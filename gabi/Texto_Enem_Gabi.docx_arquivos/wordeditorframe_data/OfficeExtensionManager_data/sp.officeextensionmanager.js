var OSF=OSF||{};OSF.OUtil=function(){var e="on",k="configurable",j="writable",f="enumerable",c="",h="undefined",b=true,d=null,g=2147483647,a=false,n=-1,s="&_xdm_Info=",q="_xdm_",l="#",m={},u=3e4,o=a,p=a,i=(new Date).getTime();function t(){var a=g*Math.random();a^=i^(new Date).getMilliseconds()<<Math.floor(Math.random()*(31-10));return a.toString(16)}function r(){var a=d;if(!o)try{if(window.sessionStorage)a=window.sessionStorage}catch(c){o=b}return a}return {set_entropy:function(a){if(typeof a=="string")for(var b=0;b<a.length;b+=4){for(var d=0,c=0;c<4&&b+c<a.length;c++)d=(d<<8)+a.charCodeAt(b+c);i^=d}else if(typeof a=="number")i^=a;else i^=g*Math.random();i&=g},extend:function(b,a){var c=function(){};c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.uber=a.prototype;if(a.prototype.constructor===Object.prototype.constructor)a.prototype.constructor=a},setNamespace:function(b,a){if(a&&b&&!a[b])a[b]={}},unsetNamespace:function(b,a){if(a&&b&&a[b])delete a[b]},loadScript:function(f,g,h){if(f&&g){var k=window.document,c=m[f];if(!c){var e=k.createElement("script");e.type="text/javascript";c={loaded:a,pendingCallbacks:[g],timer:d};m[f]=c;var i=function(){if(c.timer!=d){clearTimeout(c.timer);delete c.timer}c.loaded=b;for(var e=c.pendingCallbacks.length,a=0;a<e;a++){var f=c.pendingCallbacks.shift();f()}},j=function(){delete m[f];if(c.timer!=d){clearTimeout(c.timer);delete c.timer}for(var b=c.pendingCallbacks.length,a=0;a<b;a++){var e=c.pendingCallbacks.shift();e()}};if(e.readyState)e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){e.onreadystatechange=d;i()}};else e.onload=i;e.onerror=j;h=h||u;c.timer=setTimeout(j,h);e.src=f;k.getElementsByTagName("head")[0].appendChild(e)}else if(c.loaded)g();else c.pendingCallbacks.push(g)}},loadCSS:function(c){if(c){var b=window.document,a=b.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=c;b.getElementsByTagName("head")[0].appendChild(a)}},parseEnum:function(b,c){var a=c[b.trim()];if(typeof a==h){Sys.Debug.trace("invalid enumeration string:"+b);throw Error.argument("str")}return a},delayExecutionAndCache:function(){var a={calc:arguments[0]};return function(){if(a.calc){a.val=a.calc.apply(this,arguments);delete a.calc}return a.val}},getUniqueId:function(){n=n+1;return n.toString()},formatString:function(){var a=arguments,b=a[0];return b.replace(/{(\d+)}/gm,function(d,b){var c=parseInt(b,10)+1;return a[c]===undefined?"{"+b+"}":a[c]})},generateConversationId:function(){return [t(),t(),(new Date).getTime().toString()].join("_")},getFrameNameAndConversationId:function(b,c){var a=q+b+this.generateConversationId();c.setAttribute("name",a);return this.generateConversationId()},addXdmInfoAsHash:function(a,e){a=a.trim()||c;var b=a.split(l),d=b.shift(),f=b.join(l);return [d,l,f,s,e].join(c)},parseXdmInfo:function(h){var i=window.location.hash,e=i.split(s),a=e.length>1?e[e.length-1]:d,b=r();if(!h&&b){var c=window.name.indexOf(q);if(c>-1){var f=window.name.indexOf(";",c);if(f==-1)f=window.name.length;var g=window.name.substring(c,f);if(a)b.setItem(g,a);else a=b.getItem(g)}}return a},getConversationId:function(){var b=window.location.search,a=d;if(b){var c=b.indexOf("&");a=c>0?b.substring(1,c):b.substr(1);if(a&&a.charAt(a.length-1)==="="){a=a.substring(0,a.length-1);if(a)a=decodeURIComponent(a)}}return a},getConversationUrl:function(){var d=c,e=OSF.OUtil.parseXdmInfo(b);if(e){var a=e.split("|");if(a!=undefined&&a.length>=3)d=a[2]}return d},validateParamObject:function(f,e){var c=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:a},{name:"expectedProperties",type:Object,mayBeNull:a},{name:"callback",type:Function,mayBeNull:b}]);if(c)throw c;for(var d in e){c=Function._validateParameter(f[d],e[d],d);if(c)throw c}},writeProfilerMark:function(a){if(window.msWriteProfilerMark){window.msWriteProfilerMark(a);typeof Sys!==h&&Sys&&Sys.Debug&&Sys.Debug.trace(a)}},outputDebug:function(a){typeof Sys!==h&&Sys&&Sys.Debug&&Sys.Debug.trace(a)},defineNondefaultProperty:function(e,f,a,c){a=a||{};for(var g in c){var d=c[g];if(a[d]==undefined)a[d]=b}Object.defineProperty(e,f,a);return e},defineNondefaultProperties:function(c,a,d){a=a||{};for(var b in a)OSF.OUtil.defineNondefaultProperty(c,b,a[b],d);return c},defineEnumerableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,[f])},defineEnumerableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,[f])},defineMutableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,[j,f,k])},defineMutableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,[j,f,k])},finalizeProperties:function(e,d){d=d||{};for(var g=Object.getOwnPropertyNames(e),i=g.length,f=0;f<i;f++){var h=g[f],c=Object.getOwnPropertyDescriptor(e,h);if(!c.get&&!c.set)c.writable=d.writable||a;c.configurable=d.configurable||a;c.enumerable=d.enumerable||b;Object.defineProperty(e,h,c)}return e},mapList:function(a,c){var b=[];if(a)for(var d in a)b.push(c(a[d]));return b},listContainsKey:function(d,e){for(var c in d)if(e==c)return b;return a},listContainsValue:function(c,d){for(var e in c)if(d==c[e])return b;return a},augmentList:function(a,b){var d=a.push?function(c,b){a.push(b)}:function(c,b){a[c]=b};for(var c in b)d(c,b[c])},redefineList:function(a,b){for(var d in a)delete a[d];for(var c in b)a[c]=b[c]},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isFunction:function(a){return Object.prototype.toString.apply(a)==="[object Function]"},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},addEventListener:function(b,c,d){if(b.addEventListener)b.addEventListener(c,d,a);else if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&b.attachEvent)b.attachEvent(e+c,d);else b[e+c]=d},removeEventListener:function(b,c,f){if(b.detachEvent)b.detachEvent(e+c,f);else if(b.removeEventListener)b.removeEventListener(c,f,a);else b[e+c]=d},encodeBase64:function(d){if(!d)return d;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=[],b=[],i=0,k,h,j,e,f,g,a,n=d.length;do{k=d.charCodeAt(i++);h=d.charCodeAt(i++);j=d.charCodeAt(i++);a=0;e=k&255;f=k>>8;g=h&255;b[a++]=e>>2;b[a++]=(e&3)<<4|f>>4;b[a++]=(f&15)<<2|g>>6;b[a++]=g&63;if(!isNaN(h)){e=h>>8;f=j&255;g=j>>8;b[a++]=e>>2;b[a++]=(e&3)<<4|f>>4;b[a++]=(f&15)<<2|g>>6;b[a++]=g&63}if(isNaN(h))b[a-1]=64;else if(isNaN(j)){b[a-2]=64;b[a-1]=64}for(var l=0;l<a;l++)m.push(o.charAt(b[l]))}while(i<n);return m.join(c)},getSessionStorage:function(){return r()},getLocalStorage:function(){var a=d;if(!p)try{if(window.localStorage)a=window.localStorage}catch(c){p=b}return a},convertIntToCssHexColor:function(b){var a="#"+(Number(b)+16777216).toString(16).slice(-6);return a},attachClickHandler:function(a,b){a.onclick=function(){b()};a.ontouchend=function(a){b();a.preventDefault()}},getQueryStringParamValue:function(b,e){var f=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:a},{name:"paramName",type:String,mayBeNull:a}]);if(f){Sys.Debug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null.");return c}var d=new RegExp("[\\?&]"+e+"=([^&#]*)","i");if(!d.test(b)){Sys.Debug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found.");return c}return d.exec(b)[1]},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?b:a},isHostNameValidWacDomain:function(b){if(!b||b==="null")return a;var c=new Array("^office-int\\.com$","^officeapps\\.live-int\\.com$","^.*\\.dod\\.online\\.office365\\.us$","^.*\\.gov\\.online\\.office365\\.us$","^.*\\.officeapps\\.live\\.com$","^.*\\.officeapps\\.live-int\\.com$","^.*\\.officeapps-df\\.live\\.com$","^.*\\.online\\.office\\.de$","^.*\\.partner\\.officewebapps\\.cn$","^"+document.domain.replace(new RegExp("\\.","g"),"\\.")+"$"),d=new RegExp(c.join("|"));return d.test(b)},parseDecodedHostName:function(b,g){var d,f=this.isBroswerIE(),j=this.isBroswerEdge();try{if(f)throw"Browser doesn't support new URL library";else if(j)throw"Browser has inconsistent URL library";var e=new URL(b);if(e)if(g)d=e.hostname;else d=e.origin}catch(k){var a=document.createElement("a");a.href=b;if((a.pathname==c||a.pathname=="/")&&!(b.substring(b.length-1,b.length)==="/"))b+="/";var h=a.protocol+"//"+a.hostname+(f?"/":c)+a.pathname+a.search+a.hash,i=a.protocol+"//"+a.host+(f?"/":c)+a.pathname+a.search+a.hash;if(b==h||b==i)if(g)d=a.hostname;else d=a.protocol+"//"+a.host}return d},isBroswerIE:function(){var d=c;if(window.navigator)d=window.navigator.userAgent;var e=d.indexOf("MSIE ");if(e>0||!!d.match(/Trident.*rv\:11\./))return b;return a},isBroswerEdge:function(){var d=c;if(window.navigator)d=window.navigator.userAgent;var e=d.indexOf("Edge");if(e>=0)return b;return a}}}();OSF.OUtil.Guid=function(){var a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return {generateNewGuid:function(){for(var c="",d=(new Date).getTime(),b=0;b<32&&d>0;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[d%16];d=Math.floor(d/16)}for(;b<32;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[Math.floor(Math.random()*16)]}return c}}}();window.OSF=OSF;OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Common",Microsoft.Office);(function(window){"use strict";var stringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',"g"),trueFalseNullRegEx=new RegExp("\\b(true|false|null)\\b","g"),numbersRegEx=new RegExp("-?(0|([1-9]\\d*))(\\.\\d+)?([eE][+-]?\\d+)?","g"),badBracketsRegEx=new RegExp("[^{:,\\[\\s](?=\\s*\\[)"),badRemainderRegEx=new RegExp("[^\\s\\[\\]{}:,]"),jsonErrorMsg="Cannot deserialize. The data does not correspond to valid JSON.";function addHandler(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c)}function getAjaxSerializer(){var a="undefined";if(typeof Sys!==a&&typeof Sys.Serialization!==a&&typeof Sys.Serialization.JavaScriptSerializer!==a)return Sys.Serialization.JavaScriptSerializer;return null}function deserialize(data,secure,oldDeserialize){var transformed;if(!secure)return oldDeserialize(data);if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);transformed=data.replace(stringRegEx,"[]");transformed=transformed.replace(trueFalseNullRegEx,"[]");transformed=transformed.replace(numbersRegEx,"[]");if(badBracketsRegEx.test(transformed))throw jsonErrorMsg;if(badRemainderRegEx.test(transformed))throw jsonErrorMsg;try{eval("("+data+")")}catch(e){throw jsonErrorMsg}}function patchDeserializer(){var a=getAjaxSerializer(),b;if(a===null||typeof a.deserialize!=="function")return false;if(a.__patchVersion>=1)return true;b=a.deserialize;a.deserialize=function(a){return deserialize(a,true,b)};a.__patchVersion=1;return true}!patchDeserializer()&&addHandler(window,"load",function(){patchDeserializer()})})(window);Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5};Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6};Microsoft.Office.Common.MessageType={request:0,response:1};Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2};Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1};Microsoft.Office.Common.MethodObject=function(c,b,a){this._method=c;this._invokeType=b;this._blockingOthers=a};Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}};Microsoft.Office.Common.EventMethodObject=function(b,a){this._registerMethodObject=b;this._unregisterMethodObject=a};Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}};Microsoft.Office.Common.ServiceEndPoint=function(c){var a=this,b=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:false}]);if(b)throw b;a._methodObjectList={};a._eventHandlerProxyList={};a._Id=c;a._conversations={};a._policyManager=null};Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(g,h,b,e){var c="invokeType",a=false,d=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:a},{name:"method",type:Function,mayBeNull:a},{name:c,type:Number,mayBeNull:a},{name:"blockingOthers",type:Boolean,mayBeNull:a}]);if(d)throw d;if(b!==Microsoft.Office.Common.InvokeType.async&&b!==Microsoft.Office.Common.InvokeType.sync)throw Error.argument(c);var f=new Microsoft.Office.Common.MethodObject(h,b,e);this._methodObjectList[g]=f},unregisterMethod:function(b){var a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:false}]);if(a)throw a;delete this._methodObjectList[b]},registerEvent:function(f,d,c){var a=false,b=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:a},{name:"registerMethod",type:Function,mayBeNull:a},{name:"unregisterMethod",type:Function,mayBeNull:a}]);if(b)throw b;var e=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(d,Microsoft.Office.Common.InvokeType.syncRegisterEvent,a),new Microsoft.Office.Common.MethodObject(c,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,a));this._methodObjectList[f]=e},registerEventEx:function(h,f,d,e,c){var a=false,b=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:a},{name:"registerMethod",type:Function,mayBeNull:a},{name:"registerMethodInvokeType",type:Number,mayBeNull:a},{name:"unregisterMethod",type:Function,mayBeNull:a},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:a}]);if(b)throw b;var g=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(f,d,a),new Microsoft.Office.Common.MethodObject(e,c,a));this._methodObjectList[h]=g},unregisterEvent:function(b){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:false}]);if(a)throw a;this.unregisterMethod(b)},registerConversation:function(b,a){var c=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:"conversationUrl",type:String,mayBeNull:false,optional:true}]);if(c)throw c;if(a)this._conversations[b]=a;else this._conversations[b]=window.location.href},unregisterConversation:function(b){var a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(a)throw a;delete this._conversations[b]},setPolicyManager:function(a){var b="policyManager",c=Function._validateParams(arguments,[{name:b,type:Object,mayBeNull:false}]);if(c)throw c;if(!a.checkPermission)throw Error.argument(b);this._policyManager=a},getPolicyManager:function(){return this._policyManager}};Microsoft.Office.Common.ClientEndPoint=function(e,b,f){var c="targetWindow",a=this,d=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:c,mayBeNull:false},{name:"targetUrl",type:String,mayBeNull:false}]);if(d)throw d;if(!b.postMessage)throw Error.argument(c);a._conversationId=e;a._targetWindow=b;a._targetUrl=f;a._callingIndex=0;a._callbackList={};a._eventHandlerList={}};Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(h,d,b){var a=this,g=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"param",mayBeNull:true}]);if(g)throw g;var c=a._callingIndex++,k=new Date,e={callback:d,createdOn:k.getTime()};if(b&&typeof b==="object"&&typeof b.__timeout__==="number"){e.timeout=b.__timeout__;delete b.__timeout__}a._callbackList[c]=e;try{var i=new Microsoft.Office.Common.Request(h,Microsoft.Office.Common.ActionType.invoke,a._conversationId,c,b),j=Microsoft.Office.Common.MessagePackager.envelope(i);a._targetWindow.postMessage(j,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(f){try{d!==null&&d(Microsoft.Office.Common.InvokeResultCode.errorInRequest,f)}finally{delete a._callbackList[c]}}},registerForEvent:function(d,g,c,i){var a=this,f=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"eventHandler",type:Function,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(f)throw f;var b=a._callingIndex++,k=new Date;a._callbackList[b]={callback:c,createdOn:k.getTime()};try{var h=new Microsoft.Office.Common.Request(d,Microsoft.Office.Common.ActionType.registerEvent,a._conversationId,b,i),j=Microsoft.Office.Common.MessagePackager.envelope(h);a._targetWindow.postMessage(j,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();a._eventHandlerList[d]=g}catch(e){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[b]}}},unregisterForEvent:function(d,c,h){var a=this,f=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(f)throw f;var b=a._callingIndex++,j=new Date;a._callbackList[b]={callback:c,createdOn:j.getTime()};try{var g=new Microsoft.Office.Common.Request(d,Microsoft.Office.Common.ActionType.unregisterEvent,a._conversationId,b,h),i=Microsoft.Office.Common.MessagePackager.envelope(g);a._targetWindow.postMessage(i,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[b]}}finally{delete a._eventHandlerList[d]}}};Microsoft.Office.Common.XdmCommunicationManager=function(){var i="channel is not ready.",c="conversationId",h="Unknown conversation Id.",a=false,b=null,k=[],e=b,w=10,j=a,f=b,p=2e3,l=6e4,g={},d={},n=a;function q(b){for(var a in g)if(g[a]._conversations[b])return g[a];Sys.Debug.trace(h);throw Error.argument(c)}function r(b){var a=d[b];if(!a){Sys.Debug.trace(h);throw Error.argument(c)}return a}function u(e,c){var a=e._methodObjectList[c._actionName];if(!a){Sys.Debug.trace("The specified method is not registered on service endpoint:"+c._actionName);throw Error.argument("messageObject")}var d=b;if(c._actionType===Microsoft.Office.Common.ActionType.invoke)d=a;else if(c._actionType===Microsoft.Office.Common.ActionType.registerEvent)d=a.getRegisterMethodObject();else d=a.getUnregisterMethodObject();return d}function y(a){k.push(a)}function x(){if(e!==b){if(!j)if(k.length>0){var a=k.shift();j=a.getInvokeBlockingFlag();a.invoke()}else{clearInterval(e);e=b}}else Sys.Debug.trace(i)}function t(){if(f){var c,g=0,k=new Date,e;for(var j in d){c=d[j];for(var h in c._callbackList){var a=c._callbackList[h];e=a.timeout?a.timeout:l;if(e>=0&&Math.abs(k.getTime()-a.createdOn)>=e)try{a.callback&&a.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,b)}finally{delete c._callbackList[h]}else g++}}if(g===0){clearInterval(f);f=b}}else Sys.Debug.trace(i)}function s(){j=a}function v(b){if(window.addEventListener)window.addEventListener("message",b,a);else if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&window.attachEvent)window.attachEvent("onmessage",b);else{Sys.Debug.trace("Browser doesn't support the required API.");throw Error.argument("Browser")}}function m(c,b){var f=a;if(!c||!b||!c.length||!b.length)return f;var e=OSF.OUtil.parseDecodedHostName(c,a),d=OSF.OUtil.parseDecodedHostName(b,a);return e==d}function z(c){var g="Access Denied";if(c.data!=""&&OSF.OUtil.isHostNameValidWacDomain(OSF.OUtil.parseDecodedHostName(c.origin,true))){var a;try{a=Microsoft.Office.Common.MessagePackager.unenvelope(c.data)}catch(h){return}if(typeof a._messageType=="undefined")return;if(a._messageType===Microsoft.Office.Common.MessageType.request){var l=c.origin==b||c.origin=="null"?a._origin:c.origin;try{var d=q(a._conversationId);if(!m(d._conversations[a._conversationId],c.origin))throw"Failed origin check";var k=d.getPolicyManager();if(k&&!k.checkPermission(a._conversationId,a._actionName,a._data))throw g;var v=u(d,a),o=new Microsoft.Office.Common.InvokeCompleteCallback(c.source,l,a._actionName,a._conversationId,a._correlationId,s),z=new Microsoft.Office.Common.Invoker(v,a._data,o,d._eventHandlerProxyList,a._conversationId,a._actionName);if(e==b)e=setInterval(x,w);y(z)}catch(h){var n=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;if(h==g)n=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied;var t=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,n,Microsoft.Office.Common.ResponseType.forCalling,h),p=Microsoft.Office.Common.MessagePackager.envelope(t);c.source&&c.source.postMessage&&c.source.postMessage(p,l)}}else if(a._messageType===Microsoft.Office.Common.MessageType.response){var f=r(a._conversationId);if(!m(f._targetUrl,c.origin))throw"Failed orgin check";if(a._responseType===Microsoft.Office.Common.ResponseType.forCalling){var i=f._callbackList[a._correlationId];if(i)try{i.callback&&i.callback(a._errorCode,a._data)}finally{delete f._callbackList[a._correlationId]}}else{var j=f._eventHandlerList[a._actionName];j!==undefined&&j!==b&&j(a._data)}}else return}}function o(){if(!n){v(z);n=true}}return {connect:function(b,c,e){var a=d[b];if(!a){o();a=new Microsoft.Office.Common.ClientEndPoint(b,c,e);d[b]=a}return a},getClientEndPoint:function(e){var b=Function._validateParams(arguments,[{name:c,type:String,mayBeNull:a}]);if(b)throw b;return d[e]},createServiceEndPoint:function(a){o();var b=new Microsoft.Office.Common.ServiceEndPoint(a);g[a]=b;return b},getServiceEndPoint:function(c){var b=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:a}]);if(b)throw b;return g[c]},deleteClientEndPoint:function(e){var b=Function._validateParams(arguments,[{name:c,type:String,mayBeNull:a}]);if(b)throw b;delete d[e]},_setMethodTimeout:function(b){var c=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:a}]);if(c)throw c;l=b<=0?6e4:b},_startMethodTimeoutTimer:function(){if(!f)f=setInterval(t,p)}}}();Microsoft.Office.Common.Message=function(g,h,e,f,c){var b=false,a=this,d=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:b},{name:"actionName",type:String,mayBeNull:b},{name:"conversationId",type:String,mayBeNull:b},{name:"correlationId",mayBeNull:b},{name:"data",mayBeNull:true,optional:true}]);if(d)throw d;a._messageType=g;a._actionName=h;a._conversationId=e;a._correlationId=f;a._origin=window.location.href;if(typeof c=="undefined")a._data=null;else a._data=c};Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}};Microsoft.Office.Common.Request=function(c,d,a,b,e){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,c,a,b,e);this._actionType=d};OSF.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message);Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType};Microsoft.Office.Common.Response=function(d,a,b,e,c,f){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,d,a,b,f);this._errorCode=e;this._responseType=c};OSF.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message);Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode};Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType};Microsoft.Office.Common.MessagePackager={envelope:function(a){return Sys.Serialization.JavaScriptSerializer.serialize(a)},unenvelope:function(a){return Sys.Serialization.JavaScriptSerializer.deserialize(a,true)}};Microsoft.Office.Common.ResponseSender=function(e,h,j,f,g,i){var c=false,a=this,d=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c}]);if(d)throw d;a._requesterWindow=e;a._requesterUrl=h;a._actionName=j;a._conversationId=f;a._correlationId=g;a._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError;a._responseType=i;var b=a;a._send=function(e){try{var d=new Microsoft.Office.Common.Response(b._actionName,b._conversationId,b._correlationId,b._invokeResultCode,b._responseType,e),c=Microsoft.Office.Common.MessagePackager.envelope(d);b._requesterWindow.postMessage(c,b._requesterUrl)}catch(a){Sys.Debug.trace("ResponseSender._send error:"+a.message)}}};Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(a){this._invokeResultCode=a}};Microsoft.Office.Common.InvokeCompleteCallback=function(d,g,h,e,f,c){var b=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(b,d,g,h,e,f,Microsoft.Office.Common.ResponseType.forCalling);b._postCallbackHandler=c;var a=b;b._send=function(e){try{var d=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,a._invokeResultCode,a._responseType,e),c=Microsoft.Office.Common.MessagePackager.envelope(d);a._requesterWindow.postMessage(c,a._requesterUrl);a._postCallbackHandler()}catch(b){Sys.Debug.trace("InvokeCompleteCallback._send error:"+b.message)}}};OSF.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender);Microsoft.Office.Common.Invoker=function(g,h,d,e,f,i){var b=false,a=this,c=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:b},{name:"paramValue",mayBeNull:true},{name:"invokeCompleteCallback",mayBeNull:b},{name:"eventHandlerProxyList",mayBeNull:true},{name:"conversationId",type:String,mayBeNull:b},{name:"eventName",type:String,mayBeNull:b}]);if(c)throw c;a._methodObject=g;a._param=h;a._invokeCompleteCallback=d;a._eventHandlerProxyList=e;a._conversationId=f;a._eventName=i};Microsoft.Office.Common.Invoker.prototype={invoke:function(){var a=this;try{var b;switch(a._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:a._methodObject.getMethod()(a._param,a._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:b=a._methodObject.getMethod()(a._param);a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var d=a._createEventHandlerProxyObject(a._invokeCompleteCallback);b=a._methodObject.getMethod()(d.getSend(),a._param);a._eventHandlerProxyList[a._conversationId+a._eventName]=d.getSend();a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var g=a._eventHandlerProxyList[a._conversationId+a._eventName];b=a._methodObject.getMethod()(g,a._param);delete a._eventHandlerProxyList[a._conversationId+a._eventName];a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var c=a._createEventHandlerProxyObject(a._invokeCompleteCallback);a._methodObject.getMethod()(c.getSend(),a._invokeCompleteCallback.getSend(),a._param);a._eventHandlerProxyList[a._callerId+a._eventName]=c.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var f=a._eventHandlerProxyList[a._callerId+a._eventName];a._methodObject.getMethod()(f,a._invokeCompleteCallback.getSend(),a._param);delete a._eventHandlerProxyList[a._callerId+a._eventName]}}catch(e){a._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse);a._invokeCompleteCallback.getSend()(e)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(a){return new Microsoft.Office.Common.ResponseSender(a.getRequesterWindow(),a.getRequesterUrl(),a.getActionName(),a.getConversationId(),a.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing)}};OSF.OUtil.setNamespace("OSF",window);OSF.TargetToExtensionType={0:"ContentApp",1:"TaskPaneApp"};OSF.CorporateCatalogProvider=function(){var n="Getting corporate catalog entitlements failed: ",f="application/json;odata=verbose",e="GET",d=true,b=null,a=false,q=a,O="54346CAE-2B9A-4C64-9E00-E7C96158901B",t="61e874cd-3ac3-4531-8628-28c3acb78279",j="__OSF_CORPORATE_CATALOG.",A=j+"webUrlFromPageUrl.",r=j+"appInstanceInfoFromAppId.",x=j+"spTokenFromProductId.",N=j+"manifest.{0}.{1}",I=j+"entitlements.{0}.{1}.{2}",y=1e4;var g=b,p=3,P=8.64e7,J=6e4,H="X-Office-Version",R=24,W="&build=",S="&expver=",T={clientName:"client",clientVersion:"cv"},c={Succeeded:1,Failed:0},o=b;function h(h,g,c,f,b,d){b=b||{};var a=new Sys.Net.WebRequest;a.set_url(h);a.set_httpVerb(g);for(var e in c)a.get_headers()[e]=c[e];if(b&&b.officeVersion)a.get_headers()[H]=b.officeVersion;d&&a.set_body(d);a.set_timeout(J);a.set_userContext(b);a.add_completed(f);a.invoke()}function l(e){if(window.localStorage){var c=window.localStorage.getItem(e);if(c){var a=Sys.Serialization.JavaScriptSerializer.deserialize(c,d),f=new Date;if(Math.abs(f.getTime()-a.createdOn)<P*a.refreshRate)return a.data;else window.localStorage.removeItem(e)}}return b}function m(d,c,a){if(window.localStorage){a=a||p;var e=new Date,b={data:c,createdOn:e.getTime(),refreshRate:a};window.localStorage.setItem(d,Sys.Serialization.JavaScriptSerializer.serialize(b))}}function k(){if(window.localStorage){for(var c=window.localStorage.length,b=[],a=0;a<c;++a){var d=window.localStorage.key(a);d.indexOf(j)===0&&b.push(d)}c=b.length;for(a=0;a<c;++a)window.localStorage.removeItem(b[a])}}function i(a,h){var d=a.get_webRequest().get_userContext(),e=a.get_webRequest().get_url();if(a.get_timedOut()){Sys.Debug.trace("Requst timed out: "+e);d.callback({status:c.Failed,result:b})}else if(a.get_aborted()){Sys.Debug.trace("Requst aborted: "+e);d.callback({status:c.Failed,result:b})}else if(a.get_responseAvailable())if(a.get_statusCode()==200)try{d._onCompleteHandler(a,h)}catch(f){Sys.Debug.trace("Requst failed with exception "+f+": "+e);d.callback({status:c.Failed,result:f})}else{var g=a.get_statusText();Sys.Debug.trace("Requst failed with status code "+g+": "+e);d.callback({status:c.Failed,result:g})}else{Sys.Debug.trace("Requst failed: "+e);d.callback({status:c.Failed,result:b})}}function L(b,a){a&&a({status:c.Succeeded,result:d})}p=1;function z(d){var e=d.get_webRequest().get_userContext(),a=d.get_object();e.callback({status:c.Succeeded,result:a&&a.d?a.d.CorporateCatalogUrl:b})}function v(c){var a=c.get_webRequest().get_userContext(),g=c.get_object();a.officeExtensionUrl=g.d.results[0].__metadata.uri;var d=a.extensionType?"$filter=(OEType%20eq%20'{1}')&":"",b="{0}/items?"+d+"$select=EncodedAbsUrl,OEID,OEVersion,OEAppInstanceID,OEProductID,OEDefaultHeight,OEDefaultWidth,OEDefaultLocale,OERevoked,OEType,OETitle,OEDisplayNameXML,OEDescription,OEDescriptionXML,OEDefaultIconURL,OEIconURLXML,OECapabilitiesXML,OEProviderName&$top={2}&$orderBy=Id";b=OSF.OUtil.formatString(b,a.officeExtensionUrl,a.extensionType,y);a._onCompleteHandler=u;h(b,e,{ACCEPT:f},i,a)}function s(e){var f=e.get_webRequest().get_userContext(),a=e.get_object(),d=b,g=c.Failed;if(a&&a.d){a=a.d;g=c.Succeeded;d={AppPrincipalId:a.AppPrincipalId,AppWebFullUrl:a.AppWebFullUrl,RemoteAppUrl:a.RemoteAppUrl};m(f.cacheKey,d)}f.callback({status:g,result:d})}function w(b){var d=b.get_webRequest().get_userContext(),e=b.get_object().d.GetAppLicenseInformation.Items.results,a=e.length>0?e[0]:"";a&&m(d.cacheKey,a);d.callback({status:c.Succeeded,result:a})}function u(j){for(var d=j.get_webRequest().get_userContext(),k=j.get_object().d.results,o=k.length,f=[],h=d.applicationName,n="Version1_1",l="</Hosts>",b,g=0;g<o;++g){b=k[g];if(!b||!b.OECapabilitiesXML){Sys.Debug.trace("Skipping malformed entitlement. Manifest URL: "+(b&&b.EncodedAbsUrl));continue}var e=a;if(b.OECapabilitiesXML.indexOf(n)>=0){if(d.supportedManifestVersions&&d.supportedManifestVersions["1.1"])e=b.OECapabilitiesXML.indexOf(h)>=0||b.OECapabilitiesXML.replace(/ /g,"").indexOf(l)===-1}else e=b.OECapabilitiesXML.indexOf(h)>=0;e&&f.push({EncodedAbsUrl:b.EncodedAbsUrl,OfficeExtensionID:b.OEID,OfficeExtensionVersion:b.OEVersion,AppInstanceID:b.OEAppInstanceID,ProductID:b.OEProductID,Title:b.OETitle,TitleXML:b.OETitleXML,OfficeExtensionDescription:b.OEDescription,OfficeExtensionDescriptionXML:b.OEDescriptionXML,HostAppName:d.applicationName,OfficeExtensionDefaultHeight:b.OEDefaultHeight,OfficeExtensionDefaultWidth:b.OEDefaultWidth,OfficeExtensionLocale:b.OEDefaultLocale,OfficeExtensionKillbit:b.OERevoked,OfficeExtensionIcon:b.OEDefaultIconURL,OfficeExtensionIconXML:b.OEIconURLXML,OfficeExtensionCapabilitiesXML:b.OECapabilitiesXML,OEType:b.OEType,OEProviderName:b.OEProviderName})}var i={officeExtensionUrl:d.officeExtensionUrl,entitlements:f};f.length>0&&m(d.cacheKey,i);d.callback({status:c.Succeeded,result:i})}function D(b){var e=b.get_webRequest().get_userContext(),d=b.get_responseData();m(e.cacheKey,d);e.callback({status:c.Succeeded,result:{manifest:d,cached:a}})}function C(e){var f=e.get_webRequest().get_userContext(),h=e.get_responseData(),g=JSON.parse(h);o=f.useEmailForUpnCheck?[g.d.UserPrincipalName,g.d.Email]:[g.d.UserPrincipalName];var b=a;if(o.indexOf(f.upn)!==-1)b=d;f.callback({status:c.Succeeded,result:b})}function G(f){var b="WebUrlFromPageUrlResult",g=f.get_webRequest().get_userContext(),e=f.get_xml(),a;if(e.getElementsByTagNameNS)a=e.getElementsByTagNameNS("http://schemas.microsoft.com/sharepoint/soap/",b)[0];else a=e.getElementsByTagName(b)[0];var d;if(a.text)d=a.text;else d=a.textContent;m(g.cacheKey,d);g.callback({status:c.Succeeded,result:d})}function F(a){var b=a.webUrl;a._onCompleteHandler=z;h(b,e,{ACCEPT:f},i,a)}function E(b){var a=b.webUrl+"/_vti_bin/client.svc/web/lists?$filter=TemplateFeatureId eq guid'{0}'&$select=Id";a=OSF.OUtil.formatString(a,t);b._onCompleteHandler=v;h(a,e,{ACCEPT:f},i,b)}function M(a){a._onCompleteHandler=D;h(a.manifestUrl,e,{ACCEPT:f},i,a)}function K(a){var b=a.webUrl+"/_api/web/currentuser";a._onCompleteHandler=C;h(b,e,{ACCEPT:f},i,a)}function B(a){var c=a.baseUrl+"/_vti_bin/webs.asmx",b='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><WebUrlFromPageUrl xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>{0}</pageUrl></WebUrlFromPageUrl></soap:Body></soap:Envelope>';b=OSF.OUtil.formatString(b,a.pageUrl);a._onCompleteHandler=G;h(c,"POST",{"Content-Type":"text/xml"},i,a,b)}return {initialize:function(){var b=this,e=OSF.OUtil.getConversationId(),c=OSF.OUtil.getConversationUrl(),f=OSF.OUtil.parseDecodedHostName(c,d),h=OSF.OUtil.isHostNameValidWacDomain(f);if(h&&!q){g=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(O);g.registerMethod("OEM_getEntitlementSummaryAsync",b.getEntitlementSummaryAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_getManifestAsync",b.getManifestAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_getSPAppWebUrlFromPageUrlAsync",b.getSPAppWebUrlFromPageUrlAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_getSPAppInstanceInfoByIdAsync",b.getSPAppInstanceInfoByIdAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_getSPTokenByProductIdAsync",b.getSPTokenByProductIdAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_clearCacheAsync",b.clearCacheAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_isProxyReady",L,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_getSPCatalogUrlAsync",b.getSPCatalogUrlAsync,Microsoft.Office.Common.InvokeType.async,a);g.registerMethod("OEM_isUpnMatchAsync",b.isUpnMatchAsync,Microsoft.Office.Common.InvokeType.async,a);e&&g.registerConversation(e,c);q=d}},getSPCatalogUrlAsync:function(d,e){OSF.OUtil.validateParamObject(d,{webUrl:{type:String,mayBeNull:a}},e);d.clearCache=d.clearCache||a;try{var f=d.webUrl,g=f.length;if(f.charAt(g-1)==="/")d.webUrl=f.substr(0,g-1);d.webUrl+="/_api/SP.TenantSettings.Current/CorporateCatalogUrl";var h=j+d.webUrl;if(d.clearCache)k();else{var i=l(h);if(i){e({status:c.Succeeded,result:i});return}}d.callback=e;d.cacheKey=h;F(d)}catch(m){Sys.Debug.trace(n+m);e({status:c.Failed,result:b})}},getEntitlementSummaryAsync:function(e,f){OSF.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:a},applicationName:{type:String,mayBeNull:a},officeExtentionTarget:{type:Number,mayBeNull:d},supportedManifestVersions:{type:Object,mayBeNull:d}},f);if(e.officeExtentionTarget){var h=OSF.TargetToExtensionType[e.officeExtentionTarget];if(h)e.extensionType=h}e.clearCache=e.clearCache||a;try{var g=e.webUrl,i=g.length;if(g.charAt(i-1)==="/")e.webUrl=g.substr(0,i-1);var j=OSF.OUtil.formatString(I,e.webUrl,e.applicationName,e.extensionType);if(e.clearCache)k();else{var m=l(j);if(m){f({status:c.Succeeded,result:m});return}}e.callback=f;e.cacheKey=j;E(e)}catch(o){Sys.Debug.trace(n+o);f({status:c.Failed,result:b})}},getManifestAsync:function(e,f){OSF.OUtil.validateParamObject(e,{manifestUrl:{type:String,mayBeNull:a},id:{type:String,mayBeNull:a},version:{type:String,mayBeNull:a}},f);e.clearCache=e.clearCache||a;try{var g=OSF.OUtil.formatString(N,e.id,e.version);if(e.clearCache)k();else{var h=l(g);if(h){f({status:c.Succeeded,result:{manifest:h,cached:d}});return}}e.callback=f;e.cacheKey=g;M(e)}catch(i){Sys.Debug.trace("Getting manifest failed: "+i);f({status:c.Failed,result:b})}},isUpnMatchAsync:function(f,e){OSF.OUtil.validateParamObject(f,{upn:{type:String,mayBeNull:a},webUrl:{type:String,mayBeNull:a}},e);try{if(o){var g=a;if(o.indexOf(f.upn)!==-1)g=d;e({status:c.Succeeded,result:g})}else{f.callback=e;K(f)}}catch(h){Sys.Debug.trace("Getting UPN failed: "+h);e({status:c.Failed,result:b})}},getSPAppWebUrlFromPageUrlAsync:function(d,e){OSF.OUtil.validateParamObject(d,{pageUrl:{type:String,mayBeNull:a},baseUrl:{type:String,mayBeNull:a}},e);d.clearCache=d.clearCache||a;try{var f=A+d.pageUrl;if(d.clearCache)k();else{var g=l(f);if(g){e({status:c.Succeeded,result:g});return}}d.callback=e;d.cacheKey=f;B(d)}catch(h){Sys.Debug.trace("Getting SPApp web Url from page Url failed: "+h);e({status:c.Failed,result:b})}},getSPAppInstanceInfoByIdAsync:function(d,g){OSF.OUtil.validateParamObject(d,{webUrl:{type:String,mayBeNull:a},appInstanceId:{type:String,mayBeNull:a}},g);d.clearCache=d.clearCache||a;try{var m=r+d.appInstanceId;if(d.clearCache)k();else{var n=l(m);if(n){g({status:c.Succeeded,result:n});return}}var j=d.webUrl+"/_api/web/GetAppInstanceById('{0}')?";j=OSF.OUtil.formatString(j,d.appInstanceId);d._onCompleteHandler=s;d.callback=g;d.cacheKey=m;h(j,e,{ACCEPT:f},i,d)}catch(o){Sys.Debug.trace("Getting SPApp instance info from app instance id failed: "+o);g({status:c.Failed,result:b})}},getSPTokenByProductIdAsync:function(d,g){OSF.OUtil.validateParamObject(d,{webUrl:{type:String,mayBeNull:a},productId:{type:String,mayBeNull:a}},g);d.clearCache=d.clearCache||a;try{var m=x+d.productId;if(d.clearCache)k();else{var n=l(m);if(n){g({status:c.Succeeded,result:n});return}}var j=d.webUrl+"/_api/sp.utilities.utility.GetAppLicenseInformation(productId='{0}')";j=OSF.OUtil.formatString(j,d.productId);d._onCompleteHandler=w;d.callback=g;d.cacheKey=m;h(j,e,{ACCEPT:f},i,d)}catch(o){Sys.Debug.trace("Getting SP Token from product id failed: "+o);g({status:c.Failed,result:b})}},clearCacheAsync:function(g,d){var f=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:a},{name:"callback",type:Function,mayBeNull:a}]);if(f)throw f;try{k();d({status:c.Succeeded,result:b})}catch(e){Sys.Debug.trace("Clearing cache failed: "+e);d({status:c.Failed,result:b})}}}}();OSF.CorporateCatalogProvider.initialize()