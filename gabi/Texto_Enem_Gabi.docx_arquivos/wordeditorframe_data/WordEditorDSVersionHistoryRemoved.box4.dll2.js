'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1498:function(D,I,c){D=c(0);var l=c(16),f=c(46),a=c(6),k=c(117),x=c(179),y=c(811),m=c(224),r=c(608),z=c(2),v=c(365),G=c(22),F=c(54),H=c(247),L=c(1),J=c(1568);class M{constructor(V,W){this.p0j=V;this.wA=W}J(V){return this.p0j.Cz(V,this.wA)}}Object(D.a)(M,"PropertyMergeStrategies",null,[]);var P=c(1643),N=c(1595);class K extends N.a{constructor(){super();this.y0c=this.P3d=this.Sn=null;this.bae=0}get fha(){return"Property"}BFb(){this.detail.Z("Type",
this.fha);this.detail.Z("ComplexMerger",null!=this.Sn?this.Sn:-1);this.detail.Z("Strategy",null!=this.P3d?this.P3d:-1);this.detail.Z("ClassId",null!=this.y0c?this.y0c:-1);this.detail.Z("PropId",this.bae);return this.detail}}Object(D.a)(K,"PropertyMergeFailureDetail",N.a,[]);c.d(I,"a",function(){return O});class O{constructor(V=null){this.Gah=this.Zb=null;this.JYb=V||this.mQc()}get Sn(){return 1}get omb(){return this.JYb}mQc(){return[Object(F.a)(this,this.ANo,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.oYk,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.pNo,"tryMergeNodeInternal")]}get wA(){return 5}get dae(){return this.Gah||(this.Gah=new M(this.uk(),this.wA))}mC(V,W){const T=V.Jg.value.tf;x.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",T.id,T.Nc);V.pq.logger.Pg(Object.assign(new K,{Sn:this.Sn,y0c:T.Nc,bae:W}));return!1}Dmg(V){const W=V.Jg.value;x.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.tf.id,W.tf.Nc);for(let T=0;T<this.omb.length;T++)if(!(0,this.omb[T])(V))return x.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.tf.id,W.tf.Nc,T),V.pq.logger.y2d("GraphNodeComplexMerge.GetMergeFunctions()",T),this.D2m(V),V.Xk=null,!1;x.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",W.tf.id,W.tf.Nc);
return!0}D2m(V){V.zqg||(V.zqg=!0,P.a(V.Jg.value.su,"Base",1),P.a(V.Jg.value.tf,"Favored",1),P.a(V.An.value.tf,"Conflict",1))}ANo(V){const W=V.Jg.value,T=this.dae;if(!W.tY)return!0;let Y=!0;W.Gqa.forEach((ba,Z)=>{if(!Z.tY||V.mg.contains(ba))return!0;Z=T.J(ba);if(5===Z){const ea=W.su.Nc;x.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ea,ba,Z);V.pq.logger.Pg(Object.assign(new K,
{Sn:this.Sn,y0c:ea,bae:ba,P3d:Z}));return Y=!1}6===Z&&V.w2f.add(ba);return!0});return Y}oYk(V){V.Xk=V.Jg.value.tf.UK();const W=V.w2f,T=V.Xk;W&&W.forEach(Y=>{T.removeProperty(y.a.KX(Y));return!0});return!0}pNo(V){const W=V.An.value,T=W.su.Nc,Y=this.dae;let ba=!0;W.Gqa.forEach((Z,ea)=>{const ha=Y.J(Z);ba=this.qNo(V,ea,Z,ha);ba||(V.Xk=null,x.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",T,Z,ha),V.pq.logger.Pg(Object.assign(new K,{Sn:this.Sn,
y0c:T,bae:Z,P3d:ha})));return ba});return ba}qNo(V,W,T,Y){const ba=V.Xk;if(!W.tY&&8!==Y||2===Y||7===Y||V.mg.contains(T))return!0;if(5===Y)return!1;if(4===Y||3===Y){let Z;if(({value:Z}=V.Jg.value.Gqa.Fc(T)).returnValue&&Z.tY)return 4!==Y;Y=0}8===Y&&(Y=0);if(0===Y){if(!W.isDeleted)return V=y.a.KX(T),(O.V_o(W,T,V)||O.cro())&&ba.RTa(V,W.newValue),!0;Y=6}return 6===Y?(ba.removeProperty(y.a.KX(T)),!0):1===Y?this.mC(V,T):!1}nan(V,W,T,Y,ba,Z){V=V||new m.a;W=W||new m.a;T=T||new m.a;var ea=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
V.length,W.length,T.length),ha=V.length<=W.length&&V.length<=T.length;this.oyi()&&ha&&x.a.instance.Ua(541181455,1,1,ea);if(!ha&&this.wwi(Z.runtime.Zb))return null;if(this.oyi())for(ea=0;ea<V.length;ea++){ha=V.Zf(ea);var la=W.Zf(ea);let ia=T.Zf(ea);ha=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ha,la,ia,ea,V.length);x.a.instance.Ua(541181457,1,1,ha)}if(this.wwi(Z.runtime.Zb))for(Z=
0;Z<V.length;Z++)if(ea=V.Zf(Z),ha=W.Zf(Z),la=T.Zf(Z),!Y(ea,ha)||!Y(ea,la))return null;V=V.I5();Y=new r.a;Z=V.length;for(ea=Z;ea<W.length;ea++)ha=W.Zf(ea),V.add(ha),Y.add(ha);for(;Z<T.length;Z++)W=T.Zf(Z),Y.contains(W)?x.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(V.add(W),ba(W));return V}oyi(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}wwi(V){if(!V)return!1;
V.FUd(1000008);return V.gjb(1000008)}ASm(V){if(!V)return!1;V.FUd(1000009);return V.gjb(1000009)}hNi(V,W,T,Y){return J.a(V,W,T,Y)}MGa(V,W,T){V=V||new m.a;W=W||new m.a;T=T||new m.a;const Y=V.ZG(),ba=W.ZG(),Z=T.ZG();V=O.filter(V,ea=>ba.contains(ea)&&Z.contains(ea));V.ZG();V.aD(V.length,O.filter(W,ea=>!Y.contains(ea)));V.aD(V.length,O.filter(T,ea=>!Y.contains(ea)&&!ba.contains(ea)));return V}gan(V,W){const T=y.a.KX(W),Y=V.Vd;var ba=Y.getPropertyObjectIds(V.Jg.value.su,T),Z=Y.getPropertyObjectIds(V.Jg.value.tf,
T);const ea=Y.getPropertyObjectIds(V.An.value.tf,T);ba=this.MGa(ba,Z,ea);Z=V.Xk;0<ba.length?Y.setPropertyObjectIds(Z,T,ba):Z.removeProperty(T);V.mg.add(W)}agb(V,W,T){V.hasProperty(T)?W.RTa(T,V.VX(T)):W.removeProperty(T)}m1n(V,W){var T=W.Jl();for(const Y of T)W.removeProperty(Y);T=V.Jl();for(const Y of T)W.RTa(Y,V.VX(Y))}fIf(V,W,T,Y,ba){W=V.getPropertyInt32(W,ba);T=V.getPropertyInt32(T,ba);T=null!=W&&null!=T?Math.max(W,T):null!=T?T:null!=W?W:null;null!=T?V.setPropertyInt32(Y,ba,T):Y.removeProperty(ba)}B6e(V,
W,T,Y,ba,Z){W=V(W,ba);T=V(T,ba);V=V(Y,ba);Y=W.ZG();let ea=!1;Z&&(ea=Z(W,T,V));ea?(Z=!0,Y=!1):(Z=Y.fHh(T),Y=Y.fHh(V));x.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.Ab(ba),W.fr(),T.fr(),V.fr(),Z,Y);return{PIc:V,Q3a:Z,G3a:Y}}bUk(V,W,T,Y,ba){let Z;W=V(W,ba);T=V(T,ba);V=V(Y,ba);Y=this.zBi(W,T);Z=this.zBi(W,V);x.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.Ab(ba),W.fr(),T.fr(),V.fr(),Y,Z);return{PIc:V,Q3a:Y,G3a:Z}}zBi(V,W){if(!V&&!W)return!0;if(!V||!W)return!1;if(!V.count&&!W.count)return!0;let T=!1;W.forEach((Y,ba)=>T=V.nb(Y)&&ba==V.J(Y));return T}uk(){let V;V=this.ASm(this.Zb)?O.K8j.value:O.J8j.value;const W=new v.a(0);for(let T=0;T<V.length;T++)W.Z(V[T],7);return W}static n8(){return new O}static get instance(){return O._instance.value}static cro(){return G.a.instance.Oa("Box4.IFeatureHelper").isFeatureEnabled(79)}static V_o(V,W,T){if(void 0!==
V.newValue&&null!==V.newValue||L.a.Zyi(T.type))return!0;O.B3m(V,W,T);return!1}static B3m(V,W,T){T=T.type===L.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);T||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",V.newValue,V.oldValue));x.a.instance.Ua(19145822,1,2,W)}static hOf(V,W,T){const Y=y.a.Ab(T),ba=V.Vd;var Z=ba.getPropertyObjectIds(V.Jg.value.su,T);const ea=ba.getPropertyObjectIds(V.Jg.value.tf,T);var ha=ba.getPropertyObjectIds(V.An.value.tf,T);ha=O.Whm(ha,
V.pq.runtime.Elc);W=W.MGa(Z,ea,ha);Z=V.Xk;0<W.length?ba.setPropertyObjectIds(Z,T,W):Z.removeProperty(T);V.mg.add(Y);return!0}static Whm(V,W){const T=new m.a;V.forEach(Y=>{W.contains(Y,(ba,Z)=>ba.equals(Z))||T.add(Y);return!0});return T}static filter(V,W){const T=new m.a;V.forEach(Y=>{W(Y)&&T.add(Y);return!0});return T}static fZl(){return[y.a.Ab(l.a.bhf),y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.yL),y.a.Ab(l.a.c7c),y.a.Ab(l.a.R9f),y.a.Ab(f.a.w0c),y.a.Ab(a.a.JGd),y.a.Ab(a.a.Rgb),y.a.Ab(k.a.Yej)]}static gZl(){return[y.a.Ab(l.a.bhf),
y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.yL),y.a.Ab(l.a.c7c),y.a.Ab(l.a.R9f),y.a.Ab(f.a.w0c),y.a.Ab(a.a.JGd),y.a.Ab(k.a.Yej)]}}O._instance=new H.a(O.n8);O.J8j=new H.a(O.fZl);O.K8j=new H.a(O.gZl);Object(D.a)(O,"GraphNodeComplexMerge",null,[1816])},1499:function(D,I,c){c.r(I);D=c(0);var l=c(110),f=c(1519),a=c(1505),k=c(1646),x=c(1647);class y{constructor(r,z){this.Cbb=!1;this.Bia=null;if(!r)throw Error.argumentNull("annotations");if(!r.Fdc(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.xw=r;this.Qec=this.xw.Nbi(z);this.njk=z}get x2b(){return this.xw}get isReadOnly(){return this.Cbb}get rUa(){return this.njk}zib(r){if(0>r||r>=this.Qec)throw Error.argument("iField","Invalid field index");return this.Bia&&null!=this.Bia[r]?this.Bia[r]:this.xw.ogi(this.rUa,r)}$bg(r,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>r||r>=this.Qec)throw Error.argument("iField","Invalid field index");if(!this.xw.Ccc(this.xw.BGb(this.rUa,
r),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Bia||(this.Bia=Array(this.Qec)))[r]=z}zea(){const {Annotations:r}=c(1499);let z="[";if(this.Bia){let v=!0;for(let G=0;G<this.Qec;++G){if(null==this.Bia[G])continue;const F=this.xw.BGb(this.rUa,G);if(r.Brb(F,this.Bia[G],this.xw.ogi(this.rUa,G)))continue;v?v=!1:z+=", ";z+=this.xw.pgi(this.rUa,G);z+="=";const H=this.xw.zea(F,this.Bia[G]);F===r.Q$?(z+='"',z+=f.a.Yhf(H),z+='"'):z+=H}}return z+"]"}isEqual(r){const {Annotations:z}=
c(1499);if(this===r)return!0;if(!r||this.xw!==r.x2b||this.rUa!==r.rUa)return!1;for(let v=0;v<this.Qec;++v)if(!z.Brb(this.xw.BGb(this.rUa,v),this.zib(v),r.zib(v)))return!1;return!0}clone(){const r=new y(this.xw,this.rUa);this.Bia&&(r.Bia=Array.clone(this.Bia));return r}KT(){return this.isReadOnly?this.clone():this}vLf(){const {Annotations:r}=c(1499);if(!this.isReadOnly&&(this.Cbb=!0,this.Bia))for(let z=0;z<this.Qec;++z){const v=this.Bia[z];null!=v&&r.FKb(v)}}toString(){return this.zea()}}Object(D.a)(y,
"StructValue",null,[1245,1243]);c.d(I,"Annotations",function(){return m});class m{constructor(r,z){if(!r)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.K6m=z.zql;let v=0;var G=z.lib(r.J(v));++v;this.hNf=new k.a(new x.a(G));this.l0j=r.J(v);++v;this.GKi=Array(this.hMd);this.ZZc=Array(this.hMd);this.fmb=Array(this.hMd);for(G=0;G<this.hMd;++G){this.GKi[G]=z.XC(r.J(v));++v;this.ZZc[G]=r.J(v);++v;var F=r.J(v);++v;this.fmb[G]=Array(F);for(var H=0;H<F;++H)this.fmb[G][H]=
z.XC(r.J(v)),++v}this.mjk=r.J(v);++v;this.mLi=Array(this.V$c);this.d3d=Array(this.V$c);this.e3d=Array(this.V$c);this.c3d=Array(this.V$c);for(G=0;G<this.V$c;++G)for(this.mLi[G]=z.XC(r.J(v)),++v,F=r.J(v),++v,this.d3d[G]=Array(F),this.e3d[G]=Array(F),this.c3d[G]=Array(F),H=0;H<F;++H)this.d3d[G][H]=z.XC(r.J(v)),++v,this.e3d[G][H]=r.J(v),++v,this.c3d[G][H]=({Sha:v}=this.DOa(this.e3d[G][H],r,v,null,null,null)).returnValue,m.FKb(this.c3d[G][H]);this.OUj=r.J(v);++v;this.MMf=Array(this.U2b);this.NMf=Array(this.U2b);
this.LMf=Array(this.U2b);for(G=0;G<this.U2b;++G)this.MMf[G]=z.XC(r.J(v)),++v,this.NMf[G]=r.J(v),++v,this.LMf[G]=({Sha:v}=this.DOa(this.NMf[G],r,v,null,null,null)).returnValue,m.FKb(this.LMf[G])}KOc(r){for(let z=0;z<this.U2b;++z)if(this.MMf[z]===r)return z;return-1}V3h(r){if(!this.Ddc(r))throw Error.argument("attrID","Invalid attribute ID");return this.MMf[r]}getAttributeType(r){if(!this.Ddc(r))throw Error.argument("attrID","Invalid attribute ID");return this.NMf[r]}BGb(r,z){if(!this.Fdc(r))throw Error.argument("structTypeID",
"Invalid struct type ID");r=this.e3d[m.W$c(r)];if(0>z||z>=r.length)throw Error.argument("iField","Invalid field index");return r[z]}zea(r,z){if(!this.DHf(r))throw Error.argument("typeID","Invalid type ID");if(!this.Ccc(r,z))throw Error.argument("value","Value is not of the correct type");switch(r){case m.Q$:return z;case m.Rza:return z?"True":"False";case m.nJa:case m.Ira:return z.toString();case m.FV:return z.zea();default:if(!m.oI(r)&&m.ccd(r)){r=m.Ohf(r);const F=this.fmb[r].length;switch(this.ZZc[r]){case 0:return this.fmb[r][z];
case 1:if(z){var v="";for(var G=1;G<F;++G)z&1<<G-1&&(0<v.length&&(v+=" & "),v+=this.fmb[r][G]);return v}return this.fmb[r][0];case 2:v="";for(G=0;G<F;++G)z&1<<G&&(0<v.length&&(v+=" & "),v+=this.fmb[r][G]);return v;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.ZZc[r]);}}else return z.zea()}}DHf(r){switch(r){case m.Q$:case m.Rza:case m.nJa:case m.Ira:case m.FV:return!0;default:return m.oI(r)?this.DHf(m.n2a(r)):m.ccd(r)?this.IUm(r):this.Fdc(r)}}IUm(r){r=m.Ohf(r);return 0<=
r&&r<this.GKi.length}Fdc(r){r=m.W$c(r);return 0<=r&&r<this.mLi.length}Ddc(r){return 0<=r&&r<this.U2b}Ccc(r,z){if(null==z)return!1;switch(r){case m.Q$:return"string"===typeof z;case m.Rza:return"boolean"===typeof z;case m.nJa:return"number"===typeof z;case m.Ira:return"number"===typeof z;case m.FV:return Object(l.a)(1242,z);default:if(m.oI(r))return Object(l.a)(1244,z)&&z.W4===m.n2a(r);if(m.ccd(r)){if("number"!==typeof z)return!1;r=m.Ohf(r);const v=this.fmb[r].length;switch(this.ZZc[r]){case 0:return 0<=
z&&z<v;case 1:return!(z&-1<<v-1);case 2:return!!z&&!(z&-1<<v);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.ZZc[r]);}}else return Object(l.a)(1245,z)&&z.rUa===r}}get U2b(){return this.OUj}get hMd(){return this.l0j}get V$c(){return this.mjk}sMl(r){if(!this.Ddc(r))throw Error.argument("attrID","Invalid attribute ID");return this.LMf[r]}Nbi(r){if(!this.Fdc(r))throw Error.argument("structTypeID","Invalid struct type ID");return this.d3d[m.W$c(r)].length}pgi(r,z){if(!this.Fdc(r))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.d3d[m.W$c(r)][z]}ogi(r,z){if(!this.Fdc(r))throw Error.argument("structTypeID","Invalid struct type ID");r=this.c3d[m.W$c(r)];if(0>z||z>=r.length)throw Error.argument("iField","Invalid field index");return r[z]}DOa(r,z,v,G,F,H){if(!z)throw Error.argumentNull("initData");if(m.oI(r)){var L=z.J(v);++v;r=m.n2a(r);var J=new a.a(this,r);for(var M=0;M<L;++M)Array.add(J.items,({Sha:v}=this.DOa(r,z,v,G,F,H)).returnValue);return{returnValue:J,Sha:v}}switch(r){case m.Q$:return{returnValue:(G||
this.hNf).XC(z.J(v++)),Sha:v};case m.Rza:return{returnValue:1===z.J(v++),Sha:v};case m.nJa:return{returnValue:z.J(v++),Sha:v};case m.Ira:return{returnValue:(F||this.K6m)[z.J(v++)],Sha:v};case m.FV:r=z.J(v++);L=new f.a(this);for(J=0;J<r;++J)M=z.J(v),++v,H&&(M=H[M]),L.Vy(M,({Sha:v}=this.DOa(this.getAttributeType(M),z,v,G,F,H)).returnValue);return{returnValue:L,Sha:v};default:if(m.ccd(r))return{returnValue:z.J(v++),Sha:v};if(m.QBj(r)){L=z.J(v++);J=new y(this,r);for(M=0;M<L;++M){const P=z.J(v);++v;J.$bg(P,
({Sha:v}=this.DOa(this.BGb(r,P),z,v,G,F,H)).returnValue)}return{returnValue:J,Sha:v}}throw Error.argument("typeID","Invalid type ID");}}static ccd(r){return 16<=(r&16383)&&16384!==(r&16384)&&32768!==(r&32768)}static QBj(r){return 16<=(r&16383)&&16384===(r&16384)&&32768!==(r&32768)}static oI(r){return 32768===(r&32768)}static C1l(r){if(m.oI(r))throw Error.argument("nonListTypeID","Non-list type ID required");return r|32768}static n2a(r){if(!m.oI(r))throw Error.argument("listTypeID","List type ID required");
return r&-32769}static Brb(r,z,v){switch(r){case m.Q$:case m.Rza:case m.nJa:case m.Ira:return z===v;case m.FV:return z.isEqual(v);default:return m.oI(r)?z.isEqual(v):m.ccd(r)?z===v:z.isEqual(v)}}static FKb(r){Object(l.a)(1243,r)&&r.vLf()}static KT(r){return Object(l.a)(1243,r)?r.KT():r}static Ohf(r){return r-16}static W$c(r){return(r&-16385)-16}}m.Q$=1;m.Rza=2;m.nJa=3;m.Ira=5;m.FV=9;Object(D.a)(m,"Annotations",null,[1246])},1503:function(D,I,c){D=c(0);var l=c(344);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(D.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(a,"InsightsParameters",null,[]);var k=c(1734),x=c(1735),y=c(1736),m=c(1737),r=c(2),z=c(1550),v=c(1565),G=c(34),F=c(20),H=c(19),L=c(25);c.d(I,"a",function(){return J});class J{static get mBf(){return"Insights_16x16x32"}static get $Bl(){return"Find_16x16x32"}static get TZi(){return"-Parameterized"}static get Hgg(){return"Parameterized"}static get rme(){return"bTryQuery"}static get Lmg(){return"TellMeSuggestion_"}static get qBj(){return"bTryQueryAlternate"}static get gkg(){return"MenuTellMe"}static get Lzn(){const M=
{},P=[];Array.add(P,{Term:{PeopleType:"Person"}});M.And=P;return M}static ibf(M){return M+J.TZi}static getParameter(M){let P="",N="";if(M)for(let K=0;K<M.MYh;++K)"Type"===M.mpf(K)?P=M.getValue(K):"Value"===M.mpf(K)&&(N=M.getValue(K));return new l.a(P,N)}static QCb(M){M=Object.assign(new a,{neighborhood:M,mentionStart:0,mentionLength:M.length});return G.c(M)}static mMh(M,P,N){M=Object.assign(new f,{displayName:M,email:P,userId:N});return G.c(M)}static uOa(M,P,N=null){return G.c(J.Ufi(M,P,N,null))}static Ufi(M,
P,N=null,K=null){M=Object.assign(new v.a,{neighborhood:M,mentionStart:0,mentionLength:M?M.length:0});return Object.assign(new z.a,{selection:M,userIntent:K,entryPoint:P,launchData:N})}static z5n(M,P){return J.uOa(M,J.edj(P))}static edj(M){switch(M){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static qLm(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static qdc(){const M=
r.AFrameworkApplication.K?r.AFrameworkApplication.K.kb("SovereignEnvironmentName"):null;return!!M&&0<M.length}static isEnterpriseUser(){const M=r.AFrameworkApplication.K?r.AFrameworkApplication.K.kb("HostAuthType"):null;return!!M&&"aad"===M.toLowerCase()||"external"===M&&J.cDf()}static Ceg(M){return M.jGo&&!J.qdc()}static JRm(){const M=r.AFrameworkApplication.K?r.AFrameworkApplication.K.kb("UiHostIntegrationType"):"";return!!r.AFrameworkApplication.K&&"UnifiedUiHostTeams"===M&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Beg(M){return M.GUa&&M.bAl&&(M.Iad||M.Gad||M.olb)&&!J.JRm()&&J.isEnterpriseUser()&&!J.qdc()}static xpa(){return r.AFrameworkApplication.K?r.AFrameworkApplication.T7a||r.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):r.AFrameworkApplication.T7a}static BR(M){return!M||J.uBi(M.Cg)}static uBi(M){return!M||!M.trim().length}static bme(M){if(!M)return 0;const P=Math.pow(10,5);return Math.round(M*P)/P}static wIo(){var M=new Date;return M?new Date(M.getUTCFullYear(),M.getUTCMonth(),M.getUTCDate(),
M.getUTCHours(),M.getUTCMinutes(),M.getUTCSeconds(),M.getUTCMilliseconds()):null}static ruf(M){M=new Date(M);return(J.wIo().getTime()-M.getTime())/1E3}static cCi(M){const {InsightsMenuItemFactory:P}=c(1733);switch(M){case k.a.byf:case x.a.z_h:case P.Qri:case y.a.$Pi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return M.startsWith(J.rme)||
M.startsWith(J.Lmg)||M.startsWith(J.qBj)||M.startsWith("PeopleSuggestion")||M.startsWith("FileSuggestion")||M.startsWith("FindInDocumentSuggestion")||M.startsWith("NotesSuggestion")||M.startsWith("OnenoteNotesSuggestion")||M.startsWith("SmartLookupFromTellMe")||M.startsWith("GetHelpFromTellMe")||M.startsWith("GetHelpWithDescriptionFromTellMe")||M.startsWith("AddinSuggestion")||M.startsWith("OfficeScripts")?!0:!1}static Fpf(M,P){const N=[];Array.add(N,new m.a(400,M));Array.add(N,new m.a(200,P));M=
{};M.parts=N;return JSON.stringify(M)}static iib(M){const P=M.indexOf("<b0>"),N=M.lastIndexOf("</b0>"),K=[];Array.add(K,new m.a(400,M.substring(0,P)));Array.add(K,new m.a(600,M.substring(P+4,N)));Array.add(K,new m.a(400,M.substring(N+5,M.length)));M={};M.parts=K;return JSON.stringify(M)}static Mhi(M){const P=J.ruf(M);return 60>P?CommonUIStrings.l_TimeSince_SecsAgo:3600>P?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(P/60).toString()):86400>P?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(P/3600).toString()):172800>P?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(M)).localeFormat("MMMM dd, yyyy"))}static TPl(M){const P=Array(M.length);for(let N=0;N<M.length;N++)P[N]=M[N].commandId;return P}static cDf(){if("Dev Box"===r.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse"))return!0;let M=r.AFrameworkApplication.K.kb("UserPrincipalName");M=L.c(M)?"":H.a.Zg(M);const P=r.AFrameworkApplication.K.ow("TellMeIntEnabledForFeatureCrew")?
r.AFrameworkApplication.K.BB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(P,M)&&"inner"===r.AFrameworkApplication.K.kb("Microsoft365Ring")}static bZl(M){switch(J.LQd(M)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static wcm(M){M=J.LQd(M);switch(M){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return M}}static LQd(M){switch(M.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static lpa(){return F.a.I4&&!F.a.Cr}}J.v8a=9E5;Object(D.a)(J,"TellMeUtils",null,[])},1504:function(D,I,c){c.r(I);D=c(0);var l=c(503),f=c(355),a=c(54),k=c(110),x=c(69),y=c(1660),m=c(218);class r{constructor(Xa,Pb,Va,tb,cb,Mb){this.groupType=Xa;this.resultType=Pb;this.wig=Va;this.Y8=tb;this.Oef=cb;this.resultIndex=
Mb}}Object(D.a)(r,"ClickLoggingInfo",null,[]);const z=Xa=>{const Pb=[];for(;Xa;)Array.add(Pb,"{ContextId:"+Xa.contextId+", IsGraphNodeContext:"+Xa.Vk+"}"),Xa=Xa.ek;Pb.reverse();return"{"+Pb.join(", ")+"}"};class v{constructor(){this.dpa=this.sessionId=null}}Object(D.a)(v,"CorrelationRecord",null,[1122]);var G=c(1524);class F{constructor(Xa,Pb){this.provider=Xa;this.J8a=Pb}}Object(D.a)(F,"ExternalResultProvider",null,[]);class H{constructor(Xa,Pb){this.Id=null;this.TimeStamp=0;this.Id=Xa;this.TimeStamp=
Pb}}Object(D.a)(H,"MRUControl",null,[]);var L=c(1648),J=c(1503),M=c(2),P=c(1383);class N{constructor(Xa,Pb){this.a$j=10;this.n7=[];this.HBa=[];this.x0g=this.w0g=!1;this.Wyc=this.Vyc="";this.HYb=Pb;this.fc=Xa}mPc(){!this.w0g&&this.fc&&(this.Vyc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.fc.application,this.n7=this.L4h(),this.w0g=!0);return this.n7}z9l(){!this.x0g&&this.fc&&(this.Wyc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.fc.application,this.HBa=this.L4h(!0),this.x0g=!0);return this.HBa}KTm(Xa){return Xa.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Xa||"TryOfficeUpsell"===Xa}ICf(Xa){return this.NFm(Xa)||this.KTm(Xa)||J.a.cCi(Xa)?!1:!0}RZa(Xa){Xa=Xa.ControlId;this.ICf(Xa)&&(Xa=this.h7f(Xa),this.wYn(Xa),this.E7m(),Array.insert(this.n7,0,new H(Xa,Date.now())),this.Vyc.length&&(Xa=JSON.stringify(this.n7),P.a.instance.setItem(this.Vyc,Xa)))}QE(Xa){this.D7m();Array.insert(this.HBa,0,new H(L.a[Xa],Date.now()));this.Wyc.length&&(Xa=JSON.stringify(this.HBa),P.a.instance.setItem(this.Wyc,Xa))}L4h(Xa=!1){if(!this.n7.length){var Pb=
Xa?P.a.instance.getItem(this.Wyc):P.a.instance.getItem(this.Vyc);if(!Pb||""===Pb)return Xa?this.HBa:this.n7;let Va=null;try{Va=JSON.parse(Pb)}catch(tb){this.qWk(Xa),Va=null}if(!Va||!Va.length||10<Va.length)return Xa?this.HBa:this.n7;Pb=0;for(const tb of Va)if(Xa||this.fc.F0d(tb.Id)&&this.ICf(tb.Id))if(Xa?Array.insert(this.HBa,Pb++,tb):Array.insert(this.n7,Pb++,tb),Pb===this.HYb)break}return Xa?this.HBa:this.n7}d9e(Xa){Xa=this.h7f(Xa);for(const Pb of this.n7)if(Pb.Id===Xa)return!0;return!1}qWk(Xa=
!1){P.a.instance.setItem(Xa?this.Wyc:this.Vyc,"")}aIm(Xa){Xa=this.h7f(Xa.ControlId);return this.ICf(Xa)?this.d9e(Xa):!1}wYn(Xa){if(0<this.n7.length){let Pb=0;for(const Va of this.n7){if(Va.Id===Xa){Array.removeAt(this.n7,Pb);break}Pb++}}}h7f(Xa){return"Excel"===this.fc.application&&Xa.startsWith("m_excelWebRenderer_ewaCtl_")?Xa.substr(26,Xa.length):Xa}E7m(){this.n7.length===this.HYb&&Array.removeAt(this.n7,this.n7.length-1)}D7m(){this.HBa.length===this.a$j&&Array.removeAt(this.HBa,this.HBa.length-
1)}NFm(Xa){Xa=Xa.split("|");let Pb="";if(6<=Xa.length)Pb=Xa[0];else if(3<=Xa.length){if("3"===Xa[0])return!0;Pb=Xa[1]}return Pb.startsWith("WA")}static createInstance(Xa){let Pb=3;M.AFrameworkApplication.K&&(Pb=M.AFrameworkApplication.K.lc("TellMeMaxRecommendedResultsToReturn",3));return new N(Xa,Pb)}}Object(D.a)(N,"MruControlsManager",null,[1121]);class K{constructor(Xa){this.yxb=Xa}Mga(Xa,Pb){let Va;return Xa.fD&&(Va=this.yxb[Xa.value])?Va.Mga(Xa,Pb):(Va=this.K5h(Xa.value))?Va.Mga(Va.hcn,Pb):null}g7l(Xa,
Pb){if(Xa=this.yxb[Xa])for(const Va of Pb)if(Pb=J.a.getParameter(Va),Pb.key===Xa.AZf)return Pb.value;return null}Zfn(Xa){(Xa=this.K5h(Xa))&&Xa.Wfn()}K5h(Xa){const Pb=Xa.indexOf(J.a.TZi);return 0<Pb?this.yxb[Xa.substring(0,Pb)]:null}}Object(D.a)(K,"ParameterizedCommandManager",null,[1120]);var O=c(1535);class V{constructor(Xa,Pb){this.Cg=Xa;this.kob=Pb}}Object(D.a)(V,"TellMeQuery",null,[]);var W=c(1645);class T{constructor(Xa,Pb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Xa;this.TimeElapsedSinceClick=
Pb}}Object(D.a)(T,"CommandClickedEvent",null,[]);var Y=c(25);class ba{constructor(Xa,Pb){this.rbk=Xa;this.Ita=Pb}resultsUpdated(Xa){this.rbk(Y.c(Xa.query)?"":Xa.query.Cg,Xa.uo,Xa.attributes,this.Ita,Xa.Wcc)}}Object(D.a)(ba,"ResultsUpdatedCallback",null,[1119]);class Z{constructor(Xa,Pb,Va,tb,cb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Xa;this.TimeElapsedSinceClick=Va;this.CommandSurface=tb;this.CommandId=
Pb;this.TerminalParentControlId=cb}}Object(D.a)(Z,"UserActionEvent",null,[]);var ea=c(75);class ha{constructor(Xa,Pb){this.menuModel=Xa;this.cdj=Pb}}Object(D.a)(ha,"GeneratedMenuModel",null,[]);class la{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(D.a)(la,"MenuModel",null,[]);class ia{constructor(Xa,Pb,Va){this.fc=Xa;this.yxb=Pb;this.Wfa=Va}rJl(Xa,Pb,Va){const {TellMeActor:tb}=c(1504);let cb=0;const Mb=new la,mc=[];let Cb=
"";Mb.sections=[];let Ja=new ea.a;const Wa=!!this.fc&&this.fc.x4a;var xb=!!this.fc&&this.fc.Npb||M.AFrameworkApplication.ua.Lb.Npb;for(const qc of Xa){Xa=0;Wa||(Ja=new ea.a);const Lc=new ea.a;let Ac=qc.displayName;for(const gd of qc.results){if(0<=gd.value.indexOf(J.a.Hgg)){if(gd.fD){var ic=this.yxb[gd.value];if(ic&&gd.value.endsWith(J.a.Hgg)){if("FindParameterized"!==gd.value&&!xb){const Md=[];Md.push(appChrome.actions.setControlLabel(gd.value,ic.ERd(gd)));Md.push(appChrome.actions.setButtonCommandValueId(gd.value,
ic.Mnf(gd)));appChrome.api.dispatch(Md)}ic=gd.value.replace(J.a.Hgg,"");Ja.remove(ic)?Xa--:Lc.add(ic);Ja.add(gd.value);Xa++}}}else switch(gd.type){case 5:Lc.contains(gd.value)||(Ja.add(gd.value),Xa++);break;case 7:Ja.add(gd.fD);Xa++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Ja.add(gd.value),Xa++}13===qc.groupType&&(Ac=J.a.xpa()?0<Pb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Pb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Pb));21===qc.groupType&&(Ac=CommonUIStrings.l_LearningUILiveText)}cb+=Xa;""!==Ac&&0<Xa&&(Cb+=" , "+Xa.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Ac+" , ");0<Ja.count&&!Wa&&(Xa=appChrome.api.menuSection(Ja.toArray(),qc.displayName,null,O.a[qc.groupType]),mc.push(Xa))}xb=null;0<cb&&(xb=0<Pb.length?1!==cb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
cb,Pb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Pb):1!==cb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,cb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Wa?(Pb=appChrome.api.menuSection(Ja.toArray(),"",null,null),mc.push(Pb)):xb+=Cb);Va&&(this.fc.Pwa?tb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(xb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(xb)));Mb.sections=
mc;return new ha(Mb,cb,[])}static get Kgf(){return ia.wSg||(ia.wSg=new ha(Object.assign(new la,{sections:[]}),0,[]))}}ia.wSg=null;Object(D.a)(ia,"TellMeMenuDefintionGenerator",null,[]);var sa;(function(Xa){Xa[Xa.TellMeControlActivated=0]="TellMeControlActivated";Xa[Xa.TellMeQueryExecuted=1]="TellMeQueryExecuted";Xa[Xa.TellMeResultsRendered=2]="TellMeResultsRendered";Xa[Xa.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(sa||(sa={}));Object(D.b)("PerformanceMarker",sa);var Oa;(function(Xa){Xa[Xa.TellMeTimeToRender=
0]="TellMeTimeToRender";Xa[Xa.TellMeSessionLength=1]="TellMeSessionLength";Xa[Xa.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Oa||(Oa={}));Object(D.b)("PerformanceMeasure",Oa);class Ra{mark(Xa){window.performance.mark(sa[Xa])}measure(Xa,Pb,Va){const {TellMeActor:tb}=c(1504);try{window.performance.measure(Oa[Xa],sa[Pb],sa[Va])}catch(cb){tb.instance.Le.onError("TellMePerformance:Measure","error measuring "+Oa[Xa])}}XLf(Xa,Pb,Va){const {TellMeActor:tb}=c(1504);tb.instance.Le.fMf(Pb,Va,Xa,this.l2l(Xa))}TWk(){var Xa=
[0,1,2,3];for(const Pb of Xa)window.performance.clearMarks(sa[Pb])}clearMeasures(Xa){for(const Pb of Xa)window.performance.clearMeasures(Oa[Pb])}l2l(Xa){let Pb=0;(Xa=this.dLl(Xa))&&0<Xa.length&&(Pb=Xa[Xa.length-1].duration);return Pb}dLl(Xa){return window.performance.getEntriesByName(Oa[Xa],"measure")}}Object(D.a)(Ra,"TellMePerformance",null,[]);var Na=c(1571),Da=c(1570),ra=c(34);class xa{constructor(Xa){this.nkk=Xa}rMb(Xa,Pb,Va){const {TellMeActor:tb}=c(1504);tb.instance.Le.M9(Pb,Da.a.$hc,Xa.data.Qe.toString(),
Math.round(window.performance.now()-Va),Da.a.$hc,!0,Na.a.lQa);Xa=ra.b(Xa.data.se);Pb=-1;Xa.Index&&(Pb=Xa.Index);tb.instance.Le.H4m(Pb,this.nkk)}$Lb(Xa,Pb,Va){const {TellMeActor:tb}=c(1504);tb.instance.Le.M9(Pb,Da.a.$hc,Xa.data.Qe.toString(),Math.round(window.performance.now()-Va),Da.a.$hc,!1,Na.a.lQa)}F9l(Xa){if(Xa&&""!==Xa.trim()){const Va=window.performance.now(),tb=M.AFrameworkApplication.Rwj;var Pb={};Pb.Text=Xa;Pb.IsFileHash="false";Pb=ra.c(Pb);M.AFrameworkApplication.He.sj(tb,2,Pb,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,cb=>{this.rMb(cb,Xa.length,Va)},cb=>{this.$Lb(cb,Xa.length,Va)},null,null,!1,4E3,6E3)}}}Object(D.a)(xa,"TellMeQueryIndexCallback",null,[]);var fa=c(1506);class oa{constructor(Xa,Pb,Va){this.xml=Xa;this.cdj=Pb;this.Xnl=Va}}Object(D.a)(oa,"GeneratedMenuXml",null,[]);var ta=c(1734),Ka=c(19);class va{constructor(Xa,Pb){this.Phd=Xa||{};this.hYa=Pb}get POb(){return 5}Mga(Xa,Pb=null){return this.hYa.Mga(Xa,Pb)||this.sLk(Xa.value)}sLk(Xa){return va.t4e(Xa,this.Phd[Xa]||null)}static t4e(Xa,
Pb=null){Xa=String.format('<ClonedControl Id="{0}" ',Xa);for(let cb in Pb){var Va=cb,tb=Pb[cb];tb=tb?Ka.a.vf(tb.toString()):"";Xa+=String.format('{0}="{1}" ',Va,tb)}return Xa+"/>"}}Object(D.a)(va,"CommandMenuItemFactory",null,[1115]);var La=c(162);class za{constructor(){this.d1j=CommonUIStrings.l_FindInDocumentText}get POb(){return 8}Mga(Xa){var Pb=Xa.fD;Xa=Ka.a.vf(Xa.value);const Va=Ka.a.vf(Pb);Pb=Ka.a.vf(String.format(this.d1j,Pb));return this.FIl(Xa,Va,Pb)}FIl(Xa,Pb,Va){return La.a(Xa,"1540292897",
Va,J.a.$Bl,null,Pb,Va,null,null)}}Object(D.a)(za,"FindInDocumentMenuItemFactory",null,[1115]);var Ca=c(1735),ua=c(1733),ib=c(1736);class bb{get POb(){return 7}Mga(Xa){const Pb=Object(x.a)(W.a,Xa);return this.AJl(Ka.a.vf(Xa.value),Pb.id)}AJl(Xa,Pb){return La.a(Pb,"1404166600",Xa,null,null,Xa,Xa,null,null)}}Object(D.a)(bb,"TryQueryMenuItemFactory",null,[1115]);class mb{constructor(Xa){this.P6=[];this.fc=Xa}uVl(Xa){for(const Pb of this.P6)if(Pb.POb===Xa)return Pb;return null}ia(Xa){this.P6.push(Xa)}BSn(Xa){this.ia(new va(this.fc.H4k,
Xa));this.ia(new ib.a(this.fc.Nen));this.ia(new ta.a(this.fc.n$n,this.fc.m$n,this.fc.sGo,this.fc.Srm,this.fc.fqo));this.ia(new ua.InsightsMenuItemFactory);this.ia(new za);this.ia(new Ca.a);this.ia(new bb)}}Object(D.a)(mb,"MenuItemFactoryRegistry",null,[]);var yb=c(1508);class ab{constructor(Xa,Pb){this.fc=Xa;this.A5g=new mb(this.fc);this.A5g.BSn(Pb)}sJl(Xa,Pb){let Va=0;const tb=[],cb=[];for(const mc of Xa){Xa=J.a.gkg;var Mb=[];for(const Cb of mc.results){const Ja=this.A5g.uVl(Cb.type).Mga(Cb,Pb);
Xa=J.a.gkg;Mb.push(Ja);if(13===Cb.type||14===Cb.type)Xa="Menu32";17===Cb.type&&(Xa="MenuTellMeExtended");Cb.groupType=mc.groupType;cb.push(Object(x.a)(yb.a,Cb))}Va=Va?Va:Mb.length;Mb=La.d("TellMeDropdownControls",Mb);Xa=La.g("TellMeDropdownMenuSection",Mb,Xa,mc.displayName);tb.push(Xa)}Pb=La.h(tb,"LookupDropdownMenu");return new oa(Pb,Va,cb)}static get ALd(){return ab.xSg||(ab.xSg=new oa(La.h([],"LookupDropdownMenu"),0,[]))}}ab.xSg=null;Object(D.a)(ab,"TellMeXmlGenerator",null,[]);class Ga{}Ga.adn=
"MRU";Ga.test="Test";Object(D.a)(Ga,"ActionType",null,[]);var Za=c(1554),Ub;(function(Xa){Xa[Xa.Service=0]="Service";Xa[Xa.Local=1]="Local";Xa[Xa.MRU=2]="MRU";Xa[Xa.TestResult=3]="TestResult";Xa[Xa.Unknown=4]="Unknown"})(Ub||(Ub={}));Object(D.b)("SubResultType",Ub);var Xb=c(85);class zb{constructor(Xa,Pb,Va,tb,cb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Xa;this.IsEnabled=Pb;this.ResultType=L.a[Va];this.SubResultType=Ub[tb];
this.OptionalData=cb?Xb.a.toJSON(cb):null}}Object(D.a)(zb,"ResultInfo",null,[]);var Ib=c(112),$a=c(188),Hb=c(290);class Ya{constructor(Xa,Pb=null){this.lnd="TellMeWAC.";this.Vck=Xa;this.plk=Pb}hIa(Xa,Pb,Va){Pb=Ib.a.jJ(Pb);Xa=Ib.a.ebf(Xa,this.Vck,this.plk,Va,Pb);$a.a.hIa(Xa,this.lnd)}gIa(Xa,Pb,Va=0){Pb=Ib.a.jJ(Pb);$a.a.gIa(Object.assign(new Hb.a,{name:Xa,dataFields:Pb,durationMs:Va}),this.lnd)}}Object(D.a)(Ya,"TellMeOtelLogger",null,[1145]);var Sa=c(135);class Eb{constructor(Xa,Pb,Va,tb,cb,Mb,mc){this.p7=
this.$aa=this.XNg=null;this.Iea=Xa;this.Q$a=Pb;this.FMa=Va;this.Bbb=tb;this.tXa=cb;this.M7j=Mb;this.p7=mc?mc:new Ya(this.Bbb?m.CuiHelper.Ggg:m.CuiHelper.Oke)}get Er(){return this.Bbb}get Kqa(){return this.FMa}Gge(Xa){this.XNg=Xa;switch(Xa){case fa.a.contextMenu:this.$aa=fa.a.contextMenu;break;default:this.$aa=fa.a.tellMe}}nIk(Xa,Pb){this.FMa.dpa||(this.FMa.dpa=Sa.a.create().toString(),this.DIi(Xa,!0,Pb))}pVh(Xa,Pb=!0){this.FMa.dpa&&this.s2m(Xa,Pb);this.Bbb&&appChrome.api.updateTellMeCorrelationId("");
this.FMa.dpa=null}DIi(Xa,Pb,Va){const {TellMeActor:tb}=c(1504),cb=this.q8(G.a.y3a);cb[Za.a.culture]=this.Q$a;cb[Za.a.appName]=this.Iea;cb[Za.a.context]=Xa;cb[Za.a.P_d]=this.tXa;cb[Za.a.ITm]=this.M7j;cb[Za.a.tSm]=Va;cb[Za.a.AMm]=Pb;cb[Za.a.contentType]=tb.instance.aJd;this.p7.hIa(G.a.y3a,cb,this.XNg);this.Bbb&&appChrome.api.updateTellMeCorrelationId(this.FMa.dpa)}s2m(Xa,Pb){const Va=this.q8(G.a.mIb);Va[Za.a.jrl]=Xa;Va[Za.a.zMm]=Pb;this.p7.gIa(G.a.mIb,Va)}G4m(Xa,Pb,Va){let tb=0;!Va&&0<Xa.length&&(tb=
Xa.trim().split(" ").length);const cb=this.q8(G.a.query);cb[Za.a.query]="!";cb[Za.a.LNb]=Pb;cb[Za.a.i4i]=Xa.length;cb[Za.a.tDi]=Va;cb[Za.a.A5o]=tb;this.p7.hIa(G.a.query,cb,this.$aa)}H3m(Xa,Pb,Va,tb,cb,Mb,mc,Cb=null){const Ja=this.q8(G.a.latency);Ja[Za.a.culture]=this.Q$a;Ja[Za.a.i4i]=Xa;Ja[Za.a.VBj]=Pb;Ja[Za.a.statusCode]=Va;Ja[Za.a.service]=cb;Ja[Za.a.isSuccess]=Mb;Ja[Za.a.OXm]=mc;Cb&&(Ja[Za.a.ZIo]=Cb);this.p7.gIa(G.a.latency,Ja,tb)}fMf(Xa,Pb,Va,tb){const cb=this.q8(G.a.performance);cb[Za.a.culture]=
this.Q$a;cb[Za.a.rIk]=sa[Xa];cb[Za.a.Gtl]=sa[Pb];cb[Za.a.bAn]=Oa[Va];this.p7.gIa(G.a.performance,cb,tb)}O4m(Xa,Pb){var {TellMeActor:Va}=c(1504);const {CommandResultsUtility:tb}=c(1543);if(Xa.results.length){var cb=this.q8(G.a.Taj);cb[Za.a.Y8]=Pb.toString();cb[Za.a.groupType]=O.a[Xa.groupType];16===Xa.groupType&&(cb[Za.a.RRm]=Va.instance.$cd);Pb=[];Va=[];var Mb=[];for(const mc of Xa.results)cb[Za.a.resultType]||(cb[Za.a.resultType]=L.a[mc.type]),Xa={},27===mc.type&&(Xa.AssetId=mc.XI),Va.push(tb.lVc(mc.value)),
Pb.push(mc.value),Mb.push(new zb(mc.value,tb.lVc(mc.value),mc.type,mc.Zuj,Xa));0<Pb.length&&(cb[Za.a.B5n]="{"+Pb.join(", ")+"}",cb[Za.a.ftl]="{"+Va.join(", ")+"}",cb[Za.a.x5n]=ra.c(Mb));this.p7.hIa(G.a.Taj,cb,this.$aa)}}gKl(Xa,Pb){if(4===Xa)return Ga.adn;switch(Pb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return L.a[Pb]}U1m(Xa,Pb,Va,tb,cb){const Mb=this.q8(G.a.click);Mb[Za.a.VBj]=Xa;Mb[Za.a.$xn]=Pb;Mb[Za.a.commandId]=
Va;Mb[Za.a.S3]=tb;Mb[Za.a.actionType]=this.gKl(cb.groupType,cb.resultType);Mb[Za.a.resultType]=L.a[cb.resultType];Mb[Za.a.wig]=Ub[cb.wig];Mb[Za.a.groupType]=O.a[cb.groupType];Mb[Za.a.Y8]=cb.Y8.toString();Mb[Za.a.Oef]=cb.Oef.toString();Mb[Za.a.resultIndex]=cb.resultIndex.toString();this.p7.hIa(G.a.click,Mb,this.$aa)}$1m(Xa,Pb){this.FMa.dpa||(this.FMa.dpa=Sa.a.create().toString(),this.DIi("",!1,Pb));Pb=this.q8(G.a.WHh);Pb[Za.a.LNb]=Xa;this.p7.gIa(G.a.WHh,Pb)}SIi(Xa,Pb,Va){if(Xa){if(Va)for(let tb in Va)Xa[tb]=
Va[tb];this.p7.gIa(G.a.events,Xa,Pb)}}MG(Xa,Pb,Va=null){const tb=this.q8(G.a.events);tb[Za.a.event]=Xa;this.SIi(tb,Math.round(Pb),Va)}AGa(Xa,Pb,Va=null){const tb=this.q8(G.a.events);tb[Za.a.event]=G.a.error;tb[Za.a.module]=Xa;tb[Za.a.errorMessage]=Pb;tb[Za.a.message]=Pb;this.SIi(tb,Math.round(window.performance.now()),Va)}S1m(Xa){const Pb=this.q8(G.a.TEh);Pb[Za.a.value]=Xa;Pb[Za.a.Tbe]=this.Bbb;this.p7.hIa(G.a.TEh,Pb,this.$aa)}l1m(Xa){const Pb=this.q8(G.a.Olh);Pb[Za.a.value]=Xa;Pb[Za.a.Tbe]=this.Bbb;
this.p7.hIa(G.a.Olh,Pb,this.$aa)}N2m(Xa){const Pb=this.q8(G.a.jZh);Pb[Za.a.value]=Xa;Pb[Za.a.Tbe]=this.Bbb;this.p7.hIa(G.a.jZh,Pb,this.$aa)}E4m(Xa){const Pb=this.q8(G.a.B3i);Pb[Za.a.value]=Xa;Pb[Za.a.Tbe]=this.Bbb;this.p7.hIa(G.a.B3i,Pb,this.$aa)}z1m(Xa){const Pb=this.q8(G.a.hij);Pb[Za.a.value]=Xa;this.p7.hIa(G.a.hij,Pb,this.$aa)}I4m(Xa,Pb){const Va=this.q8(G.a.d4i);Va[Za.a.$hc]=Xa;Pb&&(Va[Za.a.dpa]=Pb);this.p7.gIa(G.a.d4i,Va)}q8(Xa){return{["SessionID"]:this.FMa.sessionId,["CorrelationID"]:this.FMa.dpa,
["Time"]:(new Date).getTime(),["Event"]:Xa,["Scenario"]:this.$aa}}}Object(D.a)(Eb,"UsageLogger",null,[1118]);var Jb=c(67),vb=c(1684),ac=c(1213),dc=c(1540),Cc=c(92),Ec=c(28),rc=c(1212),hb=c(632),fb=c(20),Nb=c(753),Fb=c(70),nb=c(13);c.d(I,"TellMeActor",function(){return pb});class pb{constructor(){this.hYa=this.g3=this.Vb=this.Ga=this.fQ=this.Xu=this.Ib=this.ga=this.Le=this.GK=this.FJe=this.clh=this.Zla=this.fc=null;this.$Xb=!1;this.yve=[];this.TNg=[];this.Ijh=[];this.o6g=[];this.p6g=[];this.j1g=!1;
this.SUb=this.Wfa=null;this.Vwc=this.tXa=!1;this.Iqd=!0;this.l_=this.Uvc=this.mWg=this.VJe=this.a6g=null;this.rZ=[];this.S$a=this.uVb=this.SAa=this.Gtd=this.qfh=null;this.pXb=!1;this.OJe=0;this.rUb=null;this.Ita=-1;this.C5g=0;this.cxc=!1;this.uab=null;this.Djh=!1;this.tUb=this.eq=null}get aJd(){return this.fQ?this.fQ.contentType:pb.unknown}get actions(){return this.rZ}set actions(Xa){this.rZ=Xa}STd(){return this.Le?this.Le.Kqa.dpa:null}aP(){return this.fc}get Nbn(){return this.Iqd}get p1o(){return this.a6g}performance(){return this.GK}get xgg(){return this.qfh}set xgg(Xa){this.qfh=
Xa}get $cd(){return this.Djh}set $cd(Xa){this.Djh=Xa}cH(Xa){const Pb=window.performance.now();this.Wfa&&!Y.c(Xa)&&(this.Wfa(Xa),this.Le.OA(G.a.cH,window.performance.now()-Pb))}initialize(Xa,Pb=null,Va=null,tb=null,cb=null,Mb=null,mc=null,Cb=null,Ja=null,Wa=null,xb=null){const {InteractionLogger:ic}=c(1981),{GroupsPlacementInfo:qc}=c(1977),{AggregatorResultsProvider:Lc}=c(1767);this.fc=Xa;this.tXa=!!M.AFrameworkApplication.ua&&M.AFrameworkApplication.ua.Lb.ldc;this.Le=tb;if(!tb){tb=new v;tb.sessionId=
M.AFrameworkApplication.userSessionId;const Ac=Nb.a.qg(M.AFrameworkApplication.lcid)||Nb.a.MUc;this.Le=new ic(new Eb(this.fc.application,Ac.name,tb,this.fc.Er,this.tXa,Xa.GUa,null),this.fc.O4k,this.fc)}this.hYa=new K(this.fc.parameterData);this.clh=Va||new ab(this.fc,this.hYa);this.Wfa=mc;this.FJe=this.FJe||new ia(this.fc,this.fc.parameterData,mc);this.Vb=Jb.FocusManager.instance();this.g3=N.createInstance(this.fc);this.mWg=new qc(Xa);this.ga=cb||M.AFrameworkApplication.va;this.Ib=Mb||M.AFrameworkApplication.oc;
this.Xu=Ja;this.Zla=Pb;this.eq=xb;this.GK=new Ra;this.tUb=new l.a(f.a.jh());this.Gtd=[];Ja?Ja.execute(Ac=>{Ac.isFeatureEnabled(pb.iGo,!0).then(gd=>{const {AggregatorResultsProvider:Md}=c(1767);this.cxc=gd;this.Zla=this.Zla||Md.createInstance(this.g3,this.fc,this.hYa,this.cxc);for(const ie of this.Gtd)this.Zla.QE(ie.provider,ie.J8a);this.Gtd=[];return null})}):(this.cxc=!0,this.Zla=this.Zla||Lc.createInstance(this.g3,this.fc,this.hYa,this.cxc));this.Ga=Cb;this.SAa=ab.ALd;this.a6g=new Promise(Ac=>{this.VJe=
Ac});Wa&&Wa.execute(Ac=>{this.fQ=Ac})}Tb(){this.Jtk()}WTn(Xa){this.Uvc=Xa}Jtk(){this.ga.fb(nb.a.tellMe,Fb.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.fb(nb.a.fkg,Fb.a.frame,Object(a.a)(this,this.yyh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(nb.a.kkg,Fb.a.frame,Object(a.a)(this,this.iJi,"logItemExecuted"),96);this.ga.fb(nb.a.nkg,Fb.a.frame,Object(a.a)(this,this.MIi,"logControlDeactivation"),96);this.ga.fb(nb.a.mkg,Fb.a.frame,Object(a.a)(this,this.eJi,"logInputFocus"),96);this.ga.fb(nb.a.ikg,
Fb.a.frame,Object(a.a)(this,this.y3a,"interactionBegin"),96);this.ga.fb(nb.a.pkg,Fb.a.frame,Object(a.a)(this,this.y3a,"interactionBegin"),96);this.ga.fb(nb.a.lkg,Fb.a.frame,Object(a.a)(this,this.dJi,"logInputBlur"),96);this.ga.fb(nb.a.okg,Fb.a.frame,Object(a.a)(this,this.LIi,"logControlActivated"),96);this.ga.fb(nb.a.Had,Fb.a.frame,Object(a.a)(this,this.p0h,"focusSearchBox"),96);this.ga.fb(nb.a.ekg,Fb.a.frame,Object(a.a)(this,this.RGh,"constructLiveNotificationForMenu"),96);this.ga.fb(nb.a.qkg,Fb.a.frame,
Object(a.a)(this,this.jBf,"insertTryQuery"),96);this.ga.fb(nb.a.zJf,Fb.a.frame,Object(a.a)(this,this.jBf,"insertTryQuery"),96);this.ga.fb(nb.a.njf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.ojf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.pjf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.qjf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.rjf,Fb.a.frame,Object(a.a)(this,this.uSa,
"openOrInsertUrl"),96);this.ga.fb(nb.a.WXf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.XXf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.YXf,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.f_f,Fb.a.frame,Object(a.a)(this,this.t3a,"insertMention"),96);this.ga.fb(nb.a.g_f,Fb.a.frame,Object(a.a)(this,this.t3a,"insertMention"),96);this.ga.fb(nb.a.h_f,Fb.a.frame,Object(a.a)(this,this.t3a,"insertMention"),96);this.ga.fb(nb.a.hkg,
Fb.a.frame,Object(a.a)(this,this.XXi,"openFeedback"),96);this.ga.fb(nb.a.rkg,Fb.a.frame,Object(a.a)(this,this.uSa,"openOrInsertUrl"),96);this.ga.fb(nb.a.B_e,Fb.a.frame,Object(a.a)(this,this.p1d,"launchAddin"),96);this.ga.fb(nb.a.C_e,Fb.a.frame,Object(a.a)(this,this.p1d,"launchAddin"),96);this.ga.fb(nb.a.D_e,Fb.a.frame,Object(a.a)(this,this.p1d,"launchAddin"),96);this.ga.fb(nb.a.HQb,Fb.a.frame,Object(a.a)(this,this.HQb,"showTellMeCoachmark"),96);this.ga.fb(nb.a.UIf,Fb.a.frame,Object(a.a)(this,this.JEi,
"launchAddinStore"),96);this.ga.fb(nb.a.T3f,Fb.a.frame,Object(a.a)(this,this.D4i,"quickActionOnFileHandler"),96);this.ga.fb(nb.a.fmf,Fb.a.frame,Object(a.a)(this,this.L2h,"generateSlidesFromFiles"),96)}TRn(Xa){this.Iqd=!1;const Pb=window.performance.now();Xa.R4a.isCompleted?(this.Iqd=!0,this.VJe(!0)):Xa.t_(()=>{this.Iqd=!0;this.VJe(!0);this.Le.OA(G.a.zjl,window.performance.now()-Pb)});this.FSn(Xa)}FSn(Xa){hb.a.ice(Object(a.a)(this,this.wKd,"dispatcher"));hb.a.uMc([new rc.a(nb.a.tellMe,Fb.a.frame,96),
new rc.a(nb.a.fkg,Fb.a.frame,96),new rc.a(nb.a.kkg,Fb.a.frame,96),new rc.a(nb.a.nkg,Fb.a.frame,96),new rc.a(nb.a.mkg,Fb.a.frame,96),new rc.a(nb.a.ikg,Fb.a.frame,96),new rc.a(nb.a.pkg,Fb.a.frame,96),new rc.a(nb.a.lkg,Fb.a.frame,96),new rc.a(nb.a.okg,Fb.a.frame,96),new rc.a(nb.a.Had,Fb.a.frame,96),new rc.a(nb.a.ekg,Fb.a.frame,96),new rc.a(nb.a.qkg,Fb.a.frame,96),new rc.a(nb.a.zJf,Fb.a.frame,96),new rc.a(nb.a.njf,Fb.a.frame,96),new rc.a(nb.a.ojf,Fb.a.frame,96),new rc.a(nb.a.pjf,Fb.a.frame,96),new rc.a(nb.a.qjf,
Fb.a.frame,96),new rc.a(nb.a.rjf,Fb.a.frame,96),new rc.a(nb.a.WXf,Fb.a.frame,96),new rc.a(nb.a.XXf,Fb.a.frame,96),new rc.a(nb.a.YXf,Fb.a.frame,96),new rc.a(nb.a.f_f,Fb.a.frame,96),new rc.a(nb.a.g_f,Fb.a.frame,96),new rc.a(nb.a.h_f,Fb.a.frame,96),new rc.a(nb.a.hkg,Fb.a.frame,96),new rc.a(nb.a.rkg,Fb.a.frame,96),new rc.a(nb.a.B_e,Fb.a.frame,96),new rc.a(nb.a.C_e,Fb.a.frame,96),new rc.a(nb.a.D_e,Fb.a.frame,96),new rc.a(nb.a.HQb,Fb.a.frame,96),new rc.a(nb.a.UIf,Fb.a.frame,96),new rc.a(nb.a.T3f,Fb.a.frame,
96),new rc.a(nb.a.fmf,Fb.a.frame,96)],Xa)}wKd(Xa,Pb,Va,tb,cb){if(Pb.contextId===Fb.a.frame)switch(Xa){case nb.a.tellMe:return this.tellMe(Xa,Pb,Va,tb,cb);case nb.a.fkg:return this.yyh(Xa,Pb,Va,tb,cb);case nb.a.kkg:return this.iJi(Xa,Pb,Va,tb,cb);case nb.a.nkg:return this.MIi(Xa,Pb,Va,tb,cb);case nb.a.mkg:return this.eJi(Xa,Pb,Va,tb,cb);case nb.a.ikg:return this.y3a(Xa,Pb,Va,tb,cb);case nb.a.pkg:return this.j5n(Va);case nb.a.lkg:return this.dJi(Xa,Pb,Va,tb,cb);case nb.a.okg:return this.LIi(Xa,Pb,Va,
tb,cb);case nb.a.Had:return this.p0h(Xa,Pb,Va,tb,cb);case nb.a.ekg:return this.RGh(Xa,Pb,Va,tb,cb);case nb.a.qkg:case nb.a.zJf:return this.jBf(Xa,Pb,Va,tb,cb);case nb.a.njf:case nb.a.ojf:case nb.a.pjf:case nb.a.qjf:case nb.a.rjf:case nb.a.WXf:case nb.a.XXf:case nb.a.YXf:case nb.a.rkg:return this.uSa(Xa,Pb,Va,tb,cb);case nb.a.f_f:case nb.a.g_f:case nb.a.h_f:return this.t3a(Xa,Pb,Va,tb,cb);case nb.a.hkg:return this.XXi(Xa,Pb,Va,tb,cb);case nb.a.B_e:case nb.a.C_e:case nb.a.D_e:return this.p1d(Xa,Pb,
Va,tb,cb);case nb.a.HQb:return this.HQb(Xa,Pb,Va,tb,cb);case nb.a.UIf:return this.JEi(Xa,Pb,Va,tb,cb);case nb.a.T3f:return this.D4i(Xa,Pb,Va,tb,cb);case nb.a.fmf:return this.L2h(Xa,Pb,Va,tb,cb)}return 2}p0h(Xa,Pb,Va){if(1===Va)return 32;this.Tlj();Xa=!1;(this.fc.GUa||this.tXa)&&(Pb=document.getElementById("SearchButton"))&&Pb.click();if(!this.fc.GUa&&this.tXa)for(Pb=document.getElementsByClassName("ms-suiteux-search-box"),Va=0;Va<Pb.length;Va++){const tb=Pb[Va].querySelector("input[type=search]");
tb&&(Xa=Jb.FocusManager.fK(tb))}else Xa=Jb.FocusManager.fK($get(this.fc.Er?m.CuiHelper.Ggg:m.CuiHelper.Oke));this.Vwc=!0;return Xa?32:8}jBf(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Tlj();Xa=cb.CommandValueId;Pb=this.fc.Er?m.CuiHelper.Ggg:m.CuiHelper.Oke;this.fc.Er&&!Y.c(cb[ac.a.cUa])&&(cb[ac.a.cUa]=!1);if(Xa){if(this.fc.Er)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Xa)),this.uab=
[19],32;if(cb=$get(Pb))cb.value=Xa}return Jb.FocusManager.fK($get(Pb))?32:8}Tlj(){this.Vb.zL(this.fc.GUa||this.tXa?this.fc.mHb:this.fc.Z6a,!1)}YJl(Xa,Pb){switch(Xa){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Pb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Pb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Pb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Pb)}return Pb}RGh(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Xa=this.SAa?this.SAa.cdj:0;cb.Value=1!==Xa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Xa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.SAa)for(const Mb of this.SAa.Xnl)cb=Object(k.a)(W.a,Mb)?Mb.id:Ka.a.replaceAll(Mb.value,'"',""),(cb=$get(cb+"-"+J.a.gkg))&&Ec.a.ir(cb,Ec.a.kga,Ka.a.vf(this.YJl(Mb.groupType,
cb.innerText)));return 32}yyh(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.rUb=new Cc.a(2,1,0,()=>{cb[vb.a.Callback]()},97);this.SAa&&this.Ib.Xb(this.rUb);return 32}iJi(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;cb.CloseAllMenus&&(Xa=void 0===cb.ParentControlId||null===cb.ParentControlId?"<NA>":cb.ParentControlId,
Pb=this.SUb?this.SUb[cb.ControlId]:null,!Pb&&this.SUb&&"<NA>"!==Xa&&(Pb=this.SUb[Xa]),Pb||(Pb=this.$Xb&&this.g3.aIm(cb),Pb=this.Tkl(Pb,cb.ControlId),Pb=new r(Pb,32,4,-1,-1,-1),this.Le.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+cb.ControlId+" determined group:"+O.a[Pb.groupType])),this.Le.Vjn(cb.ControlId,Xa,cb.CommandId,cb.CloseAllMenus,Pb),this.hYa.Zfn(cb.ControlId),cb.Location!==fa.a.contextMenu&&(this.g3.RZa(cb),this.g3.QE(Pb.resultType),this.fc.Hhe&&this.Zla.xrk(cb.CommandId)));
return 32}MIi(Xa,Pb,Va,tb,cb){if(1===Va)return 32;(new xa(this.STd())).F9l(this.uVb);Xa=this.uVb;Pb=this.Ita;Va=this.Le.wid;if(Y.c(cb))return this.Le.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;cb=cb.UILocation;Xa&&0<Xa.length&&this.cxc&&J.a.Ceg(this.fc)&&this.fc.n0d&&19!==cb&&Pb>Va&&!this.fc.PP&&(this.Le.hMf(Xa),this.Le.Qbg(Pb));this.Le.W3n();this.fc.Xne&&19!==cb&&(this.GK.mark(3),this.GK.measure(1,0,3),this.GK.measure(2,2,3),this.GK.XLf(0,1,2),this.GK.XLf(2,2,3),this.GK.XLf(1,
0,3),this.GK.TWk(),this.GK.clearMeasures([0,2,1]));this.Le.Bkn(window.performance.now()-this.OJe);this.fc.Er&&(this.S$a=null,this.Le.iya());this.Vwc=this.pXb=!1;this.uVb="";return 32}eJi(Xa,Pb,Va){if(1===Va)return 32;this.Le.fnb(z(Pb),this.Vwc);return 32}dJi(Xa,Pb,Va){if(1===Va)return 32;this.Le.iya();this.pXb=!1;return 32}LIi(Xa,Pb,Va,tb,cb){if(1===Va)return 32;this.l_=null;cb&&(this.l_=cb);this.fc.Xne&&(Y.c(this.l_)||this.l_.Location!==fa.a.contextMenu)&&this.GK.mark(0);this.Le.Gge(Y.c(this.l_)||
Y.c(this.l_.Location)?fa.a.unknown:this.l_.Location);this.Le.Akn(this.C5g,this.Vwc);this.pXb||this.I5a();return 32}vKh(Xa,Pb){const Va=[],tb=Date.now();for(let cb of Xa)Xa=(tb-cb.timeStamp)/1E3,Xa=J.a.bme(Xa),Array.add(Va,new T(Pb?cb.commandId:cb.controlId,Xa));return Va}eel(Xa){const Pb=[],Va=Date.now();for(let tb of Xa)if(tb.controlId||"keyboardShortcut"===tb.commandSurface)Xa=(Va-tb.timeStamp)/1E3,Xa=J.a.bme(Xa),Array.add(Pb,new Z(tb.controlId,tb.commandId,Xa,tb.commandSurface,tb.Ske));return Pb}gLh(Xa=
!1){var Pb=Xa?this.g3.z9l():this.g3.mPc();Xa=[];const Va=Date.now();for(const tb of Pb)Pb=(Va-tb.TimeStamp)/1E3,Pb=J.a.bme(Pb),Array.add(Xa,new T(tb.Id,Pb));return Xa}I5a(){if(!this.pXb){this.$Xb=this.pXb=!0;""!==this.fc.dag&&M.AFrameworkApplication.$n(this.fc.dag);if(!this.j1g){this.j1g=!0;const Xa={};Xa.IsMLREnabled=this.fc.eOm;Xa.IsReactRibbonEnabled=this.fc.Er;Xa.IsSharedHeaderEnabled=!!M.AFrameworkApplication.ua&&M.AFrameworkApplication.ua.Lb.IJ;Xa.IsSearchUxEnabled=this.tXa;Xa.IsTellMeInHeaderEnabled=
this.fc.GUa;Xa.IsGoLocalEnv=J.a.qLm();Xa.IsSovereignEnvironment=J.a.qdc();Xa.IsTellMeServiceResultsEnabled=J.a.Ceg(this.fc);Xa.IsSubstrateProviderEnabled=J.a.Beg(this.fc);Xa.ShouldFetchTokens=!!M.AFrameworkApplication.ua&&M.AFrameworkApplication.ua.Lb.pQb;Xa.IsSerpletEnabled=J.a.xpa();Xa.FirstOnClickTimeInMS=Math.round(window.performance.now());Xa.IsHeaderHidden=M.AFrameworkApplication.hideHeader||M.AFrameworkApplication.fY;Xa.IsSearchInHeaderHidden=M.AFrameworkApplication.ISc;void 0!==window.performance.timing&&
null!==window.performance.timing&&(Xa.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Xa.IsFindWithMatchesEnabled=this.fc.ANd;Xa.HelpShowsTopSearchResult=this.fc.B9c;Xa.HelpShowsNumberOfMatches=this.fc.A9c;M.AFrameworkApplication.K&&(Xa.UiHost=M.AFrameworkApplication.K.kb("UiHostIntegrationType"));this.Le.$4m(JSON.stringify(Xa))}this.yve=this.vKh(y.a.instance.dPc(),!1);this.TNg=this.vKh(y.a.instance.bib(),!0);this.Ijh=this.eel(y.a.instance.bib());this.o6g=this.gLh();
this.p6g=this.gLh(!0);this.Le.I5a()}}y3a(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(fb.a.fWc)return 32;this.OJe=window.performance.now();this.I5a();Xa=new ba(Object(a.a)(this,this.oya,"onRequestCompleted"),0);this.Ita++;this.Le.beginQuery("",this.Ita,this.$Xb);this.Xng(!0,null);this.SAa=ab.ALd;this.S$a=ia.Kgf;if(this.Zla)pb.instance.actions=[],this.Zla.ZH(new V("",this.Ita),Xa,this.fc.Er);else this.Le.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.rUb&&this.Ib.Xb(this.rUb);return 32}j5n(Xa){if(1===Xa)return 32;this.Vb.dS(this.fc.GUa||this.tXa?this.fc.mHb:this.fc.Z6a,!1);return 32}tellMe(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:TellMe","actiondata comes null"),16;this.l_=cb;this.Le.Gge(Y.c(this.l_.Location)?fa.a.unknown:this.l_.Location);Xa=this.l_.Value;this.fc.Er||Xa&&""!==Xa.trim()?(!this.S$a&&this.fc.Er&&(this.Le.fnb(z(Pb),this.Vwc),this.I5a()),this.lxl(Xa,
this.l_.Location),this.l_.PopulationXML=this.SAa.xml):this.$Xb?this.l_.PopulationXML=this.SAa.xml:(this.l_.PopulationXML=ab.ALd.xml,this.S$a=ia.Kgf,this.uVb="");return 32}lxl(Xa,Pb){this.OJe=window.performance.now();this.fc.Xne&&Pb!==fa.a.contextMenu&&this.GK.mark(1);this.fc.Er&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Xa));Xa&&0<Xa.trim().length&&(this.$Xb=!1);this.fc.Jvl();Pb=Y.c(Pb)?fa.a.tellMe:Pb;if(Xa!==this.uVb||this.fc.Er){this.Ita++;this.Le.beginQuery(Xa,this.Ita,this.$Xb);
this.Xng(!0,null);const Va=new V(Xa,this.Ita),tb=new ba(Object(a.a)(this,this.oya,"onRequestCompleted"),this.Ita);this.SAa=ab.ALd;this.S$a=ia.Kgf;if(this.Zla)pb.instance.actions=[],this.Zla.ZH(Va,tb,this.fc.Er,Pb,this.uab),this.uab=null;else this.Le.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.C5g=this.Ita;this.uVb=Xa}}HUo(Xa){if(this.fc.Er){var Pb=appChrome.selectors.getActiveControlStates();if(Pb=Object(x.a)(Object,Pb[Xa.value])){Xa.label=Pb.label;let Va=
null;"description"in Pb&&(Va=Pb.description);Va&&Object.getType(Va)===String?Xa.description=Va:"secondaryText"in Pb?Xa.description=Pb.secondaryText:"fullDescriptionLabel"in Pb&&(Xa.description=Pb.fullDescriptionLabel)}}}MBn(Xa){this.SUb={};let Pb=0,Va=0;for(const tb of Xa){Xa=0;for(const cb of tb.results)this.SUb[cb.value]=new r(cb.groupType,cb.type,cb.Zuj,Pb,Xa,Va),Xa++,Va++,cb.label||5!==cb.type||this.HUo(cb);0<Xa&&Pb++}}Lgc(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(Xa=cb.CommandValueId)&&window.open(Xa,"_blank");return 32}XEi(Xa){const Pb={};Pb.token=this.xgg;Pb.files=ra.c(Xa);Pb.type="MultiFilesDeckGeneration";if(M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Rb(nb.a.hYm,2,Pb),!0;Xa=J.a.Ufi("",J.a.edj("GenerateDeckFromFile"),Object.assign(new dc.a,{landingTab:"All",data:Pb}));Xa=this.ga.Rb(nb.a.g9,2,Xa);return 32!==Xa?(this.Le.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+Xa+"."),!1):!0}D4i(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Vb.Hkf();if(Xa=cb.TerminalParentControlId){Xa=this.tUb.J(Xa);if(!Xa)return 16;Pb=[];Array.add(Pb,Xa);if(!this.XEi(Pb))return 8}return 32}L2h(){if(!this.tUb.count)return 16;const Xa=[];for(let Pb of this.tUb.values)Array.add(Xa,Pb);return this.XEi(Xa)?32:8}t3a(Xa,Pb,Va,tb,cb){if(1===Va)return 32;
if(Y.c(cb))return this.Le.onError("TellMeActor:InsertMention","actiondata comes null"),16;Xa=cb.UILocation;let Mb;cb=cb.CommandValueId;try{Mb=ra.a(cb)}catch(mc){return this.Le.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Y.c(Mb)?(this.Le.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Y.c(this.Uvc)?(this.Le.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Xa?(this.Le.onError("TellMeActor:InsertMention",
"location "+Xa+" is unexpected"),16):this.Uvc.t3a(Mb.displayName,Mb.email,Mb.userId)?32:(this.Le.onError("TellMeActor:InsertMention","mention is not inserted"),16)}uSa(Xa,Pb,Va,tb,cb){return 1===Va?32:Y.c(cb)?(this.Le.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===cb.UILocation?this.QCm(Va,cb):this.Lgc(Xa,Pb,Va,tb,cb)}XXi(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.eq&&window.setTimeout(()=>
{this.eq.execute(Mb=>{Mb.AIa("TellMeSurvey",null)})},pb.tzl);return 32}QCm(Xa,Pb){if(1===Xa)return 32;if(Y.c(Pb))return this.Le.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Y.c(this.Uvc))return this.Le.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Xa=Pb.CommandValueId;return Y.c(Xa)?(this.Le.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Uvc.insertHtmlText(Xa)?32:(this.Le.onError("TellMeActor:InsertUrl","url is not inserted"),16)}oya(Xa,
Pb,Va,tb,cb){Va=window.performance.now();this.MBn(Pb);this.Le.Hho(Pb);this.fc.Er?(this.S$a=this.FJe.rJl(Pb,Xa,cb),this.fc.Pwa?(this.rZ.push(appChrome.actions.updateTellMeSearchResults(this.S$a.menuModel,Xa,cb)),appChrome.api.dispatch(this.rZ)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.S$a.menuModel,Xa,cb)),this.fc.Xne&&this.pXb&&(Y.c(this.l_)||this.l_.Location!==fa.a.contextMenu)&&(this.GK.mark(2),this.GK.measure(0,1,2))):this.SAa=this.clh.sJl(Pb,this.Le.Kqa);this.rUb&&
this.Ib.Xb(this.rUb);cb={};cb.GroupsCount=Pb.length;cb.QueryID=tb;cb.QueryLength=Xa.length;this.Le.OA(G.a.acl,window.performance.now()-Va,cb)}Tkl(Xa,Pb){return Pb.startsWith(this.fc.Er?J.a.Lmg:J.a.rme)?5:Xa?4:"bSearchHelp"===Pb||Pb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Pb||Pb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Pb?24:Pb===this.fc.Djf?2:0}QE(Xa,Pb){this.Zla?this.Zla.QE(Xa,Pb):Array.add(this.Gtd,new F(Xa,Pb))}JEi(Xa,Pb,Va,tb,cb){if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Xa={};Xa.SourceControlId=cb.SourceControlId;Xa.Query=cb.CommandValueId;cb=this.ga.Rb(nb.a.JYc,2,Xa);if(32!==cb)this.Le.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+cb+".");return cb}return this.ga.Rb(nb.a.JYc,2,cb)}p1d(Xa,Pb,Va,tb,cb){({AddinResultsProvider:Xa}=c(1658));if(1===Va)return 32;if(Y.c(cb))return this.Le.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;Va=cb.CommandValueId;if(Y.b(Va))return this.Le.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Xa.AAb[Va])return this.Le.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Va+" doesn't not exist in entitlements"),16;cb=c(1658).AddinResultsProvider.AAb[Va];Xa={};Xa.solutionId=cb.id;Xa.version=cb.appVersion;Xa.storeType=cb.storeType;Xa.storeId=cb.storeId;Xa.assetId=cb.assetId;Xa.assetStoreId=cb.assetStoreId;Xa.displayName=cb.displayName;Xa.targetType=
cb.targetType;Xa.height=cb.height;Xa.width=cb.width;cb=this.ga.Rb(nb.a.WAf,2,Xa);if(32!==cb)this.Le.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+cb+". AssetId: "+Va);return cb}HQb(){if(!Y.c(this.eq))for(let Xa of y.a.instance.bib()){if("ShowContextMenuWithFloatie"===Xa.commandId)return this.eq.execute(Pb=>{Pb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Xa.commandId&&-1===Xa.commandId.indexOf("Tab"))break}return 8}Xng(Xa,Pb="",Va=null){Xa?
this.tUb=new l.a(f.a.jh()):Pb&&Va&&this.tUb.add(Pb,Va)}static get instance(){return pb._instance||(pb._instance=new pb)}}pb._instance=null;pb.iGo="mso_tellMeService";pb.unknown="Unknown";pb.tzl=500;Object(D.a)(pb,"TellMeActor",null,[])},1505:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(1519);class f{constructor(a,k){this.Cbb=!1;const {Annotations:x}=c(1499);if(!a)throw Error.argumentNull("annotations");if(!a.DHf(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.oI(k))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.xw=a;this.j$j=k;this.kp=[]}get x2b(){return this.xw}get isReadOnly(){return this.Cbb}get W4(){return this.j$j}get items(){return this.kp}zea(){const {Annotations:a}=c(1499);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=", ");const m=this.xw.zea(this.W4,this.items[x]);this.W4===a.Q$?(k+='"',k+=l.a.Yhf(m),k+='"'):k+=m}return k+"]"}isEqual(a){const {Annotations:k}=c(1499);if(this===a)return!0;if(!a||a.x2b!==this.xw||a.W4!==this.W4||a.items.length!==
this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.Brb(this.W4,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new f(this.xw,this.W4);Array.addRange(a.items,this.items);return a}KT(){return this.isReadOnly?this.clone():this}vLf(){const {Annotations:a}=c(1499);if(!this.isReadOnly){this.Cbb=!0;for(const k of this.items)a.FKb(k)}}toString(){return this.zea()}}Object(D.a)(f,"ListValue",null,[1244,1243])},1506:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}
l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(D.a)(l,"TellMeScenario",null,[])},1508:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k=null,x=null,y=4,m=-99999,r=0){this.XI="";this.GBd=-1;this.value=f;this.type=a;this.Zuj=y;this.label=this.fD=k;this.groupType=30;this.description=x;this.score=m;this.count=r}}Object(D.a)(l,"ResultBinding",null,[])},1510:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.attributes=
null;this.query=f;this.uo=[]}$u(f){this.uo.push(f)}$9i(f){const a=[];for(const k of this.uo)k.groupType!==f&&a.push(k);this.uo.length!==a.length&&(this.uo=a)}get Wcc(){return!1}}Object(D.a)(l,"SimpleResultsUpdatedEventArgs",null,[1097])},1511:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f=30,a=""){this.jM=[];this.groupType=f;this.displayName=a}get results(){return this.jM}Rw(f){f.groupType=this.groupType;Array.add(this.results,f)}X6f(f=1){if(this.results.length>=f)for(let a=
0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(l,"SimpleResultGroup",null,[1098])},1519:function(D,I,c){D=c(0);class l{constructor(a,k){this.Keb=a;this.value=k}}Object(D.a)(l,"AttrValuePair",null,[]);c.d(I,"a",function(){return f});class f{constructor(a){this.Cbb=!1;if(!a)throw Error.argumentNull("annotations");this.xw=a;this.EY=[]}get x2b(){return this.xw}get isReadOnly(){return this.Cbb}get mxf(){return 0<this.EY.length}Jq(a){if(!this.xw.Ddc(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.EY)if(a===k.Keb)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}Vy(a,k){var {Annotations:x}=c(1499);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.xw.Ddc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.xw.Ccc(this.xw.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.FKb(k);
for(x=0;x<this.EY.length;++x){const y=this.EY[x];if(a===y.Keb){y.value=k;return}}Array.add(this.EY,new l(a,k))}hTa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.xw.Ddc(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.EY.length;++k)if(a===this.EY[k].Keb){Array.removeAt(this.EY,k);break}}uOd(a){if(!a)throw Error.argumentNull("action");for(const k of this.EY)a(k.Keb,k.value)}clone(){const a=new f(this.xw);
a.i0a(this);return a}i0a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.x2b!==this.xw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.EY);a.uOd((k,x)=>{this.Vy(k,x)})}zea(){const {Annotations:a}=c(1499);let k="[",x=!0;for(const y of this.EY){x?x=!1:k+=", ";k+=this.xw.V3h(y.Keb);k+="=";const m=this.xw.getAttributeType(y.Keb),r=this.xw.zea(m,y.value);m===a.Q$?(k+=
'"',k+=f.Yhf(r),k+='"'):k+=r}return k+"]"}isEqual(a){const {Annotations:k}=c(1499);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.xw!==a.x2b||this.mxf!==a.mxf)return!1;let x=0,y=null,m=!1;a.uOd((r,z)=>{++x;if(!m){var v=-1;for(let G=0,F=this.EY.length;G<F;++G)if(this.EY[G].Keb===r){v=G;break}0>v?m=!0:(y||(y=Array(this.EY.length)),y[v]=z)}});if(this.EY.length!==x||m)return!1;for(let r=0,z=this.EY.length;r<z;++r)if(!k.Brb(this.xw.getAttributeType(this.EY[r].Keb),this.EY[r].value,
y[r]))return!1;return!0}KT(){return this.isReadOnly?this.clone():this}vLf(){const {Annotations:a}=c(1499);if(!this.isReadOnly){this.Cbb=!0;for(const k of this.EY)a.FKb(k.value)}}toString(){return this.zea()}static Yhf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(f,"FeatureBundle",null,[1242,1243])},1524:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.click="Click";l.y3a="InteractionBegin";l.mIb="InteractionEnd";l.WHh="ControlActivated";
l.query="Query";l.d4i="QueryIndexRecorded";l.TEh="Clicks";l.Olh="ActionEvents";l.jZh="FilteredActionEvents";l.hij="SessionContext";l.latency="Latency";l.performance="Performance";l.Taj="RenderedResults";l.events="Events";l.acl="CreateResultsMenu";l.cH="UpdateRibbonControls";l.A5n="ResultsAggregation";l.ZH="IssueQuery";l.v_k="CommandSuggestions";l.error="Error";l.fLf="LoadModelData";l.zjl="DepsResolveTime";l.Obn="ModelDataWaitTime";l.timedOut="TimedOut";l.cyk="AddinQueryCommandReady";l.BKl="GetAddinEntitlements";
l.B3i="ProviderMRUEvents";l.Xsl="EnableAddinSearchCommands";Object(D.a)(l,"EventNames",null,[])},1528:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.eNf=null;this.kda=this.gNf=0}Dlf(f,a,k){if(!f)throw Error.argumentNull("referenceList");if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>f.length)throw Error.argumentOutOfRange("length");if(a+k>f.length)throw Error.argument("Invalid start-length range");this.eNf=f;this.gNf=a;this.kda=k}Xhb(f,
a,k){this.Dlf(f.eNf,f.gNf+a,k)}J(f){if(0>f||f>=this.kda)throw Error.argumentOutOfRange("index");return this.eNf[this.gNf+f]}get count(){return this.kda}static Jaf(f){const a=new l;a.Dlf(f,0,f.length);return a}}Object(D.a)(l,"ReadOnlyList",null,[1261])},1535:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.Classifier=0]="Classifier";f[f.AppsForOffice=1]="AppsForOffice";f[f.FindInDocument=2]="FindInDocument";f[f.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
f[f.RecentlyUsed=4]="RecentlyUsed";f[f.TryQuery=5]="TryQuery";f[f.Empty=6]="Empty";f[f.TryCommand=7]="TryCommand";f[f.Assistance=8]="Assistance";f[f.Answer=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.WolframAnswer=12]="WolframAnswer";f[f.Insights=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.Recommended=16]="Recommended";f[f.ServiceClassifier=17]="ServiceClassifier";f[f.ServiceRecommended=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=
20]="Notes";f[f.Learning=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.ActionAI=24]="ActionAI";f[f.ActionAICommand=25]="ActionAICommand";f[f.SummarizeDeck=26]="SummarizeDeck";f[f.Addin=27]="Addin";f[f.OfficeScript=28]="OfficeScript";f[f.AddinStoreEntry=29]="AddinStoreEntry";f[f.None=30]="None";f[f.MergedActions=31]="MergedActions";f[f.MergedScopedSearches=32]="MergedScopedSearches";f[f.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(D.b)("ResultGroupType",
l)},1541:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1595);class l extends c.a{constructor(){super();this.info=this.uj=this.eventId=null}get fha(){return"Misc"}BFb(){this.detail.Z("Type",this.fha);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.uj);this.detail.Z("Info",this.info);return this.detail}}Object(D.a)(l,"BasicMergeFailureDetail",c.a,[])},1542:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(608),f=c(811),a=c(1559);class k{constructor(x,y=!0){this.zm=
y&&x?x.UK():x;this.I0b=new l.a}zC(x){this.I0b.add(f.a.Ab(x))}emo(x){this.I0b=x}lNi(x){this.zm&&(new a.a(this.zm,x)).Gqa.forEach((y,m)=>{m.tY&&!this.I0b.contains(y)&&(this.I0b.add(y),m.isDeleted?(m=this.zm,m.hasProperty(f.a.KX(y))&&m.removeProperty(f.a.KX(y))):this.zm.RTa(f.a.KX(y),m.newValue));return!0})}}Object(D.a)(k,"PartialMergeResult",null,[])},1543:function(D,I,c){c.r(I);c.d(I,"CommandResultsUtility",function(){return z});D=c(0);var l=c(1554),f=c(1524),a=c(1555),k=c(1508),x=c(1511),y=c(1504),
m=c(1503),r=c(2);class z{static mcd(v,G){if(G&&G.Er){const F={};for(const H of v)G.F0d(H)&&(F[H]=appChrome.selectors.getModelType(H));y.TellMeActor.instance.cH(F)}}static tGo(v){return v.startsWith("btnTellMeOfficeAddIn")}static lVc(v){const G=y.TellMeActor.instance.aP();return!!G&&G.Er&&!appChrome.selectors.isControlDisabled(v)}static m2d(v,G,F,H){if(y.TellMeActor.instance.Le&&v){const L=[];for(const J of v)L.push(String.format('{{"Id":"{0}","Score":{1}}}',J.commandId,J.score));v={};v[l.a.suggestions]=
"[{"+L.join(",")+"}]";v[l.a.tDi]=G;v[l.a.groupType]=F;v[l.a.provider]=H;y.TellMeActor.instance.Le.OA(f.a.v_k,window.performance.now(),v)}}static CRl(v,G){const F=[],H=[];for(const L of G){G=L.commandId;let J=L;L.commandId in v&&(G=v[L.commandId],J=new a.a(G,L.score));Array.contains(H,G)||(F.push(J),H.push(G))}return F}static WQc(v,G,F,H,L,J,M,P){F.kof&&(G=z.CRl(F.kof,G));var N=m.a.TPl(G);z.mcd(N,F);var K=[],O=[];N=[];const V=new x.a(M);M=16===M||18===M||7===M||4===M?r.AFrameworkApplication.K?r.AFrameworkApplication.K.lc("TellMeMaxRecommendedResultsToReturn",
3):3:0===M||17===M||25===M?5:0;for(const W of G)if(!z.ZHm(W.commandId)){G=z.tGo(W.commandId);if(F.F0d(W.commandId)&&!G){if(m.a.cCi(W.commandId))continue;G=null;L&&J&&(G=L.g7l(W.commandId,J));z.lVc(W.commandId)?Array.add(K,new k.a(W.commandId,5,G,null,P,W.score)):Array.add(O,new k.a(W.commandId,5,G,null,P,W.score))}else F.IAb&&G&&H&&Array.add(N,W.commandId.substr(21));if(K.length+N.length>=M)break}F=0;for(L=0;L<K.length&&F<M;L++,F++)V.Rw(K[L]);for(K=0;K<O.length&&F<M;K++,F++)V.Rw(O[K]);for(O=0;O<N.length&&
F<M;O++,F++)H.Xrp(v,N[O],V);return V}static ZHm(v){z.Mvh||(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.ow("TellMeControlPredictionBlockList")&&r.AFrameworkApplication.K.BB("TellMeControlPredictionBlockList").forEach(G=>{Array.add(z.Lvh,G.toLowerCase())}),z.Mvh=!0);return Array.contains(z.Lvh,v.toLowerCase())}static vCf(v){return 2<v.length&&";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&!!r.AFrameworkApplication.K&&(r.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static M5h(v){const G=new x.a(0);var F=v.split(";");v=y.TellMeActor.instance.aP();for(const H of F)if(0<H.length){F=H.split(":");const L=2===F.length?F[0]:H;if(!v.F0d(L))break;if(1===F.length)F=new k.a(L,5,null,null,1),G.Rw(F);else if(2===F.length)F=new k.a(L,5,F[1],null,1),G.Rw(F);else break}return G}static $qk(v,G,F){if(!(G&&G.results&&v&&v.results&&v.results.length))return{returnValue:!1,GYe:v,xZe:G};const H=[];for(var L of G.results)Array.add(H,L.value);L=0;const J=0<G.results.length?G.results[0].score:
0;for(const M of v.results)if(M.score>F&&!Array.contains(H,M.value)&&z.lVc(M.value)&&(0<J&&(M.score=J),Array.insert(G.results,L,M),L++),2===L)break;return 0<L?(F=G.results.length-5,0<F&&G.X6f(F),{returnValue:!0,GYe:v,xZe:G}):{returnValue:!1,GYe:v,xZe:G}}}z.Mvh=!1;z.Lvh=[];Object(D.a)(z,"CommandResultsUtility",null,[])},1553:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static lIo(f){return f.toString().charCodeAt(0)}static iTm(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static Qth(f,
a){if(f===a)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static Pth(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=l.cbj(f);a=l.cbj(a);return f===a}static cbj(f){return f.replace(l.p_c," ")}static mqb(f,a,k){return f.substring(a,a+k)}}l.p_c=RegExp("\u00a0","g");Object(D.a)(l,"CharUtils",null,[])},1554:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.appName="AppName";l.S3="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture=
"Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.dpa="CorrelationID";l.$xn="ParentUiElement";l.query="Input";l.LNb="QueryID";l.i4i="QueryLength";l.$hc="QueryIndex";l.B5n="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.VBj="UiElement";l.Tbe="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.ZIo="TokenAcquired";l.OXm="LatencyType";l.groupName="GroupName";
l.Y8="GroupIndex";l.groupType="GroupType";l.x5n="ResultInfoList";l.resultType="ResultType";l.wig="SubResultType";l.zMm="IsInputBlur";l.AMm="IsInputFocus";l.tSm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.jrl="DwellTime";l.tDi="IsZeroTerm";l.A5o="WordsCount";l.P_d="IsSearchUxEnabled";l.ITm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.Oef="DisplayIndex";l.ftl="EnableList";l.provider="Provider";l.contentType="ContentType";l.RRm="IsSelectionBased";l.rIk="BeginPerformanceMarker";
l.Gtl="EndPerformanceMarker";l.bAn="PerformanceMeasure";Object(D.a)(l,"Columns",null,[])},1555:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.commandId=f;this.score=a}}Object(D.a)(l,"CommandSuggestion",null,[])},1559:function(D,I,c){D=c(0);var l=c(365),f=c(811),a=c(247),k=c(54);class x{constructor(m,r,z){this.iek=m;this.Cak=r;this.V$j=z;this.KEe=new a.a(Object(k.a)(this,this.pUk,"checkIfDifferent"))}get gob(){return this.iek}get oldValue(){return this.Cak}get newValue(){return this.V$j}get okb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get tY(){return this.okb||this.isDeleted||this.KEe.value}pUk(){return this.okb||this.isDeleted?!0:!f.a.Wth(this.gob,this.oldValue,this.newValue)}}Object(D.a)(x,"PropertyDiff",null,[]);c.d(I,"a",function(){return y});class y{constructor(m,r){this.zak=m;this.S$j=r;this.KEe=new a.a(()=>this.wVc());this.kek=
new a.a(Object(k.a)(this,this.uwl,"evaluatePropertyDiffs"))}get su(){return this.zak}get tf(){return this.S$j}get okb(){return!!this.tf&&!this.su}get isDeleted(){return!this.tf&&!!this.su}get tY(){return this.okb||this.isDeleted||this.KEe.value}get Gqa(){return this.kek.value}wVc(m=null){let r=!1;this.Gqa.forEach((z,v)=>{r=v.tY&&(!m||7!==m.J(z));return!r});return r}uwl(){const m=new l.a;var r=this.tf,z=this.su;if(this.okb){z=r.Jl();for(var v=0;v<z.length;v++){var G=z[v];m.Z(f.a.Ab(G),new x(G,null,
r.VX(G)))}}else if(this.isDeleted)for(r=z.Jl(),v=0;v<r.length;v++)G=r[v],m.Z(f.a.Ab(G),new x(G,z.VX(G),null));else{v=z.Jl();for(G=0;G<v.length;G++){var F=v[G],H=f.a.Ab(F),L=z.VX(F);const J=r.hasProperty(F)?r.VX(F):null;m.Z(H,new x(F,L,J))}v=r.Jl();for(G=0;G<v.length;G++)F=v[G],z.hasProperty(F)||(H=f.a.Ab(F),L=r.VX(F),m.Z(H,new x(F,null,L)))}return m}}Object(D.a)(y,"MergeableObjectDiff",null,[])},1568:function(D,I,c){c.d(I,"b",function(){return x});c.d(I,"a",function(){return m});var l=c(224),f=c(365),
a=c(608),k=c(1725);const x=(z,v,G)=>{const F=y(z,v,G);let H=0,L=0,J=0,M=new k.a;const P=new l.a;for(let N=0;N<F.length;N++){const K=F.Zf(N+1);M.bCd(z.Zf(H));M.dCd(v.Zf(L));M.hCd(G.Zf(J));H++;L++;for(J++;H<z.length&&(!K||!K.equals(z.Zf(H)));)M.bCd(z.Zf(H)),H++;for(;L<v.length&&(!K||!K.equals(v.Zf(L)));)M.dCd(v.Zf(L)),L++;for(;J<G.length&&(!K||!K.equals(G.Zf(J)));)M.hCd(G.Zf(J)),J++;P.add(M);M=new k.a}for(;H<z.length;)M.bCd(z.Zf(H)),H++;for(;L<v.length;)M.dCd(v.Zf(L)),L++;for(;J<G.length;)M.hCd(G.Zf(J)),
J++;M.isEmpty||P.add(M);return P},y=(z,v,G)=>{const F=new l.a,H=v.ZG(),L=G.ZG();z.forEach(J=>{H.contains(J)&&L.contains(J)&&F.add(J);return!0});return F},m=(z,v,G)=>{z=z||new l.a;v=v||new l.a;G=G||new l.a;const F=new l.a,H=new f.a(0),L=new a.a;for(var J=0;J<z.length;J++){var M=z.Zf(J);H.Z(M,J)}for(z=J=0;J<v.length&&z<G.length;){M=v.Zf(J);let P=G.Zf(z),N=H.Cz(M,-1),K=H.Cz(P,-1);-1===N?(r(L,F,M),J++):-1===K?(r(L,F,P),z++):N===K?(r(L,F,M),J++,z++):N<K?J++:z++}for(;J<v.length;J++)M=v.Zf(J),-1===H.Cz(M,
-1)&&r(L,F,M);for(;z<G.length;z++)v=G.Zf(z),-1===H.Cz(v,-1)&&r(L,F,v);return F},r=(z,v,G)=>{z.contains(G)||(v.add(G),z.add(G))}},1569:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(60);class f{constructor(){this.cp=0;this.id=l.a.create()}}Object(D.a)(f,"LcsUpdateHint",null,[1289,72])},1570:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.$hc="QueryIndex";l.Swj="TellMeRanker";l.Twj="TellMeRankerLogging";Object(D.a)(l,
"Services",null,[])},1571:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.lQa="HttpRequest";l.provider="Provider";Object(D.a)(l,"LatencyTypes",null,[])},1575:function(D,I,c){D=c(0);var l=c(16),f=c(6),a=c(224),k=c(179),x=c(241),y=c(60),m=c(608),r=c(54),z=c(237),v=c(1595);class G extends v.a{constructor(){super();this.BTa=null}get fha(){return"CreateMergeBlock"}BFb(){this.detail.Z("Type",this.fha);this.detail.Z("Revision",this.BTa);return this.detail}}Object(D.a)(G,"CreateMergeBlockFailureDetail",
v.a,[]);var F=c(1641),H=c(1643),L=c(1724),J=c(1596),M=c(1542),P=c(1788);c.d(I,"a",function(){return N});class N{static rId(K,O,V,W,T,Y,ba){let Z;Z="";const ea=new a.a;for(let la=0;la<V.length;la++){var ha=void 0;let ia;ha=F.a.URl(O,V.J(la),W,T,Y,ba,K);if(!ha)return{returnValue:null,i5a:Z};({gOf:ia,i5a:ha}=ha.Xai());if(!ia)return{returnValue:null,i5a:Z};Z+=ha;ea.aD(ea.length,ia)}return{returnValue:ea,i5a:Z}}static jLh(K,O,V,W,T,Y,ba,Z){let ea,ha,la,ia,sa,Oa;Oa=sa=ia=la=ha=ea=null;({i5a:ia,returnValue:ea}=
N.rId(O,Ra=>K.runtime.sk.J(Ra),V,1,Y,ba,Z));if(!ea)return k.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),K.logger.Pg(Object.assign(new G,{BTa:"Base"})),{returnValue:!1,MK:ea,gNc:ha,fcd:la,ZCd:ia,dNd:sa,Ome:Oa};({i5a:sa,returnValue:ha}=N.rId(O,Ra=>K.runtime.Ku.J(Ra)||K.runtime.sk.J(Ra),W,2,Y,ba,Z));if(!ha)return k.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
K.logger.Pg(Object.assign(new G,{BTa:"Favored"})),{returnValue:!1,MK:ea,gNc:ha,fcd:la,ZCd:ia,dNd:sa,Ome:Oa};({i5a:Oa,returnValue:la}=N.rId(O,Ra=>K.runtime.Kq.J(Ra)||K.runtime.sk.J(Ra),T,4,Y,ba,Z));return la?{returnValue:!0,MK:ea,gNc:ha,fcd:la,ZCd:ia,dNd:sa,Ome:Oa}:(k.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),K.logger.Pg(Object.assign(new G,{BTa:"Unfavored"})),{returnValue:!1,
MK:ea,gNc:ha,fcd:la,ZCd:ia,dNd:sa,Ome:Oa})}static REh(K,O=!1){const V=new a.a;let W=0;for(;W<K.length;){var T=K.J(W);if(1===T.type||4===T.type||2===T.type)V.add(T),W++;else if(3===T.type){let ba="";ba+=T.character;W++;let Z=T.aRa,ea=!1;for(;W<K.length;W++){var Y=K.J(W);3===Y.type?T.runId===Y.runId&&T.rJ.equals(Y.rJ)&&(T.xca===Y.xca||T.rFa===Y.rFa)&&T.DF.IA(Y.DF)&&(!O||T.ku&&T.ku.equals(Y.ku))?(ba+=Y.character,Y.aRa&&(Z=!0)):ea=!0:ea=!0;if(ea){T=new P.a(null,T.source,T.Lj,T.yg,T.runId,T.rJ,ba,T.Fmb,
!0,Z,T.xca,T.rFa,T.OSa,T.DF,T.ku);V.add(T);break}}}}k.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",V.fr());return V}static m_k(K,O=!1){const V=new a.a;let W=0;for(;W<K.length;){var T=K.J(W);if(1===T.type||4===T.type||2===T.type)V.add(T),W++;else if(3===T.type){let ba=T.character.toString();W++;let Z=T.aRa;for(;W<K.length;W++){var Y=K.J(W);if(3===Y.type&&N.kqo(T,Y,O))ba+=Y.character,Y.aRa&&(Z=!0);else break}T=new P.a(null,T.source,T.Lj,
T.yg,T.runId,T.rJ,ba,T.Fmb,!0,Z,T.xca,T.rFa,T.OSa,T.DF,T.ku);V.add(T)}}k.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",V.fr());return V}static kqo(K,O,V){return K.runId===O.runId&&K.rJ.equals(O.rJ)&&(K.xca===O.xca||K.rFa===O.rFa)&&K.DF.IA(O.DF)&&(!V||!!K.ku&&K.ku.equals(O.ku))}static Ojo(K,O,V,W,T,Y,ba,Z,ea,ha,la,ia,sa,Oa,Ra,Na){K.setPropertyString(V.zm,l.a.vo,T);K.setPropertyUint32(V.zm,f.a.Wc,W);K.setPropertyUint32s(V.zm,f.a.rq,Y);K.setPropertyUint32s(V.zm,
f.a.kt,ba);K.setPropertyObjectIds(V.zm,l.a.Ln,ea);K.hasProperty(V.zm,f.a.oj)&&K.setPropertyUint32(V.zm,f.a.oj,N.WIl());O&&O(10)&&K.setPropertyObjectIds(V.zm,f.a.Hv,Na);W=!1;for(T=0;T<ha.length;T++)if(ha.J(T)){W=!0;break}W&&K.setPropertyBools(V.zm,f.a.fSf,ha);N.QOk(O,K,V,la,ia,sa,Oa);N.ROk(K,V,Ra);V.zC(l.a.vo);V.zC(f.a.Wc);V.zC(f.a.rq);V.zC(f.a.kt);V.zC(l.a.Ln);V.zC(f.a.fSf);V.zC(l.a.Dm);V.zC(l.a.dqb);V.zC(f.a.UPa);V.zC(f.a.CHa);V.zC(l.a.aya);V.zC(f.a.Hv);K.hasProperty(V.zm,f.a.oj)&&V.zC(f.a.oj);0<
Z.length?K.setPropertyUint32s(V.zm,l.a.Dm,Z):V.zm.removeProperty(l.a.Dm)}static QOk(K,O,V,W,T,Y,ba){if(K(101)){K=W.contains(!0,(Z,ea)=>ea);N.Zcg(O,V,l.a.aya,K?W:null);N.Zcg(O,V,l.a.dqb,N.Dcj(W,T));N.Zcg(O,V,f.a.UPa,N.Dcj(W,Y));W=!1;for(T=0;T<ba.length;T++)0!==ba.J(T)&&(W=!0);W?O.setPropertyUint32s(V.zm,f.a.CHa,ba):V.zm.removeProperty(f.a.CHa)}}static ROk(K,O,V){const W=ba=>ba;var T=Object(r.a)(K,K.setPropertyBools,"setPropertyBools");N.ONa(O,V.fkb,W,T,f.a.NFa);N.ONa(O,V.ygb,W,T,f.a.Sga);N.ONa(O,V.k6a,
W,T,f.a.BHa);T=ba=>0<ba.length;var Y=Object(r.a)(K,K.setPropertyStrings,"setPropertyStrings");N.ONa(O,V.ekb,T,Y,f.a.OFa);N.ONa(O,V.xgb,T,Y,f.a.hEa);N.ONa(O,V.bob,T,Y,f.a.dJa);T=ba=>!!ba;Y=Object(r.a)(K,K.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");N.ONa(O,V.gkb,T,Y,f.a.PFa);N.ONa(O,V.J0a,T,Y,f.a.iEa);N.ONa(O,V.dob,T,Y,f.a.eJa);V.k6a.any(W)?N.ONa(O,V.cob,()=>!0,Object(r.a)(K,K.setPropertyObjectIds,"setPropertyObjectIds"),f.a.Qza):O.zm.removeProperty(f.a.Qza)}static Dcj(K,O){const V=
new a.a;let W=!1;for(let T=0;T<K.length;T++){const Y=O.J(T)&&!K.J(T);V.add(Y);W=Y||W}return W?V:null}static Zcg(K,O,V,W){W?K.setPropertyBools(O.zm,V,W):O.zm.removeProperty(V)}static WIl(){return x.a.zF()}static Tbi(K,O){return K.runtime.Ku.Cz(O,K.runtime.sk.J(O)||K.runtime.Kq.get(O))}static nQc(K,O,V,W,T){let Y;Y=new a.a;const ba=!!V&&V(10);if(K.runtime.Zb.isFeatureEnabled(78)){var Z=N.m_k(W,ba);var ea=N.REh(W,ba);Z.length!==ea.length&&K.runtime.Zb.Tx(78)}else Z=N.REh(W,ba);ea=0;let ha="",la=new a.a,
ia=new a.a,sa=new a.a,Oa=new a.a,Ra=new a.a,Na=new a.a,Da=new a.a,ra=new a.a,xa=new a.a;const fa=new L.a;let oa=new a.a;var ta=Z.J(Z.length-1);if(2!==ta.type&&4!==ta.type)return k.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",ta.type),K.logger.Pg(Object.assign(new J.a,{uj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",ta.type)})),{returnValue:!1,
A9d:Y};var Ka=0;for(ta=0;ta<Z.length;ta++){var va=Z.J(ta),La=null;if(1===va.type||3===va.type)La=va,ha+=La.text;else if(4===va.type){va=N.Tbi(K,va.Lj);va=new M.a(va);Y.add(va);continue}La?(la.add(La.runId),ia.add(La.yg),Ka+=La.text.length,sa.add(Ka),Oa.add(La.rJ),Ra.add(La.Fmb),Na.add(La.aRa),Da.add(La.xca),ra.add(La.rFa),xa.add(La.OSa),fa.fkb.add(La.DF.aqm),fa.ygb.add(La.DF.Epm),fa.k6a.add(La.DF.Eqm),fa.ekb.add(La.DF.insertion.author),fa.xgb.add(La.DF.deletion.author),fa.bob.add(La.DF.AHa.author),
fa.gkb.add(La.DF.insertion.Q_c),fa.J0a.add(La.DF.deletion.Q_c),fa.dob.add(La.DF.AHa.Q_c),fa.cob.add(La.DF.AHa.h1f),ba&&oa.add(La.ku)):la.length||(la.add(0),ia.add(0),sa.add(0),Oa.add(y.a.nil),Ra.add(!1),Na.add(!1),Da.add(!1),ra.add(!1),xa.add(0),fa.fkb.add(!1),fa.ygb.add(!1),fa.k6a.add(!1),fa.ekb.add(""),fa.xgb.add(""),fa.bob.add(""),fa.gkb.add(0),fa.J0a.add(0),fa.dob.add(0),fa.cob.add(y.a.nil));if(2===va.type){Ka=va;va=Ka.Wc;sa.tG(sa.length-1);La=T.J(ea);if(!La)return k.a.instance.Ua(17044307,1,
2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",ea,T.length,W.length,ta,Z.length),K.logger.Pg(Object.assign(new J.a,{uj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.kka(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",T.fr()),k.a.instance.kka(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
W.fr()),k.a.instance.kka(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",Z.fr()),{returnValue:!1,A9d:Y};if(La=N.Tbi(K,La))La=new M.a(La.UK()),N.Ojo(O,V,La,Ka.Wc,ha,la,ia,sa,Oa,Ra,Na,Da,ra,xa,fa,oa),Y.add(La);k.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ka.Lj,va,la.fr(),ia.fr(),
sa.fr(),Na.fr(),Da.fr(),ra.fr(),Oa.fr(),"",xa.fr());ea++;ha="";la=new a.a;ia=new a.a;sa=new a.a;Oa=new a.a;Ra=new a.a;Na=new a.a;Da=new a.a;ra=new a.a;xa=new a.a;fa.reset();Ka=0;oa=new a.a}}return{returnValue:!0,A9d:Y}}static p4n(K,O){const V=K.runtime.qn.J(z.a.ML),W=O.getPropertyObjectIds(V.zm,f.a.W1);for(let T=0;T<W.length;T++)K.runtime.qn.remove(W.J(T));O.setPropertyObjectIds(V.zm,f.a.W1,new a.a);O.setPropertyString(V.zm,f.a.$Ua,y.a.nil.toString());V.zC(f.a.W1);V.zC(f.a.$Ua)}static $zm(K,O){if(K.runtime.qn.nb(z.a.ML))return null;
const V=new M.a(K.runtime.sk.J(z.a.ML).UK());O.setPropertyString(V.zm,f.a.$Ua,K.output.ZM.last().id.toString());O.setPropertyObjectIds(V.zm,f.a.W1,new a.a);V.zC(f.a.W1);V.zC(f.a.$Ua);K.runtime.qn.Z(z.a.ML,V);return V}static drf(K){const O=new a.a;K.forEach(V=>{O.add(V.id);return!0});return O}static Jec(K,O,V,W){let T=0;V.forEach(Y=>{H.a(Y,O+T++,1);393230===Y.Nc&&K.getPropertyObjectIds(Y,l.a.Ln).forEach(ba=>{W.add(ba);return!0});return!0})}static C2m(K,O){const V=new m.a;let W=0;O.forEach(T=>{if(V.contains(T))return!0;
V.add(T);if(({index:W}=N.QLf("BaseFormatting_",W,T,Y=>K.runtime.sk.J(Y))).returnValue||({index:W}=N.QLf("FavoredFormatting_",W,T,Y=>K.runtime.Ku.J(Y))).returnValue||({index:W}=N.QLf("ConflictingFormatting_",W,T,Y=>K.runtime.Kq.J(Y))).returnValue)return!0;W++;return!0})}static QLf(K,O,V,W){if(V=W(V))if(H.a(V,K+O,1),1179649===V.Nc)return O++,{returnValue:!0,index:O};return{returnValue:!1,index:O}}static vff(K){return!!K.runtime.sk.J(z.a.ML)}static ONa(K,O,V,W,T){O.any(V)?(W(K.zm,T,O),K.zC(T)):K.zm.removeProperty(T)}static wlj(K,
O){const V=new a.a;V.add(0);const W=K?K.length:0;for(let T=0;T<W;T++)V.insert(T+1,K.Zf(T));V.insert(V.length,O);return V}}Object(D.a)(N,"ParagraphMergeUtils",null,[])},1593:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(224);class f{constructor(a,k,x){this.Gm=null;this.Zj=a;this.source=k;this.Lj=x}get type(){return this.Zj}get f8a(){return!1}get gLm(){return 1===(this.source&1)}get hLm(){return 2===(this.source&2)}get iLm(){return 4===(this.source&4)}S4(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.cNl(),this.G8b())}cNl(){let a="";this.gLm&&(a+="Base");this.hLm&&(a+="FavoredUpdate");this.iLm&&(a+="UnfavoredUpdate");return a}G8b(){return""}IA(a){return this.type===a.type}F$c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(D.a)(f,"AMergeBlock",null,[45,46])},1594:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1593);class l extends c.a{constructor(f,a,k){super(2,f,a);this.Wc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Wc,this.Lj)}G8b(){return"Eop"}clone(){return new l(this.source,this.Lj,this.Wc)}IA(f,a,k,x=!1,y=!0){return super.IA(f,a,k,x)?y?f.Wc===this.Wc:f.Lj===this.Lj&&f.Wc===this.Wc:!1}get length(){return 1}}Object(D.a)(l,"EopMergeBlock",c.a,[])},1595:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(365);class f{constructor(){this.detail=new l.a}}Object(D.a)(f,"AMergeFailureDetail",null,[1834])},1596:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1541);class l extends c.a{constructor(){super()}get fha(){return"ParagraphMerge"}}
Object(D.a)(l,"ParagraphMergeFailureDetail",c.a,[])},1597:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1541);class l extends c.a{constructor(){super()}get fha(){return"RdOpLcs"}}Object(D.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1598:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1541);class l extends c.a{constructor(){super()}get fha(){return"TableMerge"}}Object(D.a)(l,"TableMergeFailureDetail",c.a,[])},1606:function(D,I,c){D=c(0);class l{constructor(){this.fbd=this.gUc=
null;this.SNf=this.score=this.r_c=0}GZf(F,H,L){this.score=F.J(H);++H;this.gUc=F.J(H)?L.poa(F.J(H)):null;++H;this.fbd=F.J(H)?L.poa(F.J(H)):null;++H;this.r_c=F.J(H);++H;this.SNf=F.J(H);++H;return H}}Object(D.a)(l,"TokenStringGeneratorInit",null,[]);class f{constructor(F,H,L,J,M){this.Lhb=F;this.count=H;this.RNd=L;this.QO=J;this.depth=M}}Object(D.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=c(1656),k=c(1742);class x{constructor(F=null,H=0,L=0,J=0){this.olk=F||new k.a;this.kwa=H;this.QO=L;this.depth=
J}get d6(){return this.olk}getKey(){return this.d6.Ox.toString()+":"+this.kwa.toString()}}Object(D.a)(x,"TrieBookmark",null,[]);class y{constructor(F,H){this.KRa=F;this.ZMf=H}o6m(F){if(null==F)throw Error.argumentNull("prefix");let H={};var L=H[""]=new x;this.ZVd(L,H);for(L=0;L<F.length;++L){const J=F.charCodeAt(L),M={};for(let P in H)this.Zyk(J,H[P],M);H=M}return this.WKo(H)}ZVd(F,H){if(!(F.QO>=this.ZMf)&&(F=new x(a.a.w7e(F.d6),F.kwa,F.QO+1,F.depth),F.d6.KF&a.a.z9a&&(F.kwa+=1),this.KRa.SRb(F.d6))){F.depth+=
1;let L=!0;for(;L;)y.une(F,H),this.ZVd(F,H),F.kwa+=this.KRa.U8b(F.d6,!0)+(F.d6.KF&a.a.z9a?1:0),L=this.KRa.Dbd(F.d6)}}Zyk(F,H,L){H.QO+1<=this.ZMf&&(H.QO+=1,y.une(H,L),--H.QO);H.d6.KF&a.a.z9a&&(H.kwa+=1);if(this.KRa.SRb(H.d6)){H.depth+=1;let J=!0;for(;J;)H.d6.ZSb===F?(y.une(H,L),this.ZVd(H,L)):H.QO+1<=this.ZMf&&(H.QO+=1,y.une(H,L),this.ZVd(H,L),--H.QO),H.kwa+=this.KRa.U8b(H.d6,!0)+(H.d6.KF&a.a.z9a?1:0),J=this.KRa.Dbd(H.d6)}}WKo(F){const H=[];for(var L in F){const J=F[L];if(!J.d6.Ox)continue;const M=
!!(J.d6.KF&a.a.z9a),P=this.KRa.U8b(J.d6,!1)+(M?1:0);Array.add(H,new f(J.kwa,P,M,J.QO,J.depth))}H.sort((J,M)=>{let P=J.Lhb-M.Lhb;return P||(P=-(J.count-M.count))?P:P=J.depth-M.depth});if(2>H.length)return H;F=[];for(L=0;L<H.length;)L+=y.Bzj(L,H,F);return F}static une(F,H){const L=F.getKey();L in H?(H=H[L],H.QO=Math.min(H.QO,F.QO)):H[L]=new x(a.a.w7e(F.d6),F.kwa,F.QO,F.depth)}static Bzj(F,H,L){const J=H[F];let M=J.Lhb;const P=M+J.count;let N=1,K=J.RNd;for(;F+N<H.length&&H[F+N].Lhb<P;){const O=H[F+N];
O.Lhb>M&&(Array.add(L,new f(M,O.Lhb-M,K,J.QO,J.depth)),K=!1);N+=y.Bzj(F+N,H,L);M=O.Lhb+O.count}M<P&&Array.add(L,new f(M,P-M,K,J.QO,J.depth));return N}}Object(D.a)(y,"ErrorTolerantTrieLookupEngine",null,[1310]);class m extends l{constructor(F,H,L){super();this.lpi=this.PXi=!1;this.MWh=null;if(F){var J=0;try{J=this.GZf(F,J,H);this.PXi=1===F.J(J);++J;this.lpi=1===F.J(J);++J;const M=F.J(J);this.MWh=this.tyn(L,M)}catch(M){throw Error.argument("initData");}}}tyn(F,H){return new y(F,H)}}Object(D.a)(m,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class r extends l{constructor(F,H){super();this.query=this.name=null;if(F){this.annotations=H.annotations;var L=0;try{L=this.GZf(F,L,H),this.name=H.XC(F.J(L)),++L,this.query=H.eL(F.J(L))}catch(J){throw Error.argument("initData");}}}}Object(D.a)(r,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(F,H){super();if(F)try{this.GZf(F,0,H)}catch(L){throw Error.argument("initData");}}}Object(D.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var v=c(1528);c.d(I,"a",function(){return G});
class G{constructor(F){this.PMf=F}get gUc(){return this.PMf.gUc}get fbd(){return this.PMf.fbd}get r_c(){return this.PMf.r_c}static create(F,H,L){const {SurfaceStringTokenStringGenerator:J}=c(1887),{QueryTokenStringGenerator:M}=c(1888),{FuzzyMatchTokenStringGenerator:P}=c(1889);let N=0;try{if(F.J(N)!==G.oBb)throw Error.argument("initData","Input does not represent a token string generator");++N;const K=F.J(N);++N;const O=new v.a;O.Xhb(F,N,F.count-N);switch(K){case J.aHc:return new J(new z(O,H));case M.aHc:return new M(new r(O,
H));case P.aHc:return new P(new m(O,H,L));default:throw Error.argument("initData");}}catch(K){throw Error.argument("initData");}}static Doh(F,H,L,J,M,P){F=F.dJo.getId(H,null);if(0>F)return++P,P;G.Eoh(F,L,J,M);return P}static Eoh(F,H,L,J){Array.add(J.gig,F);Array.add(J.Nuj,H);++J.hnc[L]}}G.oBb=1099767983;Object(D.a)(G,"TokenStringGenerator",null,[1286])},1640:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(224);I=c(1593);var f=c(1553);class a extends I.a{constructor(k,x,y){super(k,x,
y)}Iyo(k){let x;x=null;if(!this.text||!this.f8a||0>=k||k>=this.length)return{returnValue:!1,jtj:x};x=new l.a;const y=this.clone();y.l9c(f.a.mqb(this.text,0,k));const m=this.clone();m.l9c(f.a.mqb(this.text,k,this.length-k));x.add(y);x.add(m);return{returnValue:!0,jtj:x}}S4(){return!0}get length(){return this.text.length}}Object(D.a)(a,"ATextMergeBlock",I.a,[])},1641:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(179);class f{L0e(a,k){return a+("[Block: "+k+"] ")}static URl(a,k,x,y,
m,r,z){const {ParagraphMergeBlockCreator:v}=c(1983),{TableMergeBlockCreator:G}=c(1987);if(393230===k.Nc)return new v(a,k,x,m,r,y(10),z);if(393250===k.Nc)return new G(k,x);l.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Nc);return null}}Object(D.a)(f,"MergeBlockCreator",null,[])},1642:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(6),f=c(60);I=c(1640);var a=c(1559);class k extends I.a{constructor(x,y,m,r,z,v,G,F,H,L,J,M,P,N){super(y,
m,r);this.yg=z;this.runId=v;this.Fmb=F;this.Q1j=G;this.ose=x;this.aRa=H;this.xca=L;this.rFa=J;this.OSa=M;this.DF=P;this.ku=N}get CFc(){return this.ose}get rJ(){return this.Q1j}get PEb(){return this.CFc(this.rJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.yg,this.runId,this.Fmb,this.Lj,this.rJ.toString(),this.ku?this.ku.toString():"NULL")}IA(x,y,m,r=!1){if(!super.IA(x,y,m,r))return!1;
if(r)return!0;if(!this.DF.IA(x.DF)||this.ku&&!this.ku.equals(x.ku))return!1;if(this.rJ.equals(x.rJ)||this.rJ.equals(f.a.nil)||x.rJ.equals(f.a.nil))return!0;x=new a.a(this.PEb,x.PEb);y=y.JKh(this.PEb,m);return x.wVc(y.dae)?!1:!0}get XFm(){return this.S4()&&"\ufffc"===this.text&&this.PEb?this.PEb.hasProperty(l.a.Is)||1179725!==this.PEb.Nc?!0:!1:!1}}Object(D.a)(k,"AUserRunMergeBlock",I.a,[])},1643:function(D,I,c){c.d(I,"a",function(){return f});var l=c(179);const f=(a,k,x=4)=>{a?l.a.instance.kka(4273285,
x,4,k,a.Yad()):l.a.instance.Ua(4293845,x,1,k,"{0}: Node was null.",k)}},1644:function(D,I,c){c.d(I,"e",function(){return y});c.d(I,"a",function(){return m});c.d(I,"d",function(){return r});c.d(I,"b",function(){return z});c.d(I,"c",function(){return v});var l=c(6),f=c(16),a=c(60),k=c(1051),x=c(1568);const y=(H,L,J)=>{const M=new k.a;let P=a.a.nil;L=M.getPropertyObjectId(L,l.a.vqb);L.equals(a.a.nil)||(H=H.runtime.sk.J(L),J&&(H=J.Cz(L,H)),H&&(P=M.getPropertyObjectId(H,l.a.vqb)));return P},m=(H,L,J,M,
P)=>{const N=new k.a;let K=null;var O=N.getPropertyObjectId(J,l.a.vqb);O!==a.a.nil&&(K=H.runtime.sk.J(O),L&&(K=L.Cz(O,K)));if(K){O=N.getPropertyObjectIds(K,f.a.$e);for(P=0;P<O.length&&!O.J(P).equals(J.id);P++);P===O.length&&(P=-1)}J=y(H,J,L);if(!J.equals(a.a.nil)&&(H=H.runtime.sk.J(J),L&&(H=L.Cz(J,H)),H)){L=N.getPropertyObjectIds(H,f.a.$e);for(M=0;M<L.length&&!L.J(M).equals(K.id);M++);M===L.length&&(M=-1)}return{rowIndex:M,q4b:P}},r=(H,L,J,M,P)=>{var N=new k.a;let K=null;var O=H.runtime.sk.J(J);L&&
(O=L.Cz(J,O));if(!O)return null;O=N.getPropertyObjectIds(O,f.a.$e);J=null;M<O.length&&(M=O.J(M),J=H.runtime.sk.J(M),L&&(J=L.Cz(M,J)));J&&(N=N.getPropertyObjectIds(J,f.a.$e),P<N.length&&(P=N.J(P),K=H.runtime.sk.J(P),L&&(K=L.Cz(P,K))));return K},z=(H,L,J)=>{let M,P;P=M=-1;const N=(new k.a).getPropertyObjectId(J,l.a.vqb);var K=y(H,J,L);if(K.equals(a.a.nil)||N.equals(a.a.nil))return{rowIndex:M,q4b:P};L=H.runtime.xjg;var O=L.J(K);if(!O){O=G(H,K);if(!O)return{rowIndex:M,q4b:P};L.Z(K,O)}for(K=0;K<O.length;K++)if(O.J(K).equals(N)){M=
K;break}O=L.J(N);if(!O){O=F(H,N);if(!O)return{rowIndex:M,q4b:P};L.Z(N,O)}for(H=0;H<O.length;H++)if(O.J(H).equals(J.id)){P=H;break}return{rowIndex:M,q4b:P}},v=(H,L,J,M)=>{if(0>J||0>M)return a.a.nil;new k.a;const P=H.runtime.xjg;let N=P.J(L);if(!N){N=G(H,L);if(!N)return a.a.nil;P.Z(L,N)}if(J<N.length)L=N.J(J);else return a.a.nil;J=P.J(L);if(!J){J=F(H,L);if(!J)return a.a.nil;P.Z(L,J)}if(M<J.length)H=J.J(M);else return a.a.nil;return H},G=(H,L)=>{var J=new k.a;const M=H.runtime.sk.J(L);if(M){var P=H.runtime.Ku.Cz(L,
M);H=H.runtime.Kq.Cz(L,M);L=J.getPropertyObjectIds(M,f.a.$e);P=J.getPropertyObjectIds(P,f.a.$e);J=J.getPropertyObjectIds(H,f.a.$e);return L.zq(P,(N,K)=>N.equals(K))?J:L.zq(J,(N,K)=>N.equals(K))?P:x.a(L,P,J,(N,K)=>N.equals(K))}return(P=H.runtime.Ku.J(L))?J.getPropertyObjectIds(P,f.a.$e):(P=H.runtime.Kq.J(L))?J.getPropertyObjectIds(P,f.a.$e):null},F=(H,L)=>{var J=new k.a;const M=H.runtime.sk.J(L);if(M){var P=H.runtime.Ku.Cz(L,M);H=H.runtime.Kq.Cz(L,M);L=J.getPropertyObjectIds(M,f.a.$e);P=J.getPropertyObjectIds(P,
f.a.$e);J=J.getPropertyObjectIds(H,f.a.$e);return L.zq(P,(N,K)=>N.equals(K))?J:L.zq(J,(N,K)=>N.equals(K))?P:null}return(P=H.runtime.Ku.J(L))?J.getPropertyObjectIds(P,f.a.$e):(P=H.runtime.Kq.J(L))?J.getPropertyObjectIds(P,f.a.$e):null}},1645:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1508);class l extends c.a{constructor(f,a,k,x,y=null){super(f,a,y,null,k);this.id=x}}Object(D.a)(l,"TryQueryResultBinding",c.a,[])},1646:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.Cb=
f}get x5a(){return this.Cb.x5a}get eDo(){return 4!==this.Cb.style}get gDo(){return!0}get trie(){return this.Cb.trie}getId(f,a){if(!this.eDo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Cb.style){case 0:return this.dZl(f,a);default:throw Error.notImplemented();}}XC(f){if(!this.gDo)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.x5a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Cb.style){case 0:return this.hdm(f);
case 4:return this.gdm(f);default:throw Error.notImplemented();}}dZl(f,a){f=this.Cb.trie.eKi(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.wnc||f.wnc>=this.Cb.x5a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Cb.Ebd?this.Cb.Z4c.Ty(this.Cb.Ebd+4*f.wnc,4):f.wnc}hdm(f){if(this.Cb.Ebd){let a=0;for(;a<this.Cb.x5a&&this.Cb.Z4c.Ty(this.Cb.Ebd+4*a,4)!==f;++a);if(a>=this.Cb.x5a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Cb.trie.ngi(a)}return this.Cb.trie.ngi(f)}gdm(f){const a=
this.Cb.Z4c.Ty(this.Cb.Kuj+4*f,4);f=this.Cb.Z4c.Ty(this.Cb.Luj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({dum:f}=this.xNn(f)).returnValue;return String.fromCharCode.apply(null,k)}xNn(f){let a=0;for(let k=0;3>k;++k){const x=this.Cb.Z4c.J(this.Cb.tBh+f)^182;++f;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,dum:f}}}Object(D.a)(l,"StringTable",null,[1262])},1647:function(D,I,c){c.d(I,"a",function(){return f});
D=c(0);var l=c(1656);class f{constructor(a){this.trie=null;this.tBh=this.Kuj=this.Luj=this.Ebd=0;if(a){this.Z4c=a;var k=0;if(a.Ty(k,4)!==f.oBb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.x5a=a.Ty(k,4);k+=4;this.style=a.Ty(k,4);k+=4;switch(this.style){case 0:const x=1===a.Ty(k,4);k+=4;x||(this.Ebd=k,k+=4*this.x5a);a.Ty(k,4);this.trie=this.Uyn(a,k+4);break;case 4:this.Luj=k;this.Kuj=k+=4*this.x5a;k+=4*this.x5a;a.Ty(k,4);this.tBh=k+4;break;default:throw Error.argument("bytes");
}}}Uyn(a,k){return new l.a(a,k)}}f.oBb=1025118440;Object(D.a)(f,"StringTableInit",null,[])},1648:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.Answer=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.WolframAnswer=3]="WolframAnswer";f[f.Assistance=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.TryQuery=7]="TryQuery";f[f.FindInDocument=8]="FindInDocument";f[f.HelpAction=9]="HelpAction";f[f.Insights=10]="Insights";f[f.People=
11]="People";f[f.Image=12]="Image";f[f.FirstRunResult=13]="FirstRunResult";f[f.NoCommandsFoundResult=14]="NoCommandsFoundResult";f[f.TestResult=15]="TestResult";f[f.AppsForOffice_Installed=16]="AppsForOffice_Installed";f[f.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";f[f.AppsForOffice_Query=18]="AppsForOffice_Query";f[f.Notes_Onenote=19]="Notes_Onenote";f[f.Notes_Samsung=20]="Notes_Samsung";f[f.Notes_Sticky=21]="Notes_Sticky";f[f.Learning=22]="Learning";f[f.Feedback=23]="Feedback";
f[f.Template=24]="Template";f[f.ActionAI=25]="ActionAI";f[f.ActionAICommand=26]="ActionAICommand";f[f.Addin=27]="Addin";f[f.OfficeScript=28]="OfficeScript";f[f.AddinStoreEntry=29]="AddinStoreEntry";f[f.GenerateSlides=30]="GenerateSlides";f[f.SummarizeDeck=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(l||(l={}));Object(D.b)("ResultType",l)},1653:function(D,I,c){D=c(0);var l=c(6),f=c(608),a=c(179),k=c(224),x=c(60),y=c(365),m=c(69),r;(function($a){$a[$a.none=0]="none";$a[$a.mergeConflict=1]="mergeConflict";
$a[$a.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";$a[$a.failedToApplyHints=3]="failedToApplyHints";$a[$a.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";$a[$a.other=5]="other"})(r||(r={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",r);var z=c(1051),v=c(237),G=c(904);const F=$a=>{const Hb=new k.a;$a.forEach(Ya=>{Hb.add(Ya);return!0});return Hb};var H=c(1594),L=c(1568),J=c(1597);const M=($a,Hb)=>{if($a.length!==Hb.length)return!1;for(let Ya=0;Ya<
$a.length;Ya++)$a.J(Ya).Gm=Hb.J(Ya),Hb.J(Ya).Gm=$a.J(Ya);return!0},P=($a,Hb,Ya)=>{let Sa,Eb,Jb;Sa=0;Eb=!1;Jb=0;var vb;if(!({idx:vb}=W($a,Hb)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Hb,$a.fr()),{returnValue:!1,GRc:Sa,Bmb:Eb,m0c:Jb};if(!Ya&&2===$a.J(vb).type)return{returnValue:!0,GRc:vb,Bmb:Eb,m0c:Jb};if(!$a.J(vb).S4())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
vb,Ya,$a.fr()),{returnValue:!1,GRc:Sa,Bmb:Eb,m0c:Jb};let ac=!1,dc=0;for(;vb<$a.length&&$a.J(vb).Lj.equals(Hb);vb++){if(Ya===dc){ac=!0;break}if(Ya>dc&&Ya<dc+$a.J(vb).length){Eb=ac=!0;Jb=Ya-dc;break}dc+=$a.J(vb).length}ac||Ya!==dc||(ac=!0);ac&&(Sa=vb);return{returnValue:ac,GRc:Sa,Bmb:Eb,m0c:Jb}},N=($a,Hb,Ya)=>{let Sa,Eb,Jb;Jb=Eb=0;Sa=!1;let vb=0,ac=!1;for(;Eb<$a.length;Eb++){if(Hb===vb){ac=!0;break}if(Hb>vb&&Hb<vb+$a.J(Eb).length){Sa=ac=!0;Jb=Hb-vb;break}vb+=$a.J(Eb).length}ac||Hb!==vb||(ac=!0);ac||
($a=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",$a.length,vb,Hb),a.a.instance.Ua(573178201,1,2,$a),Ya.Pg(Object.assign(new J.a,{eventId:"8k6fz",info:$a})));return{returnValue:ac,Bmb:Sa,Kvh:Eb,Jvh:Jb}},K=($a,Hb,Ya)=>{let Sa;if($a.J(Hb).S4()&&({jtj:Sa}=$a.J(Hb).Iyo(Ya)).returnValue)return $a.aD(Hb+1,Sa),$a.tG(Hb),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Hb,Ya,$a.fr());
return!1},O=($a,Hb,Ya)=>{let Sa,Eb;if(!({GRc:Ya,Bmb:Eb,m0c:Sa}=P($a,Hb,Ya)).returnValue)return{returnValue:!1,index:0};if(!Eb)return{returnValue:!0,index:Ya};if(K($a,Ya,Sa))return{returnValue:!0,index:Ya+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Hb,Sa,$a.fr());return{returnValue:!1,index:0}},V=($a,Hb,Ya)=>{let Sa;if(!({Bmb:Sa,Kvh:Hb,Jvh:Ya}=N($a,Hb,Ya)).returnValue)return{returnValue:!1,index:0};if(!Sa)return{returnValue:!0,
index:Hb};if(K($a,Hb,Ya))return{returnValue:!0,index:Hb+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Ya,$a.fr());return{returnValue:!1,index:0}},W=($a,Hb)=>{let Ya;Ya=0;for(let Sa=0;Sa<$a.length;Sa++)if($a.J(Sa).Lj.equals(Hb))return Ya=Sa,{returnValue:!0,idx:Ya};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Hb,$a.fr());return{returnValue:!1,idx:Ya}},T=($a,
Hb)=>{let Ya;Ya=-1;for(let Sa=Hb;Sa<$a.length;Sa++)if(2===$a.J(Sa).type)return Ya=Sa,{returnValue:!0,dha:Ya};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Hb,$a.fr());return{returnValue:!1,dha:Ya}},Y=($a,Hb,Ya)=>{let Sa;Sa=-1;for(let Eb=Ya;Eb<$a.length;Eb++)if(2===$a.J(Eb).type&&$a.J(Eb).Lj.equals(Hb))return Sa=Eb,{returnValue:!0,dha:Sa};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
Hb,Ya,$a.fr());return{returnValue:!1,dha:Sa}},ba=($a,Hb)=>{let Ya;Ya=0;var Sa;if(!({idx:Sa}=W($a,Hb)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Hb,$a),{returnValue:!1,length:Ya};for(;Sa<$a.length;Sa++)if(6!==$a.J(Sa).type){if(2===$a.J(Sa).type)return{returnValue:!0,length:Ya};a.a.instance.shipAssertTag(17342617,1,$a.J(Sa).S4(),"We found something other than text with type "+$a.J(Sa).type);a.a.instance.shipAssertTag(17877021,1,$a.J(Sa).Lj.equals(Hb),
"Unexpected GraphNodeId {0} for ParaId {1}",$a.J(Sa).Lj,Hb);Ya+=$a.J(Sa).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Hb,$a);return{returnValue:!1,length:Ya}},Z=$a=>{const Hb=new k.a;for(let Ya=0;Ya<$a.length;Ya++)Hb.add($a.J(Ya).clone());return Hb};var ea=c(1596),ha=c(1553);class la{constructor($a,Hb,Ya=null,Sa=null){this.Lj=$a;this.type=Hb;this.text=Ya;this.Wc=Sa}isEqual($a){return $a.Lj.equals(this.Lj)&&this.type===$a.type&&this.Wc===$a.Wc&&ha.a.Pth(this.text,
$a.text)}toString(){let $a=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Lj,this.Wc,this.type);this.text&&($a+=String.format(" [TextLength: {0}]",this.text.length));return $a}}Object(D.a)(la,"MergeBlockValidationState",null,[]);var ia=c(110),sa=c(949),Oa=c(870),Ra=c(538),Na=c(468),Da=c(948),ra=c(869),xa=c(1541),fa=c(1732),oa;(function($a){$a[$a.base=1]="base";$a[$a.favoredUpdate=2]="favoredUpdate";$a[$a.unfavoredUpdate=4]="unfavoredUpdate";$a[$a.min=1]="min";$a[$a.max=
7]="max"})(oa||(oa={}));Object(D.b)("MergeBlockSource",oa);class ta{constructor($a,Hb,Ya,Sa){this.yg=$a;this.cp=Hb;this.YCd=Ya;this.Mcd=Sa}}Object(D.a)(ta,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var Ka=c(1593);class va extends Ka.a{constructor($a,Hb){super(6,$a,Hb);this.Wc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Lj)}G8b(){return"Selection"}clone(){return new va(this.source,this.Lj)}IA(){return!1}get length(){return 0}}Object(D.a)(va,"SelectionMergeBlock",
Ka.a,[]);var La;(function($a){$a[$a.success=0]="success";$a[$a.selfSplit=1]="selfSplit";$a[$a.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";$a[$a.unexpected=3]="unexpected"})(La||(La={}));Object(D.b)("SplitTwinListResult",La);var za=c(1640);class Ca extends za.a{constructor($a,Hb,Ya,Sa){super(5,$a,Hb);this._text=null;this.l9c(Ya);this.Tlk=Sa}get text(){return this._text}l9c($a){this._text=$a}get ucd(){return this.Tlk}clone(){return new Ca(this.source,this.Lj,this.text,this.ucd)}get f8a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(Ca,"UpdateHintTextMergeBlock",za.a,[]);class ua{constructor($a,Hb,Ya,Sa){this.f3=!1;this.Tcb=new y.a;this.Yd=$a;this.gjh=Sa;this.yMg=Ya;this._base=Hb;this.Bxe=Z(Hb);if(!M(this.base,this.Me))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),$a.logger.Pg(Object.assign(new xa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Me(){return this.Bxe}get mergeConflict(){return this.f3}z1e($a,
Hb){switch($a.type){case 1:return this.eDk($a,Hb);case 2:return this.Y0e($a,Hb);case 3:return this.dEk($a,Hb);case 4:return this.yDk($a);case 5:return this.uCk($a,Hb);case 6:return this.W0e($a);default:return!1}}y1e($a,Hb){switch($a.type){case 1:return this.b1e($a,Hb);case 2:return this.X0e($a,Hb);case 3:return this.cEk($a,Hb);case 4:return this.xDk($a);case 5:return this.tCk($a,Hb);case 6:return this.V0e($a);default:return{returnValue:!1,zu:null}}}eDk($a,Hb){let Ya;const Sa=({Tha:Ya}=this.GIa($a.yg,
Hb,!1,$a.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",oa[Hb],La[Sa]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.f3=!1;Hb=new Ca(Hb,$a.yg,$a.text,$a.id);this.IAf($a,Ya,Hb);return!0}Y0e($a,Hb){let Ya,Sa=({Tha:Ya}=this.GIa($a.yg,Hb,!1,$a.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",oa[Hb],La[Sa]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Eb;({Tha:Eb,returnValue:Sa}=this.GIa($a.yg,Hb,!1,$a.cp+$a.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
oa[Hb],La[Sa]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.f3=!1;this.adf($a,Ya,Eb);return!0}dEk($a,Hb){let Ya;const Sa=({Yyf:Ya}=this.j$h($a,Hb,!1)).returnValue;if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",oa[Hb],La[Sa]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.f3=!1;Hb=new H.a(Hb,$a.fu,$a.pua);this.IAf($a,Ya,Hb);return!0}yDk($a){let Hb;if(!({eWd:Hb}=this.k$h($a,this.Me,"Derived")).returnValue)return!1;this.adf($a,Hb,Hb+1);return!0}uCk($a,Hb){let Ya;if(!({fOf:Hb,Xyf:Ya}=this.Wai($a,!1,Hb)).returnValue)return!1;this.IAf($a,Ya,Hb);return!0}W0e($a){let Hb;if(!({dWd:Hb}=this.b$h($a,this.Me,"Derived")).returnValue)return!1;this.adf($a,Hb,Hb+1);return!0}$sh($a,Hb,Ya){const Sa=({Tha:Hb}=this.GIa($a,Ya,!1,Hb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",oa[Ya],La[Sa]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.f3=!1;$a=new va(Ya,$a);this.Me.insert(Hb,$a);return!0}b1e($a,Hb){var Ya=null;if(ua.gwi($a.text.length))return{returnValue:!1,zu:Ya};let Sa,Eb,Jb;var vb=({Tha:Sa,cxa:Eb,Jga:Jb}=this.GIa($a.yg,Hb,!0,$a.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==vb&&2!==vb)return 3!==vb&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",oa[Hb],La[vb]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,zu:Ya};this.f3=!1;({dha:vb}=T(this.Me,Eb));vb=this.Me.J(vb).Lj;Ya=new Ca(Hb,$a.yg,$a.text,$a.id);Hb=new Ca(Hb,vb,$a.text,$a.id);Ya.Gm=Hb;Hb.Gm=
Ya;this.base.insert(Sa,Ya);this.Me.insert(Eb,Hb);Ya=new k.a;Ya.add(new Na.a(vb,Jb,$a.text,$a.id,$a.Nu));return{returnValue:!0,zu:Ya}}X0e($a,Hb){let Ya;Ya=null;if(ua.gwi($a.text.length))return{returnValue:!1,zu:Ya};let Sa;var Eb,Jb=({Tha:Sa,cxa:vb,Jga:Eb}=this.GIa($a.yg,Hb,!0,$a.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Jb){if(2!==Jb)return 3!==Jb&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
oa[Hb],La[Jb]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,zu:Ya};var vb=0;for({idx:Eb}=W(this.base,$a.yg);Eb<this.base.length&&vb<$a.cp;Eb++)vb+=this.base.J(Eb).length;vb-=this.base.J(Eb-1).length;({cxa:vb,Jga:Eb,returnValue:Jb}=this.GIa($a.yg,Hb,!0,vb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Jb)return 3!==Jb&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
oa[Hb],La[Jb]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,zu:Ya};this.f3=!1}var ac,dc;({Tha:ac,cxa:dc,Jga:Cc,returnValue:Jb}=this.GIa($a.yg,Hb,!0,$a.cp+$a.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Jb){if(2!==Jb)return 3!==Jb&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",oa[Hb],La[Jb]),this.Yd.logger.Pg(Object.assign(new fa.a,
{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,zu:Ya};var Cc=0;for({idx:dc}=W(this.base,$a.yg);dc<this.base.length&&Cc<$a.cp+$a.text.length;dc++)Cc+=this.base.J(dc).length;({cxa:dc,Jga:Cc,returnValue:Jb}=this.GIa($a.yg,Hb,!0,Cc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Jb)return 3!==Jb&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",oa[Hb],La[Jb]),
this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,zu:Ya};this.f3=!1}Hb="";Ya=new k.a;for(--dc;dc>=vb;dc--)if(6!==this.Me.J(dc).type)if(this.Me.J(dc).Gm)Hb=this.Me.J(dc).text+Hb,this.Me.tG(dc);else{if(5===this.Me.J(dc).type)Jb=Cc-Hb.length;else if(2===this.Me.J(dc).type){if(Jb=0,!({length:Cc}=ba(this.Me,this.Me.J(dc).Lj)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),
this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,zu:Ya}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,zu:Ya};if(!({dha:Ec}=T(this.Me,dc+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),
this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,zu:Ya};var Ec=this.Me.J(Ec).Lj;Ya.add(new Ra.DeleteTextUpdateHint(Ec,Jb,Hb));Hb=""}for(--ac;ac>=Sa;ac--)this.base.tG(ac);if(!({dha:Ec}=T(this.Me,vb)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,zu:Ya};Ec=
this.Me.J(Ec).Lj;Hb&&Hb.length&&Ya.add(new Ra.DeleteTextUpdateHint(Ec,Eb,Hb,$a.id,$a.Nu));return{returnValue:!0,zu:Ya}}cEk($a,Hb){var Ya=null;let Sa,Eb,Jb;var vb=({Yyf:Sa,poi:Eb,Jga:Jb}=this.j$h($a,Hb,!0)).returnValue;if(0!==vb)return 3!==vb&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",oa[Hb],La[vb]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),
{returnValue:!1,zu:Ya};var ac;if(!({dha:ac}=T(this.Me,Eb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,zu:Ya};vb=this.Me.J(ac).Lj;const dc=this.Me.J(ac).Wc;let Cc,Ec,rc;({fu:ac,U7:Cc,pua:Ec,wba:rc}=this.K3l($a,ac));this.oBh(this.Me,ac,Cc,rc,Eb);Ya=new H.a(Hb,$a.fu,$a.pua);Hb=new H.a(Hb,ac,Ec);Ya.Gm=Hb;Hb.Gm=Ya;this.base.insert(Sa,Ya);this.Me.insert(Eb,Hb);Ya=new k.a;Ya.add(new ra.a(vb,dc,
Jb,ac,Ec,Cc,rc,$a.id,$a.Nu));return{returnValue:!0,zu:Ya}}xDk($a){let Hb;Hb=null;let Ya,Sa;var Eb;if(!({eWd:Ya}=this.k$h($a,this.base,"Base")).returnValue)return{returnValue:!1,zu:Hb};if(!this.base.J(Ya).Gm||!({dha:Sa}=Y(this.Me,this.base.J(Ya).Gm.Lj,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc1"})),this.f3=!0,{returnValue:!1,zu:Hb};if(!({dha:Eb}=T(this.Me,Sa+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.f3=!0,{returnValue:!1,zu:Hb};let Jb,vb,ac,dc,Cc,Ec;({j5a:Eb,k5a:ac,YRf:Jb,sen:dc,$dn:vb,aen:Cc}=this.qSl($a,Sa,Eb));if(!({length:Ec}=ba(this.Me,Eb)).returnValue)return{returnValue:!1,
zu:Hb};this.nBh(this.Me,Eb,ac,Sa);this.Me.tG(Sa);this.base.tG(Ya);Hb=new k.a;Hb.add(new Da.MergeParagraphUpdateHint(Jb,dc,Ec,vb,Cc,Eb,ac,$a.id,$a.Nu));return{returnValue:!0,zu:Hb}}tCk($a,Hb){var Ya=null;let Sa,Eb,Jb;if(!({fOf:Jb,Xyf:Sa}=this.Wai($a,!0,Hb)).returnValue)return{returnValue:!1,zu:Ya};if(!({Ijb:Eb}=this.bQc(this.base,this.Me,Sa,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,
zu:Ya};if(0<Eb&&2!==this.Me.J(Eb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.f3=!0,{returnValue:!1,zu:Ya};let vb;if(!({fu:vb}=this.a3h(Eb)).returnValue)return{returnValue:!1,zu:Ya};Hb=new H.a(Hb,$a.yg,$a.Wc);Ya=Jb;Ya.Gm=Hb;Hb.Gm=Ya;this.base.insert(Sa,Jb);this.Me.insert(Eb,Hb);Ya=new k.a;Ya.add(new sa.AddParagraphUpdateHint($a.yg,
$a.Wc,vb,$a.id,$a.Nu));return{returnValue:!0,zu:Ya}}V0e($a){let Hb;Hb=null;let Ya;var Sa;if(!({dWd:Sa}=this.b$h($a,this.base,"Base")).returnValue)return{returnValue:!1,zu:Hb};if(!this.base.J(Sa).Gm||!this.base.J(Sa).Gm.Lj.equals($a.yg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.f3=
!0,{returnValue:!1,zu:Hb};if(!({Ijb:Ya}=this.bQc(this.base,this.Me,Sa,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,zu:Hb};if(0<Ya&&2!==this.Me.J(Ya).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.f3=!0,{returnValue:!1,zu:Hb};
const Eb=this.Me.J(Ya).Lj,Jb=this.Me.J(Ya).Wc;this.Me.tG(Ya);this.base.tG(Sa);({fu:Sa}=this.a3h(Ya));0<Ya&&6===this.Me.J(Ya-1).type&&this.ECn(Ya-1,Sa);Hb=new k.a;Hb.add(new Oa.a(Eb,Jb,Sa,$a.id,$a.Nu));return{returnValue:!0,zu:Hb}}Zsh($a,Hb,Ya){let Sa;var Eb=({Tha:Hb,cxa:Sa}=this.GIa($a,Ya,!0,Hb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Eb)return 3!==Eb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
oa[Ya],La[Eb]),this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({dha:Eb}=T(this.Me,Sa));Eb=this.Me.J(Eb).Lj;$a=new va(Ya,$a);Ya=new va(Ya,Eb);$a.Gm=Ya;Ya.Gm=$a;this.base.insert(Hb,$a);this.Me.insert(Sa,Ya);return!0}qSl($a,Hb,Ya){let Sa,Eb,Jb;Sa=$a.j5a.equals($a.yg)?this.Me.J(Hb).Lj:this.Me.J(Ya).Lj;$a=$a.k5a===$a.Wc?this.Me.J(Hb).Wc:this.Me.J(Ya).Wc;Eb=this.Me.J(Hb).Lj;Hb=this.Me.J(Hb).Wc;Jb=this.Me.J(Ya).Lj;Ya=this.Me.J(Ya).Wc;return{j5a:Sa,
k5a:$a,YRf:Eb,sen:Hb,$dn:Jb,aen:Ya}}K3l($a,Hb){let Ya;var Sa=$a.yg.equals($a.fu)?$a.U7:$a.fu;const Eb=$a.Wc===$a.pua?$a.wba:$a.pua;$a.yg.equals($a.fu)?Ya=this.Me.J(Hb).Lj:(Ya=Sa,Sa=this.Me.J(Hb).Lj);$a.Wc===$a.pua?($a=this.Me.J(Hb).Wc,Hb=Eb):($a=Eb,Hb=this.Me.J(Hb).Wc);return{fu:Ya,U7:Sa,pua:$a,wba:Hb}}pBh($a,Hb,Ya,Sa){for(;Sa<$a.length;Sa++){if(!$a.J(Sa).S4()&&6!==$a.J(Sa).type&&2!==$a.J(Sa).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+$a.J(Sa).type);break}$a.J(Sa).Lj=
Hb;if(2===$a.J(Sa).type){$a.J(Sa).Wc=Ya;break}}}oBh($a,Hb,Ya,Sa,Eb){this.pBh($a,Ya,Sa,Eb);ua.qBh($a,Hb,Eb)}nBh($a,Hb,Ya,Sa){this.pBh($a,Hb,Ya,Sa+1);ua.qBh($a,Hb,Sa)}k$h($a,Hb,Ya){let Sa,Eb=-1;if(!({dha:Sa}=Y(Hb,$a.yg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Ya+"for GraphNodeId "+$a.yg),{returnValue:!1,eWd:Sa};if(!({dha:Eb}=T(Hb,Sa+1)).returnValue||!Hb.J(Eb).Lj.equals($a.U7))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
Sa+1+" in "+Ya+" of length "+Hb.length),{returnValue:!1,eWd:Sa};this.nBh(Hb,$a.j5a,$a.k5a,Sa);return{returnValue:!0,eWd:Sa}}j$h($a,Hb,Ya){let Sa;const Eb=Ya?this.base:this.Me,Jb=Ya?"Base":"Derived",vb=({Tha:Hb,cxa:Ya,Jga:Sa}=this.GIa($a.yg,Hb,Ya,$a.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===vb||2===vb)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Jb),{returnValue:vb,Yyf:Hb,poi:Ya,Jga:Sa};this.oBh(Eb,$a.fu,$a.U7,$a.wba,Hb);return{returnValue:vb,
Yyf:Hb,poi:Ya,Jga:Sa}}b$h($a,Hb,Ya){return({idx:$a}=W(Hb,$a.yg)).returnValue?2!==Hb.J($a).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Ya),{returnValue:!1,dWd:-1}):{returnValue:!0,dWd:$a}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Ya),{returnValue:!1,dWd:-1})}ECn($a,Hb){var Ya=this.Me.J($a);if(Hb){let Sa;({dha:Sa}=Y(this.Me,Hb,0));Ya=Ya.clone();Ya.Lj=Hb;this.Me.tG($a);this.Me.insert(Sa,
Ya)}else this.Me.length>$a&&(this.Me.J($a+1).S4()||2===this.Me.J($a+1).type)&&(Ya.Lj=this.Me.J($a+1).Lj)}Wai($a,Hb,Ya){var Sa=Hb?this.base:this.Me;Hb=Hb?"Base":"Derived";Ya=new H.a(Ya,$a.yg,$a.Wc);if($a.fu){if(!({dha:Sa}=Y(Sa,$a.fu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",$a.fu,Hb),{returnValue:!1,fOf:Ya,Xyf:Sa};Sa+=1}else Sa=0;return{returnValue:!0,fOf:Ya,Xyf:Sa}}a3h($a){let Hb;Hb=null;let Ya=$a-1;if(-1===
Ya)return{returnValue:!0,fu:Hb};6===this.Me.J(Ya).type&&Ya--;if(2===this.Me.J(Ya).type||4===this.Me.J(Ya).type)return Hb=this.Me.J(Ya).Lj,{returnValue:!0,fu:Hb};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Me.J($a-1).type);return{returnValue:!1,fu:Hb}}bQc($a,Hb,Ya,Sa){let Eb,Jb=!0;Eb=-1;if(Ya>$a.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Ijb:Eb};
if(Ya<$a.length){if(-1<Ya&&Ya<$a.length&&!$a.J(Ya).Gm){Jb=!1;for(var vb=Ya+1;vb<$a.length;vb++)if($a.J(vb).Gm){Ya=vb;Jb=!0;break}}if(!Jb)return{returnValue:!1,Ijb:Eb};Jb=!1;for(vb=0;$a.J(Ya)&&vb<Hb.length;vb++)if(Hb.J(vb).Gm===$a.J(Ya)){Eb=vb;Jb=!0;break}if(!Jb)return{returnValue:!1,Ijb:Eb}}else Eb=Hb.length;if(0<Eb&&Sa&&!Hb.J(Eb-1).Gm){for($a=Eb-1;0<=$a&&!Hb.J($a).Gm;$a--);Eb=$a+1;6===Hb.J(Eb).type&&5!==this.Yd.input.source&&Eb++}return{returnValue:!0,Ijb:Eb}}GIa($a,Hb,Ya,Sa,Eb,Jb){let vb;var ac;
let dc;var Cc=this.base;let Ec=this.Me,rc=!1;Ya||(Cc=this.Me,Ec=this.base);dc=ac=vb=0;let hb,fb,Nb=0;if(!({GRc:Sa,Bmb:hb,m0c:fb}=P(Cc,$a,Sa)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Tha:vb,cxa:ac,Jga:dc};0<=Sa&&Sa<Cc.length&&!Cc.J(Sa).Gm&&hb&&!Eb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Jb),this.f3=!0,Nb=Hb===Cc.J(Sa).source?1:2,rc=!0);Eb&&!Cc.J(Sa)&&Sa--;Eb&&hb&&!Cc.J(Sa).Gm&&(hb=!1,fb=0);if(!Ya&&!({idx:$a}=W(Ec,$a)).returnValue&&!hb)return{returnValue:0,Tha:Sa,cxa:ac,Jga:dc};if(!({Ijb:$a}=this.bQc(Cc,Ec,Sa,Ya&&!hb)).returnValue&&!rc&&(Hb=!1,1===this.gjh&&0<Sa&&!fb&&(Sa--,{Ijb:$a,returnValue:Hb}=this.bQc(Cc,Ec,Sa,Ya&&!hb),Hb&&(Sa++,$a<Ec.length-1?$a++:Hb=!1)),!Hb))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.Yd.logger.Pg(Object.assign(new fa.a,{uj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.f3=!0,{returnValue:3,Tha:vb,cxa:ac,Jga:dc};if(hb&&(!K(Cc,Sa,fb)||!rc&&!K(Ec,$a,fb)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Tha:vb,cxa:ac,Jga:dc};vb=Sa;ac=$a;hb&&(vb=Sa+1,rc||(ac=Cc.J(Sa),Ya=Ec.J($a),ac.Gm=Ya,Ya.Gm=ac,Cc=Cc.J(Sa+1),ac=Ec.J($a+1),Cc.Gm=ac,ac.Gm=
Cc,ac=$a+1));if(ac>=Ec.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+ac+" secondaryList length was "+Ec.length),{returnValue:3,Tha:vb,cxa:ac,Jga:dc};for(Cc=0;Cc<ac;Cc++)Ec.J(Cc).Lj.equals(Ec.J(ac).Lj)&&(dc+=Ec.J(Cc).length);return{returnValue:Nb,Tha:vb,cxa:ac,Jga:dc}}adf($a,Hb,Ya){this.yMg.contains($a.id)&&this.Tcb.Z($a.id,new k.a);for(--Ya;Ya>=Hb;Ya--)this.yMg.contains($a.id)?this.Tcb.J($a.id).insert(this.Tcb.J($a.id).length,
this.Me.J(Ya)):this.Me.J(Ya).Gm&&(this.Me.J(Ya).Gm.Gm=null),this.Me.tG(Ya)}IAf($a,Hb,Ya){if(this.Tcb.nb($a.Nu)){const Sa=this.Tcb.J($a.Nu);for(let Eb=0;Eb<Sa.length;Eb++)Sa.J(Eb).Lj=Ya.Lj,Object(ia.a)(H.a,Ya)&&Object(ia.a)(H.a,Sa.J(Eb))&&(Sa.J(Eb).Wc=Ya.Wc);this.Me.aD(Hb,this.Tcb.J($a.Nu));this.Tcb.remove($a.Nu)}else this.Me.insert(Hb,Ya)}Tgm($a){let Hb,Ya;Ya=Hb=-1;if(!$a.Gm)return{returnValue:!1,h6b:Hb,vdf:Ya};var Sa;let Eb=0,Jb=!1;if(!({idx:Sa}=W(this.Me,$a.Gm.Lj)).returnValue)return{returnValue:!1,
h6b:Hb,vdf:Ya};for(;Sa<this.Me.length;Sa++){if($a.Gm===this.Me.J(Sa)){Hb=Sa;Ya=Eb;Jb=!0;break}Eb+=this.Me.J(Sa).length}return{returnValue:Jb,h6b:Hb,vdf:Ya}}Gjf($a){let Hb;Hb=new k.a;let Ya=0,Sa=0;for(;Ya<$a.length;){if(Sa>=this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Rnc:Hb};if($a.J(Ya).length>this.base.J(Sa).length){if(!K($a,Ya,this.base.J(Sa).length))return a.a.instance.Ua(17335389,1,
2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Ya,this.base.J(Sa).length),{returnValue:!1,Rnc:Hb}}else if($a.J(Ya).length<this.base.J(Sa).length){var Eb=!!this.base.J(Sa).Gm,Jb=0;if(Eb&&!({Ijb:Jb}=this.bQc(this.base,this.Me,Sa,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Sa),
{returnValue:!1,Rnc:Hb};if(!K(this.base,Sa,$a.J(Ya).length)||Eb&&!K(this.Me,Jb,$a.J(Ya).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,Rnc:Hb};if(Eb){Eb=this.base.J(Sa);var vb=this.Me.J(Jb);Eb.Gm=vb;vb.Gm=Eb;Eb=this.base.J(Sa+1);Jb=this.Me.J(Jb+1);Eb.Gm=Jb;Jb.Gm=Eb}}if(this.base.J(Sa).Gm&&5!==this.base.J(Sa).type&&this.base.J(Sa).S4()&&(Jb=this.base.J(Sa),Eb=$a.J(Ya),!Jb.rJ.equals(Eb.rJ)||
!Jb.DF.IA(Eb.DF))){let ac;if(!({h6b:vb,vdf:ac}=this.Tgm(this.base.J(Sa))).returnValue)return{returnValue:!1,Rnc:Hb};Hb.add(new ta(this.Me.J(vb).Lj,ac,Jb,Eb))}Ya++;Sa++}return{returnValue:!0,Rnc:Hb}}static qBh($a,Hb,Ya){for(--Ya;0<=Ya;Ya--){if(!$a.J(Ya).S4()&&6!==$a.J(Ya).type){a.a.instance.shipAssertTag(17311187,1,2===$a.J(Ya).type||4===$a.J(Ya).type,"Found merge block of type "+$a.J(Ya).type);break}$a.J(Ya).Lj=Hb}}static gwi($a){return $a?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),
!0)}}Object(D.a)(ua,"ParagraphMergeUsingHintsTwinList",null,[1833]);var ib=c(1730),bb=c(1731),mb=c(1727),yb=c(1729),ab=c(1728);class Ga{constructor($a,Hb,Ya,Sa){this.cp=$a;this.length=Hb;this.YCd=Ya;this.Mcd=Sa}}Object(D.a)(Ga,"UpdateFormattingIdsPosInfo",null,[]);class Za{constructor($a,Hb,Ya){this.f3=!1;this.Tcb=new y.a;this.H5g=!1;this.Yd=$a;this.gjh=Ya;this._base=Hb;this.Bxe=Z(Hb);if(!M(this.base,this.Me))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),$a.logger.Pg(Object.assign(new J.a,
{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.Yd.runtime.Zb.gjb(1000010)&&(this.H5g=!0)}get base(){return this._base}get Me(){return this.Bxe}get mergeConflict(){return this.f3}z1e($a,Hb){switch($a.type){case 11:return this.cDk($a,Hb);case 8:return this.Y0e($a,Hb);case 10:return this.W0e($a);default:return!1}}y1e($a,Hb){switch($a.type){case 11:return this.bDk($a,Hb);case 8:return this.X0e($a,Hb);case 10:return this.V0e($a);default:return{returnValue:!1,zu:null}}}$sh(){a.a.instance.Ua(574433295,
1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}Zsh(){a.a.instance.Ua(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Gjf($a){let Hb;Hb=new k.a;let Ya=0,Sa=0,Eb=0;for(;Ya<$a.length;){if(Sa>=this.base.length)return a.a.instance.shipAssertTag(574433297,
1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,Lcd:Hb};if($a.J(Ya).length>this.base.J(Sa).length){if(!K($a,Ya,this.base.J(Sa).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",
eventId:"8ps6s"})),{returnValue:!1,Lcd:Hb}}else if($a.J(Ya).length<this.base.J(Sa).length&&!this.X7a(Eb+$a.J(Ya).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Lcd:Hb};if(this.base.J(Sa).Gm&&5!==this.base.J(Sa).type&&this.base.J(Sa).S4()){const Jb=this.base.J(Sa),vb=$a.J(Ya);if(!Jb.rJ.equals(vb.rJ)||
!Jb.DF.IA(vb.DF)){let ac,dc;if(({h6b:ac,hQh:dc}=this.Ugm(this.base.J(Sa))).returnValue)Hb.add(new Ga(dc,this.Me.J(ac).length,Jb,vb));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Lcd:Hb}}}Eb+=this.base.J(Sa).length;Ya++;Sa++}return{returnValue:!0,Lcd:Hb}}cDk($a,Hb){let Ya;if(!({jEa:Ya}=
this.X7a($a.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let Eb=0;Eb<$a.p0.length;Eb++)switch($a.p0.J(Eb).type){case 7:var Sa=$a.p0.J(Eb);this.Me.insert(Ya,new Ca(Hb,null,Sa.text,Sa.id));break;case 9:Sa=$a.p0.J(Eb);this.Me.insert(Ya,new H.a(Hb,Sa.yg,Sa.Wc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Yd.logger.Pg(Object.assign(new J.a,
{uj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Y0e($a,Hb){let Ya,Sa;if(!({jEa:Ya}=this.X7a($a.cp,!0)).returnValue||!({jEa:Sa}=this.X7a($a.cp+$a.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for($a=Sa;$a>=Ya;$a--)this.Me.J($a).source!==Hb&&this.IJd(this.Me,$a);return!0}W0e($a){let Hb;if(!({jEa:Hb}=this.X7a($a.cp,!0)).returnValue)return a.a.instance.Ua(574433302,
1,2,"ApplyDeleteParaHintToDerived"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.ddf(this.Me,$a,Hb);return!0}bDk($a,Hb){let Ya;Ya=null;let Sa,Eb;if(!({SAb:Sa,jEa:Eb}=this.X7a($a.cp,!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,zu:Ya};var Jb=this.mof(this.Me,Eb-1);
Jb=new ab.a(Jb);for(let vb=0;vb<$a.p0.length;vb++)switch($a.p0.J(vb).type){case 7:Jb.p0.add(this.b1e($a.p0.J(vb),Hb,Sa,Eb));break;case 9:Jb.p0.add(this.dDk($a.p0.J(vb),Hb,Sa,Eb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,zu:Ya}}Ya=new k.a;Ya.add(Jb);return{returnValue:!0,zu:Ya}}b1e($a,Hb,Ya,Sa){const Eb=new Ca(Hb,$a.yg,$a.text,$a.id);Hb=new Ca(Hb,
$a.yg,$a.text,$a.id);Eb.Gm=Hb;Hb.Gm=Eb;this.base.insert(Ya,Eb);this.Me.insert(Sa,Hb);Ya=new yb.a($a.yg,$a.text);Ya.id=$a.id;return Ya}dDk($a,Hb,Ya,Sa){const Eb=new H.a(Hb,$a.yg,$a.Wc);Hb=new H.a(Hb,$a.yg,$a.Wc);Eb.Gm=Hb;Hb.Gm=Eb;this.base.insert(Ya,Eb);this.Me.insert(Sa,Hb);return new mb.a($a.yg,$a.Wc)}X0e($a){let Hb;Hb=new k.a;let Ya;var Sa;let Eb;if(!({SAb:Ya,jEa:Sa}=this.X7a($a.cp,!0)).returnValue||!({SAb:Eb,jEa:Jb}=this.X7a($a.cp+$a.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,
1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,zu:Hb};this.Yd.runtime.Zb.FUd(1000010);for($a=Jb;$a>=Sa;$a--)if(this.Me.J($a).Gm){var Jb=$a;const vb=({TRf:$a}=this.CBl($a,Sa)).returnValue;vb&&(Hb.add(vb),this.IJd(this.Me,$a,Jb))}for(Sa=Eb;Sa>=Ya;Sa--)this.IJd(this.base,Sa);return{returnValue:!0,zu:Hb}}V0e($a){let Hb;Hb=null;let Ya,Sa;if(!({SAb:Ya,jEa:Sa}=this.X7a($a.cp,!0)).returnValue)return a.a.instance.Ua(574433305,
1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,zu:Hb};if(!this.ddf(this.base,$a,Ya))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,zu:Hb};this.ddf(this.Me,$a,Sa)&&(Hb=new k.a,Hb.add(new ib.a(this.mof(this.Me,Sa-1),$a.yg,$a.Wc)));
return{returnValue:!0,zu:Hb}}X7a($a,Hb){var Ya;var Sa=Ya=-1;let Eb,Jb;if(!({Bmb:Jb,Kvh:$a,Jvh:Eb}=N(this.base,$a,this.Yd.logger)).returnValue)return{returnValue:!1,SAb:Ya,jEa:Sa};const vb=$a>=this.base.length;vb&&$a--;if(this.base.J($a).Gm){const ac=this.aDl(this.Me,this.base.J($a));if(Jb){if(0>ac||!K(this.base,$a,Eb)||!K(this.Me,ac,Eb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,
SAb:Ya,jEa:Sa};Ya=this.base.J($a);Sa=this.Me.J(ac);Ya.Gm=Sa;Sa.Gm=Ya;Ya=this.base.J($a+1);Sa=this.Me.J(ac+1);Ya.Gm=Sa;Sa.Gm=Ya;Ya=Hb?$a+1:$a;Sa=Hb?ac+1:ac}else Hb?(Ya=vb?$a+1:$a,Sa=vb?ac+1:ac):(Ya=vb?$a:$a-1,Sa=vb?ac:ac-1)}else if(Jb){if(K(this.base,$a,Eb))Ya=Hb?$a+1:$a;else return a.a.instance.Ua(575706445,1,2,"SplitTwinListAndFindIdx"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,SAb:Ya,jEa:Sa};Hb?(Sa=({FHb:Sa}=this.Q7b(this.base,this.Me,
$a,!1)).returnValue?Sa+1:0,Sa=Sa>=this.Me.length?this.Me.length-1:Sa):(Sa=({FHb:Sa}=this.Q7b(this.base,this.Me,$a,!0)).returnValue?Sa-1:this.Me.length-1,Sa=0>Sa?0:Sa)}else Hb?(({FHb:Sa}=this.Q7b(this.base,this.Me,$a,!0)).returnValue||(({FHb:Sa}=this.Q7b(this.base,this.Me,$a,!1)).returnValue?Sa+=1:(Sa=vb?this.Me.length-1:0,Sa=0>Sa?0:Sa)),Ya=vb?$a+1:$a):(({FHb:Sa}=this.Q7b(this.base,this.Me,$a,!1)).returnValue||(({FHb:Sa}=this.Q7b(this.base,this.Me,$a,!0)).returnValue?--Sa:(Sa=$a?this.Me.length-1:0,
Sa=0>Sa?0:Sa)),Ya=vb?$a:$a-1);return{returnValue:!0,SAb:Ya,jEa:Sa}}Q7b($a,Hb,Ya,Sa){let Eb=null;if(Sa)for(;Ya<$a.length;Ya++){if($a.J(Ya).Gm){Eb=$a.J(Ya).Gm;break}}else for(;0<=Ya;Ya--)if($a.J(Ya).Gm){Eb=$a.J(Ya).Gm;break}if(Eb)for($a=0;$a<Hb.length;$a++)if(Hb.J($a)===Eb)return Hb=$a,{returnValue:!0,FHb:Hb};return{returnValue:!1,FHb:-1}}aDl($a,Hb){for(let Ya=0;Ya<$a.length;Ya++)if($a.J(Ya).Gm===Hb)return Ya;return-1}IJd($a,Hb,Ya=-1){for(Ya=0>Ya?Hb:Ya;Ya>=Hb;Ya--)$a.J(Ya).Gm&&($a.J(Ya).Gm.Gm=null),
$a.tG(Ya)}mof($a,Hb){let Ya=0;for(;0<=Hb;Hb--)Ya+=$a.J(Hb).length;return Ya}ofm($a){$a=Object(m.a)(za.a,$a);$a||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"GetTextBlock",eventId:"8ujvq"})));return $a}CBl($a,Hb){let Ya="",Sa=$a;for(;Sa>=Hb&&this.Me.J(Sa).Gm&&2!==this.Me.J(Sa).type;)Ya=this.ofm(this.Me.J(Sa)).text+Ya,Sa--;Hb=0>Sa?0:this.mof(this.Me,Sa);return!this.H5g||Sa<$a?($a=Sa+1,{returnValue:new bb.a(Hb,Ya),TRf:$a}):{returnValue:null,TRf:Sa}}Ugm($a){let Hb,
Ya,Sa=!1;Ya=Hb=0;if(!$a.Gm)return{returnValue:!1,h6b:Hb,hQh:Ya};for(Hb=0;Hb<this.Me.length;Hb++){if(this.Me.J(Hb).Gm===$a){Sa=!0;break}Ya+=this.Me.J(Hb).length}return{returnValue:Sa,h6b:Hb,hQh:Ya}}ddf($a,Hb,Ya){Ya=Ya===$a.length?--Ya:Ya;Ya>$a.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"DeleteEopInList",eventId:"8ffwf"})));if(2===$a.J(Ya).type){const Sa=$a.J(Ya);if(Sa.Lj!==Hb.yg||Sa.Wc!==Hb.Wc)return!1;this.IJd($a,Ya);return!0}return!1}}
Object(D.a)(Za,"ParagraphMergeUsingHintsTwinListLcs",null,[1833]);var Ub=c(1575),Xb=c(1542),zb=c(1726);c.d(I,"a",function(){return Ib});class Ib{constructor($a,Hb,Ya,Sa,Eb,Jb,vb=null,ac=null,dc=null){this.vQ=this.iua=this.XKa=this.ksa=null;this._initialized=!1;this.Yd=$a;this.LF=Hb;this.xCa=Sa;this.fBa=Ya;this.Nsa=Eb;this.wte=new f.a;for($a=0;$a<this.LF.length;$a++)this.wte.add(this.LF.J($a).id);this.yTg=new f.a;for($a=0;$a<this.fBa.length;$a++)this.yTg.add(this.fBa.J($a).id);this.Uih=new f.a;for($a=
0;$a<this.xCa.length;$a++)this.Uih.add(this.xCa.J($a).id);this.Og=Jb;this.hWe=vb||G.a.instance;this.CI=ac;this.VW=dc;this.Rvb=1===(this.CI&&this.VW&&1===this.CI.uJa&&1===this.VW.uJa?1:0);this.Msa=0}get A9f(){return 1!==this.Msa}Zzm(){var $a=!0;if(this.CI&&this.VW)return $a;if(this.CI||this.VW)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.Yd.runtime.Ku.nb(v.a.ML)&&($a=this.Yd.runtime.Ku.J(v.a.ML),$a=this.Upg($a,this.Yd.runtime.DDa.id,"favored")&&({updateHints:this.CI}=this.wqi($a,this.wte,this.yTg,this.Yd.runtime.Ku,"favored")).returnValue);$a&&this.Yd.runtime.Kq.nb(v.a.ML)&&($a=this.Yd.runtime.Kq.J(v.a.ML),$a=this.Upg($a,this.Yd.runtime.DDa.id,"unfavored")&&({updateHints:this.VW}=this.wqi($a,this.wte,this.Uih,this.Yd.runtime.Kq,"unfavored")).returnValue);this.CI=this.CI?this.CI:new zb.a(new k.a,0);this.VW=this.VW?this.VW:
new zb.a(new k.a,0);$a&&this.Yd.input.HHb&&($a=this.Yd.input.P$.last().o2a(v.a.ML),$a=this.Upg($a,this.Yd.input.P$.last().iX.id,"alreadyMerged"));return $a}fym(){const $a=new f.a;if(this.Rvb)return $a;const Hb=this.CI?this.CI.updateHints.I5():new k.a;let Ya=0;for(;Ya<Hb.length-1;){const Sa=Hb.J(Ya);let Eb,Jb=!1;for(Eb=Ya+1;Eb<Hb.length;Eb++){const vb=Hb.J(Eb);if(Sa.Mxi(vb)){$a.add(Sa.id);Hb.tG(Eb);Hb.tG(Ya);Jb=!0;break}}Jb||Ya++}return $a}Upg($a,Hb,Ya){$a=this.Og.getPropertyString($a,l.a.$Ua);$a=
x.a.Ff($a);return Hb.equals($a)?!0:(this.J8c(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.Yd.runtime.DDa.id,$a,Ya),!1)}wqi($a,Hb,Ya,Sa,Eb){let Jb;Jb=new zb.a(new k.a,0);$a=this.Og.getPropertyObjectIds($a,l.a.W1).I5();for(let ac=0;ac<$a.length;ac++){if(!Sa.nb($a.J(ac)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
$a.J(ac),Eb),{returnValue:!1,updateHints:Jb};const dc=Sa.J($a.J(ac));var vb=x.a.Ff(this.Og.getPropertyString(dc,l.a.rka));if(Hb.contains(vb)||Ya.contains(vb)){vb=this.hWe.qRc(dc);if(!vb)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",dc.id,Eb),{returnValue:!1,updateHints:Jb};Jb.updateHints.add(vb)}}0<$a.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
Eb,$a.fr(),Jb.updateHints.fr());return{returnValue:!0,updateHints:Jb}}jzm(){return({MK:this.ksa,gNc:this.XKa,fcd:this.iua}=Ub.a.jLh(this.Yd,this.Og,this.LF,this.fBa,this.xCa,this.Nsa,!0,!0)).returnValue?!0:!1}Xzm($a){const Hb=Ub.a.rId(this.Og,Ya=>this.Yd.runtime.sk.J(Ya),this.LF,1,this.Nsa,!0,!0).returnValue;if(!Hb)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.vQ=this.Rvb?new Za(this.Yd,Hb,1):new ua(this.Yd,Hb,$a,
this.CI?this.CI.uJa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.Zzm()||!this.jzm())return!1;const $a=this.fym();return this.Xzm($a)?!0:!1}Yai($a){const Hb=new k.a;let Ya="";for(let Sa=0;Sa<$a.length;Sa++){const Eb=$a.J(Sa);Eb.S4()?Ya+=$a.J(Sa).text:2===Eb.type?(Hb.add(new la(Eb.Lj,Eb.type,Ya,Eb.Wc)),Ya=""):4===Eb.type&&(Hb.add(new la(Eb.Lj,Eb.type)),Ya="")}return Hb}validateUpdateHintsAreComplete($a,Hb,Ya){Hb=this.Yai(Hb);$a=this.Yai($a);let Sa=Hb.length===
$a.length;if(Sa)for(let Eb=0;Eb<Hb.length;Eb++)if(!Hb.J(Eb).isEqual($a.J(Eb))){Sa=!1;break}Sa||(this.J8c(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Ya,$a.fr(),Hb.fr()));return Sa}Fth($a,Hb,Ya){(Hb=({T8a:$a}=this.MEk($a,Hb,Ya)).returnValue)||this.J8c(this.vQ.mergeConflict?1:3);return{returnValue:Hb,T8a:$a}}MEk($a,Hb,Ya){let Sa;Sa=new k.a;let Eb=!0;var Jb=
0;let vb=null,ac=this.CI?this.CI.updateHints.length:0;for(var dc=0;dc<ac&&Eb;dc++)vb=this.CI.updateHints.J(dc),Jb<this.VW.updateHints.length&&vb.id.equals(this.VW.updateHints.J(Jb).id)&&5!==this.Yd.input.source?({returnValue:Eb}=this.vQ.y1e(vb,2),Jb++):Eb=this.vQ.z1e(vb,2);if(!Eb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",vb.toString()),{returnValue:!1,T8a:Sa};if(!this.validateUpdateHintsAreComplete(this.vQ.Me,this.XKa,"Favored"))return{returnValue:!1,
T8a:Sa};if($a&&1===this.Yd.input.Fia&&!this.vQ.$sh(Hb,Ya,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Hb,Ya),{returnValue:!1,T8a:Sa};Eb=!0;dc=new k.a;for(ac=this.VW?this.VW.updateHints.length:0;Jb<ac&&Eb;Jb++){vb=this.VW.updateHints.J(Jb);let Cc;({zu:Cc,returnValue:Eb}=this.vQ.y1e(vb,4));Eb&&Cc&&dc.aD(dc.length,Cc)}return Eb?this.validateUpdateHintsAreComplete(this.vQ.base,this.iua,"Unfavored")?$a&&2===this.Yd.input.Fia&&!this.vQ.Zsh(Hb,
Ya,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Hb,Ya),{returnValue:!1,T8a:Sa}):{returnValue:!0,T8a:dc}:{returnValue:!1,T8a:Sa}:(a.a.instance.Ua(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",vb.id,vb.type),{returnValue:!1,T8a:Sa})}p2l(){let $a,Hb=0;let Ya=0,Sa=x.a.nil;for($a=new y.a;Ya<this.vQ.base.length;){const vb=this.vQ.base.J(Ya);Sa.equals(vb.Lj)||(Hb=0,Sa=vb.Lj);if(5===vb.type){var Eb=
Hb+vb.length;var Jb=void 0;let ac;const dc=Z(this.iua);if(!({index:Jb}=O(dc,vb.Lj,Hb)).returnValue||!({index:ac}=O(dc,vb.Lj,Eb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",vb.ucd),{returnValue:!1,$Mi:$a};for(Eb=new k.a;Jb<ac;Jb++)Eb.add(dc.J(Jb));$a.Z(vb.ucd,Eb)}Hb+=vb.length;Ya++}return{returnValue:!0,$Mi:$a}}q2l(){let $a;$a=new y.a;let Hb=0;for(let Sa=
0;Sa<this.vQ.base.length;Sa++){const Eb=this.vQ.base.J(Sa);if(5===Eb.type){var Ya=void 0;let Jb;const vb=Z(this.iua);if(!({index:Ya}=V(vb,Hb,this.Yd.logger)).returnValue||!({index:Jb}=V(vb,Hb+Eb.length,this.Yd.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,aNi:$a};const ac=new k.a;for(;Ya<Jb;Ya++)ac.add(vb.J(Ya));$a.Z(Eb.ucd,ac)}Hb+=Eb.length}return{returnValue:!0,aNi:$a}}zDk($a){let Hb;Hb=
new k.a;let Ya;if(this.Rvb){if(!({aNi:Ya}=this.q2l()).returnValue)return{returnValue:!1,N_c:Hb}}else if(!({$Mi:Ya}=this.p2l()).returnValue)return{returnValue:!1,N_c:Hb};let Sa;Sa=this.Rvb?new Za(this.Yd,Z(this.XKa),1):new ua(this.Yd,Z(this.XKa),new f.a,this.CI?this.CI.uJa:0);for(var Eb=0;Eb<$a.length;Eb++)if(!Sa.z1e($a.J(Eb),4))return{returnValue:!1,N_c:Hb};for($a=Sa.Me.length-1;0<=$a;$a--)5===Sa.Me.J($a).type&&(Eb=Sa.Me.J($a).ucd,Sa.Me.tG($a),Sa.Me.aD($a,Ya.J(Eb)));this.Rvb&&(this.qOh(Sa.Me),this.qOh(this.vQ.Me));
if(!this.validateUpdateHintsAreComplete(this.vQ.Me,Sa.Me,"Merged"))return{returnValue:!1,N_c:Hb};Hb=Sa.Me;return{returnValue:!0,N_c:Hb}}qOh($a){const Hb=new y.a;for(let Ya=$a.length-1;0<=Ya;Ya--){const Sa=Object(m.a)(H.a,$a.J(Ya));Sa&&(Hb.nb(Sa.Wc)?Hb.J(Sa.Wc).source!==Sa.source&&$a.tG(Ya):Hb.add(Sa.Wc,Sa))}}LEk($a){let Hb;if(!({Lcd:Hb}=this.vQ.Gjf(Z(this.iua))).returnValue)return!1;for(let Sa=0;Sa<Hb.length;Sa++){const Eb=Hb.J(Sa);let Jb,vb;if(!({index:Jb}=V($a,Eb.cp,this.Yd.logger)).returnValue||
!({index:vb}=V($a,Eb.cp+Eb.length,this.Yd.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Yd.logger.Pg(Object.assign(new J.a,{uj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Ya=!1;for(let ac=Jb;ac<vb&&!Ya;ac++)Ya=!Eb.YCd.rJ.equals($a.J(ac).rJ);if(!Ya){for(Ya=Jb;Ya<vb;Ya++)$a.tG(Jb);$a.insert(Jb,Eb.Mcd)}}return!0}KEk($a){let Hb;if(!({Rnc:Hb}=this.vQ.Gjf(Z(this.iua))).returnValue)return!1;for(let Eb=0;Eb<Hb.length;Eb++){var Ya=
Hb.J(Eb);let Jb,vb;if(({index:Jb}=O($a,Ya.yg,Ya.cp)).returnValue&&({index:vb}=O($a,Ya.yg,Ya.cp+Ya.Mcd.length)).returnValue){var Sa=!1;for(let ac=Jb;ac<vb&&!Sa;ac++)Sa=!Ya.YCd.rJ.equals($a.J(ac).rJ)||!Ya.YCd.DF.IA($a.J(ac).DF);if(Sa){if(this.CI&&1===this.CI.uJa||this.VW&&1===this.VW.uJa)return!1}else{for(Sa=Jb;Sa<vb;Sa++)$a.tG(Jb);$a.insert(Jb,Ya.Mcd)}}else if(Ya=Ya.Mcd.XFm,a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",
Ya),Ya||this.CI&&1===this.CI.uJa||this.VW&&1===this.VW.uJa)return!1}return!0}v7l($a){let Hb,Ya;Ya=new k.a;Hb=this.Yd.runtime.qn.J(v.a.ML);let Sa;({nOf:Sa}=Ib.z3h(this.Yd,this.Og));const Eb=new k.a;for(let vb=0;vb<$a.length;vb++){if(Sa.contains($a.J(vb).id,(dc,Cc)=>dc.equals(Cc)))continue;if(this.Yd.runtime.qn.nb($a.J(vb).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",$a.J(vb).id),{returnValue:!1,C9d:Hb,B9d:Ya};Eb.add($a.J(vb).id);
var Jb=$a.J(vb).t2a();const ac=new Xb.a(Jb);Jb=Jb.Jl();for(const dc of Jb)ac.zC(dc);Ya.add(ac)}$a=this.Og.getPropertyObjectIds(Hb.zm,l.a.W1);$a.aD($a.length,Eb);this.Og.setPropertyObjectIds(Hb.zm,l.a.W1,$a);return{returnValue:!0,C9d:Hb,B9d:Ya}}EQd($a){return String.format("Name: {0}, Message: {1}, Stack: {2}",$a.name,$a.message,$a.stack)}J8c($a){0===this.Msa&&(this.Msa=$a)}Dnc(){let $a;$a=null;let Hb,Ya;var Sa;try{if({qn:$a,C9d:Hb,B9d:Ya,returnValue:Sa}=this.nMo(),Sa){if(Hb&&Ya){this.Yd.runtime.qn.Z(Hb.zm.id,
Hb);for(Sa=0;Sa<Ya.length;Sa++){const ac=Ya.J(Sa);this.Yd.runtime.qn.Z(ac.zm.id,ac)}const Eb=Hb.zm,Jb=this.Og.getPropertyObjectIds(Eb,l.a.W1),vb=this.Og.getPropertyString(Eb,l.a.$Ua);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Jb.fr(),vb)}else a.a.instance.Ua(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,qn:$a}}}catch(Eb){a.a.instance.Ua(17162313,
1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.EQd(Eb))}this.J8c(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Msa,this.A9f);this.V4a();this.CI&&1===this.CI.uJa&&this.Yd.logger.Pg(Object.assign(new ea.a,{eventId:"bc04c",uj:"ParagraphMergeUsingHints.TryDoMerge",info:r[this.Msa]+"/LCS"}));return{returnValue:!1,qn:$a}}nMo(){let $a,Hb,Ya;Ya=Hb=$a=null;let Sa;Sa=this.initialize();
this.Yd.logger.OU("PMUH Initialize");let Eb=null;Sa=Sa&&({T8a:Eb}=this.Fth(!1,x.a.nil,0)).returnValue;this.Yd.logger.OU("PMUH ApplyUpdateHints");let Jb=new k.a;Sa=Sa&&({N_c:Jb}=this.zDk(Eb)).returnValue;this.Yd.logger.OU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Sa=this.Rvb?Sa&&this.LEk(Jb):Sa&&this.KEk(Jb);this.Yd.logger.OU("PMUH ApplyUnfavoredFormattingChanges");this.Rvb&&!this.g6n(Jb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Yd.logger.Pg(Object.assign(new J.a,
{uj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Sa=!1);const vb=this.uSd(Jb);Sa=Sa&&({A9d:$a}=Ub.a.nQc(this.Yd,this.Og,this.Nsa,Jb,vb)).returnValue;this.Yd.logger.OU("PMUH GetMergeableObjectsFromMergeBlocks");this.CI&&1===this.CI.uJa&&this.VW&&1===this.VW.uJa||(Sa=Sa&&({C9d:Hb,B9d:Ya}=this.v7l(F(Eb))).returnValue,this.Yd.logger.OU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Sa,mergeConflict:!!this.vQ&&this.vQ.mergeConflict,qn:$a,C9d:Hb,B9d:Ya}}uSd($a){const Hb=new k.a;for(let Ya=
0;Ya<$a.length;Ya++)2===$a.J(Ya).type&&Hb.add($a.J(Ya).Lj);return Hb}epf($a){const Hb=new k.a;for(let Ya=0;Ya<$a.length;Ya++)2===$a.J(Ya).type&&Hb.add($a.J(Ya));return Hb}g6n($a){var Hb=this.epf(this.ksa),Ya=this.epf(this.XKa),Sa=this.epf(this.iua),Eb=this.uSd(Hb),Jb=this.uSd(Ya),vb=this.uSd(Sa);Jb=L.b(Eb,Jb,vb);Eb=new k.a;for(vb=0;vb<Jb.length;vb++)Eb.aD(Eb.length,Jb.J(vb).cDl());Jb=this.hDl($a);Hb=this.dDl(Jb,Eb,Hb,Ya,Sa);Ya=0;Sa=new f.a;for(Eb=0;Eb<$a.length;Eb++)if(Jb=$a.J(Eb),2===Jb.type)if(Sa.contains(Jb.Lj))if(Ya<
Hb.length)$a.tG(Eb),$a.insert(Eb,Hb.J(Ya)),Ya++;else return!1;else Sa.add(Jb.Lj);0<$a.length&&2!==$a.J($a.length-1).type&&Ya<Hb.length&&$a.insert($a.length,Hb.J(Ya));return!0}hDl($a){const Hb=new f.a;for(let Ya=0;Ya<$a.length;Ya++)2===$a.J(Ya).type&&Hb.add($a.J(Ya).Lj);return Hb}dDl($a,Hb,Ya,Sa,Eb){const Jb=new k.a;for(let vb=0;vb<Hb.length;vb++){const ac=Hb.J(vb);if(!$a.contains(ac)){let dc;(({block:dc}=this.zjf(Sa,ac)).returnValue||({block:dc}=this.zjf(Eb,ac)).returnValue||({block:dc}=this.zjf(Ya,
ac)).returnValue)&&dc&&Jb.add(dc)}}return Jb}zjf($a,Hb){for(let Ya=0;Ya<$a.length;Ya++)if(2===$a.J(Ya).type&&$a.J(Ya).Lj===Hb)return $a=$a.J(Ya),{returnValue:!0,block:$a};return{returnValue:!1,block:null}}V4a(){const $a=new k.a;Ub.a.Jec(this.Og,"BaseObjects_",this.LF,$a);Ub.a.Jec(this.Og,"FavoredObjects_",this.fBa,$a);Ub.a.Jec(this.Og,"ConflictObjects_",this.xCa,$a)}SPk(){let $a,Hb;$a=x.a.nil;Hb=-1;let Ya=0;for(let Sa=0;Sa<this.vQ.Me.length;Sa++){const Eb=this.vQ.Me.J(Sa);if(Eb.S4())Ya+=Eb.length;
else if(6!==Eb.type)Ya=0;else return $a=Eb.Lj,Hb=Ya,{returnValue:!0,objectId:$a,cp:Hb}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:$a,cp:Hb}}qcd($a,Hb){let Ya,Sa;Sa=Hb;Ya=$a;try{let Eb=this.initialize();if(Eb=(Eb=Eb&&this.Fth(!0,$a,Hb).returnValue)&&({objectId:Ya,cp:Sa}=this.SPk()).returnValue)return a.a.instance.Ua(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",
Ya,Sa),{returnValue:!0,U6a:Ya,Sqa:Sa}}catch(Eb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.EQd(Eb))}this.J8c(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Msa,this.A9f);this.V4a();return{returnValue:!1,U6a:Ya,Sqa:Sa}}static z3h($a,Hb){let Ya;Ya=new k.a;if(!$a.input.HHb)return{returnValue:!0,nOf:Ya};$a=$a.input.P$.last().o2a(v.a.ML);
Ya=Hb.getPropertyObjectIds($a,l.a.W1);return{returnValue:!0,nOf:Ya}}static mDn($a){if(!Ub.a.vff($a))return!0;const Hb=new z.a;$a.runtime.qn.Z(v.a.ML,Ub.a.$zm($a,Hb));return!0}static SCn($a){if(!$a.runtime.qn.nb(v.a.ML)||!$a.runtime.Kq.nb(v.a.ML))return!0;const Hb=new z.a,Ya=$a.runtime.qn.J(v.a.ML);var Sa=Hb.getPropertyString(Ya.zm,l.a.$Ua);if(x.a.Ff(Sa).equals(x.a.nil))return!0;Sa=Hb.getPropertyObjectIds(Ya.zm,l.a.W1);const Eb=Hb.getPropertyObjectIds($a.runtime.Kq.J(v.a.ML),l.a.W1);let Jb;({nOf:Jb}=
Ib.z3h($a,Hb));for(let vb=0;vb<Eb.length;vb++)Sa.contains(Eb.J(vb),(ac,dc)=>ac.equals(dc))||Jb.contains(Eb.J(vb),(ac,dc)=>ac.equals(dc))||(Sa.add(Eb.J(vb)),$a.runtime.qn.Z(Eb.J(vb),new Xb.a($a.runtime.Kq.J(Eb.J(vb)).UK())));Hb.setPropertyObjectIds(Ya.zm,l.a.W1,Sa);return!0}}Object(D.a)(Ib,"ParagraphMergeUsingHints",null,[1805])},1656:function(D,I,c){D=c(0);class l{constructor(m){this.MPi=m;this.succeeded=!1;this.wnc=m?m.wnc:0;this.DTm=!1;this.length=this.qFo=0}}Object(D.a)(l,"TrieResult",null,[]);
class f{constructor(m,r,z){this.hmb=new l(null);this.S6m=m;this.a_c=r;this.FKi=r+z-1}get result(){return this.hmb}pbi(){let m;return this.a_c<=this.FKi?(m=this.S6m.charAt(this.a_c),++this.a_c,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}Z5f(m,r,z){m&&(this.hmb.DTm=!0,this.hmb.qFo=r);this.hmb.length=this.a_c;this.hmb.succeeded=!0;this.hmb.wnc=z;this.a_c!==this.FKi+1&&(this.hmb=new l(this.hmb))}}Object(D.a)(f,"LookUpStringVisitor",null,[1285]);var a=c(1742);class k{constructor(){this.UAh=this.tyh=
this.vyh=this.syh=this.uyh=this.O4e=this.M4e=this.Q4e=this.L4e=0}}Object(D.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.i8a=this.I0c=0}}Object(D.a)(x,"TrieSymbol",null,[]);c.d(I,"a",function(){return y});class y{constructor(m,r){this.T4=null;this.Y2d=this.UKi=this.SKi=this.WKi=this.OKi=this.VKi=this.TKi=this.XKi=this.PKi=0;this.NJ=m;if(m.Ty(r,4)!==y.oBb)throw Error.argument("Input does not represent a trie");r+=4;this.HKi=1===m.Ty(r,4);r+=4;this.P6m=1===m.Ty(r,4);r+=4;this.L6m=m.Ty(r,4);r+=
4;if(m.Ty(r,4)){m=r+4;this.T4=this.GNn(m);this.PKi=r=m+y.lOk;this.XKi=r+=y.MDd*(this.T4.L4e+(this.T4.L4e%2?1:0));this.TKi=r+=y.MDd*(this.T4.Q4e+(this.T4.Q4e%2?1:0));this.VKi=r+=y.MDd*(this.T4.M4e+(this.T4.M4e%2?1:0));this.OKi=r+=y.MDd*(this.T4.O4e+(this.T4.O4e%2?1:0));this.WKi=r+=y.S4e*this.T4.syh;this.SKi=r+=y.T4e*this.T4.vyh;this.UKi=r+=y.T4e*this.T4.tyh;r+=y.T4e*this.T4.uyh;if(r!==m+this.T4.UAh)throw Error.argument("Corrupted trie binary");this.Y2d=r}else this.T4=null}eKi(m,r,z,v){m=new f(m,r,
z);this.CIj(m,v);return m.result}ngi(m){if(this.HKi)if(m)--m;else return"";if(!this.T4)throw Error.argument("Invalid trieID");const r=new a.a;r.KF=0;this.SRb(r);const z=[];for(;;){if(r.KF&y.z9a)if(m)--m;else return Array.add(z,r.ZSb),String.fromCharCode.apply(null,z);const v=!!(r.KF&y.Hqe),G=this.U8b(r,!0);if(v||m<G){if(Array.add(z,r.ZSb),!this.SRb(r))throw Error.argument("Invalid trieID");}else if(m-=G,!this.Dbd(r))throw Error.argument("Invalid trieID");}}CIj(m,r){let z=0;this.HKi&&(m.Z5f(this.P6m,
this.L6m,0),++z);if(this.T4){var v=new a.a;v.KF=0;if(this.SRb(v))for(;;){var G=void 0;if(!({ch:G}=m.pbi()).returnValue)break;r&&(G=r(G));G=G.toString().charCodeAt(0);let F=!1;for(;!F;){const H=!!(v.KF&y.z9a);if(v.ZSb===G){if(F=!0,H&&m.Z5f(!!(v.KF&y.Utg),v.Cke,z),!this.SRb(v))return}else if(z+=this.U8b(v,!0),!this.Dbd(v))return;H&&++z}}}}SRb(m){if(!m.KF)return this.emg(m),!0;if(!(m.KF&y.Gqe))return!1;m.oQa=0;m.Ox=m.Hjb;this.emg(m);return!0}Dbd(m){if(m.KF&y.Hqe)return!1;this.emg(m);return!0}U8b(m,r){return m.KF&
y.Ttg?m.LDd:m.KF&y.Gqe?!r&&m.KF&y.Hqe?this.GRl(m):1:0}GRl(m){m=y.w7e(m);if(!this.SRb(m))return 0;let r=0;do m.KF&y.z9a&&++r,r+=this.U8b(m,!1);while(this.Dbd(m));return r}emg(m){m.KF||(m.oQa=0,m.Ox=this.Y2d);var r=this.qJd(this.PKi,m.Ox),z=r.i8a;m.Ox+=r.I0c;r=this.NJ.Ty(this.OKi+y.S4e*z,y.S4e);m.ZSb=r&65535;m.KF=r>>16;m.KF&y.Ttg&&(m.LDd=this.bgl(m));m.KF&y.Utg&&(r=this.qJd(this.XKi,m.Ox),z=r.i8a,m.Ox+=r.I0c,m.Cke=this.NJ.Ty(this.WKi+4*z,4));m.KF&y.AQj?(m.Hjb=this.Y2d+((this.NJ.J(m.Ox)<<8|this.NJ.J(m.Ox+
1))<<8|this.NJ.J(m.Ox+2)),m.Ox+=3):m.KF&y.BQj?(m.Hjb=m.Ox,m.oQa=m.Hjb):m.KF&y.CQj?(r=this.qJd(this.TKi,m.Ox),z=r.i8a,m.Ox+=r.I0c,m.Hjb=this.Y2d+this.NJ.Ty(this.SKi+4*z,4)):m.KF&y.Gqe&&(r=this.qJd(this.VKi,m.Ox),z=r.i8a,m.Ox+=r.I0c,m.oQa||(m.oQa=m.Ox),m.oQa+=this.NJ.Ty(this.UKi+4*z,4),m.Hjb=m.oQa)}qJd(m,r){const z=new x;let v=0;for(;;){v+=this.NJ.J(r);++r;++z.I0c;const G=this.NJ.Ty(m,2);if(v<G)break;z.i8a+=G;v-=G;m+=2;v<<=8}z.i8a+=v;return z}bgl(m){let r=this.NJ.J(m.Ox);192<=r?(r=(r&63)<<15|(this.NJ.J(m.Ox+
1)&127)<<8,r|=this.NJ.J(m.Ox+2),m.Ox+=3):128<=r?(r=(r&127)<<8|this.NJ.J(m.Ox+1),m.Ox+=2):m.Ox+=1;return r}GNn(m){const r=new k;r.L4e=this.NJ.Ty(m+12,2);r.Q4e=this.NJ.Ty(m+14,2);r.M4e=this.NJ.Ty(m+16,2);r.O4e=this.NJ.Ty(m+18,2);r.uyh=this.NJ.Ty(m+24,4);r.syh=this.NJ.Ty(m+28,4);r.vyh=this.NJ.Ty(m+32,4);r.tyh=this.NJ.Ty(m+36,4);r.UAh=this.NJ.Ty(m+40,4);return r}static w7e(m){const r=new a.a;r.ZSb=m.ZSb;r.KF=m.KF;r.LDd=m.LDd;r.Ox=m.Ox;r.Hjb=m.Hjb;r.oQa=m.oQa;r.Cke=m.Cke;return r}}y.oBb=1654263084;y.lOk=
48;y.MDd=2;y.T4e=4;y.S4e=4;y.z9a=1;y.Hqe=2;y.Ttg=4;y.Utg=8;y.Gqe=16;y.BQj=64;y.CQj=128;y.AQj=256;Object(D.a)(y,"Trie",null,[1275])},1658:function(D,I,c){c.r(I);D=c(0);c(1506);var l=c(1524);class f{}f.marketPlace=0;f.catalog=1;f.privateCatalog=10;Object(D.a)(f,"AppsForOfficeStoreType",null,[]);var a=c(1504),k=c(2),x=c(92),y=c(13);class m{constructor(){this.TSe=0}X2f(J,M){this.TSe=window.performance.now();this.sVa(()=>{const P=window.performance.now(),N={},K=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);M.dyk&&(N.callback=O=>{J(O,f.marketPlace,P)},K&&(N.storeType=f.marketPlace),k.AFrameworkApplication.va.Rb(y.a.JNb,2,N));M.eyk&&(N.callback=O=>{J(O,f.privateCatalog,P)},K?N.storeType=f.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?N.storeType=10:N.storeType=f.privateCatalog,k.AFrameworkApplication.va.Rb(y.a.JNb,2,N))},0,()=>{if(a.TellMeActor.instance.Le)a.TellMeActor.instance.Le.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.TSe)+" ms")})}sVa(J,M=0,P=null){2!==k.AFrameworkApplication.va.processAction(y.a.JNb,1)?(a.TellMeActor.instance.Le&&a.TellMeActor.instance.Le.OA(l.a.cyk,window.performance.now()-this.TSe),J()):M<m.c$m?k.AFrameworkApplication.oc.Xb(new x.a(2,1,m.t1o,()=>{this.sVa(J,M+1,P)})):P&&P()}static get instance(){m._instance||(m._instance=new m);return m._instance}}m._instance=null;m.c$m=20;m.t1o=500;Object(D.a)(m,"AddinEntitlementsQuery",null,
[]);class r{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.nIf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(D.a)(r,"AddinInfo",null,[]);var z=c(1508),v=c(1511),G=c(1510),F=c(1503),H=c(125);c.d(I,"AddinResultsProvider",function(){return L});class L{constructor(J){this.YOe=[];this.fc=J;this.omn=(M,P,N)=>{if(M){const K=M.errorCode;if(a.TellMeActor.instance.Le){const O=
{};O.StoreType=P;O.ErrorCode=K;O.AddinCount=M.value?M.value.length:0;a.TellMeActor.instance.Le.OA(l.a.BKl,window.performance.now()-N,O)}if(0===K&&M.value){L.AAb=L.AAb||{};M=M.value;for(const O of M)M=new r,M.displayName=O[0],M.id=O[1],M.description=O[2],M.targetType=O[3],M.appVersion=4<O.length?O[4]:"",M.assetId=5<O.length?O[5]:"",M.assetStoreId=6<O.length?O[6]:"",M.width=7<O.length?O[7]:0,M.height=8<O.length?O[8]:0,M.iconUrl=9<O.length?O[9]:"",M.providerName=10<O.length?O[10]:"",M.storeId=11<O.length?
O[11]:"",M.storeType=12<O.length?O[12]:"",M.nIf=this.P_l(M),L.AAb[M.id]=M,0<M.iconUrl.length&&(P="AddinIcon_"+M.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.U7i(P,M.iconUrl):appChrome.addInApi.registerAddinIcon(P,M.iconUrl))}}};m.instance.X2f(this.omn,this.fc)}lL(){return"Add-ins"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(J,M,P,N,K=null){P=new G.a(J);K&&!Array.contains(K,27)||F.a.BR(J)||(K=new v.a(27),K.displayName=
CommonUIStrings.l_TellMeAddinProviderTitle,this.p_l(J.Cg,K),P.$u(K));M.resultsUpdated(P)}p_l(J,M){if((J=this.k$n(J))&&0<J.length){let P=0;J.forEach(N=>{if(!(3<++P)){var K="AddinSuggestion"+P,O={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var V="AddinIcon_"+N.id;0>Array.indexOf(this.YOe,V)&&0<N.iconUrl.length&&this.U7i(V,N.iconUrl);O["default"]=0<=Array.indexOf(this.YOe,V)?V:"AppForOfficeLogo_20"}else O["default"]=0<N.iconUrl.length?
"AddinIcon_"+N.id:"AppForOfficeLogo_20";V=[];V.push(appChrome.actions.setControlLabel(K,N.displayName));V.push(appChrome.actions.setControlIconSet(K,O));V.push(appChrome.actions.setCompoundButtonCommandValueId(K,N.id));V.push(appChrome.actions.updateCompoundButtonDescription(K,N.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(O=window.performance.now(),V.push(appChrome.actions.updateControlEnabledDisabledState(K,!1)),
a.TellMeActor.instance.Le&&a.TellMeActor.instance.Le.OA(l.a.Xsl,window.performance.now()-O));appChrome.api.dispatch(V);K=new z.a(K,27,void 0,void 0,1);K.XI=Telemetry.PrivacyRules.GetPrivacyCompliantId(N.id,N.storeType,N.assetId,null,null,N.storeId);M.Rw(K)}})}}U7i(J,M){H.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(J,M),Array.add(this.YOe,J))}k$n(J){if(!L.AAb)return null;const M=[],P=L.AAb;for(let K in P){var N=P[K];N&&L.c9m(J,N)&&Array.add(M,N)}return M}P_l(J){return L.jzo(J.displayName)}static c9m(J,
M){if(!M.nIf)return!1;for(const P of J.split(" ")){J=!1;for(const N of M.nIf)if(N.toLowerCase().startsWith(P.toLowerCase())){J=!0;break}if(!J)return!1}return!0}static jzo(J){const M=[];for(const P of J.split(" ")){J=0;for(let N=0;N<P.length;N++){const K=P.charAt(N);K.toString().toUpperCase()===K.toString()&&N>J&&(Array.add(M,P.substring(J,N)),J=N)}Array.add(M,P.substring(J,P.length));J&&Array.add(M,P.substring(0,P.length))}return M}}L.AAb=null;Object(D.a)(L,"AddinResultsProvider",null,[1117])},1724:function(D,
I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(224);class f{constructor(){this.cob=this.dob=this.J0a=this.gkb=this.bob=this.xgb=this.ekb=this.k6a=this.ygb=this.fkb=null;this.reset()}reset(){this.fkb=new l.a;this.ygb=new l.a;this.k6a=new l.a;this.ekb=new l.a;this.xgb=new l.a;this.bob=new l.a;this.gkb=new l.a;this.J0a=new l.a;this.J0a=new l.a;this.dob=new l.a;this.cob=new l.a}W_o(a){return this.bQa(this.fkb,a)&&this.bQa(this.ygb,a)&&this.bQa(this.k6a,a)&&this.bQa(this.ekb,a)&&this.bQa(this.xgb,
a)&&this.bQa(this.bob,a)&&this.bQa(this.gkb,a)&&this.bQa(this.J0a,a)&&this.bQa(this.dob,a)&&this.bQa(this.cob,a)}bQa(a,k){return!a||!a.length||a.length===k}}Object(D.a)(f,"MergeableTrackedChangesProperties",null,[])},1725:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(224),f=c(608);class a{constructor(){this.VJa=new l.a;this.WKa=new l.a;this.lNa=new l.a}get QAb(){return this.VJa}get Xif(){return this.WKa}get grb(){return this.lNa}get isEmpty(){return!this.VJa.length&&!this.WKa.length&&
!this.lNa.length}get lmb(){return Math.max(Math.max(this.VJa.length,this.WKa.length),this.lNa.length)}get Abn(){return Math.min(Math.min(this.VJa.length,this.WKa.length),this.lNa.length)}bCd(k){this.VJa.add(k)}dCd(k){this.WKa.add(k)}hCd(k){this.lNa.add(k)}cDl(){const k=new f.a,x=new l.a;let y=0;for(;y<this.VJa.length||y<this.WKa.length||y<this.lNa.length;)y<this.VJa.length&&!k.contains(this.VJa.J(y))&&(x.add(this.VJa.J(y)),k.add(this.VJa.J(y))),y<this.WKa.length&&!k.contains(this.WKa.J(y))&&(x.add(this.WKa.J(y)),
k.add(this.WKa.J(y))),y<this.lNa.length&&!k.contains(this.lNa.J(y))&&(x.add(this.lNa.J(y)),k.add(this.lNa.J(y))),y++;return x}}Object(D.a)(a,"ObjectCollection",null,[])},1726:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.uJa=a;this.updateHints=f}}Object(D.a)(l,"UpdateHintCollection",null,[])},1727:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1569);class l extends c.a{constructor(f,a){super();this.yg=f;this.Wc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.yg,this.Wc)}}Object(D.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1728:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(224);c=c(1569);class f extends c.a{constructor(a){super();this.p0=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let k=0;k<this.p0.length;k++)a+=String.format("({0}), ",this.p0.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(D.a)(f,"LcsInsertUpdateHint",c.a,[])},1729:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);c=c(1569);class l extends c.a{constructor(f,a){super();this.text=a;this.yg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.yg,this.text)}}Object(D.a)(l,"LcsInsertTextUpdateHint",c.a,[])},1730:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1569);class l extends c.a{constructor(f,a,k){super();this.cp=f;this.yg=a;this.Wc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.yg,this.Wc)}}Object(D.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1731:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1569);class l extends c.a{constructor(f,a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(D.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1732:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1541);class l extends c.a{constructor(){super()}get fha(){return"Conflict"}}
Object(D.a)(l,"ConflictMergeFailureDetail",c.a,[])},1733:function(D,I,c){c.r(I);c.d(I,"InsightsMenuItemFactory",function(){return k});D=c(0);var l=c(1503),f=c(162),a=c(19);class k{constructor(x=null){this.q5j=x||CommonUIStrings.l_InsightsButtonText}get POb(){return 10}Mga(x){var y=x.fD;x=l.a.xpa()?l.a.uOa(y,1):l.a.QCb(y);y=String.format(this.q5j,y);return this.OIl(x,y)}OIl(x,y){return f.a(k.Qri,l.a.xpa()?"1914896509":"3317204163",a.a.vf(y),l.a.mBf,null,a.a.vf(x),a.a.vf(y),null,null)}}k.Qri="bInsights";
Object(D.a)(k,"InsightsMenuItemFactory",null,[1115])},1734:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(162),f=c(19);class a{constructor(k,x,y,m,r){this.KQe=k;this.JQe=x;this.rkk=y;this.R3j=m;this.dYg=r}get POb(){return 4}Mga(k,x=null){x=x.sessionId+"|"+x.dpa+"|"+k.fD;if(this.dYg||this.R3j){let y=this.dYg||f.a.ZA(CommonUIStrings.l_HelpTooltip)===f.a.ZA(k.fD.trim());if(this.rkk&&2<k.fD.length){const m=k.fD;";"===m.charAt(0)&&";"===m.charAt(m.length-1)&&m.substring(1,m.length-1)===
a.byf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.fD);return this.K2h(x,f.a.vf(k),y)}return this.K2h(x,f.a.vf(String.format(CommonUIStrings.l_TextWithQuotation,k.fD)),!1)}K2h(k,x,y){return l.a(a.byf,y?this.JQe:this.KQe,x,"OfficeAssistant_16x16x32","A0",f.a.vf(k),x,null,null)}}a.byf="bSearchHelp";Object(D.a)(a,"AssistanceMenuItemFactory",null,[1115])},1735:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(2),f=c(162),a=
c(90),k=c(19);class x{get POb(){return 13}Mga(){return x.MLk()}static MLk(){return f.b(x.z_h,"798637440",k.a.vf(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.$s,a.getImageClass("Info_32x32x32"),null,null,k.a.vf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,k.a.vf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.z_h="bTellMeFirstRun";Object(D.a)(x,"FirstRunMenuItemFactory",null,[1115])},1736:function(D,I,c){c.d(I,"a",function(){return k});
D=c(0);var l=c(2),f=c(162),a=c(19);class k{constructor(x=null,y=null){this.T6g=x;this.dak=y||CommonUIStrings.l_LookupNoResultsDescription}get POb(){return 14}Mga(x){x=String.format(this.dak,x.fD);return this.AMk(x)}AMk(x){return f.b(k.$Pi,"798637440",a.a.vf(CommonUIStrings.l_LookupNoResultsTitle),this.T6g?l.AFrameworkApplication.$s:null,this.T6g,null,null,a.a.vf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.vf(x),null,null)}}k.$Pi="lookupNoResults";Object(D.a)(k,"NoCommandsFoundMenuItemFactory",
null,[1115])},1737:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(D.a)(l,"LabelFormatted",null,[])},1738:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);c(1506);var l=c(1508),f=c(1511),a=c(1510),k=c(1503),x=c(19);class y{constructor(m){this.fc=m}lL(){return"Assistance"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:this.fc.R1c?3:2}ZH(m,r,z=!1,v,G=null){v=new a.a(m);if((!G||Array.contains(G,
8))&&!k.a.BR(m)){G=new f.a(8);if(z){z=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(m.Cg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Cg);const F=[];this.fc.x4a&&(this.fc.Phe||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.Gbi(m.Cg));const H="||"+m.Cg;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));
appChrome.api.dispatch(F);m=new l.a("GetHelpFromTellMe",4,m.Cg,null,1)}else m=new l.a("bSearchHelp",4,m.Cg,null,1);G.Rw(m);G.displayName=CommonUIStrings.l_HelpButtonTitle;v.$u(G)}r.resultsUpdated(v)}ojb(m,r=null){const z=new f.a(8),v=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(m.Cg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Cg);for(let F=0;F<r.length&&2>F;F++){var G=void 0;G=[];let H="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),
L=4;if(this.fc.A9c)G.push(appChrome.actions.setControlLabel(H,v)),G.push(appChrome.actions.setCompoundButtonCommandValueId(H,m.Cg)),G.push(appChrome.actions.updateCompoundButtonDescription(H,this.yuf(r.length)));else if(this.fc.B9c){let J=this.Whi(r[F]);H="GetHelpFromTellMe"+(F+1).toString();this.fc.x4a&&(J=this.Gbi(J));L=9;G.push(appChrome.actions.setControlLabel(H,J));G.push(appChrome.actions.setButtonCommandValueId(H,this.jgm(r[F])))}appChrome.api.dispatch(G);G=new l.a(H,L,null,null,0);G.label=
this.Whi(r[F]);G.description=this.igm(r[F]);z.Rw(G);if(this.fc.B9c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}yuf(m){return 1===m?String.format(CommonUIStrings.l_SearchResultText,m):String.format(CommonUIStrings.l_SearchResultsText,m)}Gbi(m){return this.fc.NGf?k.a.Fpf(m,CommonUIStrings.l_HelpScopedButtonText):m+CommonUIStrings.l_HelpScopedButtonText}Whi(m){return m.name?m.name:""}igm(m){return m.description?m.description:""}jgm(m){return m.id?"AssetID="+m.id:""}}Object(D.a)(y,
"AssistanceResultsProvider",null,[1117])},1739:function(D,I,c){c.d(I,"a",function(){return m});D=c(0);c(1506);var l=c(1508),f=c(1511),a=c(1510),k=c(1504),x=c(1503),y=c(1540);class m{constructor(r){this.fc=r}lL(){return"Image"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:3===this.fc.fv?3:2}ZH(r,z,v,G,F=null){v=new a.a(r);(!F||Array.contains(F,19))&&x.a.BR(r)&&this.fc.PP&&this.ojb(r,v,1);z.resultsUpdated(v)}ojb(r,z,v,G=null){var F=[];let H;k.TellMeActor.instance.aP()&&k.TellMeActor.instance.aP().x4a?
(H=this.fc.NGf?x.a.Fpf(r.Cg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):r.Cg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.fc.Phe||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.fc.PP?x.a.BR(r)?this.fc.Geb?x.a.iib(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.fc.Geb?x.a.iib(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
r.Cg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,r.Cg):this.fc.Zkc?CommonUIStrings.l_TellMeImageSuggestionButtonText:r.Cg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.fc.Pwa?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",H)),F=x.a.uOa(r.Cg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",
H)),r=x.a.uOa(r.Cg,9,Object.assign(new y.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",r)),appChrome.api.dispatch(F));v=new l.a("ImageForSearch",12,null,null,v);G&&(v.score=G.ConfidenceScore);G=new f.a(19,this.fc.Zkc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);G.Rw(v);z.$u(G)}}Object(D.a)(m,"ImageResultsProvider",null,[1117])},1740:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);c(1506);var l=c(1508),f=c(1511),a=c(1510),
k=c(1503),x=c(2);class y{constructor(m){this.fc=m}lL(){return"Template"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:3}ZH(m,r){m=new a.a(m);r.resultsUpdated(m)}ojb(m,r,z){var v=[];let G;G=this.fc.PP?this.fc.Geb?k.a.iib(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,m.Cg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,m.Cg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,m.Cg);v.push(appChrome.actions.setControlLabel("TemplateForSearch",G));v.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(x.AFrameworkApplication.K.kb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,m.Cg)));appChrome.api.dispatch(v);m=new f.a(23);m.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;v=new l.a("TemplateForSearch",24,null,null,0);v.label=z[0].Title?z[0].Title:"";v.description=z[0].Description?z[0].Description:"";m.Rw(v);r.$u(m)}}Object(D.a)(y,"TemplateResultsProvider",null,[1117])},1741:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);c(1506);var l=c(1543),f=c(1508),
a=c(1511),k=c(1510),x=c(1645),y=c(1504),m=c(1503),r=c(19);class z{constructor(v,G,F,H){this.g3=v;this.Odb=G;this.Eih=H;this.n1j=F;this.fc=y.TellMeActor.instance.aP()}lL(){return"EmptyQuery"}rU(){return 1===this.fc.fv?1:0}ZH(v,G,F=!1,H,L=null){H=new k.a(v);if((!L||Array.contains(L,5)||Array.contains(L,6)||Array.contains(L,4))&&m.a.BR(v)){this.g3.mPc().length||!this.n1j||this.Eih||(v=new a.a(6),L=new f.a(null,13,void 0,void 0,1),v.Rw(L),H.$u(v));v=new a.a(4);if(0<this.g3.mPc().length){v.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;L=this.g3.mPc();var J=[];for(var M of L)J.push(M.Id);l.CommandResultsUtility.mcd(J,this.fc);for(var P of L)l.CommandResultsUtility.lVc(P.Id)&&v.Rw(new f.a(P.Id,5,null,null,2));H.$u(v)}if(this.Eih&&0<this.Odb.length&&this.g3.mPc().length<z.maxResults){M=new a.a(5);M.displayName=CommonUIStrings.l_TellMeTryQueryTitle;P=z.maxResults-v.results.length;v=[];for(L=0;L<this.Odb.length&&L<P;++L){if(F){J=m.a.Lmg+(L+1);const N=this.Odb[L].key,K=r.a.replaceAll(N,'"',"");
v.push(appChrome.actions.setControlLabel(J,N));v.push(appChrome.actions.setButtonCommandValueId(J,K));J=new x.a(N,7,0,K,J)}else J=new x.a(this.Odb[L].key,7,0,this.Odb[L].value);M.Rw(J)}0<v.length&&appChrome.api.dispatch(v);H.$u(M)}}G.resultsUpdated(H)}}z.maxResults=5;Object(D.a)(z,"EmptyQueryResultsProvider",null,[1117])},1742:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.Cke=this.oQa=this.Hjb=this.Ox=this.LDd=this.KF=this.ZSb=0}}Object(D.a)(l,"TRIESCAN",null,[])},
1744:function(D,I,c){c.d(I,"a",function(){return F});D=c(0);var l=c(2),f=c(403),a=c(707),k=c(398),x=c(729);c.n(x);var y=c(747);c.n(y);var m=c(52),r=c(767),z=c(369),v=c(368),G=c(7);c=c(258);class F extends c.a{constructor(H,L){super("SummaryGenerationCondition");this.yig=-1;this.Shj=()=>{if(!F.Kig&&this.Ooe.By>F.Dbn){const J=a.a.getAugLoopRuntimeManager(),M=this.XOd();this.yig=Date.now();J.submitOperation(Object.assign(new v.a,{operation:M}))}};this.Thj=()=>{this.Shj();this.Ooe.Vce(this.Thj)};this.rnb=
J=>{J=J.items[0];x.TextSummaryAnnotation.typeGuard(J.body)||x.GptSummaryAnnotation.typeGuard(J.body)||y.TextAbstractiveSummaryAnnotation.typeGuard(J.body)?(F.Kig=J.body,"Success"!==F.Kig.status?this.xg(!1):(this.xg(!0),this.I3m())):(G.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${m.a.getTypeNameFor(J.body)}`),this.xg(!1))};this.Ooe=L.getInstance(0);this.Al=H.Al}static get summary(){return F.Kig}initialize(){super.initialize();k.a.Uk().then(()=>{const H=a.a.getAugLoopRuntimeManager();
let L;L=this.Wxi()?x.GptSummaryAnnotation.getTypeName():this.$Uc()?y.TextAbstractiveSummaryAnnotation.getTypeName():x.TextSummaryAnnotation.getTypeName();H.activateAnnotation(Object.assign(new f.a,{annotationType:L,handler:this.rnb}))});-1===this.Ooe.By?this.Ooe.xAb(this.Thj):this.Shj()}Nd(){super.Nd()}$Uc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}Wxi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",
!1)}XOd(){return this.Wxi()?Object.assign(new r.l,{parentPath:["Signal",x.GptSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new x.GptSummarySignal})]}):this.$Uc()?Object.assign(new r.l,{parentPath:["Signal",y.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new y.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new r.l,{parentPath:["Signal",x.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new z.a,
{body:new x.GenerateTextSummarySignal})]})}xg(H){super.xg(H);G.ULS.sendTraceTag(508944769,3028,50,this.EO(this.Al,H))}I3m(){if(-1!==this.yig){var H=Date.now()-this.yig;G.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",H)}}}F.Dbn=300;Object(D.a)(F,"SummaryGenerationCondition",c.a,[])},1767:function(D,I,c){c.r(I);var l=c(0),f=c(1506),a=c(1554),k=c(1524),x=c(1508),y=c(1511),m=c(1510),r=c(1504),z=c(1503),v=c(1540);class G{constructor(eb){this.fc=
eb}lL(){return"ActionAI"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc=!1,Hc,Pc=null){Hc=new m.a(eb);if(!Pc||Array.contains(Pc,24))if(this.sro()||!z.a.BR(eb)){Pc=new y.a(24);var ec=z.a.BR(eb);fc&&(fc=null,z.a.xpa()&&(fc=z.a.uOa(ec?"":eb.Cg,1,Object.assign(new v.a,{landingTab:"ActionAI"}))),this.fc.Pwa?fc&&r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",fc)):(eb=[],fc&&eb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
fc)),appChrome.api.dispatch(eb)));Pc.Rw(new x.a("ActionAIFromTellMe",25,null,null,1));Hc.$u(Pc)}Kb.resultsUpdated(Hc)}sro(){return z.a.xpa()&&this.fc.UBf}}Object(l.a)(G,"ActionAIResultsProvider",null,[1117]);var F=c(1658);class H{constructor(eb,Kb){this.rAa=eb;this.Qk=Kb}resultsUpdated(eb){this.rAa.jko(this.Qk,eb)}}Object(l.a)(H,"AggregatorResultsProviderCallback",null,[1119]);class L{constructor(eb){this.esa=null;this.fc=eb;this.fc.IAb&&(this.esa=null)}lL(){return"AppsForOffice"}rU(){return 0===
this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc,Hc,Pc=null){fc=new m.a(eb);if(!Pc||Array.contains(Pc,1))Pc=new y.a(1),this.esa.Tbp(Pc,eb.Cg),fc.$u(Pc);Kb.resultsUpdated(fc)}}Object(l.a)(L,"AppsForOfficeRecommendationResultsProvider",null,[1117]);var J=c(1738),M=c(1499),P=c(1519),N=c(110);class K{constructor(eb,Kb){this.Cb=eb;this.O6m=Kb}isMatch(eb,Kb){if(!Object(N.a)(1242,eb))throw Error.argument("objToTest","Expected feature bundle");let fc;return({value:fc}=eb.Jq(this.Cb.Kua)).returnValue?this.Cb.Wpg.isMatch(fc,
Kb):this.O6m}}Object(l.a)(K,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1263]);class O{constructor(eb,Kb){this.Cb=eb;this.VMf=Kb}isMatch(eb){if(!Object(N.a)(1242,eb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.VMf^eb.Jq(this.Cb.Kua).returnValue)}}Object(l.a)(O,"AnnotatedWithAnnotationFilter",null,[1263]);class V{constructor(eb){this.Cb=eb}isMatch(eb,Kb){if(!Object(N.a)(1245,eb))throw Error.argument("objToTest","Expected struct value");return this.Cb.Wpg.isMatch(eb.zib(this.Cb.dPa),
Kb)}}Object(l.a)(V,"FieldValueMatchesStructFilter",null,[1263]);class W{constructor(eb,Kb){eb&&(this.dPa=eb.J(0),this.Wpg=Kb.poa(eb.J(1)))}}Object(l.a)(W,"FieldValueMatchesStructFilterInit",null,[]);class T{constructor(eb){this.VMf=eb}isMatch(eb){if(!Object(N.a)(1242,eb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.VMf^eb.mxf)}}Object(l.a)(T,"HasAnnotationsAnnotationFilter",null,[1263]);class Y{constructor(eb,Kb){this.Cb=eb;this.G9=Kb}isMatch(eb,Kb){if(!Object(N.a)(1244,
eb))throw Error.argument("objToTest","Expected list value");switch(this.G9){case 0:for(const fc of eb.items)if(this.Cb.filter.isMatch(fc,Kb))return!0;return!1;case 1:for(const fc of eb.items)if(!this.Cb.filter.isMatch(fc,Kb))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Y,"ItemTestListFilter",null,[1263]);class ba{constructor(eb){this.Cb=eb}isMatch(eb,Kb){if(!Object(N.a)(1244,eb))throw Error.argument("objToTest","Expected list value");return this.Cb.filter.isMatch(eb.items.length,
Kb)}}Object(l.a)(ba,"LengthMatchesListFilter",null,[1263]);class Z{constructor(eb,Kb){this.Cb=eb;this.G9=Kb}isMatch(eb,Kb,fc=null){let Hc=0===this.G9;for(const Pc of this.Cb.BCh)if((Hc=Pc.isMatch(eb,Kb,fc))?1===this.G9:0===this.G9)return Hc;2===this.G9&&(Hc=!Hc);return Hc}}Object(l.a)(Z,"NonterminalFilter",null,[1263]);class ea{constructor(eb,Kb){if(eb){var fc=eb.J(0);this.BCh=Array(fc);for(let Hc=0;Hc<fc;++Hc)this.BCh[Hc]=Kb.poa(eb.J(1+Hc))}}}Object(l.a)(ea,"NonterminalFilterInit",null,[]);class ha{constructor(eb,
Kb){this.Cb=eb;this.G9=Kb}isMatch(eb,Kb){if("number"!==typeof eb)throw Error.argument("objToTest","Expected number value");let fc=this.Cb.number;if(this.Cb.query){Kb=this.Cb.query.Mt(null,Kb);if("number"!==typeof Kb)throw Error.invalidOperation("Query did not return number");fc+=Kb}switch(this.G9){case 0:return eb===fc;case 1:return eb<fc;case 2:return eb<=fc;case 3:return eb>fc;case 4:return eb>=fc;default:throw Error.notImplemented();}}}Object(l.a)(ha,"NumberFilter",null,[1263]);class la{constructor(eb,
Kb){eb&&(this.number=eb.J(0),this.query=eb.J(1)?Kb.eL(eb.J(1)):null)}}Object(l.a)(la,"NumberFilterInit",null,[]);class ia{constructor(eb,Kb,fc){this.HQd=this.AVl;this.U6m=eb;this.LKi=Kb;this.KKi=fc}g6e(eb){this.LKi=eb}AVl(eb){if(!eb)throw Error.argument("name","Invalid named feature bundle reference");const Kb=eb.substr(1);return 1===eb.charCodeAt(0)&&Kb===this.U6m?this.LKi:this.KKi?this.KKi.HQd(eb):null}}Object(l.a)(ia,"SimpleNamedFeatureBundleResolver",null,[1283]);class sa{constructor(eb){this.Cb=
eb}isMatch(eb,Kb){if(!Object(N.a)(1242,eb))throw Error.argument("objToTest","Expected feature bundle");eb=this.Cb.query.Mt(null,new ia(this.Cb.loe,eb,Kb));if("boolean"!==typeof eb)throw Error.invalidOperation("Query did not return bool");return eb}}Object(l.a)(sa,"PredicateAnnotationFilter",null,[1263]);class Oa{constructor(eb,Kb){eb&&(this.loe=Kb.XC(eb.J(0)),this.query=Kb.eL(eb.J(1)))}}Object(l.a)(Oa,"PredicateAnnotationFilterInit",null,[]);class Ra{constructor(eb){this.Cb=eb}isMatch(eb,Kb){if("boolean"!==
typeof eb)throw Error.argument("objToTest","Expected bool value");Kb=this.Cb.query.Mt(null,Kb);if("boolean"!==typeof Kb)throw Error.invalidOperation("Query did not return bool");return eb===Kb}}Object(l.a)(Ra,"QueryBooleanFilter",null,[1263]);class Na{constructor(eb,Kb){this.Cb=eb;this.G9=Kb}isMatch(eb,Kb){if("number"!==typeof eb)throw Error.argument("objToTest","Expected integer");Kb=this.Cb.query.Mt(null,Kb);if("number"!==typeof Kb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.G9){case 0:return eb===Kb;case 1:return 0!==(eb&Kb);case 2:return eb===(eb&Kb);case 3:return Kb===(eb&Kb);default:throw Error.notImplemented();}}}Object(l.a)(Na,"QueryEnumFilter",null,[1263]);class Da{constructor(eb,Kb){eb&&(this.e_d=1===eb.J(0),this.query=Kb.eL(eb.J(1)))}}Object(l.a)(Da,"QueryEnumFilterInit",null,[]);class ra{constructor(eb,Kb){this.Cb=eb;this.G9=Kb}isMatch(eb,Kb){if(!Object(N.a)(1244,eb))throw Error.argument("objToTest","Expected list value");Kb=this.Cb.query.Mt(null,
Kb);if(!Object(N.a)(1244,Kb))throw Error.invalidOperation("Query did not return list value");if(eb.W4!==Kb.W4)return!1;switch(this.G9){case 0:return M.Annotations.Brb(M.Annotations.C1l(eb.W4),eb,Kb);case 1:for(const fc of eb.items)for(const Hc of Kb.items)if(M.Annotations.Brb(eb.W4,fc,Hc))return!0;return!1;case 2:for(const fc of eb.items)for(const Hc of Kb.items)if(!M.Annotations.Brb(eb.W4,fc,Hc))return!1;return!0;case 3:for(const fc of Kb.items)for(const Hc of eb.items)if(!M.Annotations.Brb(eb.W4,
fc,Hc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(ra,"QueryListFilter",null,[1263]);class xa{constructor(eb,Kb){this.Cb=eb;this.G9=Kb}isMatch(eb,Kb){if("string"!==typeof eb)throw Error.argument("objToTest","Expected string");Kb=this.Cb.query.Mt(null,Kb);if("string"!==typeof Kb)throw Error.invalidOperation("Query did not return string");this.Cb.mCf&&(eb=eb.toUpperCase(),Kb=Kb.toUpperCase());switch(this.G9){case 0:return eb===Kb;case 1:return 0<=eb.indexOf(Kb);case 2:return eb.startsWith(Kb);
case 3:return eb.endsWith(Kb);case 4:return 0<=Kb.indexOf(eb);case 5:return Kb.startsWith(eb);case 6:return Kb.endsWith(eb);default:throw Error.notImplemented();}}}Object(l.a)(xa,"QueryStringFilter",null,[1263]);class fa{constructor(eb,Kb){eb&&(this.query=Kb.eL(eb.J(0)),this.mCf=1===eb.J(1))}}Object(l.a)(fa,"QueryStringFilterInit",null,[]);class oa{constructor(eb){this.Cb=eb}isMatch(eb,Kb){if(!Object(N.a)(1245,eb))throw Error.argument("objToTest","Expected struct value");Kb=this.Cb.query.Mt(null,
Kb);if(!Object(N.a)(1245,Kb))throw Error.invalidOperation("Query did not return struct value");return eb.isEqual(eb)}}Object(l.a)(oa,"QueryStructFilter",null,[1263]);class ta{constructor(eb){this.Cb=eb}isMatch(eb,Kb){eb=this.Cb.query.Mt(null,Kb);if("boolean"!==typeof eb)throw Error.invalidOperation("Query did not return bool");return eb}}Object(l.a)(ta,"QueryWhereConstraintFilter",null,[1263]);class Ka{constructor(eb){this.Cb=eb}isMatch(eb){if("string"!==typeof eb)throw Error.argument("objToTest",
"Expected string");return this.Cb.q5f.test(eb)}}Object(l.a)(Ka,"RegexStringFilter",null,[1263]);class va{constructor(eb,Kb){eb&&(this.q5f=Kb.b$b(eb.J(0)))}}Object(l.a)(va,"RegexStringFilterInit",null,[]);class La{constructor(eb,Kb){eb&&(this.filter=Kb.poa(eb.J(0)))}}Object(l.a)(La,"SingleFilterFilterInit",null,[]);class za{constructor(eb,Kb){eb&&(this.query=Kb.eL(eb.J(0)))}}Object(l.a)(za,"SingleQueryFilterInit",null,[]);class Ca{constructor(eb){this.Cb=eb}isMatch(eb){if("boolean"!==typeof eb)throw Error.argument("objToTest",
"Expected bool value");return eb===this.Cb.value}}Object(l.a)(Ca,"StoredValueBooleanFilter",null,[1263]);class ua{constructor(eb){eb&&(this.value=1===eb.J(0))}}Object(l.a)(ua,"StoredValueBooleanFilterInit",null,[]);class ib{constructor(eb,Kb){this.Cb=eb;this.G9=Kb}isMatch(eb){if("number"!==typeof eb)throw Error.argument("objToTest","Expected integer");switch(this.G9){case 0:return this.Cb.e_d?this.Cb.value?!!(eb&this.Cb.value):!eb:eb===this.Cb.value;case 1:return this.Cb.e_d?(eb&this.Cb.value)===
this.Cb.value:32>eb&&(1<<eb&this.Cb.value)===this.Cb.value;case 2:return this.Cb.e_d?!!(eb&this.Cb.value):32>eb&&!!(1<<eb&this.Cb.value);default:throw Error.notImplemented();}}}Object(l.a)(ib,"StoredValueEnumFilter",null,[1263]);class bb{constructor(eb){eb&&(this.e_d=1===eb.J(0),this.value=eb.J(1))}}Object(l.a)(bb,"StoredValueEnumFilterInit",null,[]);class mb{constructor(){this.Zxn=null;this.R4e=this.EHb=0}}Object(l.a)(mb,"WHEREConstraintData",null,[]);class yb{constructor(eb){this.Cb=eb}isMatch(eb,
Kb){if(!Object(N.a)(mb,eb))throw Error.argument("objToTest","Expected WHERE constraint data");let fc=-1,Hc=-1;const Pc=eb.Zxn;switch(this.Cb.Q5e){case 4:fc=Pc.MNc;Hc=Pc.Vgg;break;case 5:fc=eb.EHb;Hc=Pc.MNc-eb.EHb;break;case 6:fc=Pc.MNc+Pc.Vgg;Hc=eb.EHb+eb.R4e-fc;break;case 1:case 2:case 3:let ec=!1;for(let Ld=Pc.bdp;Ld;Ld=Ld.next)if(this.Cb.CZo===Ld.name){ec=!0;1===this.Cb.Q5e?(fc=Ld.MNc,Hc=Ld.Vgg):2===this.Cb.Q5e?(fc=eb.EHb,Hc=Ld.MNc-eb.EHb):(fc=Ld.MNc+Ld.Vgg,Hc=eb.EHb+eb.R4e-fc);break}if(!ec)return!1;
break;case 7:fc=eb.EHb;Hc=eb.R4e;break;default:throw Error.notImplemented();}return null!==this.Cb.lzo.rhp(Pc.uqp,fc,Hc,fc,!0,2,Kb)}}Object(l.a)(yb,"SubSreWhereConstraintFilter",null,[1263]);class ab{constructor(eb,Kb){if(eb){var fc=Kb.XC(eb.J(0));this.Q5e=fc.charCodeAt(0);this.CZo=fc.substr(1);this.lzo=Kb.Dam(eb.J(1))}}}Object(l.a)(ab,"SubSreWhereConstraintFilterInit",null,[]);class Ga{constructor(eb){this.Cb=eb}isMatch(eb,Kb,fc=null){if(!Object(N.a)(1242,eb))throw Error.argument("objToTest","Expected feature bundle");
if(null==fc)throw Error.argumentNull("parentTextForSpan");if(this.Cb.srh&&!this.Cb.srh.isMatch(eb,Kb))return!1;if(this.Cb.zkg){let Hc;if(({value:Hc}=eb.Jq(this.Cb.dyo)).returnValue){if(!this.Cb.zkg.isMatch(Hc,Kb))return!1}else{let Pc,ec;if(!({value:Pc}=eb.Jq(this.Cb.Lsj)).returnValue||!({value:ec}=eb.Jq(this.Cb.Ksj)).returnValue||0>Pc||0>ec||Pc+ec>fc.length||!this.Cb.zkg.isMatch(fc.substr(Pc,ec),Kb))return!1}}if(this.Cb.Btj){let Hc;if(!({value:Hc}=eb.Jq(this.Cb.Lsj)).returnValue||!this.Cb.Btj.isMatch(Hc,
Kb))return!1}if(this.Cb.tFi){let Hc;if(!({value:Hc}=eb.Jq(this.Cb.Ksj)).returnValue||!this.Cb.tFi.isMatch(Hc,Kb))return!1}return!0}}Object(l.a)(Ga,"TextSpanFilter",null,[1263]);class Za{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.Lsj=eb.J(0),this.Ksj=eb.J(1),this.dyo=eb.J(2),this.zkg=eb.J(3)?Kb.poa(eb.J(3)):null,this.srh=eb.J(4)?Kb.poa(eb.J(4)):null,this.Btj=eb.J(5)?Kb.poa(eb.J(5)):null,this.tFi=eb.J(6)?Kb.poa(eb.J(6)):null)}}Object(l.a)(Za,"TextSpanFilterInit",null,[]);class Ub{constructor(eb,
Kb){eb&&(this.annotations=Kb.annotations,this.Kua=eb.J(0),this.Wpg=eb.J(1)?Kb.poa(eb.J(1)):null)}}Object(l.a)(Ub,"ValueFilterAnnotationFilterInit",null,[]);var Xb=c(1528);class zb{poa(eb,Kb){const fc=eb.J(0),Hc=new Xb.a;Hc.Xhb(eb,1,eb.count-1);switch(fc){case 1:return new Z(new ea(Hc,Kb),0);case 2:return new Z(new ea(Hc,Kb),1);case 3:return new Z(new ea(Hc,Kb),2);case 101:return new Ka(new va(Hc,Kb));case 103:return new xa(new fa(Hc,Kb),0);case 104:return new xa(new fa(Hc,Kb),1);case 105:return new xa(new fa(Hc,
Kb),2);case 106:return new xa(new fa(Hc,Kb),3);case 107:return new xa(new fa(Hc,Kb),4);case 108:return new xa(new fa(Hc,Kb),5);case 109:return new xa(new fa(Hc,Kb),6);case 201:return new Ca(new ua(Hc));case 202:return new Ra(new za(Hc,Kb));case 301:return new ha(new la(Hc,Kb),0);case 302:return new ha(new la(Hc,Kb),1);case 303:return new ha(new la(Hc,Kb),2);case 304:return new ha(new la(Hc,Kb),3);case 305:return new ha(new la(Hc,Kb),4);case 401:return new ib(new bb(Hc),0);case 402:return new ib(new bb(Hc),
1);case 403:return new ib(new bb(Hc),2);case 404:return new Na(new Da(Hc,Kb),0);case 405:return new Na(new Da(Hc,Kb),1);case 406:return new Na(new Da(Hc,Kb),2);case 407:return new Na(new Da(Hc,Kb),3);case 501:return new V(new W(Hc,Kb));case 502:return new oa(new za(Hc,Kb));case 601:return new Y(new La(Hc,Kb),0);case 602:return new Y(new La(Hc,Kb),1);case 603:return new ba(new La(Hc,Kb));case 604:return new ra(new za(Hc,Kb),0);case 605:return new ra(new za(Hc,Kb),1);case 606:return new ra(new za(Hc,
Kb),2);case 607:return new ra(new za(Hc,Kb),3);case 701:return new T(!1);case 702:return new T(!0);case 703:return new O(new Ub(Hc,Kb),!1);case 704:return new O(new Ub(Hc,Kb),!0);case 705:return new K(new Ub(Hc,Kb),!1);case 706:return new K(new Ub(Hc,Kb),!0);case 707:return new sa(new Oa(Hc,Kb));case 901:return new Ga(new Za(Hc,Kb));case 1002:return new ta(new za(Hc,Kb));case 1001:return new yb(new ab(Hc,Kb));default:throw Error.argument("initData");}}}Object(l.a)(zb,"FilterFactory",null,[1241]);
var Ib=c(1505);class $a{constructor(eb){this.Cb=eb}get $D(){return this.Cb.$D}get x5(){return this.Cb.x5}get ake(){return this.Cb.ake}get GYd(){return this.Cb.GYd}load(eb,Kb){return this.Mt(eb,eb?new ia("root",eb,Kb):Kb)}store(eb,Kb,fc){this.Vlc(eb,Kb,eb?new ia("root",eb,fc):fc,null)}Mt(eb,Kb){if(!this.GYd&&!this.Cb.annotations.Ccc(this.$D,eb))throw Error.argument("input","Input value not of expected type");let fc=this.Cb.F_h;for(;fc;)eb=fc.load(eb,Kb),fc=fc.next;return eb}Vlc(eb,Kb,fc,Hc){if(!this.ake)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.GYd&&!this.Cb.annotations.Ccc(this.$D,eb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Cb.annotations.Ccc(this.x5,Kb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Cb.F_h.store(eb,Kb,fc,Hc)}static EEh(eb,Kb,fc,Hc){if(fc===Hc)return Kb;if(M.Annotations.oI(fc)&&M.Annotations.oI(Hc)){fc=M.Annotations.n2a(fc);Hc=M.Annotations.n2a(Hc);const Pc=new Ib.a(eb,Hc);for(const ec of Kb.items)Array.add(Pc.items,$a.EEh(eb,ec,fc,Hc));return Pc}if(fc===
M.Annotations.nJa){if(Hc===M.Annotations.Ira)return Kb;if(Hc===M.Annotations.Q$)return Kb.toString()}else if(fc===M.Annotations.Ira){if(Hc===M.Annotations.nJa)return Math.floor(Kb);if(Hc===M.Annotations.Q$)return Kb.toString()}else if(fc===M.Annotations.Q$){if(Hc===M.Annotations.nJa)return parseInt(Kb);if(Hc===M.Annotations.Ira)return parseFloat(Kb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)($a,"AnnotationQuery",null,[1267]);class Hb{constructor(){this.x5=
this.$D=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}s2a(eb){if(this.next)return{returnValue:this.next,HIa:eb};if(eb){const Kb=eb.UHh;eb=eb.g2i;return{returnValue:Kb,HIa:eb}}return{returnValue:null,HIa:eb}}}Object(l.a)(Hb,"AnnotationQueryStep",null,[1291]);class Ya extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){Kb=this.Cb.query.Mt(eb,Kb);if(M.Annotations.oI(this.$D)){var fc=M.Annotations.n2a(this.$D);let Pc=new Ib.a(this.Cb.annotations,fc);if(M.Annotations.oI(this.Cb.query.x5)){if(eb.items.length!==
Kb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let ec=0,Ld=eb.items.length;ec<Ld;++ec)Array.add(Pc.items,this.SDd(eb.items[ec],Kb.items[ec],fc===M.Annotations.Ira))}else for(var Hc of eb.items)Array.add(Pc.items,this.SDd(Hc,Kb,fc===M.Annotations.Ira));return Pc}if(M.Annotations.oI(this.Cb.query.x5)){Hc=new Ib.a(this.Cb.annotations,this.$D);for(fc of Kb.items)Array.add(Hc.items,this.SDd(eb,fc,this.$D===M.Annotations.Ira));return Hc}return this.SDd(eb,
Kb,this.$D===M.Annotations.Ira)}SDd(eb,Kb,fc){eb=this.F3b(eb,Kb);return fc?eb:Math.floor(eb)}}Object(l.a)(Ya,"NumericAnnotationQueryStep",Hb,[]);class Sa extends Ya{constructor(eb){super(eb)}F3b(eb,Kb){return eb+Kb}}Object(l.a)(Sa,"AddAnnotationQueryStep",Ya,[]);class Eb extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){if(this.$D===M.Annotations.Rza&&this.Cb.query.x5===M.Annotations.Rza){let Pc;if(({result:Pc}=this.dAh(eb)).returnValue)return Pc}if(M.Annotations.oI(this.$D)){var fc=new Ib.a(this.Cb.annotations,
M.Annotations.Rza);Kb=this.Cb.query.Mt(eb,Kb);if(M.Annotations.oI(this.Cb.query.x5)){if(eb.items.length!==Kb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Pc=0,ec=eb.items.length;Pc<ec;++Pc)Array.add(fc.items,this.MIc(Kb.items[Pc],eb.items[Pc]))}else for(var Hc of eb.items)Array.add(fc.items,this.MIc(Kb,Hc));return fc}Hc=this.Cb.query.Mt(eb,Kb);if(M.Annotations.oI(this.Cb.query.x5)){Kb=new Ib.a(this.Cb.annotations,M.Annotations.Rza);for(fc of Hc.items)Array.add(Kb.items,
this.MIc(fc,eb));return Kb}return this.MIc(Hc,eb)}}Object(l.a)(Eb,"BinaryBooleanAnnotationQueryStep",Hb,[]);class Jb extends Eb{constructor(eb){super(eb)}dAh(eb){return{returnValue:!eb,result:!1}}MIc(eb,Kb){return eb&&Kb}}Object(l.a)(Jb,"AndAnnotationQueryStep",Eb,[]);class vb{constructor(eb){eb&&(this.annotations=eb)}}Object(l.a)(vb,"AnnotationsOnlyQueryStepInit",null,[]);class ac extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){Kb=this.Cb.query.Mt(eb,Kb);eb=eb.clone();M.Annotations.oI(this.Cb.query.x5)?
Array.addRange(eb.items,Kb.items):Array.add(eb.items,Kb);return eb}}Object(l.a)(ac,"AppendAnnotationQueryStep",Hb,[]);class dc extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){if(this.$D===M.Annotations.FV)return this.TMc(eb,Kb);const fc=new Ib.a(this.Cb.annotations,M.Annotations.FV);for(const Hc of eb.items)Array.add(fc.items,this.TMc(Hc,Kb));return fc}TMc(eb,Kb){const fc=new P.a(this.Cb.annotations);fc.i0a(eb);eb=new P.a(this.Cb.annotations);this.Cb.script.VOa(null,new ia("Input",fc,new ia("Output",
eb,Kb)));return eb}}Object(l.a)(dc,"ApplyAnnotationQueryStep",Hb,[]);class Cc extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){if(this.$D===M.Annotations.FV)return Kb=this.TMc(eb,Kb),Kb.Jq(this.Cb.qrh).returnValue||new Ib.a(this.Cb.annotations,M.Annotations.FV),Kb;const fc=new Ib.a(this.Cb.annotations,M.Annotations.FV);for(const Hc of eb.items)if(eb=this.TMc(Hc,Kb),({value:eb}=eb.Jq(this.Cb.qrh)).returnValue)for(const Pc of eb.items)Array.add(fc.items,Pc);return fc}TMc(eb,Kb){const fc=new P.a(this.Cb.annotations);
fc.i0a(eb);eb=new P.a(this.Cb.annotations);this.Cb.script.VOa(null,new ia("Input",fc,new ia("Output",eb,Kb)));return eb}}Object(l.a)(Cc,"ApplyExpandAnnotationQueryStep",Hb,[]);class Ec{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.script=Kb.aFb(eb.J(0)),this.qrh=eb.J(1))}}Object(l.a)(Ec,"ApplyExpandQueryStepInit",null,[]);class rc{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.script=Kb.aFb(eb.J(0)))}}Object(l.a)(rc,"ApplyQueryStepInit",null,[]);class hb extends Hb{constructor(eb){super();
this.Cb=eb}load(eb){if(this.$D===M.Annotations.FV)return this.Z1d(eb);const Kb=new Ib.a(this.Cb.annotations,this.Cb.annotations.getAttributeType(this.Cb.Kua));for(const fc of eb.items)Array.add(Kb.items,this.Z1d(fc));return Kb}store(eb,Kb,fc,Hc){if(this.$D===M.Annotations.FV){var Pc=Kb,ec=({HIa:Hc}=this.s2a(Hc)).returnValue;ec&&(Pc=ec.store(M.Annotations.KT(this.Z1d(eb)),Kb,fc,Hc));eb.Vy(this.Cb.Kua,Pc)}else{var Ld=Kb;if(Pc=({HIa:Hc}=this.s2a(Hc)).returnValue){Ld=new Ib.a(this.Cb.annotations,this.Cb.annotations.getAttributeType(this.Cb.Kua));
for(ec of eb.items)Array.add(Ld.items,this.Z1d(ec));Ld=Pc.store(Ld,Kb,fc,Hc)}Kb=Ld;if(Kb.items.length!==eb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let De=0,cf=eb.items.length;De<cf;++De)fc=eb.items[De],fc.isReadOnly&&(fc=fc.clone(),eb.items[De]=fc),fc.Vy(this.Cb.Kua,Kb.items[De])}return eb}Z1d(eb){({value:eb}=eb.Jq(this.Cb.Kua)).returnValue||(eb=this.Cb.annotations.sMl(this.Cb.Kua));return eb}}Object(l.a)(hb,"AttrAnnotationQueryStep",Hb,
[]);class fb{constructor(eb,Kb){eb&&(this.annotations=Kb,this.Kua=eb.J(0))}}Object(l.a)(fb,"AttrQueryStepInit",null,[]);class Nb extends Hb{constructor(eb){super();this.Cb=eb}load(eb){const Kb=new P.a(this.Cb.annotations);Kb.i0a(eb);return this.Cb.module.execute(Kb)}}Object(l.a)(Nb,"CallModuleAnnotationQueryStep",Hb,[]);class Fb{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.module=Kb.irf(eb.J(0)))}}Object(l.a)(Fb,"CallModuleQueryStepInit",null,[]);class nb extends Hb{constructor(eb){super();
this.Cb=eb}load(eb,Kb){if(M.Annotations.oI(this.$D)){var fc=this.Cb.query.Mt(eb,Kb);Kb=new Ib.a(this.Cb.annotations,M.Annotations.Q$);let ec="string"===typeof fc;for(var Hc of eb.items)if(ec)Array.add(Kb.items,Hc+fc);else for(var Pc of fc.items)Array.add(Kb.items,Hc+Pc);return Kb}Hc=this.Cb.query.Mt(eb,Kb);if("string"===typeof Hc)return eb+Hc;Pc=new Ib.a(this.Cb.annotations,M.Annotations.Q$);for(fc of Hc.items)Array.add(Pc.items,eb+fc);return Pc}}Object(l.a)(nb,"ConcatAnnotationQueryStep",Hb,[]);
class pb extends Hb{constructor(eb){super();this.Cb=eb}load(eb){return $a.EEh(this.Cb.annotations,eb,this.$D,this.x5)}}Object(l.a)(pb,"ConvertAnnotationQueryStep",Hb,[]);class Xa extends Hb{constructor(){super()}load(eb){return eb.items.length}}Object(l.a)(Xa,"CountAnnotationQueryStep",Hb,[]);class Pb extends Ya{constructor(eb){super(eb)}F3b(eb,Kb){return eb/Kb}}Object(l.a)(Pb,"DivideAnnotationQueryStep",Ya,[]);class Va extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){Kb=new ia(this.Cb.loe,
null,Kb);for(const fc of eb.items)if(Kb.g6e(fc),this.Cb.query.Mt(fc,Kb))return!0;return!1}}Object(l.a)(Va,"ExistsAnnotationQueryStep",Hb,[]);class tb extends Ya{constructor(eb){super(eb)}F3b(eb,Kb){return Math.pow(eb,Kb)}}Object(l.a)(tb,"ExpAnnotationQueryStep",Ya,[]);class cb{constructor(eb,Kb){eb&&(this.cPa=Kb.XC(eb.J(0)))}}Object(l.a)(cb,"FeatureBundleNameQueryStepInit",null,[]);class Mb extends Hb{constructor(eb){super();this.Cb=eb}load(eb){if(M.Annotations.oI(this.$D)){const Kb=new Ib.a(this.Cb.annotations,
this.Cb.annotations.BGb(M.Annotations.n2a(this.$D),this.Cb.dPa));for(const fc of eb.items)Array.add(Kb.items,fc.zib(this.Cb.dPa));return Kb}return eb.zib(this.Cb.dPa)}store(eb,Kb,fc,Hc){if(M.Annotations.oI(this.$D)){var Pc=Kb,ec=({HIa:Hc}=this.s2a(Hc)).returnValue;if(ec){Pc=new Ib.a(this.Cb.annotations,this.Cb.annotations.BGb(M.Annotations.n2a(this.$D),this.Cb.dPa));for(var Ld of eb.items)Array.add(Pc.items,Ld.zib(this.Cb.dPa));Pc=ec.store(Pc,Kb,fc,Hc)}Kb=Pc;if(Kb.items.length!==eb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let De=0,cf=eb.items.length;De<cf;++De)fc=eb.items[De],fc.isReadOnly&&(fc=fc.clone(),eb.items[De]=fc),fc.$bg(this.Cb.dPa,Kb.items[De])}else ec=Kb,(Ld=({HIa:Hc}=this.s2a(Hc)).returnValue)&&(ec=Ld.store(M.Annotations.KT(eb.zib(this.Cb.dPa)),Kb,fc,Hc)),eb.$bg(this.Cb.dPa,ec);return eb}}Object(l.a)(Mb,"FieldAnnotationQueryStep",Hb,[]);class mc{constructor(eb,Kb){eb&&(this.annotations=Kb,this.dPa=eb.J(0))}}Object(l.a)(mc,"FieldQueryStepInit",null,[]);class Cb extends Hb{constructor(eb){super();this.Cb=
eb}load(eb,Kb){for(const fc of eb.items)if(this.Cb.filter.isMatch(fc,Kb))return fc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(eb,Kb,fc,Hc){let Pc=Kb,ec=-1;for(let De=0,cf=eb.items.length;De<cf;De++)if(this.Cb.filter.isMatch(eb.items[De],fc)){ec=De;break}if(0>ec)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Ld=({HIa:Hc}=this.s2a(Hc)).returnValue;Ld&&(Pc=Ld.store(M.Annotations.KT(eb.items[ec]),Kb,fc,Hc));
eb.items[ec]=Pc;return eb}}Object(l.a)(Cb,"FirstItemMatchingAnnotationQueryStep",Hb,[]);class Ja extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){Kb=new ia(this.Cb.loe,null,Kb);for(const fc of eb.items)if(Kb.g6e(fc),!this.Cb.query.Mt(fc,Kb))return!1;return!0}}Object(l.a)(Ja,"ForAllAnnotationQueryStep",Hb,[]);class Wa extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){eb=Kb?Kb.HQd(this.Cb.cPa):null;if(!eb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Cb.cPa+
'"');return eb}store(eb,Kb,fc,Hc){eb=fc?fc.HQd(this.Cb.cPa):null;if(!eb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Cb.cPa+'"');let Pc=Kb;const ec=({HIa:Hc}=this.s2a(Hc)).returnValue;ec&&(Pc=ec.store(eb,Kb,fc,Hc));eb!==Pc&&eb.i0a(Pc);return eb}}Object(l.a)(Wa,"GetAnnotationQueryStep",Hb,[]);class xb{constructor(eb,Kb){this.JYj=eb;this.Pdk=Kb}get UHh(){return this.JYj}get g2i(){return this.Pdk}}Object(l.a)(xb,"AnnotationQueryStoreContinuation",null,[1293]);class ic extends Hb{constructor(eb){super();
this.Cb=eb}load(eb,Kb){return this.Cb.Uke.Mt(eb,Kb)?this.Cb.rAj.Mt(eb,Kb):this.Cb.$Md?this.Cb.$Md.Mt(eb,Kb):eb}store(eb,Kb,fc,Hc){var Pc=this.Cb.Uke.Mt(eb,fc);this.next&&(Hc=new xb(this.next,Hc));if(Pc)return this.Cb.rAj.Vlc(eb,Kb,fc,Hc);if(this.Cb.$Md)return this.Cb.$Md.Vlc(eb,Kb,fc,Hc);Pc=Kb;let ec=null;Hc&&(ec=Hc.UHh,Hc=Hc.g2i);ec&&(Pc=ec.store(M.Annotations.KT(eb),Kb,fc,Hc));return Pc}}Object(l.a)(ic,"IfAnnotationQueryStep",Hb,[]);class qc{constructor(eb,Kb){eb&&(this.Uke=Kb.eL(eb.J(0)),this.rAj=
Kb.eL(eb.J(1)),this.$Md=eb.J(2)?Kb.eL(eb.J(2)):null)}}Object(l.a)(qc,"IfQueryStepInit",null,[]);class Lc{constructor(eb,Kb){eb&&(this.xwm=Kb.eL(eb.J(0)),this.wDi=Kb.eL(eb.J(1)))}}Object(l.a)(Lc,"IndexAndItemQueryStepInit",null,[]);class Ac extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){const fc=this.Cb.xwm.Mt(eb,Kb);Kb=this.Cb.wDi.Mt(eb,Kb);eb=eb.clone();if(0>fc||fc>eb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(M.Annotations.oI(this.Cb.wDi.x5))for(let Hc=
0;Hc<Kb.items.length;++Hc)Array.insert(eb.items,fc+Hc,Kb.items[Hc]);else Array.insert(eb.items,fc,Kb);return eb}}Object(l.a)(Ac,"InsertAtAnnotationQueryStep",Hb,[]);class gd extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){return!(!Kb||!Kb.HQd(this.Cb.cPa))}}Object(l.a)(gd,"IsDefinedAnnotationQueryStep",Hb,[]);class Md extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){Kb=this.vJ(eb,Kb);return eb.items[Kb]}store(eb,Kb,fc,Hc){const Pc=this.vJ(eb,fc);let ec=Kb;const Ld=({HIa:Hc}=this.s2a(Hc)).returnValue;
Ld&&(ec=Ld.store(M.Annotations.KT(eb.items[Pc]),Kb,fc,Hc));eb.items[Pc]=ec;return eb}vJ(eb,Kb){Kb=this.Cb.query.Mt(eb,Kb);if(0>Kb||Kb>=eb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Kb}}Object(l.a)(Md,"ItemAnnotationQueryStep",Hb,[]);class ie extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){const fc=new Ib.a(this.Cb.annotations,M.Annotations.n2a(this.$D));for(const Hc of eb.items)this.Cb.filter.isMatch(Hc,Kb)&&Array.add(fc.items,Hc);return fc}}
Object(l.a)(ie,"ItemsMatchingAnnotationQueryStep",Hb,[]);class hf extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){Kb=this.vJ(eb,Kb);return eb.items[eb.items.length-Kb-1]}store(eb,Kb,fc,Hc){const Pc=this.vJ(eb,fc);let ec=Kb;const Ld=({HIa:Hc}=this.s2a(Hc)).returnValue;Ld&&(ec=Ld.store(M.Annotations.KT(eb.items[eb.items.length-Pc-1]),Kb,fc,Hc));eb.items[eb.items.length-Pc-1]=ec;return eb}vJ(eb,Kb){Kb=this.Cb.query?this.Cb.query.Mt(eb,Kb):0;if(0>Kb||Kb>=eb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Kb}}Object(l.a)(hf,"LastItemAnnotationQueryStep",Hb,[]);class Ue extends Hb{constructor(eb){super();this.Cb=eb}load(eb){if(M.Annotations.oI(this.$D)){const Kb=new Ib.a(this.Cb.annotations,M.Annotations.nJa);for(const fc of eb.items)Array.add(Kb.items,fc.length);return Kb}return eb.length}}Object(l.a)(Ue,"LengthAnnotationQueryStep",Hb,[]);class Kd extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){if(M.Annotations.oI(this.$D)){const fc=new Ib.a(this.Cb.annotations,M.Annotations.Rza);
for(const Hc of eb.items)Array.add(fc.items,this.Cb.filter.isMatch(Hc,Kb));return fc}return this.Cb.filter.isMatch(eb,Kb)}}Object(l.a)(Kd,"MatchesAnnotationQueryStep",Hb,[]);class Wc extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){return this.Cb.filter.isMatch(eb,Kb)}}Object(l.a)(Wc,"MatchesAsListAnnotationQueryStep",Hb,[]);class Zc extends Ya{constructor(eb){super(eb)}F3b(eb,Kb){return eb%Kb}}Object(l.a)(Zc,"ModuloAnnotationQueryStep",Ya,[]);class Nc extends Ya{constructor(eb){super(eb)}F3b(eb,
Kb){return eb*Kb}}Object(l.a)(Nc,"MultiplyAnnotationQueryStep",Ya,[]);class ge extends Hb{constructor(eb){super();this.Cb=eb}load(eb){if(M.Annotations.oI(this.$D)){const Kb=new Ib.a(this.Cb.annotations,M.Annotations.Rza);for(const fc of eb.items)Array.add(Kb.items,!fc);return Kb}return!eb}}Object(l.a)(ge,"NotAnnotationQueryStep",Hb,[]);class $d extends Eb{constructor(eb){super(eb)}dAh(eb){return{returnValue:eb,result:!0}}MIc(eb,Kb){return eb||Kb}}Object(l.a)($d,"OrAnnotationQueryStep",Eb,[]);class te extends Hb{constructor(eb){super();
this.Cb=eb}load(eb,Kb){const fc=this.Cb.Mhg.Mt(eb,Kb);eb=this.Cb.xJc.Mt(eb,Kb);Kb=new Ib.a(this.Cb.annotations,M.Annotations.nJa);for(let Hc=0;Hc<eb;++Hc)Array.add(Kb.items,fc+Hc);return Kb}}Object(l.a)(te,"RangeAnnotationQueryStep",Hb,[]);class Se{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.filter=Kb.poa(eb.J(0)))}}Object(l.a)(Se,"SingleFilterQueryStepInit",null,[]);class tc{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.query=eb.J(0)?Kb.eL(eb.J(0)):null)}}Object(l.a)(tc,
"SingleOptionalQueryQueryStepInit",null,[]);class dd{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.query=Kb.eL(eb.J(0)))}}Object(l.a)(dd,"SingleQueryQueryStepInit",null,[]);class Ed{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.Mhg=Kb.eL(eb.J(0)),this.xJc=eb.J(1)?Kb.eL(eb.J(1)):null)}}Object(l.a)(Ed,"StartAndCountOrLengthQueryStepInit",null,[]);class Qd extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){let fc;({startIndex:Kb,length:fc}=this.wTd(eb,Kb));const Hc=
new Ib.a(this.Cb.annotations,eb.W4);for(let Pc=0;Pc<fc;++Pc)Array.add(Hc.items,eb.items[Kb+Pc]);return Hc}store(eb,Kb,fc,Hc){let Pc,ec;({startIndex:Pc,length:ec}=this.wTd(eb,fc));var Ld=Kb;const De=({HIa:Hc}=this.s2a(Hc)).returnValue;if(De){Ld=new Ib.a(this.Cb.annotations,eb.W4);for(let cf=0;cf<ec;++cf)Array.add(Ld.items,eb.items[Pc+cf]);Ld=De.store(Ld,Kb,fc,Hc)}Kb=Ld;for(fc=0;fc<ec;++fc)Array.removeAt(eb.items,Pc);for(let cf=0,nf=Kb.items.length;cf<nf;++cf)Array.insert(eb.items,Pc+cf,Kb.items[cf]);
return eb}wTd(eb,Kb){let fc;fc=this.Cb.Mhg.Mt(eb,Kb);if(0>fc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Kb=this.Cb.xJc?this.Cb.xJc.Mt(eb,Kb):eb.items.length-fc;if(0>Kb||fc+Kb>eb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:fc,length:Kb}}}Object(l.a)(Qd,"SublistAnnotationQueryStep",Hb,[]);class Ad extends Hb{constructor(eb){super();this.Cb=eb}load(eb,Kb){if(M.Annotations.oI(this.$D)){const fc=
new Ib.a(this.Cb.annotations,M.Annotations.Q$);for(let Hc=0,Pc=eb.items.length;Hc<Pc;++Hc)Array.add(fc.items,this.Agi(eb.items[Hc],Kb));return fc}return this.Agi(eb,Kb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}Agi(eb,Kb){let fc;({startIndex:Kb,length:fc}=this.wTd(eb,Kb));return eb.substr(Kb,fc)}wTd(eb,Kb){let fc;fc=this.Cb.Mhg.Mt(eb,Kb);if(0>fc)throw Error.invalidOperation("Invalid start index in Substring() query step");Kb=this.Cb.xJc?this.Cb.xJc.Mt(eb,
Kb):eb.length-fc;if(0>Kb||fc+Kb>eb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:fc,length:Kb}}}Object(l.a)(Ad,"SubstringAnnotationQueryStep",Hb,[]);class Oe extends Ya{constructor(eb){super(eb)}F3b(eb,Kb){return eb-Kb}}Object(l.a)(Oe,"SubtractAnnotationQueryStep",Ya,[]);class pf extends Hb{constructor(eb){super();this.Cb=eb}load(eb){const Kb=new Ib.a(this.Cb.annotations,M.Annotations.Q$);for(let fc=0;fc<eb.length;++fc)Array.add(Kb.items,
eb.charAt(fc).toString());return Kb}}Object(l.a)(pf,"ToCharListAnnotationQueryStep",Hb,[]);class Fh extends Hb{constructor(eb){super();this.Cb=eb}load(eb){const Kb=new Ib.a(this.Cb.annotations,this.$D);Array.add(Kb.items,eb);return Kb}}Object(l.a)(Fh,"ToListAnnotationQueryStep",Hb,[]);class Ig extends Hb{constructor(eb){super();this.Cb=eb}load(){return this.Cb.value}}Object(l.a)(Ig,"ValueAnnotationQueryStep",Hb,[]);class Jh{constructor(eb,Kb){if(eb){var fc=eb.J(0),Hc=1;this.value=({Sha:Hc}=Kb.DOa(fc,
eb,Hc,null,null,null)).returnValue;M.Annotations.FKb(this.value)}}}Object(l.a)(Jh,"ValueQueryStepInit",null,[]);class xg{constructor(eb,Kb){eb&&(this.loe=Kb.XC(eb.J(0)),this.query=Kb.eL(eb.J(1)))}}Object(l.a)(xg,"VarNameAndQueryQueryStepInit",null,[]);class bc{constructor(eb,Kb){this.rUg=null;if(eb){this.annotations=Kb.annotations;var fc=0;this.$D=eb.J(fc);++fc;this.x5=eb.J(fc);++fc;this.ake=1===eb.J(fc);++fc;this.GYd=1===eb.J(fc);++fc;var Hc=eb.J(fc);++fc;if(Hc){var Pc=fc,ec=fc+Hc,Ld=fc+2*Hc;fc+=
3*Hc;var De=eb.count-fc,cf=null;for(let Wb=0;Wb<Hc;++Wb){var nf=fc+eb.J(Ld+Wb);const Ug=(Wb===Hc-1?De:eb.J(Ld+Wb+1))-eb.J(Ld+Wb),gi=new Xb.a;gi.Xhb(eb,nf,Ug);nf=bc.M3l(eb.J(ec+Wb),gi,Kb);nf.$D=eb.J(Pc+Wb);nf.x5=Wb===Hc-1?this.x5:eb.J(Pc+Wb+1);cf?cf.next=nf:this.rUg=nf;cf=nf}}}}get F_h(){return this.rUg}static M3l(eb,Kb,fc){switch(eb){case 1:return new Wa(new cb(Kb,fc));case 2:return new gd(new cb(Kb,fc));case 3:return new hb(new fb(Kb,fc.annotations));case 4:return new Mb(new mc(Kb,fc.annotations));
case 5:return new ic(new qc(Kb,fc));case 6:return new Kd(new Se(Kb,fc));case 43:return new Wc(new Se(Kb,fc));case 45:return new dc(new rc(Kb,fc));case 49:return new Cc(new Ec(Kb,fc));case 46:return new Ig(new Jh(Kb,fc.annotations));case 51:return new Nb(new Fb(Kb,fc));case 52:return new te(new Ed(Kb,fc));case 53:return new pb(new vb(fc.annotations));case 13:return new Md(new dd(Kb,fc));case 14:return new hf(new tc(Kb,fc));case 15:return new Xa;case 18:return new Cb(new Se(Kb,fc));case 16:return new Ja(new xg(Kb,
fc));case 17:return new Va(new xg(Kb,fc));case 22:return new Ac(new Lc(Kb,fc));case 24:return new ac(new dd(Kb,fc));case 26:return new Qd(new Ed(Kb,fc));case 27:return new ie(new Se(Kb,fc));case 30:return new Fh(new vb(fc.annotations));case 31:return new Ad(new Ed(Kb,fc));case 32:return new nb(new dd(Kb,fc));case 47:return new Ue(new vb(fc.annotations));case 48:return new pf(new vb(fc.annotations));case 34:return new Sa(new dd(Kb,fc));case 35:return new Oe(new dd(Kb,fc));case 36:return new Nc(new dd(Kb,
fc));case 37:return new Pb(new dd(Kb,fc));case 38:return new Zc(new dd(Kb,fc));case 39:return new tb(new dd(Kb,fc));case 40:return new Jb(new dd(Kb,fc));case 41:return new $d(new dd(Kb,fc));case 42:return new ge(new vb(fc.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(bc,"AnnotationQueryInit",null,[]);class Bc{constructor(eb){this.Cb=eb}execute(eb,Kb){this.VOa(eb,eb?new ia("root",eb,Kb):Kb)}VOa(eb,Kb){for(const fc of this.Cb.commands)Kb=fc.execute(eb,Kb)}}Object(l.a)(Bc,
"AnnotationScript",null,[1265]);class ad{constructor(eb){this.Cb=eb}execute(eb,Kb){const fc=this.Cb.CAm.Mt(eb,Kb),Hc=this.Cb.Rvn.Mt(eb,Kb);this.Cb.script.VOa(eb,new ia("Input",fc,new ia("Output",Hc,Kb)));return Kb}}Object(l.a)(ad,"ApplyAnnotationScriptCommand",null,[1290]);class zd{constructor(eb,Kb){eb&&(this.CAm=Kb.eL(eb.J(0)),this.Rvn=Kb.eL(eb.J(1)),this.script=Kb.aFb(eb.J(2)))}}Object(l.a)(zd,"ApplyScriptCommandInit",null,[]);class Xd{constructor(eb){this.Cb=eb}execute(eb,Kb){const fc=this.Cb.s$f.Mt(eb,
Kb);this.Cb.P2d.Vlc(eb,fc,Kb,null);return Kb}}Object(l.a)(Xd,"AssignAnnotationScriptCommand",null,[1290]);class Gd{constructor(eb){this.Cb=eb}execute(eb,Kb){const fc=this.Cb.P2d.Mt(eb,Kb);eb=this.Cb.s$f.Mt(eb,Kb);fc!==eb&&fc.i0a(eb);return Kb}}Object(l.a)(Gd,"CopyAnnotationScriptCommand",null,[1290]);class Ze{constructor(eb){this.Cb=eb}execute(eb,Kb){let fc=this.Cb.aKf.Mt(eb,Kb);if(this.Cb.aKf.ake){fc=M.Annotations.KT(fc);var Hc=new ia(this.Cb.cPa,null,Kb);for(let ec=0,Ld=fc.items.length;ec<Ld;++ec){var Pc=
this.iXh(eb,fc.items[ec],Hc);if(0>this.Cb.Jde)fc.items[ec]=Pc;else if(({value:Pc}=Pc.Jq(this.Cb.Jde)).returnValue)fc.items[ec]=Pc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Cb.aKf.Vlc(eb,fc,Kb,null)}else{Hc=new ia(this.Cb.cPa,null,Kb);for(let ec=0,Ld=fc.items.length;ec<Ld;++ec)this.iXh(eb,fc.items[ec],Hc)}return Kb}iXh(eb,Kb,fc){let Hc;0>this.Cb.Jde?Hc=M.Annotations.KT(Kb):(Hc=new P.a(this.Cb.annotations),Hc.Vy(this.Cb.Jde,Kb));fc.g6e(Hc);
this.Cb.rJk.VOa(eb,fc);return Hc}}Object(l.a)(Ze,"EnumerateAnnotationScriptCommand",null,[1290]);class Fe{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.cPa=Kb.XC(eb.J(0)),this.aKf=Kb.eL(eb.J(1)),this.rJk=Kb.aFb(eb.J(2)),this.Jde=eb.J(3))}}Object(l.a)(Fe,"EnumerateScriptCommandInit",null,[]);class bf{constructor(eb){this.Cb=eb}execute(eb,Kb){this.Cb.Uke.Mt(eb,Kb)?this.Cb.TLo.VOa(eb,Kb):this.Cb.mYh&&this.Cb.mYh.VOa(eb,Kb);return Kb}}Object(l.a)(bf,"IfAnnotationScriptCommand",null,[1290]);
class ag{constructor(eb,Kb){eb&&(this.Uke=Kb.eL(eb.J(0)),this.TLo=Kb.aFb(eb.J(1)),this.mYh=eb.J(2)?Kb.aFb(eb.J(2)):null)}}Object(l.a)(ag,"IfScriptCommandInit",null,[]);class Xf{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.P2d=Kb.eL(eb.J(0)),this.s$f=Kb.eL(eb.J(1)))}}Object(l.a)(Xf,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class vf{constructor(eb){this.Cb=eb}execute(eb,Kb){const fc=this.Cb.s$f.Mt(this.Cb.P2d.Mt(eb,Kb),Kb);this.Cb.P2d.Vlc(eb,fc,Kb,null);return Kb}}Object(l.a)(vf,
"ModifyAnnotationScriptCommand",null,[1290]);class Bg{constructor(eb){this.Cb=eb}execute(eb,Kb){const fc=new P.a(this.Cb.annotations);this.Cb.query&&fc.i0a(this.Cb.query.Mt(eb,Kb));return Kb=new ia(this.Cb.cPa,fc,Kb)}}Object(l.a)(Bg,"NewAnnotationScriptCommand",null,[1290]);class ob{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.cPa=Kb.XC(eb.J(0)),this.query=eb.J(1)?Kb.eL(eb.J(1)):null)}}Object(l.a)(ob,"NewScriptCommandInit",null,[]);class $b{constructor(eb){this.Cb=eb}execute(eb,Kb){eb=
this.Cb.query.Mt(eb,Kb);if(this.Cb.query.x5===M.Annotations.FV)eb.hTa(this.Cb.Kua);else for(const fc of eb.items)fc.hTa(this.Cb.Kua);return Kb}}Object(l.a)($b,"RemoveAnnotationScriptCommand",null,[1290]);class Uc{constructor(eb,Kb){eb&&(this.annotations=Kb.annotations,this.query=Kb.eL(eb.J(0)),this.Kua=eb.J(1))}}Object(l.a)(Uc,"RemoveScriptCommandInit",null,[]);class Pd{constructor(eb,Kb){if(eb){var fc=0,Hc=eb.J(fc);++fc;if(Hc){var Pc=fc,ec=fc+Hc;fc+=2*Hc;var Ld=eb.count-fc;this.commands=Array(Hc);
for(let De=0;De<Hc;++De){const cf=fc+eb.J(ec+De),nf=(De===Hc-1?Ld:eb.J(ec+De+1))-eb.J(ec+De),Wb=new Xb.a;Wb.Xhb(eb,cf,nf);this.commands[De]=Pd.C3l(eb.J(Pc+De),Wb,Kb)}}}}static C3l(eb,Kb,fc){switch(eb){case 1:return new Xd(new Xf(Kb,fc));case 2:return new vf(new Xf(Kb,fc));case 3:return new $b(new Uc(Kb,fc));case 6:return new Bg(new ob(Kb,fc));case 7:return new Ze(new Fe(Kb,fc));case 8:return new bf(new ag(Kb,fc));case 9:return new Gd(new Xf(Kb,fc));case 10:return new ad(new zd(Kb,fc));default:throw Error.argument("initData");
}}}Object(l.a)(Pd,"AnnotationScriptInit",null,[]);var ze=c(1656);class Me{constructor(eb){this.l2=eb;this.jy=0}j$(){const eb=this.l2.Ty(this.jy,4);this.jy+=4;return eb}get z_(){return this.l2}get offset(){return this.jy}set offset(eb){this.jy=eb}}Object(l.a)(Me,"ByteArrayReader",null,[]);class af{constructor(){this.NJ=null;this.QKi=this.kda=0}J(eb){if(0>eb||eb>=this.kda)throw Error.argumentOutOfRange("index");return this.NJ.Ty(this.QKi+4*eb,4)}get count(){return this.kda}static H9k(eb,Kb,fc){const Hc=
new af;Hc.NJ=eb;Hc.QKi=Kb;Hc.kda=fc;return Hc}}Object(l.a)(af,"ReadOnlyListOverByteArray",null,[1261]);class Hg{constructor(eb,Kb){this.JKi=this.IKi=!1;this.xw=this.KRa=this.KMf=this.MKi=null;try{this.xw=Kb.annotations;const fc=Kb.lib(eb.J(0)),Hc=new Me(fc);if(-914743053!==Hc.j$())throw Error.argument("Input does not represent a flat lexicon");this.IKi=1===Hc.j$();this.JKi=1===Hc.j$();const Pc=Hc.j$();Hc.offset+=Pc;const ec=Hc.j$();this.KMf=Hg.dyn(Hc,ec,this.xw);const Ld=Hc.j$();this.MKi=Hg.uyn(Hc,
Ld);const De=Hc.j$();this.KRa=new ze.a(Hc.z_,Hc.offset);Hc.offset+=De}catch(fc){throw Error.argument("initData");}}get trie(){return this.KRa}rOl(eb){return"i"===eb&&this.JKi?"\u0130":eb.toUpperCase()}mCf(){return this.IKi}FLl(eb){let Kb;Kb=new Ib.a(this.xw,M.Annotations.FV);if(1!==eb)if(0===eb)eb=new P.a(this.xw),Array.add(Kb.items,eb);else if(eb&1073741824){eb=this.MKi[eb&-1073741825];for(let Hc=0;Hc<eb.length;++Hc){var fc=eb[Hc];fc=0===fc?new P.a(this.xw):this.KMf[fc-2];Array.add(Kb.items,fc)}}else Array.add(Kb.items,
this.KMf[eb-2]);return{returnValue:!0,sZm:Kb}}static dyn(eb,Kb,fc){if(Kb%4)throw Error.argument("reader");const Hc=af.H9k(eb.z_,eb.offset,Kb/4);eb.offset+=Kb;eb=[];for(Kb=0;Kb<Hc.count;){const Pc=({Sha:Kb}=fc.DOa(M.Annotations.FV,Hc,Kb,null,null,null)).returnValue;Array.add(eb,Pc)}return eb}static uyn(eb,Kb){Kb=eb.offset+Kb;const fc=[];for(;eb.offset<Kb;){const Hc=eb.j$(),Pc=Array(Hc);for(let ec=0;ec<Hc;++ec){const Ld=eb.j$();Pc[ec]=Ld}Array.add(fc,Pc)}return fc}}Object(l.a)(Hg,"RawFlatLexicon",null,
[1264]);var wi=c(1646),Wi=c(1647);class Mf{constructor(eb){if(null==eb)throw Error.argumentNull("base64String");const Kb=eb.length;if(Kb%4)throw Error.argument("base64String's length must be a multiple of 4");this.kda=.75*Kb;this.QKb=Array(Math.ceil(this.kda/4));eb.endsWith("==")?this.kda-=2:eb.endsWith("=")&&--this.kda;let fc=0;for(let Hc=0;Hc<Kb;Hc+=4){const Pc=Mf.xee[eb.charCodeAt(Hc)-43]<<18|Mf.xee[eb.charCodeAt(Hc+1)-43]<<12|Mf.xee[eb.charCodeAt(Hc+2)-43]<<6|Mf.xee[eb.charCodeAt(Hc+3)-43];let ec=
Pc>>16&255;this.QKb[Math.floor(fc/4)]|=ec<<fc%4*8;++fc;ec=Pc>>8&255;this.QKb[Math.floor(fc/4)]|=ec<<fc%4*8;++fc;ec=Pc&255;this.QKb[Math.floor(fc/4)]|=ec<<fc%4*8;++fc}}get length(){return this.kda}J(eb){if(0>eb||eb>=this.kda)throw Error.argumentOutOfRange("i");return this.F4h(eb)}Ty(eb,Kb){if(0>eb||0>Kb||eb+Kb>this.kda)throw Error.argument("Bad range");let fc=0;for(let Hc=0;Hc<Kb;++Hc)fc|=this.F4h(eb+Hc)<<8*Hc;return fc}JNn(eb,Kb){let fc=0,Hc=0,Pc=Math.floor(eb/8);for(eb%=8;Hc<Kb;){const ec=8-eb>Kb-
Hc?Kb-Hc:8-eb,Ld=this.J(Pc);fc|=(Ld>>eb&~(255<<ec))<<Hc;Hc+=ec;++Pc;eb=0}return fc}F4h(eb){return this.QKb[Math.floor(eb/4)]>>eb%4*8&255}}Mf.xee=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Mf,"ByteArray",null,[]);class Zg{constructor(eb,Kb,fc){this.dE=eb;this.Q6m=Kb;this.T6m=fc;this.YKi=Array(eb.b?eb.b.length:0);this.hNf=
new wi.a(new Wi.a(this.lib(this.dE.s)));this.E9=Array(eb.t.length);this.rD=new M.Annotations(this.hib(0),this)}get annotations(){return this.rD}get zql(){return this.dE.d}X2l(){if(!(""in this.dE.m))throw Error.argument("name","Unrecognized module");return this.irf(this.dE.m[""])}lib(eb){if(0>eb||!this.dE.b||eb>=this.dE.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.YKi[eb]||(this.YKi[eb]=new Mf(this.dE.b[eb]))}XC(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.E9[eb]){const Kb=this.hib(eb).J(0);this.E9[eb]=this.hNf.XC(Kb)}return this.E9[eb]}b$b(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.E9[eb]){var Kb=this.hib(eb);const fc=this.XC(Kb.J(0));Kb=1===Kb.J(1);this.E9[eb]=new RegExp(fc,Kb?"i":"")}return this.E9[eb]}Dam(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}irf(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not an NL module");return this.E9[eb]||(this.E9[eb]=this.T6m.r3l(this.hib(eb),this))}eL(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.E9[eb]||(this.E9[eb]=new $a(new bc(this.hib(eb),this)))}aFb(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.E9[eb]||(this.E9[eb]=new Bc(new Pd(this.hib(eb),this)))}poa(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not a filter");return this.E9[eb]||(this.E9[eb]=
this.Q6m.poa(this.hib(eb),this))}L9l(eb){if(1>eb||eb>=this.dE.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.dE.t[eb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.E9[eb]||(this.E9[eb]=new Hg(this.hib(eb),this))}hib(eb){const Kb=this.dE.n[eb];eb=(eb<this.dE.t.length-1?this.dE.n[eb+1]:this.dE.n.length)-Kb;if(0>Kb||0>eb||Kb+eb>this.dE.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Kb+","+eb+")");const fc=new Xb.a;
fc.Dlf(this.dE.n,Kb,eb);return fc}}Object(l.a)(Zg,"ObjectFetcher",null,[1240]);class zf{constructor(eb,Kb,fc){if(!eb)throw Error.argumentNull("prediction");if(!Kb)throw Error.argumentNull("fieldNames");if(!fc)throw Error.argumentNull("values");if(Kb.length!==fc.length)throw Error.argument("values","fieldNames and values do not have same length");this.Edk=eb;this.RKb=Kb;this.e_c=fc}get prediction(){return this.Edk}get MYh(){return this.RKb.length}mpf(eb){return 0<=eb&&eb<this.RKb.length?this.RKb[eb]:
null}getValue(eb){return 0<=eb&&eb<this.e_c.length?this.e_c[eb]:null}}Object(l.a)(zf,"PredictionData",null,[]);class ii{constructor(eb,Kb){if(!eb)throw Error.argumentNull("predictions");if(!Kb)throw Error.argumentNull("tokenAttributes");this.W6m=eb;this.$6m=Kb}msf(){return this.W6m}x3h(){return this.$6m}}Object(l.a)(ii,"PredictionDataWithTokenAttributes",null,[]);class Af{constructor(eb,Kb){this.prediction=null;this.score=0;this.prediction=eb;this.score=Kb}}Object(l.a)(Af,"PredictionWithScore",null,
[]);class jg{constructor(eb,Kb){if(!eb)throw Error.argumentNull("predictions");if(!Kb)throw Error.argumentNull("attributes");this.Fdk=eb;this.QUj=Kb}msf(){return this.Fdk}x3h(){return this.QUj}}Object(l.a)(jg,"PredictionsWithTokenAttributes",null,[]);class Rf{constructor(eb,Kb,fc){if(!eb)throw Error.argumentNull("attributeName");if(!Kb)throw Error.argumentNull("fieldNames");if(!fc)throw Error.argumentNull("values");if(Kb.length!==fc.length)throw Error.argument("values","fieldNames and values do not have same length");
this.PUj=eb;this.RKb=Kb;this.e_c=fc}get attributeName(){return this.PUj}get MYh(){return this.RKb.length}mpf(eb){return 0<=eb&&eb<this.RKb.length?this.RKb[eb]:null}getValue(eb){return 0<=eb&&eb<this.e_c.length?this.e_c[eb]:null}}Object(l.a)(Rf,"TokenAttributes",null,[]);var lj=c(54),Qh=c(130);class ei{constructor(eb,Kb,fc,Hc,Pc){this.aed=0;this.Arg=null;this.bed=this.bpc=0;this.qpe=this.gTb=this.Yra=this.cpc=null;this.Brg=0;this.yKe=this.qC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.vS=eb;this.CKj=this.GKj=Kb;this.BKj=this.EKj=fc;this.Zdd=this.DKj=Hc;this.$dd=this.FKj=Pc}HKj(){this.bed=0;return this.yrg}yrg(){if(!(this.bed<this.Zdd))return this.zrg;this.cpc=this.CKj.items[this.bed+this.BKj];this.Yra=new P.a(this.vS.Cb.annotations);1!==this.Zdd&&this.vS.Cb.hVc||this.Yra.i0a(this.cpc);if(0<=this.vS.Cb.F4d){({value:this.gTb}=this.Yra.Jq(this.vS.Cb.F4d)).returnValue?this.gTb=this.gTb.KT():this.gTb=new Ib.a(this.vS.Cb.annotations,
M.Annotations.FV);this.qpe=this.$dd.items;this.Brg=this.qpe.length;for(this.aed=0;this.aed<this.Brg;++this.aed)this.Arg=this.qpe[this.aed],Array.add(this.gTb.items,this.Arg);this.Yra.Vy(this.vS.Cb.F4d,this.gTb)}else 0<=this.vS.Cb.Igg?this.Yra.Vy(this.vS.Cb.Igg,this.$dd.items[0]):0<=this.vS.Cb.z3e?this.Yra.Vy(this.vS.Cb.z3e,!0):this.vS.Cb.nzi?this.$dd.items[0].uOd((eb,Kb)=>this.Yra.Vy(eb,Kb)):(this.Yra.i0a(this.$dd.items[0]),1!==this.Zdd&&this.vS.Cb.hVc||(({value:this.bpc}=this.cpc.Jq(this.vS.Cb.N3)).returnValue&&
this.Yra.Vy(this.vS.Cb.N3,this.bpc),({value:this.bpc}=this.cpc.Jq(this.vS.Cb.S7)).returnValue&&this.Yra.Vy(this.vS.Cb.S7,this.bpc),this.cpc.Jq(this.vS.Cb.Leb).returnValue&&this.Yra.Vy(this.vS.Cb.Leb,this.bpc)));this.qC=this.Yra;this._state=2;return this.JKj}zrg(){this._state=3}IKj(){this.bed++;return this.yrg}JKj(){return 1<this.Zdd&&this.vS.Cb.hVc?this.zrg:this.IKj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new ei(this.vS,this.GKj,this.EKj,this.DKj,this.FKj)).getEnumerator()}[Symbol.iterator](){return Object(Qh.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.yKe=this.HKj());for(;1===this._state;)this.yKe=this.yKe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.qC}}Object(l.a)(ei,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,70,78]);class cl{constructor(eb,Kb,fc){this.b_c=this.RKi=0;this.Rec=null;this.iNf=this.QMf=this.Pec=this.W2d=this.TMf=
0;this.X2d=!1;this.cNf=eb;this.kNf=Kb;this.V6m=fc}pbi(){null===this.Rec&&({ixj:this.Rec,hoi:this.TMf,length:this.W2d,Nyl:eb}=this.cNf.Thi(this.kNf.items[this.b_c],this.V6m),this.X2d=eb||this.X2d);if(this.Pec<this.W2d){var eb=this.Rec.charAt(this.TMf+this.Pec);++this.Pec;return{returnValue:!0,ch:eb}}if(this.b_c===this.kNf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.b_c;this.Pec=0;this.Rec=null;return{returnValue:!0,ch:" "}}Z5f(eb,Kb){this.Pec===this.W2d&&this.Rec&&(this.iNf=Kb,this.QMf=
this.b_c-this.RKi+1)}j4n(eb){if(0>eb||eb>=this.kNf.items.length)throw Error.argumentOutOfRange("iToken");this.b_c=this.RKi=eb;this.Rec=null;this.QMf=this.Pec=this.W2d=this.TMf=0;this.iNf=-1;this.X2d=!1}U1l(){return{jOk:this.QMf,LWm:this.iNf,Myl:this.X2d}}}Object(l.a)(cl,"TriePrefixVisitor",null,[1285]);class ul{constructor(eb){this.Cb=eb}execute(eb){if(!({value:fc}=eb.Jq(this.Cb.FNa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Kb;({value:Kb}=eb.Jq(this.Cb.n_a)).returnValue||
(Kb=null);var fc=this.KKl(fc,Kb);eb=M.Annotations.KT(eb);eb.Vy(this.Cb.FNa,fc);return eb}KKl(eb,Kb){let fc=null;const Hc=this.Cb.flatLexicon.trie,Pc=new cl(this,eb,Kb);let ec=null;this.Cb.flatLexicon.mCf()&&(ec=Object(lj.a)(this.Cb.flatLexicon,this.Cb.flatLexicon.rOl,"getCaseInsensitiveForm"));let Ld=0,De;var cf;let nf;for(;Ld<eb.items.length;){const Wb=eb.items[Ld];Pc.j4n(Ld);Hc.CIj(Pc,ec);({jOk:De,LWm:cf,Myl:nf}=Pc.U1l());if(0<De){({sZm:cf}=this.Cb.flatLexicon.FLl(cf));for(let Ug of this.Gal(eb,
Ld,De,cf)){1<De&&this.Cb.hVc&&this.ybl(eb,Kb,Ld,Wb,De,nf,Ug);if(!fc)for(fc=new Ib.a(this.Cb.annotations,M.Annotations.FV),cf=0;cf<Ld;++cf)Array.add(fc.items,eb.items[cf]);Array.add(fc.items,Ug)}Ld+=De}else fc&&Array.add(fc.items,Wb),++Ld}return fc||eb}ybl(eb,Kb,fc,Hc,Pc,ec,Ld){if(ec)ec=!0;else if(this.Cb.Xyi){ec=!1;var De=-1;for(var cf=0;cf<Pc;cf++){var nf=eb.items[fc+cf];let rf;var Wb=void 0;if(!({value:rf}=nf.Jq(this.Cb.N3)).returnValue||!({value:Wb}=nf.Jq(this.Cb.S7)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<cf){if(rf>De+1){ec=!0;break}if(0>De||null===Kb||De>=Kb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Kb.charAt(De)){ec=!0;break}}De=rf+Wb}}else ec=!1;if(ec){Wb=new Sys.StringBuilder;for(ec=0;ec<Pc;++ec)({ixj:De,hoi:cf,length:nf}=this.Thi(eb.items[fc+ec],Kb)),0<ec&&Wb.append(" "),Wb.append(De.substr(cf,nf));Ld.Vy(this.Cb.Leb,Wb.toString())}eb=eb.items[fc+Pc-1];let Ug,gi;({value:Hc}=Hc.Jq(this.Cb.N3)).returnValue&&
({value:Ug}=eb.Jq(this.Cb.N3)).returnValue&&({value:gi}=eb.Jq(this.Cb.S7)).returnValue?(Ld.Vy(this.Cb.N3,Hc),Ld.Vy(this.Cb.S7,Ug+gi-Hc)):(Ld.hTa(this.Cb.N3),Ld.hTa(this.Cb.S7))}Gal(eb,Kb,fc,Hc){return new ei(this,eb,Kb,fc,Hc)}Thi(eb,Kb){let fc,Hc;if(({value:fc}=eb.Jq(this.Cb.Leb)).returnValue)Hc=!0,Kb=0,eb=fc.length;else{Hc=!1;if(null===Kb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");fc=Kb;if(!({value:Kb}=eb.Jq(this.Cb.N3)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:eb}=eb.Jq(this.Cb.S7)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Kb||0>eb||Kb+eb>fc.length)throw Error.argument("Token start/length values out of range","token");}return{ixj:fc,hoi:Kb,length:eb,Nyl:Hc}}}Object(l.a)(ul,"FlatLexiconNLModule",null,[1266]);class qi{constructor(eb,Kb){this.z3e=this.F4d=this.Igg=this.Leb=this.S7=this.N3=this.n_a=this.FNa=0;this.nzi=this.Xyi=this.hVc=!1;this.flatLexicon=null;this.annotations=Kb.annotations;
let fc=0;try{this.FNa=eb.J(fc),++fc,this.n_a=eb.J(fc),++fc,this.N3=eb.J(fc),++fc,this.S7=eb.J(fc),++fc,this.Leb=eb.J(fc),++fc,this.Igg=eb.J(fc),++fc,this.F4d=eb.J(fc),++fc,this.z3e=eb.J(fc),++fc,this.hVc=1===eb.J(fc),++fc,this.Xyi=1===eb.J(fc),++fc,this.nzi=1===eb.J(fc),++fc,this.flatLexicon=Kb.L9l(eb.J(fc))}catch(Hc){throw Error.argument("initData");}}}Object(l.a)(qi,"FlatLexiconNLModuleInit",null,[]);class Jg{constructor(){this.dTc=0;this.vjf=null;this.D7c=0}}Object(l.a)(Jg,"FeatureGenStackRec",
null,[]);class xi{constructor(eb){this.ylg=Array(eb);this.hnc=Array(eb);this.gig=[];this.Nuj=[]}}Object(l.a)(xi,"TokenStringLattice",null,[]);const Fj=(eb,Kb,fc)=>{for(let Hc=0;Hc<eb.length;Hc++)fc=Kb(fc,eb[Hc]);return fc},km=(eb,Kb)=>{const fc=Array(eb.length);for(let Hc=0;Hc<eb.length;Hc++)fc[Hc]=Kb(eb[Hc]);return fc},hg=(eb,Kb)=>{Kb=Array(Math.min(Kb,eb.length));for(let fc=0;fc<Kb.length;fc++)Kb[fc]=eb[fc];return Kb},Wg=(eb,Kb)=>{const fc=[];for(const Hc of eb)Kb(Hc)&&Array.add(fc,Hc);return fc};
class ej{constructor(eb,Kb){this.key=eb;this.value=Kb}}Object(l.a)(ej,"KeyValuePair",null,[]);const tm=(eb,Kb)=>({returnValue:Kb in eb,value:eb[Kb]}),nl=eb=>{const Kb=[];for(let fc in eb){const Hc=new ej(fc,eb[fc]);Array.add(Kb,Hc)}return Kb};class Pg{constructor(eb){this.Shi=this.Yfm;this.Cb=eb;this.$2d=this.$Mf=this.aNf=0;for(const Kb of this.Cb.gNd)this.aNf=Math.max(this.aNf,Kb.F0f),this.$Mf=Math.max(this.$Mf,Kb.y0f),this.$2d=Math.max(this.$2d,Kb.$pb.length)}get aBl(){return this.Cb.Ele.trie}execute(eb){if(!eb)throw Error.argumentNull("input");
let Kb,fc;({tokens:Kb,QXm:fc}=this.Zfm(eb));let Hc=null,Pc=null,ec={};if(this.Cb.OVc){Kb=M.Annotations.KT(Kb);for(var Ld=0;Ld<Kb.items.length;++Ld)Kb.items[Ld]=M.Annotations.KT(Kb.items[Ld])}else({uYh:Pc,returnValue:Hc}=this.hci(eb,ec));Ld=Array(this.$2d);const De=Array(this.$2d);for(var cf=0;cf<De.length;++cf)De[cf]=new Jg;for(cf=-this.aNf;cf<Kb.items.length+this.$Mf;++cf){let nf=null;this.Cb.OVc&&(nf=Kb.items[cf],ec={},{uYh:Pc,returnValue:Hc}=this.hci(nf,ec));for(const Wb of this.Cb.gNd){if(0>cf&&
-cf>Wb.F0f||cf>=Kb.items.length&&cf-Kb.items.length+1>Wb.y0f)continue;let Ug=!0;for(let gi=0;gi<Wb.$pb.length;++gi){const rf=cf+Wb.$pb[gi];Ld[gi]=rf;if(0>rf?0>this.Cb.G0f:rf>=Kb.items.length?0>this.Cb.z0f:!fc.hnc[rf]){Ug=!1;break}}Ug&&({Qel:Hc,Rel:Pc}=this.cDm(Wb,fc,Hc,Pc,ec,De,Ld))}this.Cb.OVc&&(nf.Vy(this.Cb.W3a?this.Cb.T2b:this.Cb.R2b,Hc),this.Cb.W3a&&nf.Vy(this.Cb.S2b,Pc))}eb=M.Annotations.KT(eb);this.Cb.OVc?eb.Vy(this.Cb.FNa,Kb):(eb.Vy(this.Cb.W3a?this.Cb.T2b:this.Cb.R2b,Hc),this.Cb.W3a&&eb.Vy(this.Cb.S2b,
Pc));return eb}Zfm(eb){let Kb,fc;if(!eb||!({value:Kb}=eb.Jq(this.Cb.FNa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Hc;({value:Hc}=eb.Jq(this.Cb.n_a)).returnValue||(Hc="");fc=new xi(Kb.items.length);const Pc=Wg(this.Cb.Blg,ec=>!ec.gUc||ec.gUc.isMatch(eb,null));for(let ec=0;ec<Kb.items.length;++ec){const Ld=Kb.items[ec];let De=null;fc.ylg[ec]=fc.gig.length;let cf=fc.hnc[ec]=0;for(const nf of Pc)0<nf.r_c&&fc.hnc[ec]+cf>=nf.r_c||nf.fbd&&!nf.fbd.isMatch(Ld,
null)||({hbd:De,$Gc:cf}=nf.apply(this,Ld,ec,fc,Hc,De,cf))}return{tokens:Kb,QXm:fc}}cDm(eb,Kb,fc,Hc,Pc,ec,Ld){let De=0;ec[0].dTc=-1;for(ec[0].vjf=eb.jej;;){var cf=Ld[De],nf=0>cf||cf>=Kb.hnc.length?1:Kb.hnc[cf];let gi=!1;for(;ec[De].dTc<nf-1;){++ec[De].dTc;var Wb=void 0,Ug=void 0;0>cf?(Wb=this.Cb.G0f,Ug=1):cf>=Kb.ylg.length?(Wb=this.Cb.z0f,Ug=1):(Ug=Kb.ylg[cf]+ec[De].dTc,Wb=Kb.gig[Ug],Ug=Kb.Nuj[Ug]);ec[De].D7c=Ug*(De?ec[De-1].D7c:eb.score);if(({value:Wb}=tm(ec[De].vjf,Wb.toString())).returnValue){De===
eb.$pb.length-1?(cf=Wb,ec[De].D7c&&(({value:nf}=tm(Pc,cf.toString())).returnValue||(nf=-1),0>nf&&(fc=M.Annotations.KT(fc),Array.add(fc.items,cf)),this.Cb.W3a&&(Hc=M.Annotations.KT(Hc),0>nf?Array.add(Hc.items,ec[De].D7c):Hc.items[nf]+=ec[De].D7c),0>nf&&(this.Cb.KCi||this.Cb.W3a)&&(Pc[cf.toString()]=fc.items.length-1))):(++De,ec[De].dTc=-1,ec[De].vjf=Wb);gi=!0;break}}if(!gi&&(--De,0>De))break}return{Qel:fc,Rel:Hc}}hci(eb,Kb){let fc;if(({value:fc}=eb.Jq(this.Cb.W3a?this.Cb.T2b:this.Cb.R2b)).returnValue)for(let Hc=
0;Hc<fc.items.length;++Hc)Kb[fc.items[Hc].toString()]=Hc;else fc=new Ib.a(this.Cb.annotations,M.Annotations.nJa);if(this.Cb.W3a){if(({value:Kb}=eb.Jq(this.Cb.S2b)).returnValue||(Kb=new Ib.a(this.Cb.annotations,M.Annotations.Ira)),Kb.items.length!==fc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Cb.annotations.zea(M.Annotations.FV,eb));}else Kb=null;return{returnValue:fc,uYh:Kb}}get dJo(){return this.Cb.Ele}Yfm(eb,
Kb){var fc;if(({value:fc}=Kb.Jq(this.Cb.Leb)).returnValue)eb=fc;else{if(!({value:fc}=Kb.Jq(this.Cb.N3)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Kb}=Kb.Jq(this.Cb.S7)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>fc||0>Kb||fc+Kb>eb.length)throw Error.argument("Token indices are out of range");eb=eb.substr(fc,Kb)}return eb}}Object(l.a)(Pg,"NGramNLModule",null,[1266,1268]);class fi{constructor(eb){this.$pb=null;this.score=this.y0f=this.F0f=
0;this.jej=null;if(eb){var Kb=0;try{if(eb.J(Kb)!==fi.oBb)throw Error.argument("initData","Input does not represent a feature template");++Kb;const fc=eb.J(Kb);++Kb;this.$pb=Array(fc);for(let Hc=0;Hc<fc;++Hc)this.$pb[Hc]=eb.J(Kb),++Kb;this.F0f=eb.J(Kb);++Kb;this.y0f=eb.J(Kb);++Kb;this.score=eb.J(Kb);++Kb;this.jej=({boi:Kb}=fi.T5i(eb,Kb)).returnValue}catch(fc){throw Error.argument("initData");}}}static T5i(eb,Kb){const fc=eb.J(Kb);++Kb;const Hc={};for(let Pc=0;Pc<fc;++Pc){const ec=eb.J(Kb);++Kb;eb.J(Kb)?
Hc[ec.toString()]=({boi:Kb}=fi.T5i(eb,Kb)).returnValue:(++Kb,Hc[ec.toString()]=eb.J(Kb),++Kb)}return{returnValue:Hc,boi:Kb}}}fi.oBb=240803228;Object(l.a)(fi,"FeatureTemplate",null,[1287]);var Em=c(1606);class kg{constructor(eb,Kb){this.W3a=this.KCi=this.OVc=!1;this.Leb=this.S7=this.N3=this.FNa=this.n_a=this.S2b=this.T2b=this.R2b=0;this.Ele=null;this.z0f=this.G0f=0;this.gNd=this.Blg=null;if(eb){this.annotations=Kb.annotations;var fc=0;try{this.OVc=1===eb.J(fc);++fc;this.KCi=1===eb.J(fc);++fc;this.W3a=
1===eb.J(fc);++fc;this.R2b=eb.J(fc);++fc;this.T2b=eb.J(fc);++fc;this.S2b=eb.J(fc);++fc;this.n_a=eb.J(fc);++fc;this.FNa=eb.J(fc);++fc;this.N3=eb.J(fc);++fc;this.S7=eb.J(fc);++fc;this.Leb=eb.J(fc);++fc;this.Ele=this.Pyn(Kb.lib(eb.J(fc)));++fc;this.G0f=eb.J(fc);++fc;this.z0f=eb.J(fc);++fc;const Hc=eb.J(fc);++fc;this.Blg=Array(Hc);for(let ec=0;ec<Hc;++ec){const Ld=eb.J(fc);++fc;const De=this.Ele.trie,cf=new Xb.a;cf.Xhb(eb,fc,Ld);this.Blg[ec]=this.Tyn(cf,Kb,De);fc+=Ld}const Pc=eb.J(fc);++fc;this.gNd=Array(Pc);
for(Kb=0;Kb<Pc;++Kb){const ec=eb.J(fc);++fc;const Ld=new Xb.a;Ld.Xhb(eb,fc,ec);this.gNd[Kb]=this.vyn(Ld);fc+=ec}}catch(Hc){throw Error.argument("initData");}}}Pyn(eb){return new wi.a(new Wi.a(eb))}Tyn(eb,Kb,fc){return Em.a.create(eb,Kb,fc)}vyn(eb){return new fi(eb)}}Object(l.a)(kg,"NGramNLModuleInit",null,[]);class aj{constructor(eb){this.Cb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");eb=eb.clone();this.Cb.script.execute(eb,null);return eb}}Object(l.a)(aj,"ScriptNLModule",null,[1266]);
class Ri{constructor(eb,Kb){eb&&(this.script=Kb.aFb(eb.J(0)))}}Object(l.a)(Ri,"ScriptNLModuleInit",null,[]);const Qk=eb=>{eb=km(eb,Kb=>Kb*Kb);return Math.sqrt(Fj(eb,(Kb,fc)=>Kb+fc,0))},dl=eb=>Fj(eb,(Kb,fc)=>Kb>fc?Kb:fc,eb[0]);class dm{constructor(eb){this.Cb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");var Kb=[],fc=[];this.KZk(eb,Kb,fc);this.syk(Kb,fc);const Hc={};for(let ec=0;ec<Kb.length;++ec){var Pc=Kb[ec];const Ld=this.Cb.tsi.J(Pc);Pc=this.Cb.usi.J(Pc);for(let De=0;De<Pc;++De){const cf=
this.Cb.f8.J(this.Cb.KCh.J(Ld+De)),nf=this.Cb.LCh.J(Ld+De);let Wb;({value:Wb}=tm(Hc,cf)).returnValue||(Wb=0);Hc[cf]=Wb+fc[ec]*nf}}fc=nl(Hc);fc.sort((ec,Ld)=>{var De=ec.value,cf=Ld.value;(De=-(De>cf?1:De<cf?-1:0))||(De=ec.key.localeCompare(Ld.key));return De});Kb=new Ib.a(this.Cb.annotations,M.Annotations.FV);for(const ec of hg(fc,this.Cb.r9m))fc=new P.a(this.Cb.annotations),fc.Vy(this.Cb.wGk,ec.key),fc.Vy(this.Cb.yGk,ec.value),Array.add(Kb.items,fc);eb.Vy(this.Cb.xGk,Kb);return eb}KZk(eb,Kb,fc){if(({value:eb}=
eb.Jq(this.Cb.vGk)).returnValue){let Hc;if(({value:Hc}=eb.Jq(this.Cb.T2b)).returnValue){let Pc;if(!({value:Pc}=eb.Jq(this.Cb.S2b)).returnValue||Hc.items.length!==Pc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.VFd(Hc,Pc,Kb,fc)}if(({value:Hc}=eb.Jq(this.Cb.AGk)).returnValue){let Pc;if(!({value:Pc}=eb.Jq(this.Cb.BGk)).returnValue||Hc.items.length!==Pc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.VFd(Hc,Pc,Kb,fc)}({value:Hc}=eb.Jq(this.Cb.R2b)).returnValue&&this.VFd(Hc,null,Kb,fc);({value:Hc}=eb.Jq(this.Cb.zGk)).returnValue&&this.VFd(Hc,null,Kb,fc)}}VFd(eb,Kb,fc,Hc){for(let ec=0;ec<eb.items.length;++ec){var Pc=void 0;eb.W4===M.Annotations.Q$?({value:Pc}=tm(this.Cb.YTh,eb.items[ec])).returnValue||(Pc=-1):(Pc=eb.items[ec],Pc=Pc>=this.Cb.COf&&Pc<=this.Cb.X9m?this.Cb.vSf?this.Cb.vSf.J(Pc-this.Cb.COf)-1:Pc-this.Cb.COf:-1);if(0<=Pc){let Ld;Ld=Kb?Kb.items[ec]:1;0<Ld&&(Array.add(fc,Pc),Array.add(Hc,
Ld))}}}syk(eb,Kb){if(eb.length){switch(this.Cb.YIn){case 0:break;case 1:for(var fc=0;fc<Kb.length;++fc)Kb[fc]=1+Math.log(Kb[fc]);break;case 2:fc=dl(Kb);for(let Hc=0;Hc<Kb.length;++Hc)Kb[Hc]=.5+Kb[Hc]/fc*.5;break;case 3:for(fc=0;fc<Kb.length;++fc)Kb[fc]=1;break;default:throw Error.notImplemented();}if(this.Cb.AXd)for(fc=0;fc<Kb.length;++fc)Kb[fc]*=this.Cb.AXd.J(eb[fc]);eb=Qk(Kb);for(fc=0;fc<Kb.length;++fc)Kb[fc]/=eb}}}Object(l.a)(dm,"TfIdfRankerNLModule",null,[1266]);class xn{constructor(eb,Kb=0){if(!eb)throw Error.argumentNull("byteArray");
this.a3d=Kb;if(604662927!==eb.Ty(this.a3d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Xj=eb.Ty(this.a3d+4,4);this.AKi=eb.Ty(this.a3d+8,4);this.J6m=eb}J(eb){if(0>eb||eb>=this.count)throw Error.argumentOutOfRange("index");return this.J6m.JNn(8*this.a3d+96+eb*this.AKi,this.AKi)}get count(){return this.Xj}}Object(l.a)(xn,"CompactIntArray",null,[1261]);const ah=(eb,Kb)=>{Kb=Array(Kb);for(let ec=0;ec<Kb.length;ec++){var fc=ec,Hc=eb.j$(),Pc=1===(Hc>>31&1)?-1:
1;const Ld=Hc&8388607;Hc=Hc>>23&255;256===Hc+1?Pc=Ld?Number.NaN:1===Pc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Hc?(Hc-=127,Pc=Pc*Tn(Ld,1)*Math.pow(2,Hc)):Pc=Pc*Tn(Ld,0)*Math.pow(2,-126);Kb[fc]=Pc}return Kb},Tn=(eb,Kb)=>{let fc=0;for(let Hc=0;23>Hc;Hc++)fc+=(eb>>22-Hc&1)/Math.pow(2,Hc+1);return Kb+fc};class Jj{constructor(eb,Kb){this.vSf=null;this.WQi=0;this.usi=this.tsi=this.AXd=null;this.VQi=0;this.LCh=this.KCh=null;this.annotations=Kb.annotations;let fc=0;this.zGk=eb.J(fc);++fc;this.R2b=
eb.J(fc);++fc;this.AGk=eb.J(fc);++fc;this.BGk=eb.J(fc);++fc;this.T2b=eb.J(fc);++fc;this.S2b=eb.J(fc);++fc;this.vGk=eb.J(fc);++fc;this.xGk=eb.J(fc);++fc;this.wGk=eb.J(fc);++fc;this.yGk=eb.J(fc);++fc;var Hc=eb.J(fc);++fc;var Pc=Array(Hc);for(var ec=0;ec<Hc;++ec)Pc[ec]=Kb.XC(eb.J(fc)),++fc;this.f8=Xb.a.Jaf(Pc);this.r9m=eb.J(fc);++fc;this.YIn=eb.J(fc);++fc;Hc=eb.J(fc);++fc;this.YTh={};for(Pc=0;Pc<Hc;++Pc){ec=Kb.XC(eb.J(fc));++fc;const Ld=eb.J(fc);++fc;this.YTh[ec]=Ld}this.COf=eb.J(fc);++fc;this.X9m=eb.J(fc);
++fc;Hc=eb.J(fc);++fc;0<Hc&&(Hc=Kb.lib(eb.J(fc)),++fc,this.vSf=this.s9d(new Me(Hc)));++fc;eb=Kb.lib(eb.J(fc));this.Cyn(eb)}s9d(eb){return new xn(eb.z_,eb.offset)}Cyn(eb){try{const Kb=new Me(eb);this.WQi=Kb.j$();1===Kb.j$()?this.AXd=Xb.a.Jaf(ah(Kb,this.WQi)):this.AXd=null;const fc=Kb.j$();this.tsi=this.s9d(Kb);Kb.offset+=fc;const Hc=Kb.j$();this.usi=this.s9d(Kb);Kb.offset+=Hc;this.VQi=Kb.j$();const Pc=Kb.j$();this.KCh=this.s9d(Kb);Kb.offset+=Pc;this.LCh=Xb.a.Jaf(ah(Kb,this.VQi))}catch(Kb){throw Error.argument("byteReader");
}}}Object(l.a)(Jj,"TfIdfRankerNLModuleInit",null,[]);class Yi{constructor(eb,Kb,fc,Hc){this.EZf=eb;this.q_h=fc;this.tokens=Hc;this.xna=Kb;this.dkc=-1;this.lfe=0}}Object(l.a)(Yi,"TokenizerData",null,[]);class Lm{constructor(eb){this.Cb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");if(!({value:Hc}=eb.Jq(this.Cb.n_a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Kb;({value:Kb}=eb.Jq(this.Cb.N3)).returnValue||(Kb=0);let fc;({value:fc}=
eb.Jq(this.Cb.S7)).returnValue||(fc=Hc.length-Kb);if(0>Kb||Kb>Hc.length)throw Error.argument("input","Start index out of range");if(0>fc||fc>Hc.length)throw Error.argument("input","Length out of range");if(Kb+fc>Hc.length)throw Error.argument("input","Bad start-length range");var Hc=new Yi(Hc,Kb,Kb+fc,new Ib.a(this.Cb.annotations,M.Annotations.FV));this.eJo(Hc);eb=eb.isReadOnly?eb.clone():eb;eb.Vy(this.Cb.FNa,Hc.tokens);return eb}eJo(eb){for(;eb.xna<eb.q_h;){if(this.Cb.Gvf){var Kb=this.Cb.Gvf.eKi(eb.EZf,
eb.xna,eb.q_h-eb.xna,null);!Kb.succeeded&&Kb.MPi&&(Kb=Kb.MPi);if(Kb.succeeded){this.RUi(eb,Kb.length,this.Cb.fki);eb.xna+=Kb.length;continue}}Kb=eb.EZf.substr(eb.xna);let fc=-1,Hc=-1,Pc=-1;for(let ec=0;ec<this.Cb.lee.length;++ec){const Ld=this.Cb.lee[ec].exec(Kb);Ld&&0<Ld[1].length&&(0>fc||Ld[0].length>Hc)&&(fc=ec,Hc=Ld[0].length,Pc=Ld[1].length)}0<=fc?(this.RUi(eb,Pc,this.Cb.o$f[fc]),eb.xna+=Pc):eb.xna+=1}}RUi(eb,Kb,fc){if(this.Cb.bBi)fc!==Lm.sOk&&(0>eb.dkc&&(eb.dkc=eb.xna),eb.lfe=eb.xna+Kb-eb.dkc,
fc===Lm.rOk&&(0<=eb.dkc&&0<eb.lfe&&(Kb=new P.a(this.Cb.annotations),Kb.Vy(this.Cb.N3,eb.dkc),Kb.Vy(this.Cb.S7,eb.lfe),Kb.Vy(this.Cb.n2e,Lm.tOk),Kb.Vy(this.Cb.n_a,eb.EZf),Array.add(eb.tokens.items,Kb)),eb.dkc=-1,eb.lfe=0));else{let Hc=new P.a(this.Cb.annotations);Hc.Vy(this.Cb.N3,eb.xna);Hc.Vy(this.Cb.S7,Kb);Hc.Vy(this.Cb.n2e,fc);Array.add(eb.tokens.items,Hc)}}}Lm.sOk="GAP";Lm.rOk="EOS_CHUNK";Lm.tOk="SENTENCE";Object(l.a)(Lm,"TokenizerNLModule",null,[1266]);class bn{constructor(eb,Kb){this.S7=this.N3=
this.n2e=this.FNa=this.n_a=0;this.bBi=!1;this.o$f=this.lee=this.fki=this.Gvf=null;if(eb){this.annotations=Kb.annotations;var fc=0;try{this.n_a=eb.J(fc);++fc;this.FNa=eb.J(fc);++fc;this.n2e=eb.J(fc);++fc;this.N3=eb.J(fc);++fc;this.S7=eb.J(fc);++fc;this.bBi=1===eb.J(fc);++fc;var Hc=eb.J(fc);++fc;0<Hc&&(this.Gvf=Kb.irf(Hc).aBl);this.fki=eb.J(fc)?Kb.XC(eb.J(fc)):"";++fc;const Pc=eb.J(fc);++fc;this.lee=Array(Pc);this.o$f=Array(Pc);for(Hc=0;Hc<Pc;++Hc)this.lee[Hc]=new RegExp(Kb.XC(eb.J(fc))),++fc,this.o$f[Hc]=
Kb.XC(eb.J(fc)),++fc}catch(Pc){throw Error.argument("initData");}}}}Object(l.a)(bn,"TokenizerNLModuleInit",null,[]);class zh{constructor(eb){this.Cb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");let Kb;if(!({value:Kb}=eb.Jq(this.Cb.Nuh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const fc of this.Cb.yhg)Kb=fc.apply(Kb);eb=M.Annotations.KT(eb);eb.Vy(this.Cb.Ouh,Kb);return eb}static w1e(eb,Kb){const fc=new Sys.StringBuilder;for(let Hc=
0;Hc<eb.length;++Hc)fc.append(Kb(eb.substr(Hc,1)));return fc.toString()}}Object(l.a)(zh,"TransliteratorNLModule",null,[1266]);class vg{constructor(eb){eb&&(this.style=eb.J(0))}apply(eb){return zh.w1e(eb,Kb=>vg.RSk(Kb,this.style))}static RSk(eb,Kb){switch(Kb){case 0:return eb.toLowerCase();case 1:return"I"===eb?"\u0131":eb.toLowerCase();case 2:return eb.toUpperCase();case 3:return"i"===eb?"\u0130":eb.toUpperCase();default:throw Error.invalidOperation();}}}vg.pBb=0;Object(l.a)(vg,"ChangeCaseTransliterationStage",
null,[1274]);class jl{apply(eb){return zh.w1e(eb,jl.FKo)}static FKo(eb){const Kb=eb.charCodeAt(0);return 65281<=Kb&&65374>=Kb?String.fromCharCode(Kb-65248):eb}}jl.pBb=4;Object(l.a)(jl,"LatinFullWidthToHalfWidthTransliterationStage",null,[1274]);class Cl{constructor(eb,Kb){eb&&(this.q5f=Kb.b$b(eb.J(0)),this.Q1n=Kb.XC(eb.J(1)))}apply(eb){return eb.replace(this.q5f,this.Q1n)}}Cl.pBb=1;Object(l.a)(Cl,"RegexReplaceTransliterationStage",null,[1274]);class um{constructor(eb,Kb){if(eb){var fc=eb.J(0),Hc=
Kb.XC(eb.J(1)),Pc=new xn(Kb.lib(eb.J(2)));eb=0>eb.J(3)?null:new xn(Kb.lib(eb.J(3)));this.Dig={};for(Kb=0;Kb<fc;++Kb)this.Dig[Hc.charAt(Kb).toString()]=Hc.substr(Pc.J(Kb),eb?eb.J(Kb):1)}}apply(eb){return zh.w1e(eb,Kb=>Kb in this.Dig?this.Dig[Kb]:Kb)}}um.pBb=2;Object(l.a)(um,"SingleCharSubstitutionsTransliterationStage",null,[1274]);class Qm{constructor(eb,Kb){this.Ouh=this.Nuh=0;this.yhg=null;if(eb){this.annotations=Kb.annotations;var fc=0;try{this.Nuh=eb.J(fc);++fc;this.Ouh=eb.J(fc);++fc;const Hc=
eb.J(fc);++fc;this.yhg=Array(Hc);for(let Pc=0;Pc<Hc;++Pc){const ec=eb.J(fc);++fc;const Ld=eb.J(fc);++fc;const De=new Xb.a;De.Xhb(eb,fc,Ld);fc+=Ld;this.yhg[Pc]=this.Oyn(ec,De,Kb)}}catch(Hc){throw Error.argument("initData");}}}Oyn(eb,Kb,fc){switch(eb){case vg.pBb:return new vg(Kb);case Cl.pBb:return new Cl(Kb,fc);case um.pBb:return new um(Kb,fc);case jl.pBb:return new jl;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(Qm,"TransliteratorNLModuleInit",
null,[]);class oj{r3l(eb,Kb){const fc=eb.J(0),Hc=new Xb.a;Hc.Xhb(eb,1,eb.count-1);switch(fc){case 0:return new aj(new Ri(Hc,Kb));case 2:return new Lm(new bn(Hc,Kb));case 3:return new Pg(new kg(Hc,Kb));case 5:return new ul(new qi(Hc,Kb));case 9:return new zh(new Qm(Hc,Kb));case 10:return new dm(new Jj(Hc,Kb));default:throw Error.notImplemented();}}}Object(l.a)(oj,"NLModuleFactory",null,[1238]);class ph{constructor(eb){this.pOk=";";if(!eb)throw Error.argumentNull("resource");this.Cia=new Zg(eb,new zb,
new oj);this.cNf=this.Cia.X2l();this.zKi=this.Cia.annotations.KOc("Text.Text");this.xKi=this.Cia.annotations.KOc("Classification.Predictions");this.OMf=this.Cia.annotations.KOc("Classification.PredictionString");this.yKi=this.Cia.annotations.KOc("Classification.Probability");this.I6m=this.Cia.annotations.KOc("NLMod.Tokens");if(0>this.zKi||0>this.xKi||0>this.OMf||0>this.yKi)throw Error.argument("resourceObj","Resource does not represent a ranker");}OMl(){const eb=[];this.jif(void 0,this.h4h(eb),null);
return eb}QMl(eb,Kb){const fc=[],Hc=[];this.jif(eb,this.h4h(fc),(Pc,ec)=>{const Ld=this.Cia.annotations.V3h(Pc),De=[],cf=[];Kb&&Kb.length&&-1===Array.indexOf(Kb,Ld)||(Pc=this.Cia.annotations.getAttributeType(Pc),this.b1i(Pc,ec,De,cf),ec=new Rf(Ld,De,cf),Array.add(Hc,ec))});return new jg(fc,Hc)}PMl(eb){const Kb=[];this.jif(eb,fc=>{let Hc;if(({value:Hc}=fc.Jq(this.OMf)).returnValue){let Pc;({value:Pc}=fc.Jq(this.yKi)).returnValue&&Array.add(Kb,new Af(Hc,Pc))}},null);return Kb}jif(eb,Kb,fc){var Hc=new P.a(this.Cia.annotations);
Hc.Vy(this.zKi,eb);eb=this.cNf.execute(Hc);if(({value:Hc}=eb.Jq(this.xKi)).returnValue)for(const Pc of Hc.items)Kb(Pc);if(fc&&({value:Kb}=eb.Jq(this.I6m)).returnValue)for(const Pc of Kb.items)Pc.uOd(fc)}b1i(eb,Kb,fc,Hc){if(M.Annotations.oI(eb))for(var Pc of Kb.items)this.b1i(Kb.W4,Pc,fc,Hc);else if(M.Annotations.QBj(eb)){Pc=this.Cia.annotations.Nbi(eb);for(let ec=0;ec<Pc;ec++)Array.add(fc,this.Cia.annotations.pgi(eb,ec)),Array.add(Hc,this.Cia.annotations.zea(this.Cia.annotations.BGb(eb,ec),Kb.zib(ec)))}else Array.add(fc,
"VALUE"),Array.add(Hc,this.Cia.annotations.zea(eb,Kb))}h4h(eb){return Kb=>{let fc;({value:fc}=Kb.Jq(this.OMf)).returnValue&&Array.add(eb,this.n8l(fc))}}n8l(eb){const Kb=eb.indexOf(this.pOk);return 0>Kb?eb:eb.substring(0,Kb)}}Object(l.a)(ph,"Ranker",null,[]);var cd=c(1543),dg=c(1555),vm=c(2);class Rm{constructor(eb,Kb){this.X2g="";this.zOe=null;this.AOe=!1;this.esa=null;this.SUj=["TellMe.TellMeParamCollection"];this.fc=eb;this.hYa=Kb;this.fc.IAb&&(this.esa=null)}get Uae(){if(!this.zOe&&!this.AOe){let eb=
null;try{eb=window.TellMeModel}catch(Kb){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("QueryRanker","TellMeModel not found. Exception: "+Kb)}if(eb){try{this.zOe=new ph(eb)}catch(Kb){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Kb)}this.AOe=!0}else if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("QueryRanker","Classifier model not found")}return this.zOe}lL(){return"Command"}rU(){return 0===
this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc=!1,Hc=f.a.tellMe,Pc=null){const ec=new m.a(eb);if((!Pc||Array.contains(Pc,0))&&!z.a.BR(eb)){if(!this.Uae&&this.AOe){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.fc.IAb&&this.esa&&this.esa.initialize();if(cd.CommandResultsUtility.vCf(eb.Cg)&&(Pc=cd.CommandResultsUtility.M5h(eb.Cg),0<Pc.results.length)){Pc.displayName=
"Classifier Debug";ec.$u(Pc);Kb.resultsUpdated(ec);return}Pc=eb?this.X2g=eb.Cg:this.X2g;if(vm.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Pc=this.p8l(Pc);var Ld=this.OPd(Pc.msf());Pc=Pc.x3h()}else Pc=this.o8l(Pc),Ld=this.WPl(Pc),Pc=[];cd.CommandResultsUtility.m2d(Ld,!1,"Classifier","TFIDF");Ld=cd.CommandResultsUtility.WQc(eb,Ld,this.fc,this.esa,this.hYa,Pc,0,1);0<Ld.results.length&&Hc!==f.a.contextMenu&&(Ld.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);fc||Ld.results.length||
this.fc.u0||this.fc.T7a||(eb=new x.a("lookupNoResults",14,eb.Cg,null,1),Ld.Rw(eb));0<Ld.results.length&&ec.$u(Ld);ec.attributes=Pc}Kb.resultsUpdated(ec)}msf(){let eb=[];try{eb=this.Uae.OMl()}catch(Kb){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("GetPredictions","Exception: "+Kb)}return eb}o8l(eb){let Kb=[];try{Kb=this.Uae.PMl(eb)}catch(fc){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("GetPredictionsWithScore","Exception: "+fc)}return Kb}p8l(eb){try{return this.Uae.QMl(eb,
this.SUj)}catch(Kb){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("GetPredictionsWithTokenAttributes","Exception: "+Kb)}return new jg([],[])}OPd(eb){const Kb=[];if(eb)for(const fc of eb)Kb.push(new dg.a(fc,-99999));return Kb}WPl(eb){const Kb=[];if(eb)for(const fc of eb)Kb.push(new dg.a(fc.prediction,fc.score));return Kb}}Object(l.a)(Rm,"CommandResultsProvider",null,[1117]);var ce=c(1741);class md{constructor(eb){this.fc=eb}lL(){return"Feedback"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?
1:2}ZH(eb,Kb,fc,Hc,Pc=null){eb=new m.a(eb);if(!Pc||Array.contains(Pc,21))Pc=[],Pc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Pc),Pc=new y.a(22),Pc.displayName="",Pc.Rw(new x.a("TellMeFeedback",23,null,null,1)),eb.$u(Pc);Kb.resultsUpdated(eb)}}Object(l.a)(md,"FeedbackResultsProvider",null,[1117]);class mg{constructor(eb,Kb,fc,Hc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=eb;this.CommandId=
Kb;this.CommandValueId=fc;this.InputText=Hc}}Object(l.a)(mg,"FindInDocumentProp",null,[]);var Kg=c(19);class Jd{constructor(eb){this.rJe=2;this.Jwb=[];this.fcb=[];this.fc=eb;Jd.EEa=eb.Djf;Jd.JZh="FindInDocumentSuggestion";Jd.o0i="FindInDocumentSuggestion3";this.jIe=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.khk=this.fc.Npb||!!vm.AFrameworkApplication.ua&&vm.AFrameworkApplication.ua.Lb.Npb}lL(){return"FindInDocument"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:3===this.fc.fv?this.fc.gsj?
2:3:2}ZH(eb,Kb,fc=!1,Hc,Pc=null){const ec=new m.a(eb);if(Pc&&!Array.contains(Pc,2))Kb.resultsUpdated(ec);else if(Array.clear(this.Jwb),z.a.BR(eb)){if(fc&&this.qpj()){fc=new y.a(2);fc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Pc=1;Hc="";if(0<this.fcb.length&&!this.fc.Zkc)for(var Ld of this.fcb)if(""!==Ld.Label.toLowerCase()){if(Pc>=this.rJe)break;this.MFj(fc,Ld.Label,Ld.CommandValueId,Jd.JZh+Pc,Ld.InputText);Pc++}Ld="";this.fc.PP?(ec.$u(fc),fc=new y.a(3),Ld=this.fc.Geb?z.a.iib(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Ld=CommonUIStrings.l_TellMeOpenFindPaneText;Hc=this.L5h("");this.MFj(fc,Ld,Hc,Jd.o0i,"");ec.$u(fc)}Kb.resultsUpdated(ec)}else Ld="",fc&&(fc=this.L5h(eb.Cg),Hc=[],this.fc.x4a?(this.fc.Phe&&Hc.push(appChrome.actions.setControlIconSet(Jd.EEa,{"default":"FindInDocument_20"})),Ld=this.fc.NGf?z.a.Fpf(eb.Cg,CommonUIStrings.l_FindInDocumentScopedButtonText):eb.Cg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.fc.PP?(Ld=this.fc.Geb?z.a.iib(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
eb.Cg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,eb.Cg),Hc.push(appChrome.actions.setControlIconSet(Jd.EEa,{"default":"FindInDocument_20"}))):Ld=this.fc.Zkc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,eb.Cg),this.fc.Pwa?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Jd.EEa,Ld)),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Jd.EEa,fc))):(Hc.push(appChrome.actions.setControlLabel(Jd.EEa,
Ld)),Hc.push(appChrome.actions.setButtonCommandValueId(Jd.EEa,fc)),appChrome.api.dispatch(Hc)),this.Nkj(Ld,Jd.EEa,fc,eb.Cg)),this.fc.gsj?(Ld=new x.a(Jd.EEa,8,eb.Cg),fc=new y.a(2),fc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,fc.Rw(Ld),ec.$u(fc),Kb.resultsUpdated(ec)):this.fc.MQd(eb.Cg).then(De=>{const cf=new x.a(Jd.EEa,8,eb.Cg,null,1);cf.count=De;De=new y.a(2);De.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;De.Rw(cf);ec.$u(De);Kb.resultsUpdated(ec)},De=>{r.TellMeActor.instance.Le.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+De);De=new x.a(Jd.EEa,8,eb.Cg,null,1);const cf=new y.a(2);cf.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;cf.Rw(De);ec.$u(cf);Kb.resultsUpdated(ec)})}qpj(){return!!this.fc&&this.fc.Hhe}MFj(eb,Kb,fc,Hc,Pc=null){const ec=[];Kb&&ec.push(appChrome.actions.setControlLabel(Hc,Kb));this.fc.PP&&ec.push(appChrome.actions.setControlIconSet(Hc,{"default":"FindInDocument_20"}));ec.push(appChrome.actions.setButtonCommandValueId(Hc,fc));appChrome.api.dispatch(ec);
this.Nkj(Kb,Hc,fc,"");eb.Rw(new x.a(Hc,8,Pc,null,1,-99999))}L5h(eb){return this.khk?z.a.uOa(eb,15,this.jIe):Kg.a.vf(eb)}Nkj(eb,Kb,fc,Hc){this.qpj()&&this.Jwb.length<this.rJe&&(eb=new mg(eb,Kb,fc,Hc),Array.add(this.Jwb,eb))}qio(eb){for(let Kb=0;Kb<this.Jwb.length;Kb++)if(this.Jwb[Kb].CommandId===eb){const fc=this.Jwb[Kb].Label;let Hc=!1;if(0<this.fcb.length){let Pc=0;for(const ec of this.fcb){if(ec.Label===fc){Array.removeAt(this.fcb,Pc);Hc=!0;break}Pc++}}!Hc&&this.fcb.length>=this.rJe-1&&Array.removeAt(this.fcb,
1);Array.insert(this.fcb,0,this.Jwb[Kb])}}}Jd.EEa=null;Jd.JZh=null;Jd.o0i=null;Object(l.a)(Jd,"FindInDocumentResultsProvider",null,[1117]);var tg=c(1739);class xd{constructor(eb){this.fc=eb}lL(){return"Insights"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc=!1,Hc,Pc=null){Hc=new m.a(eb);if(!Pc||Array.contains(Pc,13))if(this.Hro()||!z.a.BR(eb)){Pc=new y.a(13);var ec=""===eb.Cg.trim(),Ld=ec?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",De=new x.a(Ld,10,eb.Cg,null,1);fc&&(fc=
null,z.a.xpa()?ec?ec=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(ec=this.fc.Zkc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,eb.Cg),fc=z.a.uOa(eb.Cg,1)):(ec=String.format(CommonUIStrings.l_InsightsButtonText,eb.Cg),fc=z.a.QCb(eb.Cg)),this.fc.Pwa?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ld,ec)),fc&&r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
fc))):(eb=[],eb.push(appChrome.actions.setControlLabel(Ld,ec)),fc&&eb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",fc)),appChrome.api.dispatch(eb)),De.label=ec);Pc.Rw(De);Hc.$u(Pc)}Kb.resultsUpdated(Hc)}Hro(){return z.a.xpa()&&this.fc.hGo&&!this.fc.Yga}}Object(l.a)(xd,"InsightsResultsProvider",null,[1117]);var Oi=c(1737);class he{constructor(eb){this.fc=eb}lL(){return"Learning"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc,Hc,Pc=null){fc=new m.a(eb);Pc&&!Array.contains(Pc,
21)||!z.a.BR(eb)||(Pc=[],Hc=this.fc.aZm,Pc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Hc)),Hc=he.pXl(Hc),Pc.push(appChrome.actions.setControlLabel("LearningForSearch",Hc)),appChrome.api.dispatch(Pc),eb=new x.a("LearningForSearch",22,eb.Cg,null,1),Pc=new y.a(21),Pc.Rw(eb),fc.$u(Pc));Kb.resultsUpdated(fc)}static pXl(eb){const Kb=[];Array.add(Kb,new Oi.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Kb,new Oi.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Kb,new Oi.a(600,eb));Array.add(Kb,new Oi.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));eb={};eb.parts=Kb;return JSON.stringify(eb)}}Object(l.a)(he,"LearningProvider",null,[1117]);var Ng=c(609);class wk{constructor(eb,Kb){this.cYb=this.U0b=this.Fcb=this.Hqd=null;this.zx=!1;this.LYb=eb;this.jZj=Kb;eb&&this.WXh(eb)}nme(){this.LYb.nme()&&this.WXh(this.LYb)}getSuggestions(eb){let Kb=[];var fc=[];eb=wk.rfn(eb);var Hc="";Array.clear(fc);for(let Pc=0;Pc<eb.length;Pc++){const ec=eb.charAt(Pc);
-1!==" ".indexOf(ec)?(Hc.length&&Array.add(fc,Hc),Hc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(ec)?(Hc.length&&Array.add(fc,Hc),Hc=ec,Array.add(fc,Hc),Hc=""):Hc+=ec}Hc.length&&Array.add(fc,Hc);for(eb=0;eb<fc.length;eb++)Hc=this.VPl(fc[eb]),Hc=this.z5k(Hc),Kb=wk.U$m(Kb,Hc);return Kb=this.wsk(Kb)}YEf(){this.zx||this.nme();return this.zx}pJd(eb){return this.Hqd[eb.toString()]}wsk(eb){for(let Kb=0;Kb<eb.length;Kb++){const fc=this.Fcb[Kb];if(eb[Kb].commandId!==this.pJd(fc[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Hc;(Hc=eb[Kb]).score=Hc.score+fc[1]}return eb}z5k(eb){const Kb=[];for(var fc=0;fc<this.Fcb.length;fc++)Kb.push(new dg.a(this.pJd(this.Fcb[fc][0]),-5));fc=new Ng.a;for(var Hc=0;Hc<eb.length;Hc++)fc.add(this.pJd(eb[Hc][0]));for(Hc=0;Hc<Kb.length;Hc++){const ec=Kb[Hc];for(let Ld=0;Ld<eb.length;Ld++){var Pc=eb[Ld];const De=this.pJd(Pc[0]);Pc=Pc[1];if(De===ec.commandId){ec.score=Pc;fc.remove(De);break}}if(!fc.count)break}return Kb}VPl(eb){const Kb=1>eb.length;for(let Ld=0;2>=Ld;Ld++){const De=this.cYb;
for(let cf in De){var fc=De[cf],Hc=eb,Pc=cf;const nf=Pc.length+1,Wb=Array((Hc.length+1)*nf);for(var ec=0;ec<=Hc.length;ec++)Wb[ec*nf]=ec;for(ec=0;ec<=Pc.length;ec++)Wb[ec]=ec;for(ec=0;ec<Pc.length;ec++)for(let Ug=0;Ug<Hc.length;Ug++)Wb[(Ug+1)*nf+(ec+1)]=Hc.charAt(Ug)===Pc.charAt(ec)?Wb[Ug*nf+ec]:Math.min(Math.min(Wb[Ug*nf+(ec+1)]+1,Wb[(Ug+1)*nf+ec]+1),Wb[Ug*nf+ec]+1);Hc=Wb[Hc.length*nf+Pc.length];if((!Hc||!Kb)&&Hc<=Ld)return fc}}return this.U0b}WXh(eb){this.Hqd=eb.hrf();this.Fcb=eb.W8l();this.U0b=
eb.ehm();this.cYb=eb.R_l();if(this.zx=!!this.Hqd&&!!this.Fcb&&!!this.cYb&&!!this.U0b)this.zx=0<this.Fcb.length&&wk.aCf(this.Fcb);this.zx&&(this.zx=0<this.U0b.length&&wk.aCf(this.U0b));this.zx&&(this.cYb=wk.Vhm(this.cYb));this.zx||(this.cYb=this.U0b=this.Fcb=this.Hqd=null)}kgm(eb){eb=this.getSuggestions(eb);return this.NAl(eb,this.jZj)}NAl(eb,Kb){let fc=[];for(let Hc=0;Hc<eb.length;Hc++)eb[Hc].score>=Kb&&fc.push(eb[Hc]);fc.sort((Hc,Pc)=>Hc.score<Pc.score?1:Hc.score>Pc.score?-1:0);0<fc.length-10&&(fc=
fc.slice(0,10));return fc}static U$m(eb,Kb){if(!eb.length)return Kb;if(eb.length!==Kb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let fc=0;fc<eb.length;fc++){if(eb[fc].commandId!==Kb[fc].commandId)throw Error.create("Incorrect CommandId");let Hc;(Hc=eb[fc]).score=Hc.score+Kb[fc].score}return eb}static rfn(eb){return Kg.a.Zg(eb)}static aCf(eb){for(let Kb=0;Kb<eb.length;Kb++)if(2!==eb[Kb].length)return!1;return!0}static Vhm(eb){const Kb=
{};for(let Pc in eb){var fc=Pc,Hc=eb[Pc];const ec=Hc;ec.length&&wk.aCf(ec)&&(Kb[fc]=Hc)}return Kb}}Object(l.a)(wk,"NaiveBayesClassifierModel",null,[]);class Vj{constructor(eb,Kb){this.esa=null;this.fc=eb;this.Qyc=new wk(Kb,eb.s3l);this.fc.IAb&&(this.esa=null)}lL(){return"NBCommand"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc=!1,Hc=f.a.tellMe,Pc=null){const ec=new m.a(eb);if((!Pc||Array.contains(Pc,0))&&!z.a.BR(eb)){if(cd.CommandResultsUtility.vCf(eb.Cg)&&(Pc=cd.CommandResultsUtility.M5h(eb.Cg),
0<Pc.results.length)){Pc.displayName="Classifier Debug";ec.$u(Pc);Kb.resultsUpdated(ec);return}if(!this.Qyc.YEf()){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.fc.IAb&&this.esa&&this.esa.initialize();Pc=this.Qyc.kgm(eb.Cg);cd.CommandResultsUtility.m2d(Pc,!1,"Classifier","NaiveBayesian");Pc=cd.CommandResultsUtility.WQc(eb,Pc,this.fc,this.esa,
null,null,0,1);0<Pc.results.length&&Hc!==f.a.contextMenu&&(Pc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);fc||Pc.results.length||this.fc.u0||this.fc.T7a||(eb=new x.a("lookupNoResults",14,eb.Cg,null,1),Pc.Rw(eb));0<Pc.results.length&&ec.$u(Pc)}Kb.resultsUpdated(ec)}}Object(l.a)(Vj,"NaiveBayesCommandProvider",null,[1117]);class Xg{constructor(){this.Gwb=null;this.zx=!1;this.nme()}nme(){this.zx||(this.Gwb=window.NBCRM)&&4===this.Gwb.length&&(this.zx=!0);return this.zx}W8l(){return this.zx?
this.Gwb[1]:null}ehm(){return this.zx?this.Gwb[2]:null}R_l(){return this.zx?this.Gwb[3][0]:null}hrf(){return this.zx?this.Gwb[0][0]:null}}Object(l.a)(Xg,"NaiveBayesModelAdapter",null,[1147]);var jf=c(182);class sf{constructor(eb){this.fc=eb}lL(){return"OfficeScript"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb){const fc=new m.a(eb);if(!z.a.BR(eb)){eb=jf.d(eb.Cg);var Hc=new y.a(28);Hc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Hc=this.doh(eb,sf.kPo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Hc);Hc=this.doh(eb,sf.QHl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Hc);fc.$u(Hc)}Kb.resultsUpdated(fc)}doh(eb,Kb,fc,Hc,Pc,ec){const Ld=[];for(const De of Kb)if(jf.a(eb,De)){this.fc.Pwa?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(fc,Pc)),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(fc,Hc))):(Ld.push(appChrome.actions.setControlLabel(fc,
Pc)),Ld.push(appChrome.actions.setButtonCommandValueId(fc,Hc)),appChrome.api.dispatch(Ld));ec.Rw(new x.a(fc,28,null,null,1));break}return ec}}sf.kPo="unhide row rows col cols column columns".split(" ");sf.QHl=["freeze","selection","pane","panes"];Object(l.a)(sf,"OfficeScriptsSamplesProvider",null,[1117]);var Rh=c(75),ij=c(344),hn=c(1571),pg=c(1535),Rl=c(1570),nh=c(34),vl=c(135),Dl=c(25);class oe{constructor(eb){this.wQ=null;this.B2=-1;this.TNf=14;this.VNf=12;this.attributes=this.UVe=this.query=null;
this.Wcc=!1;this.VZb=[];this.Wf=vm.AFrameworkApplication.He;vm.AFrameworkApplication.K&&(this.TNf=vm.AFrameworkApplication.K.lc("TellMeMaxTermedResults",this.TNf),this.VNf=vm.AFrameworkApplication.K.lc("TellMeMaxZeroTermResults",this.VNf));this.NR=eb}get uo(){return this.VZb}get Sme(){return this.UVe}$u(eb){let Kb=!1;for(let fc=0;fc<this.uo.length;fc++)if(30!==this.uo[fc].groupType&&this.uo[fc].groupType===eb.groupType){this.jZe(this.uo[fc],eb);Kb=!0;break}Kb||this.uo.push(eb)}jZe(eb,Kb){for(let fc=
0;fc<Kb.results.length;fc++)eb.Rw(Kb.results[fc])}$9i(eb){const Kb=[];for(const fc of this.uo)fc.groupType!==eb&&Kb.push(fc);this.uo.length!==Kb.length&&(this.VZb=Kb)}kYn(eb){let Kb=null,fc=null,Hc=null;for(let Pc=0;Pc<eb.length;Pc++){const ec=eb[Pc];if(ec&&ec.uo&&ec.uo.length)for(const Ld of ec.uo)if(17===Ld.groupType||18===Ld.groupType)Kb=Ld;else if(0===Ld.groupType||16===Ld.groupType)fc=Ld,Hc=ec}Kb&&fc&&0<fc.results.length&&(17===Kb.groupType&&({GYe:fc,xZe:Kb}=cd.CommandResultsUtility.$qk(fc,Kb,
this.NR.aP()?this.NR.aP().pPl:-.6)),Hc.$9i(fc.groupType))}Hxo(){this.NR&&(new Rh.a,this.x$c(this.NR.eLi))}xXc(eb,Kb){return this.query.Cg.length>this.NR.aP().G9l&&this.hQm(eb,Kb)||this.query.Cg.length>this.NR.aP().H9l&&this.WSm(eb,Kb)?!0:!1}WSm(eb,Kb){return eb&&eb.length&&Kb&&Kb.length?-1===Kb.toLowerCase().indexOf(eb.toLowerCase())?!1:!0:!1}hQm(eb,Kb){return eb&&eb.length&&Kb&&Kb.length?Kb.toLowerCase().startsWith(eb.toLowerCase()):!1}ZAl(eb){const Kb=[];for(const fc of this.NR.aP().PP?this.Sme:
this.uo)eb.contains(fc.groupType)||Kb.push(fc);this.NR.aP().PP?this.UVe=Kb:this.VZb=Kb}DWo(eb,Kb){const fc=[];for(const Hc of this.uo){const Pc=Hc;if(13!==Pc.groupType||24!==Pc.groupType){const ec=eb[pg.a[Pc.groupType].toLowerCase()];let Ld="False";ec<Kb&&(Ld="True");Pc.displayName=Pc.displayName+" ("+Ld+": "+ec+")"}fc.push(Pc)}this.VZb=fc}x$c(eb,Kb=!1,fc=null){if(this.NR.aP().PP){if(!Kb)for(this.UVe=Array(this.uo.length),Kb=0;Kb<this.uo.length;Kb++)this.Sme[Kb]=this.uo[Kb];this.NR.kLi.x$c(this.uo,
this.Sme,this.query,eb,fc)}else{for(fc=new Rh.a;this.uo.length;){Kb=this.uo.pop();const Hc=pg.a[Kb.groupType].toLowerCase(),Pc=eb[Hc];if(Dl.c(Pc))throw Error.create("GroupId "+Hc+" missed from group SortingOrder");fc.add(new ij.a(Pc,Kb))}fc.Sc((Hc,Pc)=>Hc.key<Pc.key?-1:1);for(eb=0;eb<fc.count;eb++)Kb=fc.J(eb).value,this.uo.push(Kb)}}Ixo(){var eb=!1;let Kb=!1,fc=!1;for(let Pc=0;Pc<this.uo.length;Pc++){var Hc=this.uo[Pc];const ec=Hc.groupType;if(8===ec||15===ec||14===ec){Hc=Hc.results;for(let Ld=0;Ld<
Hc.length;Ld++){if(8===ec&&this.xXc(this.query.Cg,Hc[Ld].label)){eb=!0;break}if(15===ec&&this.xXc(this.query.Cg,Hc[Ld].label)){Kb=!0;break}if(14===ec){if(this.xXc(this.query.Cg,Hc[Ld].label)||this.xXc(this.query.Cg,Hc[Ld].description)){fc=!0;break}const De=Hc[Ld].label.split(" ");for(const cf of De)if(this.xXc(this.query.Cg,cf)){fc=!0;break}}}}}eb=this.NR.yam(eb,Kb,fc);this.x$c(eb)}qMb(eb,Kb,fc,Hc,Pc,ec){if(Pc===this.wQ){var Ld=eb.data.se;Pc=null;try{Pc=nh.b(Ld)}catch(ee){r.TellMeActor.instance.Le.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+ee);return}if("RankerResults"in Pc&&Pc.RankerResults){this.vDa();var De=Pc.RankerResults,cf=new Rh.a,nf=new Rh.a;Ld=0;for(var Wb of De){De=Wb.ProviderId;var Ug=Wb.Score;Ld+=Ug;cf.add(new ij.a(De,Ug))}cf.Sc((Rk,wh)=>Rk.value>wh.value?-1:1);Ug=ec?ec.Dfi:1E-6;Wb={};De={};let ee=0;for(var gi=0;gi<cf.count;gi++){let Rk=parseInt(cf.J(gi).key),wh=cf.J(gi).value/Ld;1===Rk&&(De.answer=ee++,De.entity=ee++,De.definition=ee++,De.wolframanswer=
ee++,wh<Ug&&(nf.add(9),nf.add(11),nf.add(10),nf.add(12)),Wb.answer=wh,Wb.entity=wh,Wb.definition=wh,Wb.wolframanswer=wh);2===Rk&&(De.assistance=ee++,wh<Ug&&nf.add(8),Wb.assistance=wh);3===Rk&&(De.classifier=ee++,De.serviceclassifier=ee++,wh<Ug&&(nf.add(0),nf.add(17)),Wb.classifier=wh,Wb.serviceclassifier=wh);4===Rk&&(De.people=ee++,wh<Ug&&nf.add(14),Wb.people=wh);5===Rk&&(De.document=ee++,wh<Ug&&nf.add(15),Wb.document=wh);6===Rk&&(De.findindocument=ee++,wh<Ug&&nf.add(2),Wb.findindocument=wh);7===
Rk&&(De.notes=ee++,wh<Ug&&nf.add(20),Wb.notes=wh);8===Rk&&(De.image=ee++,wh<Ug&&nf.add(19),Wb.image=wh)}cf=new Rh.a;cf.add("classifier");cf.add("serviceclassifier");cf.add("appsforoffice");cf.add("addin");cf.add("findindocument");cf.add("assistance");cf.add("document");cf.add("people");cf.add("answer");cf.add("wolframanswer");cf.add("definition");cf.add("entity");cf.add("image");cf.add("template");cf.add("officescript");for(gi=0;gi<cf.count;gi++)cf.J(gi)in De||(De[cf.J(gi)]=ee++);De.learning=ee++;
De.insights=ee++;De.actionai=ee++;De.actionaicommand=ee++;De.feedback=ee++;ec&&ec.Fyi&&this.DWo(Wb,Ug);ec&&ec.Gyi&&this.ZAl(nf);nf={};for(var rf in Wb)nf[rf]=Wb[rf]*Ld;this.x$c(De,!0,nf)}if(ec.W_d&&"Intents"in Pc&&Pc.Intents){rf=Pc.Intents;for(var Uk of rf)if(this.yHf(Uk)&&"Serplet"===Uk.GroupType&&Uk.ConfidenceScore>Uk.ConfidenceThreshold){rf=!1;Pc=0;if(ec.X_d){Ld=new x.a("",32);for(nf=0;nf<this.uo.length;nf++)if((cf=this.uo[nf].results)&&0<cf.length){Pc=nf;Ld=cf[0];break}2===Ld.groupType&&(rf=!0)}Ld=
new y.a(13);rf&&ec.X_d&&(Ld=new y.a(13,CommonUIStrings.l_TellMeWebTitle));nf=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Cg,null,0);cf=[];Wb=null;Wb=z.a.xpa()?z.a.uOa(this.query.Cg,1):z.a.QCb(this.query.Cg);cf.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Wb));Wb=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Cg);cf.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Wb));appChrome.api.dispatch(cf);
Ld.Rw(nf);nf=[];if(rf&&ec.X_d)for(nf.push(this.uo[Pc]),nf.push(Ld),rf=Pc+1;rf<this.uo.length;rf++)(Pc=this.uo[rf].results)&&0<Pc.length&&nf.push(this.uo[rf]);else for(nf.push(Ld),rf=0;rf<this.uo.length;rf++)(Pc=this.uo[rf].results)&&0<Pc.length&&nf.push(this.uo[rf]);this.VZb=nf}}if(ec.JXc&&!ec.PP){Uk=rf=-1;for(Pc=0;Pc<this.uo.length;Pc++)switch(this.uo[Pc].groupType){case 23:rf=Pc;break;case 0:case 17:case 2:-1===Uk&&(Uk=Pc)}if(-1!==rf){Uk=-1===Uk?0:rf>Uk?Uk+1:Uk;rf=this.uo[rf];Pc=Array(this.uo.length);
Ld=0;for(nf=0;nf<Pc.length;nf++)nf===Uk?Pc[nf]=rf:(23===this.uo[Ld].groupType&&Ld++,Pc[nf]=this.uo[Ld],Ld++);this.VZb=Pc}}Hc.resultsUpdated(this);Hc=r.TellMeActor.instance.Le;Hc.M9(Kb.length,"RankerInference",eb.data.Qe.toString(),Math.round(window.performance.now()-fc),Rl.a.Swj,!0,hn.a.lQa);this.Wcc&&Hc&&(eb=this.query.kob,Kb=Hc.wid,ec.n0d&&eb>Kb&&!ec.PP&&(Hc.hMf(this.query.Cg),Hc.Qbg(eb)))}}yHf(eb){if("GroupType"in eb&&eb.GroupType&&"ConfidenceScore"in eb&&"ConfidenceThreshold"in eb)return!0;r.TellMeActor.instance.Le.onError("IsValidIntentGroup",
"Invalid intents found");return!1}ZLb(eb,Kb,fc,Hc,Pc){Hc===this.wQ&&(this.vDa(),r.TellMeActor.instance.Le.M9(Kb.length,"RankerInference",eb.data.Qe.toString(),Math.round(window.performance.now()-fc),Rl.a.Swj,!1,hn.a.lQa));Pc.resultsUpdated(this)}vDa(){-1!==this.B2&&(window.clearTimeout(this.B2),this.B2=-1)}Jxo(eb){let Kb;Kb=this.NR.aP().PP?r.TellMeActor.instance.Le.Jtf(this.Sme,this.query.Cg):r.TellMeActor.instance.Le.Jtf(this.uo,this.query.Cg);var fc=this.NR.aP().Cfi;""!==fc&&(fc="_"+fc);let Hc=
"";this.NR.aP().b_d&&(Hc="RankerInference"+fc+",");this.NR.aP().W_d&&(Hc+="SerpletClassifier");","===Hc.charAt(Hc.length-1)&&(Hc=Hc.substring(0,Hc.length-1));fc=r.TellMeActor.instance.Le.phi(Hc);const Pc=this.wQ=vl.a.create().toString();fc["Client-Request-Id"]=Pc;const ec=window.performance.now(),Ld=this.NR.aP()?this.NR.aP().Efi:600;this.vDa();this.B2=window.setTimeout(()=>{if(Pc===this.wQ){this.wQ="";this.B2=-1;eb.resultsUpdated(this);const De={};De[a.a.provider]="Ranker";De[a.a.LNb]=this.query.kob;
r.TellMeActor.instance.Le.OA(k.a.timedOut,Ld,De)}},Ld);this.Wf.sj(r.TellMeActor.instance.Le.qhi(),2,Kb,fc,!1,0,De=>{this.qMb(De,this.query.Cg,ec,eb,Pc,this.NR.aP())},De=>{this.ZLb(De,this.query.Cg,ec,Pc,eb)},null,null,!1,4E3,6E3)}HLo(){var eb=0,Kb=new Rh.a,fc=this.NR.cLi,Hc=this.NR.dLi;for(var Pc=0;Pc<this.uo.length;Pc++){var ec=this.uo[Pc],Ld=pg.a[ec.groupType].toLowerCase(),De=fc[Ld];eb+=ec.results.length;ec.results.length>De&&(Ld=Hc[Ld],Dl.c(Ld)||Kb.add(new ij.a(Ld,ec)))}Hc=!this.query||""===this.query.Cg.trim();
Pc=eb-(Hc?this.VNf:this.TNf);if(!(0>=Pc)){Hc=window.performance.now();eb=eb.toString()+" total,"+Pc.toString()+" to remove.";if(0<Kb.count)for(Kb.Sc((cf,nf)=>cf.key>nf.key?-1:1),ec=0;ec<Kb.count&&0<Pc;ec++){Ld=Kb.J(ec).value;De=pg.a[Ld.groupType].toLowerCase();let cf=Ld.results.length-fc[De];cf>Pc&&(cf=Pc);0<cf&&(Ld.X6f(cf),eb+=De+": "+cf.toString()+" results removed.",Pc-=cf)}if(0<Pc){eb+=Pc.toString()+" results left after trimming.";Kb=new Rh.a;fc=this.NR.hLi;for(ec=0;ec<this.uo.length;ec++)Ld=
this.uo[ec],De=fc[pg.a[Ld.groupType].toLowerCase()],Dl.c(De)||Kb.add(new ij.a(De,Ld));Kb.Sc((cf,nf)=>cf.key<nf.key?-1:1);for(fc=0;0<Pc;)ec=Kb.J(fc++).value,Pc>=ec.results.length?(Array.remove(this.uo,ec),eb+=pg.a[ec.groupType]+": "+ec.results.length.toString()+" results force removed.",Pc-=ec.results.length):(ec.X6f(Pc),eb+=pg.a[ec.groupType]+": "+Pc.toString()+" results force removed.",Pc=0)}r.TellMeActor.instance.Le&&(Kb={},Kb[a.a.message]=eb,r.TellMeActor.instance.Le.OA("ShowOptimal",window.performance.now()-
Hc,Kb))}}}Object(l.a)(oe,"CombineResultsUpdatedEventArgs",null,[1097]);class Yg{constructor(eb,Kb,fc,Hc=!1,Pc=""){this.aNe=this.FPe=!1;this.vv=eb;this.pyb=[];this.Kah=Kb.length;this.fc=r.TellMeActor.instance.aP();this.Nod=Hc;this.Vfa=Pc;this.k0b={};for(eb=0;eb<Kb.length;++eb)this.k0b[eb.toString()]=fc?0:Kb[eb].rU()}jko(eb,Kb){Kb&&Kb.query&&Kb.query.kob<r.TellMeActor.instance.Ita||(this.pyb[eb]=Kb,this.aNe?this.FPe=!0:(!this.fc||3!==this.fc.fv||3!==this.k0b[eb.toString()]||this.jRh())&&this.JXd())}yzn(){this.aNe=
!0}CPo(){this.aNe=!1;this.FPe&&(this.FPe=!1,this.JXd())}jRh(){if(this.pyb.length<this.Kah)return!1;for(let eb=0;eb<this.Kah;++eb)if(!this.pyb[eb])return!1;return!0}JXd(){var eb=this.jRh();const Kb=window.performance.now(),fc=new oe(r.TellMeActor.instance.mWg);fc.kYn(this.pyb);for(var Hc=0;Hc<this.pyb.length;++Hc){var Pc=this.pyb[Hc];if(Pc&&Pc.uo&&Pc.uo.length&&(fc.query=Pc.query,Pc.attributes&&0<Pc.attributes.length&&(fc.attributes=Pc.attributes),Pc&&Pc.uo&&(eb||this.iVk(Hc,this.pyb))))for(const ec of Pc.uo)fc.$u(ec)}fc.uo&&
fc.uo.length&&(fc.Wcc=eb,this.fc&&this.fc.Yle&&fc.HLo(),this.fc&&this.fc.uRm&&fc.query.Cg&&0<fc.query.Cg.length?fc.Ixo():fc.Hxo(),this.fc&&(this.fc.b_d||this.fc.W_d)&&this.Nod&&fc.query.Cg&&0<fc.query.Cg.length&&fc.Wcc&&this.Vfa!==f.a.contextMenu?(3===this.fc.fv&&eb||this.vv.resultsUpdated(fc),fc.Jxo(this.vv)):this.vv.resultsUpdated(fc),eb=r.TellMeActor.instance.Le,fc.Wcc&&eb&&(Hc=fc.query.kob,Pc=eb.wid,fc.query.Cg&&0<fc.query.Cg.length&&this.Nod&&this.fc.n0d&&this.Vfa!==f.a.contextMenu&&Hc>Pc&&!this.fc.b_d&&
!this.fc.PP&&(eb.hMf(fc.query.Cg),eb.Qbg(Hc)),eb.OA(k.a.A5n,window.performance.now()-Kb)))}iVk(eb,Kb){if(!(this.k0b&&eb.toString()in this.k0b)||Kb.length<=eb||!Kb[eb])return!1;if(!Kb[eb].uo.length)return!0;const fc=this.k0b[eb.toString()];if(0===fc)return!0;const Hc=this.k0b;for(let ec in Hc){var Pc=Hc[ec];const Ld=Number.parseInvariant(ec);if(Ld!==eb&&Pc===fc&&!(Kb.length>Ld&&Kb[Ld]))return!1}return!0}}Object(l.a)(Yg,"ResultsAggregator",null,[]);var Vh=c(1777);class Tf{constructor(){this.$mc=this.anc=
this.Zmc=this.logCount=this.logRank=this.invertedRank=0}Iqk(eb,Kb){switch(eb){case 1:this.invertedRank=Kb;break;case 3:this.logRank=Kb;break;case 2:this.logCount=Kb;break;case 5:this.Zmc=Kb;break;case 4:this.anc=Kb;break;case 6:this.$mc=Kb}}}Object(l.a)(Tf,"CommandFeatures",null,[]);class Hf{constructor(eb){this.DTg=0;this.FBa=eb;this.xXj={}}get modelId(){return this.FBa}get featureIntercept(){return this.DTg}get nIc(){return this.xXj}Gpk(eb,Kb,fc){0===Kb?this.DTg=fc:(this.nIc[eb]||(this.nIc[eb]=
new Tf),this.nIc[eb].Iqk(Kb,fc))}}Object(l.a)(Hf,"CoefficientsModel",null,[]);const sh=(eb,Kb)=>Math.pow(10,-Kb/(60*Math.LN10/Math.LN2*eb));class sj{constructor(eb,Kb){this.Xj=1;this.okd=new Tf;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=eb?1/eb:0;this.features.logRank=2/Math.pow(2,eb);this.features.Zmc=sh(10,Kb);this.features.anc=sh(2,Kb);this.features.$mc=sh(1,Kb)}get count(){return this.Xj}get features(){return this.okd}ppi(){this.Xj=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}qWo(eb){const Kb=2/Math.pow(2,eb);this.features.invertedRank=Math.max(this.features.invertedRank,eb?1/eb:0);this.features.logRank=Math.max(this.features.logRank,Kb)}QXo(eb){const Kb=sh(10,eb),fc=sh(2,eb);eb=sh(1,eb);this.features.Zmc=Math.max(this.features.Zmc,Kb);this.features.anc=Math.max(this.features.anc,fc);this.features.$mc=Math.max(this.features.$mc,eb)}}Object(l.a)(sj,"CommandModel",null,[]);class Tk{constructor(eb){this.Jrc=null;if(!eb&&r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("PredictionEngine",
"IModelAdapter can't be null");this.LYb=eb;this.Gqd=this.fLf()}fLf(){const eb=this.LYb.O2l(),Kb=this.LYb.hrf();if(void 0===eb||null===eb||void 0===Kb||null===Kb)return!1;try{window.performance.now();this.Jrc={};for(let fc=0;fc<eb.length;fc++){const Hc=eb[fc],Pc=Kb[Hc[0].toString()].trim(),ec=Hc[1],Ld=0!==ec?Kb[Hc[2].toString()].trim():"",De=Hc[3];Pc in this.Jrc||(this.Jrc[Pc]=new Hf(Pc));this.Jrc[Pc].Gpk(Ld,ec,De)}}catch(fc){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("LoadModelData",
"Error Loading Suggestions Model: "+fc);return!1}return!0}NIl(){const eb=this.LYb.h_l(),Kb={};if(!eb)return Kb;let fc=1;for(let Hc=0;Hc<eb.length;Hc++){const Pc=eb[Hc];Pc.Id in Kb?(Kb[Pc.Id].ppi(),Kb[Pc.Id].qWo(fc),Kb[Pc.Id].QXo(Pc.TimeElapsedSinceClick)):Kb[Pc.Id]=new sj(fc,Pc.TimeElapsedSinceClick);fc++}return Kb}YEf(){this.Gqd||(this.Gqd=this.fLf());return this.Gqd}m8l(){let eb=[];if(!this.Gqd){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("GetPredictedCommands","IModelAdapter returned no data");
return eb}const Kb=this.NIl(),fc=this.Jrc;for(let Pc in fc){const ec=fc[Pc],Ld=ec.modelId;let De=0;for(let cf in Kb){var Hc=cf;const nf=Kb[cf].features;(Hc=Hc in ec.nIc?ec.nIc[Hc]:null)&&(De+=nf.invertedRank*Hc.invertedRank+nf.logRank*Hc.logRank+nf.logCount*Hc.logCount+nf.Zmc*Hc.Zmc+nf.anc*Hc.anc+nf.$mc*Hc.$mc)}De+=ec.featureIntercept;eb.push(new dg.a(Ld,De))}eb.sort((Pc,ec)=>Pc.score<ec.score?1:Pc.score>ec.score?-1:0);0<eb.length-10&&(eb=eb.slice(0,10));return eb}}Object(l.a)(Tk,"PredictionEngine",
null,[]);class El{constructor(){this.Ndh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}OPd(eb,
Kb){return Kb&&"word"===Kb.application.toLowerCase()&&eb in this.Ndh?this.Ndh[eb]:[]}}Object(l.a)(El,"SuggestionResultsUtility",null,[]);class $g{constructor(eb,Kb,fc){this.fc=Kb;this.Qyc=new Tk(eb);this.g3=fc;this.Cgh=new El}lL(){return"Suggestion"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:2}ZH(eb,Kb,fc,Hc=f.a.tellMe,Pc=null){fc=new m.a(eb);r.TellMeActor.instance.$cd=!1;if((!Pc||Array.contains(Pc,16))&&z.a.BR(eb)){if(!this.Qyc.YEf()){if(r.TellMeActor.instance.Le)r.TellMeActor.instance.Le.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.Q_d()&&0<this.Cgh.OPd(r.TellMeActor.instance.aJd,this.fc).length){const Ld=this.Cgh.OPd(r.TellMeActor.instance.aJd,this.fc);Pc=[];for(var ec of Ld)this.fc.Hhe&&"Find"===ec||Pc.push(new dg.a(ec,0));r.TellMeActor.instance.$cd=!0}else Pc=this.Qyc.m8l();cd.CommandResultsUtility.m2d(Pc,!0,"Recommended","LRE");ec=[];for(const Ld of Pc)this.g3&&this.g3.d9e(Ld.commandId)||
ec.push(Ld);eb=cd.CommandResultsUtility.WQc(eb,ec,this.fc,null,null,null,16,1);0<eb.results.length&&Hc!==f.a.contextMenu&&(eb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<eb.results.length&&fc.$u(eb)}Kb.resultsUpdated(fc)}Q_d(){return!!this.fc&&(this.fc.Q_d||this.fc.JVm)}}Object(l.a)($g,"SuggestionResultsProvider",null,[1117]);class Ef{h_l(){return r.TellMeActor.instance.yve}O2l(){return window.TellMeSuggestionModel}hrf(){return window.CoefficientModelIdMap}}Object(l.a)(Ef,"SuggestionsModelAdapter",
null,[1146]);var em=c(1791),Di=c(1740);c.d(I,"AggregatorResultsProvider",function(){return Zf});class Zf{constructor(eb=!1){this.KZb={};this.KZb[f.a.tellMe]=[];this.KZb[f.a.contextMenu]=[];this.Nod=eb}vDi(eb,Kb,fc,Hc,Pc=null){let ec;var Ld=!1;switch(Hc){case f.a.contextMenu:ec=this.KZb[f.a.contextMenu];Ld=!0;break;default:ec=this.KZb[f.a.tellMe]}Kb=new Yg(Kb,ec,Ld,this.Nod,Hc);Kb.yzn();for(let De=0;De<ec.length;++De){const cf=window.performance.now(),nf=new H(Kb,De);(Ld=r.TellMeActor.instance.aP())&&
Ld.zKk?window.setTimeout(()=>{ec[De].ZH(eb,nf,fc,Hc,Pc);if(r.TellMeActor.instance.Le){const Wb={};Wb[a.a.provider]=ec[De].lL();Wb[a.a.LNb]=eb.kob;r.TellMeActor.instance.Le.OA(k.a.ZH,window.performance.now()-cf,Wb)}},0):(ec[De].ZH(eb,nf,fc,Hc,Pc),r.TellMeActor.instance.Le&&(Ld={},Ld[a.a.provider]=ec[De].lL(),Ld[a.a.LNb]=eb.kob,r.TellMeActor.instance.Le.OA(k.a.ZH,window.performance.now()-cf,Ld)))}Kb.CPo()}lL(){return"Aggregator"}rU(){return 0}ZH(eb,Kb,fc=!1,Hc=f.a.tellMe,Pc=null){if(r.TellMeActor.instance.Nbn)this.vDi(eb,
Kb,fc,Hc,Pc);else{const ec=window.performance.now();r.TellMeActor.instance.p1o.then(()=>{r.TellMeActor.instance.Le&&r.TellMeActor.instance.Le.OA(k.a.Obn,window.performance.now()-ec);this.vDi(eb,Kb,fc,Hc,Pc);return!0})}}QE(eb,Kb){this.KZb[Kb].push(eb)}xrk(eb){switch(eb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Kb=this.KZb[f.a.tellMe];for(const fc of Kb)if("FindInDocument"===fc.lL()){fc.qio(eb);break}}}static createInstance(eb,Kb,fc,Hc){const Pc=
Kb.Yga;var ec=Hc&&z.a.Ceg(Kb),Ld=ec&&Kb.ZXf&&!Pc;const De=Kb.gHf&&!z.a.qdc()&&!Pc,cf=Kb.lFf&&!Pc,nf=new Zf(ec);if(Kb.Iro&&!Pc){var Wb=new he(Kb);nf.QE(Wb,f.a.tellMe)}Wb=Kb.Er?vm.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):vm.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Ug=!Wb&&vm.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");nf.QE(new ce.a(eb,Kb.ENo,Ug,!1),f.a.tellMe);Wb&&!Pc&&nf.QE(new $g(new Ef,Kb,eb),f.a.tellMe);eb=vm.AFrameworkApplication.ua.Lb.dCi?
new Vj(Kb,new Xg):new Rm(Kb,fc);nf.QE(eb,f.a.contextMenu);(ec&&Kb.$Xf||Ld)&&nf.QE(em.a.EMh(Kb,!0),f.a.tellMe);nf.QE(eb,f.a.tellMe);!Kb.FZh||Pc||"Word"===Kb.application&&Kb.ANd||nf.QE(new Jd(Kb),f.a.tellMe);Kb.IAb&&!Pc&&(Ld=new L(Kb),nf.QE(Ld,f.a.tellMe),nf.QE(Ld,f.a.contextMenu));!Kb.NAb||Kb.B9c||Kb.A9c||Pc||nf.QE(new J.a(Kb),f.a.tellMe);Hc&&(Kb.u0||z.a.xpa())&&(Ld=new xd(Kb),nf.QE(Ld,f.a.tellMe),nf.QE(Ld,f.a.contextMenu));ec&&nf.QE(em.a.EMh(Kb,!1),f.a.tellMe);Hc&&!Kb.Fig&&z.a.Beg(Kb)&&!Pc&&(nf.QE(new Vh.a(Kb),
f.a.tellMe),Kb.gvj&&nf.QE(new Vh.a(Kb),f.a.contextMenu));De&&nf.QE(new md(Kb),f.a.tellMe);!Kb.dlc&&!Kb.PP||Pc||nf.QE(new tg.a(Kb),f.a.tellMe);Kb.JXc&&!Pc&&nf.QE(new Di.a(Kb),f.a.tellMe);Kb.UBf&&(ec=new G(Kb),nf.QE(ec,f.a.tellMe),nf.QE(ec,f.a.contextMenu));Hc&&Kb.YXd&&!Pc&&nf.QE(new F.AddinResultsProvider(Kb),f.a.tellMe);cf&&"Excel"===Kb.application&&!Pc&&nf.QE(new sf(Kb),f.a.tellMe);return nf}}Object(l.a)(Zf,"AggregatorResultsProvider",null,[1117])},1770:function(D,I,c){D=c(0);var l=c(16),f=c(6),
a=c(179),k=c(224),x=c(365);c(60);var y=c(69);c(949);c(870);var m=c(538);c(468);var r=c(1730),z=c(1731),v=c(1727),G=c(1729),F=c(1728);c(948);c(869);class H{constructor(Z,ea,ha){this.gIl=Z;this.SHk=ea;this.iTk=ha}}Object(D.a)(H,"BacktraceAndMakeUpdateHintsInput",null,[]);var L=c(1553),J;(function(Z){Z[Z.EOP=0]="EOP";Z[Z.character=1]="character";Z[Z.embeddedMarker=2]="embeddedMarker"})(J||(J={}));Object(D.b)("LCSBlockType",J);class M{toString(){return String.format("[Type: {0}]",J[this.type])}}Object(D.a)(M,
"ALCSBlock",null,[]);class P extends M{constructor(Z,ea){super();this.Iue=ea;this.LMe=Z}get type(){return 1}get character(){return this.Iue}get DSa(){return this.LMe}IA(Z){return 1===Z.type&&L.a.Qth(Z.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(D.a)(P,"CharacterLCSBlock",M,[]);class N extends M{constructor(Z,ea,ha){super();this.LMe=Z;this.nXe=ea;this.Uxc=ha}get type(){return 0}get Wc(){return this.nXe}get length(){return this.Uxc}get DSa(){return this.LMe}IA(Z){return 0!==
Z.type?!1:Z.DSa===this.DSa&&Z.Wc===this.Wc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.DSa.toString(),this.Wc,this.length)}}Object(D.a)(N,"EOPLCSBlock",M,[]);class K extends P{constructor(Z,ea,ha){super(Z,"\ufffc");this.N9j=ea;this.dld=ha}get type(){return 2}get Mf(){return this.N9j}get Tj(){return this.dld}IA(Z){return 2!==Z.type?!1:Z.Mf===this.Mf&&this.Tj.equals(Z.Tj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.Mf,this.Tj)}}Object(D.a)(K,"EmbeddedMarkerLCSBlock",P,[]);class O{constructor(Z,ea){this.x=Z;this.y=ea}equals(Z){return Z.x===this.x&&Z.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(O,"IntPair",null,[896]);var V=c(1596),W=c(1575),T=c(1597),Y=c(1726);c.d(I,"a",function(){return ba});class ba{constructor(Z,ea){this.Og=Z;this.Yd=ea}PMh(Z,ea,ha,la,ia,sa,Oa){return this.Fdl(Z,ea,ha,la,ia,sa,Oa)}Fdl(Z,ea,ha,la,ia,sa,Oa){let Ra;Ra=null;({returnValue:Z}=this.DRd(Z,ea));if(!Z)return a.a.instance.Ua(575706449,
1,2,"Failed to get LCS blocks from objects for base"),this.Yd.logger.OU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Ra};({returnValue:ha}=this.DRd(ha,la));if(!ha)return a.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Yd.logger.OU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Ra};this.Yd.logger.OU("GetLCSBlocksFromObject");Ra=this.Edl(Z,ha,ia,sa,Oa);return Ra?{returnValue:!0,updateHints:Ra}:(a.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),
{returnValue:!1,updateHints:Ra})}uZh(Z,ea,ha,la){({returnValue:Z}=this.DRd(Z,ea));if(!Z)return-1;({returnValue:ha}=this.DRd(ha,la));if(!ha)return-1;({lcf:ha}=this.yZh(Z,ha));return ha}DRd(Z,ea){let ha;const la=new k.a;ha=new k.a;if(!Z.length)return a.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Yd.logger.Pg(Object.assign(new V.a,{uj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,Qhf:ha};for(let Oa=0;Oa<Z.length;Oa++)if(this.Yd.runtime.YG("GetLCSBlocksFromObject: paraObjs#"+
Oa),393230===Z.J(Oa).Nc){const Ra=this.Og.getPropertyString(Z.J(Oa),l.a.vo),Na=this.Og.getPropertyUint32(Z.J(Oa),f.a.Wc);if(null==Na)return a.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Yd.logger.Pg(Object.assign(new V.a,{uj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,Qhf:ha};let Da=this.Og.getPropertyUint32s(Z.J(Oa),l.a.Dm);Da=W.a.wlj(Da,Ra.length);const ra=this.Og.getPropertyObjectIds(Z.J(Oa),l.a.Ln);let xa;for(xa=0;xa<Da.length-1;xa++){var ia=ea(ra.Zf(xa)),
sa=void 0;sa=ia?(sa=this.Og.getPropertyBool(ia,l.a.N$))?sa:!1:!1;if(sa)la.add(this.d9k(Z.J(Oa).id,ia));else for(ia=Da.Zf(xa);ia<Da.Zf(xa+1);ia++)la.add(new P(Z.J(Oa).id,L.a.charAt(Ra,ia)))}la.add(new N(Z.J(Oa).id,Na,Da.J(xa)));ha.add(la.length-1)}else return a.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",Z.J(Oa).Nc),this.Yd.logger.Pg(Object.assign(new V.a,{uj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,Qhf:ha};this.Yd.runtime.YG("LCS: GetLCSBlocks for base");
return{returnValue:la,Qhf:ha}}d9k(Z,ea){const ha=null==this.Og.getPropertyInt32(ea,f.a.Is)?0:this.Og.getPropertyInt32(ea,f.a.Is);return new K(Z,ha,ea.id)}Edl(Z,ea,ha,la,ia){la=({lcf:ha}=this.yZh(Z,ea,ha,la,ia)).returnValue;this.Yd.logger.OU("FindFurthestPaths");Z=new H(la,Z,ea);Z=new Y.a(this.HHk(Z,ha),1);this.Yd.logger.OU("BacktraceAndMakeUpdateHints");return Z}yZh(Z,ea,ha=-1,la=-1,ia=-1){let sa;if(-1===ha||-1===la||-1===ia)ia=la=ha=-1;sa=-1;const Oa=new x.a;Oa.Z(new O(-1,1),new O(0,-1));if(-1!==
ha){Oa.Z(new O(0,0),new O(ha,ha));var Ra=1}else Ra=0,la=Z.length,ia=ea.length;for(ha=0;Ra<=Z.length+ea.length;Ra++){let Na=!1;for(let Da=-Ra;Da<=Ra;Da+=2){let ra,xa;Da===-Ra?(ra=Oa.J(new O(Ra-1,Da+1)).x,xa=Oa.J(new O(Ra-1,Da+1)).y+1):Da===Ra?(ra=Oa.J(new O(Ra-1,Da-1)).x+1,xa=Oa.J(new O(Ra-1,Da-1)).y):Oa.J(new O(Ra-1,Da-1)).x>=Oa.J(new O(Ra-1,Da+1)).x?(ra=Oa.J(new O(Ra-1,Da-1)).x+1,xa=Oa.J(new O(Ra-1,Da-1)).y):(ra=Oa.J(new O(Ra-1,Da+1)).x,xa=Oa.J(new O(Ra-1,Da+1)).y+1);for(;ra<la&&xa<ia&&Z.J(ra).IA(ea.J(xa));)ra++,
xa++;Oa.Z(new O(Ra,Da),new O(ra,xa));if(ra===la&&xa===ia){Na=!0;sa=Ra;ha=Da;break}}if(Na)break;this.Yd.runtime.YG("LCS FindFurthestPaths")}if(ha!==la-ia)return{returnValue:null,lcf:sa};Oa.Z(new O(sa,ha),new O(la+1,ia+1));a.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",Z.length,ea.length,sa);return{returnValue:Oa,lcf:sa}}HHk(Z,ea){const ha=Z.gIl,la=Z.SHk;Z=Z.iTk;const ia=new k.a;let sa=la.length,Oa=Z.length;for(;0<sa||0<Oa;){var Ra=
sa-1,Na=Oa-1;if(this.xzn(ha,ea,sa,Oa)){Ra=Z.J(Na);if(1===Ra.type||2===Ra.type)this.LCm(ia,sa,Ra);else if(0===Ra.type)this.iCm(ia,sa,Ra);else return a.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Ra.type),this.Yd.logger.Pg(Object.assign(new T.a,{uj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Oa--;ea--}else if(this.wzn(ha,ea,sa,Oa)){Na=la.J(Ra);if(1===Na.type||2===Na.type)this.pjl(ia,Ra,Na);else if(0===Na.type)this.Vil(ia,Ra,Na);else return a.a.instance.Ua(575706453,
1,2,"Abandoning LCS due to unexpected block of type {0}",Na.type),this.Yd.logger.Pg(Object.assign(new T.a,{uj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;sa--;ea--}else if(sa&&Oa&&la.J(Ra).IA(Z.J(Na)))sa--,Oa--;else return a.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Yd.logger.Pg(Object.assign(new T.a,{uj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Yd.runtime.YG("LCS: CreateUpdateHintsFromLCSBlocks");return ia}wzn(Z,ea,ha,la){ea=
new O(ea-1,ha-la-1);return Z.nb(ea)&&Z.J(ea).x===ha-1&&Z.J(ea).y===la}xzn(Z,ea,ha,la){ea=new O(ea-1,ha-la+1);return Z.nb(ea)&&Z.J(ea).x===ha&&Z.J(ea).y===la-1}iCm(Z,ea,ha){ha=new v.a(ha.DSa,ha.Wc);let la=!1;if(0<Z.length&&11===Z.Zf(Z.length-1).type){const ia=Z.Zf(Z.length-1);ia.cp===ea&&(la=!0,ia.p0.add(ha))}la||(ea=new F.a(ea),ea.p0.add(ha),Z.add(ea))}LCm(Z,ea,ha){var la=!1;if(0<Z.length&&11===Z.Zf(Z.length-1).type){const ia=Z.Zf(Z.length-1);ia.cp===ea&&((la=Object(y.a)(G.a,ia.p0.J(ia.p0.length-
1)))?la.text=ha.character.toString()+la.text:ia.p0.add(new G.a(ha.DSa,ha.character.toString())),la=!0)}la||(ea=new F.a(ea),ea.p0.add(new G.a(ha.DSa,ha.character.toString())),Z.add(ea))}Vil(Z,ea,ha){ea=new r.a(ea,ha.DSa,ha.Wc);Z.add(ea)}OKc(Z,ea){let ha=!1;if(0<Z.updateHints.length&&2===Z.updateHints.Zf(Z.updateHints.length-1).type){const la=Z.updateHints.Zf(Z.updateHints.length-1);la.yg.equals(ea.DSa)&&la.cp===ea.e9d&&(la.cp=ea.e9d-1,la.text=(void 0).character.toString()+la.text,ha=!0)}ha||Z.updateHints.add(new m.DeleteTextUpdateHint(ea.DSa,
ea.e9d-1,(void 0).character.toString()));--ea.e9d}pjl(Z,ea,ha){let la=!1;if(0<Z.length&&8===Z.Zf(Z.length-1).type){const ia=Z.Zf(Z.length-1);ia.cp===ea+1&&(ia.text=ha.character.toString()+ia.text,--ia.cp,la=!0)}la||Z.add(new z.a(ea,ha.character.toString()))}}Object(D.a)(ba,"LCSUpdateHintGenerator",null,[])},1776:function(D,I,c){c.r(I);D=c(0);var l=c(16),f=c(6),a=c(179),k=c(365),x=c(608),y=c(224),m=c(60),r=c(54),z=c(1541);class v extends z.a{constructor(){super()}get fha(){return"ChildNodeListMerge"}}
Object(D.a)(v,"ChildNodeListMergeFailureDetail",z.a,[]);class G{drb(ba,Z,ea){return Z.Cz(ba,ea.J(ba))}NAj(ba,Z,ea,ha){let la;return({value:la}=Z.Fc(ba)).returnValue||({value:la}=ea.Fc(ba)).returnValue?la:ha.J(ba)}}Object(D.a)(G,"ChildNodeListMergeUtils",null,[1813]);var F=c(1568),H=c(1790),L=c(1643);class J{constructor(ba,Z){this.classId=ba;this.fOo=Z}}Object(D.a)(J,"NodeChildrenTransformation",null,[]);var M=c(811),P=c(1559);class N{constructor(ba,Z,ea){this.VE=ba;this.Lra=ea;this.H8=Z}cae(ba){let Z,
ea;return({w3i:Z}=this.SAj(this.Lra,ba)).returnValue&&Z.tY||({w3i:ea}=this.SAj(this.H8,ba)).returnValue&&ea.tY}SAj(ba,Z){let ea;return{returnValue:({value:ea}=(new P.a(this.VE,ba)).Gqa.Fc(M.a.Ab(Z))).returnValue,w3i:ea}}}Object(D.a)(N,"NodeTriplet",null,[]);var K=c(1725);class O{constructor(ba,Z,ea){this.Yd=ba;this.Og=Z;this.C7=ea;this.xgh=!0}get pq(){return this.Yd}get Vd(){return this.Og}get dAa(){return this.C7}get success(){return this.xgh}u7l(){a.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");
const ba=new k.a;this.A4e(ba,Z=>this.pq.runtime.sk.J(Z));this.A4e(ba,Z=>this.dAa.drb(Z,this.pq.runtime.Ku,this.pq.runtime.sk));this.A4e(ba,Z=>this.dAa.drb(Z,this.pq.runtime.Kq,this.pq.runtime.sk));return ba}A4e(ba,Z){const ea=Z(c(1776).ChildNodeListMerge.R8d);this.Vd.getPropertyObjectIds(ea,l.a.$e).forEach(ha=>{this.Vd.getPropertyObjectIds(Z(ha),l.a.$e).forEach(la=>{ba.nb(la)&&!ha.equals(ba.J(la))&&(this.xgh=!1,a.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
la,ha,ba.J(la)));ba.Z(la,ha);return!0});return!0})}}Object(D.a)(O,"OutlineGroupParentFinder",null,[]);var V=c(1542),W=c(1598),T=c(1644);c.d(I,"ChildNodeListMerge",function(){return Y});class Y{constructor(ba,Z=null,ea=null,ha=null,la=null){this.Og=ba;this.Lxn=Z||H.a.mBj;this.d5d=ea||this.r4l();this.dAa=ha||new G;this.dNi=la||this.r2l()}get Vd(){return this.Og}r4l(){return[new J(393227,Object(r.a)(this,this.swn,"pageContentNodeThreewayChildMerge")),new J(1073872968,Object(r.a)(this,this.o5o,"wordSectionNodeThreewayChildMerge")),
new J(393241,Object(r.a)(this,this.H8d,"outlineElementContainerThreewayChildMerge")),new J(393252,Object(r.a)(this,this.tEo,"tableCellThreewayChildMergev2")),new J(1074135125,Object(r.a)(this,this.H8d,"outlineElementContainerThreewayChildMerge")),new J(1074135123,Object(r.a)(this,this.H8d,"outlineElementContainerThreewayChildMerge")),new J(1074135127,Object(r.a)(this,this.H8d,"outlineElementContainerThreewayChildMerge"))]}r2l(){return[Object(r.a)(this,this.$Dn,"prepareObjectGroupings"),Object(r.a)(this,
this.anm,"handleInterOutlineGroupMerge"),Object(r.a)(this,this.aAn,"performThreewayChildMerge")]}T$m(ba){let Z=0;for(;Z<this.dNi.length;Z++)if(!(0,this.dNi[Z])(ba))return a.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",Z),ba.logger.y2d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",Z),!1;return!0}$Dn(ba){const Z=new k.a,ea=new k.a,ha=new x.a;ba.runtime.Ku.forEach((la,ia)=>Y.m_i(ia,Z));ba.runtime.Kq.forEach((la,ia)=>Y.m_i(ia,ea));for(let la=0;la<this.d5d.length;la++){const ia=
this.d5d[la].classId;ba.runtime.Hmb.Z(ia,new k.a);Z.nb(ia)&&Z.J(ia).forEach(sa=>{var Oa=ba.runtime.sk.J(sa.id);Oa&&(Oa=new N(Oa,sa,ba.runtime.Kq.Cz(sa.id,Oa)),ba.runtime.Hmb.J(ia).add(sa.id,Oa),ha.add(sa.id));return!0});ea.nb(ia)&&ea.J(ia).forEach(sa=>{if(ha.contains(sa.id))return!0;const Oa=ba.runtime.sk.J(sa.id);Oa&&ba.runtime.Hmb.J(ia).add(sa.id,new N(Oa,Oa,sa));return!0})}ba.runtime.YG("PrepareObjectGroupings");ba.logger.Aia("PrepareObjectGroupings");return!0}aAn(ba){let Z=!0;for(let ea=0;Z&&
ea<this.d5d.length;ea++){const ha=this.d5d[ea];ba.runtime.YG("Before function#"+ea);const la=ha.classId;ba.runtime.Hmb.J(la).forEach((ia,sa)=>{ba.runtime.WNa.contains(sa.VE.id)||(Z=ha.fOo(ba,sa)&&Z);Z||(a.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",la,sa.VE.id),ba.logger.Pg(Object.assign(new v,{uj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return Z});ba.runtime.YG("PerformThreewayChildMerge"+ea)}ba.logger.Aia("PerformThreewayChildMerge");
return Z}swn(ba,Z){if(Z.cae(l.a.$e)){var ea=this.Vd.getPropertyObjectIds(Z.VE,l.a.$e);const ha=this.Vd.getPropertyObjectIds(Z.H8,l.a.$e);Z=this.Vd.getPropertyObjectIds(Z.Lra,l.a.$e);ea=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ea.length,ha.length,Z.length,ba.input.source);a.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ea);ba.logger.Pg(Object.assign(new v,{uj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:ea}));return!1}return!0}o5o(ba,Z){if(Z.cae(l.a.$e)){const Ra=new x.a,Na=new x.a,Da=new x.a,ra=new x.a;var ea=this.Vd.getPropertyObjectIds(Z.VE,l.a.$e),ha=ea.ZG(),la,ia=({lJh:la}=this.mIj(Z.H8,ha,Ra,"Favored")).returnValue,sa=({lJh:Oa}=this.mIj(Z.Lra,ha,Na,"Unfavored")).returnValue;if(!ia||!sa)return ea=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
ha.count,Ra.count,Na.count,la,Oa),ba.logger.Pg(Object.assign(new v,{uj:"WordSectionNodeThreewayChildMerge",info:ea})),!1;ea.forEach(xa=>{Ra.contains(xa)||Da.add(xa);Na.contains(xa)||ra.add(xa);return!0});Z=Z.VE.UK();ha=new y.a;for(la=0;la<ea.length;la++){var Oa=ea.Zf(la);if(Da.contains(Oa)||ra.contains(Oa)){if(ba.runtime.WNa.add(Oa),ha.length&&(ia=ha.Zf(ha.length-1),ia=ba.runtime.Hmb.J(393241).J(ia),sa=ba.runtime.Hmb.J(393241).J(Oa),ia&&sa))Da.contains(Oa)?ra.contains(Oa)||(ia.VE=ia.VE.UK(),ia.Lra=
ia.Lra.UK(),this.cCd(ia.VE,sa.VE),this.cCd(ia.Lra,sa.Lra)):(ia.VE=ia.VE.UK(),ia.H8=ia.H8.UK(),this.cCd(ia.VE,sa.VE),this.cCd(ia.H8,sa.H8))}else ha.add(Oa)}this.Vd.setPropertyObjectIds(Z,l.a.$e,ha);ea=new V.a(Z);ea.zC(l.a.$e);ba.runtime.qn.Z(Z.id,ea)}return!0}cCd(ba,Z){const ea=this.Vd.getPropertyObjectIds(ba,l.a.$e);Z=this.Vd.getPropertyObjectIds(Z,l.a.$e);const ha=ea.I5();Z.forEach(la=>{ha.add(la);return!0});this.Vd.setPropertyObjectIds(ba,l.a.$e,ha)}mIj(ba,Z,ea,ha){let la=0,ia=!0;this.Vd.getPropertyObjectIds(ba,
l.a.$e).forEach(sa=>{Z.contains(sa)?ea.add(sa):(ia=!1,a.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ha,sa),la++);return!0});return{returnValue:ia,lJh:la}}anm(ba){let Z=!0;ba.runtime.Hmb.J(393241).forEach((ea,ha)=>{if(this.LMm(ha)){a.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ha.VE.id);let la;const ia=new O(ba,this.Vd,this.dAa);if(({FYi:ea,ZJj:la}=this.yMo(ba,ia.u7l(),ha)).returnValue)return a.a.instance.Ua(4220303,1,4,
"Merging WordSection {0} as a unit.",la),Z=ia.success&&this.Lan(ba,la,ea)&&Z,Z||(a.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",ha.VE.id,ia.success),ba.logger.Pg(Object.assign(new v,{uj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ia.success)}))),Z}return!0});return Z}LMm(ba){if(!ba.cae(l.a.$e))return!1;const Z=this.Vd.getPropertyObjectIds(ba.VE,l.a.$e).J(0),
ea=this.Vd.getPropertyObjectIds(ba.H8,l.a.$e);ba=this.Vd.getPropertyObjectIds(ba.Lra,l.a.$e);return!ea.contains(Z,(ha,la)=>ha.equals(la))||!ba.contains(Z,(ha,la)=>ha.equals(la))}yMo(ba,Z,ea){Z=Z.J(ea.VE.id);a.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ea.VE.id,Z);if(ba.runtime.WNa.contains(Z))return a.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
Z),{returnValue:!1,FYi:null,ZJj:Z};const ha=new K.a;ea=ba.runtime.sk.J(Z);this.Vd.getPropertyObjectIds(ea,l.a.$e).forEach(la=>{ha.bCd(la);return!0});ea=this.dAa.drb(Z,ba.runtime.Ku,ba.runtime.sk);this.Vd.getPropertyObjectIds(ea,l.a.$e).forEach(la=>{ha.dCd(la);return!0});ba=this.dAa.drb(Z,ba.runtime.Kq,ba.runtime.sk);this.Vd.getPropertyObjectIds(ba,l.a.$e).forEach(la=>{ha.hCd(la);return!0});return{returnValue:!0,FYi:ha,ZJj:Z}}W0f(ba,Z,ea,ha,la){let ia=!0;ba.forEach(sa=>{const Oa=Z(sa);this.Vd.getPropertyObjectIds(Oa,
l.a.$e).forEach(Ra=>{ea.add(Ra);if(ha.nb(Ra))return(ia=ha.J(Ra).equals(sa)&&ia)||a.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",la,Ra,sa,ha.J(Ra)),ia;ha.Z(Ra,sa);return!0});return!0});return ia}H5l(ba,Z){let ea,ha,la,ia;ea=new y.a;ha=new y.a;la=new y.a;ia=new k.a;const sa=ba.runtime.sk;return this.W0f(Z.QAb,Oa=>sa.J(Oa),ea,ia,"Base")&&this.W0f(Z.Xif,Oa=>this.dAa.drb(Oa,ba.runtime.Ku,sa),ha,ia,"Favored")&&
this.W0f(Z.grb,Oa=>this.dAa.drb(Oa,ba.runtime.Kq,sa),la,ia,"Unfavored")?{returnValue:!0,rvh:ea,oYh:ha,jCj:la,jRi:ia}:{returnValue:!1,rvh:ea,oYh:ha,jCj:la,jRi:ia}}mDl(ba,Z,ea,ha){let la=!0;const ia=ba.runtime.sk,sa=ba.runtime.Ku,Oa=ba.runtime.Kq,Ra=ba.runtime.qn,Na=new y.a,Da=new k.a;ea.forEach(ra=>{const xa=ha.J(ra);if(!xa)return a.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ra),ba.logger.Pg(Object.assign(new v,{uj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),la=!1;xa.equals(Na.last())||(Na.add(xa),Da.add(xa,new y.a));Da.J(xa).add(ra);ba.runtime.WNa.add(ra);return!0});if(!la)return!1;Da.forEach((ra,xa)=>{const fa=this.dAa.NAj(ra,sa,Oa,ia).UK();this.Vd.setPropertyObjectIds(fa,l.a.$e,xa);Ra.Z(ra,new V.a(fa));Ra.J(ra).zC(l.a.$e);ba.runtime.WNa.add(ra);return la});ea=this.dAa.NAj(Z,sa,Oa,ia).UK();this.Vd.setPropertyObjectIds(ea,l.a.$e,Na);Ra.Z(Z,new V.a(ea));Ra.J(Z).zC(l.a.$e);ba.runtime.WNa.add(Z);return la}Lan(ba,Z,ea){let ha,la;if(!({rvh:ia,
oYh:ha,jCj:la,jRi:ea}=this.H5l(ba,ea)).returnValue)return!1;var ia=F.b(ia,ha,la);ia=this.vYf(ba,ia);return!!ia&&this.mDl(ba,Z,ia,ea)}H8d(ba,Z){return this.AYi(ba,Z)}AYi(ba,Z){if(Z.cae(l.a.$e)){var ea=this.D5l(Z);ea=this.vYf(ba,ea);if(!ea)return a.a.instance.Ua(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Z.VE.id),ba.logger.Pg(Object.assign(new v,{uj:"OutlineElementContainerThreewayChildMerge",
eventId:"aqgwu"})),L.a(Z.VE,"OutlineElementContainerThreewayChildMerge_Base",1),L.a(Z.H8,"OutlineElementContainerThreewayChildMerge_Favored",1),L.a(Z.Lra,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ha=this.Vd.getPropertyObjectIds(Z.VE,l.a.$e);const la=ea.ZG();ha.forEach(ia=>{la.contains(ia)||(ia=this.Vd.getPropertyObjectIds(Z.VE,l.a.XK),0<ia.length&&ba.runtime.iZf.add(ia.J(0)));return!0});ha=Z.H8.UK();this.Vd.setPropertyObjectIds(ha,l.a.$e,ea);ba.runtime.qn.Z(ha.id,new V.a(ha));
ba.runtime.qn.J(ha.id).zC(l.a.$e)}return!0}EJb(ba){if(!ba)return a.a.instance.Ua(573957964,1,2,"Feature helper is null"),!1;ba.Tx(107);return ba.isFeatureEnabled(107)}tEo(ba,Z){if(!this.EJb(ba.runtime.Zb))return this.ujg(ba,Z);var ea=Z.VE.id,ha=T.e(ba,Z.VE,null);if(ha.equals(m.a.nil))return a.a.instance.Ua(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ea),ba.logger.Pg(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),!1;var la=ba.runtime.cCb.J(ha);
if(la&&(la=la.J(ea)))if(la.fg)Z=Z.H8.UK(),Z.removeProperty(l.a.$e),this.Vd.setPropertyBool(Z,f.a.ghostCell,!0),null!=la.colSpan?this.Vd.setPropertyUint32(Z,f.a.colSpan,la.colSpan):Z.removeProperty(f.a.colSpan),ba.runtime.qn.Z(Z.id,new V.a(Z)),ba.runtime.qn.J(Z.id).zC(l.a.$e),ba.runtime.qn.J(Z.id).zC(f.a.ghostCell),ba.runtime.qn.J(Z.id).zC(f.a.colSpan);else{let ia,sa;({WCd:ha,bNd:ia,Mme:sa}=this.q1l(ba,Z,la,ha));if(!ia.length&&!sa.length)return a.a.instance.Ua(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",
ea),ba.logger.Pg(Object.assign(new W.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ia.length?sa.length?(ea=F.b(ha,ia,sa),ea=this.vYf(ba,ea)):ea=ia:ea=sa;if(!ea)return a.a.instance.Ua(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Z.VE.id),ba.logger.Pg(Object.assign(new v,{uj:"TableCellThreewayChildMergev2",eventId:"8n426"})),L.a(Z.VE,"TableCellThreewayChildMergev2_Base",
1),L.a(Z.H8,"TableCellThreewayChildMergev2_Favored",1),L.a(Z.Lra,"TableCellThreewayChildMergev2_Unfavored",1),!1;Z=Z.H8.UK();this.Vd.setPropertyObjectIds(Z,l.a.$e,ea);Z.removeProperty(f.a.ghostCell);ea=la.rowSpan;la=la.colSpan;null!=ea&&null!=la&&(1<ea||1<la)?(this.Vd.setPropertyUint32(Z,f.a.rowSpan,ea),this.Vd.setPropertyUint32(Z,f.a.colSpan,la)):(Z.removeProperty(f.a.rowSpan),Z.removeProperty(f.a.colSpan));ba.runtime.qn.Z(Z.id,new V.a(Z));ba.runtime.qn.J(Z.id).zC(l.a.$e);ba.runtime.qn.J(Z.id).zC(f.a.ghostCell);
ba.runtime.qn.J(Z.id).zC(f.a.rowSpan);ba.runtime.qn.J(Z.id).zC(f.a.colSpan)}else return this.ujg(ba,Z);ba.logger.Aia("TableCellThreewayChildMergev2");return!0}q1l(ba,Z,ea,ha){let la,ia;({WCd:Z,bNd:la,Mme:ia}=this.K7h(Z));Z||(Z=new y.a);la||(la=new y.a);ia||(ia=new y.a);var sa=Z.ZG(),Oa=la.ZG(),Ra=ia.ZG(),Na=ea.E5d;if(Na)for(var Da=0;Da<Na.length;Da++){var ra=Na.J(Da),xa=ba.runtime.sk.J(ra);!sa.contains(ra)&&xa&&(sa.add(ra),Z.add(ra));!Oa.contains(ra)&&ba.runtime.Ku.Cz(ra,xa)&&(Oa.add(ra),la.add(ra));
!Ra.contains(ra)&&ba.runtime.Kq.Cz(ra,xa)&&(Ra.add(ra),ia.add(ra))}ba.logger.Aia("OENodesAddedToChildrenList");if(Na=ea.mvf)for(Da=0;Da<Na.length;Da++)if(ra=Na.J(Da),xa=ba.runtime.sk.J(ra)){var fa=this.Vd.getPropertyObjectIds(xa,l.a.$e);if(fa)for(var oa=0;oa<fa.length;oa++){var ta=fa.J(oa);sa.contains(ta)||(sa.add(ta),Z.add(ta))}fa=ba.runtime.Ku.Cz(ra,xa);if(fa=this.Vd.getPropertyObjectIds(fa,l.a.$e))for(oa=0;oa<fa.length;oa++)ta=fa.J(oa),Oa.contains(ta)||(Oa.add(ta),la.add(ta));ra=ba.runtime.Kq.Cz(ra,
xa);if(ra=this.Vd.getPropertyObjectIds(ra,l.a.$e))for(xa=0;xa<ra.length;xa++)fa=ra.J(xa),Ra.contains(fa)||(Ra.add(fa),ia.add(fa))}ba.logger.Aia("GhostCellOENodesAddedToChildrenList");if(ea=ea.xSf)for(sa=0;sa<ea.length;sa++)if(Oa=ea.J(sa),Oa=ba.runtime.cCb.J(ha).J(Oa))if(Oa=Oa.E5d){Oa=Oa.ZG();Ra=new y.a;for(Na=0;Na<Z.length;Na++)Oa.contains(Z.J(Na))||Ra.add(Z.J(Na));Z=Ra;Ra=new y.a;for(Na=0;Na<la.length;Na++)Oa.contains(la.J(Na))||Ra.add(la.J(Na));la=Ra;Ra=new y.a;for(Na=0;Na<ia.length;Na++)Oa.contains(ia.J(Na))||
Ra.add(ia.J(Na));ia=Ra}ba.logger.Aia("NonGhostCellsOENodesRemovedFromChildrenList");return{WCd:Z,bNd:la,Mme:ia}}ujg(ba,Z){let ea=Z.H8.hasProperty(l.a.$e),ha=Z.Lra.hasProperty(l.a.$e);ea&&(ea=!!this.Vd.getPropertyObjectIds(Z.H8,l.a.$e).length);ha&&(ha=!!this.Vd.getPropertyObjectIds(Z.Lra,l.a.$e).length);if(ea!==ha)if(this.sTm(ba.runtime.Zb))ba.logger.BIi(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return ba.logger.Pg(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),
!1;return this.AYi(ba,Z)}D5l(ba){let Z,ea;({WCd:ba,bNd:Z,Mme:ea}=this.K7h(ba));return F.b(ba,Z,ea)}vYf(ba,Z){a.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",Z.length);const ea=new y.a;let ha=!0;Z.forEach(la=>{if(!la)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),ba.logger.Pg(Object.assign(new v,{uj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ha=!1;if(1===la.Abn&&1===la.lmb){const fa=la.QAb.J(0),oa=la.Xif.J(0),ta=la.grb.J(0);
if(fa&&fa.equals(oa)&&fa.equals(ta))return ea.add(fa),!0;if(1!==Z.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",fa,oa,ta,Z.length),ba.logger.Pg(Object.assign(new v,{uj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ha=!1}const ia=new k.a,sa=new y.a,Oa=new y.a,Ra=new y.a,Na=new y.a,Da=new y.a,ra=
new y.a,xa=ba.runtime.sk;la.QAb.forEach(fa=>ha=this.S1f(ba,fa,oa=>xa.J(oa),sa,Na,ia,"Base"));if(!ha)return a.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ba.logger.Pg(Object.assign(new v,{uj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;la.Xif.forEach(fa=>ha=this.S1f(ba,fa,oa=>this.dAa.drb(oa,ba.runtime.Ku,xa),Oa,Da,ia,"Favored"));if(!ha)return a.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
ba.logger.Pg(Object.assign(new v,{uj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;la.grb.forEach(fa=>ha=this.S1f(ba,fa,oa=>this.dAa.drb(oa,ba.runtime.Kq,xa),Ra,ra,ia,"Unfavored"));if(!ha)return a.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),ba.logger.Pg(Object.assign(new v,{uj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ba.runtime.Zb&&ba.runtime.Zb.gjb(1000005)&&(Da.length&&this.izl(Da,
ba.runtime.Ku)?(this.Coh(Da,ba,ea,ia),this.aBd(ba,ia,ra)):this.Coh(ra,ba,ea,ia));if(sa.length){la=null;if(!({qn:la}=this.Lxn(ba,sa,Oa,Ra,la)).returnValue||!la)return ha=!1;la.forEach(fa=>{0<fa.I0b.count&&ba.runtime.qn.Z(fa.zm.id,fa);ea.add(ia.J(fa.zm.id));return!0})}return!0});return ha?ea:null}izl(ba,Z){for(let ea=0;ea<ba.length;ea++)if(Z.get(ba.Zf(ea).id))return!0;return!1}aBd(ba,Z,ea){ea.length&&(ea.forEach(ha=>{ba.runtime.Elc.add(ha.id);ba.runtime.Elc.add(Z.J(ha.id));return!0}),H.a.aBd(ba,this.Vd,
ea.J(0)))}Coh(ba,Z,ea,ha){ba.forEach(la=>{const ia=new V.a(la.UK());Z.runtime.qn.Z(la.id,ia);ea.add(ha.J(la.id));return!0})}S1f(ba,Z,ea,ha,la,ia,sa){var Oa=ea(Z);if(!Oa)return a.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",sa,Z),ba.logger.Pg(Object.assign(new v,{uj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",sa)})),!1;const Ra=this.Vd.getPropertyObjectIds(Oa,l.a.XK);if(!Ra||!Ra.length)return a.a.instance.Ua(4285058,
1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",sa,Z),ba.logger.Pg(Object.assign(new v,{uj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",sa)})),L.a(Oa,"ProcessOutlineElement_"+sa,1),!1;Oa=Ra.Zf(0);ea=ea(Oa);if(!ea)return a.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",sa,Oa,Z),ba.logger.Pg(Object.assign(new v,{uj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",sa)})),!1;if((sa=this.Vd.getPropertyString(ea,f.a.zN))&&""!==sa&&ba.runtime.Zb&&(ba.runtime.Zb.FUd(1000005),ba.runtime.Zb.gjb(1000005)))return la.add(ea),ia.add(Oa,Z),ba.runtime.WNa.add(Oa),!0;ha.add(ea);ia.add(Oa,Z);ba.runtime.WNa.add(Oa);return!0}K7h(ba){let Z,ea;Z=this.Vd.getPropertyObjectIds(ba.VE,l.a.$e);ea=this.Vd.getPropertyObjectIds(ba.H8,l.a.$e);ba=this.Vd.getPropertyObjectIds(ba.Lra,
l.a.$e);return{WCd:Z,bNd:ea,Mme:ba}}sTm(ba){if(!ba)return a.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;ba.Tx(106);return ba.isFeatureEnabled(106)}static m_i(ba,Z){Z.nb(ba.Nc)||Z.Z(ba.Nc,new y.a);Z.J(ba.Nc).add(ba);return!0}}Y.R8d=m.a.Ff("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(Y,"ChildNodeListMerge",null,[1809])},1777:function(D,I,c){D=c(0);var l=c(1506),f=c(1637),a=c(1554),k=c(1524),x=c(1716),y=c(1571);class m{constructor(Z,ea){this.DimensionValue=this.DimensionName=
null;this.DimensionName=Z;this.DimensionValue=ea}}Object(D.a)(m,"Dimension",null,[]);class r{constructor(Z,ea,ha,la,ia){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Z;this.Query=ea;this.From=ha;this.Size=la;ia&&(this.Filter=ia)}}Object(D.a)(r,"EntityRequest",null,[]);class z{constructor(Z){this.QueryString=null;this.QueryString=Z}}Object(D.a)(z,"Query",null,[]);var v=c(1508);class G{constructor(Z,ea){this.Dimensions=this.Name=null;this.Name=Z;this.Dimensions=
ea}}Object(D.a)(G,"Scenario",null,[]);var F=c(1511),H=c(1510);class L{constructor(Z,ea,ha,la){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Z;this.TimeZone=ea;this.Cvid=ha;this.Scenario=la}}Object(D.a)(L,"SubstrateBody",null,[]);var J=c(1570),M=c(1504),P=c(1503),N=c(2),K=c(1709),O=c(1708),V=c(1540),W=c(34),T=c(19),Y=c(135);c.d(I,"a",function(){return ba});class ba{constructor(Z){this.Mzc=this.ddb=this.erd=this.Guc=this.yAc=0;this.Z6g=this.A$g=this.wQ=null;this.$He=
0;this.B2=-1;this.hDc="";this.nBe=!1;this.Wf=N.AFrameworkApplication.He;this.fc=Z;this.bxd=this.Ktf();this.yyb=new f.a;this.o5g=this.fc.Yle?3:2;this.kUe=this.fc.Yle&&this.fc.Sqj?5:3;this.CXe=this.fc.Hhe?2:3;this.dlh=1;this.jqd=this.fc.Qbi;this.Ffh=this.fc.DSm;this.vBc=Z.Sfi;N.AFrameworkApplication.K&&(this.A$g=N.AFrameworkApplication.K.kb("AppCatalogUrl")+N.AFrameworkApplication.K.kb("SearchPersonaPhotoBaseUrl"),this.nBe=this.fc.Yga||this.fc.DLd);this.fc.Yga&&(this.CXe=this.kUe=5)}lL(){return"Substrate"}rU(){return 0===
this.fc.fv?0:1===this.fc.fv?1:3}ZH(Z,ea,ha,la=l.a.tellMe,ia=null){const sa=new H.a(Z);if(!ia||Array.contains(ia,14)||Array.contains(ia,15)||Array.contains(ia,20))if(!this.$He||window.performance.now()-this.$He>=P.a.v8a)if(ha=this.yyb.ygi())this.$He=window.performance.now(),ha.then(Oa=>{Oa&&""!==Oa?(this.hDc=Oa,""!==this.wQ&&this.xgi(Z,la,this.hDc,ea,ia)):(M.TellMeActor.instance.Le.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ea.resultsUpdated(sa))},Oa=>{M.TellMeActor.instance.Le.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+Oa);ea.resultsUpdated(sa)});else{if(M.TellMeActor.instance.Le)M.TellMeActor.instance.Le.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ea.resultsUpdated(sa)}else this.hDc&&""!==this.hDc?this.xgi(Z,la,this.hDc,ea,ia):(ea.resultsUpdated(sa),M.TellMeActor.instance.Le.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ea.resultsUpdated(sa)}R6a(){this.ddb=this.Mzc=this.erd=this.Guc=this.yAc=0}xgi(Z,ea,ha,la,ia){this.R6a();
const sa=new H.a(Z),Oa=this.wQ=Y.a.create().toString();this.vDa();this.B2=window.setTimeout(()=>{if(Oa===this.wQ){this.wQ="";this.B2=-1;la.resultsUpdated(sa);const Da={};Da[a.a.provider]=this.lL();Da[a.a.LNb]=Z.kob;M.TellMeActor.instance.Le.OA(k.a.timedOut,this.vBc,Da)}},this.vBc);const Ra={"Content-Type":"application/json",Accept:"application/json"};Ra.Authorization="Bearer "+ha;Ra["X-Office-Version"]=N.AFrameworkApplication.buildVersion;Ra["X-Office-Application"]=N.AFrameworkApplication.K.kb("Application");
Ra["X-Office-Platform"]="WAC";Ra["X-TellMe-SessionId"]=M.TellMeActor.instance.STd();Ra["X-TellMe-Culture"]=N.AFrameworkApplication.uiCulture;Ra["X-TellMe-ProcessSessionId"]=N.AFrameworkApplication.userSessionId;Ra["Client-Request-Id"]=Oa;const Na=window.performance.now();this.Wf.sj(this.Ddm(),2,this.Edm(Z.Cg,this.fc.application,M.TellMeActor.instance.STd(),P.a.BR(Z)),Ra,!1,0,Da=>{this.qMb(Da,Z,la,Oa,Na,ea,ia)},Da=>{this.ZLb(Da,Z,la,Oa,Na)},null,null,!1,4E3,6E3)}vDa(){-1!==this.B2&&(window.clearTimeout(this.B2),
this.B2=-1)}qMb(Z,ea,ha,la,ia,sa,Oa){M.TellMeActor.instance.Le.M9(ea.Cg.length,this.bxd.join(","),Z.data.Qe.toString(),Math.round(window.performance.now()-ia),J.a.substrate,!0,y.a.lQa);const Ra=P.a.BR(ea),Na=new H.a(ea);if(la===this.wQ){this.vDa();Z=W.b(Z.data.se);if(Z.Groups){Z=Z.Groups;for(const Da of Z)"People"===Da.Type&&this.fc.Iad&&(Oa?Array.contains(Oa,14):1)?(Z=this.edi(Da.Suggestions,Ra,sa),0<Z.results.length&&Na.$u(Z)):"File"===Da.Type&&this.fc.Gad&&(Oa?Array.contains(Oa,15):1)?(Z=this.qpf(Da.Suggestions,
Ra,sa),0<Z.results.length&&(this.qZd()&&(la=new v.a("GenerateSlidesFromTellMe",30,"",null,1),Z.Rw(la)),Na.$u(Z))):"Notes"===Da.Type&&this.fc.olb&&sa!==l.a.contextMenu&&(Oa?Array.contains(Oa,20):1)&&(Z=this.Mbi(Da.Suggestions,Ra,ea),0<Z.results.length&&Na.$u(Z))}ha.resultsUpdated(Na);M.TellMeActor.instance.Le.M9(ea.Cg.length,this.bxd.join(","),"",Math.round(window.performance.now()-ia),"",!0,y.a.provider)}else ha.resultsUpdated(Na)}Mbi(Z,ea,ha){const la=new F.a(20);la.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;
for(const ia of Z)this.UUm(ia)&&(Z=ia.NotesType,Z=T.a.Zg(Z),Z=this.H4l(Z,ia.LastModifiedTime,ia.BodyPreview,ia.Subject,ea,ha,ia))&&(Z.groupType=20,la.Rw(Z));return la}edi(Z,ea,ha){const la=new F.a(14);la.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const sa of Z)if(this.VUm(sa)){var ia=sa.Id.split("@")[0];Z=sa.EmailAddresses[0];let Oa=sa.Type;if(void 0===Oa||null===Oa)Oa="User";if(ia=this.I7l(Oa,sa.DisplayName,sa.JobTitle,Z,ia,ha,ea))ia.description=Z,Z=sa.JobTitle,"Department"in sa&&
"CompanyName"in sa&&(Z+="@"+sa.Department+"@"+sa.CompanyName),ia.XI=Z,la.Rw(ia)}return la}qpf(Z,ea,ha){const la=new F.a(15);la.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Da of Z)if(this.KUm(Da)){var ia=Da.FileName;Z=Da.FileExtension;var sa=ia;ia.length>Z.length&&sa.endsWith(Z)&&(sa=ia.substr(0,ia.length-Z.length-1));var Oa=void 0,Ra=0;"DateCreated"in Da&&Da.DateCreated?(Ra=P.a.ruf(Da.DateCreated),Oa=P.a.Mhi(Da.DateCreated),Oa=String.format(CommonUIStrings.l_CreatedTimeFormatString,
Da.Author,Oa)):Oa=Da.Author;var Na=Da.AccessUrl+"?web=1";const ra=T.a.sac(Na);ia=String.format('<a href="{0}">{1}</a>',ra,T.a.jY(ia));if(ha!==l.a.contextMenu||T.a.DR(Na))if(sa=this.PVl(sa,ha===l.a.contextMenu?ia:Na,Oa,Da.FileExtension,Da.Text,ea))sa.description=Da.Author,sa.GBd=Ra,la.Rw(sa),this.nBe&&(Ra=Da.AccessUrl,ia=P.a.LQd(Z),Oa=Da.DateModified?Da.DateModified:Da.DateCreated,Na=Da.Size?Da.Size:Da.FileSize,this.Dqo()&&(Ra=Ra.replace(RegExp("%20","g")," "),ia=P.a.wcm(Z)),Z=new x.a(ia,Ra,Da.SPWebUrl,
Da.Id,Na,Oa),M.TellMeActor.instance.Xng(!1,sa.value,Z))}return la}ZLb(Z,ea,ha,la,ia){la===this.wQ&&(this.vDa(),M.TellMeActor.instance.Le.M9(ea.Cg.length,this.bxd.join(","),Z.data.Qe.toString(),Math.round(window.performance.now()-ia),J.a.substrate,!1,y.a.lQa));Z=new H.a(ea);ha.resultsUpdated(Z)}I7l(Z,ea,ha,la,ia,sa,Oa){Oa=Oa?this.dlh:this.o5g;if(!window.LPC&&!P.a.cDf()||this.yAc===Oa)return null;this.yAc+=1;Oa="PeopleSuggestion"+this.yAc.toString();var Ra=this.A$g+"?size=1&accountName="+la;Z=Object.assign(new K.a,
{PersonaType:Z,Smtp:la,ProfilePictureUrl:Ra,AadObjectId:ia});const Na=Object.assign(new O.a,{identifiers:Z,displayName:ea});Z=sa===l.a.contextMenu;this.fc.Pwa?(M.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Oa,Na,ea,ha)),sa===l.a.contextMenu&&(ha=P.a.mMh(ea,la,ia),M.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Oa,ha))),M.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Oa,Z))):(Ra=[],Ra.push(appChrome.actions.setPersonaButtonCoauthor(Oa,
Na,ea,ha)),sa===l.a.contextMenu&&(ha=P.a.mMh(ea,la,ia),Ra.push(appChrome.actions.setButtonCommandValueId(Oa,ha))),Ra.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Oa,Z)),appChrome.api.dispatch(Ra));return new v.a(Oa,11,ea,la,0)}H4l(Z,ea,ha,la,ia,sa,Oa){if(ia&&!this.fc.hCi||this.erd===this.jqd||this.Mzc===this.jqd||this.ddb===this.jqd)return null;var Ra=null;this.erd+=1;ia="";const Na=[],Da={};Oa.type="Notes";this.Z6g=Object.assign(new V.a,{landingTab:"Notes",data:Oa});sa=P.a.uOa(sa.Cg,
33,this.Z6g);if("onenotepagepreviews"===Z){if(!("ClickthroughUrl"in Oa&&Oa.ClickthroughUrl)||""===Oa.ClickthroughUrl)return null;this.Mzc+=1;ia="OnenoteNotesSuggestion"+this.Mzc.toString();Da["default"]="SaveAsonetoc2_20";Ra=Oa.ClickthroughUrl;Na.push(appChrome.actions.setControlIconSet(ia,Da));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ia,Ra));Ra=new v.a(ia,19,null,null,0)}else if("stickynote"===Z){if(!this.Ffh)return null;this.ddb+=1;ia="NotesSuggestion"+this.ddb.toString();Da["default"]=
"ShowAllNotes_20";Na.push(appChrome.actions.setControlIconSet(ia,Da));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ia,sa));Ra=new v.a(ia,21,null,null,0)}else if("samsung"===Z){if(!this.Ffh)return null;this.ddb+=1;ia="NotesSuggestion"+this.ddb.toString();Da["default"]="CategoryCollapsed_20";Na.push(appChrome.actions.setControlIconSet(ia,Da));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ia,sa));Ra=new v.a(ia,20,null,null,0)}""!==ia&&(Z=P.a.Mhi(ea),Z=String.format(CommonUIStrings.l_LastModifiedString,
Z),Ra.label=la,Ra.GBd=P.a.ruf(ea),Na.push(appChrome.actions.setControlLabel(ia,la)),Na.push(appChrome.actions.updateCompoundButtonDescription(ia,Z)),Na.push(appChrome.actions.setControlCustomTooltip(ia,ha)),appChrome.api.dispatch(Na));return Ra}PVl(Z,ea,ha,la,ia,sa){if(this.Guc===(sa?this.CXe:this.kUe)||this.nBe&&"Word"!==P.a.LQd(la))return null;this.Guc+=1;sa="FileSuggestion"+this.Guc.toString();const Oa=[],Ra={};Ra["default"]=P.a.bZl(la);this.fc.Pwa?(M.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa,
Z)),M.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(sa,Ra)),M.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(sa,ha)),M.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(sa,ea)),M.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(sa,ia))):(Oa.push(appChrome.actions.setControlLabel(sa,Z)),Oa.push(appChrome.actions.setControlIconSet(sa,Ra)),Oa.push(appChrome.actions.updateCompoundButtonDescription(sa,
ha)),Oa.push(appChrome.actions.setCompoundButtonCommandValueId(sa,ea)),Oa.push(appChrome.actions.setControlCustomTooltip(sa,ia)),appChrome.api.dispatch(Oa));return new v.a(sa,6,Z,ha,0)}Ktf(){const Z=[];this.fc.Iad&&Array.add(Z,"People");this.fc.Gad&&Array.add(Z,"File");this.fc.olb&&Array.add(Z,"Notes");return Z}Edm(Z,ea,ha,la){var ia=new z(Z);Z=new r("File",ia,0,la?this.CXe:this.kUe,null);la=new r("People",ia,0,la?this.dlh:this.o5g,P.a.Lzn);ia=new r("Notes",ia,0,this.jqd,null);this.fc.DLd&&"powerpoint"===
ea.toLowerCase()&&(ea="word");ea=new m("app",ea.toLowerCase());var sa=[];Array.add(sa,ea);ea=new G("tellmesearch",sa);sa=[];this.fc.Gad&&Array.add(sa,Z);this.fc.Iad&&Array.add(sa,la);this.fc.olb&&Array.add(sa,ia);ha=new L(sa,"UTC",ha,ea);return W.c(ha)}Ddm(){let Z=this.fc.ECo;this.fc.olb&&(Z+="?&setflight=NotesFrom3S");""!==this.fc.zgi&&(Z=Z+"&"+this.fc.zgi);return Z}VUm(Z){return"DisplayName"in Z&&"Id"in Z&&"EmailAddresses"in Z&&!!Z.Id&&!!Z.EmailAddresses}KUm(Z){return"FileExtension"in Z&&!!Z.FileExtension&&
"FileName"in Z&&!!Z.FileName&&""!==Z.FileName&&"AccessUrl"in Z&&!!Z.AccessUrl&&""!==Z.AccessUrl}UUm(Z){return"Id"in Z&&!!Z.Id&&"NotesType"in Z&&!!Z.NotesType&&"Subject"in Z&&!!Z.Subject&&""!==Z.Subject}qZd(){return!!N.AFrameworkApplication.K&&N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Dqo(){return!!N.AFrameworkApplication.K&&N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(D.a)(ba,"SubstrateResultsProvider",null,[1117])},1778:function(D,I,c){D=c(0);var l=c(41),f=c(6),a=c(16),k=c(179),x=c(86),y=c(185),m=c(224),r=c(608),z=c(60),v=c(365),G=c(2),F=c(1458),H=c(966);class L{constructor(sa,Oa=0){this.Z$e=null;this.MZf=0;this.ZM=sa;this.qan=Oa}}Object(D.a)(L,"GraphMergerResponse",null,[]);var J=c(54),M=c(1),P=c(115),N=c(880),K=c(1541),O=c(1595);class V extends O.a{constructor(){super();this.ptj=null;this.iJj=!1}get fha(){return"Crash"}BFb(){this.detail.Z("Type",
this.fha);this.detail.Z("Trace",this.ULo(this.ptj));this.detail.Z("Continue",this.iJj);return this.detail}ULo(sa){sa=sa.split("\n");const Oa=4<sa.length?4:sa.length,Ra=new Sys.StringBuilder;for(let Na=0;Na<Oa;Na++)Na===Oa-1?Ra.append(String.format("{0}...",sa[Na])):Ra.append(String.format("{0}\n",sa[Na]));return Ra.toString()}}Object(D.a)(V,"CrashMergeFailureDetail",O.a,[]);var W=c(1979),T=c(1559),Y=c(1653),ba=c(1542);class Z{constructor(){this.EJk=new v.a;this.v0k=new v.a;this.L3k=new v.a}}Object(D.a)(Z,
"RangeMarkers",null,[]);class ea{constructor(){this.colSpan=this.rowSpan=null;this.fg=!1;this.JBe=new m.a;this.EKe=new m.a;this.YKe=new m.a}get mvf(){return this.JBe.I5()}set mvf(sa){sa||(this.JBe=new m.a);this.JBe=sa.I5()}get xSf(){return this.EKe.I5()}set xSf(sa){sa||(this.EKe=new m.a);this.EKe=sa.I5()}get E5d(){return this.YKe.I5()}set E5d(sa){sa||(this.YKe=new m.a);this.YKe=sa.I5()}}Object(D.a)(ea,"TableCellStructureInfo",null,[]);var ha=c(1598),la=c(1644);c.d(I,"a",function(){return ia});class ia{constructor(){this.EUd=
0;this.eWg=this.Rab=this.JYb=this.Og=this.zch=this.XZb=null;this.m5g=0;this.V1g=50;this.CTg=this.hNg=null}get Vde(){return this.XZb}get r6n(){return this.zch}get Vd(){return this.Og}get omb(){return this.JYb}get $ji(){return this.Rab}get xkm(){return this.eWg}get cfc(){return this.m5g}get CCh(){return this.hNg}get hNc(){return this.CTg}jfc(sa,Oa,Ra,Na,Da,ra,xa){Ra=this.lal(sa,Oa,Na,Da,ra,xa,this.hNc);Na=0;const fa=Ra.runtime.Mhe;let oa=null;try{this.Y3m(fa,Ra,xa,sa,Oa,Da,ra);for(sa=1;Na<this.omb.length;Na++)if(!(0,this.omb[Na])(Ra)){sa=
2;Ra.logger.y2d("GraphMerger.GetMergeFunctions()",Na);break}return oa=new L(Ra.output.ZM,sa)}catch(ta){const Ka=!Ra.output.timeout;Ra.output.crash=Ka;const va=this.EQd(ta),La=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ka?"Crashed":"Timed Out",Ra.input.eLb,!!Ra.output.ZM,va);Ka?(k.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",La),Ra.logger.Pg(Object.assign(new V,{ptj:va,iJj:!!Ra.output.ZM}))):k.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",
La);if(Ra.output.ZM)return oa=new L(Ra.output.ZM,2);throw ta;}finally{Ra.output.succeeded?this.V3m(fa,Ra,Na):Ra.output.timeout?this.X3m(Ra,Na):Ra.output.crash?Ra.output.ZM?this.W3m(Ra,Na):this.U3m(Ra,Na):this.T3m(Ra,Na);Ra.logger.S3m();k.a.instance.kka(42350232,1,Ra.output.succeeded?4:2,"MergeLogger",Ra.logger.u2l());Ra.logger.o_c.Vli()&&k.a.instance.kka(559015903,1,2,"MarkerInfo",Ra.logger.o_c.toString());if(Ra.runtime.Zb&&Ra.runtime.Zb.isFeatureEnabled(75))try{this.p1m(Ra)}catch(ta){k.a.instance.Ua(571619421,
1,4,"Error logging references: {0}",ta.toString())}this.F4m(Ra);oa.MZf|=(Ra.output.succeeded?2:1)<<2*(xa-1);if(oa)try{oa.Z$e=this.GDn(Ra)}catch(ta){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",ta)}}}F4m(sa){if(!sa.output.succeeded){sa=sa.output.timeout?"Timeout":sa.logger.G3i?sa.logger.G3i.fha:"Unknown";const Oa=new P.a;x.Health.instance.recordQosError(sa,["MergeFailure"],!0,!0,!1,!1,Oa)}}p1m(sa){const Oa=Da=>{const ra=this.VEa()-sa.input.oUa>this.cfc;if(0<this.cfc&&
ra)throw k.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Da),y.a.invalidOperation(Da);};let Ra=sa.runtime.Ku.keys,Na=Da=>sa.runtime.Ku.J(Da);this.ALf(sa,Oa,Ra,Na,"Favored");Ra=sa.runtime.Kq.keys;Na=Da=>sa.runtime.Kq.J(Da);this.ALf(sa,Oa,Ra,Na,"Unfavored");Ra=sa.runtime.qn.keys;Na=Da=>{const ra=sa.runtime.qn.J(Da);return ra?ra.zm:sa.runtime.Ku.J(Da)};this.ALf(sa,Oa,Ra,Na,"Merged")}ALf(sa,Oa,Ra,Na,Da){var ra=new m.a;const xa=new m.a;for(let fa=0;fa<Ra.length;fa++){Oa("LogAddedAndDeletedNodes");
const oa=Na(Ra.J(fa));if(4325465===oa.Nc)continue;const ta=sa.runtime.sk.J(oa.id);ta&&this.q1m(ra,xa,oa,ta)}this.pJi(xa,fa=>sa.runtime.sk.J(fa),Oa);this.pJi(ra,Na,Oa);Oa=new Sys.StringBuilder;for(Ra=0;Ra<ra.length;Ra++)Oa.append(ra.J(Ra).toString()+",");ra=new Sys.StringBuilder;for(Ra=0;Ra<xa.length;Ra++)ra.append(xa.J(Ra).toString()+",");k.a.instance.kka(571619423,1,4,Da+" revision: Added references",Oa.toString());k.a.instance.kka(571619424,1,4,Da+" revision: Deleted references",ra.toString())}q1m(sa,
Oa,Ra,Na){const Da=Ra.Jl();for(let xa=0;xa<Da.length;xa++){const fa=Da[xa];if(this.Jti(fa)){var ra=this.Vd.getPropertyObjectIds(Ra,fa);this.c3m(sa,Oa,Na,fa,ra)}else this.czi(fa)&&(ra=this.Vd.getPropertyObjectId(Ra,fa),this.b3m(sa,Oa,Na,fa,ra))}}pJi(sa,Oa,Ra){Ra("LogNestedReferences");Ra=new m.a;const Na=new r.a;for(let Da=0;Da<sa.length;Da++){const ra=sa.J(Da);this.eMf(ra,Ra,Na,Oa)}for(Oa=0;Oa<Ra.length;Oa++)sa.add(Ra.J(Oa))}eMf(sa,Oa,Ra,Na){const Da=Na(sa);if(Da){const xa=Da.Jl();for(let fa=0;fa<
xa.length;fa++){var ra=xa[fa];if(this.Jti(ra)){ra=this.Vd.getPropertyObjectIds(Da,ra);for(let oa=0;oa<ra.length;oa++)Ra.contains(ra.J(oa))||(Oa.add(ra.J(oa)),Ra.add(ra.J(oa)),this.eMf(ra.J(oa),Oa,Ra,Na))}else this.czi(ra)&&(ra=this.Vd.getPropertyObjectId(Da,ra),Ra.contains(ra)||(Oa.add(ra),Ra.add(ra),this.eMf(sa,Oa,Ra,Na)))}}}c3m(sa,Oa,Ra,Na,Da){if(this.Vd.hasProperty(Ra,Na)){Ra=this.Vd.getPropertyObjectIds(Ra,Na);const ra=Ra.ZG();Na=Da.ZG();for(let xa=0;xa<Da.length;xa++)ra.contains(Da.J(xa))||sa.add(Da.J(xa));
for(sa=0;sa<Ra.length;sa++)Na.contains(Ra.J(sa))||Oa.add(Ra.J(sa))}else for(Oa=0;Oa<Da.length;Oa++)sa.add(Da.J(Oa))}b3m(sa,Oa,Ra,Na,Da){Da&&(this.Vd.hasProperty(Ra,Na)?(Ra=this.Vd.getPropertyObjectId(Ra,Na),Da.equals(Ra)||(sa.add(Da),Oa.add(Ra))):sa.add(Da))}R3m(sa){k.a.instance.Ua(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",sa.input.eLb,sa.output.crash,sa.output.timeout)}Y3m(sa,Oa,Ra,Na,Da,ra,xa){if(sa){sa=Na.length?Na.Zf(Na.length-1):null;var fa=Da.length?Da.Zf(Da.length-
1):null;Ra=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",Oa.input.eLb,Na.length,sa?sa.id:z.a.nil,sa?sa.iX?sa.iX.id:z.a.nil:z.a.nil,Da.length,fa?fa.id:z.a.nil,fa?fa.iX?fa.iX.id:z.a.nil:z.a.nil,ra,xa,this.cfc,Ra);switch(Oa.input.source){case 5:k.a.instance.Ua(51663493,1,4,Ra);break;default:k.a.instance.Ua(4051606,
1,4,Ra)}}}V3m(sa,Oa,Ra){if(sa)switch(sa=this.zPc(Oa,Ra,"Succeeded"),Oa.input.source){case 5:k.a.instance.Ua(51663494,1,4,sa);break;default:k.a.instance.Ua(4059162,1,4,sa)}}X3m(sa,Oa){Oa=this.zPc(sa,Oa,"Timeout");switch(sa.input.source){case 5:k.a.instance.Ua(51663495,1,4,Oa);break;default:k.a.instance.Ua(4059163,1,2,Oa)}}T3m(sa,Oa){Oa=this.zPc(sa,Oa,"Rejection");switch(sa.input.source){case 5:k.a.instance.Ua(51663496,1,4,Oa);break;default:k.a.instance.Ua(4059164,1,2,Oa)}}W3m(sa,Oa){Oa=this.zPc(sa,
Oa,"Crash - Rejection");switch(sa.input.source){case 5:k.a.instance.Ua(51663497,1,4,Oa);break;default:k.a.instance.Ua(4059165,1,2,Oa)}}U3m(sa,Oa){Oa=this.zPc(sa,Oa,"Crash - Failed");switch(sa.input.source){case 5:k.a.instance.Ua(51663498,1,4,Oa);break;default:k.a.instance.Ua(4059166,1,2,Oa)}}zPc(sa,Oa,Ra){const Na=sa.output.ZM,Da=Na&&Na.length?Na.Zf(Na.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
sa.input.eLb,Ra,this.VEa()-sa.input.oUa,Oa,Na?Na.length:0,Da?Da.id:z.a.nil,Da?Da.iX?Da.iX.id:z.a.nil:z.a.nil,sa.input.source)}lal(sa,Oa,Ra,Na,Da,ra,xa){const fa=new W.a,oa=fa.input;oa.P$=sa;oa.yVa=Oa;oa.Am=Ra;oa.Fia=Na;oa.HHb=Da;oa.source=ra;oa.hNc=xa;oa.oUa=this.VEa();fa.logger.nlo(oa.oUa);sa=fa.runtime;sa.K9c=k.a.instance.F$(1,5);sa.Mhe=k.a.instance.F$(1,4);let ta="";sa.YG=Ka=>{if(this.cfc){var va=this.VEa()-oa.oUa,La=va>this.cfc;ta+=String.format(" ({0}: {1})",Ka,va);La&&(fa.output.timeout=!0,
Ka=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",oa.eLb,this.cfc,Ka,va,ta),k.a.instance.Ua(528061012,1,2,Ka),this.yHo(Ka))}};return fa}mQc(){return[Object(J.a)(this,this.nvn,"otherAuthorsHaveChangesToMerge"),Object(J.a)(this,this.BMm,"isInputValid"),Object(J.a)(this,this.pzm,"initializeOutputMergeState"),Object(J.a)(this,this.RWd,"initializeRuntimeMergeState"),Y.a.mDn,Object(J.a)(this,this.lDn,"preProcessTableStructure"),
Object(J.a)(this.CCh,this.CCh.T$m,"mergeChildNodeLists"),Object(J.a)(this,this.vNo,"tryObjectMerge"),Y.a.SCn,Object(J.a)(this,this.eBl,"finalizeObjectMerge"),Object(J.a)(this,this.L_o,"validateMarkers"),Object(J.a)(this,this.Ark,"addMergeResultsToOutput")]}nvn(sa){const Oa=sa.input.P$;sa=sa.output;return Oa?Oa.length?!0:(k.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),sa.ZM=Oa,sa.succeeded=!0,!1):(k.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
sa.ZM=Oa,sa.succeeded=!0,!1)}BMm(sa){var Oa=sa.input;const Ra=Oa.P$,Na=Oa.yVa,Da=Oa.Am,ra=Oa.Fia;Oa=Oa.HHb;sa=sa.output;if(!Na||!Na.length)return k.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),sa.ZM=Ra,sa.succeeded=!0,!1;let xa=!0;if(2!==ra&&1!==ra)return sa.ZM=Ra,!1;Da&&Da!==z.a.nil||(xa=!1);Ra.length<(Oa?2:1)&&(k.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
Oa),xa=!1);xa||(sa.ZM=2===ra?Ra:Na);return xa}RWd(sa){var Oa=sa.input,Ra=Oa.P$,Na=Oa.yVa,Da=Oa.Fia,ra;let xa;({Okg:ra,wrg:xa,DDa:Oa}=this.Cqf(sa,Ra,Na,Oa.HHb));if(!Oa)return k.a.instance.Ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",ra.id,xa.id),sa.logger.Pg(Object.assign(new K.a,{uj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.HJi(ra,Ra.length,"TheirChanges"),this.HJi(xa,Na.length,
"YourChanges"),sa.output.ZM=2===Da?Ra:Na,!1;sa.runtime.DDa=Oa;({ePo:Ra,jzl:Na}=this.kll(Da,ra,xa));({fPo:Oa,kzl:Da,VHk:ra}=this.S2l(sa,Ra,Na,Oa));sa.runtime.sk=ra;sa.runtime.Kq=Oa;sa.runtime.Ku=Da;sa.runtime.qn=new v.a;sa.runtime.cNd=Na.id;sa.runtime.Nme=Ra.id;sa.runtime.Hmb=new v.a;sa.runtime.WNa=new r.a;sa.runtime.Wcf=new v.a;sa.runtime.cCb=new v.a;sa.runtime.xjg=new v.a;sa.runtime.Sbe=new Z;sa.runtime.R3d=new m.a;sa.runtime.iZf=new r.a;sa.runtime.Elc=new m.a;sa.runtime.Zb=sa.input.hNc(sa);sa.runtime.Zb.lFc(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.uGo);sa.runtime.Zb.lFc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",l.a.AIo);sa.runtime.Zb.lFc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.Tyl);sa.runtime.Zb.lFc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.AXn);sa.runtime.Zb.lFc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix",
"79ee6190;i588c310",l.a.fan);sa.runtime.zqi=!0;G.AFrameworkApplication.K&&(this.V1g=G.AFrameworkApplication.K.lc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}HJi(sa,Oa,Ra){const Na=new m.a;for(;sa;)Na.add(sa),sa=sa.iX;const Da=new Sys.StringBuilder;Da.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Ra,Oa,Na.length));let ra=Na.length,xa=0;Na.forEach(fa=>({goi:ra,aKi:xa}=this.otk(Da,fa,Na,ra,xa)).returnValue);k.a.instance.Ua(4273302,1,4,Da.toString())}otk(sa,
Oa,Ra,Na,Da){sa.append(String.format(" [{0} {1} {2}]",Na,Oa.nia?"S":"B",Oa.id));Na--;Da++;return 50<Da&&Ra.length!==Da?(sa.append(" ...Truncated."),{returnValue:!1,goi:Na,aKi:Da}):{returnValue:!0,goi:Na,aKi:Da}}Cqf(sa,Oa,Ra,Na){Oa=Oa.Zf(Oa.length-1-(Na?1:0));Ra=Ra.Zf(Ra.length-1);Na=Oa.P1a(Ra);sa.runtime.YG("GetCommonBase");sa.logger.Aia("GetCommonBase");return{Okg:Oa,wrg:Ra,DDa:Na}}S2l(sa,Oa,Ra,Na){let Da,ra;({result:Da}=Oa.kfc(Na));sa.runtime.YG("GetUnfavoredChanges");sa.logger.Aia("GetUnfavoredChanges");
({result:ra}=Ra.kfc(Na));5===sa.input.source&&(sa.runtime.nzl=N.a.yei(Ra),sa.runtime.hPo=N.a.yei(Oa));sa.runtime.YG("GetFavoredChanges");sa.logger.Aia("GetFavoredChanges");Oa=new F.a(Object(J.a)(Na,Na.o2a,"getMergeableObject"));sa.runtime.YG("GetModifiedObjects");sa.logger.Aia("GetModifiedObjects");return{fPo:Da,kzl:ra,VHk:Oa}}kll(sa,Oa,Ra){2===sa?(sa=Oa,Oa=Ra):sa=Ra;return{ePo:Oa,jzl:sa}}pzm(sa){const Oa=sa.input,Ra=Oa.P$,Na=Oa.yVa;sa.output.ZM=(2===Oa.Fia?Ra:Na).I5();sa.runtime.YG("InitializeOutputMergeState");
sa.logger.Aia("InitializeOutputMergeState");return!0}Ark(sa){var Oa=sa.input.Am;const Ra=sa.runtime.qn,Na=sa.output.ZM;Oa=this.mal(sa,Na.Zf(Na.length-1),Oa,z.a.create());this.DAl(sa,Oa,Ra);Na.add(Oa);return sa.output.succeeded=!0}mal(sa,Oa,Ra,Na){sa.runtime.Mhe&&k.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Ra,Na);sa=this.r6n(Na);sa.tIk(Oa,Ra);return sa}DAl(sa,Oa,Ra){sa.runtime.Mhe&&k.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",
Ra.count);Ra.forEach((Na,Da)=>{Oa.Ssk(Da.zm);return!0})}EJb(sa){if(!sa)return k.a.instance.Ua(573957952,1,2,"Feature helper is null"),!1;sa.Tx(107);return sa.isFeatureEnabled(107)}lDn(sa){if(!this.EJb(sa.runtime.Zb))return!0;const Oa=sa.runtime.Ku,Ra=sa.runtime.Kq,Na=sa.runtime.sk;let Da=!0;Oa.forEach((ra,xa)=>{393252===xa.Nc&&(Da=this.x1i(sa,ra,xa,Na,Oa));return Da});if(!Da)return!1;Ra.forEach((ra,xa)=>{393252===xa.Nc&&(Da=this.x1i(sa,ra,xa,Na,Ra));return Da});sa.logger.Aia("PreProcessTableStructure");
return Da}x1i(sa,Oa,Ra,Na,Da){const ra=null==this.Vd.getPropertyBool(Ra,f.a.ghostCell)?!1:this.Vd.getPropertyBool(Ra,f.a.ghostCell),xa=null==this.Vd.getPropertyUint32(Ra,f.a.rowSpan)?1:this.Vd.getPropertyUint32(Ra,f.a.rowSpan),fa=null==this.Vd.getPropertyUint32(Ra,f.a.colSpan)?1:this.Vd.getPropertyUint32(Ra,f.a.colSpan);if(ra)return!0;var oa=Na.J(Oa);if(oa){Na=null==this.Vd.getPropertyBool(oa,f.a.ghostCell)?!1:this.Vd.getPropertyBool(oa,f.a.ghostCell);var ta=null==this.Vd.getPropertyUint32(oa,f.a.rowSpan)?
1:this.Vd.getPropertyUint32(oa,f.a.rowSpan);var Ka=null==this.Vd.getPropertyUint32(oa,f.a.colSpan)?1:this.Vd.getPropertyUint32(oa,f.a.colSpan);Na=Na!==ra;ta=ta!==xa;Ka=Ka!==fa}else Ka=ta=Na=!0;const va=la.e(sa,Ra,Da);if(va.equals(z.a.nil))return k.a.instance.Ua(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",Oa),sa.logger.Pg(Object.assign(new ha.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let La=sa.runtime.cCb.J(va);La||(sa.runtime.cCb.Z(va,
new v.a),La=sa.runtime.cCb.J(va));let za=La.J(Oa),Ca=new m.a;const ua=new m.a,ib=new m.a;Na&&(za||(Ca=this.Vd.getPropertyObjectIds(Ra,a.a.$e)));if(ta||Ka)if(za){if(za.fg)return k.a.instance.Ua(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),sa.logger.Pg(Object.assign(new ha.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=za.rowSpan&&xa!==za.rowSpan||null!=za.colSpan&&fa!==za.colSpan)return k.a.instance.Ua(573957962,1,
4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),sa.logger.Pg(Object.assign(new ha.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var bb;({rowIndex:Ra,q4b:bb}=la.b(sa,Da,Ra));if(-1===Ra||-1===bb)return k.a.instance.Ua(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",Oa),sa.logger.Pg(Object.assign(new ha.a,{info:"Table cell location could not be found"})),!1;for(var mb=Ra;mb<Ra+xa;mb++)for(var yb=bb;yb<
bb+fa;yb++){var ab=la.c(sa,va,mb,yb);if(ab.equals(z.a.nil))return k.a.instance.Ua(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),sa.logger.Pg(Object.assign(new ha.a,{info:"Ghost cell not found in the table bounds"})),!1;var Ga=Da.Cz(ab,sa.runtime.sk.J(ab));if(!Ga)return k.a.instance.Ua(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),sa.logger.Pg(Object.assign(new ha.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),
!1;if(!ab.equals(Oa)){if(null==this.Vd.getPropertyBool(Ga,f.a.ghostCell)||!this.Vd.getPropertyBool(Ga,f.a.ghostCell))return k.a.instance.Ua(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),sa.logger.Pg(Object.assign(new ha.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var Za=La.J(ab);if(Za)return k.a.instance.Ua(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),sa.logger.Pg(Object.assign(new ha.a,
{info:"Ghost cell is already merged with some other cell"})),!1;ua.add(ab);Za=new ea;Za.fg=!0;Ga=this.Vd.getPropertyUint32(Ga,f.a.colSpan);null!=Ga&&(Za.colSpan=Ga);La.Z(ab,Za)}}if(oa&&(null==this.Vd.getPropertyBool(oa,f.a.ghostCell)||!this.Vd.getPropertyBool(oa,f.a.ghostCell))&&(Da=null==this.Vd.getPropertyUint32(oa,f.a.rowSpan)?1:this.Vd.getPropertyUint32(oa,f.a.rowSpan),Ra=null==this.Vd.getPropertyUint32(oa,f.a.colSpan)?1:this.Vd.getPropertyUint32(oa,f.a.colSpan),Da>xa||Ra>fa)){mb=bb=-1;({rowIndex:bb,
q4b:mb}=la.a(sa,null,oa,bb,mb));if(-1===bb||-1===mb)return k.a.instance.Ua(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",Oa),sa.logger.Pg(Object.assign(new ha.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;oa=ua.ZG();for(yb=bb;yb<bb+Da;yb++)for(ab=mb;ab<mb+Ra;ab++){Za=la.d(sa,null,va,yb,ab);if(!Za)return k.a.instance.Ua(573957960,1,2,"Table cell could not be found within table bounds"),sa.logger.Pg(Object.assign(new ha.a,
{info:"Ghost cell not found in the table bounds"})),!1;Za.id.equals(Oa)||oa.contains(Za.id)||ib.add(Za.id)}}}!za&&(Na||ta||Ka)&&(k.a.instance.Ua(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",Oa),za=new ea,za.rowSpan=xa,za.colSpan=fa,za.fg=ra,za.E5d=Ca,za.mvf=ua,za.xSf=ib,La.add(Oa,za));return!0}vNo(sa){return this.iBj(sa,!1)}eBl(sa){return this.iBj(sa,!0)}iBj(sa,Oa){const Ra=sa.runtime,Na=Ra.sk,Da=Ra.Ku,ra=Oa?Ra.Wcf:Ra.Kq,xa=Ra.qn;let fa=
!0;const oa=sa.runtime.K9c;let ta=0,Ka=0,va=0;ra.forEach((La,za)=>{oa&&k.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",La,za.Nc,Oa);Ka++;this.V1g===Ka&&(ta++,sa.runtime.YG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",ta,va,Oa)),Ka=0);if(sa.runtime.Zb&&sa.runtime.Zb.gjb(1000005)&&sa.runtime.Elc.contains(za.id,(ib,bb)=>ib.equals(bb))||this.Two(za.Nc))return!0;if(!Oa&&this.Lhl(za.Nc,sa.runtime.Zb))return Ra.Wcf.Z(La,za),!0;var Ca=
Da.get(La);if(!Ca)return xa.nb(La)?xa.J(La).lNi(za):xa.Z(La,new ba.a(za,!1)),!0;if(!Na.J(La)&&!this.Kan(Ca.Nc)){var ua=!!sa.input.P$&&!!sa.input.P$.last()&&sa.input.P$.last().M4(La);const ib=!!sa.input.yVa&&!!sa.input.yVa.last()&&sa.input.yVa.last().M4(La),bb=new T.a(Ca,za);if(!bb.tY)return xa.Z(La,new ba.a(Ca,!1)),!0;k.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
La,za.Nc,Oa,ua,ib,!bb.tY,sa.input.source);sa.logger.Pg(Object.assign(new K.a,{uj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return fa=!1}ua=xa.Cz(La,new ba.a(Na.J(La)));({Xk:Ca,returnValue:fa}=this.xkm.merge(sa,this.$ji,this.Vd,ua,Ca,za));va++;fa&&(sa.runtime.YG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",La,za.Nc,va,ta,Oa)),Ca&&(xa.nb(Ca.zm.id)?xa.J(Ca.zm.id).lNi(Ca.zm):xa.Z(Ca.zm.id,Ca)));return fa});sa.logger.Aia("ObjectMerge");oa&&
k.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ra.count,va,Oa);return fa}L_o(sa){try{for(let Oa=0;Oa<sa.runtime.R3d.length;Oa++){const Ra=sa.runtime.R3d.J(Oa);if(sa.runtime.qn.J(Ra)){if(!this.QNm(sa,Ra))return!1}else k.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");sa.runtime.YG("Validate markers taking too long")}}catch(Oa){k.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",Oa)}return sa.logger.o_c.Vli()?
!1:!0}Wro(sa){return 38===sa||39===sa||40===sa||41===sa||44===sa||45===sa||33===sa||34===sa?!1:!0}f2l(sa){switch(sa){case 38:case 39:case 40:case 41:return f.a.ke;case 44:case 45:return f.a.mDd;case 33:case 34:return f.a.$j}return H.CommonProperties.nil}K_o(sa,Oa){const Ra=this.Vd.getPropertyUint32(sa,f.a.Is);if(!Ra||this.Wro(Ra))return!0;sa=this.Vd.getPropertyObjectId(sa,this.f2l(Ra));return ia.j9b(Oa,sa)?!0:(Oa.logger.o_c.CXd=Ra,!1)}QNm(sa,Oa){if(sa.runtime.iZf.contains(Oa))return!1;if(Oa=ia.j9b(sa,
Oa)){Oa=this.Vd.getPropertyObjectIds(Oa,a.a.Ln);for(let Ra=0;Ra<Oa.length;Ra++){const Na=ia.j9b(sa,Oa.Zf(Ra));if(Na&&!this.K_o(Na,sa))return!1}}return!0}Two(sa){switch(sa){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}Lhl(sa,Oa){let Ra=!1;if(1074135145===sa)return!0;Oa&&Oa.Tx(125);Oa&&Oa.isFeatureEnabled(125)&&1074135153===sa&&(Ra=!0);return Ra}Kan(sa){switch(sa){case 1074135162:return!0}return!1}ycl(sa,Oa){const Ra=new m.a,Na=new m.a,Da=
new m.a;var ra=sa.runtime.DDa;const xa=ra?ra.id:z.a.nil;this.bKf(ra).forEach(fa=>{Ra.add(Oa(fa));return!0});ra=sa.input.P$.Zf(sa.input.P$.length-1);this.bKf(ra,xa).forEach(fa=>{Na.add(Oa(fa));return!0});sa=sa.input.yVa.Zf(sa.input.yVa.length-1);this.bKf(sa,xa).forEach(fa=>{Da.add(Oa(fa));return!0});return{UHk:Ra,aHo:Na,d6o:Da}}bKf(sa,Oa=null){const Ra=new m.a;Oa||(Oa=z.a.nil);for(;sa&&!Oa.equals(sa.id);)Ra.add(sa),sa=sa.iX;Ra.reverse();return Ra}fDo(sa){const Oa=3===this.EUd;let Ra=!1;!sa.output.succeeded&&
(2===this.EUd||sa.output.crash&&1===this.EUd)&&(Ra=!0);let Na=!1;sa.input.P$&&0<sa.input.P$.length&&(Oa||Ra)&&sa.runtime.Ku&&sa.runtime.sk&&sa.runtime.Zb&&(Na=sa.runtime.Zb.isFeatureEnabled(53));return Na}Jti(sa){return 9===M.a.Zib(M.a.Glf(sa))}czi(sa){return 8===M.a.Zib(M.a.Glf(sa))}static IXl(sa){return sa.output.crash?2:sa.output.succeeded?3:1}static j9b(sa,Oa){if(!Oa||Oa===z.a.nil)return null;const Ra=sa.runtime.qn.J(Oa);return Ra?Ra.zm:sa.runtime.sk.J(Oa)}}ia.CUd=z.a.Ff("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(D.a)(ia,"GraphMergerBase",null,[1365])},1788:function(D,I,c){D=c(0);var l=c(224),f=c(1642),a=c(185),k=c(1553);class x extends f.a{constructor(m,r,z,v,G,F,H,L,J,M,P,N,K,O){super(m,3,r,z,v,G,F,L,J,M,P,N,K,O);this.Iue=H}get character(){return this.Iue}get text(){return this.character.toString()}l9c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}G8b(){return"CharRun"}clone(){return new x(this.CFc,this.source,this.Lj,this.yg,this.runId,this.rJ,this.character,
this.Fmb,this.aRa,this.xca,this.rFa,this.OSa,this.DF,this.ku)}IA(m,r,z,v=!1){return super.IA(m,r,z,v)?m.character===this.character?!0:k.a.Qth(m.character,this.character):!1}}Object(D.a)(x,"CharRunMergeBlock",f.a,[]);c.d(I,"a",function(){return y});class y extends f.a{constructor(m,r,z,v,G,F,H,L,J,M,P,N,K,O,V){super(m,1,r,z,v,G,F,L,M,P,N,K,O,V);this._text=H;this.BTe=J}get text(){return this._text}l9c(m){this._text=m}get f8a(){return this.BTe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.BTe)}G8b(){return"TextRun"}clone(){return new y(this.CFc,this.source,this.Lj,this.yg,this.runId,this.rJ,this._text,this.Fmb,this.BTe,this.aRa,this.xca,this.rFa,this.OSa,this.DF,this.ku)}IA(m,r,z,v=!1){return super.IA(m,r,z,v)?k.a.Pth(this._text,m._text):!1}F$c(){const m=new l.a;for(let z=0;z<this.text.length;z++){var r=k.a.charAt(this._text,z);if(k.a.iTm(k.a.lIo(r))){let v="";v+=r;r=k.a.charAt(this._text,++z);v+=r;r=new y(this.CFc,this.source,this.Lj,this.yg,this.runId,this.rJ,
v,this.Fmb,!1,this.aRa,this.xca,this.rFa,this.OSa,this.DF,this.ku);m.add(r)}else r=new x(this.CFc,this.source,this.Lj,this.yg,this.runId,this.rJ,r,this.Fmb,this.aRa,this.xca,this.rFa,this.OSa,this.DF,this.ku),m.add(r)}return m}}Object(D.a)(y,"TextRunMergeBlock",f.a,[])},1789:function(D,I,c){D=c(0);var l=c(1029),f=c(16),a=c(365),k=c(224);c(60);c(811);var x=c(608),y=c(179),m=c(185),r=c(1051),z;(function(L){L[L.none=0]="none";L[L.browser=1]="browser";L[L.serverPutChanges=2]="serverPutChanges";L[L.syncDiff=
3]="syncDiff";L[L.docxMerge=4]="docxMerge";L[L.undo=5]="undo"})(z||(z={}));Object(D.b)("GraphMergeSource",z);var v=c(1776),G=c(1568),F=c(1770);c.d(I,"a",function(){return H});class H{constructor(L){this.iB=new r.a;this.tW=new a.a;this.Yhh=new a.a(0);this.Cfd=new k.a;this.sXg=new k.a;this.w6g=new k.a;this.J3g=new k.a;this.G5g="";this.RWa=null;this.ps=this.KHe=0;this.usd=new a.a(0);this.eAe=this.U9g=this.ppd=0;const {MarkerValidation:J}=c(1885);this._state=L;this.O9j=new J}get o_c(){return this.O9j}get G3i(){return this.RWa}nlo(L){this.KHe=
L}y2d(L,J){this.G5g=String.format("{0}-{1}",L,J)}uge(L){this.DWk();this.eAe=L}Hcg(){this.eAe=0}DWk(){this.RWa&&this.Cfd.add(this.RWa);this.RWa=null}Pg(L){this.RWa||(this.RWa=L);switch(this.eAe){case 1:this.sXg.add(L);break;case 2:this.w6g.add(L);break;case 3:this.J3g.add(L);break;default:this.RWa&&this.Cfd.add(L)}}BIi(L){this.Cfd.add(L)}S3m(){this.ps=this.VEa();this.Aia("MergeEnd")}Aia(L){const J=this.VEa();this.Yhh.Z(L,J-this.KHe);this.KHe=J}ljo(){this.ppd=this.VEa();this.U9g++}OU(L){const J=this.VEa();
let M;({value:M}=this.usd.Fc(L)).returnValue?(M+=J-this.ppd,this.usd.Z(L,M)):this.usd.Z(L,J-this.ppd);this.ppd=J}u2l(){this.tW.Z("Id",this._state.input.eLb.toString());this.tW.Z("Source",z[this._state.input.source]);this.tW.Z("RevSummary",H.wVa(this.P$l()));this.tW.Z("NodesRolledBackIfFailed",H.wVa(this.x4l()));if(!this._state.output.succeeded){let L,J,M,P,N;({WHk:L,lzl:J,gPo:M,aIk:P,iPo:N}=this.jBl(this._state.runtime));this.tW.Z("CharactersLost",this.XOl(L,J,M));this.tW.Z("CharactersLostInComments",
this.aQl());this.tW.Z("CharactersLostInTables",this.wLl(N,P))}this.tW.Z("FuncStep",this.G5g);this.tW.Z("FailureDetail",H.wVa(this.BFb()));this.tW.Z("FailDetailHints",this.GQd(this.sXg));this.tW.Z("FailDetailNaiveMerge",this.GQd(this.w6g));this.tW.Z("FailDetailLcs",this.GQd(this.J3g));this.tW.Z("ExtraDetails",this.GQd(this.Cfd));this.tW.Z("Timeline",H.wVa(this.Yhh));this.tW.Z("ParagraphMergesCount",this.U9g);this.tW.Z("ParagraphMergeDurations",H.wVa(this.usd));this.tW.Z("MarkerInfo",H.wVa(this.o_c.o7h()));
this.tW.Z("Result",H.wVa(this.w2l()));return JSON.stringify(H.wVa(this.tW))}VEa(){return(new Date).getTime()}P$l(){const L=new a.a;let J,M,P;({Okg:J,wrg:M,DDa:P}=this.Cqf(this._state,this._state.input.P$,this._state.input.yVa,this._state.input.HHb));L.Z("hasBase",P?"true":"false");if(P){let N=0,K=0;for(;J&&!J.id.equals(P.id);)N++,J=J.iX;for(;M&&!M.id.equals(P.id);)K++,M=M.iX;L.Z("lenToBaseTheirs",J?N:-1);L.Z("lenToBaseYours",M?K:-1)}return L}Cqf(L,J,M,P){L=J.Zf(J.length-1-(P?1:0));J=(M=M.Zf(M.length-
1))&&L?L.P1a(M):null;return{Okg:L,wrg:M,DDa:J}}x4l(){if(!this._state.runtime.zqi)return null;const L=this._state.runtime.Kq,J=new a.a(0);L.forEach((M,P)=>{({value:M}=J.Fc(P.Nc.toString()));J.Z(P.Nc.toString(),M+1);return!0});return J}XOl(L,J,M){let P=null,N=null,K=null;const O=this._state.runtime.Kq;let V=0;try{K=new F.a(this.iB,this._state);P=G.b(L,J,M);N=new x.a;for(L=0;L<P.length;L++)if(!P.J(L).QAb.zq(P.J(L).grb,(W,T)=>W.equals(T))){const W=this.mRh(P.J(L),K);V+=W;N.add(P.J(L))}P&&O.forEach((W,
T)=>{if(393230===T.Nc){T=null;for(let Y=0;Y<P.length;Y++)if(!N.contains(P.J(Y))&&P.J(Y).grb.contains(W,(ba,Z)=>ba===Z)){T=P.J(Y);break}T&&(W=this.mRh(T,K),N.add(T),V+=W)}return!0});return V}catch(W){return y.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+W.toString()),-1}}jBl(L){let J,M,P,N,K;L.YG=V=>{if(750<this.VEa()-this._state.input.oUa)throw y.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",V),m.a.invalidOperation(V);};J=new k.a;M=new k.a;P=new k.a;
N=new k.a;const O=new k.a;K=new k.a;try{if(L.sk){const V=L.sk.J(v.ChildNodeListMerge.R8d);let W,T;W=L.Ku.J(v.ChildNodeListMerge.R8d)||V;T=L.Kq.J(v.ChildNodeListMerge.R8d)||V;this.xjf(V,Y=>L.sk.J(Y),J,N);this.xjf(W,Y=>L.Ku.J(Y)||L.sk.J(Y),M,O);this.xjf(T,Y=>L.Kq.J(Y)||L.sk.J(Y),P,K)}}catch(V){y.a.instance.Ua(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+V.toString())}return{WHk:J,lzl:M,gPo:P,aIk:N,iPo:K}}wLl(L,J){try{let P=0;const N=this._state.runtime;var M=V=>N.Kq.J(V)||N.sk.J(V);const K=
new x.a,O=this.XCl(L,N,M,K);for(L=0;L<O.count;L++){let V=O.keys.J(L);const W=O.J(V);if(!K.contains(V)){let T=this.Lgi(N,M,K,V,W);if(-1!==T)P+=T;else return y.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(M=0;M<J.length;M++){let V=J.J(0);if(!K.contains(V)){let W=this.VTd(N.sk.J(V));if(-1===W)return y.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;P+=W}}return P}catch(P){return y.a.instance.Ua(573089735,
1,2,"Exception in GetAllTablesCharactersLost: "+P.toString()),-1}}Lgi(L,J,M,P,N){L.YG("GetTableCharactersLost");let K=0;N=this.iB.getPropertyObjectIds(N,f.a.$e);for(let Y=0;Y<N.length;Y++){var O=J(N.J(Y));O=this.iB.getPropertyObjectIds(O,f.a.$e);for(let ba=0;ba<O.length;ba++){var V=J(O.J(ba));if(L.sk.J(N.J(Y))&&L.sk.J(O.J(ba))){var W=L.sk.J(O.J(ba));if(!W)return y.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;V=this.iB.getPropertyObjectIds(W,f.a.$e);var T=L.Ku.J(O.J(ba))||L.sk.J(O.J(ba));
T=this.iB.getPropertyObjectIds(T,f.a.$e);W=this.iB.getPropertyObjectIds(W,f.a.$e);V=G.b(V,T,W);for(W=0;W<V.length;W++){T=V.J(W);const Z=this.Fem(L,J,M,T);if(-1===Z)return y.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",T.toString()),-1;K+=Z}}else{W=this.sfm(J,V,M);if(-1===W)return y.a.instance.Ua(573089736,1,2,"Error getting text length of cell {0}",V.id.toString()),-1;K+=W}}}M.add(P);return K}Fem(L,J,M,P){let N=0;var K=new k.a,O=new k.a;const V=new a.a;new a.a;for(var W=
0;W<P.QAb.length;W++){var T=L.sk.J(P.QAb.J(W));T=this.iB.getPropertyObjectIds(T,f.a.XK);if(1!==T.length)return y.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",T.length),-1;var Y=L.sk.J(T.J(0));393230===Y.Nc?K.add(Y):393250===Y.Nc&&V.add(T.J(0),Y)}for(W=0;W<P.grb.length;W++){T=J(P.grb.J(W));T=this.iB.getPropertyObjectIds(T,f.a.XK);if(1!==T.length)return y.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",T.length),-1;Y=J(T.J(0));if(393230===Y.Nc)O.add(Y);else if(393250===
Y.Nc){Y=this.Lgi(L,J,M,T.J(0),Y);if(-1===Y)return y.a.instance.Ua(573089741,1,2,"Error diffing table {0}",T.J(0).toString()),-1;N+=Y}}W=new F.a(this.iB,this._state);if(0<K.length&&0<O.length){K=W.uZh(K,ba=>L.sk.J(ba),O,ba=>J(ba));if(-1===K)return y.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",P.toString()),-1;N+=K}else if(0<K.length)for(P=0;P<K.length;P++)N+=this.iB.getPropertyString(K.J(P),f.a.vo).length+1;else if(0<O.length)for(P=0;P<O.length;P++)N+=this.iB.getPropertyString(O.J(P),
f.a.vo).length+1;for(P=0;P<V.count;P++)if(K=V.keys.J(P),!M.contains(K)){O=this.VTd(V.J(K));if(-1===O)return y.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",K.toString()),-1;N+=O}return N}sfm(L,J,M){let P=0;J=this.iB.getPropertyObjectIds(J,f.a.$e);for(let O=0;O<J.length;O++){var N=L(J.J(O));N=this.iB.getPropertyObjectIds(N,f.a.XK);if(1!==N.length)return y.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;var K=L(N.J(0));if(393230===K.Nc)P+=this.iB.getPropertyString(K,
f.a.vo).length+1;else if(393250===K.Nc){K=this.VTd(K);if(-1===K)return y.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",N.J(0).toString()),-1;P+=K;M.add(N.J(0))}}return P}VTd(L){this._state.runtime.YG("GetTextLengthOfTable");let J=0;const M=V=>this._state.runtime.Kq.J(V)||this._state.runtime.sk.J(V);L=this.iB.getPropertyObjectIds(L,f.a.$e);for(let V=0;V<L.length;V++){var P=M(L.J(V));P=this.iB.getPropertyObjectIds(P,f.a.$e);for(let W=0;W<P.length;W++){var N=M(P.J(W));N=this.iB.getPropertyObjectIds(N,
f.a.$e);for(let T=0;T<N.length;T++){var K=M(N.J(T));K=this.iB.getPropertyObjectIds(K,f.a.XK);if(1!==K.length)return y.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",K.length),-1;var O=M(K.J(0));if(393230===O.Nc)J+=this.iB.getPropertyString(O,f.a.vo).length+1;else if(393250===O.Nc){O=this.VTd(O);if(-1===O)return y.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",K.J(0)),-1;J+=O}}}}return J}XCl(L,J,M,P){const N=new a.a;for(let K=0;K<L.length;K++){let O=
!1;J.Kq.J(L.J(K))&&(O=!0);const V=M(L.J(K)),W=this.iB.getPropertyObjectIds(V,f.a.$e);if(!O)for(let T=0;T<W.length;T++)if(J.Kq.J(W.J(T))){O=!0;break}O?N.add(L.J(K),V):P.add(L.J(K))}return N}mRh(L,J){return this.lRh(L.QAb,L.grb,J)}lRh(L,J,M){const P=new k.a;for(var N=0;N<L.length;N++)P.add(this._state.runtime.sk.J(L.J(N)));L=new k.a;for(N=0;N<J.length;N++)L.add(this._state.runtime.Kq.J(J.J(N))||this._state.runtime.sk.J(J.J(N)));return M.uZh(P,K=>this._state.runtime.sk.J(K),L,K=>this._state.runtime.Kq.J(K)||
this._state.runtime.sk.J(K))}xjf(L,J,M,P){if(393227===L.Nc){L=this.iB.getPropertyObjectIds(L,f.a.$e);for(let N=0;N<L.length;N++){const K=this.iB.getPropertyObjectIds(J(L.J(N)),f.a.$e);for(let O=0;O<K.length;O++){const V=this.iB.getPropertyObjectIds(J(K.J(O)),f.a.$e);for(let W=0;W<V.length;W++){const T=this.iB.getPropertyObjectIds(J(V.J(W)),f.a.XK);if(1!==T.length)return;const Y=J(T.J(0));393230===Y.Nc?M.add(T.J(0)):393250===Y.Nc?P.add(T.J(0)):y.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+
l.a[Y.Nc])}}}}}yjf(L,J){L=this.iB.getPropertyObjectIds(L,f.a.$e);const M=new k.a;for(let P=0;P<L.length;P++){const N=this.iB.getPropertyObjectIds(J(L.J(P)),f.a.XK);if(1!==N.length)return null;M.add(N.J(0))}return M}aQl(){let L=0;const J=this._state.runtime,M=J.Kq,P=K=>J.Kq.J(K)||J.sk.J(K);let N=null;J.YG=K=>{if(750<this.VEa()-this._state.input.oUa)throw y.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",K),m.a.invalidOperation(K);};try{M.forEach((K,O)=>{if(1074135127===
O.Nc){K=this.yjf(O,P);var V=J.sk.J(O.id);if(V)V=this.yjf(V,T=>J.sk.J(T)),N||(N=new F.a(this.iB,this._state)),L+=this.lRh(V,K,N);else for(V=0;V<K.length;V++)L+=this.iB.getPropertyString(J.Kq.J(K.J(V)),f.a.vo).length+1}if(1074135126===O.Nc&&(K=this.iB.getPropertyObjectIds(O,f.a.$e).ZG(),O=J.sk.J(O.id)))for(O=this.iB.getPropertyObjectIds(O,f.a.$e),V=0;V<O.length;V++)if(!K.contains(O.J(V))){var W=J.sk.J(O.J(V));W=this.yjf(W,T=>J.sk.J(T));for(let T=0;T<W.length;T++)L+=this.iB.getPropertyString(J.sk.J(W.J(T)),
f.a.vo).length+1}return!0})}catch(K){return y.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+K.toString()),-1}return L}BFb(){return this.RWa?this.RWa.BFb():null}GQd(L){const J=new k.a;L.forEach(M=>{J.add(H.wVa(M.BFb()));return!0});return J.toArray()}w2l(){const L=new a.a;L.Z("Succeeded",this._state.output.succeeded);L.Z("Timeout",this._state.output.timeout);L.Z("Crash",this._state.output.crash);L.Z("MergedRevisions",this._state.output.ZM?this._state.output.ZM.length:-1);L.Z("Duration",
this.ps-this._state.input.oUa);return L}static wVa(L){if(!L)return null;const J={};L.forEach((M,P)=>{J[M.toString()]=P;return!0});return J}}Object(D.a)(H,"MergeLogger",null,[])},1790:function(D,I,c){D=c(0);var l=c(247),f=c(16),a=c(6),k=c(117),x=c(811),y=c(179),m=c(224),r=c(365),z=c(1498);class v{constructor(H,L,J){this.position=H;this.leader=L;this.val=J}equals(H){return this.position===H.position&&this.leader===H.leader&&this.val===H.val}toString(){return this.position.toString()}}Object(D.a)(v,
"TabStop",null,[]);var G=c(1886);c.d(I,"a",function(){return F});class F extends z.a{constructor(){super()}get Sn(){return 20}get wA(){return 0}uk(){const H=super.uk();H.Z(x.a.Ab(f.a.vo),1);H.Z(x.a.Ab(f.a.Ln),1);H.Z(x.a.Ab(f.a.Dm),1);H.Z(x.a.Ab(a.a.kt),1);H.Z(x.a.Ab(a.a.rq),1);H.Z(x.a.Ab(a.a.Wc),1);H.Z(x.a.Ab(f.a.dqb),1);H.Z(x.a.Ab(a.a.UPa),1);H.Z(x.a.Ab(a.a.CHa),1);H.Z(x.a.Ab(f.a.aya),1);H.Z(x.a.Ab(a.a.NFa),1);H.Z(x.a.Ab(a.a.Sga),1);H.Z(x.a.Ab(a.a.OFa),1);H.Z(x.a.Ab(a.a.hEa),1);H.Z(x.a.Ab(a.a.PFa),
1);H.Z(x.a.Ab(a.a.iEa),1);H.Z(x.a.Ab(a.a.BHa),1);H.Z(x.a.Ab(a.a.dJa),1);H.Z(x.a.Ab(a.a.eJa),1);H.Z(x.a.Ab(a.a.Qza),1);H.Z(x.a.Ab(a.a.Hv),1);H.Z(x.a.Ab(a.a.Mz),1);H.Z(x.a.Ab(a.a.Nz),1);H.Z(x.a.Ab(a.a.yw),1);H.Z(x.a.Ab(k.a.MJ),6);H.Z(x.a.Ab(k.a.tVa),6);H.Z(x.a.Ab(a.a.QBb),7);H.Z(x.a.Ab(k.a.MJ),6);H.Z(x.a.Ab(a.a.msj),2);H.Z(x.a.Ab(k.a.o3k),2);H.Z(x.a.Ab(k.a.vxn),2);H.Z(x.a.Ab(a.a.snc),2);H.Z(x.a.Ab(a.a.xbd),2);H.Z(x.a.Ab(a.a.RRb),2);H.Z(x.a.Ab(a.a.A8a),2);H.Z(x.a.Ab(a.a.ybd),2);H.Z(x.a.Ab(a.a.zbd),2);
H.Z(x.a.Ab(a.a.wLf),2);H.Z(x.a.Ab(a.a.listID),3);H.Z(x.a.Ab(a.a.listLevel),3);return H}mC(H,L){if(L===x.a.Ab(f.a.vo)||L===x.a.Ab(f.a.Ln)||L===x.a.Ab(f.a.Dm)||L===x.a.Ab(a.a.kt)||L===x.a.Ab(a.a.rq)||L===x.a.Ab(a.a.Wc)||L===x.a.Ab(f.a.dqb)||L===x.a.Ab(a.a.UPa)||L===x.a.Ab(a.a.CHa)||L===x.a.Ab(f.a.aya)||L===x.a.Ab(a.a.NFa)||L===x.a.Ab(a.a.Sga)||L===x.a.Ab(a.a.OFa)||L===x.a.Ab(a.a.hEa)||L===x.a.Ab(a.a.PFa)||L===x.a.Ab(a.a.iEa)||L===x.a.Ab(a.a.BHa)||L===x.a.Ab(a.a.dJa)||L===x.a.Ab(a.a.eJa)||L===x.a.Ab(a.a.Qza)||
L===x.a.Ab(a.a.Hv)||L===x.a.Ab(a.a.zN)){var J=H.An.value.su,M=H.An.value.tf;L=H.Jg.value.tf;if(H.pq.runtime.WNa.contains(J.id))return y.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",J.id),!0;if(H.pq.runtime.Zb.gjb(1000005)&&this.axo(H,L,M))return H.Xk=L.UK(),F.xnh(H),F.aBd(H.pq,H.Vd,M),!0;const P=new m.a;P.add(J);J=new m.a;J.add(M);M=new m.a;M.add(L);if(!({qn:L}=F.mBj(H.pq,P,M,J)).returnValue)return H.zqg=
!0,H.Xk=null,!1;F.xnh(H);H.Xk=L.Zf(0).zm;return!0}return L===x.a.Ab(a.a.Mz)||L===x.a.Ab(a.a.Nz)||L===x.a.Ab(a.a.yw)?(this.iMo(H),H.mg.add(x.a.Ab(a.a.Mz)),H.mg.add(x.a.Ab(a.a.Nz)),H.mg.add(x.a.Ab(a.a.yw)),!0):!1}axo(H,L,J){L=H.Vd.getPropertyString(L,a.a.zN);H=H.Vd.getPropertyString(J,a.a.zN);return L||H?!0:!1}iMo(H){const L=H.Vd,J=H.Xk;var M=H.An.value.tf,P=H.Jg.value.tf;H=this.Bof(H.An.value.su,L);P=this.Bof(P,L);M=this.Bof(M,L);({Nan:M,Oan:H,Qan:P}=this.y2l(H,P,M));M.length?(L.setPropertyUint32s(J,
a.a.yw,M),L.setPropertyUint32s(J,a.a.Mz,H),L.setPropertyUint32s(J,a.a.Nz,P)):this.mXn(J)}Bof(H,L){const J=L.getPropertyUint32s(H,a.a.yw),M=L.getPropertyUint32s(H,a.a.Mz);H=L.getPropertyUint32s(H,a.a.Nz);L=new m.a;if(!J)return L;for(let P=0;P<J.length;++P)L.add(new v(J.J(P),M.J(P),H.J(P)));return L}y2l(H,L,J){({vYi:L,wYi:K,xYi:N}=this.Y6h(H,L));let M,P;({vYi:J,wYi:M,xYi:P}=this.Y6h(H,J));H=this.cmm(H,K,N,M,P);var N=this.bmm(H,L,J);H=new m.a;L=new m.a;var K=new m.a;for(J=0;J<N.length;++J)H.add(N.J(J).position),
L.add(N.J(J).leader),K.add(N.J(J).val);return{Nan:H,Oan:L,Qan:K}}Y6h(H,L){let J,M,P;J=new m.a;M=new r.a;P=new r.a;let N,K;for(N=K=0;N<H.length&&K<L.length;)H.J(N).position===L.J(K).position?(H.J(N).equals(L.J(K))||P.Z(H.J(N).position,L.J(K)),++N,++K):H.J(N).position<L.J(K).position?(M.Z(H.J(N).position,H.J(N)),++N):(J.add(L.J(K)),++K);for(;N<H.length;)M.Z(H.J(N).position,H.J(N)),++N;for(;K<L.length;)J.add(L.J(K)),++K;return{vYi:J,wYi:M,xYi:P}}cmm(H,L,J,M,P){const N=new m.a;for(let K=0;K<H.length;++K){const O=
H.J(K).position;L.nb(O)||(J.nb(O)?N.add(J.J(O)):M.nb(O)||(P.nb(O)?N.add(P.J(O)):N.add(H.J(K))))}return N}bmm(H,L,J){L=this.jNi(L,J);return this.jNi(H,L)}jNi(H,L){const J=new m.a;let M,P;for(M=P=0;M<H.length&&P<L.length;)H.J(M).position<=L.J(P).position?(J.add(H.J(M)),H.J(M).position===L.J(P).position&&++P,++M):J.add(L.J(P++));for(;M<H.length;)J.add(H.J(M++));for(;P<L.length;)J.add(L.J(P++));return J}mXn(H){H.removeProperty(a.a.yw);H.removeProperty(a.a.Mz);H.removeProperty(a.a.Nz)}static ih(){return new F}static get instance(){return F.Ng.value}static xnh(H){H.mg.add(x.a.Ab(f.a.vo));
H.mg.add(x.a.Ab(f.a.Ln));H.mg.add(x.a.Ab(f.a.Dm));H.mg.add(x.a.Ab(a.a.kt));H.mg.add(x.a.Ab(a.a.rq));H.mg.add(x.a.Ab(a.a.Wc));H.mg.add(x.a.Ab(f.a.dqb));H.mg.add(x.a.Ab(a.a.UPa));H.mg.add(x.a.Ab(a.a.CHa));H.mg.add(x.a.Ab(f.a.aya));H.mg.add(x.a.Ab(a.a.NFa));H.mg.add(x.a.Ab(a.a.Sga));H.mg.add(x.a.Ab(a.a.OFa));H.mg.add(x.a.Ab(a.a.hEa));H.mg.add(x.a.Ab(a.a.PFa));H.mg.add(x.a.Ab(a.a.iEa));H.mg.add(x.a.Ab(a.a.BHa));H.mg.add(x.a.Ab(a.a.dJa));H.mg.add(x.a.Ab(a.a.eJa));H.mg.add(x.a.Ab(a.a.Qza));H.mg.add(x.a.Ab(a.a.Hv));
H.mg.add(x.a.Ab(a.a.zN))}static mBj(H,L,J,M){return(new G.a(H,L,J,M)).Dnc()}static aBd(H,L,J){J=L.getPropertyObjectIds(J,f.a.Ln);for(let P=0;P<J.length;P++){var M=H.runtime.Kq.J(J.Zf(P));if(M&&(M=L.getPropertyObjectId(M,a.a.ke))){H.runtime.Elc.add(M);break}}}}F.Ng=new l.a(F.ih);Object(D.a)(F,"ParagraphNodeComplexMerge",z.a,[])},1791:function(D,I,c){D=c(0);var l=c(75),f=c(1506),a=c(1637),k=c(1554),x=c(1524),y=c(1571),m=c(1508),r=c(1511),z=c(1510),v=c(1504),G=c(1503);class F{constructor(Y){this.fc=
Y;this.bxd=this.Ktf()}lL(){return"Add-ins"}rU(){return 0===this.fc.fv?0:1===this.fc.fv?1:3}ZH(Y,ba){Y=new z.a(Y);ba.resultsUpdated(Y)}ojb(Y,ba,Z){let ea;ea=this.fc.PP?new r.a(29):new r.a(27);ea.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;Z&&this.Cvo(Y.Cg,ba,ea)}Cvo(Y,ba,Z){const ea=[];let ha;ha=this.fc.rFm?this.fc.PP&&this.fc.Geb?G.a.iib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):
this.fc.sFm?this.fc.PP&&this.fc.Geb?G.a.iib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.fc.PP&&this.fc.Geb?G.a.iib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,Y);this.fc.Pwa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ha)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
Y))):(ea.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ha)),ea.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(ea));Z.Rw(new m.a("LaunchAddinDialogFromTellMe",29));ba.$u(Z)}Ktf(){const Y=[];this.fc.YXd&&Array.add(Y,"Addin");return Y}}Object(D.a)(F,"AddinStoreResultsProvider",null,[1117]);var H=c(1738),L=c(1543),J=c(1555),M=c(1739),P=c(1777),N=c(1740),K=c(1570),O=c(2),V=c(34),W=c(135);c.d(I,"a",function(){return T});class T{constructor(Y,
ba,Z){this.sdb=this.DCc=this.ECc=this.iwd=!1;this.wQ=null;this.B2=-1;this.hZa=this.vDc=this.Vfa=this.$yb=null;this.i3g=this.r3g=0;this.fc=Y;const ea=G.a.xpa();this.uab=ba||[];this.Wf=O.AFrameworkApplication.He;this.cfh=Y.$Xf;this.FCc=Y.ZXf;this.gwd=ea&&this.tQb();this.hwd=ea&&this.uQb();this.efh=ea&&this.vQb();this.kwd=this.xQb();this.QRe=this.dlc();if((ba=Y.Fig&&G.a.Beg(Y))||Y.Yga)this.$yb=new P.a(Y),this.iwd=Y.Gad;ba&&(this.ECc=Y.Iad,this.DCc=Y.olb,this.sdb=this.iwd&&this.jx("File")||this.ECc&&
this.jx("People")||this.DCc&&this.jx("Notes"));this.fwd=this.uro();this.HCc=Y.R1c;this.jwd=this.Oro();this.PRe=this.tro();this.K_b=this.Ghe();this.baa=this.kfm();this.DKg=new H.a(Y);this.K4j=new M.a(Y);this.pkk=new N.a(Y);this.xTj=new F(Y);this.vBc=Z;this.yyb=new a.a;this.HCc&&(this.DKg=new H.a(Y));Y.Yga&&(this.PRe=this.jwd=this.HCc=this.sdb=this.DCc=this.ECc=this.QRe=this.kwd=this.efh=this.hwd=this.gwd=this.FCc=!1,O.AFrameworkApplication.K&&this.jx("File")&&this.Gpj()||this.K_b)&&(Y=this.yyb.uuf("Search",
O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.jNc(Y,"TellMeService",!0),Y=this.yyb.uuf("SmartLookup",O.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")),this.jNc(Y,"Shredder",!1));O.AFrameworkApplication.K&&this.sdb&&this.jx("File")&&this.Gpj()&&(Y=this.yyb.uuf("Search",O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.jNc(Y,"TellMeService",!0))}jx(Y){return Array.contains(this.uab,Y)?!0:!1}lL(){return"TellMeService"}rU(){return 0===
this.fc.fv?0:1===this.fc.fv?1:this.jx("Command")||this.jx("Recommended")?2:3}hfm(Y){let ba="";if(!Y&&this.jx("Command")&&this.fc.$Ef){ba+="CommandSearch_DLIS,";var Z=this.fc.Wwj;0<Z.length&&(ba+=Z+",")}Y&&this.jx("Recommended")&&this.FCc&&(Z=this.ojm(),0<Z.length&&(ba+=Z+","));!Y&&this.jx("Help")&&(Y=this.fc.Vwj,0<Y.length&&(ba+=Y+","));this.fc.Yga&&this.hZa&&0<this.hZa.length&&(ba+="IsRecallEnabled_true,");(this.fc.DLd||this.fc.Yga)&&this.sdb&&(ba+="IsGenerateSlidesEnabled_true,");0<ba.length&&(ba=
ba.substr(0,ba.length-1));return ba}jNc(Y,ba,Z){const ea=Z?this.r3g:this.i3g;if(!ea||window.performance.now()-ea>=G.a.v8a)if(Y)Z?this.r3g=window.performance.now():this.i3g=window.performance.now(),Y.then(ha=>{Z?this.vDc=ha:(this.hZa=ha,v.TellMeActor.instance.xgg=ha)},ha=>{v.TellMeActor.instance.Le.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"tellMeServiceToken promise rejected: "+ha)});else if(v.TellMeActor.instance.Le)v.TellMeActor.instance.Le.onError("TellMeServiceProvider:FetchTokenForService_"+
ba,"undefined token promise")}ZH(Y,ba,Z,ea=f.a.tellMe,ha=null){const la=new z.a(Y);Z=G.a.BR(Y);this.jx("File")&&(this.sdb||this.fc.Yga)&&this.jNc(this.yyb.lfm(),"TellMeService",!0);(this.jx("File")&&this.fc.Yga||this.jx("ActionAI")&&this.K_b)&&this.jNc(this.yyb.jcm(),"Shredder",!1);var ia=this.sdb&&!!this.vDc;const sa=this.fc.Yga&&!!this.hZa;var Oa=ia||sa||Z&&this.jx("Recommended")&&this.FCc;ia=ia||sa||!Z&&(this.cfh&&this.jx("Command")||this.gwd&&this.jx("Answer")||this.hwd&&this.jx("Definition")||
this.QRe&&this.jx("Image")||this.HCc&&this.jx("Help")||this.kwd&&this.jx("WolframAnswer")||this.jwd&&this.jx("Template")||this.PRe&&this.jx("Addin"));if(Oa||ia)if(this.Vfa=ea,ea={"Content-Type":"application/json",Accept:"application/json"},ea["X-Office-Version"]=O.AFrameworkApplication.buildVersion,ea["X-Office-Application"]=O.AFrameworkApplication.K.kb("Application"),ea["X-Office-Platform"]="WAC",ea["X-TellMe-SqmUserId"]=O.AFrameworkApplication.K.kb("LoggableUserId")||"",ea["X-TellMe-SessionId"]=
v.TellMeActor.instance.STd(),this.vDc&&(ea.Authorization="Bearer "+this.vDc),this.hZa&&0<this.hZa.length&&(ea["X-TellMe-ShredderToken"]="Bearer "+this.hZa),Oa=this.hfm(Z),0<Oa.length&&(ea["X-TellMe-Flights"]=Oa),Oa=[],!Z&&this.jx("Answer")&&this.gwd&&(ha?Array.contains(ha,9):1)&&Array.add(Oa,"Answer"),!Z&&this.jx("Command")&&this.cfh&&!L.CommandResultsUtility.vCf(Y.Cg)&&(ha?Array.contains(ha,17):1)&&Array.add(Oa,"Command"),!Z&&this.jx("Definition")&&this.hwd&&(ha?Array.contains(ha,10):1)&&Array.add(Oa,
"Definition"),!Z&&this.jx("Help")&&this.HCc&&(ha?Array.contains(ha,8):1)&&Array.add(Oa,"Help"),!Z&&this.jx("WolframAnswer")&&this.kwd&&(ha?Array.contains(ha,12):1)&&Array.add(Oa,"WolframAnswer"),Z&&this.jx("Recommended")&&this.FCc&&!v.TellMeActor.instance.$cd&&(ha?Array.contains(ha,18):1)&&Array.add(Oa,"Recommended"),!Z&&this.jx("Image")&&this.QRe&&(ha?Array.contains(ha,19):1)&&Array.add(Oa,"Image"),this.vDc&&this.sdb&&(ha?Array.contains(ha,14)||Array.contains(ha,15)||Array.contains(ha,20):1)&&(this.$yb.R6a(),
this.iwd&&this.jx("File")&&Array.add(Oa,"File"),this.ECc&&this.jx("People")&&Array.add(Oa,"People"),this.DCc&&this.jx("Notes")&&Array.add(Oa,"Notes")),this.hZa&&0<this.hZa.length&&this.fc.Yga&&(ha?Array.contains(ha,15):1)&&(this.$yb.R6a(),this.jx("File")&&Array.add(Oa,"File")),!Z&&this.jx("Template")&&this.jwd&&(ha?Array.contains(ha,23):1)&&Array.add(Oa,"Template"),!Z&&this.jx("Addin")&&this.PRe&&(ha?Array.contains(ha,27):1)&&Array.add(Oa,"Addin"),!Z&&this.jx("ActionAI")&&this.K_b&&(ha?Array.contains(ha,
25):1)&&Array.add(Oa,"ActionAI"),Oa.length){ea["X-TellMe-SuggestionTypes"]=Oa.join(",");ea["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;ea["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;var Ra=this.wQ=W.a.create().toString();ea["Client-Request-Id"]=Ra;var Na=window.performance.now();this.vDa();this.B2=window.setTimeout(()=>{if(Ra===this.wQ){this.wQ="";this.B2=-1;ba.resultsUpdated(la);const Da={};Da[k.a.provider]=this.lL();Da[k.a.LNb]=Y.kob;v.TellMeActor.instance.Le.OA(x.a.timedOut,
this.vBc,Da)}},this.vBc);this.Wf.sj(this.baa,2,this.jfm(Y.Cg),ea,!1,0,Da=>{this.qMb(Da,Y,ba,Ra,Na,ha)},Da=>{this.ZLb(Da,Y,ba,Ra,Na)},null,null,!1,4E3,this.K_b?3E4:6E3)}else v.TellMeActor.instance.Le.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ba.resultsUpdated(la);else ba.resultsUpdated(la)}vDa(){-1!==this.B2&&(window.clearTimeout(this.B2),this.B2=-1)}qMb(Y,ba,Z,ea,ha,la){const ia=new z.a(ba);if(ea===this.wQ){this.vDa();v.TellMeActor.instance.Le.M9(ba.Cg.length,
this.uab.join(","),Y.data.Qe.toString(),Math.round(window.performance.now()-ha),K.a.tellMe,!0,y.a.lQa);ea=Y.data.se;Y=null;try{Y=V.b(ea)}catch(ra){v.TellMeActor.instance.Le.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ra);return}ea=G.a.BR(ba);if("Groups"in Y&&Y.Groups){var sa=Y.Groups;for(var Oa of sa)if("GroupType"in Oa&&"Suggestions"in Oa&&Oa.Suggestions)if("Commands"===Oa.GroupType&&(la?Array.contains(la,17):1)||"Recommended"===Oa.GroupType&&(la?Array.contains(la,
18):1)){var Ra=(sa="Recommended"===Oa.GroupType)?"DLIS":"NaiveBayes";"Source"in Oa&&Oa.Source&&(Ra=Oa.Source);var Na=Oa.Suggestions;new l.a;var Da=[];for(const ra of Na)this.DUm(ra)&&(Na=ra.Type,("Command"===Na||sa&&"Recommended"===Na)&&Da.push(new J.a(ra.CommandId,ra.Score)));L.CommandResultsUtility.m2d(Da,!ba.Cg.trim().length,Oa.GroupType,Ra);Ra=v.TellMeActor.instance.g3;Na=[];for(const ra of Da)sa&&Ra&&Ra.d9e(ra.commandId)||Na.push(ra);Da=L.CommandResultsUtility.WQc(ba,Na,this.fc,null,null,null,
sa?18:17,0);0<Da.results.length&&(this.Vfa!==f.a.contextMenu&&(Da.displayName=sa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ia.$u(Da))}else if("Answer"===Oa.GroupType){Na=Oa.Suggestions;sa=null;Da=2147483647;Ra="";for(const ra of Na)if(this.CUm(ra))if(Ra=ra.Type,Na=this.ZSd(Ra),"Answer"===Ra&&this.gwd){sa=this.bMh(Ra,ra,ba.Cg);break}else Na&&Na<Da&&(Da=Na,sa=this.bMh(Ra,ra,ba.Cg));Da=G.a.z5n(ba.Cg,Ra);sa&&(la?Array.contains(la,sa.type):1)&&(Ra=[],this.fwd?
this.fc.Pwa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa.value,sa.fD)),v.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(sa.value,sa.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(sa.value,Da))):(Ra.push(appChrome.actions.setControlLabel(sa.value,sa.fD)),Ra.push(appChrome.actions.updateCompoundButtonDescription(sa.value,sa.description)),Ra.push(appChrome.actions.setCompoundButtonCommandValueId(sa.value,
Da)),appChrome.api.dispatch(Ra)):this.fc.Pwa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa.value,sa.fD+" - "+sa.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(sa.value,Da))):(Ra.push(appChrome.actions.setControlLabel(sa.value,sa.fD+" - "+sa.description)),Ra.push(appChrome.actions.setButtonCommandValueId(sa.value,Da)),appChrome.api.dispatch(Ra)),Da=this.Ecl(sa.type),Da.Rw(sa),ia.$u(Da))}else"Help"===Oa.GroupType&&Oa.Suggestions.length&&
(la?Array.contains(la,8):1)?this.HCc&&(sa=this.DKg.ojb(ba,Oa.Suggestions))&&0<sa.results.length&&ia.$u(sa):"Template"===Oa.GroupType&&(la?Array.contains(la,23):1)?(sa=Oa.Suggestions)&&0<sa.length&&this.pkk.ojb(ba,ia,sa):"Addin"===Oa.GroupType&&(la?Array.contains(la,27):1)?(sa=Oa.Suggestions)&&0<sa.length&&this.xTj.ojb(ba,ia,sa):"ActionAI"===Oa.GroupType&&(la?Array.contains(la,25):1)?(Da=Oa.Suggestions,sa=[],new r.a(25),Da&&1===Da.length&&(Ra=Da[0])&&Ra.CommandId&&(Da=Ra.CommandId,sa.push(new J.a(Da,
"Score"in Ra?Ra.Score:0)),sa=L.CommandResultsUtility.WQc(ba,sa,this.fc,null,null,null,25,0),sa.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ia.$u(sa))):"Substrate"===Oa.GroupType&&this.sdb&&"Type"in Oa?"File"===Oa.Type&&this.iwd&&(la?Array.contains(la,15):1)?(sa=this.$yb.qpf(Oa.Suggestions,ea,this.Vfa))&&0<sa.results.length&&(this.qZd()&&(Da=new m.a("GenerateSlidesFromTellMe",30,"",null,1),sa.Rw(Da)),ia.$u(sa)):"People"===Oa.Type&&this.ECc&&(la?Array.contains(la,14):1)?(sa=this.$yb.edi(Oa.Suggestions,
ea,this.Vfa))&&0<sa.results.length&&ia.$u(sa):"Notes"===Oa.Type&&this.DCc&&(la?Array.contains(la,14):1)&&(sa=this.$yb.Mbi(Oa.Suggestions,ea,ba))&&0<sa.results.length&&ia.$u(sa):"Recall"===Oa.GroupType&&this.fc.Yga&&"Type"in Oa&&"IntentService"===Oa.Type&&(la?Array.contains(la,15):1)&&(sa=this.$yb.qpf(Oa.Suggestions,ea,this.Vfa))&&0<sa.results.length&&(this.qZd()&&(Da=new m.a("GenerateSlidesFromTellMe",30,"",null,1),sa.Rw(Da)),ia.$u(sa));else v.TellMeActor.instance.Le.onError("OnSuccessCallBack","GroupType"in
Oa?"Invalid group suggestions found for "+Oa.GroupType:"Invalid group found")}if(Y.Intents){Oa=Y.Intents;for(const ra of Oa)this.yHf(ra)&&("Image"===ra.GroupType&&ra.ConfidenceScore>ra.ConfidenceThreshold&&(la?Array.contains(la,19):1)?this.K4j.ojb(ba,ia,0,ra):"Commands"===ra.GroupType&&ra.ConfidenceScore<ra.ConfidenceThreshold&&(la?Array.contains(la,17):1)&&(Oa=new r.a(17),ia.$u(Oa)))}Z.resultsUpdated(ia);v.TellMeActor.instance.Le.M9(ba.Cg.length,this.uab.join(","),"",Math.round(window.performance.now()-
ha),"",!0,y.a.provider)}}ZLb(Y,ba,Z,ea,ha){const la=new z.a(ba);ea===this.wQ&&(this.vDa(),v.TellMeActor.instance.Le.M9(ba.Cg.length,this.uab.join(","),Y.data.Qe.toString(),Math.round(window.performance.now()-ha),K.a.tellMe,!1,y.a.lQa));Z.resultsUpdated(la)}ZSd(Y){switch(Y){case "Entity":return this.efh?3:0;case "Definition":return this.hwd?5:0;case "WolframAnswer":return this.kwd?2:0;default:return 0}}bMh(Y,ba,Z){switch(Y){case "Answer":return new m.a(this.fwd?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ba.Title?Z:ba.Title,ba.Description,0);case "Entity":return new m.a(this.fwd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ba.Title?Z:ba.Title,ba.Description,0);case "Definition":return new m.a(this.fwd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ba.Title?Z:ba.Title,ba.Description,0);case "WolframAnswer":return new m.a("WolframForSearch",3,""===ba.Title?Z:ba.Title,ba.Description,0);default:return null}}Ecl(Y){switch(Y){case 0:return new r.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new r.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new r.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new r.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new r.a(19,this.fc.Zkc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}CUm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}DUm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&
""!==Y.CommandId&&"Score"in Y&&!!Y.Score}yHf(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in Y)return!0;v.TellMeActor.instance.Le.onError("IsValidIntentGroup","Invalid intents found");return!1}jfm(Y){const ba=G.a.uBi(Y),Z={};Z.Query=Y;ba&&this.FCc&&(this.vOm()?Z.UserActionEvents=v.TellMeActor.instance.Ijh:(Z.CommandClickedEvents=v.TellMeActor.instance.yve,Z.CommandActionEvents=v.TellMeActor.instance.TNg),Z.TellMeCommandClickMruEvents=v.TellMeActor.instance.o6g,Z.ContentType=
v.TellMeActor.instance.aJd);this.jwd&&(Y={},Y.Application=this.fc.application,Z.TemplateInfo=Y);return V.c(Z)}tQb(){return!!this.fc&&this.fc.tQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Lb.tQb}uQb(){return!!this.fc&&this.fc.uQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Lb.uQb}vQb(){return!!this.fc&&this.fc.vQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Lb.vQb}xQb(){return!!this.fc&&this.fc.xQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Lb.xQb}dlc(){return!!this.fc&&
(this.fc.dlc||this.fc.PP)}uro(){return!!this.fc&&!this.fc.x4a}Oro(){return!!this.fc&&this.fc.JXc}tro(){return!!this.fc&&this.fc.tFm&&this.fc.qFm}Ghe(){return!!this.fc&&this.fc.Ghe}eCi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}fCi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}vOm(){return!!O.AFrameworkApplication.K&&
O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}qZd(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Gpj(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}ojm(){return O.AFrameworkApplication.K?O.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",
""):""}kfm(){if(!O.AFrameworkApplication.K)return"";if(this.fCi())return O.AFrameworkApplication.K.kb("TellMeServiceProdEndpointForSearch");if(this.eCi())return O.AFrameworkApplication.K.kb("TellMeServiceEdogEndpointForSearch");if(G.a.cDf())return O.AFrameworkApplication.K.kb("TellMeServiceIntEndpointForSearch");let Y=O.AFrameworkApplication.K.kb("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=O.AFrameworkApplication.Uwj);return Y}static EMh(Y,ba){if(ba)return new T(Y,["Command","Recommended"],Y.xVl);
ba=G.a.xpa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new T(Y,ba,Y.Sfi)}}Object(D.a)(T,"TellMeServiceProvider",null,[1117])},1885:function(D,I,c){c.r(I);c.d(I,"MarkerValidation",function(){return a});D=c(0);var l=c(365),f=c(1789);class a{constructor(){this.CXd=this.Gsi=this.Fsi=this.Esi=0}o7h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.Esi);k.Z("InvalidComments",
this.Fsi);k.Z("InvalidContentControls",this.Gsi);0!==this.CXd&&k.Z("InvalidMarkerType",this.CXd);return k}Vli(){return 0<this.Esi||0<this.Fsi||0<this.Gsi||0!==this.CXd?!0:!1}toString(){return JSON.stringify(f.a.wVa(this.o7h()))}}Object(D.a)(a,"MarkerValidation",null,[])},1886:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(179),f=c(1051),a=c(237),k=c(1653),x=c(1575);class y{constructor(m,r,z,v,G=null,F=null,H=null,L=null){this.Yd=m;this.LF=r;this.fBa=z;this.xCa=v;this.n$j=G;this.N0j=
F;this.Hlk=H;this.Nsa=L||this.K$e()}K$e(){return m=>!!this.Yd.runtime.Zb&&this.Yd.runtime.Zb.isFeatureEnabled(m)}r9k(){return()=>this.Yd.runtime.Zb}vff(){return!!this.Yd.runtime.sk.J(a.a.ML)}Gsj(){let m;if(1===this.Yd.input.source||2===this.Yd.input.source)m=82;else if(4===this.Yd.input.source||3===this.Yd.input.source)m=41;else if(5===this.Yd.input.source)m=120;else return!1;return this.vff()&&this.Nsa(m)}Juj(m,...r){return String.format.apply(null,[m].concat(r))}xSd(m){const {ParagraphMerge:r}=
c(1980);let z=this.Yd,v=this.fBa,G=this.xCa;m||(z=this.n$j||this.Yd,v=this.N0j||v,G=this.Hlk||G);var F=x.a.drf(this.LF);const H=x.a.drf(v),L=x.a.drf(G);F=this.Juj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",z.input.source,z.runtime.DDa.id,z.runtime.cNd,z.runtime.Nme,F.fr(),H.fr(),L.fr());return m?{returnValue:new k.a(z,this.LF,v,G,this.K$e(),new f.a),fr:F}:{returnValue:new r(z,this.LF,
v,G,this.K$e(),this.r9k(),new f.a),fr:F}}Dnc(){this.Yd.logger.ljo();var m=this.Gsj();var r=({fr:v}=this.xSd(m)).returnValue;l.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",m,v);this.Yd.logger.OU("ParagraphMergeSelector initialization");m?this.Yd.logger.uge(1):this.Yd.logger.uge(2);let z=({qn:r}=r.Dnc()).returnValue;this.Yd.logger.Hcg();var v=!z;m=!!this.Yd.runtime.sk.J(a.a.ML)&&(m&&!z||!m);v&&({fr:v,returnValue:r}=this.xSd(!1),{qn:r,returnValue:z}=r.Dnc(),l.a.instance.Ua(18994390,
1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,v));m&&(v=new f.a,x.a.p4n(this.Yd,v));this.Yd.logger.OU("ParagraphMergeSelector finalization");return{returnValue:z,qn:r}}qcd(m,r){let z,v,G;const F=this.Gsj()&&this.Nsa(121);let H=({fr:G}=this.xSd(F)).returnValue,L=({U6a:z,Sqa:v}=H.qcd(m,r)).returnValue;l.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,G);F&&!L&&H.A9f&&({fr:G,returnValue:H}=this.xSd(!1),{U6a:z,Sqa:v,
returnValue:L}=H.qcd(m,r),l.a.instance.Ua(18994392,1,L?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",L,G));return{returnValue:L,U6a:z,Sqa:v}}}Object(D.a)(y,"ParagraphMergeSelector",null,[1805])},1887:function(D,I,c){c.r(I);c.d(I,"SurfaceStringTokenStringGenerator",function(){return f});D=c(0);var l=c(1606);class f extends l.a{constructor(a){super(a);this.Cb=a}apply(a,k,x,y,m,r,z){null==r&&(r=a.Shi(m,k));z=l.a.Doh(a,r,this.Cb.score,x,y,z);return{hbd:r,
$Gc:z}}}f.aHc=0;Object(D.a)(f,"SurfaceStringTokenStringGenerator",l.a,[])},1888:function(D,I,c){c.r(I);c.d(I,"QueryTokenStringGenerator",function(){return a});D=c(0);var l=c(1606),f=c(1499);class a extends l.a{constructor(k){super(k);this.Cb=k}apply(k,x,y,m,r,z,v){x=this.Cb.query.load(x,null);r=0;let G=null;this.Cb.query.x5===f.Annotations.Rza?x&&(G=this.Cb.name):((G=this.Cb.name)&&(G+="_"),G+=this.Cb.annotations.zea(this.Cb.query.x5,x));null!=G&&(r=l.a.Doh(k,G,this.Cb.score,y,m,r));return{hbd:z,
$Gc:v+r}}}a.aHc=1;Object(D.a)(a,"QueryTokenStringGenerator",l.a,[])},1889:function(D,I,c){c.r(I);c.d(I,"FuzzyMatchTokenStringGenerator",function(){return f});D=c(0);var l=c(1606);class f extends l.a{constructor(a){super(a);this.Cb=a}apply(a,k,x,y,m,r,z){null==r&&(r=a.Shi(m,k));a=this.Cb.MWh.o6m(r);if(this.Cb.PXi)for(var v of a)if(!v.QO&&v.RNd)return{hbd:r,$Gc:z};v=0;for(const G of a)if(G.QO&&!({P4e:v}=this.Hth(G,!0,x,y,v)).returnValue)return{hbd:r,$Gc:z};if(this.Cb.lpi)for(const G of a)if(!({P4e:v}=
this.Hth(G,!1,x,y,v)).returnValue)break;return{hbd:r,$Gc:z}}Hth(a,k,x,y,m){let r;k?(k=0,r=a.RNd?1:0):(k=a.RNd?1:0,r=a.count-k);for(let z=0;z<r;++z)if(l.a.Eoh(a.Lhb+k+z,this.Cb.score,x,y),++m,0<this.Cb.SNf&&m>=this.Cb.SNf)return{returnValue:!1,P4e:m};return{returnValue:!0,P4e:m}}}f.aHc=2;Object(D.a)(f,"FuzzyMatchTokenStringGenerator",l.a,[])},1970:function(D,I,c){D=c(0);var l=c(6),f=c(46),a=c(247),k=c(1498);class x extends k.a{constructor(){super()}get Sn(){return 2}get wA(){return 7}static ih(){return new x}static get instance(){return x.Ng.value}}
x.Ng=new a.a(x.ih);Object(D.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(16),m=c(811),r=c(179),z=c(1542);class v extends k.a{constructor(){super()}get Sn(){return 3}get wA(){return 7}uk(){const cb=super.uk();cb.Z(m.a.Ab(y.a.KR),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(y.a.KR)){const Cb=cb.Xk;var mc=cb.Vd;r.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.id,Cb.Nc,Mb);Mb=mc.getPropertyMilliseconds(cb.Jg.value.tf,y.a.KR);
mc=mc.getPropertyMilliseconds(cb.An.value.tf,y.a.KR);Mb<mc&&this.BQl(cb);cb.mg.add(m.a.Ab(y.a.KR));return!0}r.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}BQl(cb){this.m1n(cb.An.value.tf,cb.Xk);this.Unf(cb,l.a.F0e);this.Unf(cb,l.a.Krh);this.Unf(cb,l.a.yrh)}Unf(cb,Mb){var mc=cb.Vd,Cb=cb.Xk;if(mc.hasProperty(Cb,Mb)&&(Mb=mc.getPropertyObjectIds(Cb,Mb))&&Mb.length)for(mc=cb.pq.runtime.Kq,
cb=cb.pq.runtime.qn,Cb=0;Cb<Mb.length;Cb++){const Ja=Mb.J(Cb);if(!mc.nb(Ja))continue;const Wa=mc.J(Ja).UK();cb.add(Ja,new z.a(Wa,!1))}}static ih(){return new v}static get instance(){return v.Ng.value}}v.Ng=new a.a(v.ih);Object(D.a)(v,"AppNodeComplexMerge",k.a,[]);class G extends k.a{constructor(){super()}get Sn(){return 4}get wA(){return 7}static ih(){return new G}static get instance(){return G.Ng.value}}G.Ng=new a.a(G.ih);Object(D.a)(G,"AppPropNodeComplexMerge",k.a,[]);class F extends k.a{constructor(){super()}get Sn(){return 5}get wA(){return 7}static ih(){return new F}static get instance(){return F.Ng.value}}
F.Ng=new a.a(F.ih);Object(D.a)(F,"AppRefNodeComplexMerge",k.a,[]);var H=c(365),L=c(608),J=c(224),M=c(19);class P{constructor(cb,Mb){this.id=cb;this.zzo=Mb}}Object(D.a)(P,"IdAndTime",null,[]);class N extends k.a{constructor(){super()}get Sn(){return 6}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.h_a),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.h_a)){const mc=cb.Xk,Cb=cb.Vd;r.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,
mc.Nc,Mb);Mb=Cb.getPropertyObjectIds(cb.Jg.value.su,l.a.h_a);const Ja=Cb.getPropertyObjectIds(cb.Jg.value.tf,l.a.h_a),Wa=Cb.getPropertyObjectIds(cb.An.value.tf,l.a.h_a);Mb=this.J$m(cb,Mb,Ja,Wa);0<Mb.length?Cb.setPropertyObjectIds(mc,l.a.h_a,Mb):mc.removeProperty(l.a.h_a);cb.mg.add(m.a.Ab(l.a.h_a));return!0}r.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}J$m(cb,Mb,mc,Cb){const Ja=
this.MGa(Mb,mc,Cb),Wa=Mb.ZG(),xb=mc.ZG(),ic=Cb.ZG();Mb=k.a.filter(Ja,Ac=>!Wa.contains(Ac)&&xb.contains(Ac));mc=k.a.filter(Ja,Ac=>!Wa.contains(Ac)&&ic.contains(Ac));if(!Mb.length||!mc.length)return Ja;const qc=new H.a;Mb.forEach(Ac=>{const gd=new P(Ac,this.S3h(cb,Ac,!1));this.O3h(cb,Ac,!1).forEach(Md=>{qc.add(Md,gd);return!0});return!0});const Lc=new L.a;mc.forEach(Ac=>{const gd=this.S3h(cb,Ac,!0);this.O3h(cb,Ac,!0).forEach(Md=>qc.nb(Md)?(Lc.add(qc.J(Md).zzo>=gd?Ac:qc.J(Md).id),!1):!0);return!0});
return k.a.filter(Ja,Ac=>!Lc.contains(Ac))}S3h(cb,Mb,mc){return(Mb=this.Iha(cb,Mb,mc))?cb.Vd.getPropertyMilliseconds(Mb,y.a.KR):0}Iha(cb,Mb,mc){cb=mc?cb.pq.runtime.Kq:cb.pq.runtime.Ku;return cb.nb(Mb)?cb.J(Mb):null}O3h(cb,Mb,mc){const Cb=new J.a,Ja=new L.a,Wa=cb.Vd;Mb=this.Iha(cb,Mb,mc);var xb=this.pei(Wa,Mb);if(xb)for(Cb.add(xb),Ja.add(xb),Mb=Wa.getPropertyObjectIds(Mb,l.a.F0e),xb=0;Mb&&xb<Mb.length;xb++){const ic=this.pei(Wa,this.Iha(cb,Mb.J(xb),mc));if(!ic)break;Ja.contains(ic)||(Cb.add(ic),Ja.add(ic))}return Cb}pei(cb,
Mb){if(!cb.hasProperty(Mb,l.a.Aeb)||!cb.hasProperty(Mb,l.a.A2b)||!cb.hasProperty(Mb,l.a.B2b))return null;const mc=cb.getPropertyString(Mb,l.a.Aeb),Cb=cb.getPropertyString(Mb,l.a.A2b);cb=cb.getPropertyString(Mb,l.a.B2b);return M.a.ZA(mc+";"+Cb+";"+cb)}static ih(){return new N}static get instance(){return N.Ng.value}}N.Ng=new a.a(N.ih);Object(D.a)(N,"AppsNodeComplexMerge",k.a,[]);class K extends k.a{constructor(){super()}get Sn(){return 36}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.Wng),1);cb.Z(m.a.Ab(l.a.Vcg),
1);return cb}mC(cb,Mb){r.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Mb);if(Mb===m.a.Ab(l.a.Wng)||Mb===m.a.Ab(l.a.Vcg)){const Wa=m.a.KX(Mb);var mc=cb.Jg.value.tf,Cb=cb.An.value.tf;const xb=cb.Xk;var Ja=cb.Vd.getPropertyStrings(cb.Jg.value.su,Wa);mc=cb.Vd.getPropertyStrings(mc,Wa);Cb=cb.Vd.getPropertyStrings(Cb,Wa);Ja=this.MGa(Ja,mc,Cb);cb.Vd.setPropertyStrings(xb,Wa,Ja);cb.mg.add(Mb);return!0}return!1}static ih(){return new K}static get instance(){return K.Ng.value}}
K.Ng=new a.a(K.ih);Object(D.a)(K,"AutoSaveParametersNodeComplexMerge",k.a,[]);class O extends k.a{constructor(){super()}get Sn(){return 44}uk(){const cb=super.uk();cb.Z(m.a.Ab(y.a.$e),1);return cb}mC(cb,Mb){const mc=cb.pq.runtime.Zb;if(Mb===m.a.Ab(y.a.$e))return r.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",cb.Xk.id,cb.Xk.Nc,Mb),mc.Tx(125),mc.isFeatureEnabled(125)?this.M$m(cb,Mb):this.gan(cb,Mb),!0;r.a.instance.Ua(589608912,
1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}M$m(cb,Mb){const mc=m.a.KX(Mb),Cb=cb.Vd;var Ja=Cb.getPropertyObjectIds(cb.Jg.value.su,mc),Wa=Cb.getPropertyObjectIds(cb.Jg.value.tf,mc),xb=Cb.getPropertyObjectIds(cb.An.value.tf,mc);xb=O.chm(cb,Wa,xb);Ja=this.MGa(Ja,Wa,xb);Wa=cb.Xk;0<Ja.length?Cb.setPropertyObjectIds(Wa,mc,Ja):Wa.removeProperty(mc);cb.mg.add(Mb)}static ih(){return new O}static get instance(){return O.Ng.value}static chm(cb,
Mb,mc){const Cb=new J.a,Ja=new H.a;Mb.forEach(Wa=>{const xb=cb.pq.runtime.Ku.J(Wa);xb&&Ja.add(xb.VX(l.a.zt).toString(),Wa);return!0});mc.forEach(Wa=>{var xb=cb.pq.runtime.Kq.J(Wa);xb?(xb=xb.VX(l.a.zt).toString(),Ja.nb(xb)&&Ja.get(xb)!==Wa?r.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):Cb.add(Wa)):Cb.add(Wa);return!0});return Cb}}O.Ng=new a.a(O.ih);Object(D.a)(O,"BookmarkContainerNodeComplexMerge",k.a,
[]);class V extends k.a{constructor(){super()}get Sn(){return 41}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.bBb),1);cb.Z(m.a.Ab(l.a.zt),1);return cb}mC(cb,Mb){return Mb===m.a.Ab(l.a.bBb)?(cb.mg.add(m.a.Ab(l.a.bBb)),!0):Mb===m.a.Ab(l.a.zt)?(cb.mg.add(m.a.Ab(l.a.zt)),!0):!1}Xe(cb){return cb&&cb.length?!1:!0}static ih(){return new V}static get instance(){return V.Ng.value}}V.Ng=new a.a(V.ih);Object(D.a)(V,"BookmarkNodeComplexMerge",k.a,[]);class W extends k.a{constructor(){super();this.vYd=!1}get Sn(){return 7}uk(){const cb=
super.uk();cb.Z(m.a.Ab(y.a.$e),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(y.a.$e)){const Ja=cb.Xk,Wa=cb.Vd;var mc=cb.pq.runtime.Zb;mc&&(this.vYd=mc.isFeatureEnabled(76));r.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ja.id,Ja.Nc,Mb);Mb=Wa.getPropertyObjectIds(cb.Jg.value.su,y.a.$e);mc=Wa.getPropertyObjectIds(cb.Jg.value.tf,y.a.$e);var Cb=Wa.getPropertyObjectIds(cb.An.value.tf,y.a.$e);Mb=this.V$m(Mb,mc,Cb);if(this.vYd&&
0<Mb.length){mc=new Sys.StringBuilder;for(Cb=0;Cb<Mb.length;Cb++)mc.append(Mb.J(Cb).toString()+",");r.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Ja.id,mc.toString())}0<Mb.length?Wa.setPropertyObjectIds(Ja,y.a.$e,Mb):Ja.removeProperty(y.a.$e);cb.mg.add(m.a.Ab(y.a.$e));return!0}r.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}V$m(cb,
Mb,mc){const Cb=new J.a,Ja=new H.a(0);this.BAl(cb,mc,Cb,Ja);return this.Zkl(Mb,Ja,Cb)}BAl(cb,Mb,mc,Cb){cb=cb||new J.a;Mb=Mb||new J.a;cb.forEach(Ja=>{Cb.Z(Ja,1);return!0});Mb.forEach(Ja=>{Cb.Fc(Ja).returnValue?Cb.Z(Ja,2):(Cb.Z(Ja,0),mc.add(Ja));return!0})}Zkl(cb,Mb,mc){cb=cb||new J.a;const Cb=new J.a,Ja=new J.a,Wa=new J.a;cb.forEach(xb=>{let ic=!0,qc;({value:qc}=Mb.Fc(xb)).returnValue&&(0===qc?Mb.Z(xb,2):1===qc&&(ic=!1));ic?Cb.add(xb):this.vYd&&Ja.add(xb);return!0});mc.forEach(xb=>{let ic=!1,qc;({value:qc}=
Mb.Fc(xb)).returnValue?0===qc&&(ic=!0,Mb.Z(xb,2)):r.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",xb);ic?Cb.add(xb):this.vYd&&Wa.add(xb);return!0});this.DJi(Ja,"Favored");this.DJi(Wa,"Unfavored");return Cb}DJi(cb,Mb){if(cb.length){var mc=new Sys.StringBuilder;for(let Cb=0;Cb<cb.length;Cb++)mc.append(cb.J(Cb).toString()+",");r.a.instance.Ua(561637572,1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",
Mb,mc.toString())}}static ih(){return new W}static get instance(){return W.Ng.value}}W.Ng=new a.a(W.ih);Object(D.a)(W,"CommentContentNodeComplexMerge",k.a,[]);var T=c(69),Y=c(34);class ba extends k.a{constructor(){super();this.Jgh=[1];this.GOe=new H.a}get Sn(){return 8}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.Gba),3);cb.Z(m.a.Ab(l.a.cF),3);cb.Z(m.a.Ab(l.a.AIc),2);cb.Z(m.a.Ab(l.a.commentId),2);cb.Z(m.a.Ab(l.a.EFh),2);cb.Z(m.a.Ab(l.a.ADa),2);cb.Z(m.a.Ab(l.a.hOa),1);cb.Z(m.a.Ab(l.a.vjb),1);cb.Z(m.a.Ab(l.a.ukb),
1);cb.Z(m.a.Ab(l.a.RQ),1);cb.Z(m.a.Ab(l.a.LG),1);cb.Z(m.a.Ab(l.a.zIc),2);cb.Z(m.a.Ab(l.a.cGd),2);cb.Z(m.a.Ab(l.a.t4b),2);cb.Z(m.a.Ab(l.a.k8e),2);cb.Z(m.a.Ab(l.a.wM),1);cb.Z(m.a.Ab(y.a.$e),0);cb.Z(m.a.Ab(l.a.EH),0);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.wM)){var mc=cb.Vd.getPropertyString(cb.An.value.tf,l.a.wM);this.Xe(mc)?cb.Xk.removeProperty(l.a.wM):cb.Xk.RTa(l.a.wM,mc);return!0}if(Mb!==m.a.Ab(l.a.hOa)&&Mb!==m.a.Ab(l.a.vjb)&&Mb!==m.a.Ab(l.a.ukb)&&Mb!==m.a.Ab(l.a.LG)&&Mb!==m.a.Ab(l.a.RQ))return!1;
var Cb=cb.Jg.value.su;const Ja=cb.Jg.value.tf;var Wa=cb.An.value.tf;mc=cb.Xk;if(Mb===m.a.Ab(l.a.hOa)){Cb=cb.Vd.getPropertyString(Ja,l.a.hOa);Wa=cb.Vd.getPropertyString(Wa,l.a.hOa);Wa=this.Xe(Cb)?Wa:this.Xe(Wa)?Cb:null;if(this.Xe(Wa))return!0;cb.Vd.setPropertyString(mc,l.a.hOa,Wa);cb.mg.add(m.a.Ab(l.a.hOa));return!0}if(Mb===m.a.Ab(l.a.ukb))return Cb=cb.Vd.getPropertyBool(Ja,l.a.ukb),Wa=cb.Vd.getPropertyBool(Wa,l.a.ukb),Cb=null!=Cb?Cb:!1,Cb=(null!=Wa?Wa:!1)||Cb,cb.Vd.setPropertyBool(mc,l.a.ukb,Cb),
cb.mg.add(m.a.Ab(l.a.ukb)),!0;if(Mb===m.a.Ab(l.a.vjb)){Cb=cb.Vd.getPropertyBool(Ja,l.a.vjb);Wa=cb.Vd.getPropertyBool(Wa,l.a.vjb);if(Cb===Wa)return!0;Cb=null!=Cb?Cb:!1;Cb=(null!=Wa?Wa:!1)||Cb;cb.Vd.setPropertyBool(mc,l.a.vjb,Cb);return!0}if(Mb===m.a.Ab(l.a.LG)){Cb=cb.Vd.getPropertyBool(Ja,l.a.LG);Wa=cb.Vd.getPropertyBool(Wa,l.a.LG);if(Cb===Wa)return!0;Cb=null!=Cb?Cb:!1;Cb=(null!=Wa?Wa:!1)||Cb;cb.Vd.setPropertyBool(mc,l.a.LG,Cb);cb.mg.add(m.a.Ab(l.a.LG));return!0}if(Mb===m.a.Ab(l.a.RQ)){Mb=cb.pq.runtime.Zb;
Mb.Tx(14);if(Mb.isFeatureEnabled(14))return this.z0k(cb,Cb,Ja,Wa,mc);Cb=cb.Vd.getPropertyString(Ja,l.a.RQ);Wa=cb.Vd.getPropertyString(Wa,l.a.RQ);if(Cb===Wa)return!0;cb.Vd.setPropertyString(mc,l.a.RQ,Wa||Cb);cb.mg.add(m.a.Ab(l.a.RQ));return!0}return!1}z0k(cb,Mb,mc,Cb,Ja){mc=cb.Vd.getPropertyString(mc,l.a.RQ);Cb=cb.Vd.getPropertyString(Cb,l.a.RQ);if(mc===Cb)return!0;Mb=cb.Vd.getPropertyString(Mb,l.a.RQ);const Wa={};for(let ic=0;ic<this.Jgh.length;ic++){const qc=this.Jgh[ic];var xb=this.wsf(Mb,qc,0);
const Lc=this.wsf(mc,qc,1),Ac=this.wsf(Cb,qc,2);xb=this.oan(xb,Lc,Ac);Wa[qc.toString()]=xb.toArray()}cb.Vd.setPropertyString(Ja,l.a.RQ,this.Uco(Wa));cb.mg.add(m.a.Ab(l.a.RQ));return!0}oan(cb,Mb,mc){const Cb=new H.a,Ja=new H.a(0);for(var Wa=0;Wa<Mb.length;Wa++){const ic=Mb[Wa].UserId;Cb.add(ic,Mb[Wa]);Ja.add(ic,0)}for(Mb=0;Mb<mc.length;Mb++)Wa=mc[Mb].UserId,Ja.nb(Wa)?Ja.Z(Wa,2):(Cb.add(Wa,mc[Mb]),Ja.add(Wa,0));for(mc=0;mc<cb.length;mc++)Mb=cb[mc].UserId,Ja.nb(Mb)&&2!==Ja.J(Mb)&&Ja.Z(Mb,1);const xb=
new J.a;Ja.forEach((ic,qc)=>{if(1===qc)return!0;xb.add(Cb.J(ic));return!0});return xb}wsf(cb,Mb,mc){cb=Object(T.a)(Object,this.R9l(cb,mc));return Mb.toString()in cb?Array.isArray(cb[Mb.toString()])?cb[Mb.toString()]:null:[]}R9l(cb,Mb){if(this.GOe.nb(Mb))return Object(T.a)(Object,this.GOe.J(Mb));cb=Object(T.a)(Object,this.Mjl(cb));this.GOe.add(Mb,cb);return cb}Mjl(cb){return Object(T.a)(Object,Y.b(cb))}Uco(cb){return Y.c(cb)}Xe(cb){return cb&&cb.length?!1:!0}static ih(){return new ba}static get instance(){return ba.Ng.value}}
ba.Ng=new a.a(ba.ih);Object(D.a)(ba,"CommentNodeComplexMerge",k.a,[]);class Z extends k.a{constructor(){super()}get Sn(){return 46}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.contentControlNode),1);cb.Z(m.a.Ab(y.a.lastModifiedTime),0);cb.Z(m.a.Ab(l.a.$Ic),2);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.contentControlNode))return r.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",cb.Xk.id,cb.Xk.Nc,Mb),k.a.hOf(cb,
this,l.a.contentControlNode);r.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}static ih(){return new Z}static get instance(){return Z.Ng.value}}Z.Ng=new a.a(Z.ih);Object(D.a)(Z,"ContentControlContainerNodeComplexMerge",k.a,[]);var ea=c(60),ha=c(1778);class la extends k.a{constructor(){super()}get Sn(){return 37}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.k8),
1);cb.Z(m.a.Ab(l.a.Sqb),1);cb.Z(m.a.Ab(l.a.bHd),2);cb.Z(m.a.Ab(l.a.jCb),2);cb.Z(m.a.Ab(l.a.contentControlNode),1);cb.Z(m.a.Ab(l.a.k9),1);cb.Z(m.a.Ab(l.a.Ega),1);cb.Z(m.a.Ab(l.a.S4b),1);cb.Z(m.a.Ab(l.a.Vfb),1);cb.Z(m.a.Ab(l.a.Tfb),1);cb.Z(m.a.Ab(l.a.Sfb),1);cb.Z(m.a.Ab(l.a.oOa),2);cb.Z(m.a.Ab(l.a.mCb),1);cb.Z(m.a.Ab(l.a.cHd),1);cb.Z(m.a.Ab(l.a.j8),1);this.Zb.isFeatureEnabled(30)&&(cb.Z(m.a.Ab(l.a.CU),2),cb.Z(m.a.Ab(l.a.Iva),2),cb.Z(m.a.Ab(l.a.Dna),2),cb.Z(m.a.Ab(l.a.H4),1),cb.Z(m.a.Ab(l.a.bpa),1),
cb.Z(m.a.Ab(l.a.cpa),1));return cb}mC(cb,Mb){var mc=cb.Jg.value.tf,Cb=cb.An.value.tf;const Ja=cb.Xk;if(Mb===m.a.Ab(l.a.contentControlNode))return k.a.hOf(cb,this,l.a.contentControlNode);if(Mb===m.a.Ab(l.a.k9)){Mb=cb.Vd.getPropertyBool(mc,l.a.k9);Cb=cb.Vd.getPropertyBool(Cb,l.a.k9);if(null!=Mb&&Mb||null!=Cb&&Cb)cb.Vd.setPropertyBool(Ja,l.a.k9,!0),cb.mg.add(m.a.Ab(l.a.k9));return!0}if(Mb===m.a.Ab(l.a.Ega))return Mb=cb.Vd.getPropertyBool(mc,l.a.Ega),Cb=cb.Vd.getPropertyBool(Cb,l.a.Ega),cb.Vd.setPropertyBool(Ja,
l.a.Ega,null!=Mb&&!!Mb&&null!=Cb&&!!Cb),cb.mg.add(m.a.Ab(l.a.Ega)),!0;if(Mb===m.a.Ab(l.a.S4b))return Mb=cb.Vd.getPropertyUint32(Cb,l.a.S4b),null!=Mb&&(cb.Vd.setPropertyUint32(Ja,l.a.S4b,Mb),cb.mg.add(m.a.Ab(l.a.S4b))),!0;if(Mb===m.a.Ab(l.a.Vfb)||Mb===m.a.Ab(l.a.Tfb)||Mb===m.a.Ab(l.a.Sfb))return(Cb=cb.Vd.getPropertyString(Cb,m.a.KX(Mb)))&&0<Cb.length&&(cb.Vd.setPropertyString(Ja,m.a.KX(Mb),Cb),cb.mg.add(Mb)),!0;if(Mb===m.a.Ab(l.a.mCb)||Mb===m.a.Ab(l.a.cHd)){mc=cb.Vd.getPropertyObjectId(mc,m.a.KX(Mb));
if(ha.a.j9b(cb.pq,mc))return!0;if((Cb=cb.Vd.getPropertyObjectId(Cb,m.a.KX(Mb)))&&Cb!==ea.a.nil)return cb.Vd.setPropertyObjectId(Ja,m.a.KX(Mb),Cb),cb.mg.add(Mb),!0;Ja.removeProperty(m.a.KX(Mb));cb.mg.add(Mb);return!0}if(Mb===m.a.Ab(l.a.j8)){mc=cb.Vd.getPropertyObjectId(mc,l.a.j8);if((mc=ha.a.j9b(cb.pq,mc))&&cb.Vd.getPropertyObjectIds(mc,l.a.contentControlNode).ZG().contains(cb.Xk.id))return!0;Cb=cb.Vd.getPropertyObjectId(Cb,l.a.j8);return(mc=ha.a.j9b(cb.pq,Cb))&&cb.Vd.getPropertyObjectIds(mc,l.a.contentControlNode).ZG().contains(cb.Xk.id)?
(cb.Vd.setPropertyObjectId(Ja,l.a.j8,Cb),cb.mg.add(Mb),!0):!1}if(Mb===m.a.Ab(l.a.k8))return Mb=cb.Vd.getPropertyBool(Cb,l.a.k8),null==Mb||Mb||(cb.Vd.setPropertyBool(Ja,l.a.k8,!1),cb.mg.add(m.a.Ab(l.a.k8))),!0;if(Mb===m.a.Ab(l.a.Sqb)){Mb=cb.Vd.getPropertyObjectId(mc,l.a.Sqb);Cb=cb.Vd.getPropertyObjectId(Cb,l.a.Sqb);if(Mb&&!Mb.equals(Cb))return!1;if(Mb=Mb||Cb)cb.Vd.setPropertyObjectId(Ja,l.a.Sqb,Mb),cb.mg.add(m.a.Ab(l.a.Sqb));return!0}!this.Zb.isFeatureEnabled(30)||Mb!==m.a.Ab(l.a.H4)&&Mb!==m.a.Ab(l.a.bpa)&&
Mb!==m.a.Ab(l.a.cpa)||r.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Mb);return!1}static ih(){return new la}static get instance(){return la.Ng.value}}la.Ng=new a.a(la.ih);Object(D.a)(la,"ContentControlNodeComplexMerge",k.a,[]);class ia extends k.a{constructor(){super()}get Sn(){return 10}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.customXmlPartNode),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.customXmlPartNode)){Mb=
cb.Xk;const Cb=cb.Vd;var mc=Cb.getPropertyObjectIds(cb.Jg.value.su,l.a.customXmlPartNode);const Ja=Cb.getPropertyObjectIds(cb.Jg.value.tf,l.a.customXmlPartNode),Wa=Cb.getPropertyObjectIds(cb.An.value.tf,l.a.customXmlPartNode);mc=this.Z$m(mc,Ja,Wa);0<mc.length?Cb.setPropertyObjectIds(Mb,l.a.customXmlPartNode,mc):Mb.removeProperty(l.a.customXmlPartNode);cb.mg.add(m.a.Ab(l.a.customXmlPartNode));return!0}return!1}Z$m(cb,Mb,mc){return this.MGa(cb,Mb,mc)}static ih(){return new ia}static get instance(){return ia.Ng.value}}
ia.Ng=new a.a(ia.ih);Object(D.a)(ia,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class sa extends k.a{constructor(){super()}get Sn(){return 9}get wA(){return 0}static ih(){return new sa}static get instance(){return sa.Ng.value}}sa.Ng=new a.a(sa.ih);Object(D.a)(sa,"CustomXmlPartNodeComplexMerge",k.a,[]);class Oa extends k.a{constructor(){super()}get Sn(){return 29}get wA(){return 3}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.embeddedFontNode),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.embeddedFontNode)){Mb=
cb.Vd;var mc=Mb.getPropertyObjectIds(cb.Jg.value.su,l.a.embeddedFontNode),Cb=Mb.getPropertyObjectIds(cb.Jg.value.tf,l.a.embeddedFontNode);const Ja=Mb.getPropertyObjectIds(cb.An.value.tf,l.a.embeddedFontNode);mc=this.MGa(mc,Cb,Ja);Cb=cb.Xk;0<mc.length?Mb.setPropertyObjectIds(Cb,l.a.embeddedFontNode,mc):Cb.removeProperty(l.a.embeddedFontNode);cb.mg.add(m.a.Ab(l.a.embeddedFontNode));return!0}return!1}static ih(){return new Oa}static get instance(){return Oa.Ng.value}}Oa.Ng=new a.a(Oa.ih);Object(D.a)(Oa,
"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class Ra extends k.a{constructor(){super()}get Sn(){return 30}get wA(){return 3}static ih(){return new Ra}static get instance(){return Ra.Ng.value}}Ra.Ng=new a.a(Ra.ih);Object(D.a)(Ra,"EmbeddedFontNodeComplexMerge",k.a,[]);class Na extends k.a{constructor(){super()}get Sn(){return 11}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.m4),4);cb.Z(m.a.Ab(l.a.B1a),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.B1a)){const mc=cb.Xk,Cb=cb.Vd;r.a.instance.Ua(4063307,1,4,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.Nc,Mb);Mb=Cb.getPropertyObjectIds(cb.Jg.value.su,l.a.B1a);const Ja=Cb.getPropertyObjectIds(cb.Jg.value.tf,l.a.B1a),Wa=Cb.getPropertyObjectIds(cb.An.value.tf,l.a.B1a);Mb=this.hNi(Mb,Ja,Wa,(xb,ic)=>xb.equals(ic));0<Mb.length?Cb.setPropertyObjectIds(mc,l.a.B1a,Mb):mc.removeProperty(l.a.B1a);cb.mg.add(m.a.Ab(l.a.B1a));return!0}r.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
cb.Jg.value.tf.id,Mb);return!1}static ih(){return new Na}static get instance(){return Na.Ng.value}}Na.Ng=new a.a(Na.ih);Object(D.a)(Na,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class Da extends k.a{constructor(){super()}get Sn(){return 12}get wA(){return 3}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.eoa),1);return cb}mC(cb,Mb){const mc=cb.Xk,Cb=cb.Vd;if(Mb===m.a.Ab(l.a.eoa)){let Ja=-1;r.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
mc.id,mc.Nc,Mb);const Wa=Cb.getPropertyInt32(cb.Jg.value.tf,l.a.eoa),xb=Cb.getPropertyInt32(cb.An.value.tf,l.a.eoa);null!=Wa&&-1!==Wa?Ja=Wa:null!=xb&&(Ja=xb);Cb.setPropertyInt32(mc,l.a.eoa,Ja);cb.mg.add(Mb);return!0}r.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.su.id,Mb);return!1}static ih(){return new Da}static get instance(){r.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return Da.Ng.value}}Da.Ng=new a.a(Da.ih);Object(D.a)(Da,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class ra extends k.a{constructor(){super()}get Sn(){return 47}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.glossaryPageContentNode),1);return cb}mC(cb,Mb){return Mb===m.a.Ab(l.a.glossaryPageContentNode)?(r.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",cb.Xk.id,cb.Xk.Nc,Mb),k.a.hOf(cb,this,l.a.glossaryPageContentNode)):
!1}static ih(){return new ra}static get instance(){return ra.Ng.value}}ra.Ng=new a.a(ra.ih);Object(D.a)(ra,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class xa extends k.a{constructor(){super()}get Sn(){return 13}get wA(){return 3}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.Fja),4);return cb}static ih(){return new xa}static get instance(){return xa.Ng.value}}xa.Ng=new a.a(xa.ih);Object(D.a)(xa,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class fa extends k.a{constructor(){super()}get Sn(){return 14}get wA(){return 3}uk(){const cb=
super.uk();cb.Z(m.a.Ab(l.a.runId),3);cb.Z(m.a.Ab(l.a.Wc),3);cb.Z(m.a.Ab(l.a.yti),3);cb.Z(m.a.Ab(l.a.yU),1);cb.Z(m.a.Ab(f.a.s0),1);cb.Z(m.a.Ab(y.a.imageAltText),1);cb.Z(m.a.Ab(l.a.kY),1);cb.Z(m.a.Ab(y.a.Fda),1);cb.Z(m.a.Ab(f.a.l9a),1);cb.Z(m.a.Ab(l.a.e_a),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(y.a.imageAltText)||Mb===m.a.Ab(l.a.kY)||Mb===m.a.Ab(l.a.yU)||Mb===m.a.Ab(l.a.lY)||Mb===m.a.Ab(y.a.Gjb)||Mb===m.a.Ab(y.a.Fda)||Mb===m.a.Ab(f.a.s0)||Mb===m.a.Ab(f.a.l9a)||Mb===m.a.Ab(l.a.e_a)){const Cb=cb.Xk;var mc=
cb.Vd;r.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.id,Cb.Nc,Mb);const Ja=mc.getPropertyInt32(cb.Jg.value.tf,f.a.s0);mc=mc.getPropertyInt32(cb.An.value.tf,f.a.s0);if(null!=Ja&&(0===Ja||2===Ja))return!0;if(null!=mc&&(0===mc||2===mc))return Mb=cb.An.value.tf,this.agb(Mb,Cb,y.a.imageAltText),this.agb(Mb,Cb,l.a.kY),this.agb(Mb,Cb,l.a.lY),Mb.hasProperty(l.a.yU)&&this.agb(Mb,Cb,l.a.yU),this.agb(Mb,Cb,y.a.Gjb),this.agb(Mb,
Cb,y.a.Fda),this.agb(Mb,Cb,f.a.s0),this.agb(Mb,Cb,f.a.l9a),cb.mg.add(m.a.Ab(y.a.imageAltText)),cb.mg.add(m.a.Ab(l.a.kY)),cb.mg.add(m.a.Ab(l.a.lY)),cb.mg.add(m.a.Ab(l.a.yU)),cb.mg.add(m.a.Ab(y.a.Gjb)),cb.mg.add(m.a.Ab(y.a.Fda)),cb.mg.add(m.a.Ab(f.a.s0)),cb.mg.add(m.a.Ab(f.a.l9a)),cb.mg.add(m.a.Ab(l.a.e_a)),!0}r.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.su.id,Mb);return!1}static ih(){return new fa}static get instance(){return fa.Ng.value}}
fa.Ng=new a.a(fa.ih);Object(D.a)(fa,"ImageNodeComplexMerge",k.a,[]);class oa extends k.a{constructor(){super()}get Sn(){return 40}get wA(){return 0}static ih(){return new oa}static get instance(){return oa.Ng.value}}oa.Ng=new a.a(oa.ih);Object(D.a)(oa,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class ta extends k.a{constructor(){super()}get Sn(){return 32}get wA(){return 0}static ih(){return new ta}static get instance(){return ta.Ng.value}}ta.Ng=new a.a(ta.ih);Object(D.a)(ta,"IntelligenceContentLocatorNodeComplexMerge",
k.a,[]);class Ka extends k.a{constructor(){super()}get Sn(){return 34}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.ikb),1);return cb}mC(cb,Mb){const mc=cb.Xk,Cb=cb.Vd;if(Mb===m.a.Ab(l.a.ikb)){Mb=Cb.getPropertyObjectIds(cb.Jg.value.su,l.a.ikb);const Ja=Cb.getPropertyObjectIds(cb.Jg.value.tf,l.a.ikb),Wa=Cb.getPropertyObjectIds(cb.An.value.tf,l.a.ikb);Mb=this.MGa(Mb,Ja,Wa);Cb.setPropertyObjectIds(mc,l.a.ikb,Mb);cb.mg.add(m.a.Ab(l.a.ikb));return!0}return!1}static ih(){return new Ka}static get instance(){return Ka.Ng.value}}
Ka.Ng=new a.a(Ka.ih);Object(D.a)(Ka,"IntelligenceRegionNodeComplexMerge",k.a,[]);class va extends k.a{constructor(){super()}get Sn(){return 35}get wA(){return 0}static ih(){return new va}static get instance(){return va.Ng.value}}va.Ng=new a.a(va.ih);Object(D.a)(va,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class La extends k.a{constructor(){super()}get Sn(){return 39}get wA(){return 0}static ih(){return new La}static get instance(){return La.Ng.value}}La.Ng=new a.a(La.ih);Object(D.a)(La,"IntelligenceReviewedNodeComplexMerge",
k.a,[]);class za extends k.a{constructor(){super()}get Sn(){return 33}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.CUc),1);cb.Z(m.a.Ab(l.a.sXd),1);cb.Z(m.a.Ab(l.a.pBf),1);cb.Z(m.a.Ab(l.a.rBf),1);return cb}mC(cb,Mb){const mc=cb.Xk,Cb=cb.Vd;if(Mb===m.a.Ab(l.a.CUc)||Mb===m.a.Ab(l.a.sXd)||Mb===m.a.Ab(l.a.pBf)||Mb===m.a.Ab(l.a.rBf)){Mb=Mb===m.a.Ab(l.a.CUc)?l.a.CUc:l.a.sXd;var Ja=Cb.getPropertyObjectIds(cb.Jg.value.su,Mb);const Wa=Cb.getPropertyObjectIds(cb.Jg.value.tf,Mb),xb=Cb.getPropertyObjectIds(cb.An.value.tf,
Mb);Ja=this.MGa(Ja,Wa,xb);Cb.setPropertyObjectIds(mc,Mb,Ja);cb.mg.add(m.a.Ab(Mb));return!0}return!1}static ih(){return new za}static get instance(){return za.Ng.value}}za.Ng=new a.a(za.ih);Object(D.a)(za,"IntelligenceRootNodeComplexMerge",k.a,[]);class Ca extends k.a{constructor(){super()}get Sn(){return 42}get wA(){return 0}static ih(){return new Ca}static get instance(){return Ca.Ng.value}}Ca.Ng=new a.a(Ca.ih);Object(D.a)(Ca,"IntelligenceSettingNodeComplexMerge",k.a,[]);class ua extends k.a{constructor(){super()}get Sn(){return 45}get wA(){return 0}static ih(){return new ua}static get instance(){return ua.Ng.value}}
ua.Ng=new a.a(ua.ih);Object(D.a)(ua,"IntelligenceWorkflowNodeComplexMerge",k.a,[]);class ib extends k.a{constructor(){super()}get Sn(){return 15}get wA(){return 3}static ih(){return new ib}static get instance(){return ib.Ng.value}}ib.Ng=new a.a(ib.ih);Object(D.a)(ib,"NumberListNodeComplexMerge",k.a,[]);var bb=c(117);class mb extends k.a{constructor(){super()}get Sn(){return 16}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.HAb),1);cb.Z(m.a.Ab(bb.a.s8e),7);cb.Z(m.a.Ab(bb.a.q8e),7);return cb}mC(cb,
Mb){const mc=cb.Xk,Cb=cb.Vd;if(Mb===m.a.Ab(l.a.HAb))return this.fIf(Cb,cb.Jg.value.tf,cb.An.value.tf,mc,l.a.HAb),cb.mg.add(Mb),!0;r.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.su.id,Mb);return!1}static ih(){return new mb}static get instance(){return mb.Ng.value}}mb.Ng=new a.a(mb.ih);Object(D.a)(mb,"OutlineElementNodeComplexMerge",k.a,[]);class yb extends k.a{constructor(){super()}get Sn(){return 17}uk(){const cb=
super.uk();cb.Z(m.a.Ab(l.a.HAb),1);cb.Z(m.a.Ab(l.a.Lna),1);cb.Z(m.a.Ab(bb.a.qJ),1);cb.Z(m.a.Ab(bb.a.fec),1);cb.Z(m.a.Ab(bb.a.Uia),8);return cb}mC(cb,Mb){const mc=cb.Xk,Cb=cb.Vd;if(Mb===m.a.Ab(l.a.HAb))return this.fIf(Cb,cb.Jg.value.tf,cb.An.value.tf,mc,l.a.HAb),cb.mg.add(Mb),!0;if(Mb===m.a.Ab(l.a.Lna)){var Ja=Cb.getPropertyBool(cb.Jg.value.tf,l.a.Lna),Wa=Cb.getPropertyBool(cb.An.value.tf,l.a.Lna);Cb.setPropertyBool(mc,l.a.Lna,null==Ja?!1:Ja&&null==Wa?!1:Wa);cb.mg.add(Mb);return!0}if(Mb===m.a.Ab(bb.a.fec))return this.fIf(Cb,
cb.Jg.value.tf,cb.An.value.tf,mc,bb.a.fec),cb.mg.add(Mb),!0;if(Mb===m.a.Ab(bb.a.qJ))return Ja=Cb.getPropertyBool(cb.Jg.value.tf,bb.a.qJ),Wa=Cb.getPropertyBool(cb.An.value.tf,bb.a.qJ),Cb.setPropertyBool(mc,bb.a.qJ,null==Ja?!0:Ja||null==Wa?!0:Wa),cb.mg.add(Mb),!0;r.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.su.id,Mb);return!1}static ih(){return new yb}static get instance(){return yb.Ng.value}}
yb.Ng=new a.a(yb.ih);Object(D.a)(yb,"OutlineGroupNodeComplexMerge",k.a,[]);var ab=c(41),Ga=c(54);class Za extends k.a{constructor(){super()}get Sn(){return 18}get wA(){return 2}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.kVd),3);cb.Z(m.a.Ab(y.a.YU),this.wA);cb.Z(m.a.Ab(l.a.gt),1);cb.Z(m.a.Ab(l.a.U9),1);cb.Z(m.a.Ab(l.a.oq),1);cb.Z(m.a.Ab(ab.a.rF),1);cb.Z(m.a.Ab(ab.a.fSa),1);return cb}mC(cb,Mb){const mc=cb.Vd;if(cb.pq.runtime.Zb.isFeatureEnabled(73)){if(Mb===m.a.Ab(l.a.gt)||Mb===m.a.Ab(l.a.U9)||Mb===m.a.Ab(ab.a.fSa)||
Mb===m.a.Ab(l.a.oq)||Mb===m.a.Ab(ab.a.rF))return this.ZNo(mc,cb)}else if(Mb===m.a.Ab(l.a.gt)||Mb===m.a.Ab(l.a.oq)){let Cb,Ja;({PIc:Mb,Q3a:Cb,G3a:Ja}=this.B6e(Object(Ga.a)(mc,mc.getPropertyUint32s,"getPropertyUint32s"),cb.Jg.value.su,cb.Jg.value.tf,cb.An.value.tf,l.a.gt,null));if(!Ja&&!Cb)return r.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",cb.Jg.value.tf.id,m.a.Ab(l.a.gt)),!0;let Wa,xb,ic;({PIc:Wa,
Q3a:xb,G3a:ic}=this.B6e(Object(Ga.a)(mc,mc.getPropertyObjectIds,"getPropertyObjectIds"),cb.Jg.value.su,cb.Jg.value.tf,cb.An.value.tf,l.a.oq,null));if(!xb&&!ic)return r.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",cb.Jg.value.tf.id,m.a.Ab(l.a.oq)),!0;const qc=xb&&!ic;if((Cb&&!Ja)!==qc)return r.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
cb.Jg.value.tf.id,m.a.Ab(l.a.gt),m.a.Ab(l.a.oq)),!1;qc&&(mc.setPropertyObjectIds(cb.Xk,l.a.oq,Wa),mc.setPropertyUint32s(cb.Xk,l.a.gt,Mb));r.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",cb.Jg.value.tf.id,m.a.Ab(l.a.gt),Cb,Ja,m.a.Ab(l.a.oq),xb,ic);cb.mg.add(m.a.Ab(l.a.oq));cb.mg.add(m.a.Ab(l.a.gt));
return!0}r.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}zmi(cb,Mb,mc,Cb){let Ja;({PIc:Mb,Q3a:Cb,G3a:Ja}=this.B6e(Mb,mc.Jg.value.su,mc.Jg.value.tf,mc.An.value.tf,cb,Cb));return Ja||Cb?{returnValue:!0,O8e:Mb,Q3a:Cb,G3a:Ja}:(r.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
mc.Jg.value.tf.id.toString(),m.a.Ab(cb)),{returnValue:!1,O8e:Mb,Q3a:Cb,G3a:Ja})}Ali(cb,Mb,mc,Cb,Ja){let Wa;let xb,ic,qc,Lc;({O8e:Wa,Q3a:Ac,G3a:xb,returnValue:qc}=this.zmi(cb,Object(Ga.a)(mc,mc.getPropertyUint32s,"getPropertyUint32s"),Cb,null));({O8e:mc,Q3a:Ja,G3a:ic,returnValue:Lc}=this.zmi(Mb,Object(Ga.a)(mc,mc.getPropertyObjectIds,"getPropertyObjectIds"),Cb,Ja));var Ac=Ac&&!xb;return qc&&Lc?Ac!==(Ja&&!ic)?(r.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Cb.Jg.value.tf.id.toString(),m.a.Ab(cb),m.a.Ab(Mb)),{returnValue:2,LGd:Wa,KGd:mc,Dke:Ac}):{returnValue:0,LGd:Wa,KGd:mc,Dke:Ac}:{returnValue:1,LGd:Wa,KGd:mc,Dke:Ac}}uDf(cb){let Mb=!0;cb.forEach(mc=>mc!==ea.a.nil?Mb=!1:!0);return Mb}oVl(cb,Mb,mc){return this.uDf(cb)&&this.uDf(Mb)&&this.uDf(mc)?!0:!1}ZNo(cb,Mb){let mc,Cb,Ja,Wa,xb,ic;var qc=({LGd:Wa,KGd:xb,Dke:Cb}=this.Ali(ab.a.fSa,l.a.oq,cb,Mb,null)).returnValue;if(2===qc||1===qc)return!0;({LGd:Ja,KGd:ic,Dke:mc,returnValue:qc}=this.Ali(l.a.gt,l.a.U9,
cb,Mb,Object(Ga.a)(this,this.oVl,"getExtendedGuidEquivalence")));if(2===qc||1===qc)return!0;let Lc;({PIc:qc,Q3a:Ac,G3a:Lc}=this.bUk(Object(Ga.a)(cb,cb.getPropertyDictionary,"getPropertyDictionary"),Mb.Jg.value.su,Mb.Jg.value.tf,Mb.An.value.tf,ab.a.rF));if(!Lc&&!Ac)return r.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Mb.Jg.value.tf.id.toString(),m.a.Ab(ab.a.rF)),!0;var Ac=Ac&&!Lc;if(mc!==Cb||mc!==
Ac)return r.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Mb.Jg.value.tf.id.toString(),m.a.Ab(l.a.gt),m.a.Ab(ab.a.fSa),m.a.Ab(ab.a.rF),Cb,mc,Ac),!0;mc&&(cb.setPropertyObjectIds(Mb.Xk,l.a.oq,xb),cb.setPropertyUint32s(Mb.Xk,ab.a.fSa,Wa),cb.setPropertyObjectIds(Mb.Xk,
l.a.U9,ic),cb.setPropertyUint32s(Mb.Xk,l.a.gt,Ja),cb.setPropertyDictionary(Mb.Xk,ab.a.rF,qc));r.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Mb.Jg.value.tf.id.toString(),Cb,mc,Ac);Mb.mg.add(m.a.Ab(ab.a.fSa));Mb.mg.add(m.a.Ab(l.a.oq));Mb.mg.add(m.a.Ab(l.a.gt));Mb.mg.add(m.a.Ab(l.a.U9));Mb.mg.add(m.a.Ab(ab.a.rF));return!0}static ih(){return new Za}static get instance(){return Za.Ng.value}}
Za.Ng=new a.a(Za.ih);Object(D.a)(Za,"PageContentNodeComplexMerge",k.a,[]);class Ub extends k.a{constructor(){super()}get Sn(){return 19}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.qIa),1);cb.Z(m.a.Ab(l.a.appsNode),2);cb.Z(m.a.Ab(l.a.customXmlPartContainerNode),2);cb.Z(m.a.Ab(l.a.intelligenceRootNode),1);return cb}mC(cb,Mb){const mc=cb.Vd;if(Mb===m.a.Ab(l.a.qIa)){var Cb=mc.getPropertyObjectIds(cb.Jg.value.su,l.a.qIa),Ja=mc.getPropertyObjectIds(cb.Jg.value.tf,l.a.qIa),Wa=mc.getPropertyObjectIds(cb.An.value.tf,
l.a.qIa);if((Cb=this.nan(Cb,Ja,Wa,(xb,ic)=>xb.equals(ic),xb=>{let ic;({value:ic}=cb.pq.runtime.Kq.Fc(xb)).returnValue?cb.pq.runtime.qn.Z(xb,new z.a(ic,!1)):r.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},cb.pq))&&0<Cb.length)return mc.setPropertyObjectIds(cb.Xk,l.a.qIa,Cb),cb.mg.add(m.a.Ab(l.a.qIa)),!0}if(Mb===m.a.Ab(l.a.intelligenceRootNode))return Cb=mc.getPropertyObjectIds(cb.Jg.value.su,l.a.intelligenceRootNode),
Ja=mc.getPropertyObjectIds(cb.Jg.value.tf,l.a.intelligenceRootNode),Wa=mc.getPropertyObjectIds(cb.An.value.tf,l.a.intelligenceRootNode),Cb=this.MGa(Cb,Ja,Wa),mc.setPropertyObjectIds(cb.Xk,l.a.intelligenceRootNode,Cb),cb.mg.add(Mb),!0;r.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}static ih(){return new Ub}static get instance(){return Ub.Ng.value}}Ub.Ng=new a.a(Ub.ih);
Object(D.a)(Ub,"PageManifestNodeComplexMerge",k.a,[]);class Xb extends k.a{constructor(){super()}get Sn(){return 43}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.Fma),0);cb.Z(m.a.Ab(l.a.aNb),0);cb.Z(m.a.Ab(l.a.wJb),0);cb.Z(m.a.Ab(l.a.Hoa),1);cb.Z(m.a.Ab(l.a.sessionId),3);cb.Z(m.a.Ab(l.a.buildVersion),3);cb.Z(m.a.Ab(l.a.IR),1);cb.Z(m.a.Ab(l.a.Vwi),1);cb.Z(m.a.Ab(l.a.mv),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(l.a.IR)||Mb===m.a.Ab(l.a.Vwi)||Mb===m.a.Ab(l.a.mv)){var mc=cb.An.value.tf,Cb=cb.Jg.value.tf,Ja=m.a.KX(Mb);
Cb=cb.Vd.getPropertyBool(Cb,Ja);mc=cb.Vd.getPropertyBool(mc,Ja);cb.Vd.setPropertyBool(cb.Xk,Ja,null==Cb?!1:Cb&&null==mc?!1:mc);cb.mg.add(Mb);return!0}if(Mb===m.a.Ab(l.a.Hoa)){Mb=cb.Vd;mc=cb.Jg.value.su;Cb=cb.An.value.tf;Ja=cb.Jg.value.tf;mc=mc?Mb.getPropertyObjectId(mc,l.a.Hoa):null;Cb=Cb?Mb.getPropertyObjectId(Cb,l.a.Hoa):null;Ja=Ja?Mb.getPropertyObjectId(Ja,l.a.Hoa):null;r.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",mc?mc.toString():
"NULL",Cb?Cb.toString():"NULL",Ja?Ja.toString():"NULL");if(Cb){if(Ja&&Cb.equals(Ja))return cb.mg.add(m.a.Ab(l.a.Hoa)),Mb.setPropertyObjectId(cb.Xk,l.a.Hoa,Cb),!0;if(ha.a.CUd.equals(Cb))return cb.mg.add(m.a.Ab(l.a.Hoa)),Mb.setPropertyObjectId(cb.Xk,l.a.Hoa,ha.a.CUd),!0}if(Ja&&ha.a.CUd.equals(Ja))return cb.mg.add(m.a.Ab(l.a.Hoa)),Mb.setPropertyObjectId(cb.Xk,l.a.Hoa,ha.a.CUd),!0;r.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",mc?mc.toString():
"NULL",Cb?Cb.toString():"NULL",Ja?Ja.toString():"NULL")}return!1}static ih(){return new Xb}static get instance(){return Xb.Ng.value}}Xb.Ng=new a.a(Xb.ih);Object(D.a)(Xb,"PageMetadataNodeComplexMerge",k.a,[]);var zb=c(1790),Ib=c(155);class $a extends k.a{constructor(){super()}get Sn(){return 31}uk(){const cb=super.uk();cb.Z(m.a.Ab(Ib.a.LA),1);cb.Z(m.a.Ab(l.a.listID),3);cb.Z(m.a.Ab(l.a.listLevel),1);cb.Z(m.a.Ab(l.a.Ee),3);cb.Z(m.a.Ab(l.a.c3b),3);cb.Z(m.a.Ab(l.a.runId),3);cb.Z(m.a.Ab(l.a.kMd),3);cb.Z(m.a.Ab(y.a.fontColor),
3);cb.Z(m.a.Ab(l.a.EGh),3);cb.Z(m.a.Ab(l.a.Wc),1);cb.Z(m.a.Ab(Ib.a.qYd),3);cb.Z(m.a.Ab(Ib.a.UHf),3);cb.Z(m.a.Ab(Ib.a.iWc),3);cb.Z(m.a.Ab(l.a.bGl),3);cb.Z(m.a.Ab(bb.a.MCj),3);for(let Mb=0;Mb<$a.O4a.length;Mb++)cb.Z($a.O4a[Mb],1);return cb}mC(cb,Mb){var mc=cb.Vd;const Cb=cb.Xk;m.a.KX(Mb);if(Mb===m.a.Ab(l.a.Wc)){mc=cb.Vd.getPropertyInt32(cb.An.value.tf,l.a.Wc);if(null==mc||!mc)return!0;cb.Vd.setPropertyInt32(Cb,l.a.Wc,mc);cb.mg.add(Mb);return!0}if(Mb===m.a.Ab(Ib.a.LA)){const Ja=mc.getPropertyUint32(cb.Jg.value.tf,
Ib.a.LA),Wa=mc.getPropertyUint32(cb.An.value.tf,Ib.a.LA);if(null!=Ja&&null!=Wa&&Ja===Wa)return mc.setPropertyUint32(Cb,Ib.a.LA,Ja),cb.mg.add(Mb),!0;if(null==Ja&&null==Wa)return Cb.removeProperty(Ib.a.LA),cb.mg.add(m.a.Ab(Ib.a.LA)),!0;if(null!=Ja&&null==Wa)return mc.setPropertyUint32(Cb,Ib.a.LA,Ja),cb.mg.add(Mb),!0;if(null==Ja&&null!=Wa)return mc.setPropertyUint32(Cb,Ib.a.LA,Wa),cb.mg.add(Mb),!0}else{if(Mb===m.a.Ab(l.a.listLevel))return this.oNo(mc,cb);if(Array.contains($a.O4a,Mb))return this.nNo(cb)}return!1}nNo(cb){let Mb=
!0,mc=!0,Cb,Ja;({iKm:Mb,zHm:mc,mzl:Cb,o2k:Ja}=this.cUk(cb));r.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",cb.Jg.value.tf.id.toString(),Mb,mc);return Mb&&!mc?(this.XNi(Ja,cb),!0):Mb?!1:(this.XNi(Cb,cb),!0)}cUk(cb){let Mb,mc,Cb,Ja;const Wa=cb.An.value;let xb;const ic=cb.Jg.value;let qc;mc=Mb=!0;Cb=new H.a;Ja=new H.a;for(let Lc=0;Lc<$a.O4a.length;Lc++){const Ac=$a.O4a[Lc],gd=({value:xb}=
Wa.Gqa.Fc(Ac)).returnValue;({value:qc}=ic.Gqa.Fc(Ac)).returnValue&&(Mb=this.RAj(cb.Jg,Cb,qc,Ac)&&Mb);gd&&(mc=this.RAj(cb.An,Ja,xb,Ac)&&mc)}return{iKm:Mb,zHm:mc,mzl:Cb,o2k:Ja}}RAj(cb,Mb,mc,Cb){const Ja=m.a.KX(Cb);cb=cb.value.tf;Mb.Z(Cb,cb.hasProperty(Ja)?cb.VX(Ja):null);return!mc.tY}XNi(cb,Mb){const mc=Mb.Xk;for(let Ja=0;Ja<$a.O4a.length;Ja++){var Cb=$a.O4a[Ja];const Wa=m.a.KX(Cb);(Cb=cb.J(Cb))?mc.RTa(Wa,Cb):mc.removeProperty(Wa)}for(cb=0;cb<$a.O4a.length;cb++)Mb.mg.add($a.O4a[cb]);r.a.instance.Ua(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Mb.Jg.value.tf.id.toString())}oNo(cb,Mb){const mc=Mb.Xk,Cb=cb.getPropertyInt32(Mb.Jg.value.tf,l.a.listLevel),Ja=cb.getPropertyInt32(Mb.An.value.tf,l.a.listLevel);return null!=Cb&&null!=Ja&&Cb===Ja?(cb.setPropertyInt32(mc,l.a.listLevel,Cb),Mb.mg.add(m.a.Ab(l.a.listLevel)),!0):null==Cb&&null==Ja?(mc.removeProperty(l.a.listLevel),Mb.mg.add(m.a.Ab(l.a.listLevel)),!0):null!=Cb&&null==Ja?(cb.setPropertyInt32(mc,l.a.listLevel,
Cb),Mb.mg.add(m.a.Ab(l.a.listLevel)),!0):null==Cb&&null!=Ja?(cb.setPropertyInt32(mc,l.a.listLevel,Ja),Mb.mg.add(m.a.Ab(l.a.listLevel)),!0):!1}static ih(){return new $a}static get instance(){return $a.Ng.value}}$a.Ng=new a.a($a.ih);$a.O4a=[m.a.Ab(l.a.$d),m.a.Ab(l.a.mt),m.a.Ab(y.a.a5),m.a.Ab(l.a.gda),m.a.Ab(l.a.nv),m.a.Ab(l.a.Zr),m.a.Ab(y.a.O0),m.a.Ab(l.a.M2e),m.a.Ab(y.a.font),m.a.Ab(bb.a.Ylb),m.a.Ab(f.a.Uv)];Object(D.a)($a,"PersistablePropertySetComplexMerge",k.a,[]);class Hb extends k.a{constructor(){super()}get Sn(){return 21}get wA(){return 0}static ih(){return new Hb}static get instance(){return Hb.Ng.value}}
Hb.Ng=new a.a(Hb.ih);Object(D.a)(Hb,"RevisionMetadataNodeComplexMerge",k.a,[]);class Ya extends k.a{constructor(){super()}get Sn(){return 48}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.m2i),3);return cb}static ih(){return new Ya}static get instance(){return Ya.Ng.value}}Ya.Ng=new a.a(Ya.ih);Object(D.a)(Ya,"ShadowNumberListNodeComplexMerge",k.a,[]);class Sa extends k.a{constructor(){super()}get Sn(){return 22}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.G4a),7);cb.Z(m.a.Ab(l.a.QWc),2);return cb}static ih(){return new Sa}static get instance(){return Sa.Ng.value}}
Sa.Ng=new a.a(Sa.ih);Object(D.a)(Sa,"SharedPersistablePropertySetComplexMerge",k.a,[]);class Eb extends k.a{constructor(){super()}get Sn(){return 38}get wA(){return 3}static ih(){return new Eb}static get instance(){return Eb.Ng.value}}Eb.Ng=new a.a(Eb.ih);Object(D.a)(Eb,"StylePropertySetComplexMerge",k.a,[]);var Jb=c(1598),vb=c(1644);class ac extends k.a{constructor(){super()}get Sn(){return 23}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(y.a.$e),4);cb.Z(m.a.Ab(l.a.rowSpan),1);cb.Z(m.a.Ab(l.a.colSpan),
1);cb.Z(m.a.Ab(l.a.ghostCell),1);cb.Z(m.a.Ab(ab.a.vMerge),1);cb.Z(m.a.Ab(ab.a.gridSpan),1);cb.Z(m.a.Ab(l.a.B8a),2);cb.Z(m.a.Ab(l.a.Zqb),2);cb.Z(m.a.Ab(l.a.PIa),2);cb.Z(m.a.Ab(l.a.vqb),5);return cb}EJb(cb){if(!cb)return r.a.instance.Ua(573957923,1,2,"Feature helper is null"),!1;cb.Tx(107);return cb.isFeatureEnabled(107)}Jxa(cb){if(!cb)return r.a.instance.Ua(540120285,1,2,"Feature helper is null"),!1;cb.Tx(108);return cb.isFeatureEnabled(108)}mC(cb,Mb){cb.pq.runtime.YG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
Mb);var mc=Mb===m.a.Ab(l.a.rowSpan)||Mb===m.a.Ab(l.a.colSpan)||Mb===m.a.Ab(l.a.ghostCell);this.Jxa(cb.pq.runtime.Zb)&&(mc=mc||Mb===m.a.Ab(ab.a.vMerge)||Mb===m.a.Ab(ab.a.gridSpan));if(!this.EJb(cb.pq.runtime.Zb))return!mc;var Cb=cb.An.value.su,Ja=vb.e(cb.pq,Cb,null);if(Ja.equals(ea.a.nil))return r.a.instance.Ua(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Cb.id),cb.pq.logger.Pg(Object.assign(new Jb.a,{info:"Table node ID could not be found for table cell"})),
!1;var Wa=cb.pq.runtime.cCb.J(Ja).J(Cb.id);if(!Wa)return!mc;Cb=cb.Xk;Ja=cb.Vd;if(Mb===m.a.Ab(l.a.ghostCell))return Ja.setPropertyBool(Cb,l.a.ghostCell,Wa.fg),cb.mg.add(m.a.Ab(l.a.ghostCell)),!0;if(Mb===m.a.Ab(l.a.rowSpan))return Mb=Wa.rowSpan,Wa=Wa.colSpan,null!=Mb&&null!=Wa&&(1<Mb||1<Wa)?Ja.setPropertyUint32(Cb,l.a.rowSpan,Mb):Cb.removeProperty(l.a.rowSpan),cb.mg.add(m.a.Ab(l.a.rowSpan)),!0;if(Mb===m.a.Ab(l.a.colSpan))return Mb=Wa.rowSpan,mc=Wa.colSpan,Wa=Wa.fg,null!=Mb&&null!=mc&&(1<Mb||1<mc)?Ja.setPropertyUint32(Cb,
l.a.colSpan,mc):Wa&&null!=mc?Ja.setPropertyUint32(Cb,l.a.colSpan,mc):Cb.removeProperty(l.a.colSpan),cb.mg.add(m.a.Ab(l.a.colSpan)),!0;r.a.instance.Ua(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",Mb);cb.pq.logger.Pg(Object.assign(new Jb.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!mc}static ih(){return new ac}static get instance(){return ac.Ng.value}}
ac.Ng=new a.a(ac.ih);Object(D.a)(ac,"TableCellNodeComplexMerge",k.a,[]);class dc extends k.a{constructor(){super()}get Sn(){return 24}EJb(cb){if(!cb)return r.a.instance.Ua(573845782,1,2,"Feature helper is null"),!1;cb.Tx(107);return cb.isFeatureEnabled(107)}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(y.a.$e),1);cb.Z(m.a.Ab(y.a.F1),1);cb.Z(m.a.Ab(y.a.Gza),1);cb.Z(m.a.Ab(l.a.mmc),1);cb.Z(m.a.Ab(l.a.M$),1);cb.Z(m.a.Ab(l.a.B8a),2);cb.Z(m.a.Ab(l.a.Zqb),2);cb.Z(m.a.Ab(l.a.PIa),2);return cb}mC(cb,
Mb){cb.pq.runtime.YG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Mb);if(Mb===m.a.Ab(y.a.$e)||Mb===m.a.Ab(y.a.F1)||Mb===m.a.Ab(l.a.mmc)||Mb===m.a.Ab(l.a.M$)||Mb===m.a.Ab(y.a.Gza)){const Ja=cb.Xk;var mc=cb.Vd;r.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ja.id,Ja.Nc,Mb);if(this.zol(cb))return!1;var Cb=mc.getPropertyObjectIds(cb.Jg.value.su,y.a.$e);const Wa=mc.getPropertyObjectIds(cb.Jg.value.tf,y.a.$e),
xb=mc.getPropertyObjectIds(cb.An.value.tf,y.a.$e);Cb=this.hNi(Cb,Wa,xb,(ic,qc)=>ic.equals(qc));if(0<Cb.length)return mc.setPropertyObjectIds(Ja,y.a.$e,Cb),mc.setPropertyInt32(Ja,y.a.Gza,Cb.length),this.EJb(cb.pq.runtime.Zb)&&({value:Mb}=cb.An.value.Gqa.Fc(m.a.Ab(y.a.F1)),{value:mc}=cb.Jg.value.Gqa.Fc(m.a.Ab(y.a.F1)),Mb.tY?Ja.RTa(y.a.F1,Mb.newValue):Ja.RTa(y.a.F1,mc.newValue)),cb.mg.add(m.a.Ab(y.a.$e)),cb.mg.add(m.a.Ab(y.a.F1)),cb.mg.add(m.a.Ab(y.a.Gza)),cb.mg.add(m.a.Ab(l.a.mmc)),cb.mg.add(m.a.Ab(l.a.M$)),
!0}r.a.instance.Ua(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}zol(cb){const Mb=cb.An.value,mc=cb.Jg.value;let Cb,Ja;({value:Cb}=Mb.Gqa.Fc(m.a.Ab(y.a.F1)));({value:Ja}=mc.Gqa.Fc(m.a.Ab(y.a.F1)));return Cb.tY||Ja.tY?Cb.tY&&Ja.tY?(r.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
Cb.oldValue,Ja.newValue,Cb.newValue),cb.pq.logger.Pg(Object.assign(new Jb.a,{uj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):dc.nSh(cb.pq,Cb,mc,"BaseConflict")||dc.nSh(cb.pq,Ja,Mb,"BaseFavored")?!0:!1:!1}static ih(){return new dc}static get instance(){return dc.Ng.value}static nSh(cb,Mb,mc,Cb){return Mb.tY&&({value:Mb}=mc.Gqa.Fc(m.a.Ab(y.a.$e)),Mb.tY)?(r.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
Cb),cb.logger.Pg(Object.assign(new Jb.a,{uj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}dc.Ng=new a.a(dc.ih);Object(D.a)(dc,"TableNodeComplexMerge",k.a,[]);class Cc extends k.a{constructor(){super()}get Sn(){return 25}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.Wc),3);cb.Z(m.a.Ab(y.a.$e),4);cb.Z(m.a.Ab(l.a.B8a),2);cb.Z(m.a.Ab(l.a.Zqb),2);cb.Z(m.a.Ab(l.a.PIa),2);cb.Z(m.a.Ab(ab.a.Ejg),2);cb.Z(m.a.Ab(ab.a.Djg),2);cb.Z(m.a.Ab(l.a.vqb),5);return cb}static ih(){return new Cc}static get instance(){return Cc.Ng.value}}
Cc.Ng=new a.a(Cc.ih);Object(D.a)(Cc,"TableRowNodeComplexMerge",k.a,[]);class Ec extends k.a{constructor(){super()}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.KFo),2);cb.Z(m.a.Ab(y.a.$e),1);return cb}mC(cb,Mb){if(Mb===m.a.Ab(y.a.$e)){const Cb=cb.Xk,Ja=cb.Vd;r.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.id,Cb.Nc,Mb);var mc=Ja.getPropertyObjectIds(cb.Jg.value.su,y.a.$e);const Wa=Ja.getPropertyObjectIds(cb.Jg.value.tf,
y.a.$e),xb=Ja.getPropertyObjectIds(cb.An.value.tf,y.a.$e);if(mc=this.Ban(mc,Wa,xb))return 0<mc.length?Ja.setPropertyObjectIds(Cb,y.a.$e,mc):Cb.removeProperty(y.a.$e),cb.mg.add(m.a.Ab(y.a.$e)),!0}r.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb);return!1}Ban(cb,Mb,mc){const Cb=new H.a(0);cb.forEach(Wa=>{Cb.Z(Wa,0);return!0});Mb.forEach(Wa=>{Cb.nb(Wa)?Cb.Z(Wa,1):Cb.Z(Wa,3);return!0});
mc.forEach(Wa=>{let xb;({value:xb}=Cb.Fc(Wa)).returnValue?1===xb?Cb.Z(Wa,5):3===xb?(r.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),Cb.Z(Wa,3)):Cb.Z(Wa,2):Cb.Z(Wa,4);return!0});const Ja=new J.a;Cb.forEach((Wa,xb)=>{0!==xb&&2!==xb&&1!==xb&&Ja.add(Wa);return!0});return Ja}static ih(){return new Ec}static get instance(){return Ec.Ng.value}}Ec.Ng=new a.a(Ec.ih);Object(D.a)(Ec,"TaskContentNodeComplexMerge",k.a,[]);class rc{equals(cb,Mb){return cb&&Mb?cb.UserId===Mb.UserId&&
cb.Provider===Mb.Provider&&cb.DisplayName===Mb.DisplayName&&cb.Email===Mb.Email:!cb&&!Mb}HM(){return 0}}Object(D.a)(rc,"CommentTaskPersonComparer",null,[200]);class hb{equals(cb,Mb){return cb&&Mb?cb.startDate?cb.endDate?cb.startDate.getTime()===Mb.startDate.getTime()&&cb.endDate.getTime()===Mb.endDate.getTime():!Mb.endDate:!Mb.startDate:!cb&&!Mb}HM(){return 0}}Object(D.a)(hb,"CommentTaskScheduleEqualityComparer",null,[200]);class fb{equals(cb,Mb){if(!cb||!Mb)return!cb&&!Mb;if(!cb.extensions&&!Mb.extensions)return!0;
if(!cb.extensions||!Mb.extensions||cb.extensions.count!==Mb.extensions.count)return!1;let mc=!0;cb.extensions.forEach((Cb,Ja)=>{let Wa;return({value:Wa}=Mb.extensions.Fc(Cb)).returnValue&&Ja===Wa?!0:mc=!1});return mc}HM(){return 0}}Object(D.a)(fb,"ExtensionListEqualityComparer",null,[200]);class Nb{$vl(cb,Mb){return cb&&Mb?cb.recordId===Mb.recordId&&Nb.fOg.equals(cb.user,Mb.user)&&Nb.fOg.equals(cb.assignee,Mb.assignee)&&cb.type===Mb.type&&cb.title===Mb.title&&cb.priority===Mb.priority&&cb.isLossy===
Mb.isLossy&&cb.completion===Mb.completion&&cb.commentId===Mb.commentId&&cb.time===Mb.time&&Nb.KXj.equals(cb.schedule,Mb.schedule):!cb&&!Mb}equals(cb,Mb){return this.$vl(cb,Mb)}HM(){return 0}}Nb.fOg=new rc;Nb.KXj=new hb;new fb;Object(D.a)(Nb,"HistoryRecordEqualityComparer",null,[200]);var Fb=c(2092),nb=c(1559);class pb extends k.a{constructor(cb){super();this.dNa=cb}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.rRb),5);cb.Z(m.a.Ab(l.a.taskId),2);cb.Z(m.a.Ab(l.a.wFo),2);cb.Z(m.a.Ab(l.a.BFo),2);cb.Z(m.a.Ab(l.a.Iza),
1);return cb}Dmg(cb){if(!cb.An.value.su&&!cb.Jg.value.su){const Mb=cb.Jg.value.tf.UK();Mb.removeProperty(l.a.Iza);const mc=cb.Jg.value.tf,Cb=cb.An.value.tf;cb.Jg=new a.a(()=>new nb.a(Mb,mc));cb.An=new a.a(()=>new nb.a(Mb,Cb))}return super.Dmg(cb)}mC(cb,Mb){if(Mb!==m.a.Ab(l.a.Iza))return r.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.Jg.value.tf.id,Mb),!1;const mc=cb.Xk,Cb=cb.Vd;r.a.instance.Ua(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.Nc,Mb);Mb=Cb.getPropertyString(cb.Jg.value.su,l.a.Iza);const Ja=Cb.getPropertyString(cb.Jg.value.tf,l.a.Iza),Wa=Cb.getPropertyString(cb.An.value.tf,l.a.Iza);Mb=this.Aan(Mb,Ja,Wa);if(!Mb)return!1;0<Mb.length?Cb.setPropertyString(mc,l.a.Iza,Mb):mc.removeProperty(l.a.Iza);cb.mg.add(m.a.Ab(l.a.Iza));return!0}Aan(cb,Mb,mc){cb=this.dNa.i6b(cb);Mb=this.dNa.i6b(Mb);mc=this.dNa.i6b(mc);if(!pb.Rzi(cb,
Mb))return r.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!pb.Rzi(cb,mc))return r.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;mc=pb.n_k(cb.length,Mb,mc);return this.dNa.cbg(mc)}static ih(){const cb=new Fb.a;return new pb(cb)}static get instance(){return pb.Ng.value}static n_k(cb,Mb,mc){const Cb=new J.a;for(let Ja=0;Ja<Mb.length;Ja++)Cb.add(Mb.J(Ja));for(;cb<mc.length;cb++)Cb.add(mc.J(cb));
return Cb}static Rzi(cb,Mb){const mc=cb.length;if(mc>Mb.length)return!1;for(let Cb=0;Cb<mc;Cb++)if(!pb.X3j.equals(Mb.J(Cb),cb.J(Cb)))return Mb.J(Cb).recordId===cb.J(Cb).recordId&&r.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}pb.Ng=new a.a(pb.ih);pb.X3j=new Nb;Object(D.a)(pb,"TaskSingleNodeComplexMerge",k.a,[]);class Xa extends k.a{constructor(){super()}get Sn(){return 26}uk(){const cb=super.uk();cb.Z(m.a.Ab(y.a.$e),
1);return cb}mC(cb,Mb){const mc=y.a.$e;if(Mb===m.a.Ab(mc)){Mb=cb.Xk;const Ja=cb.Vd;var Cb=Ja.getPropertyObjectIds(cb.Jg.value.su,mc);const Wa=Ja.getPropertyObjectIds(cb.Jg.value.tf,mc),xb=Ja.getPropertyObjectIds(cb.An.value.tf,mc);Cb=this.Han(Cb,Wa,xb);Ja.setPropertyObjectIds(Mb,mc,Cb);cb.mg.add(m.a.Ab(mc));return!0}return!1}Han(cb,Mb,mc){return this.MGa(cb,Mb,mc)}static ih(){return new Xa}static get instance(){return Xa.Ng.value}}Xa.Ng=new a.a(Xa.ih);Object(D.a)(Xa,"VectorClockContainerNodeComplexMerge",
k.a,[]);class Pb extends k.a{constructor(){super()}get Sn(){return 27}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.cQ),1);return cb}mC(cb,Mb){const mc=l.a.cQ;if(Mb===m.a.Ab(mc)){Mb=cb.Xk;const Cb=cb.Vd,Ja=Cb.getPropertyUint32(cb.Jg.value.tf,mc)||0,Wa=Cb.getPropertyUint32(cb.An.value.tf,mc)||0;Cb.setPropertyUint32(Mb,mc,this.k2l(Ja,Wa));cb.mg.add(m.a.Ab(mc));return!0}return!1}k2l(cb,Mb){return cb>Mb?cb:Mb}static ih(){return new Pb}static get instance(){return Pb.Ng.value}}Pb.Ng=new a.a(Pb.ih);Object(D.a)(Pb,
"VectorClockNodeComplexMerge",k.a,[]);class Va extends k.a{constructor(){super()}get Sn(){return 28}get wA(){return 0}uk(){const cb=super.uk();cb.Z(m.a.Ab(l.a.JSh),3);cb.Z(m.a.Ab(l.a.Wc),3);cb.Z(m.a.Ab(l.a.LSh),5);cb.Z(m.a.Ab(l.a.rNi),5);cb.Z(m.a.Ab(l.a.Fja),5);return cb}static ih(){return new Va}static get instance(){return Va.Ng.value}}Va.Ng=new a.a(Va.ih);Object(D.a)(Va,"WordSectionNodeComplexMerge",k.a,[]);c.d(I,"a",function(){return tb});class tb{JKh(cb,Mb){switch(cb.Nc){case 131073:return cb.hasProperty(l.a.imageType)||
cb.hasProperty(f.a.s0)?this.fp(fa.instance,Mb):this.fp($a.instance,Mb);case 1074135140:return this.fp(x.instance,Mb);case 1074135137:return this.fp(v.instance,Mb);case 1074135139:return this.fp(G.instance,Mb);case 1074135138:return this.fp(F.instance,Mb);case 1074135136:return this.fp(N.instance,Mb);case 1074135157:return this.fp(K.instance,Mb);case 1074135152:return this.fp(O.instance,Mb);case 1074135153:return this.fp(V.instance,Mb);case 1074135126:return this.fp(W.instance,Mb);case 1074135127:return this.fp(ba.instance,
Mb);case 1074135145:return this.fp(la.instance,Mb);case 1074135144:return this.fp(Z.instance,Mb);case 1074135142:return this.fp(ia.instance,Mb);case 1074135143:return this.fp(sa.instance,Mb);case 1074135163:return this.fp(Oa.instance,Mb);case 1074135164:return this.fp(Ra.instance,Mb);case 1074135124:return this.fp(Na.instance,Mb);case 1074135125:return this.fp(Da.instance,Mb);case 1074135122:return this.fp(xa.instance,Mb);case 393233:return this.fp(fa.instance,Mb);case 1073872970:return this.fp(fa.instance,
Mb);case 1074135170:return this.fp(oa.instance,Mb);case 1074135168:return this.fp(ta.instance,Mb);case 1074135166:return this.fp(Ka.instance,Mb);case 1074135167:return this.fp(va.instance,Mb);case 1074135169:return this.fp(La.instance,Mb);case 1074135165:return this.fp(za.instance,Mb);case 393234:return this.fp(ib.instance,Mb);case 393229:return this.fp(mb.instance,Mb);case 393241:return this.fp(yb.instance,Mb);case 393227:return this.fp(Za.instance,Mb);case 131120:return this.fp(Xb.instance,Mb);
case 393271:return this.fp(Ub.instance,Mb);case 393230:return this.fp(zb.a.instance,Mb);case 131140:return this.fp(Hb.instance,Mb);case 1179649:return this.fp(Sa.instance,Mb);case 1073872969:return this.fp(Eb.instance,Mb);case 393252:return this.fp(ac.instance,Mb);case 393250:return this.fp(dc.instance,Mb);case 393251:return this.fp(Cc.instance,Mb);case 1074135154:return this.fp(Xa.instance,Mb);case 1074135161:return this.fp(Ec.instance,Mb);case 1074135162:return this.fp(pb.instance,Mb);case 1074135155:return this.fp(Pb.instance,
Mb);case 1073872968:return this.fp(Va.instance,Mb);case 1074135172:return this.fp(ua.instance,Mb);case 1074135171:return this.fp(Ca.instance,Mb);case 1074135149:return this.fp(ra.instance,Mb);case 1074135151:return this.fp(Ya.instance,Mb)}return this.fp(k.a.instance,Mb)}fp(cb,Mb){cb.Zb=Mb?Mb():null;return cb}}Object(D.a)(tb,"GraphNodeComplexMergeFactory",null,[1808])},1977:function(D,I,c){c.r(I);D=c(0);var l=c(1535),f=c(75),a=c(344),k=c(69),x=c(1511);class y{constructor(J,M,P,N=0){this.nki=J;this.groupType=
M;this.Gwf=N;this.T6c=P}}Object(D.a)(y,"SortingGroup",null,[]);class m{constructor(J,M,P,N){this.order=J;this.Y8=M;this.Ukm=P;this.groupType=N}}Object(D.a)(m,"SortingProp",null,[]);var r=c(1504),z=c(1506),v=c(1503),G=c(25);class F{constructor(J,M){this.gLi={};this.fLi={};this.bLi=this.nLi=1;this.Qxh(J,M)}Kxo(J,M,P){var N=v.a.BR(P)?this.gLi:this.fLi;P=new f.a;for(var K of M)M=Object(k.a)(m,N[l.a[K.groupType].toLowerCase()]),G.c(M)||P.add(new a.a(M,K));P.Sc((V,W)=>V.key.order<W.key.order?-1:1);Array.clear(J);
K=r.TellMeActor.instance.l_;for(M=0;M<P.count;){N=P.J(M).key.Y8;var O=P.J(M).value;const V=new x.a(P.J(M).key.groupType);G.c(K)||K.Location===z.a.contextMenu||(V.displayName=P.J(M).key.Ukm);for(const W of O.results)V.Rw(W);for(O=++M;O<P.count&&P.J(O).key.Y8===N;)this.jZe(V,P.J(O).value),O=++M;J.push(V)}}dXo(J,M){this.bLi=this.nLi=1;this.Qxh(J,M)}Qxh(J,M){this.Csj(J);for(var P=0;P<J.length;P++){let N=J[P];for(const K of N.T6c)this.Yqk(K,P,N.nki,N.groupType)}this.Csj(M);for(J=0;J<M.length;J++){P=M[J];
for(const N of P.T6c)this.Xqk(N,J,P.nki,P.groupType)}}Csj(J){J.sort((M,P)=>Object(k.a)(y,M).Gwf>Object(k.a)(y,P).Gwf?-1:1)}Yqk(J,M,P,N){this.gLi[l.a[J].toLowerCase()]=new m(this.nLi++,M,P,N)}Xqk(J,M,P,N){this.fLi[l.a[J].toLowerCase()]=new m(this.bLi++,M,P,N)}jZe(J,M){for(let P=0;P<M.results.length;P++)J.Rw(M.results[P])}}Object(D.a)(F,"BaseGroupingSorter",null,[]);class H{constructor(){this.g3d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.b3d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13]),new y("",22,[22])];this.NKi=new F(this.g3d,this.b3d)}x$c(J,M,P,N=null,K=null){let O=!1;if(N){for(const V of v.a.BR(P)?
this.g3d:this.b3d)this.LMn(V,N);O=!0}if(K){for(const V of v.a.BR(P)?this.g3d:this.b3d)this.eXo(M,V,K);O=!0}O&&this.NKi.dXo(this.g3d,this.b3d);this.NKi.Kxo(J,M,P)}LMn(J,M){const P=new f.a;for(var N of J.T6c){const K=M[l.a[N].toLowerCase()];P.add(new a.a(G.c(K)?Number.MAX_VALUE:K,N))}if(P.count){P.Sc((K,O)=>K.key<O.key?-1:1);M=Array(P.count);for(N=0;N<P.count;N++)M[N]=P.J(N).value;J.T6c=M}}eXo(J,M,P){let N=0;for(const K of M.T6c)if(l.a[K].toLowerCase()in P&&P[l.a[K].toLowerCase()])for(const O of J)if(O.groupType===
K){N+=P[l.a[K].toLowerCase()];break}M.Gwf=N}}Object(D.a)(H,"SimplifiedGroupingSorter",null,[]);c.d(I,"GroupsPlacementInfo",function(){return L});class L{constructor(J){this.eLi={};this.cLi={};this.dLi={};this.hLi={};this.fNf={};this.iLi=this.b7m=this.X6m=this.Z6m=1;this.kLi=null;this.lx=J;this.jNk();this.kCn();this.YMk();this.aMk();J.PP&&(this.kLi=new H)}NE(J){this.eLi[l.a[J].toLowerCase()]=this.Z6m++}zH(J,M){this.cLi[l.a[J].toLowerCase()]=M}rNa(J){this.dLi[l.a[J].toLowerCase()]=this.X6m++}D3(J){this.hLi[l.a[J].toLowerCase()]=
this.b7m++}HD(J){this.fNf[l.a[J].toLowerCase()]=this.iLi++}jNk(){const J=!!this.lx&&this.lx.x4a,M=!!this.lx&&this.lx.R1c,P=!!this.lx&&this.lx.olb,N=!!this.lx&&this.lx.gHf&&!v.a.qdc(),K=!!this.lx&&this.lx.JXc,O=!!this.lx&&this.lx.YXd,V=!!this.lx&&this.lx.lFf,W=!!this.lx&&this.lx.UBf;this.lx&&(this.lx.Yga||this.lx.DLd)&&this.NE(26);W&&this.NE(24);this.NE(4);this.NE(18);this.NE(16);this.NE(7);this.NE(17);this.NE(0);this.NE(1);V&&this.NE(28);K&&this.NE(23);J||this.NE(2);J&&!M||this.NE(8);this.NE(15);
P&&this.NE(20);this.NE(14);this.NE(9);this.NE(12);this.NE(10);this.NE(11);J&&this.NE(2);J&&!M&&this.NE(8);this.NE(19);O&&this.NE(27);this.NE(21);this.NE(13);N&&this.NE(22);this.NE(30)}kCn(){this.zH(21,1);this.zH(4,3);this.zH(18,3);this.zH(16,3);this.zH(7,3);this.zH(17,5);this.zH(0,5);this.zH(1,1);this.zH(28,2);this.zH(2,1);this.zH(8,2);this.zH(15,3);this.zH(14,2);this.zH(27,3);this.zH(9,1);this.zH(12,1);this.zH(10,1);this.zH(11,1);this.zH(19,1);this.zH(23,1);this.zH(13,1);this.zH(24,1);this.zH(25,
1);this.zH(20,2);this.zH(22,1);this.zH(26,1)}YMk(){this.rNa(4);this.rNa(0);this.rNa(17);this.rNa(7);this.rNa(16);this.rNa(18);this.rNa(15);this.rNa(20);this.rNa(8);this.rNa(14)}aMk(){this.D3(14);this.D3(10);this.D3(12);this.D3(9);this.D3(11);this.D3(20);this.D3(15);this.D3(8);this.D3(2);this.D3(1);this.D3(27);this.D3(7);this.D3(18);this.D3(16);this.D3(17);this.D3(0);this.D3(4)}g4n(){this.fNf={};this.iLi=1}yam(J,M,P){this.g4n();const N=!!this.lx&&this.lx.x4a,K=!!this.lx&&this.lx.R1c,O=!!this.lx&&this.lx.olb,
V=!!this.lx&&this.lx.gHf&&!v.a.qdc(),W=!!this.lx&&this.lx.JXc,T=!!this.lx&&this.lx.YXd,Y=!!this.lx&&this.lx.lFf,ba=!!this.lx&&this.lx.Ghe;J=J&&K;ba&&this.HD(25);this.HD(4);this.HD(18);this.HD(16);this.HD(7);this.HD(17);this.HD(0);this.HD(1);Y&&this.HD(28);W&&this.HD(23);N&&!K||!J||this.HD(8);M&&this.HD(15);N||this.HD(2);T&&this.HD(27);P&&this.HD(14);N&&!K||J||this.HD(8);M||this.HD(15);O&&this.HD(20);P||this.HD(14);this.HD(9);this.HD(12);this.HD(10);this.HD(11);N&&this.HD(2);N&&!K&&this.HD(8);this.HD(19);
this.HD(21);this.HD(13);V&&this.HD(22);return this.fNf}aP(){return this.lx}}Object(D.a)(L,"GroupsPlacementInfo",null,[])},1979:function(D,I,c){D=c(0);var l=c(1789),f=c(60);class a{constructor(){this.source=0;this.Am=this.yVa=this.P$=null;this.Fia=0;this.HHb=!1;this.mode=this.oUa=0;this.hNc=null;this.eLb=f.a.create()}}Object(D.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.ZM=null}}Object(D.a)(k,"OutputState",null,[]);class x{constructor(){this.zqi=
this.Mhe=this.K9c=!1;this.Zb=this.R3d=this.iZf=this.Sbe=this.xjg=this.cCb=this.WNa=this.YG=this.Hmb=this.Elc=this.hPo=this.nzl=this.qn=this.Wcf=this.Kq=this.Ku=this.sk=this.Nme=this.cNd=this.DDa=null}}Object(D.a)(x,"RuntimeState",null,[]);c.d(I,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(D.a)(y,"MergeState",null,[])},1980:function(D,I,c){c.r(I);D=c(0);var l=c(608),f=c(224),a=c(179),k=c(110),x=c(1642),y=c(1732),
m=c(1770),r=c(6),z=c(1970);class v{constructor(P,N){this.start=P;this.end=N}}Object(D.a)(v,"MergeDiffIdx",null,[]);class G{constructor(P,N,K,O=!1,V=null,W=null,T=!0){this.fjd=this.ejd=this.cRg=this.Lyc=0;this.W0b=this.vte=null;this.Rab=V||new z.a;this.Og=K;this.ksa=P.I5();this.$lk=N.I5();this.hQ=new v(0,0);this.tT=new v(0,0);this.mDe=O;this.Zvc=T;this.Osa=W;this.hPk();this.wio()}get MK(){return this.ksa}get hK(){return this.$lk}get Lz(){return this.Lyc}get xA(){return this.cRg}get Lva(){return this.ejd}get Fna(){return this.fjd}get aml(){const P=
new f.a;for(let N=this.vte.start;N<this.vte.end;N++)P.add(this.MK.Zf(N));return P}get jef(){const P=new f.a;for(let N=this.W0b.start;N<this.W0b.end;N++)P.add(this.hK.Zf(N));return P}uff(P){if(this.xA<P.xA){if(this.xA+this.Lva>P.xA)return!0}else if(this.xA>P.xA){if(P.xA+P.Lva>this.xA)return!0}else if(2===this.Lz&&3===P.Lz||3===this.Lz&&2===P.Lz||2===this.Lz&&2===P.Lz||3===this.Lz&&3===P.Lz)return!0;return!1}abj(P,N,K,O){P.tG(N);P.aD(N,K);return O+=K.length-1}Ysj(P,N,K,O,V){let W=this.MK.Zf(P),T=this.hK.Zf(N);
if(!W||!T||!W.f8a&&!T.f8a)return{returnValue:!1,bDa:O,tJa:V};let Y=new f.a,ba=new f.a;W.f8a&&(Y=W.F$c(),W=Y.Zf(K?0:Y.length-1));T.f8a&&(ba=T.F$c(),T=ba.Zf(K?0:ba.length-1));if(!W.IA(T,this.Rab,this.Osa,this.mDe,this.Zvc))return{returnValue:!1,bDa:O,tJa:V};Y.length&&(O=this.abj(this.MK,P,Y,O));ba.length&&(V=this.abj(this.hK,N,ba,V));return{returnValue:!0,bDa:O,tJa:V}}SBl(P,N,K,O,V,W){for(;V<=K&&W<=O;){const T=P.Zf(V),Y=N.Zf(W);if(!T.IA(Y,this.Rab,this.Osa,this.mDe,this.Zvc))break;this.hQ.start+=T.length;
this.tT.start+=Y.length;V++;W++}return{L2e:V,Ong:W}}QBl(P,N,K,O,V,W){for(;V>=K&&W>=O;){const T=P.Zf(V),Y=N.Zf(W);if(!T.IA(Y,this.Rab,this.Osa,this.mDe,this.Zvc))return{returnValue:!0,bDa:V,tJa:W};V--;W--}return{returnValue:!1,bDa:V,tJa:W}}RBl(P,N,K,O){let V=!1;do({L2e:P,Ong:N}=this.SBl(this.MK,this.hK,K,O,P,N)),{bDa:K,tJa:O,returnValue:V}=this.Ysj(P,N,!0,K,O);while(V);return{L2e:P,Ong:N,bDa:K,tJa:O}}PBl(P,N,K,O){let V=!1;do{if(!({bDa:K,tJa:O}=this.QBl(this.MK,this.hK,P,N,K,O)).returnValue)break;({bDa:K,
tJa:O,returnValue:V}=this.Ysj(K,O,!1,K,O))}while(V);return{bDa:K,tJa:O}}hPk(){var P=0,N=0,K=this.MK.length-1,O=this.hK.length-1;0<=K&&this.MK.Zf(K);0<=O&&this.hK.Zf(O);({L2e:P,Ong:N,bDa:K,tJa:O}=this.RBl(P,N,K,O));if(P<K||N<O)({bDa:K,tJa:O}=this.PBl(P,N,K,O));K++;O++;this.vte=new v(P,K);this.W0b=new v(N,O);this.hQ.end=this.hQ.start;this.tT.end=this.tT.start;for(var V=P;V<K;V++){var W=this.MK.Zf(V);this.hQ.end+=W.length}for(V=N;V<O;V++)W=this.hK.Zf(V),this.tT.end+=W.length;a.a.instance.Ua(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",P,K,N,O);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.hQ.start,this.hQ.end,this.tT.start,this.tT.end);this.hQ.start<=this.hQ.end&&this.tT.start<=this.tT.end&&(P=this.MK.Zf(P),N=this.hK.Zf(N),V=this.MK.Zf(K),W=this.hK.Zf(O),K=this.MK.Zf(K-1),O=this.hK.Zf(O-1),a.a.instance.Ua(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",P,V,N,W,K,O))}wio(){this.cRg=this.hQ.start;this.ejd=this.fjd=0;this.hQ.start===this.hQ.end&&this.tT.start===this.tT.end?this.Lyc=0:this.hQ.start===this.hQ.end&&this.tT.start<this.tT.end?(this.Lyc=1,this.fjd=this.tT.end-this.tT.start):this.tT.start===this.tT.end&&this.hQ.start<this.hQ.end?(this.Lyc=2,this.ejd=this.hQ.end-this.hQ.start):(this.Lyc=
3,this.ejd=this.hQ.end-this.hQ.start,this.fjd=this.tT.end-this.tT.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Lz,this.xA,this.Lva,this.Fna)}UNm(P,N){return P.S4()&&N.S4()?P.runId===N.runId&&P.yg===N.yg:!1}bTm(P){if(!P.S4()||"\ufffc"!==P.text)return!1;P=P.PEb;return P?P.hasProperty(r.a.$j)||P.hasProperty(r.a.mDd)||P.hasProperty(r.a.Xff)||P.hasProperty(r.a.m4)||P.hasProperty(r.a.imageType)||P.hasProperty(r.a.iRa)||
P.hasProperty(r.a.AJb)||P.hasProperty(r.a.Is)&&(P=this.Og.getPropertyInt32(P,r.a.Is))&&(36===P||35===P||24===P||23===P||33===P||34===P||44===P||45===P||42===P||43===P)?!0:!1:!1}rWc(P){return P.S4()&&!this.bTm(P)}MQk(){if(2===this.Lz)return!1;var P=this.W0b.start;if(!P)return!1;let N=null;for(var K=this.W0b.start;K<this.W0b.end;K++){const O=this.hK.Zf(K);if(this.rWc(O)){N=O;break}}if(!N)return!1;--P;for(K=this.hK.Zf(P);K&&!this.rWc(K);)P--,K=this.hK.Zf(P);return K&&this.UNm(K,N)?!0:!1}e9h(P){const N=
new f.a;for(let K=0;K<P.length;K++)P.J(K).f8a?N.aD(N.length,P.J(K).F$c()):N.insert(N.length,P.J(K));return N}WNm(){if(3!==this.Lz||this.Lva!==this.Fna)return!1;const P=this.e9h(this.aml),N=this.e9h(this.jef);if(P.length!==N.length)return!1;for(let K=0;K<P.length;K++)if(!P.J(K).IA(N.J(K),this.Rab,this.Osa,!0,this.Zvc))return!1;return!0}VNm(){if(0!==this.Lz&&3!==this.Lz||this.MK.length!==this.hK.length)return!1;let P=!1;for(let N=0;N<this.MK.length;N++){if(!this.MK.J(N).IA(this.hK.J(N),this.Rab,this.Osa,
!0,this.Zvc))return!1;if(3===this.MK.J(N).type||1===this.MK.J(N).type){const K=this.MK.J(N),O=this.hK.J(N);P=K.runId!==O.runId||K.yg!==O.yg||P}}return P}}Object(D.a)(G,"MergeBlockDiff",null,[]);var F=c(1596);class H{constructor(P,N){this.id=P;this.index=N}}Object(D.a)(H,"ParagraphStartIndex",null,[]);var L=c(1653),J=c(1575);c.d(I,"ParagraphMerge",function(){return M});class M{constructor(P,N,K,O,V,W,T){this.WZb=this.uxb=this.Wo=this.wx=null;this.Xh=!1;this.Vih=this.zTg=this.eLg=this.iua=this.XKa=
this.ksa=null;this.Yd=P;this.LF=N;this.xCa=O;this.fBa=K;this.Nsa=V;this.Osa=W;this.Og=T}xei(P){const N=new l.a;P.MK.forEach(K=>{2===K.type&&N.add(K.Lj);return!0});P.hK.forEach(K=>{2===K.type&&N.remove(K.Lj);return!0});return N}Zai(P){const N=new f.a;P.hK.forEach(K=>{2===K.type&&N.add(K.Lj);return!0});return N}qGh(P){const N=new f.a;let K=0,O=0;P.hK.forEach(V=>{2===V.type&&(N.add(new H(V.Lj,K<P.xA?K:K<P.xA+P.Fna?P.xA:K-P.Fna+P.Lva)),K=O);O+=V.length;return!0});return N}P1k(P,N){var K=this.qGh(P);const O=
this.qGh(N);P=this.xei(P);const V=this.xei(N);N=new f.a;const W=new l.a;let T=0;for(let Y=0;Y<K.length;Y++){const ba=K.J(Y);if(T<O.length){let Z=O.J(T);for(;T<O.length&&Z.index<=ba.index;){if(Z.id.equals(ba.id)){T++;break}P.contains(Z.id)||W.contains(Z.id)||(N.add(Z.id),W.add(Z.id));T++;Z=O.J(T)}}V.contains(ba.id)||(N.add(ba.id),W.add(ba.id))}for(;T<O.length;)K=O.J(T),P.contains(K.id)||W.contains(K.id)||(N.add(K.id),W.add(K.id)),T++;return N}initialize(){if(this.Xh){const P=!!this.wx&&!!this.Wo;this.Yd.logger.Pg(Object.assign(new F.a,
{uj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return P}this.Xh=!0;if(!({MK:this.ksa,gNc:this.XKa,fcd:this.iua,ZCd:this.eLg,dNd:this.zTg,Ome:this.Vih}=J.a.jLh(this.Yd,this.Og,this.LF,this.fBa,this.xCa,this.Nsa,!1,!1)).returnValue)return!1;this.wx=new G(this.ksa,this.XKa,this.Og,void 0,void 0,this.Osa);this.Wo=new G(this.ksa,this.iua,this.Og,void 0,void 0,this.Osa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.wx.Lva,this.wx.Fna,this.Wo.Lva,this.Wo.Fna));return!0}hJa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let P=!1;const N=new m.a(this.Og,this.Yd);let K=null,O=null;var V=null;const W=Y=>this.Yd.runtime.sk.J(Y),T=Y=>this.Yd.runtime.Kq.J(Y)||this.Yd.runtime.sk.J(Y);this.wx=new G(this.ksa,this.XKa,this.Og,void 0,void 0,this.Osa,!1);this.Wo=new G(this.ksa,this.iua,this.Og,void 0,void 0,this.Osa,!1);({updateHints:K}=N.PMh(this.LF,W,this.fBa,Y=>this.Yd.runtime.Ku.J(Y)||this.Yd.runtime.sk.J(Y),
this.wx.xA,this.wx.xA+this.wx.Lva,this.wx.xA+this.wx.Fna)).returnValue&&({updateHints:O}=N.PMh(this.LF,W,this.xCa,T,this.Wo.xA,this.Wo.xA+this.Wo.Lva,this.Wo.xA+this.Wo.Fna)).returnValue&&(P=!0);P||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),P=!1);P&&(V=new L.a(this.Yd,this.LF,this.fBa,this.xCa,Y=>this.Yd.runtime.Zb?this.Yd.runtime.Zb.isFeatureEnabled(Y):!1,this.Og,null,K,O),({qn:V}=V.Dnc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.Yd.logger.Pg(Object.assign(new F.a,{uj:"TryLCSMerge",eventId:"9zrqs"})),P=!1));a.a.instance.Ua(593826833,1,P?4:2,"TryLCSMerge: [Success: {0}]",P);return{returnValue:P,qn:V}}Dnc(){let P;P=null;if(!this.initialize())return this.Yd.logger.OU("ParagraphMerge Initialize"),this.V4a(),{returnValue:!1,qn:P};this.Yd.logger.OU("ParagraphMerge Initialize");let N;this.Yd.logger.uge(2);let K=({hJa:N}=this.Uol()).returnValue;K=K&&({qn:P,hJa:N}=this.nQc(this.Yd,this.Og,this.Nsa,this.WZb,this.uxb)).returnValue;
this.Yd.logger.Hcg();if(!K){this.Yd.logger.OU("ParagraphMerge DoMergeInteral");if(N){this.Yd.logger.uge(3);({qn:P,returnValue:K}=this.hJa());this.Yd.logger.Hcg();if(K)return{returnValue:!0,qn:P};this.V4a();return{returnValue:!1,qn:P}}this.V4a();return{returnValue:!1,qn:P}}if(!({qn:P,hJa:N}=this.nQc(this.Yd,this.Og,this.Nsa,this.WZb,this.uxb)).returnValue)return this.Yd.logger.OU("ParagraphMerge DoMergeInteral"),this.V4a(),{returnValue:!1,qn:P};this.Yd.logger.OU("ParagraphMerge DoMergeInteral");return{returnValue:!0,
qn:P}}nQc(){let P;if(!({A9d:P}=J.a.nQc(this.Yd,this.Og,this.Nsa,this.WZb,this.uxb)).returnValue)return this.Yd.logger.OU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.V4a(),{returnValue:!1,qn:P,hJa:!0};this.Yd.logger.OU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,qn:P,hJa:!1}}V4a(P=!1){a.a.instance.kka(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+P+"] BaseRevisionMergeBlocksList: {0}",this.eLg);a.a.instance.kka(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.zTg);a.a.instance.kka(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.Vih);P=new f.a;J.a.Jec(this.Og,"BaseObjects_",this.LF,P);J.a.Jec(this.Og,"FavoredObjects_",this.fBa,P);J.a.Jec(this.Og,"ConflictObjects_",this.xCa,P);J.a.C2m(this.Yd,P)}ozh(P){let N,K;K=N=0;if(0===this.wx.Lz)N=this.Wo.xA;else if(1===this.wx.Lz)N=this.Wo.xA<this.wx.xA?this.Wo.xA:this.Wo.xA===this.wx.xA?P||1!==this.Wo.Lz?this.Wo.xA+this.wx.Fna:this.Wo.xA:this.Wo.xA+this.wx.Fna;else if(2===this.wx.Lz||3===this.wx.Lz)N=
this.Wo.xA<=this.wx.xA?this.Wo.xA:this.Wo.xA+(this.wx.Fna-this.wx.Lva);if(2===this.Wo.Lz||3===this.Wo.Lz)K=N+this.Wo.Lva;return{Yji:N,mkm:K}}LZh(P,N){let K;K=0;if(!N)return{returnValue:!0,C0c:K};let O=0,V=0;for(;O<P.length;){let W;for(let T=O;T<P.length;T++){O=T;W=P.J(T);const Y=W.length;V+=Y;if(!(V<N)){if(V>N)if(W.f8a)P.tG(O),P.aD(O,W.F$c()),V-=Y;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
N),this.Yd.logger.Pg(Object.assign(new F.a,{uj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,C0c:K};break}}if(V===N)return O++,K=O,{returnValue:!0,C0c:K}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",N);this.Yd.logger.Pg(Object.assign(new F.a,{uj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,C0c:K}}lEk(P,N,K){let O=0;var V=0,W=!1;const T=this.Wo.jef.I5();
if(this.Wo.MQk())for(--N;0<=N;N--){let Y=P.J(N);if(this.Wo.rWc(Y)){V=P.J(N);O=V.runId;V=V.yg;W=!0;break}}W||((V=P.J(K))&&this.Wo.rWc(V)?(O=V.runId,V=V.yg):V=O=0);for(P=0;P<T.length;P++)K=T.J(P),K.S4()&&(W=K,this.Wo.rWc(K)?(W.runId=O,W.yg=V):(W.runId=0,W.yg=0));return T}fzi(P){if(2===P.length){const N=1===P.J(0).type?P.J(0):null;P=2===P.J(1).type;if(N&&P&&""===N.text)return!0}return!1}Uol(){const P=this.wx.VNm();if(!P&&0===this.wx.Lz)return this.WZb=this.Wo.hK.I5(),this.uxb=this.Zai(this.Wo),{returnValue:!0,
hJa:!1};if(0===this.Wo.Lz)return this.WZb=this.wx.hK.I5(),this.uxb=this.Zai(this.wx),{returnValue:!0,hJa:!1};(this.fzi(this.wx.hK)||this.fzi(this.Wo.hK))&&this.Yd.logger.BIi(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!P){var N=this.wx.uff(this.Wo);N&&this.Nsa(57)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.wx=new G(this.ksa,this.XKa,this.Og,!0,void 0,this.Osa),this.Wo=
new G(this.ksa,this.iua,this.Og,!0,void 0,this.Osa),N=this.wx.uff(this.Wo));if(N)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Yd.logger.Pg(Object.assign(new y.a,{uj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,hJa:!0}}var K;N=0;this.uxb=this.P1k(this.wx,this.Wo);({Yji:K,mkm:V}=this.ozh(!1));const O=this.wx.hK.I5();if(!({C0c:K}=this.LZh(O,K)).returnValue||(2===this.Wo.Lz||3===this.Wo.Lz)&&!({C0c:N}=
this.LZh(O,V)).returnValue)return{returnValue:!1,hJa:!1};if(2===this.Wo.Lz||3===this.Wo.Lz){this.jkc(O,N);this.jkc(O,K-1);var V=null;for(var W=N-1;W>=K;W--)2===O.J(W).type&&(V=O.J(W)),O.tG(W);0<O.length&&(W=O.J(O.length-1),2!==W.type&&4!==W.type&&V&&(this.Yd.runtime.Zb.Tx(78),this.Yd.runtime.Zb.isFeatureEnabled(78)&&(O.add(V),this.uxb.add(V.Lj))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",N-K-1,K)}if(1===this.Wo.Lz||3===this.Wo.Lz)V=this.Wo.jef,
P&&(V=this.lEk(O,K,N)),this.jkc(O,K-1),this.jkc(O,K),this.jkc(V,0),this.jkc(V,V.length-1),O.aD(K,V),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",K,P,V.fr());this.WZb=O;return{returnValue:!0,hJa:!1}}jkc(P,N){0>N||N>=P.length||(P=P.J(N),Object(k.a)(x.a,P)&&(P.aRa=!0))}qcd(P,N){let K;K=N;if(!this.initialize())return{returnValue:!1,U6a:P,Sqa:K};if(this.Wo.uff(this.wx))return this.V4a(!0),this.Yd.logger.Pg(Object.assign(new y.a,
{uj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,U6a:P,Sqa:K};if(0===this.Wo.Lz||3===this.Wo.Lz&&this.Wo.WNm())return{returnValue:!0,U6a:P,Sqa:N};let O;({Yji:O}=this.ozh(!0));N<O||N===O&&(1!==this.Wo.Lz||1===this.Wo.Lz&&1===this.wx.Lz&&N===this.wx.xA+this.wx.Fna)?K=N:(K=N+this.Wo.Fna-this.Wo.Lva,K<O&&(K=O));return{returnValue:!0,U6a:P,Sqa:K}}}Object(D.a)(M,"ParagraphMerge",null,[1805])},1981:function(D,I,c){c.r(I);D=c(0);var l=c(1660),f=c(1571),a=c(1535),k=c(1791),x=c(1570);class y{constructor(L=
"",J="",M="",P=-99999,N=-1,K=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=J?J:"";this.Type=M?M:"";this.Score=P;this.Age=N;this.Count=K}}Object(D.a)(y,"Suggestion",null,[]);class m{constructor(L,J){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=J}}Object(D.a)(m,"SuggestionGroup",null,[]);class r{}r.help="help";r.answer="answer";r.commands="commands";r.Zco="servicecommands";r.template="template";Object(D.a)(r,
"SuggestionGroupType",null,[]);var z=c(1504),v=c(1503),G=c(2),F=c(34);c.d(I,"InteractionLogger",function(){return H});class H{constructor(L,J,M){this.Vye=0;this.hUe=this.Pxc=null;this.te=L;this.lSe=this.kwe=this.LDe=!1;this.NYj=J;this.Wf=G.AFrameworkApplication.He;this.fc=M;this.wid=this.RMe=0}get Kqa(){return this.te.Kqa}Gge(L){this.te.Gge(L)}EJi(){if(this.Pxc){var L=0;for(const J of this.Pxc)this.te.O4m(J,L++);this.Pxc=null}}beginQuery(L,J,M){this.te.G4m(L,J,M)}fnb(L,J){this.te.nIk(L,J);this.LDe=
!0;this.lSe=!1}iya(){this.LDe=!1;this.kwe||(this.EJi(),this.te.pVh(this.Vye))}H4m(L,J){this.te.I4m(L,J)}Vjn(L,J,M,P,N){for(const K of this.NYj)if(L.startsWith(K)){this.lSe=!0;break}this.te.U1m(L,J,M,P,N)}Bkn(L){this.kwe=!1;this.Vye=L;this.LDe||this.lSe||(this.EJi(),this.te.pVh(this.Vye,!1))}Akn(L,J){this.te.$1m(L,J);this.kwe=!0}Xlf(L,J){if(!L.count)return"";let M="";const P=Date.now();for(let N of L)L=(P-N.timeStamp)/1E3,L=v.a.bme(L),0<M.length&&(M+=";"),M+=J?N.commandId:N.controlId,M+=":",M+=L.toString();
return M}I5a(){var L=this.Xlf(l.a.instance.dPc(),!1);0<L.length&&this.te.S1m(L);L=this.Xlf(l.a.instance.bib(),!0);0<L.length&&this.te.l1m(L);L=this.Xlf(l.a.instance.Huc,!0);0<L.length&&this.te.N2m(L);L=z.TellMeActor.instance.p6g;0<L.length&&this.te.E4m(F.c(L))}$4m(L){this.te.z1m(L)}M9(L,J,M,P,N,K,O,V=null){this.te.H3m(L,J,M,P,N,K,O,V)}fMf(L,J,M,P){this.te.fMf(L,J,M,P)}OA(L,J,M=null){this.te.MG(L,J,M)}onError(L,J,M=null){this.te.AGa(L,J,M)}Hho(L){this.Pxc=L}Idm(L){const J=[];if(!L)return J;for(let M=
0;M<L.length;M++){const P=a.a[L[M].groupType].toLowerCase(),N=[],K=L[M].results;if(K){for(let O=0;O<K.length;O++)"findindocument"===P?Array.add(N,new y("","",P,K[O].score,K[O].GBd,K[O].count)):Array.add(N,new y(K[O].label,K[O].description,P,K[O].score,K[O].GBd,K[O].count));"answer"===P||"definition"===P||"wolframanswer"===P||"entity"===P?Array.add(J,new m(N,r.answer)):"classifier"===P||"appsforoffice"===P?Array.add(J,new m(N,r.commands)):"serviceclassifier"===P?Array.add(J,new m(N,r.Zco)):"assistance"===
P?Array.add(J,new m(N,r.help)):("document"===P||"people"===P||"findindocument"===P||"notes"===P||"image"===P||"template"===P)&&Array.add(J,new m(N,P))}}return J}Jtf(L,J){const M={};M.Query=J;M.SuggestionGroups=F.c(this.Idm(L));return F.c(M)}phi(L){const J={"Content-Type":"application/json",Accept:"application/json"};J["X-Office-Version"]=G.AFrameworkApplication.buildVersion;J["X-Office-Application"]=G.AFrameworkApplication.K.kb("Application");J["X-Office-Platform"]="WAC";J["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.kb("LoggableUserId")||
"";J["X-TellMe-SessionId"]=this.te.Kqa.dpa;J["X-TellMe-SuggestionTypes"]="Ranker";J["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;J["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;J["X-TellMe-Flights"]=L;J["X-TellMe-PartialQueryIndex"]=this.RMe;return J}qMb(L,J,M){this.M9(J.length,"RankerLogging",L.data.Qe.toString(),Math.round(window.performance.now()-M),x.a.Twj,!0,f.a.lQa)}ZLb(L,J,M){this.M9(J.length,"RankerLogging",L.data.Qe.toString(),Math.round(window.performance.now()-
M),x.a.Twj,!1,f.a.lQa)}qhi(){this.hUe||(this.hUe=new k.a(this.fc,null,6E3));return this.hUe.baa}hMf(L){const J=this.Jtf(this.Pxc,L),M=this.phi("RankerLogging"),P=window.performance.now();this.Wf.sj(this.qhi(),2,J,M,!1,0,N=>{this.qMb(N,L,P)},N=>{this.ZLb(N,L,P)},null,null,!1,4E3,6E3);this.RMe++}W3n(){this.RMe=0}Qbg(L){this.wid=L}}Object(D.a)(H,"InteractionLogger",null,[])},1983:function(D,I,c){c.r(I);D=c(0);var l=c(16),f=c(6),a=c(179),k=c(224),x=c(60),y=c(1724),m=c(1641),r=c(1594),z=c(1575);class v{constructor(L,
J,M=null){this.author=L;this.Q_c=J;this.h1f=M||x.a.nil}IA(L){return L?this.author===L.author&&this.Q_c===L.Q_c&&this.h1f===L.h1f:!1}}Object(D.a)(v,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(L,J,M){this.insertion=L||G.Hgf;this.deletion=J||G.Hgf;this.AHa=M||G.Hgf}get aqm(){return 0<this.insertion.author.length}get Epm(){return 0<this.deletion.author.length}get Eqm(){return 0<this.AHa.author.length}IA(L){return L?this.insertion.IA(L.insertion)&&this.deletion.IA(L.deletion)&&this.AHa.IA(L.AHa):
!1}}G.Hgf=new v("",0);Object(D.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var F=c(1788);c.d(I,"ParagraphMergeBlockCreator",function(){return H});class H extends m.a{constructor(L,J,M,P,N,K,O){super();this.maxValue=Number.MAX_VALUE;this.jB=new y.a;this.BUb=null;this.gO=0;this.B_g=!1;this.Kyc="";this.ose=L;this.Ss=J;this.Du=M;this.Aik=P;this.Ykd=N;this.MZg=K;this.Og=O;if(this.Og.hasProperty(this.Ss,l.a.vo))if(this.Og.hasProperty(this.Ss,f.a.Wc))if(this.Og.hasProperty(this.Ss,f.a.rq))if(this.Og.hasProperty(this.Ss,
f.a.kt))if(this.Og.hasProperty(this.Ss,l.a.Ln))if(this.h3=this.Og.getPropertyString(this.Ss,l.a.vo),this.nXe=this.Og.getPropertyUint32(this.Ss,f.a.Wc),this.vs=this.Og.getPropertyUint32s(this.Ss,f.a.rq),this.psd=this.Og.getPropertyUint32s(this.Ss,f.a.kt),this.XAe=this.Og.getPropertyObjectIds(this.Ss,l.a.Ln),this.h3||""===this.h3)if(this.h3.length||1!==this.XAe.length||(this.vs.length||(this.vs.add(0),a.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.psd.length||(this.psd.add(0),a.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.W$j=this.tPd(this.Ss,f.a.fSf,this.vs.length),this.uAc=this.tPd(this.Ss,l.a.aya,this.vs.length),this.gma=this.tPd(this.Ss,l.a.dqb,this.vs.length),this.tla=this.tPd(this.Ss,f.a.UPa,this.vs.length),this.Rla=this.Xgm(this.Ss,f.a.CHa,this.vs.length),this.Gxm(),L=this.Og.hasProperty(this.Ss,l.a.Dm)?this.Og.getPropertyUint32s(this.Ss,l.a.Dm):new k.a,this.dvd=
z.a.wlj(L,this.h3.length),this.vs.length!==this.psd.length)a.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",J.id);else if(this.vs.length!==this.XAe.length)a.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",J.id);else{this.MZg&&(this.Og.hasProperty(this.Ss,f.a.Hv)?this.BUb=this.Og.getPropertyObjectIds(this.Ss,f.a.Hv):(a.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
J.id),this.BUb=this.U_(this.vs.length,x.a.nil)),this.vs.length!==this.BUb.length&&(a.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",J.id,this.vs.length,this.BUb.length),this.BUb=this.U_(this.vs.length,x.a.nil)));if(this.vs.length!==this.uAc.length||this.vs.length!==this.gma.length||this.vs.length!==this.tla.length||this.vs.length!==this.Rla.length)this.vs.length===this.uAc.length||this.Ykd||a.a.instance.Ua(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",J.id,this.vs.length,this.uAc.length),this.vs.length===this.gma.length||this.Ykd||a.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",J.id,this.vs.length,this.gma.length),this.vs.length===this.tla.length||this.Ykd||a.a.instance.Ua(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",J.id,this.vs.length,this.tla.length),this.vs.length===this.Rla.length||this.Ykd||a.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",J.id,this.vs.length,this.Rla.length),L=this.Og.getPropertyBool(this.Ss,l.a.k9e),a.a.instance.Ua(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",J.id,N,null==L?!1:L),this.uAc=this.U_(this.vs.length,!0),this.gma=this.U_(this.vs.length,!1),this.tla=this.U_(this.vs.length,!1),this.Rla=this.U_(this.vs.length,0),this.Og.setPropertyBool(this.Ss,l.a.k9e,!1);this.jB.W_o(this.vs.length)?(this.dvd.length!==this.vs.length+1&&a.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
J.id,this.vs.length,this.dvd.length),this.X7j=!0):a.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",J.id)}else a.a.instance.Ua(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id)}Gxm(){this.Og.hasProperty(this.Ss,f.a.NFa)?this.jB.fkb=this.Og.getPropertyBools(this.Ss,f.a.NFa):this.jB.fkb=this.U_(this.vs.length,!1);this.Og.hasProperty(this.Ss,f.a.Sga)?this.jB.ygb=this.Og.getPropertyBools(this.Ss,f.a.Sga):
this.jB.ygb=this.U_(this.vs.length,!1);this.Og.hasProperty(this.Ss,f.a.OFa)?this.jB.ekb=this.Og.getPropertyStrings(this.Ss,f.a.OFa):this.jB.ekb=this.U_(this.vs.length,"");this.Og.hasProperty(this.Ss,f.a.hEa)?this.jB.xgb=this.Og.getPropertyStrings(this.Ss,f.a.hEa):this.jB.xgb=this.U_(this.vs.length,"");this.Og.hasProperty(this.Ss,f.a.PFa)?this.jB.gkb=this.Og.getPropertyListOfMilliseconds(this.Ss,f.a.PFa):this.jB.gkb=this.U_(this.vs.length,0);this.Og.hasProperty(this.Ss,f.a.iEa)?this.jB.J0a=this.Og.getPropertyListOfMilliseconds(this.Ss,
f.a.iEa):this.jB.J0a=this.U_(this.vs.length,0);this.Og.hasProperty(this.Ss,f.a.BHa)?this.jB.k6a=this.Og.getPropertyBools(this.Ss,f.a.BHa):this.jB.k6a=this.U_(this.vs.length,!1);this.Og.hasProperty(this.Ss,f.a.dJa)?this.jB.bob=this.Og.getPropertyStrings(this.Ss,f.a.dJa):this.jB.bob=this.U_(this.vs.length,"");this.Og.hasProperty(this.Ss,f.a.eJa)?this.jB.dob=this.Og.getPropertyListOfMilliseconds(this.Ss,f.a.eJa):this.jB.dob=this.U_(this.vs.length,0);this.Og.hasProperty(this.Ss,f.a.Qza)?this.jB.cob=this.Og.getPropertyObjectIds(this.Ss,
f.a.Qza):this.jB.cob=this.U_(this.vs.length,x.a.nil)}tPd(L,J,M){return this.Og.hasProperty(L,J)?this.Og.getPropertyBools(L,J):this.U_(M,!1)}Xgm(L,J,M){return this.Og.hasProperty(L,J)?this.Og.getPropertyUint32s(L,J):this.U_(M,0)}U_(L,J){const M=new k.a;for(let P=0;P<L;P++)M.add(J);return M}rfm(L){const J=this.dvd.Zf(L);L=this.dvd.Zf(L+1);return this.h3.substring(J,L)}nbi(){if(this.B_g)return null;var L=this.gO<this.vs.length?this.vs.Zf(this.gO):this.maxValue;if(L===this.maxValue||this.Aik&&!this.h3.length)return this.B_g=
!0,L=new r.a(this.Du,this.Ss.id,this.nXe),this.Kyc=this.L0e(this.Kyc,L.toString()),L;const J=this.psd.Zf(this.gO),M=this.XAe.Zf(this.gO),P=this.W$j.Zf(this.gO),N=this.uAc.Zf(this.gO),K=this.gma.Zf(this.gO),O=this.tla.Zf(this.gO),V=this.Rla.Zf(this.gO),W=this.MZg?this.BUb.Zf(this.gO):null;var T=null;this.jB.fkb.Zf(this.gO)&&(T=new v(this.jB.ekb.Zf(this.gO)||"",this.jB.gkb.Zf(this.gO)));var Y=null;this.jB.ygb.Zf(this.gO)&&(Y=new v(this.jB.xgb.Zf(this.gO)||"",this.jB.J0a.Zf(this.gO)));var ba=null;this.jB.k6a.Zf(this.gO)&&
(ba=new v(this.jB.bob.Zf(this.gO)||"",this.jB.dob.Zf(this.gO),this.jB.cob.Zf(this.gO)));T=new G(T,Y,ba);Y=this.rfm(this.gO);this.gO++;ba=Y.startsWith("\ufddfHYPERLINK ");L=new F.a(this.ose,this.Du,this.Ss.id,J,L,M,Y,P,!ba,N,K,O,V,T,W);this.Kyc=this.L0e(this.Kyc,L.toString());return L}Xai(){let L;L=null;var J="";if(!this.X7j)return{gOf:L,i5a:J};if(J=this.nbi())L=new k.a,L.add(J);for(;J=this.nbi();)L.add(J);J=this.Kyc;return{gOf:L,i5a:J}}}Object(D.a)(H,"ParagraphMergeBlockCreator",m.a,[])},1987:function(D,
I,c){c.r(I);D=c(0);var l=c(224),f=c(1641),a=c(1593);class k extends a.a{constructor(y,m){super(4,y,m)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Lj)}G8b(){return"Table"}clone(){return new k(this.source,this.Lj)}IA(y,m,r,z=!1){return super.IA(y,m,r,z)?this.Lj.equals(y.Lj):!1}get length(){return 1}}Object(D.a)(k,"TableMergeBlock",a.a,[]);c.d(I,"TableMergeBlockCreator",function(){return x});class x extends f.a{constructor(y,m){super();this.oLg=new k(m,y.id)}Xai(){let y;
y=new l.a;y.add(this.oLg);return{gOf:y,i5a:this.L0e("",this.oLg.toString())}}}Object(D.a)(x,"TableMergeBlockCreator",f.a,[])},2075:function(D,I,c){c.r(I);var l=c(2),f=c(0),a=c(54),k=c(168);class x extends k.a{constructor(R){super(!1,!1,!0);this.OJa=R}start(){var R={["tooltipPersistenceEnabled"]:this.OJa.Nyf};l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(R.textSelectionChangeEnabled=this.OJa.Yke);R={["id"]:"AccessibilitySettingsDialog",
["bodyControls"]:R};this.Qh("",Object(a.a)(this,this.o9f,"resultHandler"),R)}o9f(R,Ba){1===R&&(this.OJa.Nyf=Ba.tooltipPersistenceEnabled,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.OJa.Yke=Ba.textSelectionChangeEnabled))}}Object(f.a)(x,"AccessibilitySettingsDialog",k.a,[]);var y=c(70),m=c(13);class r{constructor(R,Ba){this.ga=R;this.OJa=Ba}Tb(){this.ga.ra(m.a.Tso,y.a.frame,Object(a.a)(this,this.Uso,"showAccessibilitySettingsDialogHandler"))}Uso(){(new x(this.OJa)).start();
return 32}}Object(f.a)(r,"AccessibilitySettingsDialogActor",null,[1702]);var z=c(462);const v=R=>{const Ba=new z.a;l.AFrameworkApplication.He.sj(G(R),1,null,null,!0,2,lb=>{200===lb.data.Qe?Ba.Ag("true"===lb.data.se.toLowerCase()):Ba.Ag(!1)},()=>{Ba.Ag(!1)},null,void 0,void 0,void 0,void 0,"7");return Ba.task},G=R=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",R,l.AFrameworkApplication.km);var F=c(125);class H{constructor(){this.tUe=
this.bXb=null}get Nyf(){return!!this.bXb}set Nyf(R){R!==this.bXb&&(this.bXb=R,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(R),this.IAi()&&l.AFrameworkApplication.He.sj(G("saveHoverableRibbonTooltipIsEnabled"),2,R.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get Yke(){return!!this.tUe}set Yke(R){R!==this.tUe&&(this.tUe=R)}d0m(){const R=new z.a;if(this.bXb)R.Ag(this.bXb);else if(this.IAi()){const Ba=v("getHoverableRibbonTooltipIsEnabled");
Ba.continueWith(()=>{this.bXb=Ba.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Ba.result);R.Ag(Ba.result)},8)}else R.Ag(!1)}IAi(){const R=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),Ba=l.AFrameworkApplication.K.$("IsAnonymousUser");return R&&!Ba}}Object(f.a)(H,"AccessibilitySettingsInfo",null,[1701]);var L=c(181),J=c(35);class M{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}wc(R){this.W=R;this.W.register(H,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Sd(()=>
new H).ha();this.W.register(r,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Sd(()=>new r(l.AFrameworkApplication.va,this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const R=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Ba=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");R&&Ba?(Ba.Tb(),R.d0m()):J.b(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){L.a.instance.Gc(new M)}}Object(f.a)(M,"AccessibilitySettingsPackage",null,[1,2]);var P=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},N=c(80);class K extends Sys.EventArgs{constructor(R,Ba){super();this.ile=R;this.actualValue=Ba}}Object(f.a)(K,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class O{constructor(){this.$Ub=[];this.fPg=this.zwe=0;this.oi=null;this.sa=new N.a}init(R,Ba,lb){this.oi=R;this.zwe=Ba;this.fPg=lb;this.oi.XZe(Object(a.a)(this,this.e6d,"onCpuMeterFrameAvailable"));this.Ovk(Object(a.a)(this,this.S6k,"cpuPercentThresholdExceeded"))}e6d(R,
Ba){Ba.xPi&&(Array.enqueue(this.$Ub,Ba.xPi.CP),this.$Ub.length>this.fPg&&(Array.dequeue(this.$Ub),this.ITk()))}ITk(){var R=this.$Ub.length;let Ba=0;for(let lb=0;lb<R;lb++){const Vb=Array.dequeue(this.$Ub);Ba+=Vb;Array.enqueue(this.$Ub,Vb)}R=Ba/R;R>this.zwe&&this.sa.raiseEvent("CPTTE",new K(this.zwe,R))}S6k(R,Ba){J.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.fId(Ba.ile,Ba.actualValue))}Ovk(R){this.sa.addHandler("CPTTE",R)}fId(R,Ba){const lb={};lb.ThresholdValue=R;lb.ActualValue=
Ba;return lb}}Object(f.a)(O,"CpuMeterMonitor",null,[1711]);class V{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(V,"ProfileInformation",null,[]);var W=c(11),T=c(38),Y=c(241),ba=c(85);class Z{constructor(R=0,Ba=0){this.ovb=!1;this.Iub={};this.$pd=R;this.qqd=Ba;this.QVe=0;T.a.addHandler(window.self,W.a.Mqh,()=>{this.ovb=!0});T.a.addHandler(window.self,W.a.Nqh,()=>{this.ovb=!1})}Pqh(R,Ba,lb){const Vb=Z.generateKey(Ba,lb);Vb in this.Iub?Ba=this.Iub[Vb]:(Ba=new V,Ba.S=lb?1:0,this.Iub[Vb]=Ba,
this.QVe++);Ba.C++;Ba.M=R>Ba.M?R:Ba.M;Ba.T+=R}SCa(R,Ba){this.Pqh(R,Ba,!1);this.ovb&&this.Pqh(R,Ba,!0)}getData(){if(0<this.qqd&&this.QVe>this.qqd)return this.eSl();const R=0<this.$pd,Ba={},lb=this.Iub;for(let zc in lb){var Vb=zc;const Yc=lb[zc];this.sej(Yc);R&&Yc.T>=this.$pd&&(Ba[Vb]=Yc)}return R?ba.a.Xe(Ba)?null:Ba:this.Iub}eSl(){var R=0<this.$pd,Ba=[];const lb=this.Iub;for(let Vb in lb){const zc={key:Vb,value:lb[Vb]};let Yc=zc.value;(!R||Yc.T>=this.$pd)&&Array.add(Ba,zc)}if(Ba.length>this.qqd)Ba.sort((Vb,
zc)=>zc.value.T-Vb.value.T),Ba=Ba.slice(0,this.qqd);else if(!Ba.length)return null;R={};for(const Vb of Ba)Ba=Vb.value,this.sej(Ba),R[Vb.key]=Ba;return R}sej(R){R.M=Y.a.lV(R.M,0);R.T=Y.a.lV(R.T,0)}reset(){this.Iub={};this.QVe=0}static generateKey(R,Ba){return Ba?R+" [it]":R}}Object(f.a)(Z,"FunctionCallAggregator",null,[861]);var ea=c(1093);class ha{}Object(f.a)(ha,"CpuMeterFrame",null,[]);class la extends Sys.EventArgs{constructor(R){super();this.xPi=R}}Object(f.a)(la,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class ia{}Object(f.a)(ia,"MiniTaskItemInfo",null,[]);class sa{}Object(f.a)(sa,"TaskItemInfo",null,[]);var Oa=c(1055),Ra=c(1409),Na=c(192);class Da{constructor(R,Ba,lb,Vb,zc){this.Xyb=0;this.b_=null;this.gvd=this.$fh=0;this.gdh=!1;this.pWb=0;this.Rwc=!1;this.uta=null;this.knd=0;this.mLe=new N.a;this.Fxd=[];this.$z=R;this.fJe=Ba;this.cBe=lb;this.V4g=Vb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.Tdc();this.y0j=zc;this.dBe=new Z(100);
this.I9j=Oa.a.hF(1,5,new Ra.a)}XZe(R){this.mLe.addHandler("OnCpuMeterFrameAvailable",R)}R$i(R){this.mLe.removeHandler("OnCpuMeterFrameAvailable",R)}eob(R,Ba,lb,Vb=null){lb=Vb?Vb.priority:7;const zc=this.$z();this.start(Ba,lb);try{R()}finally{this.stop(Ba,Vb),R=this.$z()-zc,this.V4g.track(R,Ba)}}ge(R,Ba){const lb=this.$z();try{R()}finally{R=this.$z()-lb,this.cBe.SCa(R,Ba),0<this.Xyb&&this.dBe.SCa(R,Ba),this.V4g.track(R,Ba)}}pXf(R){const Ba=new sa;Ba.TN=R.AMf;Ba.TP=R.priority;this.l5i(1,Ba)}Wec(R){this.knd|=
R}start(R,Ba){if(!this.Xyb){this.dBe.reset();const lb=this.TCi(R);lb&&this.p3d(1);this.b_=new sa;this.b_.TN=R;this.b_.TP=Ba;this.b_.ST=(new Date).toISOString();this.b_.STS=Y.a.lV(this.$z(),2);lb?this.b_.UI=1:this.bOm(R)?this.b_.UI=2:this.b_.UI=0}this.Xyb++}p3d(R){this.pWb|=R}jFd(R=!0,Ba=0){this.pWb=R?0:this.pWb&~Ba}stop(R,Ba=null){let lb;this.Xyb--;0>=this.Xyb&&this.b_&&(lb=this.$z()-this.b_.STS,this.gvd+=lb,this.fJe.SCa(lb,R),this.TCi(R)&&this.jFd(!1,1),this.b_.TRT=Y.a.lV(lb,2),Ba&&(this.b_.TQT=
Y.a.lV(Ba.PKn,2),this.b_.TDT=Y.a.lV(Ba.fEi,2)),this.y0j&&(this.l5i(0,this.b_),this.s2n()),this.Xyb=0);0<=R.indexOf(ea.a.oOo)&&this.Wec(2);0<=R.indexOf(ea.a.gbj)&&this.Wec(4);1===(this.pWb&1)&&this.Wec(1);2===(this.pWb&2)&&this.Wec(8)}s2n(){var R=this.b_.TRT;if(750<R){let lb=this.dBe.getData();if(lb){const Vb={};for(let zc in lb){var Ba=lb[zc];const Yc=zc;Yc.startsWith("SiOp_")||Yc.endsWith("[it]")||(Vb[Yc]=Math.round(100*Ba.T/R))}lb=Vb}R=Object.assign(new ia,{B:this.b_.STS,T:R,S:lb});this.I9j.track(R,
this.b_.TN)}}yxo(){var R=this.$z()-this.$fh,Ba=Y.a.lV(this.gvd/R*100,2);R=new ha;R.CP=Ba;R.II=this.knd;Ba=this.fJe.getData();ba.a.count(Ba)&&(R.LRT=Ba);Ba=this.cBe.getData();ba.a.count(Ba)&&(R.FP=Ba);this.mLe.raiseEvent("OnCpuMeterFrameAvailable",new la(R));this.Atj()}Atj(){this.fJe.reset();this.cBe.reset();this.gvd=this.Xyb=0;this.$fh=this.$z();this.knd=0;this.b_=null}run(){this.gdh?this.yxo():(this.Atj(),this.gdh=!0);this.uta?this.uta(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,
this.run,"run"),1E3)}AAd(R,Ba,lb){const Vb=Array(2);Vb[0]=Ba;Vb[1]=lb;this.Fxd[R]||(this.Fxd[R]=[]);this.Fxd[R].push(Vb)}l5i(R,Ba){R=this.Fxd[R];if(!Na.a.Xe(R))for(let Vb=0;Vb<R.length;Vb++){var lb=R[Vb];const zc=lb[0];lb=lb[1];zc&&!zc(Ba)||lb(Ba)}}Tdc(){if(!this.Rwc){const R=window.setTimeout;this.uta=(Ba,lb)=>R(Ba,lb);this.Rwc=!0}}TCi(R){return R.startsWith("key")||R.startsWith("input")}bOm(R){return R.startsWith("click")||R.startsWith("mouse")||R.startsWith("pointer")}}Object(f.a)(Da,"CpuMeter",
null,[154]);class ra{constructor(R){this.rsc=null;this.fq=new z.a;this.$z=R}initialize(R,Ba,lb,Vb=!1){this.rsc||(this.rsc=new Da(this.$z,R,Ba,lb,Vb),this.fq.Ag(this.rsc));return this.rsc}}Object(f.a)(ra,"CpuMeterProvider",null,[1705]);var xa=c(167);class fa{constructor(R=1){this.FD=[];this.Yid=[];this.Xj=R}bCl(){let R=0;for(let Ba=0;Ba<this.FD.length;Ba++)this.FD[Ba]<this.FD[R]&&(R=Ba);return R}SCa(R,Ba){R=Y.a.lV(R,2);if(this.FD.length<this.Xj)Array.add(this.FD,R),Array.add(this.Yid,Ba);else{var lb=
this.bCl();R>this.FD[lb]&&(this.FD[lb]=R,this.Yid[lb]=Ba)}}getData(){return this.FD.length?{["Vals"]:this.FD,["Desc"]:this.Yid}:null}reset(){this.FD=[];this.Yid=[]}}Object(f.a)(fa,"MaxDataAggregator",null,[861]);var oa=c(39),ta=c(22);class Ka{get name(){return"Common.App.CpuMeter"}wc(R){R.register(ra,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().Sd(()=>new ra(oa.a.We));R.register(O,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().Sd(()=>
new O)}init(){const R=l.AFrameworkApplication.K;if(R.$("CpuMeterIsEnabled")){const Ba=ta.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");xa.a.instance.YBd.continueWith(()=>{Ka.tym(R,Ba)})}}dispose(){}static tym(R,Ba){const lb=Oa.a.hF(10,5,new Z(R.lc("TaskManagerLoggingThreshold",0),R.lc("CpuMeterMaximumEntriesToLog",0)));Ba=Ba.initialize(new fa(5),new Z,lb,R.$("CPUMeterExposeTaskDetailsIsEnabled"));R.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(Ba.run(),R.$("CpuMeterMonitorIsEnabled")&&
ta.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ba,R.lU("CpuMeterAverageCpuPercentThreshold",80),R.lc("CpuMeterRollingAverageFramesCount",15)));J.b(16827671,306,50,"Initializing CpuMeter")}static main(){L.a.instance.Gc(new Ka)}}Object(f.a)(Ka,"CpuMeterPackage",null,[1,2]);var va=c(7),La=c(86),za=c(1081),Ca=c(1060),ua=c(20),ib=c(1410);class bb{constructor(){this.Ata=this.iqc=null;this.l1b=!0;this.bxc=!1}wc(R){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&R.register(1661,
"Common.IEventTimingMeter").ha().Sd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var R=new Ca.a(l.AFrameworkApplication.K.lc("EventTimingMeterEventSamplingPercent",0)/100);R=new za.a(Object(a.a)(R,R.jQb,"shouldBeInSample"));const Ba=Oa.a.hF(16,1,R);this.Ata=new ib.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.lU("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.lU("AshaVetoForTypingThresholdPercentile",
95),this.l1b);(this.bxc=!ua.a.o4a)&&l.AFrameworkApplication.lI(()=>{this.G6e()});this.iqc=lb=>{lb=lb.rawEvent.detail;for(const Vb of lb)Ba.track(Vb,"EventTimingData"),"false"!==Vb.metadata.altPressed.toString()||"false"!==Vb.metadata.ctrlPressed.toString()||"false"!==Vb.metadata.repeat.toString()||"CharacterKey"!==Vb.metadata.key.toString()&&"Space"!==Vb.metadata.key.toString()||!this.bxc||this.Ata.Lya(Vb.timeToRequestAnimationFrameMs)};T.a.addHandler(window.self,W.a.Lqh,this.iqc)}dispose(){this.iqc&&
(T.a.removeHandler(window.self,W.a.Lqh,this.iqc),this.iqc=null)}G6e(){this.Ata.XSa();this.Ata.HYi&&(va.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),La.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){L.a.instance.Gc(new bb)}}Object(f.a)(bb,"EventTimingMeterPackage",null,[1,2]);var mb=c(75),yb=c(69),ab=c(34);class Ga{constructor(R,Ba,lb,Vb=null,zc=null){this.eM=R;this.Tub=Ba;this.gvc=lb;this.Q$g=
Vb;this.HAc=zc}pif(R){const Ba=new Sys.StringBuilder(this.eM.h7c);Ba.append("RoamingServiceHandler.ashx?action=");Ba.append("getFirstRunExperienceSettings");Ba.append("&");Ba.append(this.tsf(R));Ba.append("&");Ba.append(l.AFrameworkApplication.km);l.AFrameworkApplication.He.sj(Ba.toString(),1,null,null,!0,2,Object(a.a)(this,this.z2a,"getRequestSuccessCallback"),Object(a.a)(this,this.zoa,"getRequestFailureCallback"),null)}GMd(R){var Ba=new Sys.StringBuilder(this.eM.h7c);Ba.append("RoamingServiceHandler.ashx?action=");
Ba.append("saveFirstRunExperienceSettings");Ba.append("&");Ba.append(l.AFrameworkApplication.km);Ba=Ba.toString();R=ab.c(R);l.AFrameworkApplication.He.sj(Ba,2,R,null,!0,4,Object(a.a)(this,this.VCn,"postRequestSuccessCallback"),Object(a.a)(this,this.zHa,"postRequestFailureCallback"),null)}z2a(R){let Ba=!1,lb=null;try{if(0<R.data.se.length){const Vb=Object(yb.a)(Object,ab.a(R.data.se)),zc=Vb?Vb[this.eM.C0e]:null;zc&&(lb=Object(yb.a)(Object,ab.a(zc.toString())))}Ba=!0}catch(Vb){this.zoa(null)}Ba&&this.Tub&&
this.Tub(R.data,lb)}zoa(R){this.gvc&&this.gvc(R?R.data:null)}VCn(R){this.Q$g&&this.Q$g(R?R.data:null)}zHa(R){this.HAc&&this.HAc(R?R.data:null)}tsf(R){const Ba=new Sys.StringBuilder("requestedsettings=");for(let lb=0;lb<R.count;lb++)Ba.append(R.J(lb)),lb<R.count-1&&Ba.append(";");return Ba.toString()}}Object(f.a)(Ga,"FirstRunExperienceRequestHandler",null,[]);var Za=c(265);class Ub{constructor(){this.Quc=this.Jkd=this.eM=null}Zto(R){R?(this.eM=R,this.ZNm()&&(va.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
R=new mb.a,R.add(this.eM.C0e),this.Jkd=new Ga(this.eM,Object(a.a)(this,this.z2a,"getRequestSuccessCallback"),Object(a.a)(this,this.zoa,"getRequestFailureCallback"),null,Object(a.a)(this,this.zHa,"postRequestFailureCallback")),this.Jkd.pif(R)),(this.eM.jCi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Ofg()):va.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}ZNm(){try{if(this.eM.jCi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",
!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.eM.FIm||this.eM.zdc||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const R=l.AFrameworkApplication.K.kb("FlightId");return-1!==(R?R.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(R){va.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",R?R.toString():null)}return!1}lfj(R){const Ba={},lb={};lb.FREDisplayedDate=(new Date).toUTCString();lb.VersionDisplayed=R;lb.RemindMeLater=!1;Ba[this.eM.C0e]=
ab.c(lb);va.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Jkd&&this.Jkd.GMd(Ba)}z2a(R,Ba){R=R?+R.PT-+R.RH:-1;R>this.eM.cej?va.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",R,this.eM.cej):Ba?this.Qso(Ba)?(va.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.eM.GNi),this.Ofg()):(this.Jef(!1),va.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(va.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Ofg())}zoa(R){this.Jef(!1);va.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",R?R.Qe:-1)}zHa(R){va.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
R?R.Qe:-1)}Ofg(){this.Jef(!0);var R=ta.a.instance.Oa("Common.ISystemInitiatedFeedback");R?this.nqj(R):(va.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((R=ta.a.instance.Ta("Common.ISystemInitiatedFeedback"))?R.execute(Ba=>{this.nqj(Ba)}):va.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}nqj(R){if(R){var Ba=this.eM.GEl;
Ba&&(l.AFrameworkApplication.$n(Ba),l.AFrameworkApplication.zia(Ba));va.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ba);R.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Quc=Object(a.a)(this,this.Rln,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Quc,!0),window.addEventListener("FRELaunchedEvent",this.Quc,!0)):(va.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.lfj(this.eM.currentVersion))}else va.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}Rln(R){if(R){var Ba=R.detail;R=R.type;var lb=this.eM&&this.eM.Mzh?this.eM.Mzh.split("-")[0]:null;if("FRELaunchedEvent"===R||lb&&Ba&&Ba.id&&-1!==Ba.id.indexOf(lb))Ba.success&&(va.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.lfj(this.eM.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Quc,
!0),window.removeEventListener("FRELaunchedEvent",this.Quc,!0))}}Qso(R){if("RemindMeLater"in R&&"FREDisplayedDate"in R){if("true"===R.RemindMeLater.toString()&&(+new Date-+new Date(R.FREDisplayedDate.toString()))/36E5>this.eM.GNi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in R&&R.VersionDisplayed<this.eM.currentVersion)return va.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Jef(R){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Za.a.dispatch("FREDecisionEvent",{["show"]:R})}}Object(f.a)(Ub,"FirstRunExperienceLauncher",null,[1658]);class Xb{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}wc(R){this.W=R;this.W.register(1658,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().Sd(()=>new Ub)}init(){}dispose(){}static main(){L.a.instance.Gc(new Xb)}}Object(f.a)(Xb,"FirstRunExperienceLauncherPackage",null,[1,2]);class zb{constructor(){this.y=this.x=0}}Object(f.a)(zb,"HammerPoint",
null,[]);class Ib{constructor(R,Ba,lb,Vb,zc){this.Y2g=this.hXa=this.Xmd=1;this.Pyd=this.$Dc=this.CZa=0;this.zKe=this.pKa=null;this.qsb=this.pAe=this.Btd=!1;this.qj=R;this.SMa=Ba;this.xyb=lb;this.ga=Vb;zc&&(this.Btd=zc.$("PromoteLayerPinchToZoomIsEnabled"),this.pAe=zc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.qsb=zc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get BL(){return this.SMa}mLm(){return!!this.qj.instance}nmn(R){this.ga&&this.ga.processAction(m.a.Ntj,2);const Ba=this.qj.instance;
this.Btd&&Ba.a5i();this.hXa=Ba.ij;this.Xmd=R.tOc.scale;this.Y2g=1;this.zKe=this.szh();this.pKa=this.SMa.getBounds();if(!this.pKa)return va.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;R=this.ndi(R);this.qsb?this.Wkj(this.SMa.scrollWidth,this.pKa.width,R,this.hXa,Ba):this.CZa=this.SMa.scrollWidth>this.pKa.width?this.fHc(this.xyb.scrollLeft,R.x,this.hXa):null;this.Pyd=this.SMa.scrollHeight>this.pKa.height?this.fHc(this.xyb.scrollTop,R.y,this.hXa):null;return!0}S8f(){this.CZa=null;this.$Dc=
0}Wkj(R,Ba,lb,Vb,zc){R>Ba?this.CZa?(R=zc.EJf,R!==this.$Dc&&(this.CZa-=this.$Dc-R,this.$Dc=R)):(this.CZa=this.fHc(this.xyb.scrollLeft,lb.x,Vb),this.$Dc=zc.EJf):this.S8f()}mmn(R){const Ba=this.ndi(R);if(!Ba)return va.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;R=this.Wfo(R.tOc.scale/this.Xmd)*this.hXa;this.QWo(Ba,R);this.RWo(Ba,R);return!0}QWo(R,Ba){const lb=this.SMa.scrollWidth,Vb=this.pKa.width;this.qsb?this.Wkj(lb,Vb,R,Ba,this.qj.instance):!this.CZa&&lb>Vb&&(this.CZa=this.fHc(this.xyb.scrollLeft,
R.x,Ba));if(R=this.Azh(R.x,this.CZa,lb,Vb,Ba))this.xyb.scrollLeft=R}RWo(R,Ba){const lb=this.SMa.scrollHeight,Vb=this.pKa.height;!this.Pyd&&lb>Vb&&(this.Pyd=this.fHc(this.xyb.scrollTop,R.y,Ba));if(R=this.Azh(R.y,this.Pyd,lb,Vb,Ba))this.xyb.scrollTop=R}Azh(R,Ba,lb,Vb,zc){return lb<=Vb||!Ba||!Vb?null:Math.max(0,Math.min(Ba*zc-R,lb-Vb))}fHc(R,Ba,lb){return(R+Ba)/lb}lmn(R){R=R.tOc.scale;this.pAe&&(R/=this.Xmd);this.kZh(R);this.Btd&&this.qj.instance.f4f();this.ga&&this.ga.processAction(m.a.Ygf,2);this.qsb&&
this.S8f()}kmn(R){R=R.tOc.scale;this.pAe&&(R/=this.Xmd);this.kZh(R,!0);this.Btd&&this.qj.instance.f4f();this.ga&&this.ga.processAction(m.a.Ygf,2);this.qsb&&this.S8f()}Wfo(R){const Ba=this.qj.instance,lb=new Date>=this.zKe;lb&&(this.zKe=this.szh());Math.abs(R-this.Y2g)>=.01*R&&Ba.Smo(R*this.hXa,lb);return Ba.ij/this.hXa}kZh(R,Ba=!1){R*=this.hXa;this.qj.instance.Mdg(R,!1);const lb={};lb.initialScale=this.hXa;lb.finalScale=R;lb.cancelled=Ba;va.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",
lb)}ndi(R){return(R=R.tOc.center)&&this.pKa?Object.assign(new zb,{x:R.x-this.pKa.x,y:R.y-this.pKa.y}):null}szh(){const R=(new Date).getTime();return new Date(R+1E3)}}Object(f.a)(Ib,"PinchZoomAdapter",null,[1726]);class $a{constructor(R){this._element=R}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)($a,"ScrollContainerElement",null,[1725]);var Hb=c(131);class Ya{constructor(R,
Ba,lb,Vb,zc,Yc){this.fTe=this.Oab=null;this.W=R;this.he=Ba;this.nod=lb;this.S0g=Vb;this.j7j=zc;this.VWb=Yc;this.Ahd=new mb.a}register(R,Ba){this.nod&&(4===l.AFrameworkApplication.ua.Lb.Nk&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Hb.a.get_instance().lk(8,()=>{this.Mcj(R,Ba)}):this.Mcj(R,Ba))}Mcj(R,Ba){this.W.Ta("Common.IGestureInputManager").execute(lb=>{this.pAo();this.Oab=lb;this.Ahd.add(R);if(this.S0g){if(this.j7j&&0!==lb.EXl()){this.tuj();
return}var Vb=this.W.Ta("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const zc=new $a(R);Vb=new Ib(Vb,zc,Ba,l.AFrameworkApplication.va,l.AFrameworkApplication.K);lb.yTn(R,Vb)}this.tuj()})}unregister(){if(this.Oab&&this.Ahd){if(this.S0g){for(let R of this.Ahd)this.Oab.TPo(R);this.Ahd.clear()}this.Oab=null}}pAo(){this.VWb&&(this.he?this.fTe=this.he.Vf("Task","Register"):va.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}tuj(){this.VWb&&(this.fTe?this.fTe.stop():
va.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(Ya,"GestureInputRegistrar",null,[1662]);class Sa{constructor(){this.W=null;this.Xh=!1}get name(){return"Common.App.GestureInput"}init(){this.Xh||(this.W.resolve("Common.IGestureInputRegistrar"),this.Xh=!0)}dispose(){}wc(R){this.W=R;R.register(1662,"Common.IGestureInputRegistrar").ha().Sd(()=>new Ya(R,l.AFrameworkApplication.ua.Iq,l.AFrameworkApplication.wWc(),l.AFrameworkApplication.Nzi(),!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){L.a.instance.Gc(new Sa)}}Object(f.a)(Sa,"GestureInputPackage",null,[1,2]);var Eb=c(404),Jb=c(82);class vb{constructor(){this.oob=this.X2h=null}}Object(f.a)(vb,"GestureAdapterInfo",null,[]);var ac=c(632),dc=c(291);class Cc{constructor(){this.Ftb=null}$Kf(){if(!this.Ftb){var R="hammer.min.js";l.AFrameworkApplication.K.ow("IsServerFlavorDebug")&&
(R=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");R=l.AFrameworkApplication.Rz(String.format("{0}",R),5);R=dc.a.create(R,null,null);ac.a.FX(R);this.Ftb=R.R4a}return this.Ftb}static get instance(){Cc._instance||(Cc._instance=new Cc);return Cc._instance}}Cc._instance=null;Object(f.a)(Cc,"HammerJsDependencyLoader",null,[1727]);const Ec=(R,Ba,lb=null)=>{if(void 0===Ba||null===Ba)throw va.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Vb=null;switch(R){case W.a.pinch:Vb=new Hammer.Pinch(lb);break;case W.a.pan:Vb=new Hammer.Pan(lb)}Vb&&(Vb.manager=Ba);return Vb};var rc;(function(R){R[R.none=-1]="none";R[R.pinch=0]="pinch";R[R.pan=1]="pan";R[R.swipe=2]="swipe"})(rc||(rc={}));Object(f.b)("GestureEvent",rc);var hb=c(71);class fb extends hb.a{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){super(R,lb,Vb,Yc);this.Drc=Ba;this.fZa=Zd;this.ysa=$e;this.$1j=zc}get shiftKey(){return this.fZa}get ctrlKey(){return this.ysa}get clientPoint(){return this.Drc}get tOc(){return this.$1j}static create(R,
Ba,lb,Vb,zc,Yc){if(lb.rawEvent)if(Yc){var Zd=lb.rawEvent;Zd=new Sys.UI.Point(Zd.clientX,Zd.clientY)}else Zd=hb.a.EPd(lb);else Zd=new Sys.UI.Point(lb.clientX,lb.clientY);return new fb(R,Zd,Ba,lb,Vb,zc,lb.shiftKey,lb.ctrlKey,Yc)}}Object(f.a)(fb,"GestureEventArgs",hb.a,[]);class Nb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Nb,"GestureManagerData",null,[]);class Fb{}Fb.NPj=2;Fb.OPj=4;Fb.PPj=8;Fb.QPj=8;Object(f.a)(Fb,"HammerConstants",null,[]);var nb=c(94),pb=c(113),Xa=c(19),Pb=c(104);class Va extends T.a{constructor(R,Ba){super();this.DLa=Eb.a.LJl;this.uNe=!!window.PointerEvent;this.lih=window.hasOwnProperty("ontouchstart");this.Mub=this.Bzc=null;this.pLa=
!1;this.Pla=new Jb.a;this.FAc=new Jb.a;this.xVg=new mb.a;this.U$a=null;this.sUb=this.VWb=this.XMg=this.Mue=this.TIe=this.bch=this.nNg=this.gEc=!1;this.Dyc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.gTe=null;this.lg=nb.EventHandlerManager.instance;this.uNe?(va.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Bzc=Object(a.a)(this,this.r7d,"onPointerEvent"),this.Mub=W.a.NJl):this.lih?(va.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Bzc=Object(a.a)(this,
this.unb,"onTouchEvent"),this.Mub=W.a.touchEvents):(va.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Bzc=Object(a.a)(this,this.d7d,"onMouseEvent"),this.Mub=W.a.MJl);this.he=Ba;this.I2=R;l.AFrameworkApplication.K&&(this.gEc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.nNg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.bch=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.TIe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Mue=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.XMg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.VWb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.sUb=this.gEc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}EXl(){return this.uNe?0:this.lih?1:2}jv(R){super.jv(R);this.lg.GFa(this.Mub,R,0,this.Bzc)}av(R){super.av(R);
this.lg.G0a(R,this.Mub)}yTn(R,Ba){l.AFrameworkApplication.wWc()?Cc.instance.$Kf().continueWith(lb=>{this.oAo();if(lb.Ei||lb.Eo)va.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",lb.status);else{va.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",lb.status);if(this.XMg){lb=window.Hammer;if("undefined"===typeof lb){va.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Cje();return}if("undefined"===typeof lb.inputHandler){va.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.Cje();return}}if(!R)throw this.Cje(),Error.argumentNull("source element can not be null");lb=pb.a.Eb(R,this.DLa);if(void 0===lb||null===lb)lb=new Jb.a,pb.a.Nl(R,this.DLa,lb),this.zTn(R);if(!lb.nb(rc[0])){var Vb=Object.assign(new vb,{oob:Ec(rc[0],this,null),X2h:Ba});lb.add(rc[0],Vb)}}this.Cje()}):va.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}oAo(){this.VWb&&(this.he?this.gTe=this.he.Vf("Task",
"RegisterGestureAdapterAfterLoad"):va.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Cje(){this.VWb&&(this.gTe?this.gTe.stop():va.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}TPo(R){va.ULS.sendTraceTag(42256223,310,R?100:10,"source element {0} ",R.id);const Ba=pb.a.Eb(R,this.DLa);void 0!==Ba&&null!==Ba&&(Ba.remove(rc[0]),Ba.count||(pb.a.hV(R,this.DLa),this.curRecognizer=null,this.UPo(R)))}zTn(R){this.xVg.add(R);this.lg.GFa(this.Mub,R,
0,this.Bzc)}UPo(R){this.xVg.remove(R);this.lg.G0a(R,this.Mub)}recognize(R){var Ba=Array(R.pointers.length);for(var lb=0;lb<R.pointers.length;lb++)Ba[lb]=R.pointers[lb].target;lb=null;for(this.U$a=this.W1l(Ba);void 0!==this.U$a&&null!==this.U$a&&(lb=pb.a.Eb(this.U$a,this.DLa),void 0===lb||null===lb);this.U$a=this.U$a.parentNode);if(void 0!==lb&&null!==lb){this.curRecognizer&&this.curRecognizer.state===Fb.QPj&&(this.curRecognizer=null);Ba=lb.keys;for(let Vb of Ba){Ba=lb.J(Vb);void 0!==Ba&&null!==Ba&&
void 0!==Ba.oob&&null!==Ba.oob&&(void 0===this.curRecognizer||null===this.curRecognizer||Ba.oob===this.curRecognizer||Ba.oob.canRecognizeWith(this.curRecognizer))&&Ba.oob.recognize(R);const zc=Ba.oob.state;this.curRecognizer||Fb.NPj!==zc&&Fb.OPj!==zc&&Fb.PPj!==zc||(this.curRecognizer=Ba.oob)}}}emit(R,Ba){if("hammer.input"!==R){this.pLa=!1;Ba=fb.create(R,this.U$a,Ba.srcEvent,Ba,3,this.uNe);var lb=pb.a.Eb(this.U$a,this.DLa);if(this.UPm(R))var Vb=0;else if(this.sPm(R))Vb=1;else if(this.lTm(R))Vb=2;else{va.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:lb}=lb.Fc(rc[Vb]));void 0!==lb&&null!==lb&&((lb=lb.X2h,lb.mLm())?R.endsWith("start")?this.pLa=lb.nmn(Ba):R.endsWith("end")?(lb.lmn(Ba),this.pLa=!0):R.endsWith("cancel")?(lb.kmn(Ba),this.pLa=!0):R.endsWith("move")&&(this.pLa=lb.mmn(Ba)):va.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",R))}}get(R){return Object(yb.a)(Hammer.Recognizer,R)}W1l(R){if(1>R.length)return null;if(1===R.length)return R[0];
var Ba=R[0],lb=!0;for(let Vb=1;Vb<R.length;Vb++){if(!R[Vb])return null;if(Ba!==R[Vb]){lb=!1;break}}if(lb)return Ba;Ba=this.B3h(R[0]);lb=0;for(const Vb of R){R=this.B3h(Vb);if(Ba.J(Ba.count-1)!==R.J(R.count-1))return null;for(let zc=Ba.count-2,Yc=R.count-2;zc>=lb&&0<=Yc;zc--,Yc--)if(Ba.J(zc)!==R.J(Yc)){lb=zc+1;break}}return Ba.J(lb)}B3h(R){const Ba=new mb.a;for(;void 0!==R&&null!==R;R=R.parentNode)Ba.add(R);return Ba}r$h(R){switch(R){case W.a.YP:case W.a.hBb:return 1;case W.a.XP:case W.a.l4e:return 2;
case W.a.eK:case W.a.iBb:return 4;case W.a.Kle:case W.a.k4e:return 8}return 0}unb(R,Ba,lb){R=this.r$h(R);Ba=this.g_l(lb);Hammer.inputHandler(this,R,Ba);this.pLa&&lb.preventDefault();return this.pLa}tli(){return 1<this.Pla.count}kEd(){va.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.gEc)for(let R of this.Pla)this.W9i(R.key);else this.Pla=new Jb.a;this.session=null}Zrk(R,Ba,lb){va.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",R);if(!this.FAc.nb(R)){try{Ba.setPointerCapture(R)}catch(Vb){va.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Vb)}this.FAc.add(R,Ba)}this.Pla.Z(R,lb);this.sUb&&1<this.Pla.count&&this.I2&&!this.I2.pHc&&(this.I2.pHc=!0)}W9i(R){va.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",R);if(this.FAc.nb(R)){try{this.FAc.J(R).releasePointerCapture(R)}catch(Ba){va.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Ba)}this.FAc.remove(R)}else va.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",R);this.Pla.remove(R);this.sUb&&
1>=this.Pla.count&&this.I2&&this.I2.pHc&&(this.I2.pHc=!1)}r7d(R,Ba,lb){var Vb=lb.rawEvent.pointerType.toString();const zc=lb.rawEvent.pointerId.toString();if("touch"!==Vb)return!1;R=this.r$h(R);if(1!==R&&!this.Pla.nb(zc))return!1;this.nNg&&1===R&&lb.rawEvent.isPrimary&&this.Pla.count&&(va.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.kEd());this.gEc?this.Zrk(zc,Ba,lb):this.Pla.Z(zc,lb);this.TIe&&2===R&&(!this.Mue||this.Mue&&"function"===typeof lb.rawEvent.getCoalescedEvents)&&
(Ba=lb.rawEvent.getCoalescedEvents())&&this.tli()&&(this.Dyc=Math.max(this.Dyc,Ba.length));this.bch&&(this.pLa=!1);Vb=this.f_l(this.Pla,lb,Vb);Hammer.inputHandler(this,R,Vb);if(4===R||8===R)this.gEc?this.W9i(zc):this.Pla.remove(zc),this.Pla.count||(this.session=null,this.TIe&&-1!==this.Dyc&&(va.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Dyc),this.Dyc=-1));this.pLa&&lb.preventDefault();return this.pLa}d7d(){return!1}g_l(R){const Ba=new Nb;var lb=R.rawEvent;const Vb=
lb.touches;lb=lb.changedTouches;Ba.pointers=Array.clone(Vb);Ba.pointers=Array.clone(0<Vb.length?Vb:lb);Ba.changedPointers=Array.clone(lb);Ba.srcEvent=R;Ba.pointerType="touch";return Ba}f_l(R,Ba,lb){const Vb=new Nb;Vb.pointers=Pb.toArray(R.values);Vb.changedPointers=[Ba];Vb.pointerType=lb;Vb.srcEvent=Ba;return Vb}UPm(R){return Xa.a.startsWith(R,W.a.pinch)}sPm(R){return Xa.a.startsWith(R,W.a.pan)}lTm(R){return Xa.a.startsWith(R,W.a.swipe)}}Object(f.a)(Va,"GestureInputManager",T.a,[1699,1700]);var tb=
c(298);class cb{constructor(){this.W=null;this.Xh=!1}get name(){return"Common.App.GestureInputManager"}wc(R){R.register(Va,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().Sd(()=>new Va(tb.a.instance,l.AFrameworkApplication.ua.Iq));this.W=R}init(){this.Xh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Xh=!0)}dispose(){}static main(){L.a.instance.Gc(new cb)}}Object(f.a)(cb,"GestureInputManagerPackage",null,[1,2]);var Mb=c(247),mc=c(45),
Cb=c(1563);class Ja{constructor(R,Ba,lb){this.ARe=this.zRe=null;this.H_b=new z.a;this.Wf=R;this.tzc=lb;this.wma=Ba.appSettings[Ja.I1o]||""}get soo(){return this.H_b.task}get PQ(){return this.Wf.value}W2n(){const R={};R[Ja.ipm]=l.AFrameworkApplication.km;R["Content-Type"]="application/json; charset=utf-8";va.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Ba=mc.a.$o(this.wma+Ja.too,Ja.mhn,l.AFrameworkApplication.ua.Lb.Nk.toString());this.PQ.sj(Ba,
1,"",R,!0,2,Object(a.a)(this,this.rMb,"onSuccessCallback"),Object(a.a)(this,this.$Lb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}e4m(R){try{const Ba={};Ba.FlightName=R.FlightName;Ba.SessionID=R.SessionID;va.ULS.sendTraceTag(594883776,215,50,ab.c(Ba))}catch(Ba){va.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}rMb(R){if((R=R.data.se)&&R.length)try{const Ba=ab.a(R);this.zRe=Ba.NavBarDataJson;va.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.zRe?({Hu:this.ARe}=ab.d(Ba.NavBarDataJson)).returnValue?(this.e4m(this.ARe),this.H_b.Ag(this.ARe)):(va.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Cb.a.Ibd(this.zRe)}),this.H_b.Xda()):(va.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.H_b.Xda())}catch(Ba){va.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.H_b.Xda()}else va.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}$Lb(){this.H_b.Xda();
va.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Ja._instance||(Ja._instance=Ja.$Eb())}static $Eb(){return new Ja(new Mb.a(()=>l.AFrameworkApplication.He),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Lb.Nk)}}Ja.ipm="X-qs";Ja.mhn="at";Ja.too="O365ShellServiceProxy.ashx";Ja._instance=null;Ja.I1o="ShellWebServiceBase";Object(f.a)(Ja,"O365ShellActor",null,[1698]);class Wa{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}wc(R){this.W=
R;this.W.register(Ja,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().Sd(()=>new Ja(new Mb.a(()=>l.AFrameworkApplication.He),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Lb.Nk))}init(){l.AFrameworkApplication.K.Hn(Object(a.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){l.AFrameworkApplication.qpg&&l.AFrameworkApplication.ua.Lb.IJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").W2n()}dispose(){}static main(){L.a.instance.Gc(new Wa)}}Object(f.a)(Wa,
"PackageManager",null,[1,2]);class xb{CRa(){}init(){}dispose(){}}Object(f.a)(xb,"NoOpOfflineLogger",null,[1751,10]);var ic=c(792);class qc{}qc.WBd=0;Object(f.a)(qc,"OfflineLoggerConstants",null,[]);var Lc=c(92),Ac=c(248),gd=c(304);class Md{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){this.WIe=this.tyc=null;this.rXa=!1;this.i7=null;this.Fsc=this.hYb=this.ttb=0;this.VF=this.Ubb=this.Qgd=this.Dsd=this.yQ=null;this.fm=!1;this.KBa=lb;this.vCa=Vb;this.jCa=zc;this.Wf=Ba;this.Ib=R;this.tWa=Yc;this.gwb=!1;this.qXa=
$e;Zd?(this.Qgd=new Md(R,Ba,lb,Vb,zc,Yc,!1,$e),this.Qgd.Dsd=this,this.tyc="OfflineLoggerManifest|"+this.tWa,this.WIe="OfflineLog|"+this.tWa+"|"):(this.tyc="OfflineLoggerManifest",this.WIe="OfflineLog|")}init(){this.Ydg();this.j0m();this.rXa=!1;this.Wf.S1b(this);this.yQ=new Lc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Xb(this.yQ);this.Qgd&&this.Qgd.init()}TGc(R){return this.WIe+R}j0m(){const R=this.KBa.getItem(this.tyc);void 0!==R&&null!==R&&0<R.length&&(this.i7=
Md.Rbd(R));this.i7||(this.i7={});if(void 0===this.i7.end||null===this.i7.end)this.i7.end=0;if(void 0===this.i7.offset||null===this.i7.offset)this.i7.offset=0;this.ttb=this.i7.offset;isFinite(this.ttb)||(this.ttb=0);this.hYb=this.i7.end;isFinite(this.hYb)||(this.hYb=0);this.Fsc=this.hYb}Ydg(){this.Ubb=new gd.a;this.VF=new Ac.a;this.Dsd||(this.vCa.nph(Object(a.a)(this,this.FXf,"onUlsReadyToBeSent")),this.vCa.Sph(Object(a.a)(this,this.HXf,"onUlsSentSuccessfully")),this.vCa.Rph(Object(a.a)(this,this.GXf,
"onUlsSentFailed")));this.vCa.dph(Object(a.a)(this,this.ITf,"onAfterUlsHostDisposed"))}FXf(R,Ba){if(void 0!==Ba&&null!==Ba&&void 0!==Ba.args&&null!==Ba.args){R=!1;if(!this.Ubb.nb(Ba.args.tag)){if(!this.Ubb.nb(qc.WBd))return;R=!0}this.Ubb.remove(R?qc.WBd:Ba.args.tag);this.VF.nb(Ba.uploadId)||this.VF.Z(Ba.uploadId,new mb.a);this.VF.J(Ba.uploadId).add(Ba.args)}}HXf(R,Ba){this.VF.remove(Ba.uploadId);this.qXa&&this.gwb&&(this.gwb=!1,this.cDh())}GXf(R,Ba){this.gwb=!0;if(void 0!==Ba&&null!==Ba&&this.VF.nb(Ba.uploadId)){R=
this.VF.J(Ba.uploadId);for(let Vb=0,zc=R.count;Vb<zc;++Vb){var lb=Md.serialize(R.J(Vb),this.jCa);lb=this.Sbd(this.TGc(this.Fsc++),lb);this.qXa&&lb&&(1<this.VF.J(Ba.uploadId).count?this.VF.J(Ba.uploadId).remove(R.J(Vb)):this.VF.remove(Ba.uploadId))}}}ITf(){this.dispose()}Sbd(R,Ba){try{return this.KBa.setItem(R,Ba),!0}catch(lb){return this.qXa||va.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",lb.message),!1}}sendOfflineLogs(){if(!this.rXa){for(var R=this.ttb,Ba=
new mb.a,lb=null;R<this.hYb&&5>=Ba.count;++R){var Vb=this.TGc(R);const zc=this.KBa.getItem(Vb);this.KBa.removeItem(Vb);if(void 0===zc||null===zc)continue;const Yc=({sessionId:Vb}=Md.deserialize(zc)).returnValue;if(Yc){if(!lb)lb=Vb;else if(Vb!==lb)break;Ba.add(Yc)}else va.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",zc)}0<Ba.count&&this.vCa.ncj(this,Pb.toArray(Ba),lb);this.ttb=R;R>=this.hYb&&this.XDb()}}cDh(){this.XDb();this.yQ=new Lc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,
"sendOfflineLogs"),104);this.Ib.Xb(this.yQ)}CRa(R,Ba,lb){!this.fm&&va.ULS.F$(Ba,lb)&&(this.Dsd?this.Dsd.CRa(R,Ba,lb):this.Ubb.Z(R,!0))}dispose(){if(!this.fm){this.yQ&&this.Ib.Ze(this.yQ);var R=Pb.toArray(this.VF.keys);R.sort();for(const Ba of R){R=this.VF.J(Ba);for(let lb=0,Vb=R.count;lb<Vb;++lb){const zc=Md.serialize(R.J(lb),this.jCa);this.Sbd(this.TGc(this.Fsc++),zc)}}this.ttb<this.Fsc?(this.i7.end=this.Fsc,this.i7.offset=this.ttb,this.Sbd(this.tyc,JSON.stringify(this.i7))):this.KBa.removeItem(this.tyc)}this.fm=
!0}r5a(){this.rXa=!0}tLb(){this.rXa=!1;this.qXa&&this.cDh()}XDb(){this.yQ&&(this.Ib.Ze(this.yQ),this.yQ=null)}static serialize(R,Ba){const lb={};lb.t=R.tag;lb.c=R.category;lb.l=R.level;lb.m=R.message;lb.lt=R.logType;lb.s=Ba;lb.ts=R.timestamp;lb.o=R.isMinified;lb.a=R.args;return JSON.stringify(lb)}static deserialize(R){return(R=Md.Rbd(R))?{returnValue:new ic.a(R.ts,R.c,R.t,R.l,R.m,R.lt,R.o,R.a),sessionId:R.s}:{returnValue:null,sessionId:null}}static Rbd(R){try{return JSON.parse(R)}catch(Ba){va.ULS.sendTraceTag(18614234,
222,10,"OfflineLogger TryParseString failed with exception: {0}",Ba.message)}return null}}Object(f.a)(Md,"OfflineLoggerImpl",null,[1751,10,244]);class ie{constructor(R,Ba,lb,Vb){this.sessionId=R;this.version=Ba;this.OCd=lb;this.qYf=Vb;this.LKb=new mb.a}}Object(f.a)(ie,"CachedLogUpload",null,[]);class hf{constructor(R){R.name&&(this.n=R.name);R.stack&&(this.s=R.stack);R.message&&(this.m=R.message);R.file&&(this.f=R.file);null!=R.line&&(this.l=R.line);null!=R.column&&(this.c=R.column)}}Object(f.a)(hf,
"LoggingExceptionArgsLocalStorage",null,[]);class Ue{constructor(R){this.t=R.tag;this.c=R.category;this.l=R.level;this.m=R.message;this.lt=R.logType;this.ts=R.timestamp;this.o=R.isMinified;this.a=R.args;R.exceptionArgs&&(this.e=new hf(R.exceptionArgs))}}Object(f.a)(Ue,"LoggingArgsLocalStorage",null,[]);var Kd=c(481);class Wc{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.t=R;this.m=Ba;this.s=lb;this.v=Vb;this.i=zc;this.a=Yc;this.d=Zd;this.op="Log"}}Object(f.a)(Wc,"LoggingKeyLocalStorage",null,[]);var Zc=c(135);
const Nc=(R,Ba,lb,Vb,zc)=>!(void 0===R||null===R)&&!(void 0===R.i||null===R.i)&&!(void 0===R.t||null===R.t)&&!(void 0===R.s||null===R.s)&&"Log"===R.op&&R.t===Ba&&isFinite(R.t)&&Zc.a.isValid(R.s)&&(void 0===R.m||null===R.m||R.m===lb)&&(!zc||void 0===R.d||null===R.d||R.d===Vb);class ge{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,wa,Ta,Bb){this.rXa=this.F4g=this.s4g=this.t4g=!1;this.VF=this.Ubb=this.i7=this.yQ=null;this.fm=!1;this.Uvb=[];this.bYb=[];this.KBa=lb;this.vCa=Vb;this.jCa=zc;this.Wf=Ba;this.Ib=
R;this.tzc=Yc;this.ZKe=Zd;this.lch=$e;this.MXa=pa;this.o9j=Ma;this.tGe=ya;this.tWa=wa;this.g_g=Ta;this.gwb=!1;this.qXa=Bb}get manifest(){return this.i7}get xZc(){return this.Ubb}get zGa(){return this.VF}init(){this.Ydg();this.rXa=!1;this.Wf.S1b(this);this.yQ=new Lc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Ib.Xb(this.yQ)}determineLogsToSendAtBoot(){this.HQh(!0)}determineLogsToSendOnReconnect(){this.HQh(!1)}HQh(R){this.XDb();this.Uvb=[];R&&(this.bYb=
[]);for(var Ba=0;Ba<this.KBa.length;Ba++){const lb=this.KBa.key(Ba),Vb=ge.nBj(lb,!1);Nc(Vb,this.tzc,this.ZKe,this.tWa,this.g_g)&&(Vb.s===this.jCa?Array.add(this.Uvb,lb):R&&Array.add(this.bYb,lb))}if(this.Uvb.length||R&&this.bYb.length)if(Ba=this.tGe?Object(a.a)(this,this.Cxo,"sortDescendKeysToUpload"):Object(a.a)(this,this.Fxo,"sortKeysToUpload"),this.Uvb.sort(Ba),R&&this.bYb.sort(Ba),0<this.Uvb.length||0<this.bYb.length)this.yQ=new Lc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),
105),this.Ib.Xb(this.yQ)}Fxo(R){return R.s!==R.s?R.s.localeCompare(R.s):R.i-R.i}Cxo(R){return R.s!==R.s?R.s.localeCompare(R.s):R.i-R.i}TGc(R,Ba,lb,Vb){R=new Wc(this.tzc,this.ZKe,Ba,lb,R,Vb,this.tWa);return JSON.stringify(R)}Ydg(){this.Ubb=new gd.a;this.VF=new Ac.a;this.vCa.nph(Object(a.a)(this,this.FXf,"onUlsReadyToBeSent"));this.vCa.Sph(Object(a.a)(this,this.HXf,"onUlsSentSuccessfully"));this.vCa.Rph(Object(a.a)(this,this.GXf,"onUlsSentFailed"));this.vCa.dph(Object(a.a)(this,this.ITf,"onAfterUlsHostDisposed"))}FXf(R,
Ba){if(void 0!==Ba&&null!==Ba&&void 0!==Ba.args&&null!==Ba.args){if(this.xZc.nb(Ba.args.tag))this.xZc.remove(Ba.args.tag);else if(this.xZc.nb(qc.WBd))this.xZc.remove(qc.WBd);else if(!(this.o9j&&50>Ba.args.level))return;({value:R}=this.zGa.Fc(Ba.uploadId)).returnValue||(R=new ie(Ba.sessionId,Ba.version,Ba.OCd,Ba.qYf),this.zGa.Z(Ba.uploadId,R));this.zGa.J(Ba.uploadId).LKb.add(Ba.args)}}HXf(R,Ba){this.zGa.remove(Ba.uploadId);this.qXa&&this.gwb&&(this.gwb=!1,this.dDh())}GXf(R,Ba){this.gwb=!0;void 0!==
Ba&&null!==Ba&&this.zGa.nb(Ba.uploadId)&&this.dOi(Ba.uploadId)&&!this.F4g&&(this.F4g=!0,this.qXa||va.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}dOi(R){let Ba=!1;if(({value:Vb}=this.zGa.Fc(R)).returnValue&&Vb&&0<Vb.LKb.count){if(Vb.OCd>=this.MXa)return this.qXa&&this.zGa.remove(R),!1;var lb=Vb.LKb;const zc=Array(lb.count);for(let Yc=0,Zd=lb.count;Yc<Zd;++Yc)zc[Yc]=new Ue(lb.J(Yc));lb=ge.serialize(zc);var Vb=this.TGc(Vb.qYf,Vb.sessionId,Vb.version,Vb.OCd);this.Sbd(Vb,lb)&&(this.zGa.remove(R),
Ba=!0)}return Ba}ITf(){this.dispose()}Sbd(R,Ba){try{return this.KBa.setItem(R,Ba),!0}catch(lb){return this.qXa||va.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",lb.message),!1}}sendOfflineLogs(){if(!this.rXa){var R=0<this.Uvb.length?this.Uvb:this.bYb,Ba=R.length;if(Ba)for(;0<Ba;){l.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");Ba--;var lb=this.tGe?R.pop():R[0];this.tGe||Array.removeAt(R,0);const Yc=
ge.nBj(lb,!0);if(Nc(Yc,this.tzc,this.ZKe,this.tWa,this.g_g)){var Vb=this.KBa.getItem(lb);this.KBa.removeItem(lb);if(void 0!==Vb&&null!==Vb)if(Yc.a>this.MXa)va.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Yc.a,this.MXa);else if(lb=ge.Rbd(Vb,!0),void 0!==lb&&null!==lb&&isFinite(lb.length))if(lb.length){Vb=lb[lb.length-1];var zc=(new Date).getTime()-Vb.ts;if(zc<-ge.Lxj)va.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",
Vb.ts);else if(zc>this.lch*ge.Lxj)va.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.lch,Vb.ts);else{Yc.s===this.jCa?this.t4g||(this.t4g=!0,va.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.s4g||(this.s4g=!0,va.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Yc.s));Ba=Array(lb.length);for(Vb=0;Vb<lb.length;Vb++){R=Vb;a:{zc=lb[Vb];if(void 0===zc||null===
zc){zc=null;break a}let Zd=null;zc.e&&(Zd=new Kd.a(null),Zd.name=zc.e.n,Zd.stack=zc.e.s,Zd.message=zc.e.m,Zd.file=zc.e.f,Zd.line=zc.e.l,Zd.column=zc.e.c);zc=new ic.a(zc.ts,zc.c,zc.t,zc.l,zc.m,zc.lt,zc.o,zc.a,Zd)}Ba[R]=zc}this.vCa.ncj(this,Ba,Yc.s,Yc.v,Yc.a+1,Yc.i);break}}else va.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Vb);else va.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Vb)}}else this.XDb()}}dDh(){this.XDb();this.yQ=
new Lc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Ib.Xb(this.yQ)}CRa(R,Ba,lb){!this.fm&&va.ULS.F$(Ba,lb)&&this.xZc.Z(R,!0)}dispose(){if(!this.fm){this.yQ&&this.Ib.Ze(this.yQ);var R=Pb.toArray(this.zGa.keys);for(const Ba of R)this.dOi(Ba)}this.fm=!0}r5a(){this.rXa=!0;this.XDb()}tLb(){this.rXa=!1;this.dDh()}XDb(){this.yQ&&(this.Ib.Ze(this.yQ),this.yQ=null)}static serialize(R){return JSON.stringify(R)}static nBj(R,Ba){(R=ge.Rbd(R,Ba))&&
void 0===R.d&&(R=new Wc(R.t,R.m,R.s,R.v,R.i,R.a,0));return R}static Rbd(R,Ba){try{return JSON.parse(R)}catch(lb){Ba&&va.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",lb.message)}return null}}ge.Lxj=864E5;Object(f.a)(ge,"OfflineLoggerImplV2",null,[1751,10,244]);class $d{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(R){return this.handleError("Length",R),-1}}key(R){try{return localStorage.key(R)}catch(Ba){return this.handleError("Key",
Ba),null}}getItem(R){try{return localStorage.getItem(R)}catch(Ba){return this.handleError("GetItem",Ba),null}}setItem(R,Ba){try{return localStorage.setItem(R,Ba)}catch(lb){return this.handleError("SetItem",lb),null}}removeItem(R){try{localStorage.removeItem(R)}catch(Ba){this.handleError("RemoveItem",Ba)}}clear(){try{localStorage.clear()}catch(R){this.handleError("Clear",R)}}handleError(){}}Object(f.a)($d,"OfflineStorage",null,[1750]);class te{create(R){var Ba=null;try{void 0!==localStorage&&null!==
localStorage&&(Ba=new $d)}catch(Vb){va.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Vb.message)}Object.getType(va.ULS.host).implementsInterface(1070)&&Ba||(va.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Ba?"supported":"not supported",Object.getType(va.ULS.host).implementsInterface(1070)?"supported":"not supported"),R=0);const lb=l.AFrameworkApplication.K;1===R?Ba=new Md(l.AFrameworkApplication.oc,
l.AFrameworkApplication.He,Ba,va.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.bOh,lb.$("OfflineLoggerDataBoundarySupportIsEnabled"),lb.$("OfflineLoggerMemoryOptimizationIsEnabled")):2===R?(R=l.AFrameworkApplication.ua.Lb,Ba=new ge(l.AFrameworkApplication.oc,l.AFrameworkApplication.He,Ba,va.ULS.host,l.AFrameworkApplication.userSessionId,R.Nk,R.Jia,lb.lc("OfflineLoggerRetentionInDays",30),lb.lc("OfflineLoggerMaxAttempts",5),lb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),
lb.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.bOh,lb.$("OfflineLoggerDataBoundarySupportIsEnabled"),lb.$("OfflineLoggerMemoryOptimizationIsEnabled"))):Ba=new xb;Ba.init();return Ba}}Object(f.a)(te,"OfflineLoggerFactory",null,[]);class Se{wc(){}get name(){return"Common.App.OfflineLogger"}init(){const R=l.AFrameworkApplication.K;let Ba=0;R.$("OneNoteOfflineLoggerIsEnabled")?Ba=1:R.$("OfflineLoggerV2IsEnabled")&&(Ba=2);0!==Ba&&(l.AFrameworkApplication.Nkg=(new te).create(Ba))}dispose(){}}
Object(f.a)(Se,"OfflineLoggerPackage",null,[1,2]);var tc=c(42),dd=c(1383);class Ed{constructor(R){this.$Ki=null;va.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.d_c=l.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");(this.F9=R)||va.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.d_c&&this.d_c.length||va.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}Rzl(R){R&&(this.d_c="https://dcg-df.microsoft.com/",
va.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.Qzl()}Qzl(){va.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.$Ki)va.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.$Ki=new Date;var R=new Date;this.F9.EV("BayBridge",this.d_c).then(Ba=>{const lb=+new Date-+R;Ba.IsSuccess?(va.ULS.sendTraceTag(527574723,306,
50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",lb),this.Hzl(Ba.Token,this.aMl())):va.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",lb,Ba.ErrorCode,Ba.ErrorMessage)}).catch(Ba=>{va.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Ba,+new Date-+R)})}}Hzl(R,Ba){const lb={};lb.Authorization=
"Bearer "+R;lb["Authorization-Type"]="AAD";lb.Accept="application/json";lb["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.He.sj(Ba,1,null,lb,!1,2,Object(a.a)(this,this.cdm,"getStatusSucceeded"),Object(a.a)(this,this.adm,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");tc.a("FetchAccountLinkedStatus")}gOl(){const R=dd.a.instance.getItem("AccountLinkedStatusCache");return R&&R.length?"true"===R.toLowerCase()?!0:!1:!1}aMl(){return this.d_c+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}adm(){va.ULS.sendTraceTag(527214156,
306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}cdm(R){va.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");R=ab.a(R.data.se).state+"";dd.a.instance.setItem("AccountLinkedStatusCache",R)}}Object(f.a)(Ed,"PhoneLinkManager",null,[1659]);class Qd{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}wc(R){this.W=R;this.W.register(1659,"Common.App.PhoneLink.IPhoneLinkManager").ha().Sd(()=>new Ed(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Hn(()=>
{this.k3a()})}k3a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){L.a.instance.Gc(new Qd)}}Object(f.a)(Qd,"PhoneLinkPackage",null,[1,2]);const Ad=R=>{try{return ab.a(R)}catch(Ba){}return null};class Oe{constructor(R,Ba,lb,Vb,zc,Yc){this.RZ=!1;this.Fl=null;this.iNe=!1;this.ga=R;this.Wf=Ba;this.Pk=lb;this.E3g=Vb;this.Ga=zc;this.T8j=Yc}init(R,Ba){Ba&&R.Ta("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.B2e,"awaitRtc"))}B2e(R){const Ba=R.cQc();Ba.continueWith(()=>
{this.Fl=Ba.result;this.iNe&&(this.Fl.pN(2,null,!0),this.iNe=!1);this.Fl.G3((lb,Vb)=>{2===Vb.type&&this.nc.processAction(m.a.fileNameUpdate,2)});this.Fl.xua((lb,Vb)=>{2===Vb.newState&&this.nc.processAction(m.a.fileNameUpdate,2)});2===this.Fl.connectionState&&this.nc.processAction(m.a.fileNameUpdate,2)})}WOa(R){this.uXh(R,!0)}uXh(R,Ba){const lb=this.PMk(R.dsj),Vb={};Vb[Oe.MHh]=Oe.NHh;this.ccj.sj(lb,2,"",Vb,!1,2,Object(a.a)(this,this.sgc,"onRefreshFilenameSuccess"),Ba?Object(a.a)(this,this.mqn,"onRefreshFilenameFailureRetry"):
Object(a.a)(this,this.QVi,"onRefreshFilenameFailureNoRetry"),R)}sgc(R){this.RZ=!1;const Ba=Ad(R.data.se);R.data.state.onSuccess(Ba,this.E3g.value)}mqn(R){5!==R.data.status||this.RZ?this.QVi(R):(this.RZ=!0,this.uXh(R.data.state,!1))}QVi(R){R.data.state.onFailure(-1)}dEb(R){this.vXh(R,!0)}vXh(R,Ba){const lb=this.QMk(),Vb={};Vb[Oe.MHh]=Oe.NHh;Vb[Oe.gpm]=Xa.a.Dj(R.jcj);Vb[Oe.epm]=this.T8j.value.gZk;this.ccj.sj(lb,2,"",Vb,!1,2,Object(a.a)(this,this.H1c,"onRenameFileSuccess"),Ba?Object(a.a)(this,this.sqn,
"onRenameFileFailureRetry"):Object(a.a)(this,this.SVi,"onRenameFileFailureNoRetry"),R)}QMk(){return this.Pxh()}PMk(R){let Ba=this.Pxh();return Ba=mc.a.$o(Ba,Oe.kpm,R?"2":"1")}Pxh(){let R=(this.Ga.value.appSettings.RenameWebServiceBase||"")+Oe.fpm;R=mc.a.$o(R,Oe.hpm,Xa.a.Dj(l.AFrameworkApplication.km));this.Om&&this.Om.GDf&&(R=mc.a.$o(R,Oe.jpm,"1"));return R}H1c(R){this.RZ=!1;const Ba=Ad(R.data.se);R.data.state.onSuccess(Ba,this.E3g.value);this.FQi()}FQi(){this.Fl?this.Fl.pN(2,null,!0):this.iNe=!0}sqn(R){5!==
R.data.status||this.RZ?this.SVi(R):(this.RZ=!0,this.vXh(R.data.state,!1))}SVi(R){R.data.state.onFailure(-1)}get nc(){return this.ga.value}get ccj(){return this.Wf.value}get Om(){return this.Pk.value}static get instance(){return Oe._instance||(Oe._instance=Oe.$Eb())}static $Eb(){return new Oe(new Mb.a(()=>l.AFrameworkApplication.va),new Mb.a(()=>l.AFrameworkApplication.He),new Mb.a(()=>l.AFrameworkApplication.Om),new Mb.a(()=>ta.a.instance.resolve("Postmessage.IHostPostmessenger")),new Mb.a(()=>l.AFrameworkApplication.K),
new Mb.a(()=>ta.a.instance.resolve("Common.IRenameProps")))}}Oe.MHh="Content-Type";Oe.NHh="application/json; charset=utf-8";Oe.fpm="renamehandler.ashx";Oe.hpm="qs";Oe.gpm="n";Oe.jpm="sl";Oe.epm="X-CoauthLockId";Oe.kpm="u";Oe._instance=null;Object(f.a)(Oe,"ExecuteRenameFileHandler",null,[]);class pf{constructor(){this.onFailure=this.onSuccess=null;this.dsj=!1}}Object(f.a)(pf,"ExecuteRefreshFilenameData",null,[]);class Fh{constructor(){this.onFailure=this.onSuccess=this.jcj=null}}Object(f.a)(Fh,"ExecuteRenameFileData",
null,[]);class Ig{constructor(){this.W=null;this.Sze=Oe.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}wc(R){this.W=R}init(){l.AFrameworkApplication.K.Hn(Object(a.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){l.AFrameworkApplication.eXc()&&(Oe.instance.init(this.W,l.AFrameworkApplication.e6c),l.AFrameworkApplication.dEb=Object(a.a)(this,this.dEb,"executeRenameFile"),l.AFrameworkApplication.WOa=Object(a.a)(this,this.WOa,"executeRefreshFilename"),l.AFrameworkApplication.a8c=Object(a.a)(this,
this.a8c,"sendFileNameAndLocationUpdateNotification"))}dEb(R,Ba,lb){const Vb=new Fh;Vb.jcj=R;Vb.onSuccess=Ba;Vb.onFailure=lb;this.Sze.dEb(Vb)}WOa(R,Ba,lb){const Vb=new pf;Vb.onSuccess=R;Vb.onFailure=Ba;Vb.dsj=lb;this.Sze.WOa(Vb)}a8c(){this.Sze.FQi()}dispose(){}}Object(f.a)(Ig,"PackageManager",null,[1,2]);var Jh=c(177);class xg{constructor(R,Ba,lb){this.agg=this.bgg=this.cgg=!1;this.rgg=!R&&!Ba;this.sgg=!R&&!lb;this.rgg||this.sgg||(this.cgg=!R,this.bgg=!Ba,this.agg=!lb)}}Object(f.a)(xg,"RenameDisabledDialogInfo",
null,[]);class bc extends Jh.StandardDialog{constructor(R,Ba,lb,Vb,zc){super();this.vkg=[];this.mfa=new xg(R,Ba,lb);this.Ydb=Vb;this.Dbb=zc;this.ug="RenameDisabledDialog";this.Cd=0;this.xe(1,CommonUIStrings.l_DialogClose);this.Tlo();this.C0n()}Tlo(){this.mfa.rgg?this.d$c(this.Ydb?this.Dbb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.mfa.sgg?this.d$c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.wrk();this.XEc(this.vkg)}d$c(R){Array.add(this.vkg,R)}wrk(){const R=[];this.mfa.cgg||Array.add(R,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.mfa.bgg||Array.add(R,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.mfa.agg||Array.add(R,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<R.length&&Array.add(this.vkg,R)}}Object(f.a)(bc,"ReactRenameDisabledDialogBase",Jh.StandardDialog,[]);class Bc extends bc{constructor(R,Ba,lb,Vb,zc){super(R,Ba,lb,Vb,zc)}C0n(){this.pmb(CommonUIStrings.l_RenameFileRenameDisabledTitle,
null,null,null,null,null)}}Object(f.a)(Bc,"ReactRenameDisabledDialog",bc,[]);class ad{static get Yg(){return k.a.Bz(ad.Sm,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}ad.Sm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(ad,"RenameDisabledDialogHtml",null,[]);class zd extends k.a{constructor(R,Ba,lb,Vb,zc){super();this.mfa=new xg(R,Ba,lb);this.Ydb=Vb;this.Dbb=zc;this.ug="RenameDisabledDialog";this.Cd=0;this.xe(1,CommonUIStrings.l_DialogClose);this.Yg=ad.Yg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.C5("RenameRow")}L9(){if(this.mfa.rgg){let R;R=this.Ydb?this.Dbb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;zd.d$c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),R)}else this.mfa.sgg?zd.d$c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.wsm()}wsm(){this.mfa.cgg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.mfa.bgg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.mfa.agg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static d$c(R,Ba,lb){R.style.display="none";Ba.innerText=lb}}Object(f.a)(zd,"RenameDisabledDialog",k.a,[]);class Xd{constructor(R,Ba){this.Cwb=0;this.ga=R;this.IKa=Ba}initialize(R){if(!this.ga||!this.IKa)return!1;this.Cwb=R;this.Tb();return!0}Tb(){this.ga.ra(m.a.t8e,y.a.frame,Object(a.a)(this,this.t8e,"commitNewDocumentTitle"))}t8e(R,Ba,lb,Vb,zc){if(1===lb)return this.ga.processAction(m.a.renameFile,
1);R=Xa.a.tJ(this.IKa.uz);zc=(0,zc.getNewDocumentTitle)();zc.length>this.Cwb&&(zc=zc.substr(0,this.Cwb));if(32!==this.ga.Rb(m.a.renameFile,2,zc))return this.ioc(R),8;this.ioc(zc);return 32}ioc(R){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(R))}static Wl(){return new Xd(l.AFrameworkApplication.va,l.AFrameworkApplication.Cs)}}Object(f.a)(Xd,"ReactRenameUIHandler",null,[1752]);var Gd=c(218),Ze=c(1074),Fe=c(532),bf=c(101),ag=c(163),Xf=c(28);class vf{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,
pa,Ma,ya,wa){this._initialized=!1;this._element=null;this.Cwb=0;this.ZQe=this.oDe=!1;this.ga=R;this.Lka=Ba;this.ee=lb;this.us=Vb;this.IKa=zc;this.ndh=Yc;this.wvd=Zd;this.fve=$e;this.Yab=pa;this.J0g=Ma;this.ti=ya;this.UEe=wa}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(R,Ba,lb){if(!(this.ga&&this.IKa&&this.ndh&&this.wvd&&this.fve&&Ba)||0>=R)return!1;this._element=Ba;this._element.title=lb;this._element.setAttribute(Xf.a.oh,Xf.a.L3);this._element.setAttribute("Unselectable",
"on");this.Cwb=R;this.cC();return this._initialized=!0}cC(){this.Lka&&(this.Lka.ob(W.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Lka.ob(W.a.paste,this._element,Object(a.a)(this,this.y1c,"onPaste")));this.ee.ob(W.a.$h,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.us.ob(W.a.pointerDown,this._element,Object(a.a)(this,this.eD,"onPointerDown"));this.us.ob(W.a.iN,this._element,Object(a.a)(this,this.mya,"onPointerUp"))}onBlur(){this.isActive&&!this.oDe&&(this.J0g||
this.fve(this._element),this.OFh(),this.ycf(!1));return this.oDe=!1}y1c(){va.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(R){return this.isActive?this.Ann(R):this.Bnn(R)}Ann(R){let Ba=!1;switch(R.Hb.keyCode){case Sys.UI.Key.enter:this.OFh();this.ycf(this.ti||this.UEe);Ba=!0;break;case Sys.UI.Key.tab:this.J0g&&this.fve(this._element);break;case Sys.UI.Key.esc:this.j9f(),this.ycf(this.ti||this.UEe),Ba=!0}return Ba}Bnn(R){let Ba=!1;switch(R.Hb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.sAj(this.UEe),
this.isActive&&this.wvd(this._element),Ba=!0}return Ba}eD(){this.isActive||(this.sAj(!1),this.isActive&&(this._element.focus(),this.wvd(this._element),this.ZQe=!0));return!1}mya(){return this.ZQe?(this.wvd(this._element),this.ZQe=!1,!0):!1}adc(){return 32===this.ga.processAction(m.a.renameFile,1)}OFh(){const R=Xa.a.tJ(this.IKa.uz);let Ba=this._element.innerText.trim();Ba.length>this.Cwb&&(Ba=Ba.substr(0,this.Cwb));Ba!==R&&""!==Ba?32!==this.ga.Rb(m.a.renameFile,2,Ba)?this.j9f():this.ioc(Ba):this.j9f()}j9f(){this.ioc(Xa.a.tJ(this.IKa.uz))}ioc(R){this._initialized&&
(this._element.innerText=R,this.ndh())}sAj(R){this.adc()?this.isActive||(R&&(this.oDe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Xf.a.oh,Xf.a.puh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Gd.CuiHelper.fUh),this.Yab&&this.Yab.execute(Ba=>{Ba.d5i(!0)}),R&&this._element.focus(),va.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(m.a.vlc,
2)}ycf(R){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Xf.a.oh,Xf.a.L3);Sys.UI.DomElement.removeCssClass(this._element,Gd.CuiHelper.fUh);this.Yab&&this.Yab.execute(Ba=>{Ba.d5i(!1)});R&&(this._element.blur(),this._element.focus())}static gza(){Ze.a.gza(l.AFrameworkApplication.isRtl)}static Wl(){return new vf(l.AFrameworkApplication.va,Fe.a.instance,bf.KeyInputManager.instance,ag.a.instance,l.AFrameworkApplication.Cs,vf.gza,
oa.a.N$n,oa.a.DDh,ta.a.instance.Ta("Common.App.Header.HeaderEventSource"),ua.a.L4,ua.a.ri,ua.a.lj)}}Object(f.a)(vf,"RenameUIHandler",null,[1752]);class Bg{static get instance(){return l.AFrameworkApplication.ua.Lb.IJ?Bg._instance||(Bg._instance=Xd.Wl()):Bg._instance||(Bg._instance=vf.Wl())}}Bg._instance=null;Object(f.a)(Bg,"RenameUIHandlerFactory",null,[]);var ob=c(150);class $b{constructor(){this.PRf=this.een=this.Tel=null}}Object(f.a)($b,"RenameMruEntryProperties",null,[]);var Uc=c(165),Pd=c(87),
ze=c(1562),Me;(function(R){R[R.unknown=-1]="unknown";R[R.success=0]="success";R[R.renameInvalidFileName=1]="renameInvalidFileName";R[R.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";R[R.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";R[R.permissionDenied=4]="permissionDenied";R[R.serverCommunicationFailure=5]="serverCommunicationFailure";R[R.fileNameTooLong=6]="fileNameTooLong"})(Me||(Me={}));Object(f.b)("CommonOperationResult",Me);class af{constructor(R,Ba,lb,Vb,zc,Yc,
Zd,$e,pa,Ma,ya,wa){this.b1g=R;this.ga=Ba;this.Pk=lb;this.$L=Vb;this.lwb=zc;this.omk=Yc;this.Ydb=Zd;this.ljh=$e;this.bfk=pa;this.Dbb=Ma;this.Ga=ya;this.afk=wa}Tb(){l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.IJ||this.nc.ra(m.a.Xac,y.a.frame,Object(a.a)(this,this.Xac,"initializeRenameUIHandler"));this.nc.ra(m.a.vlc,y.a.frame,Object(a.a)(this,this.vlc,"showRenameDisabledDialog"));this.nc.ra(m.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.nc.fb(m.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.DRn,"refreshFilename"),64);this.nc.fb(m.a.x4d,y.a.frame,Object(a.a)(this,this.x4d,"moveToFolderCompleteByHost"),64);this.nc.ra(m.a.lLb,y.a.frame,Object(a.a)(this,this.lLb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ua&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.kP().execute(R=>{R.Fv(Pd.a.AOi);R.bC(Pd.a.AOi,af.YNn);R.Fv(Pd.a.kjf);R.bC(Pd.a.kjf,af.WNn)})}adc(){return 0===this.afk.zei()?32:8}AZo(){return this.Om?this.Ydb?this.Om.gTh:this.Om.J1a:!0}Xac(){return Bg.instance.initialize(l.AFrameworkApplication.pNd,l.AFrameworkApplication.YSh,l.AFrameworkApplication.oaj||CommonUIStrings.l_RenameFileTooltip)?32:8}vlc(){const R=this.AZo(),Ba=this.omk();va.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.lwb,Ba,R,this.Ydb);l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.pF&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new Bc(this.lwb,!Ba,!R,this.Ydb,this.Dbb()):new zd(this.lwb,!Ba,!R,this.Ydb,this.Dbb());return 32}renameFile(R,Ba,lb,Vb,zc){if(1===lb)return this.adc();if(!l.AFrameworkApplication.dEb)return 8;if(8===this.adc())return this.nc.processAction(m.a.vlc,2),8;va.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.dEb(zc,Object(a.a)(this,
this.H1c,"onRenameFileSuccess"),Object(a.a)(this,this.rqn,"onRenameFileFailure"));l.AFrameworkApplication.naj=!0;return 32}H1c(R,Ba){R?0!==R.OperationResult?this.Hki(R.OperationResult):(this.Bbo(Ba,R.NewName),this.qRo(R,Object(a.a)(l.AFrameworkApplication.ua.Lb,l.AFrameworkApplication.ua.Lb.eFj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ua.updateCommandUI(),this.bfk.TCj()):this.Hki(5)}Bbo(R,Ba){const lb={};lb[Uc.a.tAl]=
Ba;R.sendMessage(Pd.a.kjf,lb)}qRo(R,Ba){this.ERo(R);l.AFrameworkApplication.mKd=R.DirectInvokeDavUrl;Ba=Ba(R.EditDocInClientUrl);const lb=new $b;lb.PRf=this.$L.uz;lb.Tel=Ba;lb.een=R.EditDocInClientUrl;this.nc.Rb(m.a.paj,2,lb)}Hki(R){switch(R){case 1:R=new Jh.StandardDialog,R.Cd=0,R.uV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Zcj()}}ERo(R){this.$L.uz=af.PBk(this.$L.uz,R.NewName);R.BreadcrumbFolderName&&(this.$L.breadcrumbFolderName=R.BreadcrumbFolderName);
R.BreadcrumbFolderUrl&&(this.$L.breadcrumbFolderUrl=R.BreadcrumbFolderUrl);this.ljh(R.NewName)}rqn(R){const Ba=new Jh.StandardDialog;Ba.Cd=0;switch(R){case 1:va.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Ba.Uja(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:va.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Ba.Uja(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:va.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:R}),Ba.Uja(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.kP().execute(lb=>{lb.sendMessage(Pd.a.sAl,{["FailureMessage"]:Me[R]})});this.Zcj()}DRn(R,Ba,lb){if(1===lb)return this.adc();if(!l.AFrameworkApplication.WOa)return 8;l.AFrameworkApplication.WOa(Object(a.a)(this,this.sgc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.u7d,"onRefreshFilenameFailure"),
!1);return 32}lLb(R,Ba,lb,Vb,zc){if(1===lb)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===lb){const Yc={};R=l.AFrameworkApplication.qlb;Ba=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");R=(!R||R&&Ba)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Yc[Uc.a.SCo]=R;zc&&zc.MoveButtonClickedTime&&(Yc[Uc.a.pcn]=zc.MoveButtonClickedTime.getTime());l.AFrameworkApplication.kP().execute(Zd=>{Zd.sendMessage(Pd.a.lLb,
Yc)});if(zc&&zc.MoveButtonClickedTime){if(R=ob.a.oG())zc=(new Date).getTime()-zc.MoveButtonClickedTime.getTime(),R.set("MovePostDuration",zc.toString());La.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",R)}return 32}return 8}x4d(R,Ba,lb,Vb,zc){if(1===lb)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.adc():8;if(2===lb){if(!l.AFrameworkApplication.a8c)return La.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!zc)return La.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(zc[Uc.a.kIm])if(zc[Uc.a.MGj])if(R=zc[Uc.a.MGj].toLowerCase(),Ba=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),lb=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Ba&&l.AFrameworkApplication.qlb&&lb){const Yc={};Yc[Uc.a.vic]="1";Yc[Uc.a.documentUrl]=R;Yc[Uc.a.reason]=ze.a.y$f;La.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.kP().execute(Zd=>{Zd.sendMessage(Pd.a.BDb,Yc)})}else if(!l.AFrameworkApplication.qlb&&lb)La.Health.instance.recordKpiSuccess("MoveToFolder",null),oa.a.om(R,oa.a.Ura(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return La.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else La.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.WOa(Object(a.a)(this,this.sgc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.u7d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.a8c(),La.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}sso(R,Ba){return R&&Ba?R!==this.$L.breadcrumbFolderName||Ba!==this.$L.breadcrumbFolderUrl:!1}sgc(R,Ba){R&&(R.NewName!==Xa.a.tJ(this.$L.uz)||this.sso(R.BreadcrumbFolderName,R.BreadcrumbFolderUrl))&&this.H1c(R,Ba)}u7d(){}Zcj(){this.ljh(Xa.a.tJ(this.$L.uz))}get nc(){return this.ga.value}get Om(){return this.Pk.value}static get instance(){return af._instance||
(af._instance=af.$Eb())}static $Eb(){return new af(l.AFrameworkApplication.eXc,new Mb.a(()=>l.AFrameworkApplication.va),new Mb.a(()=>l.AFrameworkApplication.Om),l.AFrameworkApplication.Cs,l.AFrameworkApplication.Ppa,()=>l.AFrameworkApplication.zpg,l.AFrameworkApplication.e6c,Object(a.a)(Bg.instance,Bg.instance.ioc,"updateTitle"),ta.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.mv,l.AFrameworkApplication.K,ta.a.instance.resolve("Common.IRenameProps"))}static PBk(R,
Ba){R=Xa.a.zha(R);return Ba+R}static YNn(R){const Ba=R.Values[Uc.a.dOm];va.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Ba);Ba?l.AFrameworkApplication.va.Rb(m.a.x4d,2,R.Values):La.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static WNn(R){l.AFrameworkApplication.va.Rb(m.a.renameFile,2,R.Values.NewName)}}af._instance=null;Object(f.a)(af,"RenameActor",null,[]);var Hg=c(190),wi=c(1389),Wi=c(573),Mf=c(397);class Zg{constructor(R,
Ba){this.ga=R;this.qtc=Ba}Tb(){this.ga.ra(m.a.mgg,y.a.frame,Object(a.a)(this,this.kvo,"showRenameDialogAction"))}kvo(R,Ba,lb){R=32;if(1===lb)return Mf.SessionStatusManager.instance.Uj||l.AFrameworkApplication.opa?8:32;2===lb&&(32!==this.ga.processAction(m.a.renameFile,1)?(this.ga.processAction(m.a.vlc,2),Hg.a.instance.Yb(wi.a.Zna,{["Reason"]:Wi.a.S_n}),R=8):32===this.ga.processAction(m.a.wlc,1)?this.ga.processAction(m.a.wlc,2):this.qtc.value.create().fUa());return R}}Object(f.a)(Zg,"RenameDialogActor",
null,[1732]);class zf{constructor(R,Ba,lb){this.dialog=null;this.ga=R;this.$L=Ba;this.Fab=lb}l$l(){const R={};R.nameInputProps={["type"]:"AppInputProps",["id"]:zf.C6b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Xa.a.tJ(this.$L.uz),["maxLength"]:this.Fab};return R}fUa(){const R={["id"]:"RenameDialog",["bodyControls"]:this.l$l()};this.dialog=new k.a(!1,!1,!0);this.dialog.Cd=1;this.dialog.ug="RenameDialog";this.dialog.Qh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.C7f,"renameDialogHandler"),
R)}C7f(R,Ba){if(Ba&&1===R){if(Ba[zf.C6b]&&(R=Xa.a.tJ(this.$L.uz),Ba=(Ba[zf.C6b]||"").trim(),Ba!==R&&""!==Ba)){this.ga.Rb(m.a.renameFile,2,Ba);return}Hg.a.instance.Yb(wi.a.z6b,{["Reason"]:Wi.a.XYh})}}}zf.C6b="txtDocumentName";Object(f.a)(zf,"ReactRenameDialog",null,[1753]);class ii{static get Yg(){return k.a.Bz(ii.Sm,CommonUIStrings.l_RenameDialogLabel)}}ii.Sm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(ii,"RenameDialogHtml",null,[]);class Af extends k.a{constructor(R,Ba,lb){super();this.ga=R;this.$L=Ba;this.Fab=lb;this.ug="RenameDialog";this.Yg=ii.Yg}fUa(){var R={["txtDocumentName"]:Xa.a.tJ(this.$L.uz)};this.Qh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.C7f,"renameDialogHandler"),R);R=document.getElementById(Af.C6b);0<this.Fab&&(R.maxLength=this.Fab);R.focus()}C7f(R,Ba){if(1===R&&(R=Xa.a.tJ(this.$L.uz),Ba=(Ba[Af.C6b]||"").trim(),Ba!==R&&""!==Ba)){this.ga.Rb(m.a.renameFile,
2,Ba);return}Hg.a.instance.Yb(wi.a.z6b,{["Reason"]:Wi.a.XYh})}}Af.C6b="txtDocumentName";Object(f.a)(Af,"RenameDialog",k.a,[1753]);class jg{constructor(R){this.IKa=null;this.Fab=0;this.ga=R;this._initialized=!1}initialize(R,Ba){this.IKa=R;this.Fab=Ba;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.pF&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new zf(this.ga,this.IKa,this.Fab):new Af(this.ga,this.IKa,this.Fab):null}}Object(f.a)(jg,
"RenameDialogFactory",null,[1731]);var Rf=c(173),lj=c(107);class Qh{constructor(R,Ba){this.ga=R;this.Vb=Ba}Tb(){this.ga.ra(m.a.wlc,y.a.frame,Object(a.a)(this,this.lvo,"showRenameFlyoutAction"))}lRk(){return F.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ua.Lb.IJ}lvo(R,Ba,lb){if(1===lb)return this.lRk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}ltk(){Qh.uSm&&l.AFrameworkApplication.XH&&lj.a.instance.Xb(new Lc.a(5,1,5E3,()=>{32===this.ga.processAction(m.a.wlc,
1)&&this.Vb&&this.Vb.currentScope.name===Rf.AFrame.Un&&(tc.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(m.a.wlc,2))}))}static get uSm(){Qh.Hod&&null!=Qh.Hod||(l.AFrameworkApplication.le("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Qh.Hod=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Qh.Hod}}Qh.Hod=null;Object(f.a)(Qh,"RenameFlyoutActor",
null,[1730]);class ei{constructor(R,Ba,lb,Vb,zc){this.gZk=null;this.Pk=zc;this.c1g=lb;this.b1g=Vb;this.qmk=R;this.Dbb=Ba}get Om(){return this.Pk.value}zei(){if(!this.b1g())return 5;if(this.Dbb())return 1;if(this.Om){if(this.c1g&&!this.Om.gTh)return 3;if(!this.c1g&&!this.Om.J1a)return 4}return this.qmk()?0:2}}Object(f.a)(ei,"RenameProps",null,[1729]);class cl{constructor(R,Ba,lb,Vb,zc,Yc){this.Qs=!1;this.RHe=new Jb.a;this.QVb=Ba;this.$z=lb;this.OUb=Vb;this.Ga=zc;this.kma=Yc}enable(){this.Qs||(this.TCj(),
this.Nhg(),this.Qs=!0)}generateKey(R,Ba,lb){return String.format("{0}/{1}/{2}",lb,R,Ba)}M_l(){const R=Xa.a.tJ(this.QVb().uz);return this.generateKey(this.QVb().breadcrumbFolderName,this.QVb().breadcrumbFolderUrl,R)}N_l(R,Ba,lb){return R&&Ba?this.generateKey(R,Ba,lb):lb}$ll(R,Ba,lb){return R&&R!==this.QVb().breadcrumbFolderName||Ba&&Ba!==this.QVb().breadcrumbFolderUrl?!0:lb!==Xa.a.tJ(this.QVb().uz)}TCj(){const R=this.M_l();this.RHe.Z(R,new Date)}t_f(R){this.Eqo(R)&&this.Jlh(R)}Eqo(R){const Ba=this.OUb();
return Ba?this.kma&&this.kma.Fo||!Ba.GDf||!l.AFrameworkApplication.WOa?(this.wuj(R),this.Qs=!1):!0:!1}QWi(R,Ba,lb,Vb){const zc=this.$ll(R,Ba,lb);R=this.N_l(R,Ba,lb);Ba=this.RHe.Fc(R).returnValue;zc&&!Ba&&(this.Jki(Vb),va.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.cMf));zc||this.RHe.Z(R,this.$z())}}Object(f.a)(cl,"ARenamedFileChecker",null,[1697]);class ul extends cl{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){super(R,Ba,lb,Vb,zc,Yc);this.HK=zc;this.$ek=Zd;this.RCe=$e}get cMf(){return"RenamedFileCheckerUsingSettingsRefresh"}Nhg(){this.HK.sFc(Object(a.a)(this,
this.eli,"handleSettingsRefresh"))}eli(R,Ba){Ba&&Ba.vLb&&Ba.FRi&&(Ba.gRa("BreadcrumbDocName")||Ba.gRa("BreadcrumbFolderName")||Ba.gRa("BreadcrumbFolderUrl")||Ba.gRa("DirectInvokeDAVUrl")||Ba.gRa("EditDocInClientUrl"))&&(va.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.cMf),this.t_f(Ba))}wuj(){this.HK.t7f(Object(a.a)(this,this.eli,"handleSettingsRefresh"))}Jlh(R){if(R&&R.vLb){const Ba=R.vLb;this.QWi(Ba.kb("BreadcrumbFolderName"),Ba.kb("BreadcrumbFolderUrl"),Ba.kb("BreadcrumbDocName"),
R)}}Jki(R){const Ba={OperationResult:0,classId:1};R=R.vLb;Ba.BreadcrumbFolderName=R.kb("BreadcrumbFolderName");Ba.BreadcrumbFolderUrl=R.kb("BreadcrumbFolderUrl");Ba.DirectInvokeDavUrl=R.kb("DirectInvokeDAVUrl");Ba.EditDocInClientUrl=R.kb("EditDocInClientUrl");R=R.kb("BreadcrumbDocName");Ba.NewName=l.AFrameworkApplication.KKd?R:Xa.a.tJ(R);this.RCe.execute(lb=>{this.LEm(Ba,lb)})}LEm(R,Ba){this.$ek().H1c(R,Ba)}}Object(f.a)(ul,"RenamedFileCheckerUsingSettingsRefresh",cl,[]);class qi extends cl{constructor(R,
Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma){super(R,lb,Vb,zc,Yc,pa);this.mBc=this.Vl=null;this.mdk=Ba;this.ga=Zd;this.Ib=$e;Ma&&Ma.execute(ya=>{this.WVn(ya)})}get cMf(){return"RenamedFileCheckerUsingTask"}WVn(R){this.Vl=R;this.Vl.$Za(Object(a.a)(this,this.aY,"handleVisibilityChange"))}aY(R,Ba){!this.Qs||0!==Ba.newState&&1!==Ba.newState||this.mBc||(this.Nhg(),this.t_f(this.mBc))}Nhg(){this.mBc=new Lc.a(3,2,this.mdk(),Object(a.a)(this,this.t_f,"performRenameFileCheckTick"),89);this.Ib.Xb(this.mBc)}wuj(R){this.Ib.Ze(R)}Jlh(R){this.Vl&&
2===this.Vl.JD?this.NXn(R):l.AFrameworkApplication.WOa(Object(a.a)(this,this.sgc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.u7d,"onRefreshFilenameFailure"),!0)}NXn(R){this.Ib.Ze(R);this.mBc=null}sgc(R){R&&this.QWi(R.BreadcrumbFolderName,R.BreadcrumbFolderUrl,R.NewName,null)}Jki(){this.ga.processAction(m.a.fileNameUpdate,2)}u7d(){}}Object(f.a)(qi,"RenamedFileCheckerUsingTask",cl,[]);var Jg=c(67);class xi{constructor(){this.Ga=this.W=null}get name(){return"Common.App.RenameFile"}wc(R){this.W=
R;this.Ga=l.AFrameworkApplication.K;this.W.register(Zg,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Sd(()=>new Zg(l.AFrameworkApplication.va,this.W.Re("Common.App.Rename.IRenameDialogFactory"))).ha();this.W.register(jg,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Sd(()=>new jg(l.AFrameworkApplication.va)).ha();this.W.register(1697,"Common.App.Rename.IRenamedFileChecker").Sd(()=>this.Sbl()).ha();this.W.register(Qh,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Sd(()=>
new Qh(l.AFrameworkApplication.va,Jg.FocusManager.instance())).ha()}Sbl(){if(this.Ga.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const R=this.W.Oa("Common.IRefreshableAppSettings");if(R&&R.vAi)return new ul(()=>R.lc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.Cs,()=>new Date,()=>l.AFrameworkApplication.Om,R,this.W.Oa("Common.ISessionStatus"),()=>af.instance,this.W.Ta("Postmessage.IHostPostmessenger"))}return new qi(()=>this.Ga.lc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Ga.lc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.Cs,()=>new Date,()=>l.AFrameworkApplication.Om,l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.oc,this.W.Oa("Common.ISessionStatus"),this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ga.Hn(Object(a.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){const R=l.AFrameworkApplication.ua.Lb.IJ;l.AFrameworkApplication.eXc()&&Bg.instance.initialize(l.AFrameworkApplication.pNd,
R?null:l.AFrameworkApplication.YSh,R?null:l.AFrameworkApplication.oaj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(ei,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Sd(()=>new ei(()=>l.AFrameworkApplication.zpg,()=>l.AFrameworkApplication.mv,l.AFrameworkApplication.e6c,l.AFrameworkApplication.eXc,new Mb.a(()=>l.AFrameworkApplication.Om))).ha(),af.instance.Tb(),this.Ga.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.Cs,
l.AFrameworkApplication.pNd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Tb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Tb(),l.AFrameworkApplication.e6c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").ltk())}dispose(){}}Object(f.a)(xi,"PackageManager",null,[1,2]);class Fj{static get Yg(){return k.a.Bz(Fj.Sm,CommonUIStrings.l_SaveACopyFileName)}}Fj.Sm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Fj,"FileNameDialogHtml",null,[]);class km extends k.a{constructor(R,Ba,lb,Vb){super();this.Skd=this.eLa=null;this.ga=R;this.fsa=Ba;this.c1b=lb;this.xe(1,CommonUIStrings.l_SaveButtonLabel);this.Yg=Fj.Yg;this.ug="FileNameDialog-SaveACopy";this.Km=Vb}oEa(R,Ba,lb){this.Skd=R;this.eLa=lb;R={["txtFileName"]:Xa.a.tJ(l.AFrameworkApplication.Cs.uz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Ba)};this.Qh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.oNd,"fileNameDialogHandler"),
R);va.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}oNd(R,Ba){1!==R?va.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(R=Ba.txtFileName.trim(),va.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Ba=Xa.a.zha(l.AFrameworkApplication.fileName),R&&""!==R&&""!==Ba&&(R+=Ba),this.c1b.zza(this.Skd,this.eLa,R,this.Km))}}Object(f.a)(km,"FileNameDialog",
k.a,[1742]);class hg{constructor(R,Ba,lb){this.ga=R;this.fsa=Ba;this.c1b=lb}create(R){return new km(this.ga,this.fsa,this.c1b,R)}}Object(f.a)(hg,"FileNameDialogFactory",null,[1715]);class Wg extends Jh.StandardDialog{constructor(R){super();this.Cd=1;this.xe(1,CommonUIStrings.l_RetryButtonLabel);this.xe(0,CommonUIStrings.l_DialogClose);this.ga=R}NO(R){va.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",R);this.rx(R,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(a.a)(this,this.y9f,"retryDialogHandler"))}y9f(R){1===R?(va.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(m.a.Ejc,2)):va.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(f.a)(Wg,"RetryDialog",Jh.StandardDialog,[1714]);var ej=c(1212);class tm{constructor(R,Ba,lb,Vb){this.Fud=null;this.rgk=R;this.Ga=lb;this.N8g=Ba;this.Z3g=new z.a;this.he=Vb}zdc(){return this.Ga.$("SaveToCloudStorageUIIsEnabled")}cib(){return m.a.H$f}TDd(){ac.a.ice(Object(a.a)(this,
this.xfj,"saveToCloudActionDispatcher"));ac.a.uMc([new ej.a(m.a.H$f,y.a.frame,0)],this.N8g.I9b())}Tb(){const R=this.N8g.I9b();R?(R.t_(()=>{this.Z3g.Ag(!0)}),this.TDd()):va.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}z6i(){va.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}xfj(R,Ba,lb,Vb,zc){return Ba.contextId!==y.a.frame||R!==this.cib()?2:this.zdc()?1===lb?Mf.SessionStatusManager.instance.Uj||l.AFrameworkApplication.opa?
8:32:2===lb?(this.z6i(),zc&&zc.FileDownloadUrl&&va.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.he&&(this.Fud=this.he.Vf("DialogShown","SaveToOneDriveReponseTime")),this.Z3g.task.continueWith(()=>{this.Fud&&(this.Fud.stop(),this.Fud=null);this.rgk.start(zc)}),32):8:8}}Object(f.a)(tm,"SaveToCloudStorageActor",null,[1723]);class nl extends tm{constructor(R,Ba,lb,Vb){super(R,Ba,lb,Vb);this.Pbk=Ba}zdc(){return this.Ga.$("SaveACopyBrsIsEnabled")}cib(){return m.a.Ejc}TDd(){ac.a.ice(Object(a.a)(this,
this.xfj,"saveToCloudActionDispatcher"));ac.a.uMc([new ej.a(m.a.Ejc,y.a.frame,0)],this.Pbk.I9b())}z6i(){l.AFrameworkApplication.le("CreateCopy_cf;CreateCopy_tf");va.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(nl,"SaveACopyActor",tm,[]);class Pg{}Pg.default=0;Object(f.a)(Pg,"SaveToCloudErrorCodes",null,[]);class fi{constructor(R,Ba,lb,Vb,zc,Yc){this.Km=null;this.jik=R;this.Qta=Ba;this.c1b=lb;this.Ga=Vb;this.aUb=zc;this.mH=Yc}start(R){this.Km=R;
if("SharePointOnlineConsumer"===this.Ga.kb("FileSource")){const Ba=ta.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(Ba){Ba.start(null,R);return}}this.Qta.XUc?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1)&&l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk?(va.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),
this.c1b.zza("root","https://onedrive.live.com",null,this.Km)):(va.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.mQk()):(va.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.wvo())}wvo(){this.jik.create().oEa()}zp(){this.mH().NO(Pg.default)}mQk(){try{va.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let R={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.aUb||2===this.aUb)R=
{["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId};WL.init(R);va.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(R){va.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",
R,R.stack),this.zp()}}onSuccess(R){va.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");R&&R.data&&R.data.folders&&this.c1b.zza(R.data.folders[0].id,R.data.folders[0].urls.viewInBrowser,null,this.Km)}onFailure(R){if(R&&R.error){if("user_canceled"===R.error.code){va.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}va.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",
R.error.code,R.error.message)}else va.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.zp()}}Object(f.a)(fi,"SaveToCloudManager",null,[1724]);class Em extends fi{constructor(R,Ba,lb,Vb,zc,Yc,Zd){super(Ba,lb,Vb,zc,Yc,Zd);this.W0j=R}onSuccess(R){R&&R.data&&R.data.folders?(va.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.W0j.create(this.Km).oEa(R.data.folders[0].id,R.data.folders[0].name,R.data.folders[0].urls.viewInBrowser)):(va.ULS.sendTraceTag(7165656,
216,10,"Fail to select folder to upload file."),this.zp())}onFailure(R){R&&R.error&&"user_canceled"===R.error.code&&va.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(R)}zp(){va.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.zp()}}Object(f.a)(Em,"SaveACopyManager",fi,[]);var kg=c(199);class aj{constructor(R,Ba,lb,Vb,zc){this.eLa=this.Bk=this.krc=null;this.RZ=!1;this.Km=this.FZa=null;this.oWe=R;this.vYa=Ba;this.mH=
lb;this.Ti=Vb;this.he=zc}Q7a(){this.Ti&&1===this.Ti.state||(this.Bk=this.vYa(),this.Bk.message=CommonUIStrings.l_CommentProgressTooltip,this.Bk.Cd=5,this.Bk.Ht=!1,this.Bk.GL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Hna(){this.Bk&&(this.Bk.close(),this.Bk=null)}K5(){1!==l.AFrameworkApplication.ua.state&&this.mH().NO(Pg.default)}jOb(){va.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");oa.a.om(this.eLa,oa.a.Ura(3),void 0,"UploadToCloudManager.RedirectToFolder")}iOb(R){l.AFrameworkApplication.ua&&
l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk&&(R+="&wdsvodm=true");let Ba=!1,lb=!1;l.AFrameworkApplication.K&&(Ba=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),lb=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));va.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",R,Ba);if(Ba&&lb){va.ULS.sendTraceTag(594929733,216,
50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Vb={};Vb[Uc.a.vic]="1";Vb[Uc.a.documentUrl]=R;l.AFrameworkApplication.kP().execute(zc=>{zc.sendMessage(Pd.a.BDb,Vb)})}else oa.a.om(R,oa.a.Ura(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}zza(R,Ba,lb=null,Vb=null){va.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.he&&(this.FZa=this.he.Vf("DialogShown","SaveToOneDriveUploadTime"));this.Q7a();this.eLa=Ba;this.krc=this.oWe.create(R,lb,Vb);
this.Km=Vb;this.eha()}eha(){va.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.krc.execute(Object(a.a)(this,this.irn,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.hrn,"onSaveToCloudUploadFailed"))}irn(R){this.Hna();this.RZ=!1;if(R&&R.data&&R.data.se){var Ba;if(({Hu:Ba}=ab.d(R.data.se)).returnValue)if(R=Ba,R.StatusCode!==kg.a.$y&&R.StatusCode!==kg.a.hKc)va.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.K5();else{va.ULS.sendTraceTag(6590603,
216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk?15:50,"UploadToCloudManager upload success.");try{R.NewDocumentUrl&&""!==R.NewDocumentUrl?this.iOb(R.NewDocumentUrl):this.jOb()}catch(lb){va.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",lb.toString())}this.V2c()}else va.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Cb.a.Ibd(R.data.se)}),this.K5()}else va.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.K5()}hrn(R){5!==R.data.status&&12!==R.data.status||this.RZ?(va.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",R.data.status),this.Hna(),this.K5(),this.V2c()):(va.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.RZ=!0,this.eha())}V2c(){this.FZa&&(this.FZa.stop(),this.FZa=null)}}Object(f.a)(aj,"UploadToCloudManager",null,[1696]);class Ri extends aj{constructor(R,Ba,lb,Vb,zc,Yc){super(Ba,lb,Vb,zc,Yc);this.ga=R}qGf(){return!!this.Km&&
!!this.Km.SaveEntryPoint&&"VersionHistory"===this.Km.SaveEntryPoint.toString()}K5(){va.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.qGf()&&this.ga.Rb(m.a.sde,2,{["FailureReason"]:"Unknown"});super.K5()}jOb(){va.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.qGf()&&this.ga.processAction(m.a.y6c,2);super.jOb()}iOb(R){va.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",R);this.qGf()&&this.ga.processAction(m.a.y6c,
2);super.iOb(R)}eha(){this.Km&&"true"===this.Km.SkipSaveToHost?super.eha():32!==this.ga.processAction(m.a.jPb,1)?(va.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.eha()):this.ga.Rb(m.a.jPb,2,[()=>{va.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");aj.prototype.eha.call(this)},()=>{va.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.K5()}])}}Object(f.a)(Ri,"SaveACopyUploadToCloudManager",aj,[]);var Qk=c(755),dl=c(1207);class dm{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Hn(Object(a.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Tb()}dispose(){}wc(R){this.W=R;this.W.register(Ri,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Sd(()=>new Ri(l.AFrameworkApplication.va,
R.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new dl.a).create(),()=>new Wg(l.AFrameworkApplication.va),l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Iq)).ha();this.W.register(hg,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Sd(()=>new hg(l.AFrameworkApplication.va,l.AFrameworkApplication.ua.Lb,R.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();this.W.register(nl,"Common.App.SaveACopy.SaveACopyActor").Sd(()=>
new nl(R.resolve("Common.App.SaveACopy.SaveACopyManager"),R.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Iq)).ha();this.W.register(Em,"Common.App.SaveACopy.SaveACopyManager").Sd(()=>new Em(R.resolve("Common.App.SaveACopy.FileNameDialogFactory"),R.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Qk.a.instance,R.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.D8,
()=>new Wg(l.AFrameworkApplication.va))).ha()}static main(){L.a.instance.Gc(new dm)}}Object(f.a)(dm,"PackageManager",null,[1,2]);var xn=c(50);class ah extends Jh.StandardDialog{constructor(R,Ba){super();this.eZb=!1;this.WN=null;this.ga=R;this.vuc=Ba;this.xIa=!1}NO(R,Ba,lb){this.WN=Ba;this.eZb=lb;va.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",R,lb);R=this.y6e(R);0===R?(this.Cd=6,this.xe(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.xe(1,CommonUIStrings.l_DialogClose));
0===R&&va.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.rx(xn.a.x8n,this.zTl(R),this.yTl(R,Ba),Object(a.a)(this,this.y9f,"retryDialogHandler"),!0)}y9f(R){1===R?(va.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.WN?this.ga.Rb(m.a.z7c,2,[this.WN,this.eZb]):this.ga.processAction(m.a.z7c,2)):va.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}y6e(R){return 0>R||6<R?(va.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",
R),0):R}yTl(R,Ba){R=this.y6e(R);return this.vuc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Ba),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][R]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,Ba),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][R]}zTl(R){R=this.y6e(R);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][R]}}Object(f.a)(ah,"ErrorRetryDialog",Jh.StandardDialog,[1755]);class Tn{constructor(R,Ba){this.Ga=
R;this.ga=Ba;this.vuc=this.Ga.$("SaveToHostWithExtraCharsInFileName")}create(){return new ah(this.ga,this.vuc)}}Object(f.a)(Tn,"ErrorRetryDialogFactory",null,[1734]);class Jj extends k.a{constructor(R,Ba,lb,Vb,zc,Yc,Zd=null){super();this.Q6=null;this.ga=Ba;this.fsa=Vb;this.GZa=Yc;this.Ga=R;this.mH=zc;this.Ti=lb;this.vuc=this.Ga.$("SaveToHostWithExtraCharsInFileName");this.Km=Zd;this.xe(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.Ti}CRh(R,Ba){this.bra(1,!!R&&R!==Ba);this.Q6=document.getElementById(Jj.WYh);
T.a.addHandler(this.Q6,"change",Object(a.a)(this,this.w6d,"onFileNameChange"));T.a.addHandler(this.Q6,"input",Object(a.a)(this,this.w6d,"onFileNameChange"));this.Q6.focus()}VYh(R){return this.vuc?(new RegExp("["+this.NWh('\\/:*?"<>|')+"]")).test(R):(new RegExp("["+this.NWh('\\/:*?"<>|#{}%~&')+"]")).test(R)}NWh(R){return R.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Qwf(){const R=Xa.a.tJ(l.AFrameworkApplication.Cs.uz);this.bra(1,!!this.Q6&&""!==this.Q6.value&&this.Q6.value!==R)}w6d(){this.Q6&&
window.setTimeout(()=>{this.Qwf()},0)}oNd(R,Ba){if(1!==R)va.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{R=Ba[Jj.WYh];Ba=Jj.PYi in Ba?Ba[Jj.PYi]:!1;va.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Xa.a.X6i(R),Ba);const lb=Xa.a.zha(l.AFrameworkApplication.fileName);(R=R?R.trim():null)&&""!==R&&""!==lb||1===this.ua.state?this.VYh(R)?this.mH.create().NO(1,R,Ba):this.GZa.zza(R+
lb,Ba,this.Km):this.mH.create().NO(2,R,Ba)}}dispose(){this.Q6&&(T.a.removeHandler(this.Q6,"change",Object(a.a)(this,this.w6d,"onFileNameChange")),T.a.removeHandler(this.Q6,"input",Object(a.a)(this,this.w6d,"onFileNameChange")),this.Q6=null);super.dispose()}}Jj.WYh="txtFileName";Jj.PYi="chkOverwrite";Object(f.a)(Jj,"FileNameDialogBase",k.a,[]);class Yi{static get Yg(){return k.a.Bz(Yi.Sm,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Yi.Sm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(Yi,"FileNameDialogHtml",null,[]);class Lm extends Jj{constructor(R,Ba,lb,Vb,zc,Yc){super(R,Ba,lb,Vb,zc,Yc);this.Yg=Yi.Yg;this.ug="FileNameDialog-SaveAsToHost"}oEa(R,Ba){const lb=Xa.a.tJ(l.AFrameworkApplication.Cs.uz);Ba={["txtFileName"]:R||lb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Ba};this.Qh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.oNd,"fileNameDialogHandler"),Ba);this.CRh(R,lb)}}Object(f.a)(Lm,"FileNameDialog",Jj,[1754]);class bn{constructor(R,Ba,
lb,Vb,zc,Yc){this.ga=Ba;this.Ga=R;this.fsa=Vb;this.GZa=Yc;this.mH=zc;this.Ti=lb}create(){return new Lm(this.Ga,this.ga,this.Ti,this.fsa,this.mH,this.GZa)}}Object(f.a)(bn,"FileNameDialogFactory",null,[1733]);class zh{constructor(R,Ba,lb){this.GZa=lb;this.nAe=Ba;this.Ga=R}Tb(){2===l.AFrameworkApplication.ua.Lb.Nk?l.AFrameworkApplication.va.fb(m.a.z7c,y.a.frame,Object(a.a)(this,this.ffj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.va.ra(m.a.z7c,y.a.frame,Object(a.a)(this,this.ffj,"saveAsToHostActionDispatcher"))}ffj(R,
Ba,lb,Vb,zc){return Ba.contextId!==y.a.frame||R!==m.a.z7c?2:this.Ga.$("SaveAsToHostBrsIsEnabled")?1===lb?Mf.SessionStatusManager.instance.Uj||l.AFrameworkApplication.opa?8:32:2===lb?(va.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),R=this.nAe.create(),zc&&Object.getType(zc)===Array&&2===zc.length?R.oEa(zc[0],!!zc[1]):R.oEa(null,!1),32):8:8}}Object(f.a)(zh,"SaveAsToHostActor",null,[]);class vg{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){this.Bk=null;this.eZb=this.RZ=
!1;this.FZa=this.Km=this.WN=null;this.Ga=Ba;this.wma=this.Ga.appSettings.SaveAsToHostWebServiceBase;this.EZg=Vb;this.vYa=zc;this.Wf=lb;this.mH=Yc;this.he=$e;this.Ti=Zd;this.ga=R;this.aXa=Ba.kb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Q7a(){1!==this.Ti.state&&(this.Bk=this.vYa(),this.Bk.message=CommonUIStrings.l_CommentProgressTooltip,this.Bk.Cd=5,this.Bk.Ht=!1,this.Bk.GL(CommonUIStrings.l_DefaultDialogTitle,null,null))}K5(R=0){1!==this.Ti.state&&this.mH.create().NO(R,Xa.a.tJ(this.WN),
this.eZb)}jOb(){const R=this.Ga.appSettings.BreadcrumbFolderUrl;va.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");oa.a.om(R,oa.a.Ura(3),void 0,"UploadToHostManager.RedirectToFolder")}iOb(R){let Ba=!1,lb=!1;this.Ga&&(Ba=this.Ga.$("SaveACopyIsEnabledForUiHost"),lb=this.Ga.$("UiHostSupportsDocRebootFeatures"));va.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",R,Ba,lb);if(Ba&&lb){va.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Vb={};Vb[Uc.a.vic]="1";Vb[Uc.a.documentUrl]=R;Vb[Uc.a.reason]=ze.a.y$f;l.AFrameworkApplication.kP().execute(zc=>{zc.sendMessage(Pd.a.BDb,Vb)})}else Ba&&!lb&&l.AFrameworkApplication.UM?oa.a.om(R,oa.a.Ura(4),void 0,"UploadToHostManager.RedirectToEditUrl"):oa.a.om(R,oa.a.Ura(3),void 0,"UploadToHostManager.RedirectToEditUrl")}zza(R,Ba,lb=null){va.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.EZg&&
!this.EZg()&&this.Wf&&(this.he&&(this.FZa=this.he.Vf("DialogShown","SaveAsToHostUploadTime")),this.Q7a(),this.eZb=Ba,this.WN=R,(this.Km=lb)&&"true"===this.Km.SkipSaveToHost?this.BMd():this.eha())}eha(){32!==this.ga.processAction(m.a.jPb,1)?(va.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.BMd()):this.ga.Rb(m.a.jPb,2,[()=>{va.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.BMd()},(R,Ba)=>
{va.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.K5(Ba)}])}otn(R){this.Hna();this.RZ=!1;if(R&&R.data&&R.data.se)if(({Hu:Ba}=ab.d(R.data.se)).returnValue)if(R=Ba,R.StatusCode!==kg.a.$y&&R.StatusCode!==kg.a.hKc){va.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Ba={};Ba.FailureReason=R.StatusCode.toString();Ba.ExtraInfo=R.ExtraInfo;this.pTa(Ba);this.K5(parseInt(R.ExtraInfo))}else{va.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.w8f();try{R.NewDocumentUrl&&""!==R.NewDocumentUrl?this.iOb(R.NewDocumentUrl):this.jOb()}catch(lb){va.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",lb.toString())}this.V2c()}else va.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Cb.a.Ibd(R.data.se)}),this.pTa({["FailureReason"]:"Failed to deserialize response"}),this.K5();else va.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.pTa({["FailureReason"]:"null response"}),this.K5()}ntn(R){5!==R.data.status&&12!==R.data.status||this.RZ?(va.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:R.data.status,["HttpStatus"]:R.data.Qe}),this.pTa({["FailureReason"]:R.data.Qe.toString()}),this.Hna(),this.K5(),this.V2c()):(va.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.RZ=!0,this.Km&&"true"===this.Km.SkipSaveToHost?this.BMd():this.eha())}Hna(){this.Bk&&
(this.Bk.close(),this.Bk=null)}V2c(){this.FZa&&(this.FZa.stop(),this.FZa=null)}w8f(){this.Km&&"VersionHistory"===this.Km.SaveEntryPoint&&this.ga.processAction(m.a.y6c,2)}pTa(R){this.Km&&"VersionHistory"===this.Km.SaveEntryPoint&&this.ga.Rb(m.a.sde,2,R)}BMd(){let R=this.wma+this.aXa;R=mc.a.$o(R,"qs",Xa.a.Dj(l.AFrameworkApplication.km));R=mc.a.$o(R,"n",Xa.a.Dj((new Date).getTime().toString()));R=mc.a.$o(R,"ov",Xa.a.Dj(this.eZb.toString()));R=mc.a.$o(R,"fn",Xa.a.Dj(this.WN));this.Km&&this.Km.FileDownloadUrl&&
(R=mc.a.$o(R,"furl",Xa.a.Dj(this.Km.FileDownloadUrl)));this.Wf.sj(R,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.otn,"onUploadFinished"),Object(a.a)(this,this.ntn,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(vg,"UploadToHostManager",null,[1695]);class jl{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Hn(Object(a.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Tb()}wc(R){this.W=R;this.W.register(Tn,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Sd(()=>new Tn(l.AFrameworkApplication.K,l.AFrameworkApplication.va)).ha();this.W.register(vg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Sd(()=>new vg(l.AFrameworkApplication.va,l.AFrameworkApplication.K,l.AFrameworkApplication.He,()=>l.AFrameworkApplication.Lk,
()=>(new dl.a).create(),R.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Iq)).ha();this.W.register(bn,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Sd(()=>new bn(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Lb,R.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),R.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();
this.W.register(zh,"Common.App.SaveAsToHost.SaveAsToHostActor").Sd(()=>new zh(l.AFrameworkApplication.K,R.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),R.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){L.a.instance.Gc(new jl)}}Object(f.a)(jl,"SaveAsToHostPackage",null,[1,2]);class Cl extends Jh.StandardDialog{constructor(){super();this.Cd=0;this.xe(1,CommonUIStrings.l_DialogClose)}NO(R){this.rx(R,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(f.a)(Cl,"ErrorDialog",Jh.StandardDialog,[1714]);var um=c(203);class Qm extends Jh.StandardDialog{constructor(R,Ba,lb){super();this.ga=R;this.Qta=Ba;this.fsa=lb;this.taa=!1;this.Cd=1;this.rV(1);this.xe(1,CommonUIStrings.l_SignIn);this.xe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}oEa(){this.Qta.Poh(Object(a.a)(this,this.NWi,"onSignIn"));this.pv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.yAm,"inputHandler"))}yAm(R){0===
R?(va.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.P9d()}BTk(){let R="2";if(this.fsa)switch(this.fsa.Nk){case 3:R="0";break;case 2:R="3";break;case 1:R="1"}return R}hide(){this.Qta.AZn(Object(a.a)(this,this.NWi,"onSignIn"));super.hide()}P9d(){var R=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";R=new um.QueryStringBuilder(R);
R.ye("prompt","1");R.ye("cbcxt",this.BTk());l.AFrameworkApplication.aga(R);oa.a.om(R.toString(),"LoginWindow",void 0,"SignInDialog")}NWi(){this.ypa&&this.hide();va.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb&&1===l.AFrameworkApplication.ua.Lb.Nk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(m.a.H$f,2)}}Object(f.a)(Qm,"SignInDialog",Jh.StandardDialog,[1749]);class oj{constructor(R,Ba,lb){this.ga=R;this.Qta=
Ba;this.fsa=lb}create(){return new Qm(this.ga,this.Qta,this.fsa)}}Object(f.a)(oj,"SignInDialogFactory",null,[1722]);class ph{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.wma=R;this.WN=Ba;this.wWb=lb;this.Skd=Vb;this.tOe=zc;this.aXa=Yc;this.Km=Zd}execute(R,Ba){if(!l.AFrameworkApplication.Lk&&l.AFrameworkApplication.He){var lb=this.wma+this.aXa;lb=mc.a.$o(lb,"fo",Xa.a.Dj(this.Skd));lb=mc.a.$o(lb,"fn",Xa.a.Dj(this.WN));lb=mc.a.$o(lb,"qs",Xa.a.Dj(this.tOe));lb=mc.a.$o(lb,"n",Xa.a.Dj((new Date).getTime().toString()));
this.Km&&this.Km.FileDownloadUrl&&(lb=mc.a.$o(lb,"furl",Xa.a.Dj(this.Km.FileDownloadUrl)));this.wWb&&(lb=mc.a.$o(lb,"fnn",Xa.a.Dj(this.wWb)));l.AFrameworkApplication.He.sj(lb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,R,Ba,null)}}}Object(f.a)(ph,"SkyDriveUploadCaller",null,[1748]);class cd{constructor(R){this.Ga=R;this.Vzb=R.appSettings.SkyDriveUploadWebServiceBase;this.WN=R.appSettings.FileName;this.aXa=R.kb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(R,Ba,lb){return new ph(this.Vzb,
this.WN,Ba,R,l.AFrameworkApplication.km,this.aXa,lb)}}Object(f.a)(cd,"SkydriveUploadCallerFactory",null,[1721]);class dg{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Tb()}dispose(){}wc(R){this.W=R;this.W.register(oj,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Sd(()=>
new oj(l.AFrameworkApplication.va,Qk.a.instance,l.AFrameworkApplication.ua.Lb)).ha();this.W.register(cd,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Sd(()=>new cd(l.AFrameworkApplication.K)).ha();this.W.register(tm,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Sd(()=>new tm(R.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),R.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Iq)).ha();this.W.register(aj,"Common.App.SaveToCloudStorage.UploadToCloudManager").Sd(()=>new aj(R.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new dl.a).create(),()=>new Cl,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Iq)).ha();this.W.register(fi,"Common.App.SaveToCloudStorage.SaveToCloudManager").Sd(()=>new fi(R.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Qk.a.instance,R.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.D8,()=>new Cl)).ha()}static main(){L.a.instance.Gc(new dg)}}Object(f.a)(dg,"PackageManager",null,[1,2]);class vm extends Jh.StandardDialog{constructor(){super();this.Cd=0;this.xe(1,CommonUIStrings.l_DialogClose)}NO(R,Ba){this.ZRh(R,Ba,xn.a.z8n)}ZRh(R,Ba,lb){va.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",lb);this.rx(lb,R,Ba,null)}Sef(R,Ba){va.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");
this.rx(xn.a.B8n,R,Ba,null,!0)}}Object(f.a)(vm,"ErrorDialog",Jh.StandardDialog,[947]);class Rm{static get Yg(){return k.a.Bz(Rm.Sm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Rm.Sm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(Rm,"FileNameDialogHtml",null,[]);var ce=c(79);class md extends Jj{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){super(R,Ba,lb,Vb,zc,Yc,$e);this.jbb=this.CQe=this.zQ=null;this.dOk=CommonUIStrings.l_SaveToAnotherFolder;this.Yg=Rm.Yg;this.ug="FileNameDialog-SaveToSharePoint";this.YBc=Zd;this.bck=$e}oEa(R){const Ba=Xa.a.tJ(l.AFrameworkApplication.Cs.uz),lb=l.AFrameworkApplication.breadcrumbFolderName,Vb=l.AFrameworkApplication.breadcrumbBrandName,zc={["txtFileName"]:R||Ba};let Yc=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ua.Lb.Nk&&(Yc=CommonUIStrings.L_SaveACopy);this.Qh(Yc,Object(a.a)(this,this.oNd,"fileNameDialogHandler"),zc);this.CRh(R,Ba);this.Mdf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.zQ=document.getElementById("anotherFolder"),R=document.getElementById("folderLocation"),this.CQe=Xf.a.Yrh(R,this.zQ,"anotherFolderDescribedBy"),this.zQ.className=
"WACButton WACDialogButtonNormal",R=!1,lb&&lb.length?(this.Fmh(this.zQ,this.CQe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Vb,lb)),R=this.npk(Vb,lb)):this.Fmh(this.zQ,this.CQe,CommonUIStrings.l_CurrentOnlineFolder),this.erk(this.zQ),this.ppk(this.zQ),R?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.zQ,"SaveToAnotherLocationTwo"),va.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.zQ,
"SaveToAnotherLocationOne"),T.a.addHandler(this.zQ,W.a.click,Object(a.a)(this,this.bXf,"onSaveToAnotherLocationClick")),T.a.addHandler(this.zQ,W.a.$h,Object(a.a)(this,this.tWi,"onSaveToAnotherLocationKeyDown")))}npk(R,Ba){let lb;lb=!1;const Vb=document.getElementById("currentLocation");Vb.innerText="";const zc=this.ibi(Vb,R),Yc=this.ibi(Vb,Ba);let Zd=255,$e=255;255<zc+Yc&&(Zd=Math.max(238,408-zc),$e=Math.max(170,408-Yc),lb=!0);this.ptk(Vb,R,$e,Ba,Zd);return lb}ibi(R,Ba){const lb=document.createElement("div");
lb.innerText=Ba;lb.style.visibility="hidden";R.appendChild(lb);Ba=lb.clientWidth;R.removeChild(lb);return Ba}ptk(R,Ba,lb,Vb,zc){Ba&&(this.Emh(R,Ba,lb),this.htk(R));Vb&&this.Emh(R,Vb,zc)}Emh(R,Ba,lb){const Vb=document.createElement("div");Vb.innerText=Ba;Vb.title=Ba;Vb.className="SaveToAnotherFolderBreadcrumb";Vb.style.maxWidth=lb.toString()+"px";R.appendChild(Vb)}htk(R){const Ba=document.createElement("span");Ba.id="FolderSeparator";const lb=document.createElementNS("http://www.w3.org/2000/svg","svg");
lb.setAttribute("class","SeparatorCaret");const Vb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Vb.setAttribute("points","1 4 1 11 5 7.5");lb.appendChild(Vb);Ba.appendChild(lb);R.appendChild(Ba)}Fmh(R,Ba,lb){lb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,lb);Ba&&(Ba.innerText=lb);R.tabIndex=0;R.setAttribute(Xf.a.oh,Xf.a.L3)}ppk(R){const Ba=document.createElement("span");Ba.id="anotherFolderText";Ba.innerText=this.dOk;Ba.className="AnotherFolderTextSpan";
R.appendChild(Ba)}erk(R){const Ba=document.createElement("span");Ba.className="cui-img-cont-float cui-img-16by16 ";this.jbb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.jbb.setAttribute("class","FolderIconSVG");const lb=document.createElementNS("http://www.w3.org/2000/svg","path");lb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.jbb.appendChild(lb);Ba.appendChild(this.jbb);R.appendChild(Ba)}tWi(R){!R||
R.keyCode!==ce.a.Ls&&R.keyCode!==ce.a.goe||this.bXf(R)}bXf(){if(this.Q6){const R=Xa.a.zha(l.AFrameworkApplication.fileName);let Ba=this.Q6.value;this.hide();Ba&&""!==Ba&&""!==R||1===this.ua.state?(""!==R&&(Ba+=R),this.VYh(Ba)?this.mH.create().NO(1,Ba,!1):this.YBc.start(Ba,this.bck)):this.mH.create().NO(2,Ba,!1)}}fTk(R){this.zQ&&this.jbb&&(R?(this.zQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.zQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.jbb,"DisabledFolderIconSVG")):(this.zQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.zQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.jbb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.zQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.jbb,"DisabledFolderIconSVG"))))}Qwf(){super.Qwf();this.fTk(!!this.Q6&&""!==this.Q6.value)}dispose(){this.zQ&&(T.a.removeHandler(this.zQ,W.a.click,Object(a.a)(this,this.bXf,"onSaveToAnotherLocationClick")),T.a.removeHandler(this.zQ,W.a.$h,Object(a.a)(this,this.tWi,
"onSaveToAnotherLocationKeyDown")),this.zQ=null);super.dispose()}}Object(f.a)(md,"FileNameDialog",Jj,[1103]);var mg=c(503),Kg=c(355),Jd=c(1558),tg=c(1683);class xd{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(xd,"SaveAsDialogInput",null,[]);class Oi{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(Oi,"SaveLocation",null,[]);var he=c(115);class Ng{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa){this.nIe=
null;this.WN="";this.YBc=R;this.mH=Ba;this.Km=pa;this.GZa=lb;this.Ti=zc;this.$L=Vb;this.Fzb=Zd;this.F_b=$e;Yc&&(this.nIe=new Mb.a(()=>new Jd.a(Yc.value,null)))}pSl(){const R=new mg.a(Kg.a.jh());R.Z("type","currentHost");return Object.assign(new Oi,{folderName:this.$L.breadcrumbFolderName,friendlyPath:this.$L.breadcrumbBrandName,properties:R})}rSm(R){return!!R&&"ClassicMru"===R.type&&!!R.service_info&&!!R.service_info.service_id&&-1!==R.service_info.service_id.indexOf("SHAREPOINT")}ccm(){if(!this.nIe||
!this.Fzb)return null;var R=this.nIe.value.jP("SaveAsToSharePointDialog",!1);if(!R||3!==R.state||!R.IOi)return null;R=R.IOi;const Ba=new mb.a;let lb=0,Vb=0;for(var zc=0;zc<R.length;zc++){var Yc=R[zc];if(!this.rSm(Yc))continue;lb++;if(!Yc.sharepoint_info)continue;const Zd=Yc.url,$e=Yc.sharepoint_info.site_url,pa=Yc.title;Yc=tg.b(Yc,l.AFrameworkApplication.isRtl);if(!(Zd&&$e&&pa&&Yc))continue;Vb++;const Ma=new mg.a(Kg.a.jh());Ma.Z("type","SharePoint");Ma.Z("siteUrl",$e);Ma.Z("folderUrl",Zd);Vb++;Ba.add(Object.assign(new Oi,
{folderName:pa,friendlyPath:Yc,properties:Ma}))}zc=new Map;zc.set("NumPlaces",R.length.toString());zc.set("NumSharepointPlaces",lb.toString());zc.set("placesWithMetadata",Vb.toString());La.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",zc);0<lb&&(Vb?.5>1*Vb/lb&&La.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):La.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ba}xTl(){const R=
new mb.a;R.add(this.pSl());const Ba=this.ccm();Ba&&R.addRange(Ba);return Object.assign(new xd,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.WN,extension:Xa.a.zha(this.$L.uz),saveLocations:R.toArray(),scenario:"SaveToSharePoint"})}Kof(){const R=Object(a.a)(this,this.xTl,"getDialogInput"),Ba={};Ba.inputPropsCallback=R;return Ba}oEa(R){this.WN=R;this.WN||(this.WN=String.format(CommonUIStrings.l_SaveACopy_Filename,Xa.a.tJ(this.$L.uz)));R={["id"]:"SaveAsDialog",
["bodyControls"]:this.Kof()};let Ba=CommonUIStrings.L_SaveAs;2===this.Ti.Lb.Nk&&(Ba=CommonUIStrings.L_SaveACopy);const lb=new k.a(!1,!1,!0);lb.Cd=1;lb.ug="SaveAsDialog";lb.xe(1,CommonUIStrings.l_SaveButtonLabel);lb.Qh(Ba,Object(a.a)(this,this.v8n,"saveAsDialogHandler"),R)}Juo(R,Ba){R&&""!==R&&""!==Ba||1===this.Ti.state?this.qSm()?this.w0m(R,Ba):(""!==Ba&&(R+=Ba),this.YBc.start(R,this.Km)):(va.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.mH.create().NO(2,
R,!1))}w0m(R,Ba){La.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const lb=this.F_b.Y$e(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.F_b.KQd(lb).then(Vb=>{if(Vb&&0<Vb.length){const zc=Vb[0][Uc.a.zAn];Vb=Vb[0][Uc.a.AAn];if(""!==zc&&""!==Vb)this.Fzb.zza(Vb,R+Ba,zc,this.Km),La.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.mH.create().NO(0,R,!1);const Yc=ob.a.oG();Yc&&(Yc.set("SiteUrlAvailable",
""===zc?"false":"true"),Yc.set("FolderUrlAvailable",""===Vb?"false":"true"));La.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new he.a,{extendedProperties:Yc}))}}else this.mH.create().NO(0,R,!1),La.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Vb=>{"Canceled"===Vb?((Vb=ob.a.oG())&&Vb.set("IsCanceled","true"),La.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new he.a,{extendedProperties:Vb}))):
La.Health.instance.recordKpiFailure("SaveACopySFP",Vb,!1,!1,null)})}qSm(){return this.F_b?this.F_b.zGf():(va.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}v8n(R,Ba){if(Ba&&1===R){R=Ba.fileName;var lb=Xa.a.zha(this.$L.uz);Ba.moreLocationsSelected&&this.Juo(R,lb);if(Ba.locationCallback){var Vb=Ba.locationCallback();Vb?Vb.properties&&"currentHost"===Vb.properties.J("type")?this.GZa.zza(R+lb,!1,this.Km):Vb.properties&&"SharePoint"===Vb.properties.J("type")?(Ba=Vb.properties.J("siteUrl"),
Vb=Vb.properties.J("folderUrl"),this.Fzb.zza(Vb,R+lb,Ba,this.Km)):va.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):va.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else va.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(Ng,"ReactSaveAsDialog",null,[1103]);class wk{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e=null,pa=null,Ma=null){this.ga=Ba;this.Ga=R;this.fsa=Vb;this.GZa=Yc;this.mH=zc;this.Ti=lb;this.ldh=Zd;this.L8j=$e;this.Fzb=pa;this.F_b=
Ma}create(R){return this.Ti&&this.Ti.Lb.pF?new Ng(this.ldh,this.mH,this.GZa,l.AFrameworkApplication.Cs,this.Ti,this.L8j,this.Fzb,this.F_b,R):new md(this.Ga,this.ga,this.Ti,this.fsa,this.mH,this.GZa,this.ldh,R)}}Object(f.a)(wk,"FileNameDialogFactory",null,[1078]);class Vj{constructor(R,Ba,lb,Vb){this.uv=this.Kzc=null;this.uub=R;this.Ti=lb;this.ldk=Vb;this.ZWa=new Mb.a(()=>new Jd.a(Ba.value,Object(a.a)(this,this.bGb,"getMoreInfoEventReceived")))}get LXi(){this.Kzc||(this.ZWa.value.jP("Save As",!0),
this.uv&&this.uv.Eda&&this.uv.Eda.length&&(this.Kzc=this.c5l(this.uv.Eda)));return this.Kzc}start(R){if(!this.LXi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.Kzc=l.AFrameworkApplication.breadcrumbFolderUrl;else return va.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.uv),!1;const Ba=this.ldk();Ba.Vuo();const lb=
Ba.P7l();if(!lb)return va.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.uub.start((Vb,zc)=>{Ba.hide();R(Vb,zc)},()=>{this.OLb(Ba)},lb,this.Kzc);return!0}OLb(R){R.hide();va.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}c5l(R){R=R.toLowerCase();R.endsWith("/")||(R+="/");const Ba=R.indexOf("/documents/");return-1!==Ba?R.substring(0,Ba+1)+"_layouts/15/onedrive.aspx":""}bGb(R){this.uv||3!==R.state||(this.uv=R)}}Object(f.a)(Vj,"OneDriveFilePickerHelper",
null,[1076]);class Xg extends k.a{constructor(){super()}Vuo(){this.Osc="FilePickerDialog";this.Yg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ug="PickerDialog-MsoSp";this.showDialog("",null)}P7l(){return document.getElementById("FilePickerDiv")}IL(){}Jda(){}}Object(f.a)(Xg,"PickerDialog",k.a,[1075]);class jf{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.Ga=R;this.nAe=lb;this.ga=Ba;this.YBc=Vb;this.uub=zc;this.Jzc=Yc;this.FWj=Zd}Tb(){const R=this.uub.I9b();R?ua.a.lpa||this.Ga.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(m.a.Gjc,y.a.frame,Object(a.a)(this,this.Afj,"saveToSharePointActionDispatcher"),64):(R.R4a.continueWith(Ba=>{Ba.Ei&&this.uub.SVf(Ba)}),this.TDd()):va.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}TDd(){ac.a.ice(Object(a.a)(this,this.Afj,"saveToSharePointActionDispatcher"));ac.a.uMc([new ej.a(m.a.Gjc,y.a.frame,0)],this.uub.I9b())}get zdc(){return this.Ga.$("SaveToAnotherFolderBrsIsEnabled")}get gAh(){return this.Ga.$("UserCanWriteRelative")}Afj(R,
Ba,lb,Vb,zc){return Ba.contextId!==y.a.frame||R!==m.a.Gjc?2:this.zdc&&(this.Jzc.LXi||this.gAh)?1===lb?Mf.SessionStatusManager.instance.Uj||l.AFrameworkApplication.opa?8:this.FWj()?32:8:2===lb?(va.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(zc&&zc.SaveEntryPoint&&"VersionHistory"===zc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.gAh?(va.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.nAe.create(zc).oEa(null)):(va.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.YBc.start(null,zc)),32):8:8}}Object(f.a)(jf,"SaveToSharePointActor",null,[]);class sf{constructor(R,Ba,lb,Vb){this.Km=this.G6g=null;this.Fzb=R;this.mH=Ba;this.Jzc=lb;this.Ti=Vb}start(R,Ba){va.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.G6g=R;this.Km=Ba;this.Jzc.start((lb,Vb)=>{this.processResponse(lb,Vb)})||this.hgg()}processResponse(R,Ba){if(R)this.onSuccess(Ba);else this.onFailure(Ba)}hgg(){1!==
this.Ti.state&&this.mH().Sef(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(R){va.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(R&&R.data&&R.data.value&&R.data.value.length&&R.data.value[0].sharePoint){const Ba=R.data.value[0].sharePoint.url;R=R.data.value[0].sharePoint.listUrl;let lb=null;if(Ba&&(lb=R?this.pcm(R):this.ocm(Ba))){this.Fzb.zza(Ba,this.G6g,lb,this.Km);return}va.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Ba,!lb)}va.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.hgg()}ocm(R){R.endsWith("/")||(R+="/");let Ba=0;for(let lb=0;lb<R.length;lb++)if("/"===R.charAt(lb)&&5===++Ba)return R.substr(0,lb);return null}pcm(R){R.endsWith("/")&&(R=R.substring(0,R.length-1));const Ba=R.lastIndexOf("/");return-1!==Ba?R.substring(0,Ba):null}onFailure(R){va.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");R&&R.error?va.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",R.error.errorCode,R.error.message):va.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.hgg()}}Object(f.a)(sf,"SaveToSharePointManager",null,[1693]);class Rh{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){this.wma=R;this.WN=Ba;this.wWb=Vb;this.tOe=Yc;this.eLa=lb;this.xik=zc;this.aXa=Zd;this.Km=$e}execute(R,Ba){if(!l.AFrameworkApplication.Lk&&
l.AFrameworkApplication.He){var lb=this.wma+this.aXa;lb=mc.a.$o(lb,"fu",Xa.a.Dj(this.eLa));lb=mc.a.$o(lb,"su",Xa.a.Dj(this.xik));lb=mc.a.$o(lb,"fn",Xa.a.Dj(this.WN));lb=mc.a.$o(lb,"n",Xa.a.Dj((new Date).getTime().toString()));this.Km&&this.Km.FileDownloadUrl&&(lb=mc.a.$o(lb,"furl",Xa.a.Dj(this.Km.FileDownloadUrl)));lb=lb+"&"+this.tOe;this.wWb&&this.wWb.length?lb=mc.a.$o(lb,"fnn",Xa.a.Dj(this.wWb)):va.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");va.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.He.sj(lb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,R,Ba,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(Rh,"SharePointSaveAsCaller",null,[1719]);class ij{constructor(R){this.Vzb=R.appSettings.SaveAsToHostWebServiceBase;this.WN=R.appSettings.FileName;this.aXa=R.kb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(R,Ba,lb,Vb){return new Rh(this.Vzb,this.WN,R,Ba,lb,l.AFrameworkApplication.km,
this.aXa,Vb)}}Object(f.a)(ij,"SharePointUploadCallerFactory",null,[1691]);var hn=c(1385);class pg{constructor(R,Ba,lb,Vb,zc){this.Bk=this.krc=null;this.tse=!1;this.wQe=this.eLa=null;this.oWe=Ba;this.vYa=lb;this.mH=Vb;this.Ti=zc;this.ga=R}zza(R,Ba,lb,Vb){this.tse=!1;va.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Q7a();this.eLa=R;Vb&&Vb.SaveEntryPoint&&(this.wQe=Vb.SaveEntryPoint);this.krc=this.oWe.create(R,Ba,lb,Vb);Vb&&"true"===Vb.SkipSaveToHost?
this.eha():this.HGl()}HGl(){const R=()=>{va.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.eha()};32!==this.ga.Rb(m.a.jPb,2,[()=>{va.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.eha()},R])&&R()}eha(){va.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.krc.execute(Object(a.a)(this,this.krn,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.jrn,
"onSaveToSharePointUploadFailed"))}krn(R){if(R&&R.data&&R.data.se){var Ba;if(({Hu:Ba}=ab.d(R.data.se)).returnValue)if(Ba.StatusCode!==kg.a.$y&&Ba.StatusCode!==kg.a.hKc)va.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",R.data.status,Ba.StatusCode),Ba.StatusCode!==kg.a.B8f&&this.HSh(R.data.status)||(this.pTa(Ba.StatusCode.toString()),this.Rto(Ba.StatusCode));else{va.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.w8f();try{Ba.NewDocumentUrl?this.iOb(Ba.NewDocumentUrl):this.jOb()}catch(lb){va.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",lb.toString())}}else va.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Cb.a.Ibd(R.data.se)}),this.EKd()||(this.pTa("Failed to deserialize response"),this.k$c())}else va.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.EKd()||(this.pTa("Unknown"),this.k$c())}jrn(R){R&&R.data?this.HSh(R.data.status)||
(va.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.pTa(hn.a[R.data.status]),this.k$c()):(va.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.EKd()||(this.pTa("Unknown"),this.k$c()))}EKd(){if(!this.tse)return va.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.tse=!0,this.eha(),!0;va.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}HSh(R){va.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
R);return this.EKd()}jOb(){va.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");oa.a.om(this.eLa,oa.a.Ura(3),void 0,"UploadToSharePointManager.RedirectToFolder")}iOb(R){let Ba=!1,lb=!1;l.AFrameworkApplication.K&&(Ba=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),lb=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));va.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",R,Ba);if(Ba&&lb){va.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Vb={};Vb[Uc.a.vic]="1";Vb[Uc.a.documentUrl]=R;Vb[Uc.a.reason]=ze.a.y$f;l.AFrameworkApplication.kP().execute(zc=>{zc.sendMessage(Pd.a.BDb,Vb)})}else oa.a.om(R,oa.a.Ura(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Q7a(){this.Ti&&1===this.Ti.state||(this.Bk=this.vYa(),this.Bk.message=CommonUIStrings.l_CommentProgressTooltip,this.Bk.Cd=5,this.Bk.Ht=!1,this.Bk.GL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Hna(){this.Bk&&(this.Bk.close(),this.Bk=null)}k$c(){this.zp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}Kuo(){this.zp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Xto(){const R=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.zp(CommonUIStrings.l_SaveAsFileTooLargeTitle,R,xn.a.w8n)}zp(R,Ba,lb=xn.a.A8n){va.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",R,Ba);this.Hna();1!==this.Ti.state&&this.mH().ZRh(R,Ba,lb)}Rto(R){va.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
R);switch(R){case kg.a.Gme:this.Kuo();break;case kg.a.B8f:this.Xto();break;default:this.k$c()}}w8f(){"VersionHistory"===this.wQe&&this.ga.processAction(m.a.y6c,2)}pTa(R){"VersionHistory"===this.wQe&&this.ga.Rb(m.a.sde,2,{["FailureReason"]:R})}}Object(f.a)(pg,"UploadToSharePointManager",null,[1689]);var Rl=c(633),nh=c(129);class vl{constructor(){this.pdb=this.gKe=this.YJe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}wc(R){this.W=R;this.YJe=Rl.a.Bp(R.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.gKe=Rl.a.Bp(R.Ta("Common.IEventEmitter<Common.IMruResult>"));this.pdb=Rl.a.Bp(R.Ta("Common.App.SharedFilePicker.ISharedFilePicker"));nh.Task.WAA.call(null,this.YJe,this.gKe,this.pdb).continueWith(()=>{this.YRn()})}YRn(){this.W.register(ij,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Sd(()=>new ij(l.AFrameworkApplication.K)).ha();this.W.register(pg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Sd(()=>
new pg(l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new dl.a).create(),()=>new vm,l.AFrameworkApplication.ua)).ha();this.W.register(sf,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Sd(()=>new sf(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new vm,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ua)).ha();
this.W.register(Vj,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Sd(()=>new Vj(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Mb.a(()=>this.YJe.result),l.AFrameworkApplication.ua,()=>new Xg)).ha();this.W.register(wk,"Common.App.SaveToSharePoint.FileNameDialogFactory").Sd(()=>new wk(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Lb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Mb.a(()=>this.gKe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.pdb?this.pdb.result:null)).ha();this.W.register(jf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Sd(()=>new jf(l.AFrameworkApplication.K,l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ua.xRk)).ha();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Tb()}static main(){L.a.instance.Gc(new vl)}}Object(f.a)(vl,"PackageManager",null,[1,2]);class Dl{}Object(f.a)(Dl,
"StringDifference",null,[1694]);class oe{constructor(R,Ba){this.charCode=R;this.description=Ba}}Object(f.a)(oe,"UBTableEntry",null,[]);class Yg{}new oe(8,"C0 Controls 1");new oe(9,"Horizontal tab (HT)");new oe(10,"Line feed (LF)");new oe(12,"C0 Controls 2");new oe(13,"Carriage return (CR)");new oe(31,"C0 Controls 3");new oe(32,"Space");new oe(47,"ASCII Punctuation and Symbols 1");new oe(57,"ASCII Digits");new oe(64,"ASCII Punctuation and Symbols 2");new oe(90,"Uppercase Latin Alphabet");new oe(96,
"ASCII Punctuation and Symbols 3");new oe(122,"Lowercase Latin Alphabet");new oe(127,"U+0000..U+007F Basic Latin");new oe(159,"C1 Controls");new oe(160,"NB Space");new oe(191,"Latin-1 Punctuation and Symbols");new oe(255,"U+0080..U+00FF Latin-1 Supplement");new oe(383,"U+0100..U+017F Latin Extended-A");new oe(591,"U+0180..U+024F Latin Extended-B");new oe(687,"U+0250..U+02AF IPA Extensions");new oe(767,"U+02B0..U+02FF Spacing Modifier Letters");new oe(879,"U+0300..U+036F Combining Diacritical Marks");
new oe(1023,"U+0370..U+03FF Greek and Coptic");new oe(1279,"U+0400..U+04FF Cyrillic");new oe(1327,"U+0500..U+052F Cyrillic Supplement");new oe(1423,"U+0530..U+058F Armenian");new oe(1535,"U+0590..U+05FF Hebrew");new oe(1791,"U+0600..U+06FF Arabic");new oe(1871,"U+0700..U+074F Syriac");new oe(1919,"U+0750..U+077F Arabic Supplement");new oe(1983,"U+0780..U+07BF Thaana");new oe(2047,"U+07C0..U+07FF NKo");new oe(2111,"U+0800..U+083F Samaritan");new oe(2143,"U+0840..U+085F Mandaic");new oe(2303,"U+08A0..U+08FF Arabic Extended-A");
new oe(2431,"U+0900..U+097F Devanagari");new oe(2559,"U+0980..U+09FF Bengali");new oe(2687,"U+0A00..U+0A7F Gurmukhi");new oe(2815,"U+0A80..U+0AFF Gujarati");new oe(2943,"U+0B00..U+0B7F Oriya");new oe(3071,"U+0B80..U+0BFF Tamil");new oe(3199,"U+0C00..U+0C7F Telugu");new oe(3327,"U+0C80..U+0CFF Kannada");new oe(3455,"U+0D00..U+0D7F Malayalam");new oe(3583,"U+0D80..U+0DFF Sinhala");new oe(3711,"U+0E00..U+0E7F Thai");new oe(3839,"U+0E80..U+0EFF Lao");new oe(4095,"U+0F00..U+0FFF Tibetan");new oe(4255,
"U+1000..U+109F Myanmar");new oe(4351,"U+10A0..U+10FF Georgian");new oe(4607,"U+1100..U+11FF Hangul Jamo");new oe(4991,"U+1200..U+137F Ethiopic");new oe(5023,"U+1380..U+139F Ethiopic Supplement");new oe(5119,"U+13A0..U+13FF Cherokee");new oe(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new oe(5791,"U+1680..U+169F Ogham");new oe(5887,"U+16A0..U+16FF Runic");new oe(5919,"U+1700..U+171F Tagalog");new oe(5951,"U+1720..U+173F Hanunoo");new oe(5983,"U+1740..U+175F Buhid");new oe(6015,"U+1760..U+177F Tagbanwa");
new oe(6143,"U+1780..U+17FF Khmer");new oe(6319,"U+1800..U+18AF Mongolian");new oe(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new oe(6479,"U+1900..U+194F Limbu");new oe(6527,"U+1950..U+197F Tai Le");new oe(6623,"U+1980..U+19DF New Tai Lue");new oe(6655,"U+19E0..U+19FF Khmer Symbols");new oe(6687,"U+1A00..U+1A1F Buginese");new oe(6831,"U+1A20..U+1AAF Tai Tham");new oe(7039,"U+1B00..U+1B7F Balinese");new oe(7103,"U+1B80..U+1BBF Sundanese");new oe(7167,"U+1BC0..U+1BFF Batak");
new oe(7247,"U+1C00..U+1C4F Lepcha");new oe(7295,"U+1C50..U+1C7F Ol Chiki");new oe(7375,"U+1CC0..U+1CCF Sundanese Supplement");new oe(7423,"U+1CD0..U+1CFF Vedic Extensions");new oe(7551,"U+1D00..U+1D7F Phonetic Extensions");new oe(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new oe(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new oe(7935,"U+1E00..U+1EFF Latin Extended Additional");new oe(8191,"U+1F00..U+1FFF Greek Extended");new oe(8303,"U+2000..U+206F General Punctuation");
new oe(8351,"U+2070..U+209F Superscripts and Subscripts");new oe(8399,"U+20A0..U+20CF Currency Symbols");new oe(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new oe(8527,"U+2100..U+214F Letterlike Symbols");new oe(8591,"U+2150..U+218F Number Forms");new oe(8703,"U+2190..U+21FF Arrows");new oe(8959,"U+2200..U+22FF Mathematical Operators");new oe(9215,"U+2300..U+23FF Miscellaneous Technical");new oe(9279,"U+2400..U+243F Control Pictures");new oe(9311,"U+2440..U+245F Optical Character Recognition");
new oe(9471,"U+2460..U+24FF Enclosed Alphanumerics");new oe(9599,"U+2500..U+257F Box Drawing");new oe(9631,"U+2580..U+259F Block Elements");new oe(9727,"U+25A0..U+25FF Geometric Shapes");new oe(9983,"U+2600..U+26FF Miscellaneous Symbols");new oe(10175,"U+2700..U+27BF Dingbats");new oe(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new oe(10239,"U+27F0..U+27FF Supplemental Arrows-A");new oe(10495,"U+2800..U+28FF Braille Patterns");new oe(10623,"U+2900..U+297F Supplemental Arrows-B");
new oe(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new oe(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new oe(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new oe(11359,"U+2C00..U+2C5F Glagolitic");new oe(11391,"U+2C60..U+2C7F Latin Extended-C");new oe(11519,"U+2C80..U+2CFF Coptic");new oe(11567,"U+2D00..U+2D2F Georgian Supplement");new oe(11647,"U+2D30..U+2D7F Tifinagh");new oe(11743,"U+2D80..U+2DDF Ethiopic Extended");new oe(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new oe(11903,"U+2E00..U+2E7F Supplemental Punctuation");new oe(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new oe(12255,"U+2F00..U+2FDF Kangxi Radicals");new oe(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new oe(12351,"U+3000..U+303F CJK Symbols and Punctuation");new oe(12447,"U+3040..U+309F Hiragana");new oe(12543,"U+30A0..U+30FF Katakana");new oe(12591,"U+3100..U+312F Bopomofo");new oe(12687,"U+3130..U+318F Hangul Compatibility Jamo");new oe(12703,"U+3190..U+319F Kanbun");new oe(12735,
"U+31A0..U+31BF Bopomofo Extended");new oe(12783,"U+31C0..U+31EF CJK Strokes");new oe(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new oe(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new oe(13311,"U+3300..U+33FF CJK Compatibility");new oe(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new oe(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new oe(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new oe(42127,"U+A000..U+A48F Yi Syllables");new oe(42191,"U+A490..U+A4CF Yi Radicals");
new oe(42239,"U+A4D0..U+A4FF Lisu");new oe(42559,"U+A500..U+A63F Vai");new oe(42655,"U+A640..U+A69F Cyrillic Extended-B");new oe(42751,"U+A6A0..U+A6FF Bamum");new oe(42783,"U+A700..U+A71F Modifier Tone Letters");new oe(43007,"U+A720..U+A7FF Latin Extended-D");new oe(43055,"U+A800..U+A82F Syloti Nagri");new oe(43071,"U+A830..U+A83F Common Indic Number Forms");new oe(43135,"U+A840..U+A87F Phags-pa");new oe(43231,"U+A880..U+A8DF Saurashtra");new oe(43263,"U+A8E0..U+A8FF Devanagari Extended");new oe(43311,
"U+A900..U+A92F Kayah Li");new oe(43359,"U+A930..U+A95F Rejang");new oe(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new oe(43487,"U+A980..U+A9DF Javanese");new oe(43615,"U+AA00..U+AA5F Cham");new oe(43647,"U+AA60..U+AA7F Myanmar Extended-A");new oe(43743,"U+AA80..U+AADF Tai Viet");new oe(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new oe(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new oe(44031,"U+ABC0..U+ABFF Meetei Mayek");new oe(55215,"U+AC00..U+D7AF Hangul Syllables");new oe(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new oe(56191,"U+D800..U+DB7F High Surrogates");new oe(56319,"U+DB80..U+DBFF High Private Use Surrogates");new oe(57343,"U+DC00..U+DFFF Low Surrogates");new oe(63743,"U+E000..U+F8FF Private Use Area");new oe(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new oe(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new oe(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new oe(65039,"U+FE00..U+FE0F Variation Selectors");new oe(65055,"U+FE10..U+FE1F Vertical Forms");new oe(65071,"U+FE20..U+FE2F Combining Half Marks");
new oe(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new oe(65135,"U+FE50..U+FE6F Small Form Variants");new oe(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new oe(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new oe(65535,"U+FFF0..U+FFFF Specials");new oe(65663,"U+10000..U+1007F Linear B Syllabary");new oe(65791,"U+10080..U+100FF Linear B Ideograms");new oe(65855,"U+10100..U+1013F Aegean Numbers");new oe(65935,"U+10140..U+1018F Ancient Greek Numbers");new oe(65999,"U+10190..U+101CF Ancient Symbols");
new oe(66047,"U+101D0..U+101FF Phaistos Disc");new oe(66207,"U+10280..U+1029F Lycian");new oe(66271,"U+102A0..U+102DF Carian");new oe(66351,"U+10300..U+1032F Old Italic");new oe(66383,"U+10330..U+1034F Gothic");new oe(66463,"U+10380..U+1039F Ugaritic");new oe(66527,"U+103A0..U+103DF Old Persian");new oe(66639,"U+10400..U+1044F Deseret");new oe(66687,"U+10450..U+1047F Shavian");new oe(66735,"U+10480..U+104AF Osmanya");new oe(67647,"U+10800..U+1083F Cypriot Syllabary");new oe(67679,"U+10840..U+1085F Imperial Aramaic");
new oe(67871,"U+10900..U+1091F Phoenician");new oe(67903,"U+10920..U+1093F Lydian");new oe(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new oe(68095,"U+109A0..U+109FF Meoritic Cursive");new oe(68191,"U+10A00..U+10A5F Kharoshthi");new oe(68223,"U+10A60..U+10A7F Old South Arabian");new oe(68415,"U+10B00..U+10B3F Avestan");new oe(68447,"U+10B40..U+10B5F Inscriptional Parthian");new oe(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new oe(68687,"U+10C00..U+10C4F Old Turkic");new oe(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new oe(69759,"U+11000..U+1107F Brahmi");new oe(69839,"U+11080..U+110CF Kaithi");new oe(69887,"U+110D0..U+110FF Sora Sompeng");new oe(69967,"U+11100..U+1114F Chakma");new oe(70111,"U+11180..U+111DF Sharada");new oe(71375,"U+11680..U+116CF Takri");new oe(74751,"U+12000..U+123FF Cuneiform");new oe(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new oe(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new oe(92735,"U+16800..U+16A3F Bamum Supplement");new oe(94111,"U+16F00..U+16F9F Miao");new oe(110847,
"U+1B000..U+1B0FF Kana Supplement");new oe(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new oe(119295,"U+1D100..U+1D1FF Musical Symbols");new oe(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new oe(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new oe(119679,"U+1D360..U+1D37F Counting Rod Numerals");new oe(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new oe(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new oe(127023,"U+1F000..U+1F02F Mahjong Tiles");
new oe(127135,"U+1F030..U+1F09F Domino Tiles");new oe(127231,"U+1F0A0..U+1F0FF Playing Cards");new oe(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new oe(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new oe(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new oe(128591,"U+1F600..U+1F64F Emoticons");new oe(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new oe(128895,"U+1F700..U+1F77F Alchemical Symbols");new oe(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new oe(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new oe(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new oe(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new oe(917631,"U+E0000..U+E007F Tags");new oe(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new oe(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new oe(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Yg,"UnicodeBlocks",null,[1692]);class Vh{constructor(){this.W=
null}wc(R){this.W=R;this.W.register(Dl,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();this.W.register(Yg,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){L.a.instance.Gc(new Vh)}}Object(f.a)(Vh,
"SensitiveLoggingPackage",null,[1,2]);var Tf;(function(R){R[R.myFiles=0]="myFiles";R[R.recent=1]="recent";R[R.currentFolder=2]="currentFolder";R[R.yourPhone=3]="yourPhone"})(Tf||(Tf={}));Object(f.b)("SharedFilePickerLandingLocation",Tf);class Hf{constructor(R){this.yHb=this.Shc=null;this._initialized=!1;this.Hyf=R}lhb(R){this._initialized||(R.Fv(Pd.a.$5i),R.bC(Pd.a.$5i,Object(a.a)(this,this.hqn,"onReceivedPickerResponse")),this._initialized=!0)}KQd(R){return this.yHb=new Promise((Ba,lb)=>{const Vb=
{};Vb[Uc.a.yAn]=R;this.Shc=(zc,Yc)=>{""===Yc?(va.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ba(zc)):("Canceled"===Yc?va.ULS.sendTraceTag(572548164,306,50,Yc):va.ULS.sendTraceTag(556901065,306,10,Yc),lb(Yc))};this.Hyf.execute(zc=>{this.lhb(zc);zc.sendMessage(Pd.a.Pun,Vb)})})}hqn(R){this.Shc(R.Values[Uc.a.pao],void 0===R.Values[Uc.a.x_f]||null===R.Values[Uc.a.x_f]?"":R.Values[Uc.a.x_f])}zGf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}Y$e(R,Ba,lb,Vb,zc,
Yc,Zd,$e,pa=null){const Ma={};Ma[Uc.a.P$n]=R;Ma[Uc.a.titleText]=Ba;Ma[Uc.a.Xzk]=lb;Ma[Uc.a.Yzk]=Vb;Ma[Uc.a.$zk]=zc;Ma[Uc.a.Nnl]=!0;Ma[Uc.a.xAl]=Yc;Ma[Uc.a.CAn]=Zd;Ma[Uc.a.BAn]=Tf[$e];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ma[Uc.a.DAn]="Dark");pa&&(null!=pa.q2b&&(Ma[Uc.a.q2b]=pa.q2b),null!=pa.Kac&&(Ma[Uc.a.Kac]=pa.Kac));return Ma}}Object(f.a)(Hf,"SharedFilePickerManager",null,[1690]);class sh{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}wc(R){this.W=
R;R.register(Hf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().Sd(()=>new Hf(R.Ta("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Hn(()=>{this.k3a()})}k3a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){L.a.instance.Gc(new sh)}}Object(f.a)(sh,"SharedFilePickerPackage",null,[1,2]);class sj extends Sys.EventArgs{constructor(){super()}}Object(f.a)(sj,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class Tk{}Object(f.a)(Tk,"TypingSpeedMeterWindow",null,[]);class El{constructor(R,Ba){new N.a;this.$z=R;this.oi=Ba;this.oi.XZe(Object(a.a)(this,this.e6d,"onCpuMeterFrameAvailable"))}e6d(){}dispose(){this.oi.R$i(Object(a.a)(this,this.e6d,"onCpuMeterFrameAvailable"))}}Object(f.a)(El,"TypingSpeedMeter",null,[1718]);class $g{constructor(R){this.Hyd=null;this.fq=new z.a;this.$z=R}initialize(R,Ba,lb,Vb){this.Hyd||(this.Hyd=new El(this.$z,R,Ba,lb,Vb),this.fq.Ag(this.Hyd));return this.Hyd}}
Object(f.a)($g,"TypingSpeedMeterProvider",null,[1688]);class Ef{constructor(){this.KVe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const R=ta.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),Ba=Rl.a.Bp(ta.a.instance.Ta("Common.ICpuMeterProvider"));Ba.continueWith(()=>{const lb=Ba.result.fq.task;var Vb=new Ca.a(l.AFrameworkApplication.K.lc("TypingSpeedMeterWindowSamplingPercent",0)/100);Vb=new za.a(Object(a.a)(Vb,
Vb.jQb,"shouldBeInSample"));const zc=Oa.a.hF(12,1,Vb),Yc=l.AFrameworkApplication.K.lc("TypingSpeedMeterWindowTimeoutMs",5E3),Zd=l.AFrameworkApplication.K.lc("TypingSpeedMeterMaxKeystrokesPerWindow",5);lb.CWR(()=>this.KVe=R.initialize(lb.result,zc,Yc,Zd))})}}dispose(){this.KVe&&this.KVe.dispose()}wc(R){R.register($g,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().Sd(()=>new $g(oa.a.We))}static main(){L.a.instance.Gc(new Ef)}}Object(f.a)(Ef,"TypingSpeedMeterPackage",
null,[1,2]);class em{constructor(){this.events=[];this.y8f=!1}static mIf(R){return R.ctrlKey&&"Control"!==R.key||R.altKey&&"Alt"!==R.key||!!em.HWm[R.key]}static rMk(R,Ba){let lb;lb=em.mIf(R)?R.key:" "===R.key?"Space":"CharacterKey";return null!=Ba?(Ba.altPressed=(!!R.altKey).toString(),Ba.ctrlPressed=(!!R.ctrlKey).toString(),Ba.key=lb,Ba.repeat=(!!R.repeat).toString(),Ba.shiftPressed=(!!R.shiftKey).toString(),Ba):{["altPressed"]:(!!R.altKey).toString(),["ctrlPressed"]:(!!R.ctrlKey).toString(),["key"]:lb,
["repeat"]:(!!R.repeat).toString(),["shiftPressed"]:(!!R.shiftKey).toString()}}static Kzi(R){return window.performance&&window.performance.now&&R.timeStamp<performance.now()}static ZWh(R){return!!R&&em.Kzi(R)&&em.mIf(R)}static $Wh(R){return!!R&&em.Kzi(R)&&!em.mIf(R)}keyPressedEventHandlerStart(R,Ba){em.$Wh(R)&&this.Vtj(R,Ba)}keyPressedEventHandlerEnd(R){em.$Wh(R)&&this.Auj(R)}keyDownEventHandlerStart(R,Ba){em.ZWh(R)&&this.Vtj(R,Ba)}keyDownEventHandlerEnd(R){em.ZWh(R)&&this.Auj(R)}Vtj(R,Ba){R={["metadata"]:em.rMk(R,
Ba),["timeStamp"]:this.Cnc(R.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Cnc(performance.now()-R.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(R);this.fVn()}Auj(R){if(0!==this.events.length){var Ba=this.Cnc(R.timeStamp);for(let lb=this.events.length-1;0<=lb;--lb){const Vb=this.events[lb];if(Vb.timeStamp===Ba){Vb.timeToHandlerFinishMs=this.Cnc(performance.now()-R.timeStamp);Vb.eventDurationMs=this.Cnc(Vb.timeToHandlerFinishMs-Vb.timeToHandlerStartMs);
break}}}}Cnc(R){return Number(R.toFixed(2))}fVn(){if(!this.y8f){const R=document.createEvent("CustomEvent");R.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(R);requestAnimationFrame(()=>{this.y8f=!1;const Ba=performance.now();this.events.forEach(Vb=>{Vb.timeToRequestAnimationFrameMs=this.Cnc(Ba-Vb.timeStamp)});var lb=document.createEvent("CustomEvent");lb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(lb);this.events=[];lb=document.createEvent("CustomEvent");
lb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(lb)});this.y8f=!0}}}em.HWm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Di{constructor(){this.tde=this.h5a=this.wRa=this.bfc=null;this.sdc=!1;this.Tic=null;this.hOc=[];this.wcd=()=>{Di.rPm()&&null==this.h5a?(this.wRa=null,this.h5a=requestAnimationFrame(this.y_c)):null!=this.h5a&&
(cancelAnimationFrame(this.h5a),this.h5a=null)};this.y_c=R=>{if(null!=this.wRa){const Ba=R-this.wRa;if(null==this.bfc||this.bfc<Ba)this.bfc=Ba;for(let lb=0;lb<Di.ranges.length;++lb)if(Ba<Di.ranges[lb]){++this.hOc[lb];break}}this.wRa=R;this.h5a=requestAnimationFrame(this.y_c)};this.zbj=()=>{if(null!=this.bfc){var R={};for(var Ba=0;Ba<Di.ranges.length;++Ba)R[Di.ranges[Ba]]=this.hOc[Ba],this.hOc[Ba]=0;Ba=performance.now();R={["intervalStart"]:this.Tic,["intervalEnd"]:Ba,["maxFrameLengthMs"]:this.bfc,
["frameData"]:R};var lb=document.createEvent("CustomEvent");lb.initCustomEvent("reportframetiming",!1,!1,R);dispatchEvent(lb);this.bfc=null;this.Tic=Ba}}}static DFf(){return!!window.performance&&!!window.performance.now}start(R){!this.sdc&&Di.DFf()&&(this.nno(),this.tde=setInterval(this.zbj,1E3*R),this.Tic=performance.now(),this.wcd(),document.addEventListener("visibilitychange",this.wcd),this.sdc=!0)}stop(){this.sdc&&(document.removeEventListener("visibilitychange",this.wcd),null!=this.tde&&(clearInterval(this.tde),
this.tde=null),null!=this.h5a&&(cancelAnimationFrame(this.h5a),this.h5a=null),this.zbj(),this.sdc=!1)}get jXc(){return this.sdc}nno(){this.hOc=[];for(let R=0;R<Di.ranges.length;++R)this.hOc.push(0)}}Di.rPm=()=>"visible"===document.visibilityState;Di.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class Zf{create(R){return new Ca.a(R)}}Object(f.a)(Zf,"RandomSamplerFactory",null,[872]);var eb=c(9),Kb=c(1417);class fc{constructor(R,Ba,lb,Vb,zc){R.Hph(()=>{Vb.r6c()});R.Pph((Yc,
Zd)=>{Vb.p6c(Zd.revisionId,Zd.D5a)});R.kBd((Yc,Zd)=>{Vb.Pvm(Zd.Hdj,Zd.D5a,Zd.Vxj)});R.nwk(()=>{Vb.n8f()});Ba.Owk((Yc,Zd)=>{Vb.OHo(Zd.lbj,Zd.ile,Zd.actualValue)});Ba.yvk((Yc,Zd)=>{Vb.NHo(Zd.lbj,Zd.ile,Zd.actualValue)});zc.rFc(()=>{Vb.dcd()});lb.G3((Yc,Zd)=>{6===Zd.type&&Vb.yjc(Zd.LL)})}}Object(f.a)(fc,"EventForwarder",null,[]);class Hc{constructor(R,Ba,lb){this.rak=R;this.NN=lb;this.x0b=Ba}create(R,Ba){return new fc(this.rak,this.x0b,R,Ba,this.NN)}}Object(f.a)(Hc,"EventForwarderFactory",null,[]);var Pc=
c(441);class ec{}ec.qOo="TypingToOutboundReplicationStart";ec.wvn="OutboundReplicationStartToOutboundReplicationEnd";ec.Cej="RtcNotificationToInboundReplicationEnd";ec.TBj="TypingToInboundReplicationEnd";Object(f.a)(ec,"PerfTrackerPhases",null,[]);class Ld{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa=null){this.r4g=!1;this.TKe=5;this.S5g=50;this.uJe=20;this.VHe=this.eJe=this.rAa=null;this.Bsc=this.qsc=0;this.SSe=this.aUe=!1;this.Exd=Array(7);this.Lpc=null;this.CWg=!1;this.Oue=null;this.cja={};this.Qmd=R;
this.qWa=Ba;this.T9j=lb;this.BYg=Vb.create(ec.Cej,zc,Yc,20,!1);this.Iyd=Vb.create(ec.TBj,Zd,$e,20,!0);if(this.Ga=l.AFrameworkApplication.K)this.r4g=this.Ga.$("LogSteppedInboundFrameIsEnabled"),this.uJe=this.Ga.lc("InboundFrameMaxNumberOfLongRunningTasks",20),this.S5g=this.Ga.lc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.TKe=this.Ga.lc("InboundFrameNumberOfLastShortTasks",5);this.atb=pa}get FUk(){null==this.Oue&&(this.Oue=!!this.Ga&&this.Ga.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.Oue}initialize(R){this.rAa=R}X1n(R,Ba,lb=null){this.SCh();va.ULS.shipAssertTag(8229761,324,0<R.length);let Vb=!1;for(const Yc of R){const Zd=Yc.toString();if(Zd in this.cja){var zc=this.cja[Zd];if(!zc.fkc){zc.fij(R,Ba,lb);if(Vb)this.MJi(Yc.toString(),zc,null,null,this.Exd,null);else{const $e=this.Iyl(),pa=this.CJl(this.Lpc);Vb=!0;this.MJi(Yc.toString(),zc,$e,this.VHe,this.Exd,pa)}delete this.cja[Zd]}}else zc=this.Qmd.create(this.BYg,this.Iyd),zc.fij(R,Ba),this.cja[Zd]=zc}this.SSe=!1}yjc(R){va.ULS.shipAssertTag(8257930,
304,R.aDi,"Expected data not sent on the wire");if(R.aDi){if(R.Wde in this.cja){var Ba=this.cja[R.Wde];Ba.iee||(Ba.yjc(R.revisionId,R.yYi,R.kpj,R.D5a),delete this.cja[R.Wde])}else Ba=this.Qmd.create(this.BYg,this.Iyd),Ba.yjc(R.revisionId,R.yYi,R.kpj,R.D5a),this.cja[R.Wde]=Ba;this.SCh()}}Cxm(){this.aUe||(this.eJe=Array(this.uJe),this.VHe=Array(this.TKe),this.Bsc=this.qsc=0,this.Exd=[0,0,0,0,0,0,0,0],this.Lpc=Array(3),this.Lpc[1]=[0,0],this.Lpc[2]=[0,0],this.aUe=!0)}iro(R){return!R.TP&&R.TN===ea.a.gbj&&
(R=Pc.a(this.cja))&&R[0]?!0:!1}Hkn(R){this.aUe=!1;const Ba=Pc.a(this.cja);Ba&&Ba[0]&&(R.TRT>=this.S5g&&this.qsc<this.uJe?this.eJe[this.qsc++]=R:(this.VHe[this.Bsc]=R,this.Bsc=this.Bsc<this.TKe-1?this.Bsc+1:0),this.m5m(R),this.C5m(R))}Gkn(){this.Cxm();this.SSe=!0}m5m(R){this.Exd[R.TP]++}C5m(R){if(R&&R.UI){const Ba=this.Lpc[R.UI];Ba[0]+=1;Ba[1]+=R.TRT}}CJl(R){const Ba={};R&&(R[1]&&(Ba.Typing=R[1]),R[2]&&(Ba.Clicking=R[2]));return Ba}Iyl(){return this.qsc?this.eJe.slice(0,this.qsc-1):null}SCh(){var R=
Pc.a(this.cja);if(R&&(this.CWg||this.a6m(R),R.length>this.T9j))for(const Ba of R){R=this.cja[Ba];const lb=R.createdTime,Vb=this.qWa();6E4<Vb-lb&&(J.b(8438528,304,50,"{0}",{["Not Received"]:R.fkc?"RtcNotification":"ServerRevision",["Duration"]:Vb-lb}),R.fkc||J.b(42075798,304,15,"{0}",{["RevisionId"]:Ba,["Duration"]:Vb-lb}),delete this.cja[Ba])}}a6m(R){if(this.FUk&&this.atb)for(const Ba of R)if(R=this.cja[Ba],R.iee&&!R.fkc&&(R=R.createdTime,2E3<this.qWa()-R)){let lb=null;eb.App.za&&eb.App.za.jb&&eb.App.za.jb.Yc&&
(lb=eb.App.za.jb.Yc.contentReplicator);this.atb.execute(Vb=>{Vb.flush(lb,1)});this.CWg=!0}}MJi(R,Ba,lb,Vb,zc,Yc){this.r4g&&(Ba=Ba.kJl())&&(Ba.RevisionId=R,Ba.LRTWR=lb,Ba.LSTWR=Vb,Ba.TSD=zc,Ba.UIWR=Yc,this.rAa&&this.rAa.track(Ba))}}Object(f.a)(Ld,"InboundMonitor",null,[1760]);class De{constructor(R,Ba,lb,Vb){this.vD=Ba;this.Qmd=lb;this.Pkk=Vb}create(R,Ba,lb,Vb,zc=null){return new Ld(this.Qmd,this.vD,50,this.Pkk,R,Ba,lb,Vb,zc)}}Object(f.a)(De,"InboundMonitorFactory",null,[1738]);var cf=c(373);class nf{}
nf.aoe="UserCount";nf.p6n="RevisionChainLength";Object(f.a)(nf,"PerfTrackerPivotNames",null,[]);class Wb{}Object(f.a)(Wb,"PerfTrackingContext",null,[]);const Ug=R=>5>=R?"5AndFewer":10>=R?"6To10":15>=R?"11To15":20>=R?"15To20":25>=R?"21To25":30>=R?"26To30":"31AndAbove";class gi{}Object(f.a)(gi,"SteppedInboundFrame",null,[]);class rf{constructor(R,Ba,lb,Vb,zc){this.ycb=this.Smd=null;this.wYg=500;this.Rmd=this.dta=this.pvb=this.iXb=this.cfd=-1;this.Aug=null;this.deh=this.Xch=!1;this.Bch=null;this.r9g=
this.hMa=0;this.uZb=R;this.createdTime=Ba();this.dwd=!1;this.gMe=0;this.Uwb=lb;this.W4j=Vb;this.Iyd=zc;l.AFrameworkApplication.K&&(this.wYg=l.AFrameworkApplication.K.lc("InboundFrameSamplingMinimalTotalTimeMs",500))}get iee(){return this.Xch}get fkc(){return this.deh}get Idj(){return this.Bch}get D5a(){return this.hMa}get vvn(){return this.r9g}get LDb(){return this.Uwb()}yjc(R,Ba,lb,Vb){this.iee||(this.dwd=lb,this.gMe=Ba,this.cfd=Y.a.lV(oa.a.We(),2),this.Aug=(new Date).toISOString(),this.ycb=R,this.r9g=
Vb,this.Xch=!0,this.fkc?this.BVh():(this.Wtj(),xa.a.instance.qz(R.toString()+"Start"),cf.a.instance.p3d(2)))}fij(R,Ba,lb=null){this.fkc||(this.hMa=Ba,this.deh=!0,this.Bch=R,this.Rmd=Y.a.lV(oa.a.We(),2),this.iee&&(xa.a.instance.qz(this.ycb.toString()+"End"),lb&&(this.iXb=lb.e3n,this.pvb=lb.O6a,this.dta=lb.Y1n),cf.a.instance.jFd(),this.BVh()))}kJl(){if(!(0<this.cfd&&0<this.iXb&&0<this.pvb&&0<this.dta&&0<this.Rmd))return null;const R=new gi;R.TT=Y.a.lV(this.Rmd-this.cfd,2);if(R.TT<this.wYg)return null;
R.ST=this.Aug;R.UC=this.LDb;R.RS=Y.a.lV(this.iXb-this.cfd,2);R.SR=Y.a.lV(this.pvb-this.iXb,2);R.RRS=Y.a.lV(this.dta-this.pvb,2);R.RP=Y.a.lV(this.Rmd-this.dta,2);R.ResponseLanded=Y.a.lV(this.pvb,2);0<R.RS?(xa.a.instance.GY("RTCToRequestSent",this.ycb.toString()+"Start","RequestInvoked"+this.iXb),xa.a.instance.GY("RequestSentToResponseReceived","RequestInvoked"+this.iXb,"RequestCompleted"+this.pvb),xa.a.instance.GY("ResponseReceivedToReplicationStart","RequestCompleted"+this.pvb,"ReplicationStart"+
this.dta)):xa.a.instance.GY("RTCToReplicationStart",this.ycb.toString()+"Start","ReplicationStart"+this.dta);xa.a.instance.GY("Replication","ReplicationStart"+this.dta,this.ycb.toString()+"End");return R}Wtj(){this.Smd=this.uZb.create();this.Smd.start(ec.Cej,ec.TBj)}BVh(){this.Smd||this.Wtj();const R=this.Smd.end(this.dwd,this.ubl());this.W4j.rde(R);this.Iyd.rde(R+this.gMe)}ubl(){const R={};R[nf.aoe]=Ug(this.LDb);var Ba=this.Idj.length;R[nf.p6n]=9>=Ba?Ba.toString():"10AndAbove";return Object.assign(new Wb,
{P:R,FC:this.D5a,CFC:this.vvn+this.D5a,ID:this.ycb.toString(),CD:this.gMe,UC:this.LDb,RCL:this.Idj.length})}}Object(f.a)(rf,"InboundOperation",null,[1759]);class Uk{constructor(R,Ba,lb){this.VKa=R;this.qWa=Ba;this.Uwb=lb}create(R,Ba){return new rf(this.VKa,this.qWa,this.Uwb,R,Ba)}}Object(f.a)(Uk,"InboundOperationFactory",null,[1737]);class ee{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa){this.ewd=!0;this.r$g=this.Osd=null;this.pN=Ma=>{this.fj.pN(6,Ma)};this.fMe=R;this.f0j=Ba;this.kdk=lb;this.fj=Vb;this.LVe=
zc.create("TypingToOutboundReplicationStart",Yc,Zd,20,!1);this.jPe=zc.create("OutboundReplicationStartToOutboundReplicationEnd",$e,pa,20,!1)}get d_f(){return this.Osd}get J9d(){return this.r$g}dcd(){!this.d_f&&this.ewd&&(this.ewd=this.f0j())&&(this.Osd=this.fMe.create(this.pN,this.kdk(),this.LVe,this.jPe),this.d_f.dcd())}r6c(){this.ewd=!0;this.r$g=this.d_f;this.J9d&&(this.Osd=null,this.J9d.r6c())}n8f(){this.Osd=null}p6c(R,Ba){this.J9d&&this.J9d.p6c(R,Ba)}}Object(f.a)(ee,"OutboundMonitor",null,[]);
class Rk{constructor(R,Ba){this.fMe=R;this.fck=Ba}create(R,Ba,lb,Vb,zc,Yc,Zd){return new ee(this.fMe,R,Ba,lb,this.fck,Vb,zc,Yc,Zd)}}Object(f.a)(Rk,"OutboundMonitorFactory",null,[]);var wh=c(60);class yg{constructor(R){this.Mcb=R}get QMn(){return this.Mcb}nb(R){return!!this.Mcb&&R in this.Mcb}get aDi(){return this.nb(yg.iLd)&&this.nb(yg.VOb)&&this.nb(yg.cfg)}get revisionId(){if(this.nb(yg.VOb))return wh.a.Ff(this.Mcb[yg.VOb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get Wde(){if(this.nb(yg.VOb))return this.Mcb[yg.VOb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get yYi(){if(this.nb(yg.iLd))return Number.parseInvariant(this.Mcb[yg.iLd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get kpj(){if(this.nb(yg.VOb))return Boolean.parse(this.Mcb[yg.cfg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get D5a(){if(this.nb(yg.VSf))return Number.parseInvariant(this.Mcb[yg.VSf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static J9k(R){return new yg(R)}static O9k(R,Ba,lb,Vb){const zc={};zc[yg.iLd]=R.toString();zc[yg.VOb]=Ba.toString();zc[yg.cfg]=lb.toString();zc[yg.VSf]=Vb.toString();return new yg(zc)}}yg.VOb="RevisionID";yg.iLd="Duration";yg.cfg="ShouldSample";yg.VSf="NumSequentialFailures";Object(f.a)(yg,"ReplicationNotificationMessage",null,[1756]);class So{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.ps=this.fi=0;this.ixb=this.XDc=
null;this.Tre=[];this.tah=null;this.ekd={};this.hMa=0;this.uZb=R;this.Mgk=Ba;this.qWa=lb;this.Uwb=Vb;this.$eh=zc;this.ycb=null;this.ekd.TypingStartStage=null;this.ekd.ReplicationStartStage="TypingStartStage";this.ekd.ReplicationEndStage="ReplicationStartStage";this.Bjh=1<this.LDb;this.LVe=Yc;this.jPe=Zd}get LDb(){return this.Uwb()}dcd(){this.w6e("TypingStartStage")&&(this.c5f("TypingStartStage"),va.ULS.shipAssertTag(8257931,324,!this.ixb&&!this.ps,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.fi=this.qWa(),this.XDc=this.uZb.create(),this.Mtj(this.XDc,ec.qOo))}r6c(){if(this.w6e("ReplicationStartStage")){this.c5f("ReplicationStartStage");va.ULS.shipAssertTag(8257932,324,!!this.XDc,"TypingStart not called");if(this.XDc){const R=this.xVh(this.XDc,this.ycb);this.LVe.rde(R)}this.ixb=this.uZb.create();this.Mtj(this.ixb,ec.wvn)}}p6c(R,Ba){this.w6e("ReplicationEndStage")&&(this.c5f("ReplicationEndStage"),this.ps=this.qWa(),this.hMa=Ba,va.ULS.shipAssertTag(8257933,324,!!this.ixb,"ReplicationStart not called"),
this.ixb&&(va.ULS.shipAssertTag(8193425,324,!!this.ixb,"ReplicationStart not called"),Ba=this.xVh(this.ixb,R),this.jPe.rde(Ba)),va.ULS.shipAssertTag(8257934,324,!!this.fi,"StartTime not set. No message sent to other editors."),this.fi&&(R=yg.O9k(this.ps-this.fi,R,this.$eh,this.hMa),this.Mgk(R.QMn)))}w6e(R){if(this.ekd[R]===this.tah)return!0;va.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.Jok()});return!1}Jok(){const R=new Sys.StringBuilder;R.append("Actual Phase:");for(let Ba=
0;Ba<this.Tre.length;Ba++)R.append(" "+this.Tre[Ba]);return R.toString()}c5f(R){this.Tre.push(R);this.tah=R}Mtj(R,Ba){this.Bjh&&R.start(Ba)}xVh(R,Ba){if(!this.Bjh)return-1;const lb={};lb[nf.aoe]=Ug(this.LDb);Ba=Object.assign(new Wb,{P:lb,FC:this.hMa,CFC:0,ID:Ba?Ba.toString():"",CD:0,UC:this.LDb,RCL:0});return R.end(this.$eh,Ba)}}Object(f.a)(So,"OutboundOperation",null,[1758]);class Sm{constructor(R,Ba,lb){this.uZb=R;this.qWa=Ba;this.Uwb=lb}create(R,Ba,lb,Vb){return new So(this.uZb,R,this.qWa,this.Uwb,
Ba,lb,Vb)}}Object(f.a)(Sm,"OutboundOperationFactory",null,[1736]);class Aa{constructor(R,Ba){this.pOg=this._name=this.r3=null;this.he=R;this.rAa=Ba}start(R,Ba=null){this.r3=this.he.Vf("UserAction",R);this._name=R;this.pOg=Ba}end(R,Ba){let lb=-1;R&&(lb=this.r3.li,Ba.D=lb,Ba.CN=this.pOg,Ba.CD+=lb,this.rAa.track(Ba,this._name));return lb}}Object(f.a)(Aa,"PerfTracker",null,[1757]);class Ab{constructor(R,Ba){this.he=R;this.rAa=Ba}create(){return new Aa(this.he,this.rAa)}}Object(f.a)(Ab,"PerfTrackerFactory",
null,[1735]);class nc{constructor(R,Ba,lb){this.Tzc=null;this.eck=R;this.AYg=Ba;this.Rah=lb}init(R,Ba,lb,Vb,zc,Yc,Zd){Ba=this.Rah.create(Ba/100);lb=this.Rah.create(lb/100);this.Tzc=this.eck.create(Object(a.a)(Ba,Ba.jQb,"shouldBeInSample"),Object(a.a)(lb,lb.jQb,"shouldBeInSample"),R,Vb,zc,Yc,Zd)}dcd(){this.Tzc.dcd()}r6c(){this.Tzc.r6c()}n8f(){this.Tzc.n8f()}p6c(R,Ba){this.Tzc.p6c(R,Ba)}Pvm(R,Ba,lb=null){this.AYg.X1n(R,Ba,lb)}yjc(R){R=yg.J9k(R);this.AYg.yjc(R);xa.a.instance.qz(R.revisionId+"Start")}OHo(R,
Ba,lb){J.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.fId(R,Ba,lb))}NHo(R,Ba,lb){J.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.fId(R,Ba,lb))}fId(R,Ba,lb){const Vb={};Vb.PhaseName=R;Vb.ThresholdValue=Ba;Vb.ActualValue=lb;return Vb}}Object(f.a)(nc,"ReplicationTelemetryManager",null,[]);var Kc=c(951);class hd extends Kc.a{constructor(R,Ba){super(R,Ba);this.Xj=this.cxd=0}Lya(R){this.cxd+=R;this.Xj++}getValue(){return this.Xj?this.cxd/
this.Xj:0}tTa(){this.Xj=this.cxd=0}}Object(f.a)(hd,"AverageMetric",Kc.a,[]);class Rd extends Kc.a{constructor(R,Ba){super(R,Ba);this.l7=0}Lya(R){R>this.l7&&(this.l7=R)}getValue(){return this.l7}tTa(){this.l7=0}}Object(f.a)(Rd,"MaxMetric",Kc.a,[]);var kc=c(1890);class ff extends Kc.a{constructor(R,Ba,lb=100){super(R,Ba);this.lqd=this.UYb=this.i0b=0;this.Sud=lb;this.$Pe=new kc.a(this.Sud)}Lya(R){if(this.UYb===this.Sud){const Ba=this.$Pe.dequeue();this.i0b-=Ba;this.UYb--}this.$Pe.enqueue(R);this.i0b+=
R;this.UYb++;R=this.i0b/this.UYb;R>this.lqd&&this.UYb===this.Sud&&(this.lqd=R)}getValue(){return this.lqd}tTa(){this.lqd=0;this.$Pe=new kc.a(this.Sud);this.UYb=this.i0b=0}}Object(f.a)(ff,"MaxRollingAverageMetric",Kc.a,[]);class bd extends Kc.a{constructor(R,Ba){super(R,Ba);this.Xj=0}Lya(){this.Xj++}getValue(){return this.Xj}tTa(){this.Xj=0}}Object(f.a)(bd,"CounterMetric",Kc.a,[]);class Sf{constructor(R,Ba){this.l1b=Ba;this.lte=new hd(R+"-AverageValue","Milliseconds");this.sJe=new Rd(R+"-MaxValue",
"Milliseconds");this.zJe=new ff(R+"-MaxRollingAverageValue","Milliseconds");this.xwe=new bd(R+"-NumberOfEvents","Count");this.Ata=new ib.a(R+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.lU("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.lU("CoAuthLatencySlowThresholdPercentile",95),this.l1b);this.mNe=new ib.a(R+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.lU("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.lU("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.l1b)}m1(R){this.lte.Lya(R);this.sJe.Lya(R);this.zJe.Lya(R);this.xwe.Lya(R);this.Ata.Lya(R);this.mNe.Lya(R)}Xbe(){this.lte.XSa();this.sJe.XSa();this.zJe.XSa();this.xwe.XSa();this.Ata.XSa();this.mNe.XSa();this.lte.tTa();this.sJe.tTa();this.zJe.tTa();this.xwe.tTa();this.Ata.tTa();this.mNe.tTa()}}Object(f.a)(Sf,"ReplicationLatencyMetrics",null,[]);class Te{constructor(){this.iIe=new Jb.a}M6i(R,Ba,lb){if(!(0>Ba)){if(!({value:Vb}=this.iIe.Fc(R,Vb)).returnValue){var Vb=new Sf(R,lb);this.iIe.Z(R,
Vb)}Vb.m1(Ba)}}Xbe(){for(const R of this.iIe.values)R.Xbe()}}Object(f.a)(Te,"ReplicationTelemetryMetricsManager",null,[1687]);class bi{M6i(){}Xbe(){}}Object(f.a)(bi,"ReplicationTelemetryMetricsManagerStub",null,[1687]);class Si{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.uZa=this.syd=0;this.s$j=R;this.pNe=lb;this.Ihh=Vb;this.aLg=zc;this.x0b=Ba;this.t$j=Yc;this.l1b=Zd}rde(R){this.s$j.M6i(this.pNe,R,this.l1b);R>this.Ihh&&this.x0b.vHo(this.pNe,this.Ihh,R);this.syd+=R;this.uZa++;this.syd/this.uZa>this.aLg&&
this.uZa>this.t$j&&this.x0b.wHk(this.pNe,this.aLg,this.syd/this.uZa)}}Object(f.a)(Si,"TimeSpanVerifier",null,[1716]);class li{constructor(R,Ba){this.rfk=R;this.x0b=Ba}create(R,Ba,lb,Vb,zc){return new Si(this.rfk,this.x0b,R,Ba,lb,Vb,zc)}}Object(f.a)(li,"TimeSpanVerifierFactory",null,[1686]);class yi extends Sys.EventArgs{constructor(R,Ba,lb){super();this.lbj=R;this.ile=Ba;this.actualValue=lb}}Object(f.a)(yi,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class lm{constructor(){this.sa=new N.a}vHo(R,
Ba,lb){this.sa.raiseEvent("TSVTE",new yi(R,Ba,lb))}wHk(R,Ba,lb){this.sa.raiseEvent("TSVATE",new yi(R,Ba,lb))}Owk(R){this.sa.addHandler("TSVTE",R)}yvk(R){this.sa.addHandler("TSVATE",R)}}Object(f.a)(lm,"TimeSpanVerifierNotifier",null,[1685]);class bh{constructor(){this.W=this.Ga=null}get name(){return"Box4.ReplicationTelemetry"}wc(R){this.Ga=R.resolve("Common.IAppSettingsManager");this.W=R;if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){R.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new Ab(eb.App.za.Iq,
Oa.a.hF(20,1,new Ra.a))).ha();R.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new lm).ha();this.Ga.$("Box4ReplicationTelemetryMetricsIsEnabled")?R.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Te).ha():R.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new bi).ha();R.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new li(R.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),R.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();
R.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new Sm(R.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),bh.I7h)).ha();R.ia("ReplicationTelemetry.OutboundMonitorFactory",()=>new Rk(R.resolve("ReplicationTelemetry.OutboundOperationFactory"),R.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();R.ia("ReplicationTelemetry.InboundOperationFactory",()=>new Uk(R.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),bh.I7h)).ha();var Ba=
new De(R.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),R.resolve("ReplicationTelemetry.InboundOperationFactory"),R.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),lb=this.Ga.$("ComponentStateLoggingPackageIsEnabled")?this.W.Ta("Common.IComponentStateLogManager"):null;R.ia("ReplicationTelemetry.IInboundMonitor",()=>Ba.create(this.Ga.lc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ga.lc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Ga.lc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ga.lc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),lb)).ha();R.ia("Common.IRandomSamplerFactory",()=>new Zf).ha();R.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new nc(R.resolve("ReplicationTelemetry.OutboundMonitorFactory"),R.resolve("ReplicationTelemetry.IInboundMonitor"),R.resolve("Common.IRandomSamplerFactory"))).ha();R.ia("ReplicationTelemetry.EventForwarderFactory",()=>new Hc(Kb.a.instance,
R.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),R.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){var R=this.Ga.lc("Box4ReplicationTelemetrySamplePercent",0),Ba=this.Ga.lc("Box4ReplicationTelemetryPhaseSamplePercent",0),lb=this.Ga.lc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Vb=this.Ga.lc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),zc=this.Ga.lc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),Yc=this.Ga.lc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Zd=this;this.W.Ta("Box4.Presence.IRtcProxyProvider").execute(pa=>{pa.XD().continueWith(()=>{const Ma=pa.XD().result,ya=Zd.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");ya.init(Ma,R,Ba,lb,Vb,zc,Yc);Zd.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Ma,ya);if(Zd.Ga.$("LogSteppedInboundFrameIsEnabled")){const wa=Rl.a.Bp(Zd.W.Ta("Common.ICpuMeterProvider"));wa.continueWith(()=>
{const Ta=Zd.W.resolve("ReplicationTelemetry.IInboundMonitor");var Bb=new za.a(()=>!0);Bb=Oa.a.hF(19,1,Bb);Ta.initialize(Bb);const Qb=wa.result.fq.task;Qb.continueWith(()=>{Qb.result.AAd(0,()=>Ta.SSe,jc=>{Ta.Hkn(jc)});Qb.result.AAd(1,jc=>Ta.iro(jc),()=>{Ta.Gkn()})})})}va.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var $e=this;l.AFrameworkApplication.lI(()=>{$e.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Xbe()})}}dispose(){}static I7h(){const R=eb.App.xd;
return R?R.nUh:0}}Object(f.a)(bh,"ReplicationTelemetryPackage",null,[1,2]);var ol=c(953),zi=c(12),fk=c(128),eh=c(3),Ck=c(81),vd=c(61),Dd=c(213),Ge=c(17),me=c(23),Kj=c(8),Sl=c(2058);class xf{static get Yg(){return k.a.Bz(xf.Sm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}xf.Sm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(xf,"InsertSymbolsDialogHtml",null,[]);class Fl extends Sl.a{constructor(R,Ba,lb){super();this.fYb=this.cNa=this.Ddb=null;this.dEe=0;this.yCm=Vb=>{1===Vb?(this.HVf("symbol_d_"+Fl.Ixc),this.Vb.zL(this.dL,!0),this.Vb.Ys().ak.Zy(this.gH),this.gH.focus()):this.hide()};this.Mvj=Vb=>{if(Vb.target!==this.fYb){const zc=this.Vb.Ys();zc&&zc.ak&&(zc.ak.Zy(Vb.target),this.fYb=Vb.target)}this.zrn(Vb.target.id)};this.MDo=Vb=>{const zc=Vb.uf;if("a"!==zc.tagName.toLowerCase())return!1;Vb.eventName===W.a.uB&&
this.HVf(zc.id);this.Vb.zL(this.dL,!0);this.Vb.Ys().ak.Zy(zc);zc.focus();return!0};this.ODo=Vb=>{var zc=Vb.uf;if("a"!==zc.tagName.toLowerCase())return!1;const Yc=parseInt(zc.id.substr(zc.id.lastIndexOf("_")+1));if(Vb.Hb.ctrlKey||Vb.Hb.altKey||Vb.Hb.keyCode>=ce.a.zTb&&Vb.Hb.keyCode<=ce.a.ATb)return!1;if(Vb.eventName===W.a.$h){Vb=Vb.Hb.keyCode;let Zd=-1;Vb===Sys.UI.Key.enter?(this.HVf(zc.id),this.Vb.zL(this.dL,!0),this.Vb.Ys().ak.Zy(zc),zc.focus()):Vb===Sys.UI.Key.up?Zd=Yc-15:Vb===Sys.UI.Key.down?Zd=
Yc+15:Vb===Sys.UI.Key.left?Zd=l.AFrameworkApplication.isRtl?Yc+1:Yc-1:Vb===Sys.UI.Key.right&&(Zd=l.AFrameworkApplication.isRtl?Yc-1:Yc+1);0<=Zd&&(zc=this.Ntf("symbol_d_"+Zd))&&zc.focus()}return!0};this.ga=R;this.Vb=Ba;this.Edb=lb;this.xe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.xe(0,CommonUIStrings.l_DialogClose);this.taa=!1;this.Yg=xf.Yg;this.ug="InsertSymbolsDialog"}dispose(){0<Fl.iVe&&va.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.dEe,Fl.iVe);Fl.KQg++;va.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Fl.KQg);this.ga=this.Edb=null;super.dispose()}fUa(){this.Qh(Box4Intl.Box4Strings.L_SymbolSingle,this.yCm,null);this.dEe=0;Fl.QQg++;va.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Fl.QQg);const R=this.Ntf("symbol_d_"+Fl.Ixc);R&&R.focus()}hide(){var R=document.getElementById("symbolsContainer");if(R&&(R=R.getElementsByTagName("a")))for(let Ba=0;Ba<R.length;Ba++)T.a.removeHandler(R[Ba],
W.a.focus,this.Mvj);super.hide()}get Glb(){return Fl.Oxc}set Glb(R){Fl.Oxc=R}get Clb(){return Fl.Bxc}set Clb(R){Fl.Bxc=R}L9(){super.L9();var R=document.getElementById("symbolsContainer");if(R&&(R.innerHTML=this.Edb.XLk(),R=R.getElementsByTagName("a")))for(let Ba=0;Ba<R.length;Ba++)T.a.addHandler(R[Ba],W.a.focus,this.Mvj)}Pma(){const R=document.getElementById("symbolsContainer");R&&(this.Ddb||(this.Ddb=this.MDo,this.Nq.ob(W.a.click,R,this.Ddb),this.Nq.ob(W.a.uB,R,this.Ddb)),this.cNa||(this.cNa=this.ODo,
this.ee.ob(W.a.$h,R,this.cNa),this.ee.ob(W.a.qu,R,this.cNa),this.ee.ob(W.a.sh,R,this.cNa)));super.Pma()}Dgb(){const R=document.getElementById("symbolsContainer");R&&(this.Ddb&&(this.Nq.sc(W.a.click,R,this.Ddb),this.Nq.sc(W.a.uB,R,this.Ddb),this.Ddb=null),this.cNa&&(this.ee.sc(W.a.$h,R,this.cNa),this.ee.sc(W.a.qu,R,this.cNa),this.ee.sc(W.a.sh,R,this.cNa),this.cNa=null));super.Dgb()}get Mxf(){return!0}zrn(R){this.Ulj("symbol_d_"+Fl.Ixc,!1);Fl.Ixc=parseInt(R.substr(R.lastIndexOf("_")+1));this.Ulj(R,
!0);if(R=document.getElementById("SymbolNameValueLabel")){const Ba=this.GTd(Fl.Ixc);R.innerText=Ba.altText}}GTd(R){const Ba=this.Edb.kke.fjg.value,lb=Pc.a(Ba);return Ba[lb[R]]}HVf(R){this.dEe++;Fl.iVe++;R=parseInt(R.substr(R.lastIndexOf("_")+1));const Ba=this.GTd(R),lb={};lb.SourceControlId="symbol_"+R+"_"+Ba.ike;this.ga.Rb(eh.a.dkb,2,lb);va.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",R)}Ntf(R){const Ba=document.getElementById("symbolsContainer");return Ba?Ba.querySelector("#"+
R):null}Ulj(R,Ba){if(R=this.Ntf(R))Ba?(R.setAttribute("selected","true"),R.setAttribute("aria-selected","true"),R.tabIndex=0):(R.removeAttribute("selected"),R.setAttribute("aria-selected","false"),R.tabIndex=-1)}}Fl.Ixc=0;Fl.Oxc=null;Fl.Bxc=null;Fl.QQg=0;Fl.KQg=0;Fl.iVe=0;Object(f.a)(Fl,"InsertSymbolsDialog",Sl.a,[]);class Wh{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.Udm=()=>this.Edb.OMk();this.m4i=($e,pa,Ma,ya,wa)=>{if(1===Ma)return 32;$e=this.Edb.g_i(wa);$e=String.format(this.Edb.NDo,$e.character);
wa[ol.a.InnerHTML]=$e;wa[ol.a.On]=!1;return 32};this.xQa=($e,pa,Ma,ya,wa)=>{if(({ie:$e,selected:Ma,xQa:Qb}=this.CKc(pa,Ma)).returnValue)return Qb;var Ta=Ge.SelectionEditor.ef(Ma);let Bb=!0;Ma=8;var Qb=this.Kc.Pc(15);Qb.Db($e.ed);Ta||(Ma=this.ga.Kf(pa,eh.a.Cna,2,!0,ya,null),pa=32===Ma,va.ULS.shipAssertTag(6407387,348,pa,"DeleteForReplace did not succeed. Response is {0}",Ma),Bb=pa);Bb&&(pa=$e.mb.ng,Ta=Ge.SelectionEditor.ef(pa),va.ULS.shipAssertTag(6407388,348,Ta,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
pa.contextId),Ma=8,Ta&&(Ma=this.ga.Kf(pa,eh.a.dkb,2,!1,ya,wa),va.ULS.shipAssertTag(6407389,348,32===Ma,"Insertion at IP context did not succeed. Response is {0}",Ma),32===Ma&&Jg.FocusManager.instance().kg($e.pJ)));Qb.dispose();return Ma};this.xCm=($e,pa,Ma,ya,wa)=>{if(1===Ma)return 32;if(Ge.SelectionEditor.E3a(pa))return 2;$e=this.Edb.g_i(wa);ya.As=$e.index;ya=this.Zc.Tf(pa.node);Ma=ya.zb(11);va.ULS.shipAssertTag(6379466,324,Ma,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
fk.a[pa.node.type]);Ma=this.Kc.Pc(15);Ma.Qt(ya);Wh.ig.Ge(pa,$e.character,!0,!1);pa=me.SelectionFactory.ne(ya.currentNode,pa.cpBegin+1);this.ib.Bc(pa);Ma.dispose();return 32};this.iNb=($e,pa,Ma,ya,wa)=>{if(1===Ma)return 32;wa.MenuItems=this.Ajk.value;return 32};this.Nvj=($e,pa,Ma)=>{({xQa:$e}=this.CKc(pa,Ma));return $e};this.Fqj=($e,pa,Ma)=>{2===Ma&&(new Fl(this.ga,Jg.FocusManager.instance(),ta.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).fUa();return 32};this.k3f=()=>32;this.ga=R;this.Zc=
Ba;this.Ajk=new Mb.a(this.Udm);this.Kc=lb;this.Edb=Vb;this.Ik=zc;this.ib=Yc;this.Zm=Zd}Tb(){this.ga.fb(eh.a.k3f,zi.a.application,this.k3f,96);this.ga.ra(eh.a.iNb,zi.a.view,this.iNb);this.ga.ra(eh.a.jke,zi.a.view,this.Nvj);this.ga.ra(eh.a.ebe,zi.a.view,this.m4i);this.ga.ra(eh.a.dkb,zi.a.view,this.xQa);this.ga.ra(eh.a.iNb,zi.a.Tc,this.iNb);this.ga.ra(eh.a.jke,zi.a.Tc,this.Nvj);this.ga.ra(eh.a.ebe,zi.a.Tc,this.m4i);this.ga.ra(eh.a.dkb,zi.a.Tc,this.xCm);this.ga.Xc(eh.a.iNb,1124);this.ga.Xc(eh.a.jke,1036);
this.ga.Xc(eh.a.ebe,1124);this.ga.Xc(eh.a.dkb,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.ra(eh.a.qUc,zi.a.view,this.Fqj),this.ga.ra(eh.a.qUc,zi.a.Tc,this.Fqj),this.ga.Xc(eh.a.qUc,1124))}CKc(R,Ba){let lb,Vb=null;R.view.qe&&(Vb=R.view);lb=null;if(!Vb||!Vb.mb)return J.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",R.toString()),{returnValue:!0,ie:Vb,selected:lb,
xQa:8};lb=Vb.mb.ng;if(!lb)return{returnValue:!0,ie:Vb,selected:lb,xQa:2};if(this.Ik.R_(lb)||this.Ik.hia(lb))return{returnValue:!0,ie:Vb,selected:lb,xQa:8};if(Vb.mb.hb.HJ||this.Zm&&this.Zm.instance&&this.Zm.instance.EU(lb)||Ge.SelectionEditor.E3a(R.ek))return{returnValue:!0,ie:Vb,selected:lb,xQa:2};if(Wh.Xg.hAa(Kj.ParagraphReader.AU,lb))return R=8,Wh.Hc.Yb(Ck.a.Ye,{["Reason"]:vd.a.yO}),{returnValue:!0,ie:Vb,selected:lb,xQa:R};R=32;return 1===Ba?{returnValue:!0,ie:Vb,selected:lb,xQa:R}:{returnValue:!1,
ie:Vb,selected:lb,xQa:R}}static get ig(){return Wh.Ld||(Wh.Ld=ta.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set ig(R){Wh.Ld=R}static get Xg(){return Dd.ContextSetEditor.instance}static get Hc(){return Hg.a.instance}}Wh.Ld=null;Object(f.a)(Wh,"SymbolsActor",null,[1657]);class we{constructor(R,Ba){this.ike=R;this.altText=Ba}}Object(f.a)(we,"Symbol",null,[]);class bo{constructor(){this.JTe=null;this.Ugh=new Mb.a(bo.Yaf)}get fjg(){return this.Ugh}Q$h(R){this.JTe||(this.JTe=Pc.a(this.Ugh.value));
return Array.indexOf(this.JTe,R)}static Yaf(){const R={};R["\u2022"]=new we("\u2022",Box4Intl.Box4Strings.L_Bullet);R["\u20ac"]=new we("\u20ac",Box4Intl.Box4Strings.L_EuroSign);R["\u00a3"]=new we("\u00a3",Box4Intl.Box4Strings.L_PoundSign);R["\u00a5"]=new we("\u00a5",Box4Intl.Box4Strings.L_YenSign);R["\u00a9"]=new we("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);R["\u00ae"]=new we("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);R["\u2122"]=new we("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);R["\u00b1"]=
new we("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);R["\u2260"]=new we("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);R["\u2264"]=new we("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);R["\u2265"]=new we("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);R["\u00f7"]=new we("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);R["\u00d7"]=new we("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);R["\u221e"]=new we("\u221e",Box4Intl.Box4Strings.L_Infinity);R["\u00b5"]=new we("\u00b5",Box4Intl.Box4Strings.L_MicroSign);
R["\u03b1"]=new we("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);R["\u03b2"]=new we("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);R["\u03c0"]=new we("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);R["\u03a9"]=new we("\u03a9",Box4Intl.Box4Strings.L_OhmSign);R["\u03a3"]=new we("\u03a3",Box4Intl.Box4Strings.L_NArySummation);R["\u00b0"]=new we("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);R["\u0394"]=new we("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);R["\u263a"]=new we("\u263a",
Box4Intl.Box4Strings.L_WhiteSmilingFace);R["\u2665"]=new we("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);R["\u20b9"]=new we("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);R["\u00bf"]=new we("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);R["\u00a1"]=new we("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);R["\u2014"]=new we("\u2014",Box4Intl.Box4Strings.L_EmDash);R["\u2026"]=new we("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);R["\u00c0"]=new we("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
R["\u00c1"]=new we("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);R["\u00c2"]=new we("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);R["\u00c3"]=new we("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);R["\u00c4"]=new we("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);R["\u00c5"]=new we("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);R["\u00c6"]=new we("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);R["\u00c7"]=
new we("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);R["\u00c8"]=new we("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);R["\u00c9"]=new we("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);R["\u00ca"]=new we("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);R["\u00cb"]=new we("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);R["\u00cc"]=new we("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);R["\u00cd"]=new we("\u00cd",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);R["\u00ce"]=new we("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);R["\u00cf"]=new we("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);R["\u00d1"]=new we("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);R["\u00d2"]=new we("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);R["\u00d3"]=new we("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);R["\u00d4"]=new we("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);
R["\u00d5"]=new we("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);R["\u00d6"]=new we("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);R["\u00d9"]=new we("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);R["\u00da"]=new we("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);R["\u00db"]=new we("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);R["\u00dc"]=new we("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);R["\u00df"]=
new we("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);R["\u00e0"]=new we("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);R["\u00e1"]=new we("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);R["\u00e2"]=new we("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);R["\u00e3"]=new we("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);R["\u00e4"]=new we("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);R["\u00e5"]=new we("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);
R["\u00e6"]=new we("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);R["\u00e7"]=new we("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);R["\u00e8"]=new we("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);R["\u00e9"]=new we("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);R["\u00ea"]=new we("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);R["\u00eb"]=new we("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);R["\u00ec"]=new we("\u00ec",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);R["\u00ed"]=new we("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);R["\u00ee"]=new we("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);R["\u00ef"]=new we("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);R["\u00f1"]=new we("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);R["\u00f2"]=new we("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);R["\u00f3"]=new we("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);
R["\u00f4"]=new we("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);R["\u00f5"]=new we("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);R["\u00f6"]=new we("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);R["\u00f9"]=new we("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);R["\u00fa"]=new we("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);R["\u00fb"]=new we("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);R["\u00fc"]=new we("\u00fc",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);R["\u00ff"]=new we("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);R["\u011e"]=new we("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);R["\u011f"]=new we("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);R["\u0130"]=new we("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);R["\u0131"]=new we("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);R["\u0152"]=new we("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);
R["\u0153"]=new we("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);R["\u015e"]=new we("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);R["\u015f"]=new we("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);R["\u0178"]=new we("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return R}}Object(f.a)(bo,"SymbolsLoader",null,[1656]);var tf=c(399),Gj=c(336),th=c(207),Qg=c(648),Cg=c(1480),ok=c(162),Je=c(90);class Ob{constructor(R){this.kke=R}get NDo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}g_i(R){R=
R.SourceControlId.split("_");const Ba={};2===R.length?(Ba.character=R[1],Ba.index=this.kke.Q$h(Ba.character)):(Ba.character=R[2],Ba.index=parseInt(R[1]));return Ba}OMk(){return this.Hgi()}build(){return this.Vdm()}XLk(){const R=new Sys.StringBuilder;R.append('<table class="moreSymbolsTable">');const Ba=this.kke.fjg.value,lb=Pc.a(Ba);let Vb=0;for(;Vb<lb.length;){Vb%15||R.append('<tr role="presentation">');const zc=Ba[lb[Vb]];R.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Vb,Xa.a.jY(zc.ike),Xa.a.jY(zc.altText)));Vb++;Vb%15&&Vb!==lb.length||R.append("</tr>")}R.append("</table>");return R.toString()}Vdm(){const R=this.Hgi();return ok.o(R)}Hgi(){const R=Object.assign(new tf.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});R.MenuSectionList.push(this.Btk());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&R.MenuSectionList.push(this.Irk());return R}Irk(){const R=Object.assign(new Gj.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),Ba=Object.assign(new th.a,{Id:"btnMoreSymbols",Command:eh.a.qUc.toString(),LabelText:Xa.a.vf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Xa.a.vf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.$s,Image16by16Class:Je.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});R.ControlList.push(Ba);return R}Btk(){const R=Object.assign(new Gj.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
Ba=Object.assign(new Qg.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),lb=this.kke.fjg.value,Vb=Pc.a(lb),zc=Math.min(25,Vb.length);for(let Zd=0;Zd<zc;Zd++){var Yc=lb[Vb[Zd]];Yc=Object.assign(new Cg.a,{Id:String.format("{0}{1}_{2}","symbol_",Zd,Yc.ike),Character:Yc.ike,Command:eh.a.dkb.toString(),QueryCommand:eh.a.ebe.toString(),Alt:Xa.a.vf(Yc.altText)});Ba.GalleryItems.push(Yc)}R.ControlList.push(Ba);
return R}}Object(f.a)(Ob,"SymbolsUiBuilder",null,[1655]);var Ah=c(48),Mq=c(236),ti=c(546),Wj=c(370);class Hj{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Tb()}dispose(){}wc(R){this.W=R;this.W.register(bo,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.W.ia("Box4.Symbols.SymbolsUiBuilder",()=>new Ob(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();
this.W.ia("Box4.Symbols.SymbolsActor",()=>new Wh(l.AFrameworkApplication.va,new ti.a,new Wj.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Mq.a.instance,Ah.a.instance,this.W.Ta("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){L.a.instance.Gc(new Hj)}}Object(f.a)(Hj,"Box4SymbolsPackage",null,[1,2]);var dp=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Gp=c(1640),To=c(1593),Vk=c(1575),hq=c(1970),fm=c(231),Cq=c(400);class wm{constructor(){this.NJa=null}wc(R){this.container=R}init(){this.NJa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.NJa&&this.NJa.dispose()}}Object(f.a)(wm,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class Xk{get d4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get e4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get f4k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get svn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get ahc(){return CommonUIStrings.l_AccCheckerPaneTitle}get Yyn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(f.a)(Xk,"AccessibilityCheckStringsProvider",null,[51]);
class mo{constructor(){this.Iej=this.contentId=null}}Object(f.a)(mo,"ResultIds",null,[]);class Dk{constructor(R,Ba){this._element=null;this.gg=Ba;this.ee=R}get element(){this._element||(this._element=this.Y8k(),this.Pz());return this._element}Odg(R){this._element=R}dispose(){this.element&&(this.R$(),this.Odg(null))}Pz(){this.gg&&this.ee?(this.gg.ob(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ee.ob(W.a.$h,this.element,Object(a.a)(this,this.PG,"onKeyPress"))):va.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}R$(){this.gg&&this.ee&&(this.gg.sc(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ee.sc(W.a.$h,this.element,Object(a.a)(this,this.PG,"onKeyPress")))}onClick(){this.iUi();return!0}PG(R){return this.cNm(R.Hb.keyCode)?(this.iUi(),!0):!1}cNm(R){return R===ce.a.goe||R===ce.a.Ls}}Object(f.a)(Dk,"AInteractivePaneElement",null,[221,10]);var Ei=c(447),
tj=c(56);class qb extends Dk{constructor(R,Ba,lb){super(R,Ba);this.pLe=lb}hide(){this.element.removeAttribute(Xf.a.oh);Xf.a.ir(this.element,Xf.a.sA,Xf.a.pp);this.element.style.display="none"}show(){Xf.a.ir(this.element,Xf.a.sA,Xf.a.uM);Xf.a.ir(this.element,Xf.a.oh,Xf.a.N1e);this.element.style.display="block"}Y8k(){const R=Ei.b("div",this.wQi,"AccCheckerNotification");Xf.a.ir(R,Xf.a.Zth,Xf.a.pp);Xf.a.ir(R,Xf.a.lga,this.ESf);R.tabIndex=0;const Ba=Ei.b("span",this.vQi,"AccCheckerNotificationIcon");var lb=
Je.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Ba.appendChild(lb);lb=Ei.b("span",this.ESf,"AccCheckerNotificationText");tj.a.tv(lb,this.xQi);R.appendChild(Ba);R.appendChild(lb);return R}iUi(){this.pLe()}}Object(f.a)(qb,"APopupNotification",Dk,[220,221,10]);class Zb extends qb{constructor(R,Ba,lb,Vb){super(R,Ba,lb);this.Vta=Vb}get wQi(){return"AccCheckerOutOfSyncNotificationId"}get vQi(){return"AccCheckerOutOfSyncNotificationIconId"}get ESf(){return"AccCheckerOutOfSyncNotificationTextId"}get xQi(){return this.Vta.svn}}
Object(f.a)(Zb,"OutOfSyncNotification",qb,[]);class ed extends qb{constructor(R,Ba,lb,Vb){super(R,Ba,lb);this.Vta=Vb}get wQi(){return"AccCheckerPartialResultNotificationId"}get vQi(){return"AccCheckerPartialResultNotificationIconId"}get ESf(){return"AccCheckerPartialResultNotificationTextId"}get xQi(){return this.Vta.Yyn}}Object(f.a)(ed,"PartialResultNotification",qb,[]);var Od=c(188),$c=c(31),yf=c(172);class Cf{constructor(R,Ba,lb,Vb=null,zc=null,Yc=null,Zd=null){this.ich=this.lM=this.ee=this.NJa=
null;this.I0=Vb;this.gg=R;this.Vb=Ba;this.hp=lb;this.Vta=Zd||new Xk;this.dMe=zc||new Zb(this.I0,this.gg,Object(a.a)(this,this.lml,"dimissOutOfSyncNotification"),this.Vta);this.TMe=Yc||new ed(this.I0,this.gg,Object(a.a)(this,this.mml,"dimissPartialResultNotification"),this.Vta)}show(){}hide(){}get I0(){return this.ee||(this.ee=l.AFrameworkApplication.ua.mD)}set I0(R){this.ee=R}dKh(){}Loa(){}dispose(){}M8a(){}GEm(R){var Ba=this.ich[R];R=Ba.contentId;if((Ba=Ba.Iej+"")&&Ba.length){const lb=[];Array.add(lb,
Object.assign(new $c.a,{name:"RuleID",string:Ba}));Od.a.sendTelemetryEvent(Object.assign(new yf.a,{name:String.format("{0}.{1}",Cf.dkg,"ViolationSelected"),dataFields:lb}))}this.Fdn(R)}Fdn(R){R&&this.NJa.bgo(R)||(this.Vb.zL(Rf.AFrame.olh,!1),this.sto())}lml(){this.W9c(!1)}mml(){this.xqj(!1)}sto(){const R=Object.assign(new Jh.StandardDialog(!0),{Ht:l.AFrameworkApplication.Pca,Cd:1,xIa:!1});R.rV(1);R.xe(1,this.Vta.d4k);R.xe(0,CommonUIStrings.l_DialogCancel);R.uV(this.Vta.f4k,this.Vta.e4k,Ba=>{1===Ba&&
this.OBf()})}UMk(R){let Ba=null;if(R.Results&&0<R.Results.length){Ba={};let lb=0;for(const Vb of R.Results)Vb.ResultId=Cf.Jnk+ ++lb,R=new mo,R.contentId=Vb.ContentId,R.Iej=Vb.RuleId,Ba[Vb.ResultId]=R}return Ba}d5m(){Od.a.addNamespaceMapping(Cf.dkg,Cf.eGo);Od.a.sendTelemetryEvent(Object.assign(new yf.a,{name:String.format("{0}.{1}",Cf.dkg,"ShowTaskpane")}))}}Cf.Jnk="AccCheckResult";Cf.dkg="Office.UX.AccChecker";Cf.eGo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)(Cf,
"BaseAccessibilityCheckPane",null,[53,10]);class hh{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(hh,"AccCheckerTaskPaneProps",null,[]);var Of=c(1399),jj=c(1413),ch=c(1064),Fi=c(178);class Bh extends Cf{constructor(R,Ba,lb,Vb,zc=null,Yc=null,Zd,$e=null,pa=null){super(Ba,
lb,Vb,Yc,void 0,void 0,$e);this.iJg=null;this.Wah=this.SMe=this.Zrd=this.lvd=this.Gud=!1;this.iWe=null;this.dUe=!!l.AFrameworkApplication.ua&&!!l.AFrameworkApplication.ua.Lb&&l.AFrameworkApplication.ua.Lb.eHf;this.Puc=this.n6=null;this.zvc=0;this.Yld=null;this.tZ=zc;pa&&(this.n6=pa.fAd,this.Puc=pa.zgp,this.zvc=pa.eip);this.kB=new jj.a}get isVisible(){return this.Wah}bUa(R){this.Wah=R}Qef(R){R&&(this.iJg=R,R.IsSuccess&&(this.ich=this.UMk(R),R.IsPartialResult&&this.xqj(!0)),this.Gud=!0,this.lvd=!1,
this.Hm())}W9c(R){this.isVisible&&R!==this.Zrd&&(this.Zrd=R,this.Hm())}xqj(R){this.SMe=R;this.Hm()}OP(){this.lvd||Fi.UISurfaces.Mu().then(R=>{xa.a.instance.qz(Bh.esb+":PaneOpen:Start");R.showTaskPane(Bh.esb,this.vA());this.OBf();return null});this.isVisible?Fi.UISurfaces.Mu().then(R=>{R.setSelectedTaskPane(Bh.esb);return null}):this.d5m()}Hm(){Fi.UISurfaces.Mu().then(R=>{R.updateTaskPane(Bh.esb,this.vA());return null})}vA(){var R=new hh;this.kB.vpb(R);R=Object.assign(new ch.a,{title:this.Vta.ahc,
hideHeader:!1,width:320,location:2,contentProps:R,onOpen:()=>{this.u$();this.bUa(!0);l.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.$da();this.bUa(!1);this.lvd=this.Gud=!1;this.Hm();l.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0});this.dUe&&(R.enableResize=!0,R.minResizeWidth=268,R.maxResizeWidth=920);return R}initialize(R){const Ba=this.Vb.ae(Bh.esb);Ba.parent=Rf.AFrame.xp;Ba.$H=!0;this.NJa=R;this.Nok()}dispose(){this.M8a();this.dMe&&(this.dMe.dispose(),this.dMe=null);
this.TMe&&(this.TMe.dispose(),this.TMe=null);super.dispose()}Nok(){this.kB.AL(this.onRecheckExecute());this.kB.AL(this.WJl());this.kB.AL(this.E$l());this.kB.AL(this.onInvokeNavigateExecute());this.kB.AL(this.CYl());this.kB.AL(this.B5l());this.kB.AL(this.w7l());this.kB.AL(this.updateLastScanTime());this.kB.AL(this.showHelpPane())}onRecheckExecute(){return R=>{R.onRecheckExecute=()=>{this.OBf()}}}WJl(){return R=>{R.accessibilityCheckResultCollection=this.iJg}}E$l(){return R=>{R.resultsReady=this.Gud}}onInvokeNavigateExecute(){return R=>
{R.onInvokeNavigateExecute=Ba=>{this.GEm(Ba)}}}CYl(){return R=>{R.helpLink=this.iyl}}B5l(){return R=>{R.outOfSync=this.Zrd}}w7l(){return R=>{R.partialResult=this.SMe}}updateLastScanTime(){return R=>{R.updateLastScanTime=Ba=>{this.iWe=Ba}}}showHelpPane(){return R=>{R.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.$K||this.Kth()?this.Yld?this.Yld():this.n6.value&&this.Puc&&
this.zvc&&this.n6.value.Rb(this.zvc,2,this.Puc):this.yrj():this.Kth()?this.Yld?this.Yld():this.n6.value&&this.Puc&&this.zvc&&this.n6.value.Rb(this.zvc,2,this.Puc):this.yrj()}}}Kth(){return!this.tZ||!this.tZ.value}yrj(){const R=this.tZ.value;if(R){var Ba={};Ba.query=Bh.vek+Bh.Q3j;Ba=Object.assign(new Of.a,{YR:Ba});R.L5(Bh.ACe,Ba)}}OBf(){this.SMe=this.Zrd=this.Gud=!1;this.iWe&&this.iWe();this.Hm();this.lvd=!0;this.NJa.Ijn()}u$(){this.Vb.kg(Bh.esb)}$da(){this.w4a()&&this.Vb.kg(this.Vb.XT)}w4a(){return!!this.Vb.currentScope&&
this.Vb.currentScope.name===Bh.esb}}Bh.esb="AccessibilityCheckerPane";Bh.Q3j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Bh.ACe="FA000000012";Bh.vek="AssetID=";Object(f.a)(Bh,"ReactAccessibilityCheckPane",Cf,[]);class Sh extends Bh{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa=null){super(R,Ba,lb,Vb,zc,Yc,void 0,pa);this.B0j=$e;this.w3=Zd}get iyl(){return this.B0j}OP(){this.w3.tOa();super.OP()}}Object(f.a)(Sh,"ReactLiveBooksAccessibilityCheckPane",Bh,[]);var Jc=c(1152),fh=c(137),fj=c(174),If=c(63),ui=c(161),gk=
c(505),le;(function(R){R[R.error=0]="error";R[R.warning=1]="warning";R[R.tip=2]="tip";R[R.intelligentService=3]="intelligentService"})(le||(le={}));Object(f.b)("AccessibilityRuleCategory",le);class xe{constructor(R,Ba,lb=null){this.tre=null;this.k0g=this.TZg=!1;this.qNa=R;this.jfd=Ba;this.ga=lb;this.nc.ra(m.a.DYk,y.a.frame,Object(a.a)(this,this.D7e,"closePane"))}get nc(){return this.ga||(this.ga=l.AFrameworkApplication.va)}set nc(R){this.ga=R}kul(){this.TZg||(this.qNa.initialize(this),this.jfd.initialize(this),
this.TZg=!0)}Ijn(){J.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.jfd.D7n()}OP(R,Ba,lb){if(1===lb)return Mf.SessionStatusManager.instance.Uj?8:32;this.qNa.isVisible||this.kul();this.Uuo();return 32}D7e(R,Ba,lb){1!==lb&&this.qNa.Loa();return 32}Lqn(){this.qNa.W9c(!0)}Qef(R){if(R){if(R.AccessibilityRules&&Object.keys(R.AccessibilityRules).length){const lb=R.AccessibilityRules;for(let Vb in lb){var Ba=Vb;const zc=lb[Vb].RuleId+"";Ba!==zc&&J.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
Ba,zc)}this.tre=lb}else!this.tre&&R.Results&&0<R.Results.length?(J.b(18993251,200,15,"No accessibility rule definitions available"),R.IsSuccess=!1):R.AccessibilityRules=this.tre;R.IsSuccess||J.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.eYn(R);this.U4m(R);this.qNa.Qef(R)}}eYn(R){const Ba=R.AccessibilityRules;if(R=R.Results)for(let lb=R.length-1;0<=lb;lb--){const Vb=R[lb];let zc="";const Yc=Vb.RuleId;Vb.ContentName||(zc+="Result does not have content name. ");Yc in Ba||(zc+=String.format("No accessibility check rule exists for ID {0}.",
Yc));0<zc.length&&(J.b(36214999,200,15,"Omitting invalid accessibility check result: "+zc),Array.removeAt(R,lb))}}Nam(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):ta.a.instance.resolve("Common.IDynamicScriptLoaderProvider").aA.loadScript("accessibility-checker-pane-strings")}Uuo(){this.k0g?this.qNa.OP():this.Nam().then(()=>{this.k0g=!0;this.qNa.OP()}).catch(R=>va.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
R))}U4m(R){var Ba={};const lb={};var Vb=R.Results,zc=[];Array.add(zc,Object.assign(new $c.a,{name:"FinalViolationCount",int64:0}));Array.add(zc,Object.assign(new $c.a,{name:"FinalErrorCount",string:"0"}));Array.add(zc,Object.assign(new $c.a,{name:"FinalWarningCount",string:"0"}));Array.add(zc,Object.assign(new $c.a,{name:"FinalTipCount",string:"0"}));Array.add(zc,Object.assign(new $c.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Vb){for(const $e of Vb)if(R.AccessibilityRules){var Yc=R.AccessibilityRules[$e.RuleId];
if(Yc){if(Ba[le[Yc.Category]]){let pa=Ba[le[Yc.Category]];Ba[le[Yc.Category]]=++pa}else Ba[le[Yc.Category]]=1;lb[$e.RuleId]?(Yc=lb[$e.RuleId],lb[$e.RuleId]=++Yc):lb[$e.RuleId]=1}}zc[0].int64=Vb.length;for(var Zd in Ba)switch(R=Ba[Zd],Vb=Zd,Vb="Final"+Vb.charAt(0).toUpperCase()+Vb.substring(1,Vb.length)+"Count",Vb){case "FinalErrorCount":zc[1].string=R.toString();break;case "FinalWarningCount":zc[2].string=R.toString();break;case "FinalTipCount":zc[3].string=R.toString();break;case "FinalIntelligentServiceCount":zc[4].string=
R.toString()}}Od.a.sendTelemetryEvent(Object.assign(new yf.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:zc}));for(let $e in lb)Ba=$e,zc=lb[$e],Zd=[],Array.add(Zd,Object.assign(new $c.a,{name:"RuleID",string:Ba})),Array.add(Zd,Object.assign(new $c.a,{name:"FinalViolationCount",string:zc.toString()})),Od.a.sendTelemetryEvent(Object.assign(new yf.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Zd}))}dispose(){this.qNa&&
this.qNa.dispose();this.jfd&&this.jfd.dispose()}}Object(f.a)(xe,"AAccessibilityCheckManager",null,[50,10]);var ci=c(307);const Ch=[12,14,22,19,30,43,44];class Re extends xe{constructor(R,Ba,lb,Vb,zc,Yc){super(Ba,lb,R);this.nc.ra(m.a.zfg,y.a.frame,this.OP.bind(this));this.nc.fb(m.a.xKn,y.a.frame,this.o4i.bind(this),96);this.graph=zc;this.I$j=Vb;this.$6j=Yc;this.zgc=()=>{this.Lqn()};this.DUn()}o4i(R,Ba,lb,Vb,zc){if(1===lb)return 32;zc[ci.a.On]=this.qNa.isVisible;return 32}bgo(R){if(this.$6j)return va.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;va.ULS.shipAssertTag(20272215,334,!!R);return this.I$j.zdn(R)}DUn(){for(const R of Ch){const Ba=this.graph.Te(R);Ba.Mo(this.zgc);Ba.hu(this.zgc);Ba.Fx(this.zgc)}}dQo(){for(const R of Ch){const Ba=this.graph.Te(R);Ba.jV(this.zgc);Ba.iV(this.zgc);Ba.Pqa(this.zgc)}}dispose(){super.dispose();this.dQo()}}Object(f.a)(Re,"WordAccessibilityCheckManager",xe,[]);var Oh=c(76),kf=c(26),Xe=c(100),xh=c(18),no=c(166),kl=c(6),gh=c(15),gm=c(473);class ug{constructor(R,
Ba,lb,Vb,zc,Yc,Zd){this.en=null;this.ZCb=0;this.Zc=Ba;this.iA=lb;this.ib=Vb;this.ga=zc;this.kd=Yc;this.eu=R;this.ud=Zd}get ZP(){if(!this.en){const R=this.Zc.Tf(this.eu.Yc);this.iA.Fmg(R);if(R.zb(7)||R.ld(7))this.en=Oh.a.zs(R,R.origin)}return this.en}zdn(R){if(!R||!R.yg||0>=R.yg.length)return va.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Ba=Array(R.yg.length);let lb=7,Vb=null;for(let Yc=0;Yc<R.yg.length;Yc++)if(Vb=this.nCl(R.yg[Yc])){if(7===lb)lb=this.ZCb;else if(lb!==
this.ZCb)return va.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var zc=this.ud.CSa(Vb.characterData,Vb.qa);const Zd=R.cpBegin?this.ud.wCb(zc,R.cpBegin):-1;zc=R.cpEnd?this.ud.wCb(zc,R.cpEnd):-1;if(-1>Zd||-1>zc)return va.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Ba[Yc]=kf.a.FO(Zd,zc,!1,Vb);switch(R.contentType){case 5:if(!Xe.a.lSc(Ba[Yc],!1))return!1;break;case 6:if(!xh.ImageReader.G4(Ba[Yc]))return!1;
break;case 7:Ba[Yc]=kf.a.FO(-1,-1,!1,Vb)}}else return!1;Ba=new no.Selection(Ba,!1);return this.Xko(Vb,Ba,R.contentType)}nCl(R){if(this.ZP)for(this.ZP.reset(),this.ZCb=7;this.ZP.moveNext();){var Ba=this.ZP.currentNode.type;if(38===Ba||36===Ba||23===Ba)this.ZCb=Ba;else if(12===Ba){Ba=this.ZP.currentNode;const lb=Ba.ja(kl.a.Wc,0);if(R===lb)return Ba}}return null}cjg(R){this.ga.processAction(gh.a.ZT,2);this.ga.processAction(gh.a.d4,2);let Ba=2;switch(this.ZCb){case 23:Ba=32;break;case 38:Ba=this.ga.Rb(gh.a.N5a,
2,new gm.a(R));break;case 36:Ba=this.ga.Rb(gh.a.Hlb,2,new gm.a(R));break;default:va.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.ZCb)}if(32===Ba)return!0;va.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.ZCb);return!1}Xko(R,Ba,lb){if(this.cjg(R)){R=this.eu.gu;const Vb=this.ib.hb.lb;Vb&&Vb.equals(Ba)&&this.kd.dea(R,null);this.kd.dea(R,Ba);switch(lb){case 0:case 1:this.ga.processAction(eh.a.rPb,2);break;case 2:this.ga.processAction(eh.a.M7c,
2);break;case 3:this.ga.processAction(eh.a.kza,2)}return!0}return!1}}Object(f.a)(ug,"WordAccessibilityCheckNavigateManager",null,[1684]);class sc{constructor(R){this.NJa=null;this.DVg=R}get fileId(){return this.DVg?this.DVg():null}initialize(R){this.NJa=R}xSi(R){this.NJa.Qef(R)}}Object(f.a)(sc,"AAccessibilityCheckService",null,[52,10]);class oo{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(R){R=Sys.Serialization.JavaScriptSerializer.deserialize(R);
const Ba=R.AccessibilityRules,lb={};if(Ba)for(let Vb=0;Vb<Ba.length;++Vb){const zc=Ba[Vb];lb[zc.Key]=zc.Value}R.AccessibilityRules=lb;return R}}Object(f.a)(oo,"AccessibilityCheckResultCollection",null,[]);class Un extends sc{constructor(R){super(R);this.onFailure=(Ba,lb)=>{va.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",lb);Ba=Object.assign(new oo,{IsSuccess:!1});this.xSi(Ba)};this.onSuccess=Ba=>{Ba=Un.C$l(Ba);let lb=null;if(Ba)try{lb=this.Ijl(Ba)}catch(Vb){va.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Vb.message),lb=Object.assign(new oo,{IsSuccess:!1})}else va.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),lb=Object.assign(new oo,{IsSuccess:!1});this.xSi(lb)}}dispose(){}static C$l(R){let Ba=null;R&&R.Hj&&(Ba=R.Hj[0]);return Ba?Ba.Body:null}}Object(f.a)(Un,"ALiveBooksAccessibilityCheckService",sc,[]);var jk=c(1004),Go=c(232);class Xl extends Go.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}el(){return 56}static construct(R,
Ba){const lb=new Xl;lb.FileId=R;lb.IsCoauthorable=Ba;return lb}}Object(f.a)(Xl,"WordAccessibilityCheckRequest",Go.a,[]);class Wp{}Object(f.a)(Wp,"AccessibilityCheckRule",null,[]);var Id=c(185);class tr{static parse(R){switch(Xa.a.Zg(R)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw R=String.format("Invalid Accessibility result category: {0}",R),Id.a.argument(R);}}}Object(f.a)(tr,"AccessibilityRuleCategoryParser",null,[]);class xk{constructor(){this.Category=
this.Text=this.Id=null}static jIo(R){const Ba=new Wp;Ba.RuleId=R.Id;Ba.RuleName=R.Text;Ba.Category=tr.parse(R.Category);return Ba}}Object(f.a)(xk,"WordAccessibilityCheckRule",null,[]);class Ek{}Object(f.a)(Ek,"AccessibilityCheckResult",null,[]);class kk{constructor(){this.cpEnd=this.cpBegin=this.yg=null;this.contentType=0}}Object(f.a)(kk,"WordAccessibilityCheckContentId",null,[]);const co=R=>{switch(Xa.a.Zg(R)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var sd=c(1609);class vc{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static hIo(R){const Ba=new Ek;Ba.RuleId=R.RuleId;Ba.ContentName=R.Label;const lb=new kk;lb.yg=R.ParaId;lb.cpBegin=sd.b(R.OS);lb.cpEnd=sd.b(R.OE);lb.contentType=co(R.ContentType);Ba.ContentId=lb;return Ba}}Object(f.a)(vc,"WordAccessibilityViolation",null,
[]);class rp{constructor(){this.Violations=this.Rules=null}static iIo(R){const Ba=new oo;try{var lb={};if(R.Rules){for(let Vb=0;Vb<R.Rules.length;++Vb){const zc=xk.jIo(R.Rules[Vb]);lb[zc.RuleId]=zc}Ba.AccessibilityRules=lb}if(R.Violations){const Vb=Array(R.Violations.length);for(lb=0;lb<R.Violations.length;++lb)Vb[lb]=vc.hIo(R.Violations[lb]);Ba.Results=Vb}Ba.IsPartialResult=!1;Ba.IsSuccess=!0}catch(Vb){va.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Vb.message),Ba.IsSuccess=!1}return Ba}}Object(f.a)(rp,"WordAccessibilityCheckResult",null,[]);class Bo extends Un{constructor(R,Ba,lb){super(R);this.Dub=Ba;this.tbb=lb}D7n(){const R=Object.assign(new jk.a,{Gq:Xl.construct(this.fileId,this.tbb),status:1,QG:"AccessibilityCheck"});this.Dub(12,!1,this.onSuccess,this.onFailure,R,null,R)}Ijl(R){R=ab.b(R);return rp.iIo(R)}}Object(f.a)(Bo,"WordAccessibilityCheckService",Un,[]);class Uo extends wm{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}wc(R){super.wc(R);
R.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Sh(l.AFrameworkApplication.va,fm.a.instance,Jg.FocusManager.instance(),Cq.a.instance,R.Re("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),bf.KeyInputManager.instance,Jc.a.instance,l.AFrameworkApplication.K.kb("AccessibilityCheckerHelpUrl"))).ha();R.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Bo(()=>l.AFrameworkApplication.rootQuerySignature,gk.a.iR,fh.PageReader.instance.xRd(eb.App.za.jb.Yc))).ha();
R.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new ug(eb.App.za.jb,R.resolve("Box4.Graph.IGraphIteratorFactory"),fj.PageNavigator.instance,R.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.va,If.InteractiveViewManager.instance,R.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();R.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Re(l.AFrameworkApplication.va,R.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
R.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),R.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),eb.App.ni.zl,ui.App.BWc)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{wm.prototype.init.call(this)})}}Object(f.a)(Uo,"WordAccCheckerPackageManager",wm,[]);class Yl{constructor(R,Ba){this.Pgh=!1;this.DLo=()=>{this.CLo()};this.Pk=R;this.NI=Ba}nSa(R){R.OM.Dxk(this.DLo)}CLo(){!this.Pgh&&this.Pk&&(this.Pk.tGa?this.NI?
this.NI.execute(R=>{R.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):va.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.Pgh=!0)}}Object(f.a)(Yl,"CoauthSurveyManager",null,[1654]);class Fm{constructor(){this.eu=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){eb.App.za&&(this.eu=eb.App.za.jb)&&(this.eu.mxa?this.Xja():this.eu.fga(()=>{this.Xja()}))}Xja(){var R=this.eu.Yc;R&&(R=R.contentReplicator)&&this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").nSa(R)}dispose(){}wc(R){this.W=
R;R.ia("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Yl(R.resolve("WordEditor.IWordEditorCoauthManager"),R.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").ha()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&L.a.instance.Gc(new Fm)}}Object(f.a)(Fm,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var Kn;(function(R){R[R.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";R[R.inboundRequestTakesTooLongToSendAfterRTC=
1]="inboundRequestTakesTooLongToSendAfterRTC";R[R.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(Kn||(Kn={}));Object(f.b)("ComponentLoggingScenario",Kn);var pj=c(1459);class Hp{flush(R,Ba){const lb=this.vTl(R);lb.LoggingScenario=Kn[Ba];Pc.a(lb).length?va.ULS.sendTraceTag(594571986,3013,15,"{0}",lb):va.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",pj.a[R.Z_a])}vTl(R){const Ba={};if(!R)return Ba;const lb=new kc.a;for(lb.enqueue(R);!lb.isEmpty;){R=
lb.dequeue();const Vb=pj.a[R.Z_a];try{Ba[Vb]=R.VC()}catch(zc){va.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Vb.toString(),{["Kind"]:"Exception",["Stack"]:zc.stack,["Message"]:zc.message,["FileName"]:zc.fileName,["LineNumber"]:zc.lineNumber})}if((R=R.DGd)&&R.length)for(const zc of R)!zc||pj.a[zc.Z_a]in Ba||lb.enqueue(zc)}return Ba}}Object(f.a)(Hp,"ComponentStateLogManager",null,[1653]);class po{flush(){}}Object(f.a)(po,"NoOpComponentStateLogManager",
null,[1653]);class Tl{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}wc(R){this.W=R;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?R.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Hp).as("Common.IComponentStateLogManager").ha():R.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new po).as("Common.IComponentStateLogManager").ha()}static main(){L.a.instance.Gc(new Tl)}}
Object(f.a)(Tl,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Fk=c(2059);class Yk{constructor(R,Ba,lb){this.Wf=R;this.uwd=Ba;this.Uah=lb}sj(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma=null,ya=!1,wa=null,Ta=null,Bb=null,Qb=null,jc=!1){return this.Uah?this.uwd.sj(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,Ta,Bb):this.Wf.sj(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,wa,Ta,Bb,Qb,jc)}d$b(R){return this.Uah?this.uwd.d$b():this.Wf.d$b(R)}}Object(f.a)(Yk,"ClientRequestAdapter",null,[923]);var Hh=c(211),qo=c(255),xm=c(223),gg=c(1408),
jn=c(312),ro=c(1419),Le=c(2060),Th=c(51),ig=c(308),Kk=c(736),Lk=c(597),Ln=c(111),zg=c(575),ka=c(609),db;(function(R){R[R.none=0]="none";R[R.getCells=1]="getCells";R[R.hotStoreStatus=2]="hotStoreStatus";R[R.saveMonitor=3]="saveMonitor";R[R.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";R[R.kickoutExecutor=5]="kickoutExecutor"})(db||(db={}));Object(f.b)("MostRecentRevisionIdOrigin",db);class Gb extends Sys.EventArgs{constructor(R,Ba,lb,Vb){super();this.BYc=R;this.httpStatusCode=lb;this.cI=
Vb}}Object(f.a)(Gb,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class cc{constructor(){this.t7=0}get isEmpty(){return!this.t7}kFc(R){this.t7|=R}fXc(R){return!!(this.t7&R)}clear(){this.t7=0}oHc(){return!1}}Object(f.a)(cc,"DocxSaveMonitorRetryAttemptOnce",null,[]);class xc{constructor(R,Ba=3){this.t7=0;this.Jud=new Map;this.Z9j=R;this.Nfk=Ba}get isEmpty(){return!this.t7}kFc(R){this.t7|=R;let Ba=this.Jud.get(R)||0;this.Jud.set(R,++Ba)}fXc(R){return!!(this.t7&R)}clear(){this.t7=0;this.Jud.clear()}oHc(R){return this.Nfk&
R?(this.Jud.get(R)||0)<this.Z9j:!1}}Object(f.a)(xc,"DocxSaveMonitorRetryAttemptMany",null,[]);class Vc{static create(R=!1,Ba=3,lb=0){return R?new xc(Ba,lb):new cc}}Object(f.a)(Vc,"DocxSaveMonitorRetryAttemptFactory",null,[]);var Wd=c(1723),re;(function(R){R[R.Ykp=-1]="noResultYet";R[R.Urp=0]="upToDate";R[R.Uop=1]="sessionLost";R[R.csp=2]="userSignedOut";R[R.Smp=3]="previousRequestPending";R[R.ude=4]="requestFailed";R[R.wpp=5]="shuttingDown";R[R.ilp=6]="nullResponseData";R[R.Xip=7]="invalidResponseData";
R[R.hgp=8]="failedRevisionLookup";R[R.nop=9]="savedWithinThreshold";R[R.clp=10]="notSavedWarning";R[R.pjp=11]="kickoutThreshold";R[R.Frp=12]="unknownRevision";R[R.Sdp=13]="contentNotYetLoaded";R[R.sessionExpired=14]="sessionExpired";R[R.canaryError=15]="canaryError";R[R.timeout=16]="timeout";R[R.qjp=17]="kickoutThreshold_Offline";R[R.dfp=18]="dssSessionDeleted";R[R.efp=19]="dssSessionExpired";R[R.lsp=20]="waitingForSessionTokenRefresh";R[R.ffp=21]="dssSessionNotFound"})(re||(re={}));Object(f.b)("SaveMonitorResult",
re);class od{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,wa,Ta,Bb,Qb,jc,Ic,Oc,kd,td,qd,Fd,se,qe,Ud,Ke=null,We){this.Ryc=0;this.NXb=!1;this.uBc=null;this.Axc=this.eO=-1;this.RNe=null;this.jtd=0;this.ktd=!1;this.Ywb=null;this.yzc=0;this.DQe=this.Uhh=null;this.FS=this.f3g=this.Mtc=0;this.dIe=null;this.n0g=!1;this.Vl=null;this.vwd=0;this.ayd=void 0;this.Teh=!1;this.tch=0;this.Weh=!1;this.tDl=()=>{var pd;va.ULS.sendTraceTag(524871194,od.Xm,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.KU,["AppVisibilityState"]:gg.a[null===
(pd=this.Vl)||void 0===pd?void 0:pd.JD]});try{if(this.Teh&&this.fvc){var pe=this.fvc();va.ULS.sendTraceTag(509367249,od.Xm,50,"Additional Details: {0}",pe)}}catch(Kf){pd=ab.c({["Kind"]:"Exception",["Stack"]:Kf.stack,["Message"]:Kf.message,["FileName"]:Kf.fileName,["LineNumber"]:Kf.lineNumber}),va.ULS.sendTraceTag(509367062,od.Xm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",pd)}pd=this.fwb;this.fwb=this.$z();if(this.Caa())this.hA.event(5),this.stop("session has shut down");
else if(this.sbb===od.tdj&&this.Xza(this.qub),pe=this.SWb())if(this.uGe()&&l.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.KU)this.hA.event(0);else if(this.RXb())this.hA.event(1),this.stop("session is lost"),l.AFrameworkApplication.le("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.n0g&&!this.dNm()&&(va.ULS.sendTraceTag(554726995,od.Xm,10,"DocxSaveMonitor: Session lost but not kicked out"),this.aI(Th.a.dTh));else if(this.uGe())20!==
this.hA.currentState?(this.hA.event(20),this.Uhh=this.$z(),va.ULS.sendTraceTag(593510691,od.Xm,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.Vhh)):this.$z().getTime()-this.Uhh.getTime()>this.Vhh&&(this.hA.event(14),this.b1d(20,Th.a.UKd,"TokenExpired"));else if(this.V7j())if(this.fwb=pd,this.NXb)this.hA.event(3),this.$z().getTime()-this.uBc.getTime()>this.oHe&&(pd=this.kve.d$b(this.eO),va.ULS.sendTraceTag(19161610,205,50,
"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.eO,hn.a[pd]),this.vud&&this.vud.log(),this.stop("stuck on previousRequestPending"),this.aI());else if(pd=Lk.b(Wd.a.construct(pe)),this.NXb=!0,this.uBc=this.wfk(),this.eO=this.kve.sj(od.serviceUrl,2,pd,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.YUk,this.XUk,null,void 0,void 0,this.yek,this.jRe,void 0,void 0,!0),0>=this.eO)this.NXb=!1,va.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",
this.eO.toString());else{pd=this.kve.d$b(this.eO);pe=100;if(pd&&1!==pd||this.HYg)pe=50;va.ULS.sendTraceTag(19161612,od.Xm,pe,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.eO,["Status"]:hn.a[pd]});this.vud&&this.vud.start(this.eO)}else this.hA.event(2);else this.hA.event(13)};this.XUk=pd=>{this.FS=this.NGd+1;let pe=this.NXb=!1,Kf=!1;pd=pd.data;ua.a.Wk&&l.AFrameworkApplication.zia("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");pd?(va.ULS.sendTraceTag(22552773,od.Xm,
15,"Request failed {0}",{["Status"]:pd.status,["HttpStatus"]:pd.Qe,["Correlation"]:pd.Aj?pd.Aj[jn.a.VQ]:"",["Id"]:pd.id,["ConsecutiveErrors"]:this.NGd,["Request.InvokedTime"]:pd.RH,["Request.EnqueueTime"]:pd.QOa,["Request.CompletedTime"]:pd.PT}),Kf=7===pd.status||13===pd.status,this.oHc(2)&&Kf?(this.kWa.kFc(2),pe=!0,this.Axc=pd.Qe,this.hA.event(16)):this.oHc(1)&&5===pd.status?(this.kWa.kFc(1),pe=!0,this.Axc=pd.Qe,this.hA.event(15)):(this.hA.event(4),this.Axc=pd.Qe)):(this.hA.event(4),va.ULS.sendTraceTag(23425240,
od.Xm,15,"RequestFailed and event data is null"));if(!pe&&(this.kWa.clear(),Kf?this.b1d(17,Th.a.gql,"while offline"):this.b1d(11,Th.a.tff,"while online")))return;this.Xza(pe?this.BMl(Kf):this.qub)};this.YUk=pd=>{this.FS=this.NGd+1;this.NXb=!1;var pe={};this.kWa.clear();if(pd=pd.data){var Kf=pd.Aj?pd.Aj[jn.a.VQ]:"";pe.HttpStatus=pd.Qe;pe.Correlation=Kf;pe.Id=pd.id;va.ULS.sendTraceTag(23425242,od.Xm,this.HYg?50:100,"Request succeeded at the HTTP level {0}",pe);this.Axc=pd.Qe}else va.ULS.sendTraceTag(23425241,
od.Xm,15,"Request succeeded with null response data");if(this.Caa()||!this.VKd)this.hA.event(5),this.stop("session has shut down");else if(!this.iSm())if(pd&&pd.se)if(pd=this.Jva(pd.se))if(this.e3.bVa(pd),pd.StatusCode)this.qIf(pd,pe)||this.hA.event(8,pe);else{this.FS=0;this.fwb=this.$z();this.IPe.clear();pe={["LastSavedRevisionId"]:pd.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:pd.RevisionSequenceNumber};pd=Ln.b(pd.LastSavedRevisionId);this.rpb(pd,3);var Yf=this.hof().store.getRevision(pd);
if(Yf){pd=null;Kf=this.vib();Yf=(Yf=Yf.P1a(Kf))?Yf.id:wh.a.nil;let Pf=Kf;for(;Pf&&!Pf.id.equals(Yf);)pd=Pf,Pf=Pf.Bn;this.Unm(pd,pe,Kf)||this.hA.event(9)}else this.Amm()||this.hA.event(12,pe);this.Xza(this.h0b)&&va.ULS.sendTraceTag(22552774,od.Xm,50,"Received response from server -- going back to normal interval")}else this.hA.event(7),this.rIf("invalid response",pe);else this.hA.event(6),this.rIf("null response",pe)};this.y5n=(pd,pe)=>{pd={};pd.DocxSaveMonitorState=re[pe.newState];pd.PreviousState=
re[pe.j1f];pd.PreviousStateHits=pe.k1f;pd.PreviousStateTransitionTime=pe.l1f.toISOString();pd.LastHttpStatus=this.Axc;pd.LastSuccessTime=this.fwb.toISOString();this.uBc&&(pd.LastRequestStartTime=this.uBc.toISOString());pd.LastSavedRevisionID=this.h4d.toString();pd.LastSavedRevisionIdOrigin=this.Ryc;pd.LastSavedRevisionIdSetTime=this.DQe?this.DQe.toISOString():null;pd.IsViable=this.kf.Lxa;pd.IsNetworkConnected=this.kf.WH;pd.IsExpired=this.kf.Sca;pd.HasEmergencyViewModeBeenDeployed=this.kf.Uj;pd["Navigator.Online"]=
window.navigator.onLine;const Kf=pe.GAo;Kf&&od.fNi(pd,Kf);pe=pe.newState;switch(pe){case 13:va.ULS.sendTraceTag(5830086,od.Xm,50,"{0}",pd);break;case 1:va.ULS.sendTraceTag(5884125,od.Xm,50,"{0}",pd);break;case 0:va.ULS.sendTraceTag(5830087,od.Xm,50,"{0}",pd);break;case 2:va.ULS.sendTraceTag(5830088,od.Xm,50,"{0}",pd);break;case 3:va.ULS.sendTraceTag(5830089,od.Xm,50,"{0}",pd);break;case 4:va.ULS.sendTraceTag(5884126,od.Xm,50,"{0}",pd);break;case 5:va.ULS.sendTraceTag(5884127,od.Xm,50,"{0}",pd);break;
case 6:va.ULS.shipAssertTag(5830090,od.Xm,!1,"{0}",pd);break;case 7:va.ULS.shipAssertTag(5830091,od.Xm,!1,"{0}",pd);break;case 8:va.ULS.sendTraceTag(5830092,od.Xm,15,"{0}",pd);break;case 10:va.ULS.sendTraceTag(5830094,od.Xm,15,"{0}",pd);break;case 9:va.ULS.sendTraceTag(5884128,od.Xm,50,"{0}",pd);break;case 11:va.ULS.sendTraceTag(5830096,od.Xm,15,"{0}",pd);break;case 17:va.ULS.sendTraceTag(37835678,od.Xm,15,"{0}",pd);break;case 12:va.ULS.sendTraceTag(5830095,od.Xm,15,"{0}",pd);break;case 18:va.ULS.sendTraceTag(38122832,
od.Xm,15,"{0}",pd);break;case 19:va.ULS.sendTraceTag(38122833,od.Xm,15,"{0}",pd);break;case 21:va.ULS.sendTraceTag(0,od.Xm,15,"{0}",pd);break;case 14:va.ULS.sendTraceTag(6575508,od.Xm,15,"{0}",pd);break;case 15:va.ULS.sendTraceTag(36739287,od.Xm,50,"{0}",pd);break;case 16:va.ULS.sendTraceTag(36767649,od.Xm,15,"{0}",pd);break;case 20:va.ULS.sendTraceTag(593510690,od.Xm,15,"{0}",pd);break;default:va.ULS.shipAssertTag(5884129,od.Xm,!1,"Bad state:{0} logInfo:{1}",pe,pd)}};this.h0b=R;this.qub=Ba;this.sbb=
R;this.tkh=lb;this.Ihk=Vb;this.yek=Yc;this.jRe=Zd;this.WYb=$e;this.ARg=pa;this.kve=Ma;this.XZ=ya;this.e3=wa;this.SWb=Ta;this.V7j=Bb;this.RXb=Qb;this.uGe=jc;this.Caa=Ic;this.$z=Oc;this.wfk=kd;this.n0g=Ud;this.kWa=Vc.create(We.isEnabled,We.maxRetries,Fd.t7);this.IPe=new ka.a;this.fvc=se;this.hA=new ro.a(-1);this.kf=Ke;this.hA.q_e(this.y5n);this.vud=td;this.fwb=Oc();this.HYg=qd;this.QTj=We.isEnabled?null:Fd;this.atb=qe;this.Vhh=this.tkh;this.$Je=wh.a.nil;this.sa=new N.a;ta.a.instance.Ta("Common.App.VisibilityManagement.IVisibilityManager").execute(pd=>
{this.Vl=pd;this.Vl.$Za((pe,Kf)=>{this.aY(pe,Kf)});this.bOe=pd.JD});this.kf&&this.kf.gBd((pd,pe)=>{this.H5a(pd,pe)});this.oHe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",zc):zc;this.tch=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.qub):this.qub;this.Teh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",
!0):!0;this.Weh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.Ofk=We}H5a(R,Ba){va.ULS.sendTraceTag(528577692,od.Xm,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Le.a[Ba.I5d],Le.a[Ba.Hfc]);1!==Ba.Hfc&&3!==Ba.Hfc&&(va.ULS.sendTraceTag(528566343,od.Xm,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",
this.kWa.fXc(1),this.kWa.fXc(2)),this.kWa.clear())}get VKd(){return this.Mtc}get h4d(){return this.$Je}get KU(){const R=!this.vib()||this.h4d.equals(this.vib().id);R||va.ULS.sendTraceTag(521413851,od.Xm,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.vib().id.toString(),this.h4d.toString());return R}get Xxi(){return this.$z().getTime()-this.fwb.getTime()>this.oHe}get NGd(){return this.FS}get Z_a(){return 3}get DGd(){let R=null;eb.App.za&&eb.App.za.jb&&
eb.App.za.jb.Yc&&(R=eb.App.za.jb.Yc.contentReplicator);return[R,ui.App.L1]}aY(R,Ba){var lb,Vb,zc;R={["VisibilityState"]:gg.a[this.Vl.JD],["IsVisible"]:this.Vl.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.NXb,["KickoutIntervalElapsed"]:this.Xxi,["LastSuccessfulIterationTime"]:null!==(lb=this.fwb)&&void 0!==lb?lb:"null",["RequestStartTime"]:null!==(Vb=this.uBc)&&void 0!==Vb?Vb:"null",["SkippedKickouts"]:this.vwd,["LastSkippedKickoutAt"]:null!==(zc=this.k3g)&&void 0!==zc?zc:"null"},["IsViable"]:this.kf.Lxa,
["IsNetworkConnected"]:this.kf.WH,["IsExpired"]:this.kf.Sca,["HasEmergencyViewModeBeenDeployed"]:this.kf.Uj,["Navigator.Online"]:window.navigator.onLine};va.ULS.sendTraceTag(539874775,od.Xm,50,ab.c(R));this.bOe!=this.Vl.JD&&(0==Ba.oldState||1==Ba.oldState||0!==Ba.newState&&1!==Ba.newState||this.Xza(this.tch),0===this.Vl.JD?(tc.c(gh.a.LKk,void 0,void 0,void 0,void 0,void 0,R),this.ayd&&tc.b("AvgTimeSpentOutsideOfWord",Date.now()-this.ayd,1),this.ayd=void 0):0===this.bOe&&(tc.c(gh.a.MKk,void 0,void 0,
void 0,void 0,void 0,R),this.ayd=Date.now()),this.bOe=this.Vl.JD)}start(){this.Mtc=this.ARg.igb(this.tDl,this.sbb)}Xza(R){if(!this.VKd||this.sbb===R)return!1;const Ba=this.sbb;this.sbb=R;this.stop("changing save monitor interval from "+Ba+"ms to "+R+"ms");this.start();return!0}rpb(R,Ba){if(Ba>=this.Ryc&&R&&!wh.a.nil.equals(R)){var lb=!this.$Je.equals(R);this.Ryc=Ba;this.$Je=R;const Vb=this.$z();this.DQe=Vb;const zc=this.KU;lb&&(Ba={["Id"]:R.toString(),["IsUpToDate"]:zc,["Origin"]:db[Ba]},this.dIe&&
(Ba.LastUpToDateTime=this.dIe.toISOString()),(lb=this.hof())&&lb.store&&(R=lb.store.getRevision(R))&&(Ba.LastSavedCreationTime=R.creationTime.toISOString()),va.ULS.sendTraceTag(557320151,od.Xm,50,"Updating Last Saved Revision: {0}",Ba));zc&&(this.dIe=Vb)}else Ba<this.Ryc?va.ULS.sendTraceTag(572051800,od.Xm,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.Ryc,Ba):va.ULS.sendTraceTag(572051801,od.Xm,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Ba)}stop(R){this.Ze(R)}Ze(R){this.VKd&&
(va.ULS.sendTraceTag(5830084,od.Xm,50,"Stopping DocxSaveMonitor because {0}!",R),this.ARg.Ze(this.VKd),this.Mtc=0)}Amm(){if(0>=this.WYb)return!1;var R=this.V4l();if(!R)return this.RNe=null,this.jtd=0,this.ktd=!1;this.Ywb=R.yEb;this.Ywb===this.RNe?this.jtd++:(this.RNe=this.Ywb,this.jtd=1,this.ktd=!1);if(this.jtd<od.vbn)return!1;this.yzc=+this.$z()-+this.Ywb;if(this.yzc<=this.WYb)return!1;if(!this.ktd)return this.ktd=!0,this.e5i(),!1;if(this.atb)this.atb.execute(Ba=>{Ba.flush(this,0)});else{R="";try{this.fvc&&
(R=this.fvc())}catch(Ba){R=ab.c({["Kind"]:"Exception",["Stack"]:Ba.stack,["Message"]:Ba.message,["FileName"]:Ba.fileName,["LineNumber"]:Ba.lineNumber}),va.ULS.sendTraceTag(50426817,od.Xm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",R)}va.ULS.sendTraceTag(50426818,od.Xm,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Ywb.toISOString(),this.yzc,this.WYb,R)}this.WYb=-1;this.stop("Exceeded oldest allowed local revision");
this.aI(Th.a.hql);return!0}V4l(){let R=null,Ba=this.vib();for(;Ba&&!Ba.nia;)R=Ba,Ba=Ba.Bn;return R}iSm(){return this.RXb()?(this.hA.event(1),this.stop("session is lost"),!0):this.uGe()?(this.hA.event(14),va.ULS.sendTraceTag(20029718,od.Xm,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.aI(Th.a.UKd),!0):!1}hof(){const R=this.SWb();return R?R.Lc:null}vib(){const R=this.hof();return R?Object(ig.a)(R.wm):null}oHc(R){return this.Ofk.isEnabled?this.kWa.oHc(R):this.QTj.fXc(R)&&!this.kWa.fXc(R)}BMl(R){return R?
od.aIo:od.tdj}b1d(R,Ba,lb){if(this.Xxi)if(this.Vl&&!this.Vl.isVisible)va.ULS.sendTraceTag(540669727,od.Xm,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.vwd+=1,this.k3g=this.$z();else return this.hA.event(R,{}),this.stop("request failed after kickout interval "+lb),this.atb&&this.atb.execute(Vb=>{Vb.flush(this,2)}),this.aI(Ba),!0;return!1}qIf(R,Ba){const lb=R.StatusCode;return 88===lb||89===lb||236===lb?(Ba.KickoutDiagnostics=this.fvc(),88===
lb?(Ba.Result="deleted DSS session",this.hA.event(18,Ba),this.stop("deleted DSS session"),this.aI(Th.a.localCobaltDeletedSessionFault)):89===lb?(Ba.Result="expired DSS session",this.hA.event(19,Ba),this.stop("expired DSS session"),this.aI(Th.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.$n("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",
!1)&&(R=Ln.b(R.LastSavedRevisionId),this.rpb(R,4)),Ba.Result="DSS session not found",this.hA.event(21,Ba),this.stop("DSS session not found"),this.aI(Th.a.localCobaltSessionNotFound)),!0):14===lb?(this.stop("DSS returned an unspecified failure"),this.aI(Th.a.R0m),!0):104===lb?(this.stop("this operation is disabled on the server"),!0):this.rIf("unrecognized OperationResult: "+lb,Ba)}rIf(R,Ba){if(!this.IPe.contains(R))this.IPe.add(R);else if(this.b1d(11,Th.a.tff,R))return Ba.ConsecutiveErrors=this.NGd,
Ba.Reason=R,va.ULS.sendTraceTag(41997899,od.Xm,15,"DocxSaveMonitor kickout. {0}",Ba),!0;this.Xza(this.qub);return!1}Unm(R,Ba,lb){let Vb=!1;if(R){const zc=this.$z().getTime()-R.creationTime.getTime();zc>=this.tkh&&(Vb=!0,od.fNi(Ba,this.N$l(R,zc,lb)),zc>=this.oHe&&10===this.hA.currentState?(this.hA.event(11,Ba),this.stop("didn't save in time"),this.aI()):(this.hA.event(10,Ba),this.e5i(),this.hlf()))}return Vb}uwk(R){this.sa.addHandler(od.u1i,R)}Uvk(R){this.sa.addHandler(od.olf,R)}X$i(R){this.sa.removeHandler(od.olf,
R)}e5i(){this.sa.raiseEvent(od.u1i)}Jva(R){let Ba;return({group:Ba}=zg.a.S1(R)).returnValue?Ba.Responses[0]:null}N$l(R,Ba,lb){const Vb={};Vb.FirstUnsavedRevisionId=R.id.toString();Vb.FirstUnsavedRevisionLengthToRoot=R.bE;Vb.UnsavedTimeInMs=Ba;Vb.CurrentRevisionId=lb.id.toString();Vb.CurrentRevisionLengthToRoot=lb.bE;return Vb}hlf(){gk.a.ilf(8)}aI(R=Th.a.tff){this.Ihk?this.Weh?(va.ULS.sendTraceTag(509146274,od.Xm,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",R,this.q7h()),
0==this.Mtc&&this.start()):this.Vl&&!this.Vl.isVisible?(va.ULS.sendTraceTag(509146273,od.Xm,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",R,this.q7h()),0==this.Mtc&&this.start()):(this.stop(od.$Wm),R===Th.a.UKd?this.XZ.value.aI(R,Object.assign(new Kk.a,{Wma:4,I_:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,X7:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.XZ.value.aI(R,new Kk.a)):va.ULS.sendTraceTag(19247383,
od.Xm,50,"Kickout disabled")}q7h(){const R={};var Ba=ta.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");R.HasDataloss=!Ba.KU;R.UnSavedRevisionsCount=Ba.XUa;R.OldestUnsavedRevisionCreationTime=Ba.KU?"":Ba.V8b().toString();R.RevisionsWithOutServerRevisionSequenceNumbers=Ba.b5b();R.RevisionsWithServerRevisionSequenceNumbers=Ba.QHd();R.RSNManager_Diagnostics=Ba.VC();if(Ba=ta.a.instance?ta.a.instance.Oa("WordEditor.RunawayDataLossMonitor"):null)R.RunawayDataLossMonitor_Diagnostics=Ba.Xej;
R.DocxSaveMonitor_Diagnostics=this.VC();(Ba=ta.a.instance?ta.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(R.LastSavedToHostDetailsManager_Diagnostics=Ba.VC());this.Vl&&(R.VisibilityState=gg.a[this.Vl.JD]);return R}VC(){const R={};this.Ywb&&(R.ORT=this.Ywb.toISOString());0<this.yzc&&(R.AA=this.yzc);0<this.WYb&&(R.MAA=this.WYb);0<this.vwd&&(R.LSKO=this.k3g.toISOString());this.hA&&0<=this.hA.currentState&&(R.SMS=re[this.hA.currentState]);const Ba={};l.AFrameworkApplication.Bpa&&
(Ba.S=1);eb.App.lostSession&&(Ba.LS=1);this.kf&&(this.kf.Fo&&(Ba.KO=1),this.kf.Sca&&(Ba.TE=1));this.Vl&&(Ba.VS=gg.a[this.Vl.JD]);window.navigator&&(Ba.NW=!window.navigator.onLine);R.AMD=Ba;return R}lYl(){const R={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(R["X-OfficeVersion"]=Xa.a.$C(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(R["X-AccessToken"]=Xa.a.$C(l.AFrameworkApplication.accessToken),R["X-AccessTokenTtl"]=
l.AFrameworkApplication.rua.toString());l.AFrameworkApplication.canary&&(R["X-Key"]=Xa.a.$C(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(R["X-UserType"]=Xa.a.$C(l.AFrameworkApplication.userType));const Ba=l.AFrameworkApplication.He.oZ;Ba&&(R["X-WacCluster"]=Xa.a.$C(Ba));l.AFrameworkApplication.userSessionId&&(R["X-UserSessionId"]=Xa.a.$C(l.AFrameworkApplication.userSessionId));return R}PGl(){var R=this.kf?this.kf.networkState:null;if(1===R||3===R)va.ULS.sendTraceTag(558158790,
od.Xm,15,"Not sending request because we dont have network.");else if(R=this.SWb()){var Ba=new Sys.Net.WebRequest;Ba.set_httpVerb("POST");Ba.set_url(od.serviceUrl);var lb={};lb.body=Lk.b(Wd.a.construct(R));lb.headers=this.lYl();lb.method=Ba.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(Ba.getResolvedUrl(),lb).then(Vb=>{va.ULS.sendTraceTag(561551382,od.Xm,50,"Request succeeded at the HTTP level {0}",Vb.statusText);this.f3g=Vb.status;return Vb.json()},Vb=>{va.ULS.sendTraceTag(561551383,
od.Xm,15,"Request failed at the HTTP level {0}",Vb);return null}).then(Vb=>{Vb=JSON.stringify(Vb);this.NUk(Vb,this.f3g);return Vb},()=>{va.ULS.sendTraceTag(561551385,od.Xm,15,"Request succeeded with null response data");return""}):va.ULS.sendTraceTag(561002076,od.Xm,15,"Browser does not support Fetch.")}catch(Vb){va.ULS.sendTraceTag(561551386,od.Xm,15,String.format("Exception when attempting to get last revision save id : {0}",Vb))}}else va.ULS.sendTraceTag(540079457,od.Xm,15,"Target node is null, not sending last saved revision request.")}NUk(R,
Ba){let lb=wh.a.nil,Vb=!1,zc=-1;Ba===kg.a.$y&&((R=this.Jva(R))?(lb=Ln.b(R.LastSavedRevisionId),R.StatusCode||(Vb=!0,zc=R.StatusCode)):va.ULS.sendTraceTag(561002077,od.Xm,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(od.olf,new Gb(lb,Vb,Ba,zc))}static fNi(R,Ba){for(const lb in Ba)R[lb]=Ba[lb]}dNm(){return Mf.SessionStatusManager.instance.Fo}}od.tdj=0;od.serviceUrl=eb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";od.$Wm="kickout";od.u1i=
"PS";od.olf="FLSR";od.Xm=343;od.vbn=5;od.aIo=5E4;Object(f.a)(od,"DocxSaveMonitor",null,[1831,131]);class Be{igb(R,Ba){return window.setInterval(R,Ba)}Ze(R){window.clearInterval(R)}}Be.instance=new Be;Object(f.a)(Be,"DocxSaveMonitorTaskManager",null,[1830]);class ve{constructor(R){this.eO=0;this.Uta=R}start(R){this.Uta&&(this.eO=R,this.Uta.reset())}log(){if(this.Uta){var R={};R.RequstId=this.eO;R.InvokeCount=this.Uta.NUc;R.InvokeFailedCount=this.Uta.PUc;R.NoOpenConnectionCount=this.Uta.v0c;R.SynchronousNotificationCount=
this.Uta.sad;R.ResponseNotAvailable=this.Uta.N6c;va.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",R)}}}Object(f.a)(ve,"RequestLifeCycleTelemetryManager",null,[1652]);class Wf{constructor(){this.W=this.zQe=null;this.pcl=()=>{var R=l.AFrameworkApplication.K;if(!R.$("DocxSaveMonitorEnabled"))return null;var Ba=R.$("DocxSaveMonitorKickoutEnabled");const lb=R.lc("DocxSaveMonitorIntervalMs",6E4),Vb=R.lc("DocxSaveMonitorFailureIntervalMs",5E3),zc=R.lc("DocxSaveMonitorWarningTimeMs",
12E4),Yc=R.lc("DocxSaveMonitorKickoutTimeMs",36E4),Zd=R.lc("DocxSaveMonitorQueueTimeoutMs",6E4),$e=R.lc("DocxSaveMonitorSentTimeoutMs",12E4),pa=R.lc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Ma=R.$("DocxSaveMonitorTelemetryInfoEnabled");const ya=R.$("DocxSaveMonitorInfoRequestLoggingEnabled");var wa=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Ta=R.$("DocxSaveMonitorRawWebRequestsEnabled")||wa;wa=R.$("ComponentStateLoggingPackageIsEnabled");
R=R.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Bb=l.AFrameworkApplication.He,Qb=Ta?new Fk.a(l.AFrameworkApplication.userSessionId,Bb.oZ,Bb.cPh):null;Qb=new Yk(Bb,Qb,Ta);Ma=Ma&&Bb&&!Ta?new ve(Bb.rea):null;Ta=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Bb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",
3):3;const jc=Vc.create(Ta,Bb);jc.kFc(1);jc.kFc(2);wa=wa?this.W.Ta("Common.IComponentStateLogManager"):null;Ba=new od(lb,Vb,zc,Ba,Yc,Zd,$e,pa,Be.instance,Qb,ta.a.instance.Re("Wonca.KickoutExecutor"),qo.a.instance,this.s$b,()=>!l.AFrameworkApplication.P4d||Qk.a.instance.XUc,()=>eb.App.lostSession,Object(a.a)(Hh.a.instance,Hh.a.instance.Uua,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Lk,()=>new Date,()=>new Date,Ma,ya,jc,this.EKl,wa,R,ta.a.instance.Oa("Common.ISessionStatus")||Mf.SessionStatusManager.instance,
{isEnabled:Ta,maxRetries:Bb});Ba.start();va.ULS.sendTraceTag(5884131,od.Xm,50,"SaveMonitor initialized");return Ba};this.s$b=()=>{const R=eb.App.za.jb.qc;return R?R.ed:null};this.EKl=()=>{const R={};l.AFrameworkApplication.oc&&(R.TM=l.AFrameworkApplication.oc.VC());xm.WoncaApp.IF&&(R.RS=xm.WoncaApp.IF.VC());ui.App.L1&&(R.CRS=ui.App.L1.VC());eb.App.za&&eb.App.za.jb&&eb.App.za.jb.Yc&&eb.App.za.jb.Yc.contentReplicator&&(R.GSR=eb.App.za.jb.Yc.contentReplicator.VC());l.AFrameworkApplication.Bpa&&(R.S=
1);eb.App.lostSession&&(R.LS=1);eb.App.xd&&eb.App.xd.kC.Fo&&(R.KO=1);R.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(R)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(eb.App.ys||eb.App.ym)this.zQe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.zQe&&this.zQe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}wc(R){this.W=R;(eb.App.ys||eb.App.ym)&&R.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.pcl).as("Wonca.IDocxSaveMonitor").ha()}static main(){L.a.instance.Gc(new Wf)}}
Object(f.a)(Wf,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var lg=c(861);class Kh{constructor(R,Ba){this.wn=R;this.T9n=Object(lg.c)(Ba)}async loadChunk(R){return this.wn.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(R):(await this.T9n).aA.loadScript(R)}}Object(f.a)(Kh,"WordOnlineChunksLoader",null,[]);class Vg{constructor(){this.name="WordEditor.EditorAi.Entry"}wc(R){R.ia("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new Kh(l.AFrameworkApplication.K,R.Ta("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){L.a.instance.Gc(new Vg)}}
Object(f.a)(Vg,"EditorAiEntryPackage",null,[1,2]);var Gk=c(995);class wl{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.TKd=R;this.Koi=Ba;this.hvm=lb;this.FYf=Vb;this.FLc=zc;this.nc=Yc;this.CH=Zd;this.Prn=($e,pa,Ma)=>{switch(Ma){case 1:if(!Object(lg.d)(pa)||!this.qL)return 8;this.FLc.Otj();break;case 2:this.FLc.A5e?this.dqj():this.Upb()}return 32};this.Tnn=($e,pa,Ma)=>{2===Ma&&this.FYf.oul().catch(ya=>{va.ULS.VA(508965832,3041,10,ya,"Failed to initialize Copilot integration package")});return 32};this.uXi=
($e,pa)=>{pa.fZ&&(Object(tc.a)("AiMakerInitializationTriggered"),this.TKd.Pda(this.uXi),this.TKd.Nd(),this.FLc.Otj(),this.CH.lk(19,()=>{this.FLc.A5e&&this.dqj()}))};this.Wsn=async($e,pa)=>{pa.fZ&&this.hvm.execute(Ma=>{Ma.findImageAndRegisterHandler()})};this.qL=ui.App.Soe.qL}initialize(){this.TKd.F3(this.uXi);this.TKd.initialize();this.Koi.F3(this.Wsn);this.Koi.initialize();this.nc.fb(gh.a.zHd,zi.a.view,this.Prn,4);this.nc.fb(gh.a.bGi,zi.a.application,this.Tnn,1028)}dqj(){this.FLc.show().catch(R=>
{va.ULS.VA(508965831,3041,10,R,"Failed to show document wizard")})}Upb(){(new Gk.a).m8d(0)}}Object(f.a)(wl,"AiMakerInitializer",null,[]);var el=c(1743),Ki=c(942);class xj extends Ki.a{constructor(R){var Ba;super("BooleanFeatureGateConditionId");this.Al=R.Al;this.r1a=R.r1a;this.defaultValue=null!==(Ba=R.defaultValue)&&void 0!==Ba?Ba:!1}initialize(){super.initialize();const R=l.AFrameworkApplication.K;R.Hn(()=>{const Ba=R.getBooleanFeatureGate(this.r1a,this.defaultValue);this.xg(Ba)})}xg(R){super.xg(R);
va.ULS.sendTraceTag(512369937,3028,50,this.EO(this.Al,R,`featureGate=${this.r1a}`))}}Object(f.a)(xj,"BooleanFeatureGateCondition",Ki.a,[]);var Hk=c(705);class Zh extends Ki.a{constructor(R){super(R.wGh);this.I8f=R}initialize(){super.initialize();l.AFrameworkApplication.K.Hn(()=>{var R,Ba,lb,Vb,zc;const Yc=null!==(Ba=null===(R=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===R?void 0:R.WACDatacenter)&&void 0!==Ba?Ba:"unknown";R=null!==(Vb=null===(lb=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===lb?void 0:lb.Ring)&&void 0!==Vb?Vb:"unknown";lb=null===(zc=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===zc?void 0:zc.Host;zc=this.VUc(Yc,R,lb);this.xg(zc);va.ULS.sendTraceTag(509747520,3028,50,this.EO(this.I8f.Al,zc,`datacenter=${Yc}`))})}VUc(R,Ba,lb){if("1"===Ba||"unknown"===R||this.I8f.eXh.includes(lb))return!0;const Vb=R.toUpperCase();return!this.I8f.GRh.some(zc=>Vb.includes(zc))}}Object(f.a)(Zh,"EditorAiDatacenterCondition",Ki.a,[]);class Ho extends Ki.a{constructor(R,
Ba,lb){super("AiMakerConsentGroupConditionId");this.Al=R;this.qba=Ba;this.defaultValue=lb}initialize(){super.initialize();this.qba.execute(R=>{var Ba;R.isFeatureEnabled("AiMaker",null!==(Ba=this.defaultValue)&&void 0!==Ba?Ba:!1).then(lb=>{this.xg(lb);return null})})}xg(R){super.xg(R);va.ULS.sendTraceTag(509752010,3028,50,this.EO(this.Al,R))}}Object(f.a)(Ho,"AiMakerConsentGroupCondition",Ki.a,[]);class Xh extends Ki.a{constructor(R){super("RegionComposerEnabledConditionId");this.Al=R.Al}initialize(){super.initialize();
this.xg(ui.App.Soe.qL)}xg(R){super.xg(R);va.ULS.sendTraceTag(508965830,3028,50,this.EO(this.Al,R))}}Object(f.a)(Xh,"RegionComposerEnabledCondition",Ki.a,[]);var Mm=c(945),Mn;(function(R){R[R.pyh=0]="bypass";R[R.$yn=1]="passed";R[R.qQi=2]="notPassed"})(Mn||(Mn={}));Object(f.b)("LicenseConditionResult",Mn);class wj extends Ki.a{constructor(R,Ba,lb){super("LicenseConditionId");this.appSettings=Ba;this.O0e=lb;this.Al=R.Al;this.Olb=R.Olb;this.z3b=R.z3b}initialize(){super.initialize();this.appSettings.Hn(()=>
{this.uSo().catch(R=>{va.ULS.VA(508875776,3028,10,R,"Failed to update license condition for {0}",this.Olb)})})}async uSo(){const R=await this.DHc();this.xg(R!==Mn.qQi);this.Wao(R)}async DHc(){return this.p5e()?Mn.pyh:await this.Cxf()?Mn.$yn:Mn.qQi}p5e(){return this.z3b?this.appSettings.getBooleanFeatureGate(this.z3b,!1):!1}async Cxf(){var R=await Object(lg.c)(this.O0e);const Ba=Mm.b.ura();R=await R.isFeatureEnabled(this.Olb,!1);va.ULS.sendTraceTag(508875286,3028,50,"License check for {0} trigger took: {1}ms",
this.Al,Ba.YLc);return R}Wao(R){R=Object.entries({Olb:this.Olb,Xcp:R===Mn.pyh}).map(([Ba,lb])=>`${Ba}=${lb}`).join(", ");va.ULS.sendTraceTag(508875285,3028,50,this.EO(this.Al,this.mia,R))}}Object(f.a)(wj,"LicenseCondition",Ki.a,[]);class cn extends wj{constructor(R,Ba,lb){super({Al:R,Olb:"Copilot",z3b:"Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"},Ba,lb)}}Object(f.a)(cn,"CopilotLicenseCondition",wj,[]);const oh="CH DE FR EU UK NO SE NL PIE".split(" ");class Gl extends Hk.a{constructor(R,
Ba,lb){const Vb=new xj({Al:16,r1a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});R=new el.a(16,R,Ba,{iPb:!0,pP:!1,Nac:!1,Lac:!1,oP:!1});Ba=new Zh({wGh:"AiMakerDocumentWizardDatacenterConditionId",Al:16,GRh:oh,eXh:["Exchange Online Consumer","OneDriveWOPI"]});const zc=new Ho(16,lb),Yc=new Xh({Al:16});lb=new cn(16,l.AFrameworkApplication.K,lb);super(16,new mb.a([Vb,R,Ba,zc,Yc,lb]),null,3028,"AiMakerDocumentWizardTriggered")}}Object(f.a)(Gl,"AiMakerDocumentWizardTriggerModel",Hk.a,[]);var Zk=c(943);
class ym extends Ki.a{constructor(R){super("AiImageInsertedConditionId");this.lfb=R;this.isInitialized=!1;this.URi=()=>{this.xg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.lfb.execute(R=>{var Ba;null===(Ba=R.add_onImageWasInsertedHandler)||void 0===Ba?void 0:Ba.call(R,this.URi)}))}Nd(){this.isInitialized&&(this.lfb.execute(R=>{var Ba;null===(Ba=R.remove_onImageWasInsertedHandler)||void 0===Ba?void 0:Ba.call(R,this.URi)}),this.isInitialized=!1,super.Nd())}}
Object(f.a)(ym,"AiImageInsertedCondition",Ki.a,[]);class Lh extends Hk.a{constructor(R,Ba){const lb=new xj({Al:19,r1a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),Vb=new ym(R),zc=new cn(19,l.AFrameworkApplication.K,Ba);super(19,new mb.a([lb,Vb,zc]),null,3028,"OnTriggerAiImageRemakeEventKey");this.lfb=R;this.qba=Ba;this.aqi=!1;this.ork()}O2a(R){super.O2a(R);super.KBd()&&super.mjb("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==R||this.aqi||(this.aYn(),this.aqi=!0)}ork(){l.AFrameworkApplication.va.fb(gh.a.AHd,
zi.a.view,()=>8,1028)}aYn(){l.AFrameworkApplication.va.Vv(gh.a.AHd,zi.a.view,()=>8)}}Object(f.a)(Lh,"AiImageRemakeTriggerModel",Hk.a,[]);class qk{constructor(R){this.BVf=async()=>{const Ba=await this.kGi.value;await this.YTc(Ba);return Ba};this.gwn=L.a.instance;this.kGi=new Mb.a(R);this.ezm=new Mb.a(this.BVf)}async i4(){await this.kGi.value}async lhb(){return await this.ezm.value}async YTc(R){L.a.instance.Gc(R);return new Promise(Ba=>{this.gwn.registerOnPackageInit(R.name,Ba)})}}Object(f.a)(qk,"LazyLoadedPackage",
null,[]);class Io{constructor(){this.bTh=new qk(()=>Promise.all([c.e(2),c.e(5),c.e(11)]).then(c.bind(null,2083)).then(R=>R.instance));this.U5k=new qk(()=>Promise.all([c.e(2),c.e(5),c.e(29)]).then(c.bind(null,2091)).then(R=>R.instance))}async qul(){await this.bTh.lhb()}async oul(){await this.bTh.lhb();await this.U5k.lhb()}}Object(f.a)(Io,"AiMakerPackageManager",null,[]);var Dq=c(292),Wk={get cql(){var R=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;
if(!R)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return R}};class ur{constructor(R){this.container=R}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(f.a)(ur,"AiMakerDocumentWizardDependenciesImpl",null,[]);class vr{constructor(R,Ba,lb,Vb,zc){this.arg=R;this.FYf=Ba;this.aj=lb;this.qc=Vb;this.b2o=zc;this.kyi=!1;this.fnn=async()=>{this.kyi=!0;await Promise.all([this.FYf.qul(),this.arg.loadChunk("aiMakerDocumentWizardUx")]);return Wk.cql};this.xHj=new Mb.a(this.fnn)}get A5e(){return this.aj.tba(this.qc.ed,{pP:!1,Gca:!1,Toa:!1,oP:!1})}Otj(){this.kyi||this.xHj.value.catch(R=>{va.ULS.VA(508965829,3041,10,R,"Failed to load document wizard UX interop")})}async show(){const R=
await this.xHj.value;this.A5e?(this.Lrh||(this.Lrh=this.jcn(R)),this.Lrh.open()):va.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}jcn(R){const Ba=this.mountApp(R);return Ba?Ba:new Co(this.b2o,()=>this.mountApp(R))}mountApp(R){const Ba=Object(Dq.a)("EditorContainer");return R.mountApp(Ba,new ur(ta.a.instance))}}Object(f.a)(vr,"AiMakerDocumentWizardUx",null,[]);class Co{constructor(R,Ba){this.controller=R;this.won=Ba;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(R){this.controller.isOpen=
R}open(){this.isOpen||(this.isOpen=!0,this.won())}close(){this.isOpen=!1}}Object(f.a)(Co,"AiMakerDocumentWizardCompatAppRef",null,[]);class yt{constructor(){this.isOpen=!1}}Object(f.a)(yt,"AiMakerDocumentWizardControllerImpl",null,[]);class dn extends Zk.a{get name(){return"WordEditor.AiMaker.Entry"}w8(R){this.container=R;R.ia("WordEditor.AiMaker.AiMakerPackageManager",()=>new Io).ha();R.ia("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new yt).ha();R.ia("WordEditor.AiMaker.AiMakerDocumentWizardUx",
()=>new vr(R.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),R.resolve("WordEditor.AiMaker.AiMakerPackageManager"),R.resolve("Box4.IParagraphReader"),eb.App.za.jb.qc,R.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).ha()}y8(){(new wl(new Gl(this.container.resolve("Box4.IParagraphReader"),eb.App.za.jb.qc,this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new Lh(this.container.Ta("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService"),
this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Ta("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),l.AFrameworkApplication.va,Hb.a.get_instance())).initialize()}x8(){}static main(){L.a.instance.Gc(new dn)}}Object(f.a)(dn,"AiMakerEntryPackage",Zk.a,[]);var en={get interop(){var R=aiInserterUx.interop;if(!R)throw Error("aiInserterUx chunk is accessed before loading");
return R}};class gj{constructor(R,Ba){this.O8d=R;this.E7c=Ba;this.oHa=async(lb,Vb)=>{Vb.fZ&&(Object(tc.a)("AiInserterInitializationTriggered"),this.O8d.Pda(this.oHa),this.O8d.Nd(),[,lb]=await Promise.all([this.K0m(),Promise.all([c.e(2),c.e(5),c.e(25)]).then(c.bind(null,2084))]),lb.main(en.interop))}}initialize(){this.O8d.F3(this.oHa);this.O8d.initialize()}async K0m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(lg.c)(this.E7c)).aA.loadScript("aiInserterUx")}}
Object(f.a)(gj,"AiInserterInitializer",null,[]);class Nr extends Ki.a{constructor(R,Ba){super("AiInserterConsentGroupConditionId");this.qba=R;this.defaultValue=Ba}initialize(){super.initialize();this.qba.execute(R=>{R.isFeatureEnabled("AiInserter",!!this.defaultValue).then(Ba=>{this.xg(Ba);return null})})}xg(R){super.xg(R)}}Object(f.a)(Nr,"AiInserterConsentGroupCondition",Ki.a,[]);const Or="CH DE FR EU UK NO SE NL PIE".split(" ");class ji extends Ki.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
l.AFrameworkApplication.K.Hn(()=>{var R,Ba,lb,Vb;const zc=null!==(Ba=null===(R=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===R?void 0:R.WACDatacenter)&&void 0!==Ba?Ba:"unknown";R=null!==(Vb=null===(lb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===lb?void 0:lb.Ring)&&void 0!==Vb?Vb:"unknown";lb=this.VUc(zc,R);this.xg(lb)})}VUc(R,Ba){if("1"===Ba||"unknown"===R)return!0;const lb=R.toUpperCase();return!Or.some(Vb=>lb.includes(Vb))}}Object(f.a)(ji,"AiInserterDatacenterCondition",
Ki.a,[]);class Mk extends Hk.a{constructor(R){const Ba=new xj({Al:17,r1a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"}),lb=new Nr(R),Vb=new ji;R=new cn(17,l.AFrameworkApplication.K,R);super(17,new mb.a([Ba,lb,Vb,R]),null,3028,"AiInserterAppTriggered")}}Object(f.a)(Mk,"AiInserterTriggerModel",Hk.a,[]);class cj extends Zk.a{get name(){return"WordEditor.AiInserter.Entry"}w8(R){this.container=R}y8(){(new gj(new Mk(this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}x8(){}static main(){L.a.instance.Gc(new cj)}}Object(f.a)(cj,"AiInserterEntryPackage",Zk.a,[]);const mm="CH DE FR EU UK NO SE NL PIE".split(" ");class pl extends Hk.a{constructor(R){const Ba=new xj({Al:18,r1a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),lb=new Zh({wGh:"AiRewriteDatacenterConditionId",Al:18,GRh:mm,eXh:["Exchange Online Consumer","OneDriveWOPI"]});R=new cn(18,l.AFrameworkApplication.K,R);super(18,new mb.a([Ba,
lb,R]),null,3028,"AiRewriteTriggered")}}Object(f.a)(pl,"AiRewriteTriggerModel",Hk.a,[]);var Ai={get interop(){var R=null===aiRewriteUx||void 0===aiRewriteUx?void 0:aiRewriteUx.interop;if(!R)throw Error("aiRewriteUx chunk is accessed before loading");return R}};class zm{constructor(R,Ba){this.IBd=R;this.E7c=Ba;this.oHa=async(lb,Vb)=>{Vb.fZ&&(Object(tc.a)("AiRewriteInitializationTriggered"),this.IBd.Pda(this.oHa),this.IBd.Nd(),[,lb]=await Promise.all([this.A_m(),Promise.all([c.e(2),c.e(5),c.e(14)]).then(c.bind(null,
2087))]),lb.main(Ai.interop))}}initialize(){this.IBd.F3(this.oHa);this.IBd.initialize()}async A_m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiRewriteUx"):(await Object(lg.c)(this.E7c)).aA.loadScript("aiRewriteUx")}}Object(f.a)(zm,"AiRewriteInitializer",null,[]);class Tm extends Zk.a{get name(){return"WordEditor.AiRewrite.Entry"}w8(R){this.container=R}y8(){(new zm(new pl(this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}x8(){}static main(){L.a.instance.Gc(new Tm)}}Object(f.a)(Tm,"AiRewriteEntryPackage",Zk.a,[]);var Ip;(function(R){R[R.version0=0]="version0";R[R.version1=1]="version1"})(Ip||(Ip={}));Object(f.b)("FirstRunExperienceVersion",Ip);class fl{get C0e(){return"Word"}get Mzh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Ip.version0}get currentVersion(){return Ip.version1}get FIm(){return fl.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get zdc(){return fl.isEnabled()&&
l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get jCi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get GEl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get GNi(){return 24}get cej(){return 4E3}get h7c(){return""}static isEnabled(){const R=l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==R&&"Automation"!==R}}
Object(f.a)(fl,"FirstRunExperienceLauncherSettings",null,[1683]);class rk{constructor(R){this.pUg=R}Yto(R){this.pUg&&this.pUg.Zto(R)}}Object(f.a)(rk,"FirstRunExperienceManager",null,[1682]);class Ul{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}wc(R){this.W=R;this.W.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new rk(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const R=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");
R&&R.Yto(new fl)}dispose(){}}Object(f.a)(Ul,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class yj{constructor(R,Ba){this.wIa=(lb,Vb,zc,Yc,Zd)=>{var $e,pa;if(1===zc)return Zd=null===(pa=null===($e=Vb.view.mb)||void 0===$e?void 0:$e.hb)||void 0===pa?void 0:pa.lb,(null===Zd||void 0===Zd?0:Zd.VH)||lb===gh.a.V9c&&(null===Zd||void 0===Zd?0:Zd.M3a)?32:8;if(2===zc){$e=this.hbb.gj.isVisible;this.hbb.hC(!0,1===Zd);pa=0;switch(lb){case gh.a.sqj:Zd=1;break;case gh.a.tqj:Zd=2;break;case gh.a.cie:Zd=
2;pa=1;break;case gh.a.die:Zd=1;pa=2;break;case gh.a.V9c:Zd=1;pa=3;break;case gh.a.vle:Zd=this.hbb.N5b;break;default:pa=Zd=0}$e&&lb===gh.a.wIa||this.hbb.xgo(Zd,pa);return 32}return 8};this.FVd=(lb,Vb,zc,Yc,Zd)=>{this.toggleButton(Zd,!1);return this.OYk(zc)};this.vle=(lb,Vb,zc,Yc,Zd)=>this.hbb.gj.isVisible?this.FVd(lb,Vb,zc,Yc,Zd):this.wIa(lb,Vb,zc,Yc,Zd);this.ga=R;this.hbb=Ba}dispose(){this.hbb&&this.hbb.dispose()}Tb(){this.ga.ra(gh.a.vle,zi.a.view,this.vle);this.ga.fb(gh.a.wIa,zi.a.view,this.wIa,
4);this.ga.ra(gh.a.FVd,zi.a.view,this.FVd);this.ga.fb(gh.a.cie,zi.a.view,this.wIa,4);this.ga.ra(gh.a.die,zi.a.view,this.wIa);this.ga.ra(gh.a.V9c,zi.a.view,this.wIa)}OYk(R){if(1===R)return 32;this.hbb.hC(!1);return 32}toggleButton(R,Ba){R&&(R[ci.a.On]=Ba)}}Object(f.a)(yj,"FormatPictureActor",null,[10]);class Xj{constructor(R){this.lzb=!1;this.gj=R}get N5b(){return this.gj.Wel}xgo(R,Ba){switch(R){case 0:case 1:this.gj.Wuo(Ba);break;case 2:this.gj.hvo(Ba)}}hC(R,Ba=!1){this.lzb||this.uAf();R?this.gj.OP(Ba):
this.gj.Loa()}dispose(){this.gj.dispose()}uAf(){this.lzb||(this.gj.initialize(),this.lzb=!0)}}Object(f.a)(Xj,"FormatPictureManager",null,[1832,10]);var nm=c(354),fn=c(155),ep=c(249);class Hl{}Hl.UP=ep.a.IOd;Hl.$gc=1;Hl.ahc=WordEditorIntl.WordEditorStrings.L_FormatPicture;Hl.Fva="FormatPictureTaskPaneData";Object(f.a)(Hl,"FormatPicturePaneConstants",null,[]);class Nq{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=
this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(Nq,"FormatPictureTaskPaneProps",null,[]);class $h{constructor(R,Ba,lb,Vb){this.NQe=0;this.mtc=this.sma=null;this.Xud=this.Oud=this.Kpd=this.sgd=this.qyd=0;this.Rs=this.KVb=!1;this.Mwe=0;this.Hrn=()=>{this.Mjj()};this.Bm=()=>{let zc=!1;zc=this.pJn()||zc;zc=this.t6a()||zc;zc=this.s6a()||zc;zc=this.Yhc()||
zc;(zc=this.lJn()||zc)&&this.Hm()};this.w3=R;this.G8j=Ba;this.lIe=lb;this.gg=Vb}initialize(){this.G_();this.Sja()}get isVisible(){return this.Rs}OP(R){this.c$c(R)}Loa(){this.$da();this.msm()}Wuo(R){this.Vlj(R,1)}hvo(R){this.Vlj(R,2)}Vlj(R,Ba){this.Mwe=Ba;this.NQe=R}get Wel(){return this.Mwe}dispose(){}G_(){this.w3.tOa();this.NQe=this.Mwe=0}get focusManager(){return this.G8j.value}get nc(){return this.lIe.value}w4a(){return!!this.focusManager.currentScope&&this.focusManager.currentScope.name===Hl.UP}Mjj(){this.focusManager.kg(Hl.UP)}Sja(){const R=
this.focusManager.ae(Hl.UP);R.parent=Rf.AFrame.xp;R.cga(this.Hrn)}$da(){this.w4a()&&this.focusManager.kg(this.focusManager.XT)}c$c(R){Fi.UISurfaces.Mu().then(Ba=>{Ba.showTaskPane(Hl.UP,this.vA(R));this.isVisible&&R&&this.focusManager.kg(Hl.UP);return null})}Hm(){Fi.UISurfaces.Mu().then(R=>{R.updateTaskPane(Hl.UP,this.vA(!1));return null})}msm(){Fi.UISurfaces.Mu().then(R=>{R.hideTaskPane(Hl.UP,2);return null})}vA(){const R=new Nq;this.Gno(R);return Object.assign(new ch.a,{title:Hl.ahc,hideHeader:!1,
width:320,location:2,contentProps:R,onOpen:Ba=>{this.Rs=!0;eb.App.za.YZa(this.Bm);eb.App.za.updateCommandUI();this.Mjj();this.gg.L1b(Hl.UP,Ba)},onClose:()=>{this.$da();this.Rs=!1;eb.App.za.Nic(this.Bm);eb.App.za.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}Gno(R){const Ba=F.e().numberFormatInfo;R.section=this.NQe;R.numberFormatInfo="object"===typeof Ba?Ba:null;R.title=this.sma;R.description=this.mtc;R.topCrop=this.qyd;R.bottomCrop=this.sgd;R.leftCrop=
this.Kpd;R.rightCrop=this.Oud;R.rotationAngle=this.Xud;R.onTitleChange=this.onTitleChange();R.onDescriptionChange=this.onDescriptionChange();R.onCropSpinButtonChange=this.onCropSpinButtonChange();R.onRotationSpinButtonChange=this.onRotationSpinButtonChange();R.disabled=this.KVb}onTitleChange(){return R=>{if(R!==this.sma){this.sma=R;var Ba=new nm.DictionaryPropertySet;Ba.setValue(fn.a.Jjb,R);this.nc.Rb(eh.a.D8c,2,Ba);this.Hm()}}}onDescriptionChange(){return R=>{if(R!==this.mtc){var Ba=new nm.DictionaryPropertySet;
Ba.setValue(fn.a.kY,R);this.mtc=R;this.nc.Rb(eh.a.HPb,2,Ba);this.Hm()}}}onCropSpinButtonChange(){return(R,Ba)=>{const lb=new nm.DictionaryPropertySet;switch(Ba){case 0:this.qyd=R;lb.setValue(fn.a.Ojb,R);this.nc.Rb(gh.a.tTc,2,lb);break;case 1:this.sgd=R;lb.setValue(fn.a.Ljb,R);this.nc.Rb(gh.a.mTc,2,lb);break;case 2:this.Kpd=R;lb.setValue(fn.a.Mjb,R);this.nc.Rb(gh.a.nTc,2,lb);break;case 3:this.Oud=R,lb.setValue(fn.a.Njb,R),this.nc.Rb(gh.a.oTc,2,lb)}this.Hm()}}onRotationSpinButtonChange(){return R=>
{this.Xud=R;const Ba=new nm.DictionaryPropertySet;Ba.setValue(fn.a.ATc,0);Ba.setValue(fn.a.DJ,R);this.nc.Rb(eh.a.c9,2,Ba);this.Hm()}}pJn(){const R=2===this.nc.Rb(eh.a.D8c,1,null),Ba=R!==this.KVb;this.KVb=R;return Ba}t6a(){var R=new nm.DictionaryPropertySet;this.nc.Rb(eh.a.t6a,2,R);R=R.ja(fn.a.Jjb,"");const Ba=R!==this.sma;this.sma=R;return Ba}s6a(){var R=new nm.DictionaryPropertySet;this.nc.Rb(eh.a.s6a,2,R);R=R.ja(fn.a.kY,"");const Ba=R!==this.mtc;this.mtc=R;return Ba}Yhc(){var R=new nm.DictionaryPropertySet;
this.nc.Rb(gh.a.j4c,2,R);const Ba=R.ja(fn.a.Ojb,0),lb=R.ja(fn.a.Ljb,0),Vb=R.ja(fn.a.Mjb,0);R=R.ja(fn.a.Njb,0);const zc=Ba!==this.qyd||lb!==this.sgd||Vb!==this.Kpd||R!==this.Oud;this.qyd=Ba;this.sgd=lb;this.Kpd=Vb;this.Oud=R;return zc}lJn(){var R=new nm.DictionaryPropertySet;this.nc.Rb(eh.a.ONb,2,R);R=R.ja(fn.a.DJ,0);const Ba=R!==this.Xud;this.Xud=R;return Ba}}Object(f.a)($h,"ReactFormatPicturePane",null,[1649,10]);class so{constructor(){this.$kd=this.W=null}get name(){return"WordEditor.FormatPicture"}wc(R){this.W=
R;this.W.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new Xj(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.W.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new $h(Jc.a.instance,new Mb.a(()=>Jg.FocusManager.instance()),new Mb.a(()=>l.AFrameworkApplication.va),fm.a.instance)).ha();this.W.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new yj(l.AFrameworkApplication.va,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(ui.App.Uqg||
ui.App.LJj)this.$kd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.$kd.Tb(),eb.App.za.updateCommandUI()}dispose(){this.$kd&&this.$kd.dispose()}static main(){L.a.instance.Gc(new so)}}Object(f.a)(so,"WordEditorFormatPicturePackage",null,[1,2]);var Vn=c(1486),zj=c(515);class Vo extends Go.a{constructor(){super();this.Prompt=0;this.FileId=null}el(){return 100}static construct(R,Ba){const lb=new Vo;lb.FileId=R;lb.Prompt=Ba;return lb}}Object(f.a)(Vo,"GraphMergeConsentChangedRequest",
Go.a,[]);var Il=c(589);class Xp extends Il.a{constructor(){super();this.Location=this.FileId=null}el(){return 34}static construct(R,Ba){const lb=new Xp;lb.FileId=R;lb.Location=Ba;return lb}}Object(f.a)(Xp,"PlayGraphMergeReplayRequest",Il.a,[]);class wr{constructor(R,Ba,lb,Vb,zc,Yc=null,Zd=null){this.fm=!1;this.ZN=null;this.Wdh=this.SGe=!1;this.U8e=()=>{if(this.zAa.qVd)this.SGe=!0;else if(this.SGe=!1,!this.Fco){this.Wdh=!0;var $e=this.nKa.Fya;va.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",
400===$e);if(100===$e||400===$e)$e=Vo.construct(this.pQ(),$e),this.Wv($e)}};this.Wki=($e,pa)=>{pa&&pa.kOf&&pa.kOf.Z$e&&!this.zAa.nCi&&(this.zAa.SCj(),this.zAa.qVd=!0,this.Wv(pa.kOf.Z$e))};this.Uki=($e,pa)=>{pa&&pa.Ddd&&this.zAa.SCj()};this.Vki=($e,pa)=>{pa&&(pa.ShowMergePrompt&&this.nKa.Zbj(this.U8e),l.AFrameworkApplication.Kg&&(l.AFrameworkApplication.Kg.SessionMergeInfo|=pa.PartMergeInfo))};this.pQ=R;this.Kzd=lb;this.zAa=Vb;this.nKa=zc;this.Kzd&&this.Kzd.Zvk(this.Wki);this.e3=Yc||qo.a.instance;
if(!Zd){const $e=new zj.a;Zd=pa=>$e.sha(0,pa)}this.vVj=Zd}get mVm(){return this.SGe}get Fco(){return this.Wdh}Wv(R){const Ba=new jk.a;Ba.Gq=R;Ba.status=1;Ba.QG="GraphMerge";const lb=this.vVj(()=>{this.M6c(Ba,33===R.el())});lb.BH(Ba);lb.$T()}M6c(R,Ba){this.fm||(Ba&&(this.zAa.qVd=!1),2===R.statusCode&&!Na.a.$Ib(R.Hj)&&1===R.Hj.length&&R.Hj[0]?(R=R.Hj[0],R.StatusCode?this.zAa.Scg():Ba&&this.nKa.Zbj(this.U8e),this.e3.bVa(R),this.mVm&&this.U8e()):this.zAa.Scg())}nSa(R){this.ZN=R;this.ZN.oFc(this.Uki);
this.ZN.pFc(this.Vki)}dispose(){this.fm||(this.Kzd&&this.Kzd.b_n(this.Wki),this.ZN&&(this.ZN.Mic(this.Uki),this.ZN.Qce(this.Vki)),this.fm=!0)}}Object(f.a)(wr,"GraphMergeBackupManager",null,[1774,10]);class xl{constructor(R,Ba=null,lb=null,Vb=null){this.rte=0;this.NFe=!1;this.q2g=new Date(0);this.qVd=!1;this.nKa=R;this.$z=Ba||(()=>new Date);lb||(lb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.lc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.u$j=lb;Vb||(Vb=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.lc("WordEditorGraphMergeMaxBackups",1):1);this.f5g=Vb}get VTm(){return+this.$z()-+this.q2g<this.u$j}get nCi(){return 500===this.nKa.Fya?!1:100===this.nKa.Fya?!0:this.NFe||this.qVd||this.VTm}SCj(){this.q2g=this.$z();this.rte++;this.rte>=this.f5g&&this.Scg()}Scg(){this.NFe||(this.NFe=!0,va.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.rte,this.f5g))}}Object(f.a)(xl,"GraphMergeBackupThrottler",
null,[1773]);class cs{constructor(R,Ba,lb=null){this.xWg=!1;this.u6=R;this.Q0j=Ba;null==lb&&(lb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.hOe=lb?500:300}get Fya(){return this.hOe}Zbj(R){if(!this.xWg&&300===this.Fya){var Ba=this.Q0j.value;Ba&&Ba.isFeatureEnabled(53)&&(this.xWg=!0,this.u6.execute(lb=>{lb.iuo(()=>{this.B2k(R)},()=>{this.consentDenied(R)})}))}}consentDenied(R){300===this.Fya&&(va.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),
this.hOe=100,R());this.p9i()}B2k(R){300===this.Fya&&(va.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.hOe=400,R());this.p9i()}p9i(){this.u6.execute(R=>{R.gsm()})}}Object(f.a)(cs,"GraphMergeCollectionConsentManager",null,[1675]);class sp extends Sys.EventArgs{constructor(R){super();this.kOf=R}}Object(f.a)(sp,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var jq=c(832),Oq=c(880),Jo=c(1051),Zi=c(620),yn=c(1778),to=c(1776),zn=c(224),uo=c(179);class Ik{constructor(R,
Ba,lb,Vb,zc,Yc){this.w2f=this.mg=null;this.yXc=this.zqg=!1;this.Xk=null;this.K9c=R.runtime.K9c;this.pq=R;this.Vd=Ba;this.Jg=lb;this.An=Vb;this.n2k=zc;this.graphNodeComplexMerge=Yc}}Object(f.a)(Ik,"GraphNodeComplexMergeState",null,[]);var tp=c(1559),Os=c(1542);class Nn{constructor(R,Ba=null){this.Og=R;this.JYb=Ba||this.mQc()}get omb(){return this.JYb}get Vd(){return this.Og}mQc(){return[Object(a.a)(this,this.Hwo,"simpleMerge"),Object(a.a)(this,this.B1k,"complexMerge")]}Mno(R,Ba,lb,Vb,zc,Yc){Ba=new Ik(R,
lb,new Mb.a(()=>new tp.a(Vb?Vb.zm:null,zc)),new Mb.a(()=>new tp.a(Vb?Vb.zm:null,Yc)),new Mb.a(()=>new tp.a(Yc,zc)),Ba.JKh(zc,()=>R.runtime.Zb));Ba.mg=Vb.I0b;Ba.w2f=new zn.a;return Ba}merge(R,Ba,lb,Vb,zc,Yc){Ba=this.Mno(R,Ba,lb,Vb,zc,Yc);lb=!0;for(Vb=0;Vb<this.omb.length&&lb;Vb++)(lb=(0,this.omb[Vb])(Ba))||R.logger.y2d("GraphNodeMerge.GetMergeFunctions()",Vb);if(R=Ba.yXc&&Ba.Xk?new Os.a(Ba.Xk,!1):null)switch(R.emo(Ba.mg),(R?R.zm:zc).Nc){case 1074135145:Ba.pq.runtime.Sbe.L3k.Z(R.zm.id,R.zm);break;case 1074135153:Ba.pq.runtime.Sbe.EJk.Z(R.zm.id,
R.zm);break;case 1074135127:Ba.pq.runtime.Sbe.v0k.Z(R.zm.id,R.zm);break;case 393230:Ba.pq.runtime.R3d.add(R.zm.id)}return{returnValue:Ba.yXc,Xk:R}}Hwo(R){if(R.pq.runtime.Zb&&R.pq.runtime.Zb.gjb(1000005)&&0<R.mg.count)return!0;var Ba=R.graphNodeComplexMerge.dae;return R.An.value.wVc(Ba)&&R.n2k.value.wVc(Ba)?R.Jg.value.wVc(Ba)?!0:(Ba=R.An.value.tf,R.yXc=!0,R.Xk=Ba.UK(),!1):(R.yXc=!0,!1)}B1k(R){const Ba=R.An.value.tf;R.K9c&&uo.a.instance.Ua(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
Ba.id,Ba.Nc);const lb=R.graphNodeComplexMerge.Dmg(R);R.yXc=lb;uo.a.instance.Ua(4018184,1,lb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",lb?"Succeeded":"Failed",Ba.id,Ba.Nc,!!R.Xk);return lb}}Object(f.a)(Nn,"GraphNodeMerge",null,[1806]);class ds extends Go.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}el(){return 33}static construct(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya){const wa=new ds;wa.FileId=R;wa.BaseRevisions=Ba;wa.TheirRevisions=lb;wa.YourRevisions=Vb;wa.IgnoreConflictsInLastServerRevision=zc;wa.MergeHint=Yc;wa.ObjectSpaceId=Zd?Ln.a(Zd):null;wa.RequestId=$e?Ln.a($e):null;wa.Source=pa;wa.Reason=Ma;wa.Prompt=ya;return wa}}Object(f.a)(ds,"CreateGraphMergeReplayRequest",Go.a,[]);var Eq=c(820),lk=c(237),Yj=c(16),Jp=c(1886),es=c(1979);class fp{constructor(R,
Ba=null,lb=null){this.cpl=(Vb,zc)=>{let Yc=Vb;var Zd=zc,$e=this.dcb.get(Vb);if(!$e)return{WHa:Yc,QOb:Zd};Zd=new zn.a;Zd.add($e);var pa=this.Hwb.get(Vb)||this.LF.J(Vb);$e=new zn.a;$e.add(pa);pa=new zn.a;pa.add(this.LF.J(Vb));va.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.sH.Avf,this.sH.Fia,this.Hai($e),this.Hai(Zd));var Ma=this.$ai(this.sH.Fia);this.bEl(Ma,Vb,Zd);$e=new Jp.a(Ma,pa,1===Ma.input.Fia?
$e:Zd,1===Ma.input.Fia?Zd:$e,this.$ai(1),$e,Zd);Zd=new zn.a;for(pa=0;pa<zc.length;pa++){this.sH.YG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const ya=({U6a:Yc,Sqa:Ma}=$e.qcd(Vb,zc.J(pa))).returnValue;Zd.add(Ma);ya?va.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Vb,zc.J(pa),Yc,Ma):va.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Vb)}return{WHa:Yc,QOb:Zd}};this.sH=R;this.LF=R.sk;this.dcb=R.bHo;this.Hwb=R.e6o;this.r9j=R.Q0m;this.Og=Ba||new Jo.a;this.Sck=lb||this.cpl}yLc(R){const Ba=new zn.a;for(let lb=0;lb<R.length;lb++){const Vb=this.Vol(R.J(lb));Ba.add(Vb)}return Ba}xLc(R,Ba,lb){const Vb=R.xu===R.Az&&R.startCp===R.endCp;Ba&&({WHa:R.xu,Sqa:R.startCp}=this.eVa(R.xu,R.startCp,R.xu),Vb&&(R.Az=R.xu,R.endCp=R.startCp));lb&&!Vb&&({WHa:R.Az,Sqa:R.endCp}=this.eVa(R.Az,R.endCp,R.Az));return R}Vol(R){if(R.xu===R.Az){var Ba=new zn.a;
Ba.add(R.startCp);Ba.add(R.endCp);({WHa:R,QOb:Ba}=this.Nog(R.xu,Ba));return new Eq.a(R,Ba.J(0),R,Ba.J(1))}Ba=new zn.a;var lb=new zn.a;let Vb;Ba.add(R.startCp);({WHa:Ba,QOb:Vb}=this.Nog(R.xu,Ba));lb.add(R.endCp);({WHa:R,QOb:lb}=this.Nog(R.Az,lb));return new Eq.a(Ba,Vb.J(0),R,lb.J(0))}Nog(R,Ba){let lb=R,Vb=Ba;if(!this.LF.J(R))return va.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",R),{WHa:lb,
QOb:Vb};if(this.dcb.get(R))({WHa:lb,QOb:Vb}=this.Sck(R,Ba,lb,Vb));else if(this.sH.Jzf&&!this.sH.Jzf.J(this.sH.Jzf.length-1).M4(R)){Vb=new zn.a;for(let zc=0;zc<Ba.length;zc++){let Yc;({WHa:lb,Sqa:Yc}=this.eVa(R,Ba.J(zc),lb));Vb.add(Yc)}}return{WHa:lb,QOb:Vb}}Hai(R){let Ba="";R.forEach(lb=>{Ba+=lb.Yad();Ba+=" ";return!0});return Ba}$ai(R){const Ba=ta.a.instance.Oa("Box4.IFeatureHelper"),lb=new es.a;lb.input.source=this.sH.Avf;lb.input.Fia=this.sH.Fia;lb.input.hNc=()=>Ba;lb.runtime.sk=this.LF;lb.runtime.DDa=
this.sH.Y0k;1===R?(lb.runtime.Ku=this.Hwb,lb.runtime.Kq=this.dcb,lb.runtime.cNd=this.sH.jEi,lb.runtime.Nme=this.sH.AEi):2===R&&(lb.runtime.Ku=this.dcb,lb.runtime.Kq=this.Hwb,lb.runtime.cNd=this.sH.AEi,lb.runtime.Nme=this.sH.jEi);lb.runtime.Zb=Ba;return lb}bEl(R,Ba,lb){if(R.runtime.Ku.nb(lk.a.ML)){var Vb=R.runtime.Ku.J(lk.a.ML);Vb=this.Og.getPropertyObjectIds(Vb,kl.a.W1);if(1===Vb.length&&(Vb=Vb.J(0),R.runtime.Ku.nb(Vb)&&(Vb=R.runtime.Ku.J(Vb),3===this.Og.getPropertyInt32(Vb,kl.a.nrb)))){const zc=
this.Og.getPropertyString(Vb,kl.a.rka),Yc=this.Og.getPropertyString(Vb,kl.a.kSb);Ba.toString()===zc&&zc===Yc&&(Ba=this.Og.getPropertyObjectId(Vb,kl.a.tcd),R.runtime.Ku.nb(Ba)&&lb.add(R.runtime.Ku.J(Ba)))}}}J6l(R,Ba){let lb=0;for(let Vb=0;Vb<R.length;Vb++)if(Ba.equals(R.J(Vb)))return lb=Vb,{returnValue:!0,idx:lb};return{returnValue:!1,idx:lb}}eVa(R,Ba){const lb=this.r9j&&!!this.Hwb.J(R)&&!this.LF.J(R);let Vb=R,zc=Ba,Yc=!1,Zd=!1;(lb?this.Hwb:this.dcb).forEach(($e,pa)=>{this.sH.YG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.rFf(pa.Nc)&&this.LF.J($e)){pa=null;if(lb){pa=this.HQc(ya=>this.Hwb.J(ya)||this.LF.J(ya),$e);var Ma=this.g_d(pa,R)}else Ma=this.HQc(ya=>this.LF.J(ya),$e),Ma=this.g_d(Ma,R);if(Ma&&(Zd=!0,pa||(pa=this.HQc(ya=>this.Hwb.J(ya)||this.LF.J(ya),$e)),$e=this.HQc(ya=>this.dcb.J(ya)||this.LF.J(ya),$e),Ma=0,({idx:Ma}=this.J6l(pa,R)).returnValue)){for(let ya=Ma+1;ya<pa.length;ya++)if(this.g_d($e,pa.J(ya)))return zc=0,Vb=pa.J(ya),Yc=!0,!1;for(--Ma;0<=Ma;Ma--)if(this.g_d($e,pa.J(Ma)))return zc=Number.MAX_VALUE,
Vb=pa.J(Ma),Yc=!0,!1}}return!0});Yc||(va.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",R,Ba,lb,Zd),5===this.sH.Avf&&(va.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Vb),({u_h:Ba}=this.vWl()).returnValue?(Vb=Ba,zc=0,va.ULS.sendTraceTag(17340241,
318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Vb)):va.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Vb)));return{WHa:Vb,Sqa:zc}}vWl(){let R=wh.a.nil,Ba=new zn.a;this.dcb.forEach((lb,Vb)=>{this.sH.YG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.rFf(Vb.Nc)?(Ba=this.HQc(zc=>this.dcb.J(zc)||this.LF.J(zc),lb),!1):!0});return 0<Ba.length?(R=Ba.J(0),{returnValue:!0,u_h:R}):{returnValue:!1,u_h:R}}rFf(R){return 393241===R||393250===R||393251===R||393252===R}HQc(R,Ba){var lb=R(Ba);Ba=new zn.a;if(!this.rFf(lb.Nc))return Ba;lb=this.Og.getPropertyObjectIds(lb,Yj.a.$e);for(let Vb=0;Vb<lb.length;Vb++){const zc=new zn.a;this.Wrf(R,lb.J(Vb),zc);Ba.aD(Ba.length,zc)}return Ba}Wrf(R,Ba,lb){var Vb=R(Ba);if(Vb)if(393230===Vb.Nc)lb.add(Ba);else if(393229===
Vb.Nc)Ba=this.Og.getPropertyObjectIds(Vb,Yj.a.XK).Zf(0),this.Wrf(R,Ba,lb);else if(393250===Vb.Nc||393251===Vb.Nc||393252===Vb.Nc)for(Ba=this.Og.getPropertyObjectIds(Vb,Yj.a.$e),Vb=0;Vb<Ba.length;Vb++)this.Wrf(R,Ba.J(Vb),lb)}g_d(R,Ba){for(let lb=0;lb<R.length;lb++)if(Ba.equals(R.J(lb)))return!0;return!1}}Object(f.a)(fp,"GraphMergeSelectionRecordUpdater",null,[]);class Hn extends yn.a{constructor(R=null,Ba=null,lb=null,Vb=null,zc=null,Yc=null,Zd=null,$e=null,pa=null,Ma=null,ya=null){var wa;super();
this.nMh=Ta=>{const Bb=Ta.iX,Qb=eb.App.za.jb.Yc;return new jq.a(Ta,Bb,Qb.vd,Qb.fileId,Qb.xob,Qb.contextId,Bb?Bb.id:wh.a.nil,this.Vde,!1,!0)};this.pQ=R||(()=>l.AFrameworkApplication.rootQuerySignature);Ba||(Ba=Ta=>new Oq.a(Ta));this.zch=Ba;this.Og=lb||new Jo.a;this.hNg=Zd||new to.ChildNodeListMerge(this.Vd);this.XZb=$e;this.Vde||(this.XZb=(Ta,Bb,Qb)=>new Zi.a(Ta,Bb,Qb));this.JYb=Vb||this.mQc();this.Rab=zc||new hq.a;this.eWg=Yc||new Nn(this.Vd);this.m5g=(null===(wa=l.AFrameworkApplication.K)||void 0===
wa?void 0:wa.lc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.zAa=pa;this.nKa=Ma;this.EUd=this.Skl(ya);this.CTg=()=>ta.a.instance.Oa("Box4.IFeatureHelper")}Skl(R){R||(R=l.AFrameworkApplication.K?l.AFrameworkApplication.K.lc("WordEditorGraphMergeBackupCasesBrowser",0):0);return R}VEa(){return(new Date).getTime()}Juj(R,...Ba){return String.format.apply(null,[R].concat(Ba))}yHo(R){throw Id.a.invalidOperation(R);}EQd(R){return String.format("Name: {0}, Message: {1}, Stack: {2}",R.name,R.message,
R.stack)}GDn(R){if(this.zAa&&this.zAa.nCi||!this.fDo(R))return null;this.R3m(R);let Ba;({UHk:Vb,aHo:zc,d6o:Ba}=this.ycl(R,this.nMh));const lb=yn.a.IXl(R);var Vb=ds.construct(this.pQ(),Vb.Nza(),zc.Nza(),Ba.Nza(),R.input.HHb,R.input.Fia,R.input.Am,R.input.eLb,R.input.source,lb,this.nKa.Fya);var zc=R.output.ZM;3===lb&&0<zc.length&&(Vb.MergedRevision=this.nMh(R.output.ZM.last()));return Vb}yLc(R,Ba){return(new fp(R)).yLc(Ba)}xLc(R,Ba,lb,Vb){return(new fp(R)).xLc(Ba,lb,Vb)}}Object(f.a)(Hn,"GraphMerger",
yn.a,[]);class An extends Hn{constructor(R,Ba=null,lb=null){super(R,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ba,lb);this.sa=new N.a}get Fya(){return this.nKa?this.nKa.Fya:0}get delayedMergeOperation(){return null}set delayedMergeOperation(R){}Zvk(R){this.sa.addHandler(An.zvf,R)}b_n(R){this.sa.removeHandler(An.zvf,R)}Reg(){return!1}jfc(R,Ba,lb,Vb,zc,Yc,Zd){(R=super.jfc(R,Ba,lb,Vb,zc,Yc,Zd))&&this.sa.raiseEvent(An.zvf,new sp(R));return R}}An.zvf="GMC";Object(f.a)(An,"WordEditorGraphMerger",
Hn,[1676,1364,1365]);class Pq{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}wc(R){this.W=R;this.W.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new cs(this.W.Ta("WordEditor.IBusinessBarController"),new Mb.a(()=>R.Oa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new xl(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();
this.W.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new An(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new wr(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){eb.App.nS||(eb.App.nS=Vn.a.n8());const R=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");eb.App.nS.NIk(R);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let R=this.W.Oa("Box4.IGraphMergeBackupManager");R&&R.dispose()}}Object(f.a)(Pq,"GraphMergePackage",null,[1,2]);var Yp=c(284);class Kp{constructor(R){this.Ave=
"FontPicker";this.qFe=null;this.R9a=R;this.mkd=this.R9a.Rya(Yp.a.qKb,Object(a.a)(this,this.mEb,"featureStateChangeCallback"));this.R9a.isFeatureEnabled(Yp.a.qKb,!1).then(Ba=>{this.qFe=Ba})}get isLicensed(){return this.qFe}mEb(R){this.qFe=R.isEnabled;R=appChrome.actions.updateFontPickerLicenseState(this.Ave,R.isEnabled);appChrome.api.dispatch(R)}dispose(){this.R9a.Fic(Yp.a.qKb,this.mkd)}}Object(f.a)(Kp,"ModernFontPickerFeatureHelper",null,[1074,10]);var On=c(478),hi=c(650),mk=c(1677);class ps{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(ps,"FontInfoTaskPaneProps",null,[]);class xr{constructor(R,Ba,lb,Vb=null){this.CVe=this.jW=this.mkd=null;this._state=this.gYb=0;this.lIe=R;this.R9a=Ba;this.tVj=lb;this.Vb=Vb}get nc(){return this.lIe.value}initialize(){this.nc.ra(m.a.C8f,y.a.frame,Object(a.a)(this,this.C8f,"requestFontInfo"));this.mkd=this.R9a.Rya(Yp.a.qKb,Object(a.a)(this,this.mEb,
"featureStateChangeCallback"));this.Sja()}OP(R=!1){const Ba=Fi.UISurfaces.Mu(),lb=this.R9a.isFeatureEnabled(Yp.a.qKb,!1),Vb=[];Vb.push(Ba);Vb.push(lb);Promise.all(Vb).then(zc=>{zc[0].showTaskPane(mk.a.LEb,this.vA(zc[1]));R&&this.fK()})}TVo(R){Fi.UISurfaces.Mu().then(Ba=>{Ba.updateTaskPane(mk.a.LEb,this.vA(R));return null})}mEb(R){this.TVo(R.isEnabled)}C8f(R,Ba,lb,Vb,zc){this.jW=zc.CommandValueId;this.CVe=zc.Trigger;this.gYb=zc.InputMethod;this.OP(2===this._state&&1===this.gYb);return 32}vA(R){const Ba=
new ps;Ba.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");Ba.fontName=this.jW;Ba.isLicensed=R;Ba.trigger=this.CVe;Ba.helpArticleUrl=this.O2k();Ba.paneId=mk.a.LEb;R=this.Dxm();R.contentProps=Ba;return R}Dxm(){return Object.assign(new ch.a,{title:mk.a.ahc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}Sja(){if(this.Vb){var R=this.Vb.ae(mk.a.LEb);R.parent=Rf.AFrame.xp;R.$H=!0}}onOpen(){this._state=2;this.fK()}onShow(R){0!==this._state&&(this._state=2,1===R&&(this.gYb=R),this.fK())}onClose(){this.gYb=this._state=0;this.blur()}onHide(){this._state=1;this.gYb=0}fK(){this.Vb&&1===this.gYb&&this.Vb.kg(mk.a.LEb)}blur(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===mk.a.LEb&&this.Vb.kg(this.Vb.XT)}onUpsellButtonClicked(){this.R9a.launchUpsellExperience(mk.a.experienceId)}dispose(){this.R9a.Fic(Yp.a.qKb,
this.mkd)}O2k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.tVj,this.BYl(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}BYl(){switch(this.CVe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return xr.jLk(this.jW)}static jLk(R){let Ba="hlpFontInfo";for(let lb=0;lb<R.length;++lb){const Vb=Xa.a.charAt(R,
lb);if(255<R.charCodeAt(lb)||Xa.a.bYd(Vb))Ba+=Vb}return Ba}}Object(f.a)(xr,"FontInfoPane",null,[949,10]);class Zj extends xr{constructor(R,Ba,lb,Vb,zc){super(R,Ba,Vb.kb("FontInfoHelpBaseUrl"),zc);this.w3=lb}OP(R){this.G_();super.OP(R)}mEb(R){super.mEb(R);eb.App.za.updateCommandUI()}G_(){this.w3.tOa()}}Object(f.a)(Zj,"WordEditorFontInfoPane",xr,[]);class Ko{constructor(){this.GWb=this.Aqd=this.Uuc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}wc(R){this.W=R;R.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Kp(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();R.ia("Common.ModernFontPicker.IFontInfoPane",()=>new Zj(new Mb.a(()=>l.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Jc.a.instance,l.AFrameworkApplication.K,Jg.FocusManager.instance())).ha()}init(){this.Aqd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Uuc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.Uuc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.GWb=this.W.Oa(hi.a))?this.GWb.initialize():va.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));eb.App.za.updateCommandUI()}dispose(){this.Uuc&&(this.Uuc.dispose(),this.Uuc=null);this.Aqd&&(this.Aqd.dispose(),this.Aqd=null);this.GWb&&(this.GWb.tDa(),this.GWb=null)}static main(){Object(On.a)()&&L.a.instance.Gc(new Ko)}}Object(f.a)(Ko,"ModernFontPickerPackage",null,[1,2]);var Qq=c(133),Wn=c(5),
gr=c(251),gl=c(36),kn=c(1110);class yl{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,wa=null){this.uZ=lb;this.Zc=R;this.Kc=Ba;this.mh=zc;this.WJa=Yc;this.UV=Zd;this.NMg=$e;this.MMg=pa;this.gy=Ma;this.SYj=wa||yl.rw}get fh(){return this.gy?this.gy.fh:!1}Uqi(R){return this.LFa(R,0)}KAm(R){return this.LFa(R,1)}LFa(R,Ba){let lb=null;if(this.fh&&this.UV&&(this.MMg.instance&&this.MMg.instance.jJa(R),Ba?1===Ba&&(lb=this.UV.Lai(R.node)):lb=this.UV.eof(R.node,R.cpBegin,R.Fb),lb&&!lb.ja(kl.a.k9,!1)))return va.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Vb=Wn.GraphIterator.JX(this.Zc.yk());Vb.set(R.node);Vb.zb(10);const zc=this.Kc.Pc(15);zc.Qt(Vb);Ba?gl.OutlineElementNavigator.Wd(Vb):(this.eqb(Vb,R),this.uZ.Mnc(R.node,ce.a.Ls));R=Kj.ParagraphReader.fl(Vb.currentNode);this.aCm(Vb);this.fh&&lb&&this.NMg&&(Ba=new mb.a,Ba.add(Vb.currentNode),this.NMg.Amh(Ba,lb.id));this.tho(R);zc.dispose();return 32}tho(R){R=me.SelectionFactory.ne(R,0);Ah.a.instance.Bc(R)}aCm(R){this.mh.Iz(R,
!0,!0,null,!1,!1);R=gl.OutlineElementNavigator.Ce(R);this.LAm(R)}eqb(R,Ba){const lb=gl.OutlineElementNavigator.Wd(R);if(Ba.cpBegin||this.fh&&(!this.fh||-1!==Ba.Fb)){eb.App.xd.So&&Ba.cpBegin!==Kj.ParagraphReader.textLength(Ba.node)&&eb.App.xd.Yp.$F(Ba.node);this.mh.Iz(R,!1,!0,null,!1,!0);var Vb=Wn.GraphIterator.JX(this.Zc.yk());Vb.set(lb);this.mh.G$(Vb,R,Ba,!0,!0,!0)}}LAm(R){R=this.SYj(R);this.WJa.sri(R)}static bF(){return new yl(new ti.a,new Wj.a,ta.a.instance.resolve("Box4.IAutoCorrectScheduler"),
kn.a.instance,ta.a.instance.resolve("Box4.IOutlineElementEditor"),ta.a.instance.resolve("Box4.IBlobEditor"),ta.a.instance.Oa("Box4.IContentControlReader"),ta.a.instance.Oa("Box4.IContentControlEditor"),ta.a.instance.Ta("Box4.IContentControlConverter"),ta.a.instance.Oa("Box4.ContentControlConfigSettings"),ta.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=yl.hBg?yl.hBg:yl.hBg=yl.bF()}static rw(R){return kf.a.rw(R)}}Object(f.a)(yl,"PageBreakInserter",null,[1712]);class Lo{constructor(R,
Ba,lb,Vb,zc,Yc,Zd,$e){this.dCm=(pa,Ma,ya,wa)=>{var Ta=Ma.view,Bb=Ta.mb.ng;if(!Bb)return 2;if(!this.t6e(Ma))return 8;if(1===ya)return 32;let Qb=!0;ya=8;const jc=this.rGe(Bb);Bb=this.Kc.Pc(15);Bb.Db(Ta.ed);Bb.Qj=pa;jc||(ya=this.ga.Kf(Ma,eh.a.Cna,2,!0,wa,null),pa=32===ya,va.ULS.shipAssertTag(4208012,314,pa),Qb=pa);Qb&&(Ta=Ta.mb.ng,pa=this.rGe(Ta),va.ULS.shipAssertTag(4208013,314,pa,"{0}",{["ContextId"]:Ma.contextId}),ya=8,pa&&(ya=this.eEe.Uqi(Ta),va.ULS.shipAssertTag(4208014,314,32===ya)));Bb.dispose();
32===ya&&this.Ud.Us(10);return ya};this.cCm=(pa,Ma,ya)=>{if(!Ma||Ma.contextId!==zi.a.Tc)return 8;if(1===ya)return Ma.contextId===zi.a.Tc?32:8;if(2===ya){if(!this.t6e(Ma))return 8;pa=this.eEe.Uqi(Ma);32===pa&&this.Ud.Us(10);return pa}return 32};this.bCm=(pa,Ma,ya)=>{if(!Ma||Ma.contextId!==zi.a.table)return 8;if(1===ya)return 32;if(2===ya){if(!this.t6e(Ma))return 8;pa=this.eEe.KAm(Ma);32===pa&&this.Ud.Us(10);return pa}return 32};this.ga=R;this.eEe=Ba;this.Kc=lb;this.Zm=Vb;this.rGe=zc;this.Ik=Yc;this.R6j=
Zd;this.Ud=$e}Tb(){this.ga.ra(gh.a.LFa,zi.a.view,this.dCm);this.ga.ra(gh.a.LFa,zi.a.Tc,this.cCm);this.ga.ra(gh.a.LFa,zi.a.table,this.bCm);this.ga.Xc(gh.a.LFa,4)}u5(){const R=Jg.FocusManager.instance().ae(Qq.AppFrame.PD);Rf.AFrame.Bi(R,bf.KeyInputManager.ic(ce.a.Ls,bf.KeyInputManager.Ph),gh.a.LFa)}XMm(R){return this.hx(R.iterator)}CQm(R){R=R.J(0);const Ba=Ge.SelectionEditor.Fj(R,!0,!1);if(this.hx(Ba.Pa.iterator))return!0;R=Ge.SelectionEditor.Fj(R,!1,!1);return this.hx(R.Pa.iterator)}hx(R){return R.zb(14)}t6e(R){let Ba=
null,lb=R;if(lb.contextId===zi.a.view){Ba=lb.view;if(!Ba.features.Uig)return!1;lb=Ba.mb.ng;if(!lb)return!1}else{const Vb=Wn.GraphIterator.eb(lb.node);if(Vb.zb(36)||Vb.zb(38)||Vb.zb(40)||Vb.zb(14))return!1}return gr.a.eia(R)?!1:lb.contextId===zi.a.table?this.Ik.HMm(lb.node):!this.Ik.FMm(lb)||this.Zm&&this.Zm.instance&&this.Zm.instance.EU(lb)?!1:((R=this.rGe(lb))?this.XMm(lb):this.CQm(Ba.mb.hb))||R&&this.R6j(lb,!0)?!1:!0}static bF(){return new Lo(l.AFrameworkApplication.va,yl.instance,new Wj.a,ta.a.instance.Ta("Box4.IExternalSelectionManager"),
Ge.SelectionEditor.ef,Mq.a.instance,Xe.a.vxa,ta.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=Lo.aAg?Lo.aAg:Lo.aAg=Lo.bF()}}Object(f.a)(Lo,"PageBreakActor",null,[1677]);class Lp{constructor(){this.rMe=this.W=null}get name(){return"WordEditor.PageBreak"}wc(R){this.W=R}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}sn(){this.rMe=Lo.instance;this.rMe.Tb();this.rMe.u5();eb.App.za.updateCommandUI()}dispose(){}}
Object(f.a)(Lp,"PackageManager",null,[1,2]);var up=c(1488),Gm=c(1489),ql=c(273),ln=c(175),eo=c(250),om=c(277),Bn=c(444);class $k{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.Dxb=null;this.sa=new N.a;this.Rwe=1;this.opd=-1;this.fYa=null;this.kqa=()=>{this.Y4e()};this.ib=Ba;this.Ib=lb;this.pjd=Vb;this.fM=zc;this.fz=Yc;this.Pfa=Zd;this.enable()}get YId(){return this.Rwe}Omj(R){this.Rwe!==R&&(this.Rwe=R,this.sa.raiseEvent("X"),this.r_d&&this.xog())}get r_d(){const R=ta.a.instance.Oa("WordEditor.Pagination.IPageEndMarkers");
return R?R.r_d:!0}get zk(){return this.fM.value}get Ck(){return cf.a.instance}avk(R){this.sa.addHandler("X",R)}xog(){this.Ck.ge(()=>{this.Pfa.bV(Bn.a.XYi)},"CPC:UPN")}enable(){this.ib.Sw(this.kqa);this.Y4e()}Y4e(){if(!this.fYa||1>=this.fYa.count)this.Omj(1);else{var R=this.ib.hb.lb;if(R){var Ba=R.isForward?R.Rc:R.Pa;!Ba||0>Ba.cpBegin||(R=Ba.node)&&Kj.ParagraphReader.Wb(R)&&this.oMm(R)&&(this.Dxb&&(this.Ib.Ze(this.Dxb),this.Dxb=null),this.Dxb=new Lc.a(2,1,400,lb=>{this.findCurrentPageFromIp(lb,Ba)},
62),this.Ib.Xb(this.Dxb))}}}oMm(R){R=Wn.GraphIterator.eb(R);return R.zb(35)||R.zb(37)||R.zb(39)?!1:!0}pFj(R){this.fYa=R;this.NDj()}NDj(){if(-1!==this.opd){var R=this.xBl(this.opd);-1!==R&&this.Omj(R)}}findCurrentPageFromIp(R,Ba){this.Dxb===R&&(this.Dxb=null,this.opd=this.QJl(Ba),-1!==this.opd&&this.NDj())}xBl(R){if(!this.fYa)return-1;for(let Ba=0;Ba<this.fYa.count;Ba++){const lb=this.fYa.J(Ba);if(R>lb.nlh&&R<lb.nlh+lb.height)return lb.Ch}return-1}QJl(R){var Ba=this.b7l(R);if(!Ba||!Ba.htmlElement)return-1;
const lb=Ba.getBounds();R=this.HRl(R,Ba);if(!R)return-1;Ba=oa.a.y2a(this.pjd.T5a,Ba.htmlElement).y;return R.y+Math.floor(R.height/2)-lb.y+Ba}b7l(R){return R.node.pe(this.zk.$b)}HRl(R,Ba){R=this.fz?this.fz.Oba(R,!0):R.cpBegin;return om.a.Tq(Ba,R)}disable(){this.ib.ZY(this.kqa)}}Object(f.a)($k,"CurrentPageCalculator",null,[1772,1746]);class mn{constructor(R){mn.HZ=R}get Qbf(){return mn.HZ}get YId(){return this.Qbf.YId}ctl(){this.Qbf.enable()}sml(){this.Qbf.disable()}}mn.HZ=null;Object(f.a)(mn,"CurrentPageManager",
null,[1771]);var Wo=c(117);class Am extends Sys.EventArgs{constructor(R,Ba){super();this.uPi=Ba}}Object(f.a)(Am,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Om extends Sys.EventArgs{constructor(R,Ba,lb){super();this.delta=R;this.uPi=lb}}Object(f.a)(Om,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class nn{static get E_a(){if(null!=nn.bvg)var R=nn.bvg;else{var Ba;R=!(null===(Ba=l.AFrameworkApplication.K)||void 0===Ba||!Ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));R=nn.bvg=R}return R}constructor(R,Ba,lb){this.lah=this.ttd=-1;this.Yzc=null;this.sa=new N.a;this.uKe=!1;this.XYf=(Vb,zc)=>{this.uKe=this.dUk();zc.Bnb||this.zuc.value.measure(this.YTk)};this.YTk=()=>{const Vb=this.T5a.clientHeight;this.XTk(Vb);this.gUk(Vb)};this.yYf=(Vb,zc)=>{zc.property===Wo.a.qJ&&(Vb=zc.node)&&Vb.ja(Wo.a.qJ,!1)&&(Vb=Vb.pe(this.zk.$b))&&(Vb=Vb.htmlElement)&&this.cYa.add(Vb)};this.fM=R;this.zuc=Ba;this.cYa=new mb.a;nn.E_a||this.zk.VZe(this.XYf);this.vyf();this.sda=this.sda.bind(this);
lb.vAb(this.sda);nn.E_a&&0===lb.mu&&this.kN()}kN(){this.zk.VZe(this.XYf)}Uza(){this.zk.M$i(this.XYf)}get zk(){return this.fM.value}sda(R,Ba){this.Yzc=null;nn.E_a&&(1===Ba.Emb?this.Uza():0===Ba.Emb&&this.kN())}get T5a(){this.Yzc||(this.Yzc=this.zk.ed.pe(this.zk.$b).T5a,va.ULS.shipAssertTag(34136386,336,!!this.Yzc));return this.Yzc}owk(R){this.sa.addHandler("OnPageContentSizeChangeKey",R)}XTk(R){R!==this.lah&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new Am(R,this.uKe)),this.lah=R)}gUk(R){R!==
this.ttd&&(-1!==this.ttd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new Om(R-this.ttd,R,this.uKe)),this.ttd=this.T5a.clientHeight)}dUk(){let R=!1;for(let Ba=this.cYa.count-1;0<=Ba;Ba--)this.cYa.J(Ba).hasChildNodes()&&(this.cYa.removeAt(Ba),R=!0);return R}vyf(){eb.App.ni.zl.Te(23).Mo(this.yYf)}}Object(f.a)(nn,"DocumentSizeManager",null,[]);var Um=c(55),hm=c(252);class Vl{constructor(R){this.fM=R}get zk(){const R=this.fM.value;va.ULS.shipAssertTag(37820298,336,R.Vi,"OutlineManager.PageView is not a PageView.");
return R}zge(R,Ba){const lb=Um.a.Ki(Vl.Qf.EB(R),1);Ba+=lb;R.pe(this.zk.$b).htmlElement.firstChild.style.minHeight=Ba+"px"}G8h(){const R=Wn.GraphIterator.eb(this.zk.ed);R.gp();R.Qd();va.ULS.shipAssertTag(37820299,336,10===R.Cn.type);return R.Cn}bai(){const R=Wn.GraphIterator.eb(this.zk.ed);R.gp();R.$X();va.ULS.shipAssertTag(37820300,336,10===R.Cn.type);return R.Cn}S8l(R){const Ba=Wn.GraphIterator.eb(this.zk.ed);Ba.gp();Ba.Qd();let lb=Ba.Cn,Vb=null;for(;R!==lb&&Ba.Kj();)Vb=lb,lb=Ba.Cn;va.ULS.shipAssertTag(37820301,
336,10===Ba.Cn.type);return Vb}static get Qf(){return hm.a.instance}}Object(f.a)(Vl,"OutlineManager",null,[1770]);class pm{constructor(R){this.CBa=0;this.n2=null;this.Bfg=Ba=>{for(const lb of Ba.customData)this.showAdornmentText(lb)};this.Ib=R}k8d(){this.n2||(this.n2=this.UJc())}GFd(){this.n2&&0<pm.MOc(this.n2).length&&this.Ib.Xb(this.n2);this.n2=null}UJc(){return Object.assign(new Lc.a(3,1,250,this.Bfg,166),{customData:[]})}Gcg(R){this.CBa=R}S9c(R){if(R){R.style.width=this.CBa+"px";if(this.n2)var Ba=
this.n2;else Ba=this.UJc(),this.Ib.Xb(Ba);pm.MOc(Ba).push(R)}}GSc(R){R&&(R.style.width="0px",this.eyf(R))}kcd(R,Ba){Ba?this.S9c(R):this.GSc(R)}showAdornmentText(R){R.style.width===this.CBa+"px"&&(this.$Oc(R).style.visibility="visible")}eyf(R){R&&(this.$Oc(R).style.visibility="hidden")}$Oc(R){R=R.childNodes;va.ULS.shipAssertTag(24958351,336,1===R.length,"Expected 1 child div in the page adornment, found "+R.length);return R[0]}static MOc(R){return R.customData}}Object(f.a)(pm,"PageAdornmentAnimationManager",
null,[1769]);class fo{constructor(R){this.gm=R;this.Kaa=new Ac.a;this.Laa=new Ac.a}EDa(R){R=Wn.GraphIterator.eb(R);if(R.gp()&&R.Qp()){R.Qd();do 10===R.Ue&&this.j0f(R.currentNode),R.Gt();while(8!==R.Ue)}}oQb(R){const Ba=R.Ch;var lb=this.yGb(R.JRb);if(!this.Kaa.nb(lb))return va.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+lb),!1;R=this.Kaa.J(lb);va.ULS.shipAssertTag(24958353,336,this.Laa.nb(lb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
lb=this.Laa.J(lb);return this.Zxf(R,Ba,lb)}nQb(R){const Ba=R.Ch;var lb=this.yGb(R.JRb);if(!this.Kaa.nb(lb))return va.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+lb),!1;R=this.Kaa.J(lb);va.ULS.shipAssertTag(24958355,336,this.Laa.nb(lb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");lb=this.Laa.J(lb);return this.Tkf(R,Ba,lb)}buf(R){if(!R)return va.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var Ba=R.tDd;if(!Ba)return va.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",R.Ch)),0;Ba=this.gm.EFb(Ba);if(!Ba)return va.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;Ba=this.gm.Kha(Ba);const lb=1===R.Ch;R=!(R.Ch%2);return 1===Ba?1:2===Ba?lb?2:1:3===Ba?R?3:4:lb?2:R?3:4}j0f(R){if(10===R.type){var Ba=new Ac.a,lb=this.gm.EFb(R);
va.ULS.shipAssertTag(24958356,336,!!lb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Vb=this.gm.Kha(lb);R=this.yGb(R);this.Log(R,Vb);this.Kog(R,Ba);lb=Wn.GraphIterator.eb(lb);if(lb.Qp()){lb.Qd();do R=lb.currentNode,Vb=this.gm.UPc(R),R=this.gm.Nmi(R),Ba.add(Vb,R),lb.Gt();while(36===lb.Ue)}}}Log(R,Ba){this.Laa.nb(R)?this.Laa.Z(R,Ba):this.Laa.add(R,Ba)}Kog(R,Ba){this.Kaa.nb(R)?this.Kaa.Z(R,Ba):this.Kaa.add(R,Ba)}yGb(R){va.ULS.shipAssertTag(24958358,
336,10===R.type,"Expected node of type Outline but received node of type "+R.type);return R.ja(kl.a.Fja,0)}Zxf(R,Ba,lb){const Vb=1===Ba;Ba=!(Ba%2);switch(lb){case 2:if(Vb){if(R.nb(2))return R.J(2)}else if(R.nb(0))return R.J(0);break;case 3:if(Ba){if(R.nb(1))return R.J(1)}else if(R.nb(0))return R.J(0);break;case 4:if(Vb){if(R.nb(2))return R.J(2)}else if(Ba){if(R.nb(1))return R.J(1)}else if(R.nb(0))return R.J(0);break;case 1:if(R.nb(0))return R.J(0)}return!1}Tkf(R,Ba,lb){const Vb=1===Ba;Ba=!(Ba%2);
switch(lb){case 2:if(Vb){if(R.nb(5))return R.J(5)}else if(R.nb(3))return R.J(3);break;case 3:if(Ba){if(R.nb(4))return R.J(4)}else if(R.nb(3))return R.J(3);break;case 4:if(Vb){if(R.nb(5))return R.J(5)}else if(Ba){if(R.nb(4))return R.J(4)}else if(R.nb(3))return R.J(3);break;case 1:if(R.nb(3))return R.J(3)}return!1}}Object(f.a)(fo,"PageAdornmentContentManager",null,[1747]);var Fq=c(1166);class Mp{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa){this.Opg(R,Ba,lb,Yc,Zd,$e,pa);this.Ch=R;this.Sq=Ba;this.Mr=lb;this.JRb=
Vb;this.tDd=zc;this.Pfb=Yc;this.dac=Zd;this.c8b=$e;this.gZi=pa}get top(){return this.Sq}get height(){return this.Mr}a9c(R){this.Sq!==R&&(this.Pfb.style.top=R+"px",this.Sq=R)}jcg(R){this.height!==R&&(this.Pfb.style.height=R+"px",this.Mr=R)}Opg(R,Ba,lb,Vb,zc,Yc,Zd){va.ULS.shipAssertTag(37244961,336,0<R,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",R);va.ULS.shipAssertTag(37244962,336,0<=Ba,"PageAdornmentContainer: top parameter value {0} is unexpected value.",Ba);va.ULS.shipAssertTag(37244963,
336,0<=lb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",lb,Ba);va.ULS.shipAssertTag(37244992,336,!!Vb,"PageAdornmentContainer: containerDomElement parameter is null.");va.ULS.shipAssertTag(37244993,336,!!zc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");va.ULS.shipAssertTag(37244994,336,!!Yc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");va.ULS.shipAssertTag(37244995,336,!!Zd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(f.a)(Mp,"PageAdornmentContainer",null,[1767]);class hk{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,wa,Ta){this.XWg="headerFooterTab";this.Kxd=null;this.Rs=!0;this.uCe=0;this.CHe=null;this.V2a=!1;this.cMb=Bb=>{this.Qhn(Bb.Uw);return!0};this.YB=()=>!0;this.nHb=()=>{this.k$e()&&(this.V2a=!1,this.gRo(),this.CHe=new Date)};this.gMb=Bb=>{this.V2a||this.QV.S9c(Bb.Uw);return!0};this.fMb=Bb=>{this.V2a||(Bb=Bb.Uw,this.ifg(Bb)||this.QV.GSc(Bb));return!0};this.QSn=()=>{let Bb=Array.dequeue(this.VOe);for(;Bb;)this.kN(Bb),
Bb=Array.dequeue(this.VOe);this.Kxd=null};this.fM=R;this.gg=Ba;this.uE=lb;this.Lka=Vb;this.ga=zc;this.qk=Yc;this.QV=Zd;this.OAa=$e;this.tLa=pa;this.Ib=Ma;this.Ga=ya;this.VOe=[];this.k2=new Map;this.GI=wa;this.yx=Ta;this.tLa.iBd(this.nHb);this.Mw=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.qL;if(this.Lnd=(this.qEe=!!this.Ga&&this.Ga.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ga&&this.Ga.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===eb.App.za.VI.getLayoutBreakpoint()&&
(this.Rs=!1),eb.App.za.VI.registerLayoutBreakpointChanged(this.XWg,Bb=>{switch(Bb){case "Small":this.jni();break;default:this.Wqj()}})}get zk(){return this.fM.value}Wqj(){try{this.Ruo()}catch(R){va.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",R.message,R.stack)}}jni(){try{this.jsm()}catch(R){va.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",R.message,R.stack)}}BYn(){for(const R of this.k2.keys())this.yce(R)}EDa(){try{this.L1k()}catch(R){va.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",R.message,R.stack)}}pFj(R){try{this.NVo(R)}catch(Ba){va.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",Ba.message)}}dispose(){try{this.GPo(),this.mQo(),this.tLa&&this.tLa.U$i(this.nHb)}catch(R){va.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",R.message,R.stack)}}Qhn(R){const Ba=this.TVc(R),lb=this.Z5h(R);lb?(tc.b("OpenHeaderFooterFromWebViewAdornment"),
R=this.OAa.buf(lb),this.ga.Rb(Ba?gh.a.toe:gh.a.qdd,2,R),this.V2a=!0):(va.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+R.id),this.ga.processAction(gh.a.$Wd,2))}GPo(){this.k2.forEach(R=>{this.Uza(R)})}mQo(){this.Mw&&(this.Lnd&&(eb.App.za.VI.unregisterLayoutBreakpointChanged(this.XWg),this.Lnd=!1),this.Mw=!1)}Uza(R){if(R){var Ba=R.dac;R=R.c8b;tj.a.Kpa(Ba)&&tj.a.Kpa(R)?(this.qk.sc(W.a.TR,Ba,this.gMb),this.qk.sc(W.a.TR,R,this.gMb),this.qk.sc(W.a.uL,
Ba,this.fMb),this.qk.sc(W.a.uL,R,this.fMb),this.gg.sc(W.a.click,Ba,this.cMb),this.gg.sc(W.a.click,R,this.cMb),this.uE.sc(Ba,hk.TLb),this.uE.sc(R,hk.TLb),this.Lka.sc(W.a.Vx,Ba,this.YB),this.Lka.sc(W.a.Vx,R,this.YB)):va.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}GKn(R){this.VOe.push(R);this.Kxd||(this.Kxd=new Lc.a(2,1,50,this.QSn),this.Ib.Xb(this.Kxd))}kN(R){if(R){var Ba=R.dac;R=R.c8b;tj.a.Kpa(Ba)&&tj.a.Kpa(R)?(this.qk.ob(W.a.TR,
Ba,this.gMb),this.qk.ob(W.a.TR,R,this.gMb),this.qk.ob(W.a.uL,Ba,this.fMb),this.qk.ob(W.a.uL,R,this.fMb),this.gg.ob(W.a.click,Ba,this.cMb),this.gg.ob(W.a.click,R,this.cMb),this.uE.ob(Ba,hk.TLb),this.uE.ob(R,hk.TLb),this.Lka.ob(W.a.Vx,Ba,this.YB),this.Lka.ob(W.a.Vx,R,this.YB)):va.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Ruo(){if(!this.Rs){for(const R of this.k2.values())R.Pfb.style.display="block";this.Rs=!0}}jsm(){this.Rs&&
(this.k2.forEach(R=>{R.Pfb.style.display="none"}),this.Rs=!1)}L1k(){this.OAa.EDa(this.zk.ed)}NVo(R){this.QV.k8d();var Ba=0;const lb=new mb.a;this.EDa();const Vb=this.a0l();for(var zc of R)R=zc.Ch,this.own(zc)||this.yce(zc.Ch),this.k2.has(R)?this.wSo(zc):this.m8k(zc),Ba=R,lb.add(R);for(zc=1;zc<=Ba;zc++)lb.contains(zc)||this.yce(zc);for(Ba+=1;Ba<=Vb;Ba++)this.yce(Ba);this.QV.GFd()}own(R){return this.k2.has(R.Ch)?this.k2.get(R.Ch).JRb.id===R.JRb.id:!1}a0l(){let R=0;this.k2.forEach((Ba,lb)=>{lb>R&&(R=
lb)});return R}m8k(R){const Ba=R.JRb.pe(this.zk.$b);if(Ba){var lb=R.Ch;R=this.GJc(lb,R.top,R.height,Ba.Wba,R.JRb,R.tDd);this.GKn(R);this.Bng(R);this.$og(R);this.Lnd&&!this.Rs&&(R.Pfb.style.display="none");this.k2.set(lb,R)}}GJc(R,Ba,lb,Vb,zc,Yc){const Zd=Ei.b("div","","PageAdornmentContainer");Zd.style.top=Ba+"px";Zd.style.height=lb+"px";Vb.appendChild(Zd);this.Z4e(Zd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Vb=this.Daf(R);Zd.appendChild(Vb);const $e=this.baf(R);
Zd.appendChild($e);const pa=this.S$e(R);Zd.appendChild(pa);l.AFrameworkApplication.isRtl&&(Zd.classList.add("Rtl"),$e.classList.add("Rtl"),pa.classList.add("Rtl"));return new Mp(R,Ba,lb,zc,Yc,Zd,$e,pa,Vb)}baf(R){R=Ei.b("div","h"+R,this.yx?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.GI&&(this.yx?R.classList.add("PageAdornmentHeaderFooterBorderThemed"):R.style.borderColor=Fq.a.Koe);const Ba=Ei.b("span","","");Ba.innerText=WordEditorIntl.WordEditorStrings.l_Header;Ba.style.whiteSpace=
"nowrap";R.appendChild(Ba);return R}S$e(R){R=Ei.b("div","f"+R,this.yx?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.GI&&(this.yx?R.classList.add("PageAdornmentHeaderFooterBorderThemed"):R.style.borderColor=Fq.a.Koe);const Ba=Ei.b("span","","");Ba.innerText=WordEditorIntl.WordEditorStrings.l_Footer;Ba.style.whiteSpace="nowrap";R.appendChild(Ba);return R}Daf(R){const Ba=Ei.b("div","","PageAdornmentNumberLabel");Ba.innerText=R.toString();return Ba}Z4e(R,Ba,lb){if(!this.uCe){const Vb=
Ei.b("p","","");Vb.innerText=Ba;Vb.style.whiteSpace="nowrap";Vb.style.visibility="hidden";R.appendChild(Vb);Ba=Ei.b("p","","");Ba.innerText=lb;Ba.style.whiteSpace="nowrap";Ba.style.visibility="hidden";R.appendChild(Ba);this.uCe=R.clientWidth;this.QV.Gcg(this.uCe);R.removeChild(Vb);R.removeChild(Ba)}}yce(R){if(this.k2.has(R)){var Ba=this.k2.get(R);this.Uza(Ba);tj.a.ox(Ba.Pfb);this.k2.delete(R)}}wSo(R){if(this.k2.has(R.Ch)){var Ba=this.k2.get(R.Ch);Ba.a9c(R.top);Ba.jcg(R.height);this.Bng(Ba);this.$og(Ba)}else va.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}gRo(){this.QV.k8d();this.EDa();this.k2.forEach(R=>{this.Bng(R);this.$og(R)});this.QV.GFd()}Bng(R){const Ba=R.dac,lb=R.c8b,Vb=this.OAa.oQb(R),zc=this.OAa.nQb(R);this.YXo(R,Vb,zc);this.QV.kcd(Ba,Vb);this.QV.kcd(lb,zc)}YXo(R,Ba=!0,lb=!0){const Vb=R.dac;R=R.c8b;3!==l.AFrameworkApplication.va.mode?(Vb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,R.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Vb.title=
Ba?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,R.title=lb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}ifg(R){const Ba=this.Z5h(R);return Ba?this.TVc(R)?this.OAa.oQb(Ba):this.OAa.nQb(Ba):(va.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}Z5h(R){R=R.id;R=R.substring(1,R.length);R=Number.parseInvariant(R);return this.k2.has(R)?this.k2.get(R):(va.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+R),null)}TVc(R){return R.id.length?"h"===R.id.substring(0,1):(va.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}$og(R){const Ba=R.height;Ba<hk.Fbn?(R.dac.classList.add(hk.yjb),R.c8b.classList.add(hk.yjb)):(R.dac.classList.remove(hk.yjb),R.c8b.classList.remove(hk.yjb));Ba<hk.Gbn?(R.gZi.classList.add(hk.yjb),R.Pfb.classList.add(hk.yjb)):(R.gZi.classList.remove(hk.yjb),R.Pfb.classList.remove(hk.yjb))}k$e(){return!this.CHe||
Y.a.Rxf(this.CHe,500)}static TLb(){return!0}}hk.yjb="Hidden";hk.Fbn=120;hk.Gbn=50;Object(f.a)(hk,"PageAdornmentManager",null,[1745,10,1746]);class Qc{constructor(R,Ba){this.S8d=new mb.a;this.S8d.add(R);this.S8d.add(Ba)}}Object(f.a)(Qc,"PageElementManagerList",null,[]);var aa=c(58);class na{constructor(R,Ba,lb){this.fn=R;this.gZb=[];this.CK=Ba;this.GI=lb}J8i(){for(let R=0,Ba=this.gZb.length;R<Ba;R++)tj.a.ox(this.gZb[R]);Array.clear(this.gZb)}C7h(R,Ba,lb,Vb,zc,Yc){let Zd=Math.min(Vb.x-Yc.x,zc.x-Yc.x);
Vb=Math.min(Yc.x+Yc.width-(Vb.x+Vb.width),Yc.x+Yc.width-(zc.x+zc.width));Ba+=zc.y-Yc.y;({Wia:Ba,leftMargin:Zd,rightMargin:Vb}=this.Kyk(Ba,Zd,Vb));R=this.b6l(R,Zd,Vb,Zd,Vb,lb);R.style.top=Ba+"px";R.style.zIndex="0";this.gZb.push(R);aa.d(R,!0);return R}qSd(R){return R?R.querySelector(".PageBreakBorderSpan"):null}b6l(R,Ba,lb,Vb,zc,Yc){return R?this.Eem(Ba,lb,Vb,zc,Yc):this.v6l(Vb,zc,Yc)}Kyk(R,Ba,lb){Ba/=this.fn.instance.ij;lb/=this.fn.instance.ij;R/=this.fn.instance.ij;return{Wia:R,leftMargin:Ba,rightMargin:lb}}zLm(R){return this.XCi(R)&&
this.cZi(R)?(R=this.nGb(R))&&R.offsetParent?!1:!0:!1}yLm(R){return!this.XCi(R)||this.cZi(R)?!1:!0}MR(){}nGb(R){if(!R.DZf)return null;let Ba=null;R.Ekb&&!R.Zca?(R=this.qSd(R.DZf))&&(Ba=R):Ba=R.DZf;return Ba}XCi(R){return R.Ekb&&!R.Zca&&R.paragraphNode?!0:!1}cZi(R){R=R.paragraphNode;return!!R&&!!R.anchor}yzh(R,Ba){R=oa.a.REa(R);Ba=oa.a.REa(Ba);return(R-Ba)/this.fn.instance.ij}d5e(R,Ba){R=oa.a.REa(R);Ba=oa.a.REa(Ba);return(R-Ba)/this.fn.instance.ij}h_c(){this.rFj(!1)}g_c(){this.rFj(!0)}rFj(R){for(let Ba=
0,lb=this.gZb.length;Ba<lb;Ba++){const Vb=this.gZb[Ba];"PageEndMarker.Para"===Vb.id?na.vFj(Vb,R):"PageEndMarker.Table"===Vb.id&&na.oGj(Vb,R)}}v6l(R,Ba,lb){if(!na.a1b){na.a1b=Ei.b("div","PageEndMarker.Para","PageEndMarker");var Vb=Ei.b("div","","Current FullWidth");this.GI&&(Vb.style.borderTopColor=this.CK.Cwa());na.a1b.appendChild(Vb);Vb=Ei.b("div","","Stale LeftWing");const zc=Ei.b("div","","Stale RightWing");this.GI&&(Vb.style.borderTopColor=this.CK.Cwa(),zc.style.borderTopColor=this.CK.Cwa());
na.a1b.appendChild(Vb);na.a1b.appendChild(zc)}Vb=na.a1b.cloneNode(!0);Vb.childNodes[1].style.width=R-10+"px";Vb.childNodes[2].style.width=Ba-10+"px";na.vFj(Vb,lb);return Vb}Eem(R,Ba,lb,Vb,zc){if(!na.Ezb){na.Ezb=Ei.b("div","PageEndMarker.Table","PageEndMarker");var Yc=Ei.b("div","","Current LeftWing"),Zd=Ei.b("div","","Current RightWing");this.GI&&(Yc.style.borderTopColor=this.CK.Cwa(),Zd.style.borderTopColor=this.CK.Cwa());na.Ezb.appendChild(Yc);na.Ezb.appendChild(Zd);Yc=Ei.b("div","","Stale LeftWing");
Zd=Ei.b("div","","Stale RightWing");this.GI&&(Yc.style.borderTopColor=this.CK.Cwa(),Zd.style.borderTopColor=this.CK.Cwa());na.Ezb.appendChild(Yc);na.Ezb.appendChild(Zd)}Yc=na.Ezb.cloneNode(!0);Yc.childNodes[0].style.width=R+"px";Yc.childNodes[1].style.width=Ba+"px";Yc.childNodes[2].style.width=lb-10+"px";Yc.childNodes[3].style.width=Vb-10+"px";na.oGj(Yc,zc);return Yc}static vFj(R,Ba){Ba?na.B7m(R):na.C7m(R)}static C7m(R){R.childNodes[0].style.display="none";R.childNodes[1].style.display="block";R.childNodes[2].style.display=
"block"}static B7m(R){R.childNodes[0].style.display="block";R.childNodes[1].style.display="none";R.childNodes[2].style.display="none"}static oGj(R,Ba){Ba?na.H7m(R):na.I7m(R)}static I7m(R){R.childNodes[0].style.display="none";R.childNodes[1].style.display="none";R.childNodes[2].style.display="block";R.childNodes[3].style.display="block"}static H7m(R){R.childNodes[0].style.display="block";R.childNodes[1].style.display="block";R.childNodes[2].style.display="none";R.childNodes[3].style.display="none"}}
na.a1b=null;na.Ezb=null;Object(f.a)(na,"PageEndDOMHelper",null,[]);class ub{constructor(R,Ba){this.Nxb=this.sah=null;this.fn=R;this.oi=Ba}dig(R,Ba){try{this.HBo(R,Ba)}catch(lb){va.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",lb.message)}}j1k(R,Ba,lb,Vb,zc,Yc){this.oi.ge(()=>{try{this.k1k(R,Ba,lb,Vb,zc,Yc)}catch(Zd){va.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Zd.message)}},"PEMPC:CP")}HBo(R,Ba){this.sah=R;this.Nxb=Ba}k1k(R,Ba,lb,Vb,zc,Yc){var Zd=this.sah;if(Zd&&R){var $e=Zd.count,pa=R.count;if($e&&pa){var Ma=this.aCl(Zd,R);if(Ma.count){var ya=this.fn.ij,wa=this.G4b(Ma)/ya,Ta=this.rGh(Ma)/ya;R=this.LNd(Zd,R);if(R.count){Zd=this.G4b(R)/ya;ya=this.rGh(R)/ya;var Bb=!0;for(var Qb=0;Qb<Ma.count;Qb++)if(Ma.J(Qb)){Bb=!1;break}var jc=Qb=0;this.Nxb&&Ba&&(Qb=this.UOk(this.Nxb,Ba),jc=Ba.count-this.Nxb.count);va.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Vb,
["EstimatedPageCount"]:$e,["CalculatedPageCount"]:pa,["InOrderAverageDelta"]:wa,["InOrderStandardDeviation"]:Ta,["ShortestAverageDelta"]:Zd,["ShortestStandardDeviation"]:ya,["PositionsShouldBeUpdated"]:lb,["DocumentHeightChanged"]:zc,["DeltasAllZero"]:Bb,["HeaderFooterOpenSinceLastResponse"]:Yc,["DeltaInViewport"]:Qb,["ChangeInViewportMarkerCount"]:jc});zc||Yc||Bb||(va.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
Ba=Ma.toArray().toString(),lb=R.toArray().toString(),va.ULS.sendTraceTag(35726603,336,50,"{0} {1}",Ba,lb))}}}}else va.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}UOk(R,Ba){const lb=new mb.a;for(const Vb of R)lb.add(Vb.top);if(!lb.count)return-1;R=new mb.a;for(const Vb of Ba)R.add(Vb.top);if(!R.count)return-1;Ba=this.LNd(lb,R);return this.G4b(Ba)/this.fn.ij}G4b(R){if(!R.count)return 0;let Ba=0;for(let lb=
0;lb<R.count;lb++)Ba+=R.J(lb);return Ba/R.count}rGh(R){if(!R.count)return 0;const Ba=this.G4b(R);let lb=0;for(let Vb=0;Vb<R.count;Vb++){const zc=R.J(Vb)-Ba;lb+=zc*zc}return Math.sqrt(lb/R.count)}aCl(R,Ba){const lb=new mb.a;if(!R.count||!Ba.count)return lb;R.Sc((zc,Yc)=>zc-Yc);Ba.Sc((zc,Yc)=>zc-Yc);const Vb=Math.min(R.count,Ba.count);for(let zc=0;zc<Vb;zc++){const Yc=Math.abs(R.J(zc)-Ba.J(zc));lb.add(Yc)}return lb}LNd(R,Ba){const lb=new mb.a;if(!R.count||!Ba.count)return lb;var Vb=R.count<=Ba.count;
const zc=Vb?R:Ba;R=Vb?Ba:R;for(Ba=0;Ba<zc.count;Ba++){Vb=zc.J(Ba);let Zd=Math.abs(Vb-R.J(0)),$e=0;for(let pa=1;pa<R.count;pa++){var Yc=R.J(pa);Yc=Math.abs(Vb-Yc);Yc<Zd&&(Zd=Yc,$e=pa)}lb.add(Zd);R.removeAt($e)}return lb}}Object(f.a)(ub,"PageEndMarkerPositionComparer",null,[1744]);var hc=c(392),wc=c(593);class fd{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma){this.Sq=R;this._pageNumber=Ba;this.Ekb=lb;this.Zca=Vb;this.DZf=zc;this.outlineNode=Yc;this.outlineGroupNode=Zd;this.u9g=$e;this.paragraphNode=pa;this.ZU=
Ma}get top(){return this.Sq}get Ch(){return this._pageNumber}get Kvn(){return this.u9g}a9c(R){this.Sq=R}Bge(R){this._pageNumber=R}Ykj(R){this.u9g=R}}Object(f.a)(fd,"PageEndMarker",null,[]);class wd{constructor(){this.mf=null;this.CPi=0}}Object(f.a)(wd,"PageEndMarkerToRestore",null,[]);class Sd{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.yYf=($e,pa)=>{pa.property===Wo.a.qJ&&($e=pa.node)&&$e.ja(Wo.a.qJ,!1)&&this.xzd.contains($e.id)&&(pa=$e.pe(this.zk.$b))&&(pa=pa.htmlElement)&&(this.xzd.remove($e.id),this.cYa.add(pa))};
this.fM=R;this.fn=Ba;this.oMa=lb;this.ny=Vb;this.vMe=zc;this.$Z=Yc;this.Pq=Zd;this.ut=new mb.a;this.hZb=new mb.a;this.Dzb=new Ac.a;this.xzd=new wc.a(new hc.a);this.cYa=new mb.a;this.kZb=!!zc;this.vyf()}get zk(){const R=this.fM.value;va.ULS.shipAssertTag(37052750,336,R.Vi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return R}coc(R){try{this.oVo(R)}catch(Ba){this.ny.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
Ba.message)}}Hsk(R){try{this.Isk(R)}catch(Ba){this.ny.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",Ba.message)}}TPk(R){try{return this.UPk(R)}catch(Ba){this.ny.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",Ba.message)}return!1}s5n(){try{this.t5n()}catch(R){this.ny.MR(R.message+" "+R.stack),va.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",R.message)}}UQc(){try{return this.o$l()}catch(R){return this.ny.MR(R.message+" "+R.stack),va.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",R.message),null}}Jog(){try{this.SWo()}catch(R){this.ny.MR(R.message+" "+R.stack),va.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
R.message)}}J6e(){try{return this.CVk()}catch(R){return this.ny.MR(R.message+" "+R.stack),va.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",R.message),!1}}TBm(R){try{this.UBm(R)}catch(Ba){this.ny.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",Ba.message)}}oVo(R){if(R){this.jXk();for(let Ba=0;Ba<R.length;Ba++){const lb=
Ba+1,Vb=this.X2k(R[Ba],lb);this.ut.add(Vb);this.Dzb.add(lb,Vb)}}}UBm(R){let Ba=!1;for(const lb of R)if(lb)if(0<lb.Ry)for(const Vb of lb.kBf)Ba=this.SAd(Vb,lb.outlineGroupNode)||Ba;else if(0>lb.Ry){Ba=!0;for(const Vb of lb.VJd)this.Uil(Vb.Ch)}Ba&&this.Y7f()}Isk(R){const Ba=this.c6h(R.paragraphNode);this.SAd(R,Ba)&&this.Y7f()}Uil(R){const Ba=R-1;0>Ba||this.ut.count<=Ba||(this.ut.removeAt(Ba),this.Dzb.nb(R)&&this.Dzb.remove(R))}o$l(){const R=new mb.a;for(const Ba of this.ut)this.Qcc(Ba)&&R.add(Ba);return R}SAd(R,
Ba){if(!R)return va.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;Ba=this.V2k(R,Ba);R=R.aHm?-1:R.Ch;let lb=!1,Vb;this.Dzb.nb(R)?(Vb=this.Dzb.J(R).Ch,Ba.Bge(Vb),this.ut.Z(Vb-1,Ba),this.Dzb.remove(R)):(Vb=Ba.Ch,this.ut.insert(Vb-1,Ba),lb=!0);return lb}X2k(R,Ba){return new fd(0,Ba,R.HardBreak,!1,null,null,null,0,null,null)}V2k(R,Ba){const lb=R.Gnb,Vb=R.Ch,zc=R.ZU,Yc=!!zc&&zc.HardBreak,Zd=R.Zca,$e=R.paragraphNode,pa=this.nci(Ba),
Ma=R.outlineNode;var ya=this.Orf(Ma);if(!ya)return va.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let wa=null;Yc&&(wa=this.ny.qSd(R.Gnb));R=this.ny.yzh(wa||lb,pa);ya=this.ny.d5e(wa||lb,ya);return new fd(ya,Vb,Yc,Zd,lb,Ma,Ba,R,$e,zc)}UPk(R){this.hZb=new mb.a;this.kZb&&this.vMe.reset();this.tXn();this.Gxo();this.Lyk();this.HPk(R);return 0<this.hZb.count}tXn(){for(let R=0;R<this.ut.count;R++){const Ba=this.ut.J(R);this.ny.zLm(Ba)?
this.X5m(Ba):(this.ny.yLm(Ba)||this.Qcc(Ba)&&!this.Orf(Ba.outlineNode))&&this.R9i(Ba)}}Lyk(){let R=0,Ba=null;var lb=0;let Vb=0;for(let zc=0;zc<this.ut.count;zc++){const Yc=this.ut.J(zc);this.Qcc(Yc)&&(Yc.Ekb&&(Vb+=this.vzh(Yc,lb,Vb)),Ba&&Ba.id===Yc.outlineNode.id||(Ba=Yc.outlineNode,Vb=R=0),Yc.Ekb&&!Yc.Zca&&(R=this.FPk(Yc)),lb=Yc.top+R+Vb,Yc.a9c(lb))}this.vzh(null,lb,Vb);this.lXn()}vzh(R,Ba,lb){let Vb=null;this.kZb&&(Vb=this.vMe.IPk(R,Ba,lb));return Vb?Vb.delta:0}t5n(){if(this.hZb){for(let R=0;R<
this.hZb.count;R++){const Ba=this.hZb.J(R);tj.a.Afo(Ba.mf,Ba.CPi)}this.kZb&&this.vMe.p5n()}}SWo(){if(!this.kZb){var R=this.oMa.bai();if(this.ut.count){var Ba=this.oMa.G8h();for(let zc=0;zc<this.ut.count;zc++){var lb=this.ut.J(zc);if(this.Qcc(lb)&&lb.Zca){lb=this.oMa.S8l(lb.outlineNode);var Vb=0<zc?this.ut.J(zc-1).outlineNode:Ba;Vb=zc&&lb.id===Vb.id?this.ut.J(zc-1).top:0;this.oMa.zge(lb,Vb)}}Ba=this.ut.J(this.ut.count-1);Ba.Zca?this.oMa.zge(R,0):this.oMa.zge(R,Ba.top)}else this.oMa.zge(R,0)}}Gxo(){this.ut.Sc((R,
Ba)=>R.Ch-Ba.Ch)}Y7f(){for(let R=0;R<this.ut.count;R++)this.ut.J(R).Bge(R+1)}FPk(R){return R?this.xzh(R)-R.top:(va.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}RPk(R){if(!R)return 0;const Ba=this.nci(R.outlineGroupNode);return Ba?this.ny.yzh(this.ny.nGb(R),Ba):0}xzh(R){if(!R)return 0;const Ba=this.ny.nGb(R);R=this.Orf(R.outlineNode);return R?this.ny.d5e(Ba,R):(va.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}lXn(){let R=0,Ba=!1,lb=null,Vb=!1;for(let zc=this.ut.count-1;0<=zc;zc--){const Yc=this.ut.J(zc);this.Qcc(Yc)&&(lb&&lb.id===Yc.outlineNode.id||(Ba=!lb,lb=Yc.outlineNode,R=this.L5l(lb)),Yc.Ekb?(Ba=!1,R=Yc.top):this.kZb&&Ba||!(Yc.top>R)||(this.R9i(Yc),tj.a.ox(this.ny.nGb(Yc)),Vb=!0))}Vb&&this.Y7f()}R9i(R){this.ut.contains(R)&&(this.kZb&&this.$Z.CYn(R),this.ut.remove(R))}Qcc(R){return R?(R=this.ny.nGb(R))&&R.offsetParent?!0:!1:(va.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}CVk(){let R=!1;for(let Ba=this.cYa.count-1;0<=Ba;Ba--)this.cYa.J(Ba).hasChildNodes()&&(this.cYa.removeAt(Ba),R=!0);return R}X5m(R){(R=this.c6h(R.paragraphNode))&&(this.xzd.contains(R.id)||this.xzd.add(R.id))}vyf(){this.Pq&&this.Pq.Te(23).Mo(this.yYf)}HPk(R){for(let Ba=this.ut.count-1;0<=Ba;Ba--){const lb=this.ut.J(Ba);this.Qcc(lb)&&this.GPk(lb,R)}}GPk(R,Ba){const lb=this.xzh(R),Vb=this.RPk(R);R.Ekb?(R.a9c(lb),R.Ykj(Vb)):(Ba=Ba?lb-R.top:Vb-R.Kvn,R.a9c(lb-Ba),R.Ykj(Vb-Ba),1<Math.abs(Ba)&&this.iko(this.ny.nGb(R),
Ba))}Orf(R){if(!R)return null;R=R.pe(this.zk.$b);return R?R.htmlElement:(va.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}nci(R){return R?(R=R.pe(this.zk.$b))?R.htmlElement:null:null}c6h(R){R=Wn.GraphIterator.eb(R);return R.zb(23)?R.ld(23):null}K5l(R){if(!R)return null;R=R.pe(this.zk.$b);return R?oa.a.getElementBounds(R.htmlElement):(va.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}L5l(R){return(R=
this.K5l(R))?R.height/this.fn.ij:0}iko(R,Ba){Ba=(tj.a.EUl(R)-Ba)*this.fn.ij;this.hZb.add(Object.assign(new wd,{mf:R,CPi:Ba}))}jXk(){this.ut=new mb.a;this.Dzb=new Ac.a}}Object(f.a)(Sd,"PageEndMarkerPositionUpdater",null,[1743]);var Pe=c(365),wf=c(32),rg=c(350),Dg=c(21);class Ye{constructor(R,Ba,lb,Vb,zc,Yc,Zd=!1,$e=!1,pa=!1,Ma=!1,ya=!1){this.Opg(Ba,lb,Vb,zc,Yc,pa,ya);this.position=R;this.Ch=Ba;this.paragraphNode=lb;this.ZU=Vb;this.Gnb=zc;this.outlineNode=Yc;this.f4a=Zd;this.tCi=$e;this.aHm=pa;this.Zca=
Ma;this.w_d=ya}Bge(R){this.Ch=R}Opg(R,Ba,lb,Vb,zc,Yc,Zd){Zd||(va.ULS.shipAssertTag(38326881,336,!!zc,"PageEndDetails: outlineNode parameter value is null."),va.ULS.shipAssertTag(24126528,336,0<=R,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",R),va.ULS.shipAssertTag(24126529,336,!!Ba||Yc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),va.ULS.shipAssertTag(24126530,336,!!lb||Yc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
va.ULS.shipAssertTag(24126531,336,!!Vb||Yc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static u$k(R,Ba){return Ye.B$e(0,R,null,Ba,!0,!1)}static v$k(R){return Ye.B$e(0,0,null,R,!1,!0)}static B$e(R,Ba,lb,Vb,zc,Yc){return new Ye(R,Ba,null,null,lb,Vb,zc,Yc,!0)}static q5b(R,Ba){return new Ye(0,R,null,Ba,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(Ye,"PageEndDetails",null,[]);class Sg{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e,pa,Ma,ya,wa,Ta,Bb,Qb,jc,Ic,
Oc,kd,td){this.xta=!0;this.uwe=0;this.msd=this.vCe=this.wCe=this.vye=this.tMe=this.fCe=!1;this.kud=this.jyb=null;this.IFe=!0;this.SLb=()=>{this.h_c()};this.rVf=()=>{this.wCe=!1};this.sVf=()=>{this.vCe=this.wCe=!0};this.Won=(qd,Fd)=>{1>=Math.abs(Fd.delta)||(this.vye=!0,this.qFj(!Fd.uPi))};this.jRn=qd=>{qd===this.jyb&&(this.jyb=null);if(this.xta){var Fd=qd.customData;if(qd=this.dYa.get(Fd.id))for(this.dYa.Z(Fd.id,new mb.a),va.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
qd.count,Fd.id),this.Maa&&this.Maa.EDa(),Fd=0;Fd<qd.count;Fd++){const se=qd.J(Fd),qe=se.ZU;qe.HardBreak||(tj.a.ox(se.Gnb),this.K7f(qe))}}};this.iRn=()=>{this.kud=null;this.xta&&this.Xia&&0<this.Xia.count&&(va.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.coc(this.Xia.toArray(),this.xta))};this.fM=R;this.ei=Ba;this.Maa=lb;this.bO=Vb;this.D9g=zc;this.ucb=Yc;Sg.ny=$e;this.PVg=pa;this.MI=Ma;this.Ib=ya;this.y2j=wa;this.he=Bb;this.$Z=jc;this.xMe=Ic;this.mZb=
Oc;this.HZ=kd;this.RYb=new Pe.a;this.iZb=new mb.a;this.Xia=new mb.a;this.dYa=new Pe.a;this.NN=Ta;this.hT=td;this.Y8d=this.Y8d.bind(this);this.$8d=this.$8d.bind(this);this.n5c=this.n5c.bind(this);this.sda=this.sda.bind(this);this.NN.rFc(this.SLb);this.uMe=!1;Qb&&(Qb.Lph(this.sVf),Qb.iBd(this.rVf));Zd&&Zd.owk(this.Won);this.hT.vAb(this.sda)}get r_d(){return this.IFe}get zk(){return this.fM.value}get nj(){return this.ei.value}coc(R,Ba){const lb=this.he.Vf("Task","UpdateMarkers");this.FBo();this.xta=
Ba;Sg.ny.J8i();this.RYb=new Pe.a;this.iZb.clear();this.Xia.clear();this.dYa=new Pe.a;this.IFe=this.fCe=!1;this.bO&&this.bO.coc(R);this.evl();this.uwe=R.length;this.$Z&&this.$Z.reset(R);this.Maa&&this.Maa.EDa();for(const Vb of R)this.Xia.add(Vb),this.K7f(Vb);Ba&&this.bO&&this.xMe&&this.xMe.isEnabled&&(R=this.bO.UQc(),this.xMe.kDa(R));this.i1k();this.vye=this.tMe=!1;this.vCe=this.wCe;xm.WoncaApp.instance.KHb&&Sg.nzf&&this.bO.Jog();this.ucb.MVo(this.bO.UQc(),this.Xia.count);this.IFe=!0;this.HZ.xog();
lb.stop();va.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:lb.li,["RenderedLineCount"]:this.uwe,["AvgDurationPerPageInMs"]:lb.li/this.uci()})}wci(){const R=this.bO.UQc();if(!R)return null;const Ba=tj.a.ZX(),lb=new mb.a;for(const Vb of R)this.pPm(Vb,Ba)&&lb.add(Vb);return lb}pPm(R,Ba){if(!R)return!1;R=Sg.ny.nGb(R);if(!R)return!1;R=oa.a.REa(R);return 0<=R&&R<=Ba}b3h(){const R=new mb.a;if(!this.dYa)return va.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
R;const Ba=this.dYa.keys;for(let zc=0;zc<Ba.length;zc++){var lb=Ba.J(zc);if(lb=this.dYa.J(lb))for(let Yc=0;Yc<lb.count;Yc++){var Vb=lb.J(Yc);Vb.ZU.HardBreak||Vb.Gnb.classList.contains("Hidden")||(Vb=oa.a.REa(Vb.Gnb),R.add(Vb))}}return R}FBo(){const R=this.b3h(),Ba=this.wci();this.D9g.dig(R,Ba);this.mZb&&this.mZb.isEnabled&&this.mZb.dig(Ba)}i1k(){if(!(25<this.uci())){var R=this.b3h(),Ba=this.wci();this.D9g.j1k(R,Ba,this.tMe,this.fCe,this.vye,this.vCe);this.mZb&&this.mZb.isEnabled&&this.mZb.kDa(Ba)}}sda(){this.Maa.BYn();
this.CQh()}CQh(){this.msd&&(this.zk.M$i(this.Y8d),this.zk.y_n(this.$8d),this.zk.c_n(this.n5c),this.msd=!1)}evl(){this.msd||(this.zk.VZe(this.Y8d),this.zk.Wwk(this.$8d),this.zk.Eph(this.n5c),this.msd=!0)}K7f(R){if(this.uMe)return!0;R=this.x0n(R);if(!R)return!1;this.$Z&&this.$Z.Cnm(R);this.bO&&(this.bO.Hsk(R),this.ucb.mFj(this.bO.UQc()),xm.WoncaApp.instance.KHb&&Sg.nzf&&this.bO.Jog());return!0}x0n(R){let Ba=this.JM(R.ParaId);if(!Ba)return null;if(!Ba.anchor||!Ba.tj)return this.Boh(R,Ba),null;let lb,
Vb;if(R.HardBreak){var zc=Kj.ParagraphReader.$f(Ba,!0,!0,!0);this.wxn(zc)&&(Ba=zc);if(!({Wia:zc,outlineGroupNode:lb,Enb:Vb}=this.LMo(R,Ba)).returnValue)return null;this.fCe=!0}else if(!({T8d:zc,outlineGroupNode:lb,Enb:Vb}=this.y0n(R,Ba)).returnValue)return null;return this.SAd(Ba,R,zc,lb,Vb)}wxn(R){return R?(R=R.pe(this.zk.$b))?!!Sg.ny.qSd(R.htmlElement):!1:!1}y0n(R,Ba){var lb=R.PageEndType;let Vb,zc=0,Yc=null;if(!lb){if(!({Wia:R,W5a:Vb}=this.xci(R,Ba)).returnValue)return{returnValue:!1,T8d:zc,outlineGroupNode:Yc,
Enb:null}}else if(!({Wia:R,yke:Vb}=this.c6l(R,Ba)).returnValue)return{returnValue:!1,T8d:zc,outlineGroupNode:Yc,Enb:null};var Zd=Wn.GraphIterator.eb(Ba);Zd.rd();Yc=Zd.ld(23);Ba=Yc.pe(this.zk.$b).getBounds();Zd=Zd.ATa().pe(this.zk.$b);if(!Zd)return va.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.zk.$b),{returnValue:!1,T8d:zc,outlineGroupNode:Yc,Enb:null};const $e=Zd.getBounds();zc=R-Ba.y;lb=Sg.ny.C7h(lb,zc,this.xta,Vb,Ba,$e);Zd.Wba.appendChild(lb);return{returnValue:!0,
T8d:zc,outlineGroupNode:Yc,Enb:lb}}LMo(R,Ba){let lb=null;const Vb=Ba.pe(this.zk.$b);var zc=0;let Yc=null;if(this.O0d(R,Vb,Ba))return{returnValue:!1,Wia:zc,outlineGroupNode:lb,Enb:Yc};lb=Sg.bPi(Ba);const Zd=lb.pe(this.zk.$b);if(!Zd)return va.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.zk.$b),{returnValue:!1,Wia:zc,outlineGroupNode:lb,Enb:Yc};zc=Zd.getBounds();zc=om.a.Tq(Vb,R.CP).y-zc.y;Yc=this.cYl(Ba);return{returnValue:!0,Wia:zc,outlineGroupNode:lb,Enb:Yc}}cYl(R){return R.pe(this.zk.$b).htmlElement}JM(R){const Ba=
this.MI.Pib(R);if(Ba!==wh.a.nil){const lb=this.nj.Eb(Ba);if(lb)return lb}va.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",R,Ba);return null}xci(R,Ba){const lb=R.CP;let Vb=0,zc=null;const Yc=Ba.pe(this.zk.$b);if(this.O0d(R,Yc,Ba))return{returnValue:!1,Wia:Vb,W5a:zc};zc=Yc.getBounds();Vb=lb?this.PVg(Object(yb.a)(105,Yc),lb):zc.y-this.y2j(Yc);return{returnValue:!0,Wia:Vb,W5a:zc}}c6l(R,Ba){let lb=null,Vb=0;var zc=R.PageEndType;let Yc=Wn.GraphIterator.eb(Ba);
Yc.rd();if(!wf.TableReader.hx(Yc))return va.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",R.ParaId),{returnValue:({Wia:Vb,W5a:lb}=this.xci(R,Ba)).returnValue,Wia:Vb,yke:lb};if(1===zc){Dg.returnToContainingRow(Yc);zc=Yc.currentNode.pe(this.zk.$b);if(this.O0d(R,zc,Ba))return{returnValue:!1,Wia:Vb,yke:lb};Vb=zc.getBounds().y}else{zc=Ba.pe(this.zk.$b);if(this.O0d(R,zc,Ba))return{returnValue:!1,Wia:Vb,yke:lb};Vb=this.PVg(Object(yb.a)(105,
zc),R.CP)}--Vb;Ba=null;do R=Ba,Ba=Yc.ld(14);while(Ba);Yc=Wn.GraphIterator.eb(R);Yc.rd();Dg.moveToFirstRow(Yc);lb=Yc.currentNode.pe(this.zk.$b).getBounds();return{returnValue:!0,Wia:Vb,yke:lb}}O0d(R,Ba,lb){if(!Ba||Ba.bqa(16))return this.Boh(R,lb),!0;Ba=Ba.getBounds();return Ba.width||Ba.height?!1:(this.Mnh(R),!0)}Mnh(R){this.iZb.contains(R)||this.iZb.add(R)}Boh(R,Ba){Ba=Ba.id;let lb;({value:lb}=this.RYb.Fc(Ba)).returnValue||(lb=new mb.a,this.RYb.Z(Ba,lb));lb.add(R)}Y8d(){const R=new mb.a;for(let Ba=
this.iZb.count-1;0<=Ba;Ba--){const lb=this.iZb.J(Ba);this.K7f(lb)||R.add(lb)}this.iZb=R;this.J6e()}J6e(){this.bO&&this.bO.J6e()&&this.qFj(!1)}qFj(R){this.bO&&(this.bO.TPk(R)&&(this.tMe=!0),this.bO.s5n(),this.ucb.mFj(this.bO.UQc()),xm.WoncaApp.instance.KHb&&Sg.nzf&&this.bO.Jog())}$8d(R,Ba){try{const lb=Ba.id;if(this.RYb.nb(lb)){const Vb=this.RYb.J(lb);for(R=0;R<Vb.count;R++)this.Mnh(Vb.J(R));this.RYb.remove(lb)}}catch(lb){}}h_c(){this.xta&&(this.xta=!1,Sg.ny.h_c())}g_c(){this.xta||(this.xta=!0,Sg.ny.g_c())}Xqj(){this.uMe=
!1;this.Xia&&this.coc(this.Xia.toArray(),this.xta);this.Maa&&this.Maa.Wqj()}kni(){this.uMe=!0;Sg.ny.J8i();this.Maa&&this.Maa.jni();this.$Z&&this.$Z.ksm()}SAd(R,Ba,lb,Vb,zc){const Yc=this.Xia.indexOf(Ba)+1;if(0>Yc)return null;const Zd=eo.WordSectionNavigator.instance.OJ(R),$e=this.Zca(Ba,R);R=new Ye(lb,Yc,R,Ba,zc,Zd,!R||!Ba||!zc,!1,!1,$e);this.dYa.nb(Vb.id)||this.dYa.Z(Vb.id,new mb.a);this.dYa.J(Vb.id).add(R);return R}Zca(R,Ba){if(!R||!R.HardBreak)return!1;R=Wn.GraphIterator.eb(Ba);R.zb(7);if(R.AJ())return!1;
R.ld(23);return R.AJ()?!1:!0}i5f(R){this.xta&&(R.anchor&&R.tj?!(R=Sg.bPi(R))||this.jyb&&this.jyb.customData&&this.jyb.customData.id===R.id||(this.jyb=Object.assign(new Lc.a(3,1,500,this.jRn),{customData:R}),this.Ib.Xb(this.jyb)):va.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}n5c(){this.xta&&!this.kud&&this.Xia&&0<this.Xia.count&&(this.kud=new Lc.a(3,1,500,this.iRn),this.Ib.Xb(this.kud))}dispose(){this.zk&&this.CQh();this.hT.q7f(this.sda);
this.NN.Rce(this.SLb)}static get nzf(){null==Sg.wDe&&(Sg.wDe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Sg.wDe}static ZXl(R){let Ba=0;try{const lb=R.htmlElement,Vb=tj.a.hN(lb.firstChild.style.marginTop);R=0;const zc=Sg.qsf(lb.parentNode);if(zc){const Yc=zc.firstChild;Yc&&Yc.classList.contains("ParaWrappingDiv")&&(R=tj.a.hN(Yc.firstChild.style.marginBottom))}Ba=Math.max(Vb,R)/2}catch(lb){}return Ba}static qsf(R){let Ba=R.previousSibling;if(!Ba){var lb=R.parentNode;tj.a.MEf(lb)&&
(lb=lb.parentNode)&&(Ba=lb.previousSibling)}if(!Ba&&(R=R.parentNode,R.classList.contains("OutlineGroup")||va.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",R.tagName,R.className),(R=R.previousSibling)&&R.hasChildNodes())){Ba=R.lastChild;do{if(Ba.classList.contains("OutlineElement")||tj.a.MEf(Ba)&&Ba.classList.contains(rg.a.vec))break;Ba=Ba.previousSibling}while(Ba)}if(Ba){if(Ba.classList.contains(rg.a.vec))return Ba.lastChild.lastChild;if(tj.a.MEf(Ba))return Ba.lastChild}return Ba}static bPi(R){R=
Wn.GraphIterator.eb(R);return R.zb(23)?R.ld(23):null}uci(){return this.uwe+1}}Sg.ny=null;Sg.wDe=null;Object(f.a)(Sg,"PageEndMarkers",null,[1680,1681,10]);var Eg=c(140);class mh{constructor(R,Ba,lb){this.Hvn=".Outline";this.fM=R;this.fn=Ba;this.ny=lb}get zk(){const R=this.fM.value;va.ULS.shipAssertTag(38416594,336,R.Vi,"Invalid PageView.");return R}R8b(R){return(R=R.outlineNode)?this.lci(R):(va.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}lci(R){let Ba,lb;return(Ba=R.pe(this.zk.$b))&&
(lb=Ba.htmlElement)?lb.querySelector(this.Hvn):(va.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}b6h(R){R=gl.OutlineElementNavigator.Hl(R.paragraphNode);let Ba;return R&&(Ba=R.pe(this.zk.$b))?Ba.htmlElement:(va.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}mzh(R,Ba){const lb=this.Mim(R);return this.MPk(R,Ba)-lb}x7h(R){return this.qci(R.outlineNode,R.Ch)}qci(R,Ba){if(!R)return-1;var lb=R.ja(kl.a.rv,-1);lb=Um.a.Ki(lb,1);var Vb=R.ja(kl.a.marginTop,
-1);Vb=Um.a.Ki(Vb,1);R=R.ja(kl.a.marginBottom,-1);R=Um.a.Ki(R,1);return 1===Ba?lb-R:lb-(Vb+R)}Sil(R){R&&tj.a.ox(R.Gnb)}lsf(R){if(R.tCi||R.Zca)return 0;if(R.f4a)return R=this.R8b(R),oa.a.getElementBounds(R).height/this.fn.ij;const Ba=this.R8b(R);return this.ny.d5e(this.vci(R),Ba)}Y7k(R,Ba,lb){lb=lb.pe(this.zk.$b).getBounds();R=R.pe(this.zk.$b);const Vb=R.getBounds();lb.y=Vb.y;Ba=this.ny.C7h(0,Ba*this.fn.ij,!1,lb,lb,Vb);R.Wba.appendChild(Ba);return Ba}Lri(R,Ba){if(R&&!R.w_d)if(R.f4a){if(R=this.R8b(R))R.style.paddingBottom=
Ba+"px"}else if(R.ZU&&R.ZU.HardBreak)if(R.Zca){if(R=this.Mdi(R))R.style.paddingBottom=Ba+"px"}else{if(R=this.b6h(R))R.style.paddingTop=Ba+"px"}else va.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Cqh(R,Ba){Ba=this.R8b(Ba);R=this.R8b(R);return oa.a.REa(Ba)-oa.a.REa(R)}Ndi(R){R=Wn.GraphIterator.eb(R.outlineNode);R.zb(7);return R.AJ()}qzi(R){if(!R||R.w_d)return!1;if(R.f4a||R.tCi)return!0;R=this.vci(R);return!!R&&tj.a.B8(R)}MR(R){this.ny.MR(R)}Mdi(R){return(R=
this.Ndi(R))?(R=R.vj(this.zk.$b).htmlElement,R?R:(va.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}vci(R){return R.ZU&&R.ZU.HardBreak&&!R.Zca?this.ny.qSd(R.Gnb):R.Gnb}Mim(R){if(R.f4a){R=this.R8b(R);if(!R)return va.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;R=Eg.a.zB(R);return tj.a.Hha(R.paddingBottom)}if(R.ZU&&R.ZU.HardBreak){if(R.Zca)return(R=this.Mdi(R))?tj.a.Hha(R.style.paddingBottom):-1;R=this.b6h(R);return R?tj.a.Hha(R.style.paddingTop):(va.ULS.shipAssertTag(38336529,
336,!0,"Containing outline element Dom is null."),-1)}return 0}MPk(R,Ba){return this.lsf(R)-Ba}}Object(f.a)(mh,"PageFullHeightDOMHelper",null,[]);class Dh{constructor(){this.delta=this.dJj=this.Ry=0;this.Via=null;this.YOa=this.a2i=0;this.outlineGroupNode=null;this.GDa=0;this.kBf=new mb.a;this.VJd=new mb.a;this.oen=new mb.a}}Object(f.a)(Dh,"PageFullHeightInfo",null,[]);class Qj{constructor(R,Ba){this.RBa=R;this.oy=Ba}wzh(R,Ba){try{return this.JPk(R,Ba)}catch(lb){return this.oy.MR(lb.message+" "+lb.stack),
va.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",lb.message),null}}JPk(R,Ba){va.ULS.shipAssertTag(38416596,336,R.f4a||R.ZU.HardBreak);const lb=this.oy.lsf(R),Vb=this.oy.mzh(R,Ba),zc=this.RBa.jzh(R,Vb);R=Object.assign(new Dh,{GDa:Vb,YOa:zc,Via:R});this.yUo(R);R.dJj=R.YOa-R.GDa;R.delta=Ba+zc+R.delta-lb;return R}yUo(R){R.GDa>R.YOa?this.zUo(R):0>R.GDa&&this.kog(R)}kog(R){let Ba=R.Via.Ch;for(;0>R.GDa;)R.Ry--,R.delta-=this.RBa.CPc(Ba),R.GDa+=this.RBa.CPc(Ba-
1),Ba--;R.YOa=this.RBa.CPc(Ba)}zUo(R){const Ba=this.oy.x7h(R.Via);R.Ry=Math.floor((R.GDa-R.YOa)/Ba)+1;R.delta=R.Ry*Ba;R.GDa-=R.YOa+(R.Ry-1)*Ba;R.YOa=Ba}}Object(f.a)(Qj,"PageFullHeightInfoCalculator",null,[]);class Mh{constructor(R,Ba,lb,Vb){this.vZa=0;this.nNa=null;this.RBa=R;this.oxb=Ba;this.EQ=lb;this.oy=Vb;this.Ebh=new mb.a}get $Y(){return this.Ebh}Cnm(R){try{this.Zwf(R)}catch(Ba){this.oy.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",
Ba.message)}}reset(R){try{this.J3n(R)}catch(Ba){this.oy.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",Ba.message)}}ksm(){try{this.lsm()}catch(R){this.oy.MR(R.message+" "+R.stack),va.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",R.message)}}VBm(R){try{this.WBm(R)}catch(Ba){this.oy.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",
Ba.message)}}CYn(R){try{this.DYn(R)}catch(Ba){this.oy.MR("Pagination: "+Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",Ba.message)}}Iym(){var R=this.EQ.TQd(),Ba=this.EQ.W$h();R=Ye.v$k(R);Ba=Ye.u$k(this.vZa,Ba);this.$Y.Z(0,R);this.Zwf(Ba)}N3n(){var R=eo.WordSectionNavigator.instance.W$h();(R=this.oy.lci(R).parentNode)&&""!==R.style.minHeight&&(R.style.minHeight="")}Fzm(R){this.Ebh=new mb.a;this.$Y.add(null);
for(let Ba=0;Ba<R.length;Ba++){const lb=Ye.q5b(Ba+1,R[Ba]);this.$Y.add(lb)}this.$Y.add(Ye.q5b(R.length+1,null))}qzm(R){this.RBa.U3n(R)}t4n(){if(this.$Y)for(const R of this.$Y)R&&this.gxi(R)&&this.oy.Lri(R,0)}Zwf(R){const Ba=this.N8l(R);if(this.oy.qzi(Ba)){let lb=this.oy.lsf(Ba);R.outlineNode!==Ba.outlineNode&&(lb+=this.oy.Cqh(R,Ba));this.SOk(R,lb);this.gxi(R)&&this.L7f(R,lb)}else this.nNa.add(R),20<this.nNa.count&&va.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.nNa.count);
this.$Y.Z(R.Ch,R);this.snm(R)}lsm(){this.t4n()}J3n(R){this.vZa=R.length+1;this.nNa=new mb.a;this.Fzm(R);this.qzm(this.vZa);this.Iym();this.N3n()}WBm(R){this.RBa.PVo(R);for(const Ba of R){if(!Ba){va.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<Ba.Ry){R=Ba.Via.Ch;for(const lb of Ba.kBf)this.$Y.insert(R,lb),R++}else if(0>Ba.Ry)for(const lb of Ba.VJd)this.$Y.remove(lb),this.nNa.contains(lb)&&this.nNa.remove(lb)}this.Xaj()}DYn(R){R=R.Ch;this.RBa.EYn(R);this.$Y.removeAt(R);for(const Ba of this.nNa)Ba.Ch===
R&&this.nNa.remove(Ba);this.Xaj()}SOk(R,Ba){Ba=this.oy.mzh(R,Ba);this.RBa.jzh(R,Ba)}L7f(R,Ba){R.ZU&&R.ZU.HardBreak||this.oxb.L7f(R,Ba)}snm(R){R=R.Ch+1;for(const Ba of this.nNa)if(Ba&&Ba.Ch===R){this.Zwf(Ba);this.nNa.remove(Ba);break}}Xaj(){for(let R=0;R<this.$Y.count;R++){const Ba=this.$Y.J(R);Ba&&Ba.Bge(R)}}gxi(R){R=this.W5l(R);return 2===R||1===R}N8l(R){return this.$Y.J(R.Ch-1)}W5l(R){return R.f4a?2:R.ZU&&R.ZU.HardBreak?1:0}}Object(f.a)(Mh,"PageFullHeightManager",null,[1765]);class Bi{constructor(R,
Ba,lb,Vb){this.oxb=R;this.RBa=Ba;this.EQ=lb;this.oy=Vb}create(){return new Mh(this.RBa,this.oxb,this.EQ,this.oy)}}Object(f.a)(Bi,"PageFullHeightManagerFactory",null,[]);var hl=c(1104),Vm=c(599);class Do{constructor(R,Ba,lb,Vb,zc){this.jZb=null;this.$Z=R;this.bO=Ba;this.$zc=lb;this.oxb=Vb;this.oy=zc}reset(){this.jZb=new mb.a}IPk(R,Ba,lb){try{return this.KPk(R,Ba,lb)}catch(Vb){return va.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",
Vb.message),null}}p5n(){try{this.q5n()}catch(R){va.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",R.message)}}KPk(R,Ba,lb){if(!this.$Z.$Y.count)return null;const Vb=this.a6l(R,!R);if(!Vb||Vb.w_d)return va.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Vb.ZU&&Vb.ZU.HardBreak)return null;var zc=this.$Z.$Y.J(Vb.Ch-1);return this.oy.qzi(zc)&&(Ba-=lb,Vb.outlineNode!==zc.outlineNode&&
(Ba+=this.oy.Cqh(Vb,zc)),(zc=this.$zc.wzh(Vb,Ba))&&1<Math.abs(zc.delta))?(zc.a2i=Ba,zc.outlineGroupNode=this.I5l(R,Vb),this.jZb.add(zc),this.kog(zc),zc):null}I5l(R,Ba){return Ba&&Ba.f4a?(R=Object(yb.a)(Vm.a,Kj.ParagraphReader.YD(Ba.outlineNode)),R=Wn.GraphIterator.eb(R),R.gp(),Object(yb.a)(hl.a,R.ld(23))):R&&R.Ekb?R.outlineGroupNode:null}q5n(){this.jZb.Sc((R,Ba)=>Ba.Via.Ch-R.Via.Ch);for(const R of this.jZb)this.oxb.Iaj(R);this.SVo()}SVo(){this.bO.value.TBm(this.jZb);this.$Z.VBm(this.jZb)}a6l(R,Ba){return Ba?
this.$Z.$Y.J(this.$Z.$Y.count-1):this.$Z.$Y.J(R.Ch)}kog(R){let Ba=R.Via.Ch;const lb=-R.Ry;for(let Vb=0;Vb<lb;Vb++)Ba--,R.VJd.add(this.$Z.$Y.J(Ba))}}Object(f.a)(Do,"PageFullHeightPositionUpdater",null,[1764]);class on{constructor(R,Ba,lb,Vb,zc){this.$Z=R;this.bO=Ba;this.$zc=lb;this.oxb=Vb;this.oy=zc}create(){return new Do(this.$Z,this.bO,this.$zc,this.oxb,this.oy)}}Object(f.a)(on,"PageFullHeightPositionUpdaterFactory",null,[]);class vp{constructor(R,Ba){this.oy=R;this.$zc=Ba}L7f(R,Ba){try{this.B0n(R,
Ba)}catch(lb){this.oy.MR(lb.message+" "+lb.stack),va.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",lb.message)}}Iaj(R){try{this.A0n(R)}catch(Ba){this.oy.MR(Ba.message+" "+Ba.stack),va.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",Ba.message)}}B0n(R,Ba){va.ULS.shipAssertTag(38285913,336,R.f4a||R.ZU.HardBreak);R=this.$zc.wzh(R,Ba);this.Iaj(R)}A0n(R){this.z0n(R);this.s0n(R)}s0n(R){0<R.Ry?this.eCm(R):0>R.Ry&&
this.Til(R)}z0n(R){this.oy.Lri(R.Via,R.dJj)}eCm(R){let Ba=R.a2i+R.YOa;for(let Vb=0;Vb<R.Ry;Vb++){var lb=R.Via.Ch+Vb;const zc=R.Via.Zca?this.oy.Ndi(R.Via):R.Via.outlineNode;lb=this.X7k(zc,R.outlineGroupNode,Ba,lb);R.kBf.add(lb);R.oen.add(Ba);Ba+=R.YOa}}Til(R){for(const Ba of R.VJd)this.oy.Sil(Ba)}X7k(R,Ba,lb,Vb){Ba=this.oy.Y7k(R,lb,Ba);return Ye.B$e(lb,Vb,Ba,R,!1,!1)}}Object(f.a)(vp,"PageFullHeightRenderer",null,[]);class Zp{constructor(R){this.k4f=R}}Object(f.a)(Zp,"PageHeightDeltaResult",null,[1761]);
class fs{constructor(R,Ba,lb){this.Jp=null;this.oy=R;this.oi=Ba;lb.execute(Vb=>{Vb.register(this)})}get P_c(){return"PageHeightDelta"}get result(){return this.Jp}get ySf(){return 1}get U$f(){return 500}get isEnabled(){return!0}HSf(){this.Jp=null}kDa(R){this.oi.ge(()=>{try{this.gHc(R)}catch(Ba){va.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",Ba.message)}},"PHDM:C")}gHc(R){this.Jp=null;R=this.hHc(R);-1!==R&&(this.Jp=new Zp(R))}hHc(R){if(!R.count)return-1;
let Ba=0,lb=0;for(const Vb of R)R=this.LPk(Vb),-1!==R&&(Ba+=R,lb++);return lb?Ba/lb:-1}LPk(R){if(!R.cKm)return-1;const Ba=this.oy.qci(R.tDd,R.Ch);return-1===Ba?-1:Math.abs(R.height-Ba)}}Object(f.a)(fs,"PageHeightDeltaMetric",null,[1739]);class pn{constructor(R){this.QWa=null;this.oy=R}CPc(R){return this.QWa.J(R-1)}U3n(R){this.QWa=new mb.a;for(let Ba=0;Ba<R;Ba++)this.QWa.add(-1)}jzh(R,Ba){if(this.qPm(R))return this.QWa.J(R.Ch-1);Ba=this.kPk(R,Ba);this.GBo(R,Ba);return Ba}PVo(R){for(const Ba of R)this.OVo(Ba)}GBo(R,
Ba){this.QWa.Z(R.Ch-1,Ba)}EYn(R){this.QWa.removeAt(R-1)}OVo(R){if(R)if(0<R.Ry){var Ba=R.Via.Ch;for(var lb=0;lb<R.Ry;lb++)this.QWa.insert(Ba,R.YOa)}else if(0>R.Ry)for(Ba=-R.Ry,R=R.Via.Ch-Ba,lb=0;lb<Ba;lb++)this.QWa.removeAt(R)}qPm(R){return-1!==this.QWa.J(R.Ch-1)}kPk(R,Ba){if(R.f4a||R.ZU.HardBreak)R=this.oy.x7h(R),Ba=Ba<R?R:Ba;return Ba}}Object(f.a)(pn,"PageHeightStorage",null,[]);var qn=c(110);class gf{constructor(R){this.k4f=R}}Object(f.a)(gf,"PageLevelDeltaResult",null,[1761]);class cm{constructor(R,
Ba,lb,Vb){this.Jp=null;this.fM=R;this.aua=Ba;this.oi=lb;Vb.execute(zc=>{zc.register(this)})}get zk(){const R=this.fM.value;va.ULS.shipAssertTag(39081438,336,R.Vi,"PageLevelDeltaMetric.PageView is not a PageView.");return R}get P_c(){return"PageLevelDelta"}get result(){return this.Jp}get ySf(){return 0}get U$f(){return 60}get isEnabled(){return!0}HSf(){this.Jp=null}kDa(R){this.oi.ge(()=>{try{this.gHc(R)}catch(Ba){va.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",
Ba.message)}},"PLDM:C")}gHc(R){this.Jp=null;R=this.hHc(R);-1!==R&&(this.Jp=new gf(R))}hHc(R){if(!R.count)return-1;let Ba=0,lb=0;for(const Vb of R)R=this.NPk(Vb),-1!==R&&(Ba+=R,lb++);return lb?Ba/lb:-1}NPk(R){if(R.Ekb)return-1;var Ba=R.ZU.CP;R=R.paragraphNode;va.ULS.shipAssertTag(39081441,336,!!R);R=R.pe(this.zk.$b);va.ULS.shipAssertTag(39081442,324,Object(qn.a)(105,R));let lb;({nJh:Ba,oFi:R,Wdj:lb}=this.APk(R,tj.a.Ey(R.htmlElement).length,Ba));return R&&lb?Math.min(Ba.x-R.x,lb.x-Ba.x):(va.ULS.sendTraceTag(39081443,
336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}APk(R,Ba,lb){let Vb,zc,Yc,Zd=zc=lb,$e=Yc=Vb=null;if(lb>Ba)return va.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{nJh:$e,bZm:Zd,oFi:Yc,Q6n:zc,Wdj:Vb};$e=this.aua.Tq(R,lb);for(var pa=0,Ma=lb;pa<=Ma;){const ya=Math.floor((pa+Ma)/2),wa=this.aua.Tq(R,ya);if(pa===Ma){Zd=ya;Yc=wa;break}wa.y+wa.height<=$e.y?pa=ya+1:Ma=ya}for(;lb<=
Ba;){pa=Math.ceil((lb+Ba)/2);Ma=this.aua.Tq(R,pa);if(lb===Ba){zc=pa;Vb=Ma;break}Ma.y>=$e.y+$e.height?Ba=pa-1:lb=pa}return{nJh:$e,bZm:Zd,oFi:Yc,Q6n:zc,Wdj:Vb}}}Object(f.a)(cm,"PageLevelDeltaMetric",null,[1739]);class vo{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.Ch=R;this.top=Ba;this.nlh=lb;this.height=Vb;this.JRb=zc;this.tDd=Yc;this.cKm=Zd}}Object(f.a)(vo,"Page",null,[]);class Cn{constructor(R,Ba,lb,Vb,zc){this.dZb=null;this.Tgh=0;this.fM=R;this.pjd=Ba;this.C9g=lb;this.oMa=Vb;this.E9g=zc;this.fYa=new mb.a}get zk(){const R=
this.fM.value;va.ULS.shipAssertTag(37007393,336,R.Vi,"PageManager.PageView is not a PageView.");return R}get Yk(){return this.fYa}mFj(R){R=this.e6i(R);this.oFj(R)}MVo(R,Ba){this.Tgh=Ba;R=this.e6i(R);this.oFj(R);this.E9g.isEnabled&&this.E9g.kDa(R)}e6i(R){this.fYa=new mb.a;this.dZb=new Pe.a(0);const Ba=new mb.a;if(!R)return this.Yk;var lb=0,Vb=null;for(let zc=0;zc<R.count;zc++){const Yc=R.J(zc);lb=Yc.Ch;Vb=this.vId(lb,Vb,Yc);this.Yk.add(Vb);!Cn.tKe&&0>Vb.height&&Ba.add(Vb);Vb=Yc}R=this.vId(lb+1,Vb,
null);this.Yk.add(R);!Cn.tKe&&0>R.height&&Ba.add(R);for(const zc of Ba)Cn.tKe=!0,va.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+zc.Ch);return this.Yk}vId(R,Ba,lb){const Vb=Ba?Ba.outlineNode:this.oMa.G8h(),zc=lb?lb.outlineNode:this.oMa.bai();var Yc=this.rci(Vb);const Zd=this.rci(zc),$e=Ba?this.tzh(Ba):0;Yc=$e+Yc;const pa=lb?this.tzh(lb):this.pjd.T5a.clientHeight-Zd;return new vo(R,$e,Yc,Vb.id===zc.id?pa-$e:pa+Zd-Yc,Vb,zc,(lb?lb.Ch:this.Tgh+1)===(Ba?Ba.Ch:
0)+1)}tzh(R){return R.Zca?0:R.top}oFj(R){if(this.C9g.S8d)for(const Ba of this.C9g.S8d)Ba&&Ba.pFj(R)}rci(R){this.dZb||(this.dZb=new Pe.a(0));if(this.dZb.nb(R.id))return this.dZb.J(R.id);var Ba=R.pe(this.zk.$b);if(!Ba)return va.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;Ba=oa.a.y2a(this.pjd.T5a,Ba.htmlElement).y;this.dZb.Z(R.id,Ba);return Ba}}Cn.tKe=!1;Object(f.a)(Cn,"PageManager",null,[1741]);var hr=c(625);class Mo{constructor(R,Ba,lb,Vb,zc,Yc,Zd,
$e){this.Trj=$e;this.Dpg=this.U5a=!1;this.pin=(pa,Ma)=>{0!==Ma.Emb||this.Dpg?this.yRh():this.eVh()};this.ga=R;this.Pfa=Ba;this.lVb=lb;this.ut=Vb;this.Ti=zc;this.G9g=Yc;this.KI=Zd;$e||(this.U5a=0===this.KI.mu,this.KI.hph(this.pin))}Tb(){this.ga.fb(gh.a.K4c,zi.a.application,this.K4c.bind(this),96);this.ga.fb(gh.a.lbe,zi.a.application,this.lbe.bind(this),96);this.ga.fb(gh.a.Ale,zi.a.application,this.Ale.bind(this),96);this.ga.fb(gh.a.xle,zi.a.application,this.xle.bind(this),8)}Ale(R,Ba,lb){return 1===
lb?32:this.ga.processAction(gh.a.t8a,2)}xle(R,Ba,lb,Vb){if(1===lb)return this.Trj?8:0===this.KI.mu?32:8;this.U5a?(this.yRh(),this.Dpg=!0):(this.eVh(),this.Dpg=!1);this.Ti.updateCommandUI();Vb.As=this.U5a?1:0;return 32}K4c(R,Ba,lb,Vb,zc){if(1===lb)return 32;R=this.G9g.HGb();-1===R?R="":this.U5a||1===this.KI.mu?(Ba=this.G9g.tSl(),Ba>R&&(R=Ba),R=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,Ba,R)):R=1===R?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,
R):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,R);zc[hr.a.Visible]=!0;zc[hr.a.LabelText]=R;return 32}lbe(R,Ba,lb,Vb,zc){if(1===lb)return 32;zc[ci.a.On]=this.U5a;return 32}eVh(){this.U5a||this.Trj||(this.lVb.ctl(),this.ut.Xqj(),this.U5a=!0)}yRh(){this.U5a&&(this.lVb.sml(),this.ut.kni(),this.U5a=!1)}}Object(f.a)(Mo,"PaginationActor",null,[]);class Rq{constructor(R){this.k4f=R}}Object(f.a)(Rq,"PaginationDeltaResult",null,[1761]);class Gq{constructor(R,Ba){this.Nxb=this.qkd=null;this.oi=
R;Ba.execute(lb=>{lb.register(this)})}get P_c(){return"PaginationDelta"}get result(){return this.qkd}get ySf(){return 1}get U$f(){return 200}get isEnabled(){return!0}HSf(){this.qkd=null}kDa(R){this.oi.ge(()=>{try{this.gHc(R)}catch(Ba){va.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",Ba.message)}},"PDM:C")}dig(R){this.Nxb=R}gHc(R){this.qkd=null;R=this.hHc(this.Nxb,R);-1!==R&&(this.qkd=new Rq(R))}hHc(R,Ba){if(!(R&&Ba&&R.count&&Ba.count))return-1;
const lb=new mb.a;for(const Vb of R)lb.add(Vb.top);R=new mb.a;for(const Vb of Ba)R.add(Vb.top);Ba=this.LNd(lb,R);return this.G4b(Ba)}G4b(R){if(!R.count)return 0;let Ba=0;for(let lb=0;lb<R.count;lb++)Ba+=R.J(lb);return Ba/R.count}LNd(R,Ba){const lb=new mb.a;if(!R.count||!Ba.count)return lb;var Vb=R.count<=Ba.count;const zc=Vb?R:Ba;R=Vb?Ba:R;for(Ba=0;Ba<zc.count;Ba++){Vb=zc.J(Ba);let Zd=Math.abs(Vb-R.J(0)),$e=0;for(let pa=1;pa<R.count;pa++){var Yc=R.J(pa);Yc=Math.abs(Vb-Yc);Yc<Zd&&(Zd=Yc,$e=pa)}lb.add(Zd);
R.removeAt($e)}return lb}}Object(f.a)(Gq,"PaginationDeltaMetric",null,[1739]);var Sq=c(461),Np=c(1407),kq=c(2052);class ak extends Sq.a{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e=null){super();this.ZN=null;this.twe=0;this.vZa=-1;this.Yub=!1;this.KY=()=>{va.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.ARh()};this.nVf=()=>{if(0==this.hT.mu){var pa=this.ZN.Lt;wh.a.zq(pa,this.nYb)||(this.nYb=pa,this.Gnn(this.FXa,this.nYb))}};this.hT=R;this.sda=this.sda.bind(this);
this.hT.vAb(this.sda);this.ga=Ba;this.ut=lb;this.HZ=Vb;this.Wla=zc;this.sIe=$e||qo.a.instance;this.nYb=this.FXa=wh.a.nil;this.E8j=Zd;Yc.CWR(()=>Yc.result.kC.yNa(this.KY));this.p6b();this.mk=new Np.a(1E3);this.mk.E0a();this.Wla.register(this)}get Gia(){return"Pagination"}get nff(){return this.E8j.value}get ZIa(){return this.vZa}gno(R){this.vZa!==R&&(this.vZa=R,this.HZ.xog())}sda(){this.FXa=this.nYb=wh.a.nil;this.p6b()}nSa(R){this.ZN=R;this.ZN.oFc(this.nVf);this.P1b(this.ZN.node)}Gnn(R,Ba){wh.a.zq(R,
Ba)?(this.ut.g_c(),this.p6b()):(this.ut.h_c(),this.rAo())}ktl(){this.enabled=2}p6b(){this.enabled=0}rAo(){this.twe=0;this.ktl();this.fF(null,null,null)}Ioa(){return eb.App.lostSession||eb.App.xd.kC.Fo?!1:!!(this.enabled&2)&&this.mk.cY()}fF(){this.mk.Thb();this.Wla.mV()}forceOutbound(){}y4(){return 0===this.enabled?!1:this.fe&&2===this.fe.status?!0:this.Ioa()}oTa(){if(1===this._state)this.fe.Gq=kq.a.Jba(l.AFrameworkApplication.rootQuerySignature,this.FXa),this.fe.QG="Pagination",this.fe.status=1,this._state=
3;else if(3===this._state&&this.fe&&2===this.fe.status)if(l.AFrameworkApplication.Lk)this._state=4;else if(this.mk.X1(),this.mk.d9(),this._state=1,this.twe++,2!==this.fe.statusCode)this.q6b();else if(1!==(this.fe.Hj?this.fe.Hj.length:0))this.q6b();else{var R=this.fe.Hj[0];this.sIe.bVa(R);104===R.StatusCode?this.ARh():101===R.StatusCode?this.q6b():3===R.StatusCode?this.q6b():R.StatusCode?this.q6b():R.PageEnds?(this.gno(R.PageEnds.length+1),this.FXa=Ln.b(R.LastKnownPaginationRevision),va.ULS.sendTraceTag(7479449,
336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.vZa,this.FXa),this.ut.coc(R.PageEnds,wh.a.zq(this.FXa,this.nYb)),this.nff.Xia=R.PageEnds,this.HZ.Y4e(),va.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.vZa,this.FXa),this.Cml()):this.q6b()}}ARh(){this.ZN&&this.ZN.Mic(this.nVf);this.p6b()}q6b(){60<
this.twe&&this.p6b()}Cml(){wh.a.zq(this.FXa,this.nYb)&&this.p6b()}dispose(){this.ZN&&(this.ZN.Mic(this.nVf),this.ZN.node&&this.N5c(this.ZN.node),this.ZN=null);this.hT.q7f(this.sda)}P1b(R){R&&(R.addListener(this),this.Yub=!0)}N5c(R){this.Yub&&R&&(R.removeListener(this),this.Yub=!1)}bMb(R){this.N5c(R)}YGa(){}E5a(R){(R=R.vd.wm)&&this.wkn(this.FXa,R.id)}wkn(R,Ba){wh.a.zq(R,Ba)&&this.ut.g_c()}}Object(f.a)(ak,"PaginationReplicator",Sq.a,[1678,10,95]);class Hm{get r_d(){return!0}coc(){}h_c(){}g_c(){}Xqj(){}kni(){}dispose(){}i5f(){}n5c(){}}
Object(f.a)(Hm,"PageEndMarkersNoOp",null,[1680,1681,10]);class Wl{dispose(){}nSa(){}get ZIa(){return-1}}Object(f.a)(Wl,"PaginationReplicatorNoOp",null,[1678,10]);class gp{constructor(){this.Maa=this.ut=this.HZ=this.lVb=this.Dv=null;this.mta=!1;this.wBk=()=>{this.Erh()}}get name(){return"WordEditor.Pagination"}wc(R){this.W=R;this.od=this.W.resolve("Box4.IFeatureHelper");this.W.ia("WordEditor.Pagination.PageElementManagerList",()=>new Qc(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.OutlineManager",()=>new Vl(new Mb.a(()=>eb.App.za.jb.qc))).as("WordEditor.Pagination.IOutlineManager").ha();this.W.ia("WordEditor.Pagination.PageManager",()=>new Cn(new Mb.a(()=>eb.App.za.jb.qc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").ha();
this.W.ia("WordEditor.IPaginationReplicator",()=>this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Qie?new Wl:new ak(this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),ui.App.L1,eb.App.Foa(),new Mb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).ha();this.W.ia("WordEditor.ICurrentPageManager",()=>new mn(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();
this.W.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new cm(new Mb.a(()=>eb.App.za.jb.qc),this.W.resolve("Box4.ITextMetricsAdapter"),cf.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightDeltaMetric",()=>new fs(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),cf.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new Gq(cf.a.instance,
this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightStorage",()=>new pn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new mh(new Mb.a(()=>eb.App.za.jb.qc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new Qj(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),
this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightRenderer",()=>new vp(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new on(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Re("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),
this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new Sd(new Mb.a(()=>eb.App.za.jb.qc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),
this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),eb.App.ni.zl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").ha();this.W.ia("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Bi(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),eo.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();
this.W.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new ub(this.W.resolve("Common.IZoomManager"),cf.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").ha();this.W.ia("WordEditor.Pagination.PaginationActor",()=>new Mo(l.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ua,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"),this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Qie)).ha();this.W.ia("WordEditor.Pagination.DocumentSizeManager",()=>new nn(new Mb.a(()=>eb.App.za.jb.qc),up.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).ha();this.W.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new $k(l.AFrameworkApplication.va,
Ah.a.instance,lj.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new Mb.a(()=>eb.App.za.jb.qc),this.W.Oa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").ha();this.W.ia("WordEditor.Pagination.IPageEndMarkers",()=>{this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Qie?this.ut=new Hm:this.ut=new Sg(new Mb.a(()=>eb.App.za.jb.qc),new Mb.a(()=>eb.App.za.jb.Yc.vd),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),om.a.CQc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),lj.a.instance,Sg.ZXl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Gm.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"));return this.ut}).as("Box4.IPaginationRefreshHelper").ha();this.W.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new na(this.W.Ta("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!eb.App.instance&&eb.App.instance.cD)).ha();this.W.ia("WordEditor.Pagination.PageAdornmentAnimationManager",
()=>new pm(l.AFrameworkApplication.oc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new fo(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentManager",()=>this.Maa=new hk(new Mb.a(()=>eb.App.za.jb.qc),fm.a.instance,ql.a.instance,Fe.a.instance,l.AFrameworkApplication.va,ln.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),
this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),lj.a.instance,l.AFrameworkApplication.K,!!eb.App.instance&&eb.App.instance.cD,!!eb.App.instance&&eb.App.instance.tpa)).as("WordEditor.Pagination.IPageAdornmentManager").ha()}init(){this.od.lq.continueWith(()=>{this.sn()})}sn(){const R=eb.App.za.jb;R.mxa?this.Erh():R.fga(this.wBk)}Erh(){this.mta||(this.mta=!0,this.lVb=ta.a.instance.resolve("WordEditor.ICurrentPageManager"),
this.HZ=ta.a.instance.resolve("Common.ICurrentPageCalculator"),this.Dv=ta.a.instance.resolve("WordEditor.IPaginationReplicator"),ta.a.instance.resolve("WordEditor.Pagination.PaginationActor").Tb())}dispose(){this.Maa&&(this.Maa.dispose(),this.Maa=null);this.ut&&(this.ut.dispose(),this.ut=null);this.Dv&&(this.Dv.dispose(),this.Dv=null);this.HZ&&(this.HZ.disable(),this.HZ=null);this.lVb&&(this.lVb=null)}}Object(f.a)(gp,"PackageManager",null,[1,2]);class ir{constructor(){this.W=null}wc(R){this.W=R||
ta.a.instance}dispose(){}}Object(f.a)(ir,"TellMePackage",null,[1,2]);var Pn=c(1504),zt=c(1506),yr=c(344),Ia=c(1503),Db=c(1395);class lc{constructor(R=null,Ba=null,lb=null,Vb,zc=null){this.ase=null;this.GJg=!1;this.bUg=this.cUb=null;this.$hk=this.Reh=this.vUj=this.cUg=!1;this.Phd=null;this.JUj=null==Ba?l.AFrameworkApplication.NAb:Ba;this.r5j=null==lb?l.AFrameworkApplication.u0:lb;this.Iik=null==zc?l.AFrameworkApplication.T7a:zc;this.S3j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");
this.skk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.eno(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.jkk=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.IXc;this.kkk=!Ia.a.lpa()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.ikk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.T0j=!!l.AFrameworkApplication.ua&&
l.AFrameworkApplication.ua.Lb.pQb;this.lkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.Fhk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.Tbk=this.B9c||this.A9c;this.Rbk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.Sbk=this.$Ef;this.D7j=!!l.AFrameworkApplication.K&&this.GUa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.p2j=
l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.V2j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.d2j=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.A7j=!!l.AFrameworkApplication.K&&
(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.e7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.Z7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.O5j=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.BVm||this.jPm);this.K_b=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.qjk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";
this.Y2j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.Ghk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.tik=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.Whk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||
this.PP;this.O7j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.a7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.t7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===
l.AFrameworkApplication.uiCulture;this.L7j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.a8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.wUj=this.GUa&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.y3j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.zik=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==l.AFrameworkApplication.K.kb("Application"));this.ZVj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.imk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.R5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.V5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.U2j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.N7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.JTm;this.T5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.U5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.S5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.$_j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.a0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.mkk=this.gCi&&(this.ZXf||this.$Xf||this.R1c||this.GUa&&Ia.a.xpa()&&!!l.AFrameworkApplication.K&&(this.dlc||this.tQb||this.uQb||this.vQb||this.xQb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||
l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.vTj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.$Ca;this.wTj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.rym(R||{});this.KQe=
"2918242107";this.JQe="1454393937";this.yxb={};this.Odb=[];this.O4k=[Ia.a.rme]}get application(){return this.cUb}get NAb(){return this.JUj}get n$n(){return this.KQe}get m$n(){return this.JQe}get Djf(){return this.bUg}get FZh(){return this.cUg}get u0(){return this.r5j}get T7a(){return this.Iik}get IAb(){return this.vUj}get Srm(){return this.S3j}get sGo(){return this.skk}get gCi(){return!0}get jGo(){return this.mkk}get fqo(){return this.Reh}eno(R){this.Reh=R}get GUa(){return this.jkk}get Iad(){return this.kkk}get Gad(){return this.ikk}get bAl(){return this.T0j}get hGo(){return this.lkk}get Yle(){return!1}get R1c(){return this.Tbk}get ZXf(){return this.Rbk}get $Xf(){return this.Sbk}get x4a(){return!1}get n0d(){return!1}get NGf(){return this.D7j}get Phe(){return this.$hk}get dlc(){return!1}get Iro(){return!1}get aZm(){return""}get brf(){return 2}get G9l(){return 4}get H9l(){return 5}get Cfi(){return""}get xVl(){return this.p2j}get Sfi(){return this.V2j}get Efi(){return 1E3}get Dfi(){return 1E-6}get ECo(){return this.qjk}get Fig(){return!1}get gvj(){return!1}get uRm(){return this.t7j}get W_d(){return!1}get X_d(){return!1}get Gyi(){return!1}get Fyi(){return!1}get JTm(){return!1}get hCi(){return!1}get ANd(){return!1}get Npb(){return!1}get tQb(){return!1}get uQb(){return!1}get vQb(){return!1}get xQb(){return!1}get B9c(){return this.Fhk}get Zkc(){return this.Ghk}get A9c(){return!1}get kof(){return null}get Q_d(){return!1}get Hhe(){return this.Whk}get Qbi(){return 0}get pPl(){return this.d2j}get zgi(){return this.Y2j}get DSm(){return this.A7j}get UBf(){return this.O5j}get Ghe(){return this.K_b}get s3l(){return-3.9}get PP(){return this.tik}get JXc(){return this.O7j}get lFf(){return this.a7j}get gHf(){return this.L7j}get Geb(){return this.wUj}get JVm(){return this.a8j}get Pwa(){return this.y3j}get gsj(){return this.zik}get zKk(){return this.ZVj}get Xne(){return this.imk}get YXd(){return this.R5j}get tFm(){return this.V5j}get fv(){return this.U2j}get olb(){return this.N7j}get rFm(){return this.T5j}get sFm(){return this.U5j}get qFm(){return this.S5j}get dyk(){return this.vTj}get eyk(){return this.wTj}get Yga(){return this.$_j}get DLd(){return this.a0j}get BVm(){return this.Z7j}get jPm(){return this.e7j}get uJb(){return!!l.AFrameworkApplication.ua&&
l.AFrameworkApplication.ua.Lb.Er}get Er(){return!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.Er}get eOm(){return!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.blc}get Nen(){return Je.getImageClass("OfficeAssistant_32x32x32")}MQd(){return Promise.reject("GetFindMatchCount method is not overridden")}F0d(R){return Array.contains(appChrome.selectors.getVisibleControlIds(),R)}IYd(){return!1}get b_d(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get Vwj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.kb("TellMeServiceHelpClassifierModelName"):""}get $Ef(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get mHb(){return"NoOpHeaderUi"}get H4k(){return this.Phd}get parameterData(){return this.yxb}get ENo(){return this.Odb}Jvl(){if(this.ase&&!this.GJg&&(this.GJg=!0,this.Fpb(this.ase),this.Er)){var R=ta.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");R=(new Db.a(R)).cPd(this.ase.$G);appChrome.api.dispatch(R)}}get dag(){return""}Fpb(){}ill(R){const Ba=
[];for(let lb=0;lb<R.length;++lb)R[lb].Cso?Ba.push(new yr.a(R[lb].Nm,Ia.a.qBj+lb.toString())):Ba.push(new yr.a(R[lb].standard,Ia.a.rme+lb.toString()));return Ba}rym(R){const Ba={};for(let lb in R){const Vb=lb,zc=R[lb];for(let Yc in zc){const Zd=Yc,$e=zc[Yc];(Ba[Zd]||(Ba[Zd]={}))[Vb]=$e}}this.Phd=Ba}get Wwj(){return""}get Sqj(){return!1}}Object(f.a)(lc,"TellMeApplicationData",null,[1096]);class Gc{constructor(R,Ba=null,lb=!1){this.standard=R;this.Nm=Ba;this.Cso=lb}}Object(f.a)(Gc,"TryQuerySet",null,
[]);class id{constructor(){this.e6g=this.f6g=null}get hcn(){return this.e6g}Mga(R){this.f6g=R;return this.uaf(R)}Wfn(){this.e6g=this.f6g}ERd(R){return 8===R.type?String.format(CommonUIStrings.l_FindInDocumentText,R.fD):R.fD}Mnf(R){return R.fD}}Object(f.a)(id,"ParameterizedCommand",null,[]);class je extends id{constructor(R){super();this.sXc=R}get commandId(){return this.sXc?"DefinitionsParameterized":"DefinitionButton"}get AZf(){return"Definition"}uaf(R){const Ba=Xa.a.vf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
R.fD));return ok.a(Ia.a.ibf(R.value),m.a.Qcf.toString(),Ba,Ia.a.mBf,null,Xa.a.vf(Ia.a.QCb(R.fD)),Ba,null,null)}ERd(R){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,R.fD)}Mnf(R){return Ia.a.QCb(R.fD)}}Object(f.a)(je,"DefinitionsParameterizedCommand",id,[]);class ef extends id{constructor(R){super();this.sXc=R}get commandId(){return this.sXc?l.AFrameworkApplication.ua.Lb.sKm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get AZf(){return"Find"}uaf(R){const Ba=
Xa.a.vf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,R.fD));return ok.a(Ia.a.ibf(R.value),m.a.findInDocument.toString(),Ba,"Find_16x16x32",null,Xa.a.vf(R.fD),Ba,null,null)}ERd(R){return String.format(CommonUIStrings.l_TextWithQuotation,R.fD)}}Object(f.a)(ef,"FindParameterizedCommand",id,[]);class Fa extends id{constructor(R){super();this.sXc=R}get commandId(){return this.sXc?"SynonymsParameterized":"SynonymButton"}get AZf(){return"Synonym"}uaf(R){const Ba=Xa.a.vf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
R.fD));return ok.a(Ia.a.ibf(R.value),m.a.Qcf.toString(),Ba,Ia.a.mBf,null,Xa.a.vf(Ia.a.QCb(R.fD)),Ba,null,null)}ERd(R){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,R.fD)}Mnf(R){return Ia.a.QCb(R.fD)}}Object(f.a)(Fa,"SynonymsParameterizedCommand",id,[]);var Ua=c(2061),sb=c(1973),oc=c(2096),Dc=c(2056),Xc=c(2057),rd=c(1592);class Vd extends Ua.a{constructor(){super(...arguments);this.fO=null;this.sZa=sb.FindManager.createInstance(this,oc.a.instance,rd.a.instance,
!0,!0)}static get instance(){return Vd._instance}P7b(){this.fO(this.sZa.Oj.ika);this.sZa.G_a(!0)}MQd(R){const Ba=new Promise((lb,Vb)=>{this.fO=lb;setTimeout(()=>{Vb("Find manager execution timed out");this.sZa.G_a(!0)},500)});R=Dc.a.createQuery(R,Xc.a.none);this.sZa.find(R);return Ba}}Vd._instance=new Vd;Object(f.a)(Vd,"TellMeFindStatusSpy",Ua.a,[]);class Ee extends lc{constructor(R){super({});this.cUb="Word";this.C2j=R;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.cUg=!0,this.bUg=
this.ANd?"FindWithMatchesParameterized":"FindParameterized");R=new je(this.uJb);const Ba=new Fa(this.uJb);this.parameterData[R.commandId]=R;this.parameterData[Ba.commandId]=Ba;R=new ef(this.uJb);this.parameterData[R.commandId]=R;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(R=[new Gc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Gc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Gc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Gc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Gc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.Odb=this.ill(R))}MQd(R){return Vd.instance.MQd(R)}get Z6a(){return Qq.AppFrame.Vqa}get mHb(){return Qq.AppFrame.fQa}get dag(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Fpb(R){var Ba=l.AFrameworkApplication.K;R=R.$G;R.WordCountFlyout=!this.C2j();R.SelectAllButton=!Ba.$("TellMeSelectAllResultIsEnabled");const lb=Ba.$("TellMeDesktopUpSellIsEnabled");let Vb=l.AFrameworkApplication.o0d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Vb));Vb=!1;R.TextBoxUpSellButton=!lb||Vb;R.TableOfContentsUpSellButton=!lb||Vb;R.SmartArtUpSellButton=!lb||Vb;R.WordArtUpSellButton=!lb||Vb;R.MultiColumnLayoutUpSellButton=!lb||Vb;R.InsertEquationUpSellButton=!lb||Vb;R.TrackChangesUpSellButton=!lb||Vb;R.ShapesUpSellButton=!lb||Vb;R.LabelsUpSellButton=!lb||Vb;R.InsertCitationUpSellButton=!lb||Vb;R.TextBoxUpSellButtonEnterprise=!lb||!Vb;R.TableOfContentsUpSellButtonEnterprise=
!lb||!Vb;R.SmartArtUpSellButtonEnterprise=!lb||!Vb;R.WordArtUpSellButtonEnterprise=!lb||!Vb;R.MultiColumnLayoutUpSellButtonEnterprise=!lb||!Vb;R.InsertEquationUpSellButtonEnterprise=!lb||!Vb;R.TrackChangesUpSellButtonEnterprise=!lb||!Vb;R.ShapesUpSellButtonEnterprise=!lb||!Vb;R.LabelsUpSellButtonEnterprise=!lb||!Vb;R.InsertCitationUpSellButtonEnterprise=!lb||!Vb;Ba=!Ba.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.u0;R.SynonymButton=Ba;R.DefinitionButton=Ba}get Wwj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get Fig(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get Vwj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get dlc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get $Ef(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get brf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Sqj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get n0d(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get b_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get W_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get X_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get Efi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get Dfi(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get Gyi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get Fyi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get Cfi(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get hCi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get Qbi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get gCi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Yle(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get x4a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Phe(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get gvj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get Q_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get tQb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get uQb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get vQb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get xQb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get kof(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(Ee,"WordEditorTellMeApplicationData",lc,[]);var of=c(1540),qh;(function(R){R[R.none=0]="none";R[R.waitAll=1]="waitAll";R[R.synchronizeFast=2]="synchronizeFast";R[R.synchronizeSlow=3]="synchronizeSlow"})(qh||(qh={}));Object(f.b)("ProviderSynchronizationType",qh);var ri;(function(R){R[R.immediate=0]="immediate";R[R.waitAll=1]="waitAll";R[R.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";R[R.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(ri||
(ri={}));Object(f.b)("MenuUpdatePolicy",ri);var eg=c(1510),mi=c(1508),Aj=c(1648),Bj=c(1511),qf=c(1535),Ve=c(112),lf=c(290);class og extends Ua.a{constructor(R){super();this.hnk=R}P7b(){this.hnk.update()}}Object(f.a)(og,"TellMeFindStatusManager",Ua.a,[]);class sg{constructor(R){this.Hdb=this.hMg=null;this.fi=0;this.lnd="TellMeWAC.";const Ba=R.Djf;this.fc=R;this.ykd=Ba;this.jIe=Object.assign(new of.a,{landingTab:"Indoc",data:null});R=new og(this);this.sZa=sb.FindManager.createInstance(R,oc.a.instance,
rd.a.instance,!0,!0)}lL(){return"WordFindInDocument"}rU(){return this.fc.brf?this.fc.brf===ri.waitAll?qh.waitAll:qh.synchronizeSlow:qh.none}ZH(R,Ba){this.WUm(R)?(this.Hdb=R,this.hMg=Ba,R=Dc.a.createQuery(R.Cg,Xc.a.none),this.fi=window.performance.now(),this.sZa.find(R)):Ba.resultsUpdated(new eg.a(R))}update(){this.jco(Math.round(window.performance.now()-this.fi));var R=String.format(CommonUIStrings.l_TextWithQuotation,this.Hdb.Cg);var Ba=l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.Npb?
Ia.a.uOa(this.Hdb.Cg,15,this.jIe):Xa.a.vf(this.Hdb.Cg);const lb=[];lb.push(appChrome.actions.setControlLabel(this.ykd,R));lb.push(appChrome.actions.setCompoundButtonCommandValueId(this.ykd,Ba));lb.push(appChrome.actions.updateCompoundButtonDescription(this.ykd,this.yuf()));appChrome.api.dispatch(lb);R=new mi.a(this.ykd,Aj.a.FindInDocument,this.Hdb.Cg,this.sZa.Oj.ika.toString());Ba=new Bj.a(qf.a.FindInDocument);Ba.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Ba.Rw(R);const Vb=new eg.a(this.Hdb);
Vb.$u(Ba);window.requestAnimationFrame(()=>{this.hMg.resultsUpdated(Vb)});this.sZa.G_a(!0);this.kco(Math.round(window.performance.now()-this.fi))}yuf(){const R=this.sZa.Oj.ika.toString();return"1"===R?String.format(CommonUIStrings.l_SearchResultText,R):String.format(CommonUIStrings.l_SearchResultsText,R)}WUm(R){return!!R&&!!R.Cg&&""!==R.Cg.trim()}jco(R){const Ba={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.Hdb.Cg.length};this.sendActivityEvent(Ba,R)}kco(R){const Ba={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Hdb.Cg.length};this.sendActivityEvent(Ba,R)}sendActivityEvent(R,Ba){R=Ve.a.jJ(R);Od.a.gIa(Object.assign(new lf.a,{name:"Latency",dataFields:R,durationMs:Ba}),this.lnd)}}Object(f.a)(sg,"WordFindInDocumentWithMatchesProvider",null,[1117]);class Cj{constructor(R,Ba){this.nc=R;this.wXd=
Ba}t3a(R,Ba,lb){return this.wXd.t3a(0,R,Ba,lb)}insertHtmlText(R){return R?32===this.NAf(R):!1}NAf(R){return this.executeCommand(eh.a.Lma,R)}executeCommand(R,Ba){const lb=new nm.DictionaryPropertySet;lb.setValue(fn.a.IP,Ba);lb.setValue(fn.a.Gja,!1);Ba=this.nc.processAction(R,1);32===Ba&&(Ba=this.nc.Rb(R,2,lb));return Ba}}Object(f.a)(Cj,"WordInsertContentHandler",null,[1679]);class Ti extends ir{constructor(){super();this.Wx=()=>{if(l.AFrameworkApplication.jkg){var R=eb.App.za.Lb.ntf(m.a.tellMe);R.zVc?
this.N0i():R.t_(this.U9n);var Ba=new Ee(()=>!1);Pn.TellMeActor.instance.initialize(Ba,null,null,null,null,null,Object(a.a)(eb.App.za,eb.App.za.FOd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Ta("Common.IActionContextProvider"),this.W.Ta("Common.ISystemInitiatedFeedback"));Pn.TellMeActor.instance.TRn(R);Pn.TellMeActor.instance.WTn(new Cj(l.AFrameworkApplication.va,this.W.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
Ba.FZh&&Ba.ANd&&Pn.TellMeActor.instance.QE(new sg(Ba),zt.a.tellMe)}};this.U9n=()=>{this.N0i()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Hn(this.Wx)}N0i(){eb.App.za.updateCommandUI()}}Object(f.a)(Ti,"WordEditorTellMePackage",ir,[]);class Dj{constructor(){this.W=null;this.Ywj=(R,Ba,lb)=>{2===lb&&(R=new Jh.StandardDialog,R.Cd=0,R.Uja(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>
{this.sn()})}dispose(){}sn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(128)){l.AFrameworkApplication.va.fb(gh.a.eKj,zi.a.view,this.Ywj,96);var R=Jg.FocusManager.instance().ae(Qq.AppFrame.PD);Rf.AFrame.Bi(R,bf.KeyInputManager.ic(ce.a.B9a,5|bf.KeyInputManager.Ph),gh.a.eKj)}}wc(R){this.W=R}static main(){L.a.instance.Gc(new Dj)}}Object(f.a)(Dj,"WordEditorTestFeaturePackage",null,[1,2]);var Ij=c(105);class Nk{constructor(R,Ba){this.Dej=R;this.nc=Ba;this.jfe=(lb,Vb,zc,Yc,Zd)=>{if(1===zc)return 32;
this.Dej.pN(9,Zd,!1);return 32};this.b1=(lb,Vb)=>{if(9===Vb.type){var zc;(lb=Vb.LL)?("string"===typeof lb?zc=lb:"data"===lb.type&&(zc=Ij.a.oMh(lb.FEn,lb.newState,lb.hno)),zc&&Nk.iFc(zc)):va.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.q5c()}q5c(){this.nc.ra(gh.a.jfe,y.a.frame,this.jfe);this.Dej.G3(this.b1)}dispose(){}static iFc(R){R=eb.App.za.notificationBar.sva(R,!1);R.image=5;R.Qoa="CoAuth_AuthorStatus_16x16x32";eb.App.za.notificationBar.qA(R)}}
Object(f.a)(Nk,"TrackChangeNotificationActor",null,[]);class lq{constructor(){this.fj=this.vVe=this.W=null;this.J1c=()=>{if(this.fj=eb.App.sUd().result)this.W.ia("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Nk(this.fj,l.AFrameworkApplication.va)).ha(),this.vVe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}wc(R){this.W=R}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}sn(){eb.App.sUd().continueWith(this.J1c)}dispose(){this.vVe&&
this.vVe.dispose()}}Object(f.a)(lq,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Xn=c(99),At=c(1484),jr=c(2050);class rn{}rn.qng="UnsavedChanges";rn.rng="UnsavedChangesThemed";rn.j9n="SavedChanges";rn.ACj="UnsavedChangesOpenPipe";rn.EQo="UnsavedChangesOpenPipeCssClassNameThemed";rn.zCj="UnsavedChangesClosePipe";rn.BQo="UnsavedChangesClosePipeThemed";rn.CQo="UnsavedChanges";rn.DQo="UnsavedChangesThemed";rn.sng="UnsavedChangesIndicatorPositionRef";Object(f.a)(rn,"UnsavedChangesHighlightUtils",
null,[]);class $p extends At.a{constructor(R,Ba){super();this.ifa=R;this.yx=Ba;this.V2=[this.yx?new jr.a(rn.rng,rn.DQo):new jr.a(rn.qng,rn.CQo)]}get Aca(){return!0}get Djb(){return 4}get a3a(){return this.V2}jHa(R,Ba){if(this.ifa){var lb=this.ifa.MOf;if(lb&&lb.count&&lb.contains(R.id))for(R=Ba.FHa("span"),Ba=0;Ba<R.length;Ba++)lb=R[Ba],Ba||lb.classList.add(this.yx?rn.EQo:rn.ACj),Ba===R.length-1&&lb.classList.add(this.yx?rn.BQo:rn.zCj),lb.classList.add(this.yx?rn.rng:rn.qng)}}v2a(){}}Object(f.a)($p,
"UnsavedChangesHighlightActor",At.a,[]);var hw=c(1054);class ev{constructor(R){this.Twe=null;this.ifa=R;this.nFe=!1}get key(){return"UnsavedChangesHighlight"}get Xw(){return"UnsavedChanges"}reset(R){if(this.ifa){R=R.node;if(Kj.ParagraphReader.Wb(R)){const Ba=this.ifa.MOf;if(Ba&&Ba.contains(R.id)){this.nFe=!0;this.Twe=R.id;return}}this.nFe=!1;this.Twe=wh.a.nil}}gJa(){let R=null;return this.nFe?(R=Object.assign(new hw.a,{TG:this.key,contentObject:this.Twe,description:null}),{returnValue:!0,aG:R}):{returnValue:!1,
aG:R}}}Object(f.a)(ev,"UnsavedChangesHighlightCpContentDetailsProvider",null,[335,336]);class Ok{constructor(R,Ba,lb,Vb,zc,Yc,Zd){this.c6g=null;this.y6=R;this.kf=Ba;this.IW=lb;this.b7=Vb;this.gih=zc;this.f_b=Yc;this.yx=Zd;this.kf.yNa(this.KY.bind(this))}get MOf(){return this.c6g}Jsm(){if(this.y6){if(1===this.y6.U7e){if(0===this.y6.JIf&&this.y6.OXi()){this.c6g=this.y6.f4d;const R=this.y6.icd;this.y6.k9n.forEach(this.hml.bind(this));R.forEach(this.Ksm.bind(this));0<R.length&&this.Unl(this.IW);return 0}return this.INn(this.y6.JIf)}return 2}return 1}INn(R){switch(R){case 0:return this.y6.vmi()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}rni(R,Ba,lb){if(Ba)if(lb){lb=Ba.querySelectorAll("span");for(let Vb=0;Vb<lb.length;Vb++){const zc=lb[Vb];Vb||zc.classList.add(rn.ACj);Vb===lb.length-1&&zc.classList.add(rn.zCj);zc.classList.add(this.yx?rn.rng:rn.qng)}Ba.classList.add(rn.sng);R&&this.b7.aoc(R)}else Ba.classList.add(rn.j9n)}jac(R,Ba){const lb=this.bgm(R);if(R&&(R=R.pe(ui.App.za.jb.qc.$b)))if(R.Lg&&R.Lg.Oi&&0!==R.Lg.Oi.count)for(const Vb of R.Lg.Oi)this.rni(lb,Vb,Ba);else this.rni(lb,
R.htmlElement,Ba)}bgm(R){return this.gih&&(R=this.gih.GGb(R))&&R&&(R=R.pe(ui.App.za.jb.qc.$b))?R:null}Ksm(R){this.jac(R,!0);return!0}hml(R){this.jac(R,!1);return!0}Unl(R){R&&R.continueWith(()=>{R.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}KY(R,Ba){Ba===Sys.EventArgs.Empty?va.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Ba&&Ba.errorCode?this.f_b.KU||(R=this.Jsm(),va.ULS.sendTraceTag(576528923,
306,15,"HighlightUnsavedChanges Run Result: {0}",R),La.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==R&&4!==R&&this.jKo(R)):va.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Ba?"Error Code":"Kickout Event Args")}jKo(R){let Ba;const lb=new he.a;lb.extendedProperties=new Map;lb.extendedProperties.set("HighlightUnsavedChangesResult",R.toString());lb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(R){case 1:case 2:case 6:Ba=
"HighlightInternalError";break;case 5:Ba="ChangeOutsideCanvas"}6!==R&&5!==R||lb.extendedProperties.set("UnsavedChangesCollectionResult",this.y6.JIf.toString());Ba&&(La.Health.instance.recordQosError(Ba,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,lb),La.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Ba,!0,!0,lb))}dispose(){this.kf.xOb(this.KY.bind(this))}}Object(f.a)(Ok,"UnsavedChangesHighlighter",null,[10]);var gt=c(504),qs=c(463),fv=c(1482);class kr extends fv.a{constructor(R,Ba){super();
this.ifa=R;this.yx=Ba}G7a(R){if(!this.ifa)return!1;const Ba=this.ifa.MOf;return Ba?Ba.contains(R.Bb.id)||R.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}yPk(R,Ba){Ba=R.exa?R.exa[Ba]?R.exa[Ba].style?R.exa[Ba].style.marginLeft:null:null:null;var lb=R.leftMargin;R=1440<=lb?-(lb/1440*96):R.D_a(0,96,this.zoom);lb=0;Ba&&(Ba=Ba.match(/^(\d+)px/))&&Ba[1]&&(lb=Number(Ba[1]));return R-lb}eQk(R,Ba,lb){return Sys.UI.DomElement.getBounds(R).y-lb.B4[Ba].y}oPk(R){return Sys.UI.DomElement.getBounds(R).height}GLh(R,
Ba,lb,Vb){let zc;zc=this.yPk(lb,Ba);Ba=this.eQk(R,Ba,lb);R=this.oPk(R);Vb=gt.a.createElement(Vb,qs.a.div);Vb.className=this.yx?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Vb.style.left=zc+"px";Vb.style.top=Ba+"px";Vb.style.height=R+"px";return Vb}TKh(R,Ba,lb,Vb){const zc=[],Yc=R.querySelectorAll("."+rn.sng);if(0===Yc.length&&R.classList.contains(rn.sng))lb=this.GLh(R,Ba,lb,Vb),lb.Kba=Ba,zc.push(lb);else for(R=0;R<Yc.length;R++){const Zd=this.GLh(Yc[R],Ba,lb,Vb);Zd.Kba=Ba;zc.push(Zd)}return zc}q0a(R){let Ba=
[];var lb=R.d1;const Vb=lb.Tg.ownerDocument;if(lb.Wj){let zc=0;for(const Yc of lb.Lg.Oi)(lb=this.TKh(Yc,zc,R,Vb))&&(Ba=Ba.concat(lb)),zc+=1}else Ba=this.TKh(lb.htmlElement,0,R,Vb);return Ba}}Object(f.a)(kr,"UnsavedChangesIndicatorActor",fv.a,[]);class Tq{constructor(){this.nW=this.Cv=this.iLa=this.b7=this.Wmd=this.ifa=null}get name(){return"WordEditor.UnsavedChangesHighlight"}wc(){}init(){this.b7=ta.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.ifa=new Ok(ta.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),
Mf.SessionStatusManager.instance,Rl.a.Bp(ta.a.instance.Ta("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.b7,ta.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),ta.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!eb.App.instance&&eb.App.instance.tpa);this.iLa=ta.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager");this.nW=ta.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.Wmd=new kr(this.ifa,!!eb.App.instance&&
eb.App.instance.tpa);this.b7.dTa(this.Wmd);this.iLa&&this.iLa.execute(R=>{R.t5(new ev(this.ifa))});this.Cv=new $p(this.ifa,!!eb.App.instance&&eb.App.instance.tpa);this.nW.C6a(this.Cv)}dispose(){this.b7&&this.Wmd&&this.b7.Ume(this.Wmd);this.nW&&this.Cv&&this.nW.lng(this.Cv);Xn.a.gC(this.ifa)}static main(){L.a.instance.Gc(new Tq)}}Object(f.a)(Tq,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var aq=c(127);class mq{constructor(R,Ba,lb){this.ga=R;this.fn=Ba;this.Ga=lb}Tb(){this.Ga.$("ZoomPopupDialogIsEnabled")&&
(this.ga.ra(m.a.zlc,y.a.frame,Object(a.a)(this.fn,this.fn.zlc,"showZoomDialog")),this.ga.fb(m.a.DKn,y.a.frame,Object(a.a)(this.fn,this.fn.MVi,"onQueryZoomText"),96),this.ga.ra(m.a.Vdd,y.a.frame,Object(a.a)(this.fn,this.fn.xKj,"zoomDialogTabFocusHandler")),this.ga.ra(m.a.Udd,y.a.frame,Object(a.a)(this.fn,this.fn.xKj,"zoomDialogTabFocusHandler")));this.Ga.$("ZoomSliderIsEnabled")&&(this.ga.fb(m.a.w4i,y.a.frame,Object(a.a)(this.fn,this.fn.$pn,"onQueryZoomPercentage"),96),this.ga.fb(m.a.zKj,y.a.frame,
Object(a.a)(this.fn,this.fn.Ktn,"onZoomToPercentage"),96),this.ga.ra(m.a.v6o,y.a.frame,aq.ActionManager.Lf))}}Object(f.a)(mq,"CommonZoomActor",null,[936]);class iw extends mq{constructor(R,Ba,lb){super(R,Ba,lb);this.Zfa=Ba}Tb(){super.Tb();this.Ga.$("ZoomPopupDialogIsEnabled")&&(this.ga.ra(gh.a.xrg,y.a.frame,aq.ActionManager.Lf),this.ga.ra(gh.a.ppe,y.a.frame,Object(a.a)(this.Zfa,this.Zfa.t6o,"zoomTo100")));this.ga.ra(gh.a.zoomToPageWidth,y.a.frame,Object(a.a)(this.Zfa,this.Zfa.zoomToPageWidth,"zoomToPageWidth"));
this.ga.ra(m.a.Qjb,y.a.frame,Object(a.a)(this.Zfa,this.Zfa.Qjb,"increaseZoom"));this.ga.ra(m.a.ugb,y.a.frame,Object(a.a)(this.Zfa,this.Zfa.ugb,"decreaseZoom"));this.ga.ra(gh.a.pag,y.a.frame,Object(a.a)(this.Zfa,this.Zfa.Tmo,"setZoomLevelFromRibbon"));this.ga.fb(gh.a.job,y.a.frame,Object(a.a)(this.Zfa,this.Zfa.MVi,"onQueryZoomText"),96);this.ga.fb(gh.a.sbe,zi.a.application,Object(a.a)(this.Zfa,this.Zfa.Zpn,"onQueryZoomLevelLabelText"),96);this.ga.ra(eh.a.qNh,y.a.frame,aq.ActionManager.Lf);this.ga.ra(eh.a.pNh,
y.a.frame,aq.ActionManager.Lf);this.ga.ra(eh.a.uNh,y.a.frame,aq.ActionManager.Lf);this.ga.ra(eh.a.rNh,y.a.frame,aq.ActionManager.Lf);this.ga.ra(gh.a.uka,y.a.frame,aq.ActionManager.Lf)}}Object(f.a)(iw,"WordEditorZoomActor",mq,[]);class Pr{constructor(R,Ba){this.zoom=R;this.cAk=Ba}}Object(f.a)(Pr,"SetCustomZoomArgs",null,[]);var Uq=c(1159);class lr{constructor(R,Ba){this.wgl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.xgl=[lr.Rdf,lr.jKd,"200","150",
"100","75","50"];this.zna=3;this.RN=0;this.delta=.1;this.EJf=0;this.hd=new N.a;this.Yh=null;this.K=R;this.nc=Ba;this.Qmj(1)}get ij(){return this.RN}Qmj(R){this.RN=R}get rKc(){return Math.round(100*this.ij)}get Ben(){return Math.floor(this.rKc/10)/10+this.delta}get Aen(){return Math.ceil(this.rKc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.va}Pxk(R){this.hd.addHandler("ZoomChanged",R)}M_n(R){this.hd.removeHandler("ZoomChanged",R)}XY(R){this.Pxk(R)}lTa(R){this.M_n(R)}b8i(){}V9i(){}a8i(){}U9i(){}Wdd(R){this.yKj(R,
this.ij)}yKj(R,Ba){null!==R&&Eg.a.ylj(R,Ba)}Mdg(R,Ba=!0){let lb=R*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(lb=new Pr(R,Ba));this.pjj(lb)}Smo(R,Ba=!1){this.uka(R,3|(Ba?0:4))}Itn(R,Ba,lb){if(1===R)return 32;R=lb/100;R<this.S_c?R=this.S_c:R>this.w_c&&(R=this.w_c);this.uka(R,1);Ba&&(Ba.As=Math.floor(100*R));return 32}MVi(R,Ba,lb,Vb,zc){if(1===lb)return 32;R=Xa.a.MEa(this.rKc,6,l.AFrameworkApplication.numberFormat);zc.Value=R;zc.LabelText=R;return 32}Ktn(R,Ba,lb,Vb,zc){return 1===
lb?32:this.Itn(lb,Vb,zc.value)}$pn(R,Ba,lb,Vb,zc){zc.MinValue=100*this.S_c;zc.MaxValue=100*this.w_c;zc.value=this.rKc;return 32}bji(){return this.wgl}cji(){return this.xgl}ASl(){let R=Math.floor(100*this.ij).toString();1===this.zna?R=lr.Rdf:2===this.zna&&(R=lr.jKd);return R}Qjb(R,Ba,lb){if(1===lb)return 32;this.TZc(this.nc?this.nc.KC:0,"IncreaseZoom");this.zna=0;this.uka(this.Ben);return 32}ugb(R,Ba,lb){if(1===lb)return 32;this.TZc(this.nc?this.nc.KC:0,"DecreaseZoom");this.zna=0;this.uka(this.Aen);
return 32}Tmo(R,Ba,lb,Vb,zc){if(1===lb)return 32;this.TZc(this.nc?this.nc.KC:0,"SetZoomLevelFromRibbon");R=zc.Value;if(R.toLowerCase().startsWith("fit"))return R=new Lc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),lj.a.instance.Xb(R),32;R=parseInt(R)/100;if(isNaN(R))return 2;this.zna=0;this.uka(R);return 32}TZc(R,Ba){va.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",R,Ba,l.AFrameworkApplication.ua.Lb.Er)}zlc(R,Ba,lb){if(1===
lb)return 32;va.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const R=this.ASl();this.Yh=new Uq.a(this.bji(),this.cji(),Object(a.a)(this,this.cpm,"handleZoomDialogResult"),Jg.FocusManager.instance(),!0);this.Yh.zlc(CommonUIStrings.l_ZoomDialogTitle,R)}YIm(R){return R.toLowerCase()===lr.Rdf.toLowerCase()}ZIm(R){return R.toLowerCase()===lr.jKd.toLowerCase()}cpm(R){if(R){if(this.YIm(R)){this.zna=1;var Ba=32}else if(this.ZIm(R))this.zna=
2,Ba=this.zoomToPageWidth(0,null,2,null,null);else if(Ba=Number.parseInvariant(R)){this.zna=0;let lb=Ba;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(lb=new Pr(Ba,!0));Ba=this.pjj(lb)}else Ba=8;32===Ba?va.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:R}):va.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:R})}else va.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:R})}GMn(){this.hd.raiseEvent("ZoomChanged",null)}a5i(){}f4f(){}xKj(R){if(!this.Yh)return 2;
var Ba=this.Yh.focusManager.Ys().ak.Z3;if(Ba===this.Yh.Yz&&R===m.a.Vdd||Ba===this.Yh.gH&&R===m.a.Udd)this.Yh.fAb||this.Yh.W$n(),this.Yh.focusManager.Ys().ak.Zy(this.Yh.fAb);else if(Ba.id.startsWith(this.Yh.Q4c)||Ba.className.startsWith(this.Yh.E4i))Ba=null,R===m.a.Vdd?Ba=this.Yh.gH:R===m.a.Udd&&(Ba=this.Yh.Yz),this.Yh.focusManager.Ys().ak.Zy(Ba),Sys.UI.DomElement.removeCssClass(this.Yh.fAb.parentNode,this.Yh.V3f);else if(R===m.a.Vdd)this.Yh.focusManager.Ys().vfc();else if(R===m.a.Udd)this.Yh.focusManager.Ys().tfc();
else return 2;return 32}}lr.Rdf="FullPage";lr.jKd="PageWidth";Object(f.a)(lr,"ZoomManager",null,[838]);var ht;(function(R){R[R.manual=0]="manual";R[R.fitToFullPage=1]="fitToFullPage";R[R.fitWidth=2]="fitWidth";R[R.onBoot=3]="onBoot"})(ht||(ht={}));Object(f.b)("ZoomStatus",ht);c(1076);var Qn;(function(R){R[R.normal=0]="normal";R[R.quiet=1]="quiet";R[R.disableScrollUpdate=2]="disableScrollUpdate";R[R.disableUiControlUpdate=4]="disableUiControlUpdate"})(Qn||(Qn={}));Object(f.b)("ZoomUpdateFlags",Qn);
var nq=c(243),it=c(328),Bt=c(1208);class jw extends lr{constructor(R,Ba,lb,Vb,zc,Yc,Zd,$e){super(R,Ba);this.u6o=$e;this.M2o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.N2o=[lr.jKd,"200","150","125","100","75","50"];this.nWe=this.Jcj=!1;this.UKg="AutoFitForAdaptiveLayout";this.o1j="FitPageWidthFailure";this.Ylk="UpdateZoomFailure";this.unk="wwf";this.DXe=null;this.e7i=()=>{this.zna===ht.fitWidth&&this.jkf()};this.Mel=pa=>{if(pa.ctrlKey){l.AFrameworkApplication.va.processAction(eh.a.rNh,
2);pa=pa.N1o;if(!pa)return!1;this.uka(this.ij-(0<pa?.1:-.1));this.TZc(6,"CtrlScroll");return!0}return!1};this.Jtn=()=>{va.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.EQ=lb;this.qk=Vb;this.Vb=zc;this.gg=Yc;this.hvc=Zd;this.$1g=R.$("KeepViewAfterZoomIsEnabled");this.vnk=R.$("ZoomShortCutIsEnabled");this.mmk=R.$("DoNotAutoScrollAfterPinchIsEnabled");this.b6j=(this.qEe=R.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&R.$("AutoFitForSmallScreenModeIsEnabled");
this.t_j=R.$("DoNotProcessUpdateZoomActionIsEnabled");this.wnk=R.$("ZoomSliderIsEnabled");this.Pz()}get appName(){return"WordEditor"}get w_c(){return 4}get S_c(){return.1}get Nel(){return wacBoot.CtrlWheelMetrics}dxk(R){this.hd.addHandler("PinchStart",R)}C_n(R){this.hd.removeHandler("PinchStart",R)}cxk(R){this.hd.addHandler("PinchEnd",R)}B_n(R){this.hd.removeHandler("PinchEnd",R)}get $J(){return null!=this.EFg?this.EFg:this.EFg=ta.a.instance.Oa("WordEditor.IStatusBarUser")}BGj(R){R=!(R&Qn.disableUiControlUpdate);
const Ba=Hb.a.get_instance().isCompleted(7);return R&&Ba?(R={SelectZoomOption:"ComboBoxModel"},eb.App.za&&eb.App.za.cH(R),this.oYo(),!0):!1}uka(R,Ba=Qn.normal){let lb=!0;this.t_j||l.AFrameworkApplication.va.processAction(gh.a.uka,2);if(this.ij===R)return this.nWe||(this.nWe=this.BGj(Ba)),lb;R>this.w_c?R=this.w_c:R<this.S_c&&(R=this.S_c);var Vb=!!(Ba&Qn.quiet);1===R||Vb||l.AFrameworkApplication.va.processAction(gh.a.xrg,2);try{Vb=null;eb.App.za&&Object(qn.a)(Bt.MainView,eb.App.za.jb.qc)&&(Vb=eb.App.za.jb.qc);
let zc=-1,Yc=-1,Zd=-1;const $e=!(Ba&Qn.disableScrollUpdate);this.$1g&&$e&&(zc=Ge.SelectionEditor.iim(Ah.a.instance.hb.lb,Vb),Yc=Vb.BL.scrollLeft,Zd=Vb.BL.scrollTop);const pa=this.ij;this.Qmj(R);this.GMn();this.nWe=this.BGj(Ba);$e&&this.PWo(Vb,zc,Yc,Zd,pa)}catch(zc){lb=!1,va.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",zc)}return lb}PWo(R,Ba,lb,Vb,zc){R&&R.isActive?this.$1g?0<=Ba&&100>=Ba?R.Vs.z5(100-Ba,!0,!0):R.Vs.zWm(lb,Vb,zc,this.ij):R.Vs.z5():va.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}t6o(R,
Ba,lb){2===lb&&(this.TZc(this.nc?this.nc.KC:0,"ZoomTo100"),this.zna=ht.manual,this.uka(1));return 32}pjj(R){this.zna=ht.manual;let Ba,lb=!0;if(this.mmk){if(!Object(qn.a)(Pr,R))return va.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Ba=R.zoom/100;lb=R.cAk}else Ba=Number.parseInvariant(String.format("{0}",R))/100;va.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Ba);R=Qn.normal;lb||(R=Qn.disableScrollUpdate);this.uka(Ba,R);return 32}zoomToPageWidth(R,
Ba,lb){if(1===lb)return 32;va.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(tc.a)("ZoomToPageWidth",!0);this.zna=ht.fitWidth;this.ovl();return this.jkf()}Zpn(R,Ba,lb,Vb,zc){if(1===lb)return 32;R=Xa.a.MEa(this.rKc,6,l.AFrameworkApplication.numberFormat);zc[nq.a.labelText]=R;return 32}bji(){return this.M2o}cji(){return this.N2o}ovl(){this.Jcj||(eb.App.za?(eb.App.za.u_(this.e7i),this.Jcj=!0):va.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}jkf(){if(this.u6o){var R=
this.EQ.TQd();if(!R)return 8;for(var Ba=0;R;)Ba=Math.max(Ba,hm.a.instance.Ft(R)),R=this.EQ.sQc(R);this.sSh(Ba);return 32}if((Ba=eb.App.za?eb.App.za.jb.qc:null)&&eb.App.za.pD){R=null;(Ba=this.wSl(Ba))&&(R=this.EQ.OJ(Ba));R||(R=this.EQ.TQd());if(null!==R)return this.sSh(hm.a.instance.Ft(R)),32;va.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else va.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}sSh(R){R=Um.a.Ki(R,
0);const Ba=this.hvc();R+=Ba&&Ba.phe()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0;R+=2*it.a.brg;this.uka(eb.App.za.pD.offsetWidth/R)}wSl(R){return R&&R.mb&&R.mb.hb.lb&&R.mb.hb.lb.Pa&&R.mb.hb.lb.Pa.node?R.mb.hb.lb.Pa.node:null}oYo(){this.$J&&(this.wnk?(this.$J.bV(Bn.a.o6o),this.$J.bV(Bn.a.q6o)):this.$J.bV(Bn.a.r6o))}dBo(R){R||(R=window.self.CtrlWheelMetrics);if(R){var Ba=R.ctrlWheelOccurred;if("boolean"!==typeof Ba)va.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{va.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Ba);try{R.stop()}catch(lb){va.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",lb)}}}else va.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Pz(){this.dBo(this.Nel);if(this.qk){var R=document.getElementById(Qq.AppFrame.PKd);R&&this.qk.ob(W.a.tmb,R,this.Mel)}this.Vb&&(R=this.Vb.ae(Qq.AppFrame.PD),this.vnk&&(R.bindAction(bf.KeyInputManager.ic(ce.a.soc,bf.KeyInputManager.Ph),m.a.Qjb),R.bindAction(bf.KeyInputManager.ic(ce.a.edd,
bf.KeyInputManager.Ph),m.a.Qjb),R.bindAction(bf.KeyInputManager.ic(ce.a.toc,bf.KeyInputManager.Ph),m.a.ugb),R.bindAction(bf.KeyInputManager.ic(ce.a.voc,bf.KeyInputManager.Ph),m.a.ugb),R.bindAction(bf.KeyInputManager.ic(ce.a.Ued,bf.KeyInputManager.Ph),gh.a.ppe)));this.gg&&(this.DXe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.gg.ob(W.a.click,this.DXe,this.Jtn);this.b6j&&(eb.App.za.VI.registerLayoutBreakpointChanged("canvas",Ba=>{this.w2e(Ba)}),eb.App.za.VI.registerBoundingWindowRectsChanged("canvas",
()=>{this.w2e(eb.App.za.VI.getLayoutBreakpoint())}))}w2e(R){let Ba=!0,lb="";if(this.zna!==ht.onBoot)return Ba;La.Health.instance.recordKpiUsage(this.UKg,0,this.unk,null);switch(R){case "Small":8===this.jkf()&&(lb=this.o1j,Ba=!1);break;default:1===this.ij||this.uka(1)||(lb=this.Ylk,Ba=!1)}Ba||La.Health.instance.recordKpiFailure(this.UKg,lb,!0,!0,null);return Ba}b8i(R){this.dxk(R)}V9i(R){this.C_n(R)}a8i(R){this.cxk(R)}U9i(R){this.B_n(R)}a5i(){this.hd.raiseEvent("PinchStart",null)}f4f(){this.hd.raiseEvent("PinchEnd",
null)}}Object(f.a)(jw,"WordEditorZoomManager",lr,[1650,838]);class oq{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const R=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),Ba=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");R.Tb();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
Ba&&Hb.a.get_instance().lk(4,()=>{Ba.w2e(eb.App.za.VI.getLayoutBreakpoint())||va.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}wc(R){this.W=R;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new jw(l.AFrameworkApplication.K,l.AFrameworkApplication.va,eo.WordSectionNavigator.instance,ln.a.instance,Jg.FocusManager.instance(),fm.a.instance,()=>R.Oa("Box4.IFloatingObjectUpdater"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleOrientationZoomToFitBugFix",
!1))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new iw(l.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).ha())}static main(){L.a.instance.Gc(new oq)}}Object(f.a)(oq,"ZoomPackage",null,[1,2]);var Zw=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",
Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},
children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",
LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",
Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",
AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},
{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",
Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",
attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class Zt extends Ki.a{constructor(R){var Ba;super("DocumentOwnerConditionId");this.Al=
R.Al;this.qeg=null!==(Ba=R.qeg)&&void 0!==Ba?Ba:!0}initialize(){super.initialize();const R=l.AFrameworkApplication.K;R.Hn(()=>{const Ba=R.$("IsDocumentOwner");this.xg(Ba===this.qeg)})}xg(R){super.xg(R);va.ULS.sendTraceTag(508958623,3028,50,this.EO(this.Al,R))}}Object(f.a)(Zt,"DocumentOwnerCondition",Ki.a,[]);var Lf=c(258);class wp extends Lf.a{constructor(R,Ba,lb){super("LicensePaywallCondition");this.N0b=R.Al;this.R0j=R.pzl;this.Ga=Ba;this.Xu=lb}initialize(){super.initialize();this.V5k()}Nd(){super.Nd()}V5k(){this.Ga.Hn(()=>
{!this.Ga.$("IsAnonymousUser")&&this.Xu?this.Xu.execute(R=>{this.hIe=Date.now();R.isFeatureEnabled(this.R0j,!1).then(Ba=>{this.hIe=Date.now()-this.hIe;this.xg(Ba)})}):this.xg(!1)})}xg(R){super.xg(R);va.ULS.sendTraceTag(508884163,3028,50,this.EO(this.N0b,R,"Latency for license check: "+this.hIe.toString()+"ms"))}}Object(f.a)(wp,"LicensePaywallCondition",Lf.a,[]);var Hq=c(1744);class hp extends Hk.a{constructor(R,Ba){var lb=new xj({Al:23,r1a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const Vb=
new xj({Al:23,r1a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),zc=new Zt({Al:23,qeg:!1});lb=new mb.a([lb,Vb,zc]);l.AFrameworkApplication.le("fbc73697;a29b4114");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(Ba=new wp({Al:23,pzl:"Copilot"},l.AFrameworkApplication.K,Ba),lb.add(Ba));l.AFrameworkApplication.le("f5gia801;0f27g313");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",
!1)&&(R=new Hq.a({Al:23},R),lb.add(R));super(23,lb,null,3028,"CopilotSummarySkittleInitTriggered")}}Object(f.a)(hp,"CopilotSummarySkittleInitTriggerModel",Hk.a,[]);var Jl={get interop(){var R=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:copilotSummarySkittleUx.interop;if(!R)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return R}};class Hu{constructor(R,Ba){this.BHd=R;this.E7c=Ba;this.oHa=async(lb,Vb)=>{if(Vb.fZ){Object(tc.a)("CopilotSummarySkittleInitializationTriggered");
this.BHd.Pda(this.oHa);this.BHd.Nd();try{const [,zc]=await Promise.all([this.z0m(),Promise.all([c.e(2),c.e(28)]).then(c.bind(null,2090))]);zc.main(Jl.interop)}catch(zc){va.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.BHd.F3(this.oHa);this.BHd.initialize()}async z0m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(lg.c)(this.E7c)).aA.loadScript("copilotSummarySkittleUx")}}
Object(f.a)(Hu,"CopilotSummarySkittleInitializer",null,[]);class $l extends Zk.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}w8(R){this.container=R}y8(){(new Hu(new hp(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory"),this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}x8(){}static main(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&L.a.instance.Gc(new $l)}}Object(f.a)($l,"CopilotSummarySkittleEntryPackage",Zk.a,[]);var Iu=c(1784),$t=c(1779);class Dn{constructor(R,Ba,lb){this.P5k=R;this.Q5k=Ba;this.appSettings=lb}async isEnabled(){const R=Mm.b.ura(),Ba=Promise.race([this.xnn(),new Promise(lb=>setTimeout(()=>lb(!1),5E3))]);va.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {1}ms",R.YLc);return Ba}get nKm(){return Object(lg.b)("Microsoft.Office.WordOnline.IsCopilotComposeEnabled")}async xnn(){if(!this.nKm)return!1;
await this.r1o();return this.P5k.DHc()&&await this.Q5k.DHc()?!0:!1}async r1o(){return new Promise(R=>{this.appSettings.Hn(()=>{R(!0)})})}}Object(f.a)(Dn,"CopilotComposeFeatureCondition",null,[]);const ip=new qk(()=>Promise.all([c.e(2),c.e(5),c.e(24)]).then(c.bind(null,2080)).then(R=>R.instance));class Iq{constructor(R){this.arg=R}initialize(){this.Mol().catch(R=>{va.ULS.VA(508913495,3048,10,R,"Failed to initialize CopilotCompose")})}async Mol(){await Promise.all([ip.i4(),this.arg.loadChunk("copilotComposeUx")]);
await ip.lhb()}}Object(f.a)(Iq,"CopilotComposeInitializer",null,[]);var Ju=c(1053);class rs extends Ju.a{placeholderField(R){return new gs(R)}}Object(f.a)(rs,"CopilotComposeDataFieldsFactoryImpl",Ju.a,[]);class gs extends $c.a{constructor(R){super();this.name="placeholder";this.string=R}}Object(f.a)(gs,"PlaceholderDataField",$c.a,[]);class Op extends Mm.a{constructor(R){super(R,"CopilotCompose");this.fieldsFactory=new rs}}Object(f.a)(Op,"CopilotComposeTelemetryLoggerImpl",Mm.a,[]);const Ps="CH DE FR EU UK NO SE NL PIE".split(" "),
Qr=["Exchange Online Consumer","OneDriveWOPI"];class jp{async DHc(){var R,Ba,lb,Vb,zc;const Yc=null!==(Ba=null===(R=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===R?void 0:R.WACDatacenter)&&void 0!==Ba?Ba:"unknown";R=null!==(Vb=null===(lb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===lb?void 0:lb.Ring)&&void 0!==Vb?Vb:"unknown";lb=null===(zc=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===zc?void 0:zc.Host;return this.VUc(Yc,R,lb)}VUc(R,Ba,lb){if("1"===Ba||"unknown"===
R||Qr.includes(lb))return!0;const Vb=R.toUpperCase();return!Ps.some(zc=>Vb.includes(zc))}}Object(f.a)(jp,"CopilotComposeDatacenterCondition",null,[]);class hj{constructor(R,Ba){this.appSettings=R;this.O0e=Ba;this.Olb="Copilot";this.z3b="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"}async DHc(){const R=await this.OUk();va.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",R);return 2!==R}async OUk(){if(this.p5e())return 0;const R=Mm.b.ura(),Ba=await this.Cxf();va.ULS.sendTraceTag(508863556,
3048,50,"License check took: {0}ms",R.YLc);return Ba?1:2}p5e(){return this.appSettings.getBooleanFeatureGate(this.z3b,!1)}async Cxf(){return(await Object(lg.c)(this.O0e)).isFeatureEnabled(this.Olb,!1)}}Object(f.a)(hj,"CopilotComposeLicenseCondition",null,[]);class im extends Zk.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}w8(R){R.ia("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger",()=>new Op(R.resolve("Wac.Common.Utils.IOtelWrapper"))).ha()}y8(){const R=
ta.a.instance;R.resolve("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger").measureActivityPerformance(()=>{(new Iq(R.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"))).initialize()},{name:"Initialize"})}x8(){}static main(){im.zRl().isEnabled().then(R=>{R&&L.a.instance.Gc(new im)}).catch(()=>{va.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static zRl(){const R=ta.a.instance;R.ia("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition",
()=>new jp).ha();R.ia("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new hj(l.AFrameworkApplication.K,R.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();R.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",()=>new Dn(R.resolve("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition"),R.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),l.AFrameworkApplication.K)).ha();return R.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}
Object(f.a)(im,"CopilotComposeEntryPackage",Zk.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");
Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Hj.main();Type.registerNamespace("Common.App.AccessibilityChecker");
Type.registerNamespace("Common.App.Assistance");P;Type.registerNamespace("CACPU");Ka.main();Type.registerNamespace("CAEventTimingMeter");bb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Xb.main();Type.registerNamespace("Common.App.GestureInput");Sa.main();Type.registerNamespace("Common.App.GestureManager");cb.main();Type.registerNamespace("Common.ModernFontPicker");null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",
!1)||(Type.registerNamespace("Common.App.OfflineLogger"),L.a.instance.Gc(new Se));Type.registerNamespace("Common.App.O365Shell");Wa.main();Type.registerNamespace("Common.App.PhoneLink");Qd.main();Type.registerNamespace("Common.App.SensitiveLogging");Vh.main();Type.registerNamespace("Common.App.Rename");L.a.instance.Gc(new xi,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");L.a.instance.Gc(new Ig);Type.registerNamespace("Common.App.SaveAsToHost");jl.main();Type.registerNamespace("Common.App.SaveToCloudStorage");
dg.main();Type.registerNamespace("Common.App.SaveACopy");dm.main();Type.registerNamespace("Common.App.SaveToSharePoint");vl.main();Type.registerNamespace("Common.App.SharedFilePicker");sh.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");Ef.main();dp;L.a.instance.Gc(new gp);Wf.main();Zw;so.main();L.a.instance.Gc(new Ul);
Ko.main();Gp.a.prototype.toString=To.a.prototype.toString;Vk.a.$ji=new hq.a;L.a.instance.Gc(new Pq);oq.main();L.a.instance.Gc(new Uo);L.a.instance.Gc(new Lp);L.a.instance.Gc(new Ti);Dj.main();Fm.main();Tl.main();Tq.main();Type.registerNamespace("NLRT");L.a.instance.Gc(new bh);Type.registerNamespace("Common.App.AccessibilitySettings");M.main();L.a.instance.Gc(new lq);Vg.main();dn.main();cj.main();Tm.main();$l.main();im.main();null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchRDLMToSliceTwo",
!1)&&Iu.a.main();null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchLSTHMToSliceTwo",!1)&&$t.a.main();window.EventTiming={EventTimingMeter:em,FrameTimingMeter:Di}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20205649/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll2.js.map