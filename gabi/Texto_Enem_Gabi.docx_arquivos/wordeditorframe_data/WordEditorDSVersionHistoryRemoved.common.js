/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1497:function(D,I,c){c.d(I,"a",function(){return m});D=c(0);var l=c(2),f=c(1982),a=c(57),k=c(7),x=c(1630),y=c(1589);class m{static CJa(r,z){r||(k.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",z),m.Pf())}static zoc(r,z){r&&r.count||(k.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",z),m.Pf())}static d2(r,z){m.CJa(r,z);r.isConnected||(k.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",z),m.Ok())}static ey(r,z){null===r&&(k.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",z),m.qd())}static Aoc(r,z){r&&""!==r||(k.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",z),m.qd())}static lVa(r,z){if(null===r||0>=r)k.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",z,r),m.qd()}static kVa(r,z){if(null===r||0>r)k.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",z,r),m.qd()}static bQ(r){if("number"===typeof r)return r;m.qd();return 0}static AJa(r,z,v){m.Aoc(r,z);var G=f.a.nva(r);G=""!==G?G:r;"#"!==G.charAt(0)&&(G="#"+G);let F=!1;if(7>G.length)F=!0;else for(let H=1;7>H;H++){const L=G.charAt(H);if(!("0"<=L&&"9">=L||"A"<=L&&"F">=L||"a"<=L&&"f">=L)){F=!0;break}}if(F)throw k.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",v.appId,z,r),OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return m.nEn(G)}static nEn(r){return r.substring(5,7)+r.substring(3,5)+r.substring(1,3)}static XM(r,z,v=0,G=!0){k.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:r,["BlobSize"]:v,["Latency"]:z,["ExecutionStatus"]:G})}static yN(r){return(new Date).getTime()-r}static Pf(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.generalException,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static qd(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static wk(r=""){if("Getter"!==r)throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static Mqb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.eAb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static Ok(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.RVm,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static Skg(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notSupported,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static Ymc(r,z,v="",G=""){r="AppId:"+r+",";r=(""!==v?r+("Property"+v):r+"Method")+(":"+z+", currently is not allowed on Word Wac");""!==G&&(r+=" for Parameter:"+G);k.ULS.sendTraceTag(19415938,369,15,r);"Getter"!==v&&m.nD()}static nD(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notAllowed,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static zHo(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.avn,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static zi(){return l.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static Kdd(){return l.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static Roe(){return l.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get kAa(){return a.a.P_f}static lJc(r){r=(r||
"").replace(RegExp("\\r","g"),"\\r");r=r.replace(RegExp("\\n","g"),"\\n");return r=r.replace(RegExp("\\v","g"),"\\v")}static Mlc(r){return r.split(RegExp("\r\n|\r|\n"))}static c7i(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static k5f(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static kRn(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorRangeTextEnabled",
!1)}static gva(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}static L2o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomXmlPartApiIsEnabled",!1)}static ZDl(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixGetHtmlStyleBug",!1)}static BHh(){var r;l.AFrameworkApplication.le("46ab6280;fg4g7862");return null===(r=l.AFrameworkApplication.K)||void 0===r?
void 0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static mkf(){l.AFrameworkApplication.le("241fi198;754i3702");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",!1)}static lOc(){l.AFrameworkApplication.le("0cdc8638;0cdc8638");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static JJj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentInsertFileFromBase64ApiIsEnabled",
!1)}static P2o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",!1)}static O2o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",!1)}static fNh(){var r;l.AFrameworkApplication.le("aa6dc483;d84c1847");return null===(r=l.AFrameworkApplication.K)||void 0===r?void 0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static R2o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",
!1)}static Quj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static yMc(r){null!==r&&void 0!==r&&r.length&&r.some(z=>-1===m.Xad(z))&&m.qd()}static zhf(r,z){null!=r&&(r=m.Xad(r),k.ULS.sendTraceTag(509616404,369,50,`${z}.insertContentControl(${x.a[r]})`),-1===r&&m.qd())}static Xad(r,z=-1){switch(r){case 96:return 1;case 31:return 0;default:return z}}}m.Rlb="\r";m.IUh=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);m.Eia=9;Object(D.a)(m,
"Utility",null,[])},1507:function(D,I,c){c.d(I,"f",function(){return v});c.d(I,"e",function(){return G});c.d(I,"d",function(){return F});c.d(I,"g",function(){return H});c.d(I,"h",function(){return L});c.d(I,"a",function(){return J});c.d(I,"j",function(){return M});c.d(I,"i",function(){return P});c.d(I,"c",function(){return N});c.d(I,"b",function(){return K});var l=c(59),f=c(7),a=c(1515);c.n(a);D=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},
{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];I=[{role:1,XG:{default:"Unknown",LJ:null}},{role:2,XG:{default:"Title",LJ:Box4Intl.Box4Strings.L_StyleWordTitle}},
{role:3,XG:{default:"Subtitle",LJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,XG:{default:"Heading1",LJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,XG:{default:"Heading2",LJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,XG:{default:"Heading3",LJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,XG:{default:"Heading4",LJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,XG:{default:"Heading5",LJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,XG:{default:"Heading6",LJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},
{role:10,XG:{default:"Heading7",LJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,XG:{default:"Heading8",LJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,XG:{default:"Heading9",LJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,XG:{default:"BodyText",LJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,XG:{default:"Caption",LJ:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,XG:{default:"ListItem",LJ:null}},{role:16,XG:{default:"SubtleEmphasis",LJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},
{role:17,XG:{default:"Emphasis",LJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,XG:{default:"IntenseEmphasis",LJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,XG:{default:"Strong",LJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,XG:{default:"Quote",LJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,XG:{default:"IntenseQuote",LJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,XG:{default:"SubtleReference",LJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,
XG:{default:"IntenseReference",LJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,XG:{default:"BookTitle",LJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,XG:{default:"NoSpacing",LJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const k=new Map(I.map(O=>[O.XG.default,O.role])),x=new Map(I.map(O=>[O.role,O.XG.default])),y=new Map(I.map(O=>[O.role,O.XG.LJ])),m=new Map(D.map(O=>[O.roleType,O.role])),r=new Map(D.map(O=>[O.role,O.roleType])),z=(O,V,W)=>O.has(V)?O.get(V):W,v=O=>z(k,O,1),
G=O=>z(m,O,1),F=O=>z(r,O,a.RoleType.Unknown),H=O=>z(x,O,"Unknown"),L=O=>z(y,O,null),J=O=>{switch(O){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},M=O=>{switch(O){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";
case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},P=O=>{switch(O){case 13:return l.StyleReader.wordStyleIdNormal;
case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.Lrb;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.Odd;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.bTb;case 8:return l.StyleReader.cTb;case 9:return l.StyleReader.dTb;case 10:return l.StyleReader.Roc;case 11:return l.StyleReader.Soc;case 12:return l.StyleReader.eTb;case 16:return l.StyleReader.Krb;case 17:return l.StyleReader.n9a;
case 18:return l.StyleReader.Irb;case 19:return l.StyleReader.cKj;case 20:return l.StyleReader.Voc;case 21:return l.StyleReader.Jrb;case 22:return l.StyleReader.dKj;case 23:return l.StyleReader.bKj;case 24:return l.StyleReader.$Jj;case 25:return l.StyleReader.Uoc;case 14:return l.StyleReader.aKj;default:return f.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+H(O)),"Unknown"}},N=O=>{switch(O){case 18:case 21:case 23:return!0;default:return!1}},K=O=>4<=O&&12>=O},1509:function(D,
I,c){c.d(I,"c",function(){return H});c.d(I,"b",function(){return L});c.d(I,"t",function(){return M});c.d(I,"r",function(){return K});c.d(I,"q",function(){return O});c.d(I,"g",function(){return V});c.d(I,"d",function(){return W});c.d(I,"o",function(){return T});c.d(I,"n",function(){return Y});c.d(I,"a",function(){return ba});c.d(I,"e",function(){return Z});c.d(I,"i",function(){return ea});c.d(I,"m",function(){return ha});c.d(I,"s",function(){return la});c.d(I,"j",function(){return ia});c.d(I,"k",function(){return sa});
c.d(I,"h",function(){return Oa});c.d(I,"v",function(){return Ra});c.d(I,"u",function(){return Na});c.d(I,"p",function(){return fa});c.d(I,"f",function(){return ta});c.d(I,"l",function(){return Ka});D=c(22);var l=c(60),f=c(113),a=c(133);I=c(392);var k=c(37),x=c(8),y=c(57),m=c(419),r=c(6),z=c(7),v=c(1518),G=c(1620);const F=()=>document.getElementById(a.AppFrame.qVa),H=new I.a,L=`.ParaWrappingDiv .${k.a.bLd}`,J=D.a.instance.Re("Box4.CommentParagraphMapping"),M=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,
Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let P=void 0;const N=()=>{if(void 0===P){let va;try{va=CSS.supports("selector(:not(* *))")}catch(La){va=!1}va||z.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");P=va}return P},K=va=>!!va&&!!va.Af,O=(va,La,za,Ca)=>{if(!va||!va.objectId)return!1;const ua=za.Eb(l.a.Ff(va.objectId)),
ib=v.a.o$b(ua,!0),bb=v.a.o$b(ua,!1);if(!ib||!bb||ib===bb&&ib!==La||!x.ParagraphReader.GWc(La,ib,bb))return!1;va=!0;var mb=!1;ib===La&&(mb=v.a.jca(ua,za,!0),va=va&&!!mb&&mb.Kb.cp<=Ca,mb=!!mb&&mb.Kb.cp===Ca);La===bb&&(La=v.a.jca(ua,za,!1),va=va&&!!La&&La.Kb.cp>Ca,mb=mb&&!!La&&La.Kb.cp===Ca);return va||mb},V=va=>{if(!va)return null;va=f.a.Eb(va,k.a.DIc);return null!==va&&void 0!==va?va:[]},W=va=>va?f.a.Eb(va,k.a.hGd):null,T=(va,La)=>{if(!va)return-1;for(let za=0;za<va.length;za++)if(va[za].hhc.equals(La))return za;
return-1},Y=(va,La)=>{if(!va)return-1;for(let za=0;za<va.length;za++)if(va[za].nsi.equals(La))return za;return-1},ba=va=>`Comment Object Id: ${va.objectId}`,Z=(va=!1)=>ta(F(),va),ea=()=>y.a.Sj?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")):oa()?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):
[],ha=(va,La=!1)=>{if(va.Wj){for(const za of va.Lg.Oi)if(Ka(za,La))return!0;return!1}return Ka(va.htmlElement,La)},la=va=>!!va&&!!va.ja(r.a.wM,null),ia=()=>{const va=new Set,La=ea();for(let za=0;za<La.length;za++)V(La[za]).forEach(Ca=>{va.add(Ca.toString())});return va},sa=(va,La)=>La?Da(va,!0,La):ra(va,!0),Oa=(va,La)=>La?Da(va,!1,La):ra(va,!1),Ra=(va,La)=>{xa(va,La,!0);m.a.isEnabled&&!va.wkb&&z.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${va.id} StartParaId: ${La}`)},
Na=(va,La)=>{xa(va,La,!1);m.a.isEnabled&&!va.wkb&&z.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${va.id} EndParaId: ${La}`)},Da=(va,La,za)=>{var Ca,ua;const ib=va.id.toString();return La?m.a.isEnabled?null!==(Ca=J.value.Y_a.get(ib))&&void 0!==Ca?Ca:za:va.ja(r.a.nUa,za):m.a.isEnabled?null!==(ua=J.value.X_a.get(ib))&&void 0!==ua?ua:za:va.ja(r.a.awa,za)},ra=(va,La)=>{const za=va.id.toString();return La?m.a.isEnabled?J.value.Y_a.get(za):va.getValue(r.a.nUa):m.a.isEnabled?
J.value.X_a.get(za):va.getValue(r.a.awa)},xa=(va,La,za)=>{const Ca=va.id.toString();m.a.isEnabled?va.wkb||(za?J.value.Y_a:J.value.X_a).set(Ca,La):va.setValue(za?r.a.nUa:r.a.awa,La)},fa=va=>m.a.isEnabled?J.value.Y_a.has(va.objectId)&&J.value.X_a.has(va.objectId):!0,oa=()=>0===G.a.Jj||2===G.a.Jj,ta=(va,La)=>{if(La&&(oa()||y.a.Sj)){if(N())return Array.from(va.querySelectorAll(y.a.Sj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));La=y.a.Sj?va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart"):va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const za=
La.length;if(0<za){va=va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Ca=[];let ua=0;for(let ib=0,bb=va.length;ib<bb;ib++){const mb=va[ib];ua<za&&La[ua]===mb?++ua:Ca.push(mb)}return Ca}}return Array.from(va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},Ka=(va,La)=>{if(La&&(oa()||y.a.Sj)){if(N())return!!va.querySelector(y.a.Sj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");La=y.a.Sj?va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length:va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;
if(0<La)return La!==va.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!va.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1512:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(2),f=c(1820),a=c(19);class k{static H8h(){return k.Wxk+"_"+f.a.QSc+"_"+a.a.NQ(l.AFrameworkApplication.userName)+"_"}static f3h(x){return x+"_"+f.a.QSc+"_"+a.a.NQ(l.AFrameworkApplication.userName)+"_"}static Rdi(){return k.yFn+
"_"+f.a.QSc+"_"+a.a.NQ(l.AFrameworkApplication.userName)+"_"}}k.zNa="ack0";k.ANa="ack1";k.rBd="ack2";k.Wxk="ack3";k.dqh="ack4";k.eqh="ack7";k.HEi="ack8";k.Tpj="ack9";k.x2e="ack10";k.fto="ack13";k.REi="ack14";k.k2b="AddinDetailsRefreshed";k.Uxk="DdaMethod";k.Txk="ControlId";k.vBd="OsfcontrolId";k.z_e="SecurityOrigin";k.m2b="ak0";k.ayk="ak1";k.hqh="ak2";k.t_e="ak4";k.cqh="Office.AutoShowTaskpaneWithDocument";k.fqh="value";k.$xk="errorCode";k.mrl="SourceControlId";k.krl="OsfControl";k.lrl="RibbonUpdaterData";
k.hle="AddinShared";k.yFn="__OSF_PRIVATECATALOG_ADDINIDS";Object(D.a)(k,"AddinConstantsString",null,[])},1514:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1838),I);f(c(1839),I)},1515:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1822),I);f(c(1823),I)},1518:function(D,I,c){D=c(0);var l=c(22),f=c(80),a=c(60),k=c(2),x=c(731),y=c(135),m=c(241),r=c(608),z=c(9),v=c(5),G=c(254),F=c(8),H=c(419),L=c(361),J=c(1178),M=c(76),P=c(63),N=c(1781),K=c(1825),O=c(1826),V=c(16),W=c(6),T=c(596),Y=c(7),ba=c(110),Z=c(248),ea=c(82),ha=c(1679);class la extends Sys.EventArgs{constructor(xa,fa){super();this.graphNode=xa;this.E_k=fa}}Object(D.a)(la,"OnCopyCommentEventArgs",Sys.EventArgs,
[]);class ia extends Sys.EventArgs{constructor(xa,fa){super();this.graphNode=xa;this.CYk=fa}}Object(D.a)(ia,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var sa=c(1208),Oa=c(1509),Ra=c(1581);class Na extends Sys.EventArgs{constructor(xa){super();this.commentNode=xa}}Object(D.a)(Na,"OnDeleteEventArgs",Sys.EventArgs,[]);class Da extends Sys.EventArgs{constructor(xa){super();this.commentNode=xa}}Object(D.a)(Da,"OnPasteEventArgs",Sys.EventArgs,[]);c.d(I,"a",function(){return ra});class ra{static get ig(){return null!=
ra.qvg?ra.qvg:ra.qvg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get hd(){return null!=ra.bxg?ra.bxg:ra.bxg=new f.a}static get CDa(){return Ra.a.instance}static get nj(){return z.App.za.jb.Yc.vd}static get Zb(){return null!=ra.byg?ra.byg:ra.byg=l.a.instance.Oa("Box4.IFeatureHelper")}static isComment(xa){return 40===xa.Ue}static wYd(xa){return 40===xa.type}static wCf(xa){return!!xa&&39===xa.Ue}static EUf(xa,fa){fa.property===V.a.$e&&(ra.zIb=!1)}static IUf(xa,fa){fa&&!xa.Qc&&ra.APh(xa)}static APh(xa){const fa=
xa.Kb.paragraph.Lc;xa=fa.Eb(xa.$j);ra.xMc();xa&&xa.anchor&&ra.deleteComment(xa,fa)}static maf(xa){const fa=new v.GraphIterator;fa.set(xa.Ui());ra.CDa.o5a(fa);return fa}static deleteComment(xa,fa){xa?(ra.xMc(),ra.KJd(xa,fa),xa.anchor&&(ra.hd.raiseEvent(ra.g1c,new Na(xa)),fa=xa.ja(W.a.cF,0),Y.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${xa.id}`),ra.hOg.add(fa.toString()),fa=new v.GraphIterator,fa.set(xa),fa.zb(39),fa.vg())):Y.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static LIm(xa){return ra.hOg.contains(xa)}static KJd(xa,
fa){ra.xMc();const oa=ra.jca(xa,fa,!0);fa=ra.jca(xa,fa,!1);ra.Bob(oa);ra.Bob(fa);oa&&fa&&oa.Kb===fa.Kb&&Y.ULS.sendTraceTag(50619292,327,10,`comment ${xa.id} start and end range objects belonged to same chp`)}static Bob(xa){if(xa&&xa.Kb.nf){xa.Kb.nf.remove(xa);const fa=xa.Kb.paragraph;0<=xa.oe&&xa.oe<fa.we.length&&(xa.Kb.cp||1!==fa.we.length||(fa.we.mY(0,4),fa.we.rq.Z(1,G.CharacterPropertiesEditor.$M),fa.we.kt.Z(1,G.CharacterPropertiesEditor.WR)),fa.we.removeAt(xa.oe,4));fa.Zl()}}static ejn(xa,fa){if(fa){var oa=
fa.paragraph;xa=fa.cpBegin;var ta=fa.cpEnd;if(oa&&F.ParagraphReader.Wb(oa)&&(oa=oa.qa)){fa.Qo[ra.tGd]||(fa.Qo[ra.tGd]=[]);fa=fa.Qo[ra.tGd];for(let va=0;va<oa.length;va++){const La=oa.J(va).nf;if(!La)continue;const za=La.length;var Ka=oa.J(va).cp;if(Ka<xa||Ka>ta)for(Ka=0;Ka<za;Ka++)fa.push(La.J(Ka))}}}}static kin(xa,fa){if(fa&&(xa=fa.Qo[ra.tGd]))for(fa=0;fa<xa.length;fa++)ra.APh(xa[fa])}static jca(xa,fa,oa){if(!xa)return null;const ta=oa?Oa.k(xa,a.a.nil):Oa.h(xa,a.a.nil);fa=fa.Eb(ta);return fa?ra.rwa(fa,
xa.id,oa):(oa||Y.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${xa.id} Anchor Id: ${ta} ${ra.KIm(ta)}`),null)}static KIm(xa){return H.a.isEnabled?`isDeletedParagraph: ${ra.cQh.has(xa.toString())}`:""}static rwa(xa,fa,oa){for(let ta=0;ta<xa.qa.length;ta++){const Ka=xa.qa.J(ta);if(Ka.nf)for(let va=0;va<Ka.nf.length;va++)if(Ka.nf.J(va).$j.equals(fa)&&oa===Ka.nf.J(va).Qc)return Ka.nf.J(va)}return null}static o$b(xa,fa){if(!xa)return null;fa=fa?Oa.k(xa,a.a.nil):Oa.h(xa,a.a.nil);
return xa.Lc.Eb(fa)}static ePc(xa,fa,oa,ta=null){const Ka=!ta;for(let va=0;va<xa.qa.length;va++){const La=xa.qa.J(va);if(La.cp>=fa&&La.nf)for(let za=0;za<La.nf.length;za++){const Ca=La.nf.J(za).$j.toString();if(La.nf.J(za).Qc===oa&&(Ka||ta.contains(Ca)))return La.nf.J(za)}}return null}static h0l(xa,fa,oa,ta){for(let Ka=0;Ka<xa.qa.length;Ka++){const va=xa.qa.J(Ka);if(va.cp>fa)break;if(va.cp===fa&&va.nf)for(let La=va.nf.length-1;0<=La;La--){const za=va.nf.J(La).$j.toString();if(va.nf.J(La).Qc===oa&&
ta.contains(za))return va.nf.J(La)}}return null}static J1b(xa,fa,oa,ta){let Ka=null;for(let va=0;va<xa.qa.length;va++){let La=xa.qa.J(va);if(La.cp>=oa){La.cp>oa||!La.formatting?(Ka=ra.ig.hZ(xa,va,oa,Ka),La=xa.qa.J(va)):Ka=La.formatting;La.nf||(La.nf=new L.a(La));ra.wAd(fa,La.nf,Ka.Tj,ta);break}La.formatting&&(Ka=La.formatting)}}static wAd(xa,fa,oa,ta){oa=fa.Kb.paragraph;const Ka=new J.a(fa.Kb,null,xa,ta);for(let va=0;va<fa.length;va++)if(fa.J(va).$j===xa&&fa.J(va).Qc===ta){Y.ULS.sendTraceTag(589616028,
327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",xa,ta);break}fa.add(Ka);oa.Zl();Ka.oe?oa.we.mY(Ka.oe-1,4):oa.we.Xoa(Ka.oe,4);oa.we.rq.Z(Ka.oe,G.CharacterPropertiesEditor.$M);oa.we.kt.Z(Ka.oe,G.CharacterPropertiesEditor.WR);return Ka}static xMc(){if(!ra.zIb){var xa=new v.GraphIterator;xa.set(z.App.za.jb.Yc);ra.CDa.o5a(xa);if(xa.Ub(1))for(;xa.Jf(1););ra.zIb=!0}}static YBl(xa){const fa=new v.GraphIterator;fa.set(z.App.za.jb.Yc);ra.CDa.o5a(fa);if(39!==fa.Ue)return!1;
let oa;if(oa=fa.Ub(1)){if(oa.id.equals(xa))return!0;for(;oa=fa.Jf(1);)if(oa.id.equals(xa))return!0}return!1}static jMb(xa,fa){ra.I5c(fa)}static aPj(xa,fa){H.a.isEnabled&&(xa=fa.node)&&(fa=F.ParagraphReader.pR(xa),ra.Mee(fa)&&ra.cQh.add(xa.id.toString()))}static Mee(xa){return 0<xa?document.querySelector("div.PageContentContainer p[paraid='"+xa+"']"):null}static I5c(xa){ra.u6f(F.ParagraphReader.mFb(xa));let fa=null;var oa=new v.GraphIterator;oa.set(xa);if(oa.gp()&&(oa=M.a.zs(oa,oa.origin),oa.moveNext()))for(;oa.moveNext();)if(F.ParagraphReader.kh(oa.iterator)){fa=
oa.iterator.currentNode;break}if(fa){xa=F.ParagraphReader.mFb(xa);for(const ta of xa)ta.Qc&&(xa=ta.Kb.paragraph.Lc.Eb(ta.$j))&&(ra.Bob(ta),ra.J1b(fa,xa.id,0,!0),Oa.v(xa,fa.id))}}static u6f(xa){for(const fa of xa)if(!fa.Qc){xa=fa.Kb.paragraph.Lc;const oa=xa.Eb(fa.$j);ra.deleteComment(oa,xa)}}static ySd(xa,fa){const oa=[];if(!xa)return Y.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),oa;if(!xa.isConnected)return Y.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),
oa;const ta=ra.jca(xa,ra.nj,!0),Ka=ra.jca(xa,ra.nj,!1);if(!ta||!Ka)return Y.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${xa.id}`),oa;xa=!1;let va=ta.Kb.paragraph;for(;va&&(!fa||!fa(va,va===ta.Kb.paragraph));){va===ta.Kb.paragraph&&(xa=!0);xa&&oa.push(va);if(va===Ka.Kb.paragraph)break;va=F.ParagraphReader.$f(va,!1)}return oa}static FUf(xa,fa){fa.Qo.Comments||(fa.Qo.Comments={});ra.c6d(fa.operation,fa.kYi,fa.original,fa.clone,fa.Qo.Comments,!0)}static HUf(xa,fa){fa.Qo.Comments||(fa.Qo.Comments=
{});ra.c6d(fa.operation,fa.kYi,fa.original,fa.clone,fa.Qo.Comments,!1)}static $jn(xa,fa){fa.Qo.Comments||(fa.Qo.Comments={});xa=fa.Qo.Comments;if((fa=Object.keys(xa))&&0<fa.length)for(let oa=0;oa<fa.length;oa++){const ta=xa[fa[oa].toString()];ta&&(ta.$j=null,ra.Bob(ta))}}static c6d(xa,fa,oa,ta,Ka,va){const La=oa.Lc;var za=F.ParagraphReader.mFb(ta);za.sort((ab,Ga)=>ab.Kb.cp<Ga.Kb.cp||ab.Kb.cp===Ga.Kb.cp&&ab.Qc?-1:ab.Kb.cp===Ga.Kb.cp&&ab.Qc===Ga.Qc?0:1);const Ca=new ea.a,ua=new Z.a,ib=ra.Zb.isFeatureEnabled(116);
for(const ab of za)if(Object(ba.a)(sa.MainView,P.InteractiveViewManager.instance.zd)){var bb=La.Eb(ab.$j);if(bb&&bb.isConnected)if(ab.Qc)Ka[ab.$j.toString()]=ab;else{var mb=bb.ja(W.a.cF,0);za=va?ra.D3c(bb,ta,xa,fa):ra.I3c(bb,ta,xa,fa);if(va)ib&&(mb=v.GraphIterator.eb(ta),mb.zb(25)&&mb.ld(25)&&ha.a.hd.raiseEvent(ha.a.PSi,new la(mb.currentNode,za.getValue(W.a.cF))));else{if(ib){var yb=za.ja(W.a.cF,0);mb&&yb&&(ua.nb(mb)?ua.J(mb)!==yb&&Y.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",
mb,yb,ua.J(mb)):ua.add(mb,yb))}za.setValue(W.a.ukb,!0);bb.ja(W.a.k8e,null)||(mb=bb.ja(W.a.hOa,null))&&za.setValue(W.a.k8e,mb);za.setValue(W.a.hOa,k.AFrameworkApplication.userSessionId)}mb=ab.$j.toString();yb=Ka[mb];ab.$j=za.id;if(!va){ab.dv=null;bb=bb.getValue(W.a.EH);const Ga=za.getValue(W.a.EH);Ka[bb]=Ga;if(bb=za.ja(W.a.wM,null))Ca.nb(bb)||Ca.add(bb,[]),Ca.J(bb).push(za)}Oa.u(za,ta.id);ta.id||Y.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");yb?(yb.$j=za.id,va||(yb.dv=null),
Oa.v(za,yb.Kb.paragraph.id),delete Ka[mb]):(ra.J1b(ta,za.id,ab.Kb.cp,!0),Oa.v(za,ta.id))}else Y.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",ra.YBl(ab.$j),!bb)),ab.$j=null,ra.Bob(ab)}else ab.$j=null,ra.Bob(ab);if(!va){for(const ab of Ca){xa=ab.key;fa=ab.value;for(const Ga of fa)Ga.setValue(W.a.wM,Ka[xa])}0<ua.count&&ib&&(oa=v.GraphIterator.eb(oa),oa.zb(25)&&oa.ld(25)&&ha.a.hd.raiseEvent(ha.a.nVi,new ia(oa.currentNode,
ua)))}ta.fk()}static nhf(xa,fa){if(xa.zb(25)&&xa.ld(25)&&!xa.Fs(16)){const oa=v.GraphIterator.eb(fa);oa.zb(39);oa.ld(39);fa=T.b(oa.currentNode,fa.Ui().Lc,!0);xa.xf(fa,16)}}static h$e(xa,fa){var oa=fa.Ui().vd;oa=T.b(xa,oa,!0);fa=v.GraphIterator.eb(fa);ra.nhf(fa,xa);fa.Ub(16);fa.C3(oa,1,xa.id);return oa}static D3c(xa,fa,oa,ta){ra.xMc();fa=ra.h$e(xa,fa);fa.wkb=!0;ra.Qwl(xa,fa,oa,ta);return fa}static Qwl(xa,fa,oa,ta){xa=new N.a(v.GraphIterator.eb(xa),v.GraphIterator.eb(fa),{});xa.lQb=!0;oa=new x.a(oa,
ta,new K.a(xa,null));oa.Hh=!0;oa.Ml("ExecuteInternalCommentCopy");oa.run()}static I3c(xa,fa,oa,ta){ra.xMc();var Ka=fa.Ui().vd;fa=v.GraphIterator.eb(fa);fa.zb(7);fa.ld(7);fa.Ub(16);Ka=T.b(xa,Ka,!0);Ka.Dg(W.a.EH,y.a.create().toString());Ka.Dg(W.a.commentId,m.a.zF());let va=!1;ra.UCi(Ka.rf(W.a.cF))?va=!0:Ka.Dg(W.a.cF,ra.Uof());fa.xf(Ka,1);ra.Rwl(xa,Ka,oa,ta);fa.wj(Ka);fa.zJ(1);fa.pib(2);fa.Ub(2);Ka.setValue(W.a.EH,fa.currentNode.rf(W.a.Wc).toString());ra.hd.raiseEvent(ra.opn,new Da(Ka));va&&this.XNh.add(Ka.id.toString());
return Ka}static Rwl(xa,fa,oa,ta){xa=new O.a(v.GraphIterator.eb(xa),v.GraphIterator.eb(fa),null,null);oa=new x.a(oa,ta,xa);oa.Hh=!0;oa.Ml("ExecuteInternalCommentPaste");oa.run()}static Uof(){const xa=m.a.qic(1,this.YLi);return ra.UCi(xa)?xa:ra.Uof()}static UCi(xa){if(!xa)return!1;if(z.App.za){const fa=new v.GraphIterator;fa.set(z.App.za.jb.Yc);ra.CDa.o5a(fa);let oa=fa.Qd();for(;oa;){if(oa.rf(W.a.cF)===xa)return!1;oa=fa.Kj()}}return!0}static YZe(xa){ra.hd.addHandler(ra.g1c,xa)}}ra.opn="OnPaste";ra.g1c=
"OnDelete";ra.tGd="CommentRangesToTrimOutsideSelection";ra.hOg=new r.a;ra.zIb=!1;ra.YLi=2147483646;ra.XNh=new Set;ra.cQh=new Set;Object(D.a)(ra,"CommentEditor",null,[])},1523:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(f){super();this.data=f}}Object(D.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1525:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.completion=new Promise((f,a)=>{this.resolve=f;this.reject=a})}}Object(D.a)(l,
"ControlledPromise",null,[])},1527:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.sq="SpellingErrorV2";l.mhg="SpellingErrorV2Themed";l.v4k="ContextualSpellingAndGrammarErrorV2";l.K9e="ContextualSpellingAndGrammarErrorV2Themed";l.BBd="AdvancedProofingIssueV2Themed";l.O5i="AdvancedProofingIssueV2Themed";l.Mrj="SimilarityReviewed";l.Nrj="SimilarityReviewedThemed";l.Orj="SimilarityUnreviewed";l.Prj="SimilarityUnreviewedThemed";l.FIh="CopilotHighlightThemed";l.Jlc="SpellingErrorHighlight";
l.I$b="GrammarErrorHighlight";l.veb="CritiqueIndicatorHighlight";l.N5i="ReactiveRewriteIndicatorHighlight";l.uwo="SimilarityHighlight";l.vwo="SimilarityReviewedHighlight";l.SCd="IdeasSuggestionConfirmation";Object(D.a)(l,"CanvasContextualCssClasses",null,[])},1529:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(6),f=c(288),a=c(1187),k=c(1095),x=c(7);class y{constructor(m,r,z,v){this.PYm=m;this.iDm=r;this.hDm=z;this.n0i=v}thc(m,r,z,v,G){m?(m=this.PJc(m,r,z),null!==m&&(v=this.w$e(v,m,
G),this.hDm.setState(this.PYm.value,v))):x.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}PJc(m,r,z){return 0>z?(x.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):f.a.YJc(m.ja(l.a.Wc,-1),m.ja(l.a.oj,-1),r,z,r,z,m)}w$e(m,r,z){return Object.assign(new k.a,{annotationType:m,contentDescriptor:r,state:z})}$Bf(m,r,z,v,G){if(m){var F=m.ja(l.a.Wc,-1),H=m.ja(l.a.oj,-1);-1===F||-1===H?G(null):(m=this.PJc(m,r,z),null===m?G(0):this.iDm.A1c(m,
v,L=>{G(L)}))}else x.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}nAn(m){if(m){var r=a.a.N8k(m);this.n0i.Rnh({Jpb:r,settingType:m})||x.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed")}}lSm(m){return new Promise(r=>{this.n0i.gdi(m,z=>{(null===z||void 0===z?0:z.Jpb)?r(z.Jpb):r(null)})})}}y.C2f="WordDesignerPullQuotesAnnotation";y.yOh="WordDesignerDefaultAnnotation";y.Hig="WordDesignerSuggestedImageAnnotation";y.uxj="WordDesignerThemeImageAnnotation";y.uig=
"WordDesignerStylizedTitleAnnotation";y.C4b="WordDesignerComplexDecoratorAnnotationType";y.tQh="DesignerPaneSuppressionSetting";Object(D.a)(y,"PersistenceHelperImpl",null,[1066])},1530:function(D,I,c){function l(J){return 1===(null===J||void 0===J?void 0:J.Hq)||3===(null===J||void 0===J?void 0:J.Hq)}D=c(0);var f=c(39),a=c(42),k=c(31),x=c(7),y=c(1632),m;(function(J){J[J.initial=0]="initial";J[J.M0o=.1]="viewingOriginal";J[J.QEk=.5]="applying";J[J.applied=1]="applied";J[J.Gbp=2]="accepted";J[J.rejected=
3]="rejected";J[J.Xnp=4]="roleChanged";J[J.Zip=5]="invalidated"})(m||(m={}));Object(D.b)("ReviewIntentState",m);const r=J=>{switch(J){case m.M0o:return m.rejected;case m.QEk:return m.applied;default:return J}};var z=c(134);c.d(I,"d",function(){return G});c.d(I,"e",function(){return l});c.d(I,"b",function(){return F});c.d(I,"c",function(){return H});c.d(I,"a",function(){return L});class v{constructor(J,M,P=null,N,K=!0){this.id=J;this.Hq=M;this.mE=P;this.Xd=N;this.XHm=K;this.lxi=!1;this.kEi=f.a.We()}ami(){return!1}FRa(J){this.ida(m[r(J)]);
this.I2d(J)}I2d(J){1===J&&this.mE&&this.Xd&&(this.XHm?(this.Xd.yFm()&&this.mE.execute(M=>{M.logActivity(z.a.HRj,null)}),2===this.Hq&&this.Xd.oTm()?this.mE.execute(M=>{M.logActivity(z.a.XRj,null)}):1===this.Hq&&this.Xd.kPm()?this.mE.execute(M=>{M.logActivity(z.a.RRj,null)}):0===this.Hq&&this.Xd.eLm()&&this.mE.execute(M=>{M.logActivity(z.a.LRj,null)})):4===this.Hq&&this.Xd.TIm()&&this.mE.execute(M=>{M.logActivity(z.a.JRj,null)}))}PZc(){6E4>f.a.We()-this.kEi?this.ida("removed"):x.ULS.sendTraceTag(539109067,
3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Hq,"removedButKept")}h3m(){this.lxi||(this.ida("hovered"),this.lxi=!0)}ida(J){this.kEi=f.a.We();x.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Hq,J);a.a(z.a.skl,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.Hq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:J})])}}Object(D.a)(v,"DesignerSuggestion",null,[]);class G extends v{constructor(J,
M=1,P=null,N,K=!1,O=0,V=""){super(J,M,P,N,K);this.q6a=O;this.X3c=V}}Object(D.a)(G,"PullQuoteSuggestion",v,[]);class F extends v{constructor(J,M,P,N=null,K,O){super(J,2,N,K);this.xR=M;this.baseUrl=P;this.t0d=O;this.selectedIndex=0;this.bmc=z.a.Oxm}ewm(){x.ULS.shipAssertTag(527708514,3016,this.bmc===z.a.Ngn,`${this.bmc}`);this.bmc=Math.min(this.xR.length,z.a.B3d)}ami(){return this.bmc<Math.min(this.xR.length,z.a.B3d)}IFb(J){return J>=this.xR.length?(x.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+
this.xR[J].imageId}ouf(J){return J>=this.xR.length?(x.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.xR[J].thumbnailId}PX(J){return J>=this.xR.length?(x.ULS.shipAssertTag(527708545,3016,!1),null):this.xR[J].altText?this.xR[J].altText:this.xR[J].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}kZl(J){var M;return J>=this.xR.length?(x.ULS.shipAssertTag(527210446,
3016,!1),0):null!==(M=this.xR[J].score)&&void 0!==M?M:0}FRa(J){if(!this.t0d){const M=m[r(J)];x.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",this.id,M);a.a(z.a.ckl,!0,void 0,[Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:M})])}super.FRa(J)}}Object(D.a)(F,"ImageSuggestion",v,[]);class H extends v{constructor(J,M=null,P,N,K=null){super(J,0,M,P,N);this.metadata=K;this.tNi=!1}FRa(J){this.tNi||(this.tNi=
!0,this.metadata&&a.a(z.a.F9k,!0,0,this.metadata.concat([Object.assign(new k.a,{name:"ID",string:this.id.toString()})])));super.FRa(J)}}Object(D.a)(H,"InconsistencySuggestion",v,[]);class L extends v{constructor(J,M=null,P,N=!1,K){super(J,4,M,P,N);this.bzn=K}FRa(J){this.MCo=J;super.FRa(J)}}Object(D.a)(L,"DesignerPasteSuggestion",v,[])},1532:function(D,I,c){c.d(I,"a",function(){return l});const l={lFh:"CommentDeepLinkNavigationFailed",fGd:"CommentDataLoss",v4b:"CommentExperienceDegraded",Yif:"CommentsFeatureUsage",
o8e:"CommentThreadInProgress",uGd:"CommentReplyInProgress",oFh:"CommentEditInProgress",gGd:"CommentDeepLink",jFh:"CommentCommit",w4b:"CommentLoad",DFh:"CommentInitialization"}},1533:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k,x=!1,y=!1,m=!1,r=!1,z=null){this.ml=f;this.source=a;this.sRa=k;this.hga=x;this.Dlc=y;this.gif=m;this.GOa=r;this.Po=z}}Object(D.a)(l,"ContextualIntentInvocationParameters",null,[])},1534:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);
class l{constructor(f,a,k,x,y=null,m=null,r=null,z=0,v=0){this.b5=this.Kmc=this.rHa=this.ZR=null;this.IH=z;this.Rbe=f;this.ASa=a;this.p8a=k;x&&(this.ZR=x);null!=y&&(this.rHa=y);null!=m&&(this.Kmc=m);r&&(this.b5=r);this.shapeId=v}}Object(D.a)(l,"AnchorData",null,[])},1538:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);var l=c(19),f=c(190),a=c(9),k=c(534),x=c(43),y=c(17),m=c(23),r=c(236),z=c(8);class v{constructor(G,F,H,L,J){this.BHb=G;this.M2a=F;this.Awb=H;this.Bla=L;this.Ld=J;this.N3g=0;this.Uab=
null;this.Jgk=!1;this.v3g=!0;this.mZg=null;this.k0c=this.Epd=!0;this.C_g=!1;this.Rzc=G?G.innerText:z.ParagraphReader.text(F)}get bD(){throw Error.notImplemented("The inherit class should have the default value.");}set bD(G){}get pKb(){return this.N3g}anj(G){this.N3g=G}get lb(){return this.Uab}set lb(G){this.Uab=G}get NG(){return this.Awb}get T0(){return this.Bla}get Ewi(){return this.C_g}get ICi(){return!1}get tya(){return this.Rzc}get nso(){return!0}invoke(){this.C_g=!0;if(this.BHb&&this.BHb.parentNode&&
!this.bD){var G=this.BHb.innerText;if(this.k0c&&l.a.substring(this.Rzc,this.Awb,this.Bla)!==l.a.substring(G,this.Awb,this.Bla))return 0;this.xDb(this.BHb);this.anj(this.BHb.innerText.length-G.length);return 1}this.Epd||f.a.instance.Yb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.v3g)return f.a.instance.Yb("AbortedAction",{["Reason"]:this.mZg}),0;var F=z.ParagraphReader.text(this.M2a);G=F.length;var H=this.Rzc.length,L=l.a.substring(this.Rzc,this.Awb,this.Bla).trimEnd();F=
l.a.substring(F,this.Awb,this.Bla).trimEnd();this.nso&&L===F&&this.Bla>H&&(this.Bla=H);if(this.k0c&&L!==F)if(H=L.replace(RegExp('"',"g"),""),H===l.a.substr(F,0,H.length))this.Bla-=2;else return 0;if(a.App.xd.So&&k.CoauthLockEditor.getInstance().I7a(v.Uf.P8b(this.M2a)))return 0;H=new x.GraphTransaction(15);H.Db(this.M2a);H.Qj=this.commandId;this.Jna(this.M2a);this.anj(z.ParagraphReader.textLength(this.M2a)-G);this.Uab&&!this.Jgk&&y.SelectionEditor.Il(this.Uab)&&(F=this.Uab.Pa,G=F.cpBegin,L=F.cpEnd,
F=F.node,F===this.M2a&&this.pKb&&(G>=this.Bla&&(G+=this.pKb),L>=this.Bla&&(L+=this.pKb),this.Uab=m.SelectionFactory.gJ(F,G,L)));H.dispose();return 2}LHj(){this.Epd=this.lCh()}xDb(){}lCh(){var G=z.ParagraphReader.text(this.M2a);const F=l.a.substring(this.Rzc,this.Awb,this.Bla).trimEnd();G=l.a.substring(G,this.Awb,this.Bla).trimEnd();return F===G}static get Uf(){return r.a.instance}}Object(D.a)(v,"AAutoCorrectAction",null,[570])},1539:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(26),
f=c(7);class a{constructor(k){this.ml=k}static create(k){if(!k)return f.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(D.a)(a,"ShowReviewArgs",null,[])},1540:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.data=this.landingTab=null}}Object(D.a)(l,"LaunchData",null,[])},1544:function(D,I,c){c.d(I,"c",function(){return a});c.d(I,"a",function(){return k});c.d(I,"b",function(){return x});D=c(0);var l=c(1529);class f{constructor(y,m,
r){this.suggestion=y;this.Hq=m;this.paragraphNode=r}get role(){switch(this.Hq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(D.a)(f,"AddEnhancementActionData",null,[]);class a extends f{constructor(y,m,r,z,v,G=1){super(y,G,m);this.q6a=r;this.X3c=z;this.callback=v}}Object(D.a)(a,"AddPullQuoteActionData",f,[]);class k extends f{constructor(y,m,r=0){super(y,2,m);this.Poa=r}}Object(D.a)(k,"AddCoverPhotoActionData",f,[]);class x{constructor(y,m,r,z,v){this.suggestion=y;this.es=m;this.hbc=
r;this.DUc=z;this.xCd=v}get annotationType(){switch(this.suggestion.Hq){case 1:case 3:return l.a.C2f;case 2:return l.a.Hig;default:return l.a.yOh}}get NRa(){return this.es&&1<=this.es.length?this.es[0]:null}}Object(D.a)(x,"AddDesignerSuggestionActionData",null,[])},1548:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"OAuthResult",null,[])},1549:function(D,I,c){c.r(I);c.d(I,"FindManagerHelper",function(){return y});D=c(0);var l=c(7),f=c(110),a=c(9),k=c(174),x=c(1058);
c=c(1834);class y extends c.a{constructor(){super()}get Yc(){return a.App.za.jb.Yc}get nj(){return a.App.za.jb.Yc.vd}get rpa(){return a.App.za.jb.rpa()}get GCf(){return a.App.za.jb.qc.Vi}lZe(m){a.App.ni.zl.vNa(m)}A4d(m,r,z){return x.b(m,r,z)}Emg(m,r,z){if(1===z){if(!y.ai.Fmg(m))return!1}else if(!(m.Ue===r||m.zb(r)&&m.ld(r)))return!1;return Object(f.a)(59,m.currentNode)||this.A4d(m,r,z)?!0:!1}ZEa(m){return this.nj.Eb(m).ZEa()}jAi(m,r,z,v){if(!m||m.matchCase!==z.matchCase||m.matchWholeWord!==z.matchWholeWord||
v.length!==r.length)return!0;for(m=0;m<v.length;m++){if(v[m]!==r[m])return!0;if(z.matchCase){if(v[m]!==r[m])return!0}else if(v[m].toLocaleLowerCase()!==r[m].toLocaleLowerCase())return!0}return!1}tAi(m,r,z,v){if(!m||m.matchWholeWord&&!z.matchWholeWord||m.matchCase&&!z.matchCase||v.length!==r.length)return!1;if(m.matchWholeWord)return m.matchCase?r[0]===v[0]:v[0].toLocaleLowerCase()===r[0].toLocaleLowerCase();for(let G=0;G<v.length;G++)if(m.matchCase){if(!v[G].startsWith(r[G]))return!1}else if(!v[G].toLocaleLowerCase().startsWith(r[G].toLocaleLowerCase()))return!1;
m.matchCase===z.matchCase&&m.matchWholeWord===z.matchWholeWord&&1===r.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});return!0}oce(m,r,z){const v=a.App.ni.zl.Te(12);v.Mo(m);v.hu(r);v.Fx(z)}static get ai(){return k.PageNavigator.instance}static get instance(){y.vub||(y.vub=new y);return y.vub}}y.vub=null;Object(D.a)(y,"FindManagerHelper",c.a,[])},1550:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(2);class f{constructor(){this.currentDocumentPath=
l.AFrameworkApplication.K.kb("EditDocInClientUrl")}}Object(D.a)(f,"SmartLookupApplicationInterface",null,[])},1551:function(D,I,c){c.d(I,"a",function(){return P});D=c(0);var l=c(731),f=c(5),a=c(1781),k=c(1825),x=c(1826),y=c(197),m=c(8),r=c(43),z=c(137),v=c(174),G=c(546),F=c(6),H=c(596),L=c(78),J=c(161),M=c(533);class P{constructor(N,K,O,V,W){P.ZYd=!1;this.zE=N;this.AMe=K;this.zMe=O;this.Zc=V;this.a2j=W}wgo(N,K){this.zE.jpa(N)&&N.properties.setValue(F.a.eoa,K)}o7b(){if(!P.ZYd){var N=this.yci();for(var K=
N.Ub(7);K;K=N.Ni(7))for(K=N.Ub(8);K;K=N.Ni(8));P.ZYd=!0}}yci(){const N=this.Zc.yk();N.set(this.a2j());P.ai.EP(N);return N}Wu(){const N=this.yci();this.zMe.B4d(N);this.d1n(N.currentNode);P.ZYd=!1}fGn(N){this.o7b();if(N.isConnected){var K=this.u4(N);if(K=this.zE.KPc(N,K)){var O=this.Zc.yk();O.set(K);O.zb(25);N.anchor&&(O.set(N),O.zb(37),O.vg())}}}Gul(N,K){if(N.zb(25)&&N.ld(25)&&!N.Fs(7)){const O=f.GraphIterator.eb(K);O.zb(37);O.ld(37);K=H.b(O.currentNode,K.Ui().Lc,!0);N.xf(K,7)}}Vwl(N,K,O,V){N=new a.a(f.GraphIterator.eb(N),
f.GraphIterator.eb(K),{});N.lQb=!0;O=new l.a(O,V,new k.a(N,null));O.Hh=!0;O.Ml("ExecuteInternalFootnoteEndnoteCopy");O.run()}h$e(N,K){K=K.Kb.paragraph;var O=K.Ui().vd;O=H.b(N,O,!0);K=f.GraphIterator.eb(K);this.Gul(K,N);K.Ub(7);K.xf(O,8);return O}D3c(N,K,O,V){this.o7b();const W=this.u4(N);if(!this.zE.KPc(this.zE.Jci(N),W))return null;K=this.h$e(N,K);this.Vwl(N,K,O,V);return K}I3c(N,K,O,V){this.o7b();var W=K.Kb.paragraph;const T=W.Ui().vd;W=f.GraphIterator.eb(W);W.zb(7);W.ld(7);this.y4d(W,K.u4());K=
H.b(N,T,!0);W.xf(K,8);this.Wwl(N,K,O,V);return K}Wwl(N,K,O,V){N=new x.a(f.GraphIterator.eb(N),f.GraphIterator.eb(K),null,null);O=new l.a(O,V,N);O.Hh=!0;O.Ml("ExecuteInternalFootnoteEndnotePaste");O.run()}y4d(N,K){N.Ub(7);this.zE.Rwi(N,K)||N.Jf(7)}L$h(N,K){const O=this.Zc.yk();O.set(K);O.zb(7);O.ld(7);this.y4d(O,N);return O}qbi(N,K,O){return this.zbi(N,K,O,!1)}I8l(N,K,O){return this.zbi(N,K,O,!0)}zbi(N,K,O,V){var W=this.Zc.yk();let T=null,Y=!1;W.set(N);W.gp();W.ld(8);W.Qd();for(W=y.a.zs(W,W.Tcd(8));W.moveNext();){if(m.ParagraphReader.Wb(W.currentNode)){const Z=
W.currentNode;var ba=L.i(Z,7);for(const ea of ba){if(Z===N){ba=ea.Kb.cp;if(V&&ba>=K)return T;ba>=K&&-1!==K&&(Y=!0)}if(ea.u4()===O){if(!V&&Y)return ea;T=ea}}Z===N&&(Y=!0)}if(V&&Y)return T}return null}d1n(N){const K=new r.GraphTransaction(3);K.Db(N);N=y.a.ap(P.ai.ru(N));let O=1,V=1;for(;N.moveNext();){var W=N.currentNode;if(W&&m.ParagraphReader.Wb(W)){W=L.i(W,7);for(const T of W){W=T.v4();const Y=T.u4()?O++:V++;this.wgo(W,Y)}}}K.dispose()}u4(N){return this.zE.jpa(N)?N.properties.getValue(F.a.m4):0}static iXl(){return new P(M.a.instance,
z.PageReader.instance,v.PageNavigator.instance,new G.a,P.kKl)}static kKl(){return J.App.hn.jb.Yc}static get ai(){return v.PageNavigator.instance}static get instance(){return null!=P.BAg?P.BAg:P.BAg=P.iXl()}}P.ZYd=!1;Object(D.a)(P,"FootnoteEndnoteEditorInteractive",null,[392])},1552:function(D,I,c){c.d(I,"a",function(){return N});D=c(0);var l=c(113),f=c(2),a=c(548),k=c(240),x=c(335),y=c(1527),m=c(779),r=c(303),z=c(506),v=c(639);c.n(v);var G=c(864);c.n(G);var F=c(609),H=c(1067),L=c(1664),J=c(104),M=
c(865),P;(function(K){K[K.Spelling=0]="Spelling";K[K.Grammar=1]="Grammar";K[K.Style=2]="Style";K[K.Apc=3]="Similarity";K[K.Wrg=4]="ContextIQ";K[K.fLj=5]="AutoReplace";K[K.Zrg=6]="CopilotHighlight"})(P||(P={}));Object(D.b)("AnnotationRenderCategory",P);class N{static $Rl(K){switch(N.dTd(K)){case P.Spelling:K=y.a.mhg;break;case P.Grammar:K=y.a.K9e;break;case P.Apc:K=60!==K.M_.state&&70!==K.M_.state?y.a.Prj:y.a.Nrj;break;case P.Wrg:if(L.a.tBi(K))return;K=y.a.BBd;break;case P.fLj:K=y.a.SCd;break;case P.Zrg:K=
y.a.FIh;break;default:K=y.a.BBd}return K}static ahm(K){switch(N.dTd(K)){case P.Spelling:return r.f.SpellingSquiggle;case P.Grammar:return r.f.GrammarSquiggle;default:return r.f.CritiqueSquiggle}}static dTd(K){let O;if(N.zXc(K)){switch(K.priority){case 0:O=P.Spelling;break;case 1:O=P.Grammar;break;default:O=P.Style}Object(M.b)()&&this.XXd(K)&&(O=P.Zrg)}else N.mdc(K)?O=P.Apc:N.IVc(K)&&(O=P.Wrg);return O}static XXd(K){return k.a.getTypeNameFor(K)===v.AddInTextAnnotation.getTypeName()}static zXc(K){const O=
k.a.getTypeNameFor(K);return O===x.a.getTypeName()||O===m.a.getTypeName()||Object(M.b)()&&this.XXd(K)}static IVc(K){return k.a.getTypeNameFor(K)===G.FlagAnnotation.getTypeName()}static mdc(K){return k.a.getTypeNameFor(K)===a.a.getTypeName()}static c0d(K){return N.zXc(K)?0===K.priority:!1}static rZd(K){return N.zXc(K)?1===K.priority:!1}static aFm(K){return k.a.getTypeNameFor(K)===m.a.getTypeName()}static eCf(K){return null!=K&&"Spelling"===K.categoryName&&1===K.suggestions.length&&4===(K.suggestions[0].suggestionActions&
4)}static Pdm(K,O){const V=[r.b.IgnoreOnce];switch(K){case 0:V.push(r.b.IgnoreAll);O&&V.push(r.b.AddToDictionary);break;case 1:V.push(r.b.Options)}return V}static P4h(K){return N.zXc(K)?K.categoryName:N.mdc(K)?N.Lrj:N.IVc(K)?N.BEl:null}static mtf(K,O){let V=z.a.Qkc;switch(K){case 0:V=O?z.a.hhe:z.a.Vnj;break;case 1:V=z.a.Unj}return V}static A8b(K,O=!1,V){V="IntentProvider_Suggestion_"+V;let W=l.a.Eb(K,V);O&&!W&&l.a.Nl(K,V,W=new F.a);return W}static Twf(K,O,V,W,T,Y,ba,Z,ea=!1,ha){W&&V&&(!(V=Y.Z2h(V,
T))||!H.a.OQa()&&f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.dTd(V)==P.Style||(ba.WLd(K,O,Z),N.A8b(K,!0,ha).add(V.id),O=N.$Rl(V),K.classList.add(O),N.xSb&&N.mYe(K,V),ea&&H.a.SZc()))}static get xSb(){return null!=N.LHg?N.LHg:N.LHg=f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static mYe(K,O){N.c0d(O)?K.setAttribute("aria-invalid","spelling"):N.rZd(O)&&K.setAttribute("aria-invalid",
"grammar")}static MQa(K,O,V){K=(K=N.A8b(K,!1,V))?J.firstOrDefault(K):null;return{returnValue:!!K,type:K?V:null,data:K}}}N.Lrj="Similarity";N.BEl="FlagAnnotation";Object(D.a)(N,"AnnotationHelper",null,[])},1558:function(D,I,c){D=c(0);class l{static S3l(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(D.a)(l,"EventReceiverIdCounter",null,[]);c.d(I,"a",function(){return f});class f{constructor(a,k){this.nWb=a;this._id=l.S3l();this.Hfk=k}get id(){return this._id}notify(a,k){this.Hfk(a,
k)}jP(a,k){return this.nWb.dJn(a,k?this:null)}}Object(D.a)(f,"EventReceiver",null,[513])},1562:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.open="open";l.refresh="refresh";l.y$f="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.yaf="createNew";Object(D.a)(l,"ReasonList",null,[])},1563:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static Ibd(f){if(!f)return"{NULL}";const a=f.length;if(600>=a)return f;const k=a-195;return f.substring(0,400)+"[...]"+f.substring(k,
a)}}Object(D.a)(l,"LogUtils",null,[])},1564:function(D,I,c){c.d(I,"b",function(){return l});c.d(I,"a",function(){return f});c.d(I,"c",function(){return a});const l=(k,x,y,m,r,z,v,G)=>{var F=1;if(!k&&!x||!y||!m)return F;r&&z?(z=y+k,F=m+x,k=1/y,x=1/m,r=k>x?k:x,1>z?z=1:1920<z&&(z=1920),1>F?F=1:1280<F&&(F=1280),k=z-y,x=F-m,G?(y=z/y,m=F/m,F=Math.abs(y-v)<Math.abs(m-v)?y:m):F=Math.abs(k/y)>Math.abs(x/m)?z/y:F/m,F<r&&(F=r)):r?(v=y+k,1>v?v=1:1920<v&&(v=1920),F=v/y):z&&(v=m+x,1>v?v=1:1280<v&&(v=1280),F=v/
m);return F},f=(k,x)=>{k=Math.atan2(x.y-k.y,x.x-k.x);0>k&&(k+=2*Math.PI);return k},a=k=>{k%=360;0>k&&(k+=360);return k}},1565:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupSelection",null,[])},1567:function(D,I,c){c.d(I,"a",function(){return M});D=c(0);var l=c(22),f=c(897),a=c(546),k=c(32),x=c(174),y=c(6),m=c(46),r=c(16),z=c(7),v=c(110),G=c(69),F=c(54),H=c(479),L=c(145),J=c(1059);class M{constructor(P,N,K,O,V,W){this.Umk=P;this.ue=N;this.yvf=K;this.OYb=
O;this.$2j=V;this.Z2j=W}get Gk(){return null!=this.jGg?this.jGg:this.jGg=l.a.instance.resolve("WordEditor.ITableEditor")}get Pd(){return null!=this.kHg?this.kHg:this.kHg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Bj(){return null!=this.SGg?this.SGg:this.SGg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get VSb(){return this.Umk.value}get zdd(){return this.ue.value}yXk(P){const N=this.VSb.ATd(P,f.a.BLb);N&&(this.XPb(N,P),this.sza(1696,
P))}XPb(P,N,K=!0){const O=this.VSb.cRc(N);if(O&&(P=this.zdd.wg(P),O.jj(P))){const V=this.VSb.i0(N);let W="Unknown";this.VSb.oZa.value&&(W=this.VSb.oZa.value.nb(P)?P:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:W,["RowCount"]:this.$2j(N),["ColumnCount"]:this.Z2j(N),["HR"]:!!(V&32),["FC"]:!!(V&128),["TR"]:!!(V&64),["LC"]:!!(V&256),["BR"]:!(V&512),["BC"]:!(V&1024),["TableId"]:N.id.toString()});K&&this.$Ta(N);this.tXo(N,O);K=O.jj(P);N.properties.setValue(y.a.tableStyle,K.id);
this.wXk(N);N.Q_.Xha(!0)}}Oge(P,N,K){if(P=this.VSb.ATd(K,P))this.sza(N,K),this.XPb(P,K)}sza(P,N,K=!0){K&&this.$Ta(N);N.properties.setValue(y.a.tableLook,P);z.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(P&32),["FC"]:!!(P&128),["TR"]:!!(P&64),["LC"]:!!(P&256),["BR"]:!(P&512),["BC"]:!(P&1024),["TableId"]:N.id.toString()});N.Q_.Xha(!0)}tXo(P,N){(P=this.OYb(P))&&N.Pge(P)}wXk(P){if(P.isConnected){P.hasProperty(m.a.qx)&&P.removeProperty(m.a.qx);this.jZn(P);this.m$i(P);P=this.yvf.Tf(P);for(var N=P.Ub(1);N;){for(N=
P.Ub(1);N;)N.hasProperty(r.a.QK)&&N.removeProperty(r.a.QK),N.hasProperty(y.a.OIa)&&N.removeProperty(y.a.OIa),this.Aob(N),this.m$i(N),N=P.Ni(1);N=P.Ni(1)}}}NTd(P){let N=P.ja(m.a.Y5a,null);if(N)return N;if(P=this.zdd.wg(P))if(N=({value:N}=this.VSb.oZa.value.Fc(P,N)).returnValue?N:null)return N;return P}ceo(P,N,K,O,V){P.properties.setValue(N.style,K);P.properties.setValue(N.size,O*L.a.JGc);P.properties.setValue(N.color,V)}$Ta(P){if(this.Pd.tg){var N;Object(v.a)(H.a,P)&&(N=Object(G.a)(H.a,P))&&(N=N.cV())&&
this.Bj.$Ta(P,N)}}jZn(P){P.zg(y.a.Xa,y.a.Ya,y.a.Eza,y.a.pb,y.a.qb,y.a.Cza,y.a.Va,y.a.Wa,y.a.Bza,y.a.rb,y.a.tb,y.a.Dza,y.a.ub,y.a.vb,y.a.LIa,y.a.Nb,y.a.Ob,y.a.MIa)}Aob(P){P.zg.apply(P,this.Gk.$Ah)}m$i(P){P.zg(y.a.Da,y.a.Aa,y.a.Ba,y.a.Ca,y.a.kS,y.a.xV,y.a.CUa,y.a.BUa)}static Nem(){return new M(l.a.instance.Re("WordEditor.IWACTableStyleReader"),l.a.instance.Re("Box4.Styles.IWACStyleReader"),new a.a,Object(F.a)(M.ai,M.ai.ru,"navigateToPageContentNode"),k.TableReader.eg,k.TableReader.eh,J.a.instance)}static get ai(){return x.PageNavigator.instance}static get instance(){return null!=
M.zBg?M.zBg:M.zBg=M.Nem()}}Object(D.a)(M,"WACTableStyleEditor",null,[346,347])},1574:function(D,I,c){I=c(1967);c=c(1968);c.esp=I;c.fsp=c;D.exports=c},1581:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(174),f=c(247);class a{o5a(k){a.ai.EP(k);return k.Ub(16)}static Ur(){return new f.a(()=>new a)}static get instance(){return a._instance.value}static get ai(){return l.PageNavigator.instance}}a._instance=a.Ur();Object(D.a)(a,"CommentNavigator",null,[361])},1583:function(D,I,c){c.d(I,"a",
function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(){super();this.BTi=this.VGa=null}}Object(D.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1584:function(D,I,c){c.d(I,"a",function(){return H});D=c(0);var l=c(7),f=c(9),a=c(534),k=c(36),x=c(60),y=c(2048),m=c(2),r=c(1518),z=c(1532),v=c(117),G=c(600),F=c(1509);class H{static k4m(){const L=document.getElementsByClassName(G.a.tYf);if(L&&L.length){var J=L[0].clientWidth;for(let M=1;M<L.length;M++){if(L[M].clientWidth!==J||M===L.length-
1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",L[M].clientWidth-J,L.length);break}J=L[M].clientWidth}}}static Tsg(L,J,M){L&&(L=f.App.xd.Yp.Vqf(L),a.CoauthLockEditor.getInstance().I7a(L)&&l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${J.objectId} added to a locked ${M?"start":"end"} paragraph. Lock Type ${L.Type.toString()}`))}static j0o(L,J,M){var P=J.Eb(x.a.Ff(L.objectId));if(P){var N=r.a.jca(P,J,!0);J=r.a.jca(P,J,!1);null!==N&&void 0!==N&&N.dv||(N=F.k(P),l.ULS.sendTraceTag(540160404,
327,15,`CommentRangeStart failed to save. startParaId: ${N}, CommentObjectId: ${L.objectId}`),H.KIi(M));null!==J&&void 0!==J&&J.dv||(P=F.h(P),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${P}, CommentObjectId: ${L.objectId}`),H.KIi(M))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${L.objectId}`)}static KIi(L){L.logKpiFailure(z.a.jFh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:z.a.fGd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static $3m(L,J,M){0!==L.size&&L.forEach(P=>{J.has(P)||H.a4m(P,M)})}static a4m(L,J){J.Eb(x.a.Ff(L))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${L}`)}static uUk(L){const J=new Set;L.forEach(M=>{M&&M.tj&&((M=H.J5l(M))?J.add(M):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});J.forEach(M=>{const P=M.ja(v.a.s8e,[]);0===M.ja(v.a.q8e,[]).length&&0===P.length&&l.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${M.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static TUm(L,
J,M,P){L=M.R5h(L);if(!L)return!1;M=F.k(L,x.a.nil);P=P.Eb(M);J.has(M.toString())&&l.ULS.sendTraceTag(539800643,327,15,`Para Node ${M} missing comment reference for comment ${L.id}`);return P&&P.tj?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${M} with missing comment reference for comment ${L.id} is in a invalid state ${P?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static J5l(L){let J;try{J=k.OutlineElementNavigator.Hl(L)}catch(M){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${L.id} OutlineNode failed to retrieve ${M}`)}return J}static lUl(L){var J;
switch(null===(J=L.yz)||void 0===J?void 0:J.sessionType){case y.a.create:return z.a.o8e;case y.a.reply:return z.a.uGd;case y.a.edit:return z.a.oFh}}static cCh(L){if(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(L=L[1])&&0!==L.length){var J=new Set;for(let M=0;M<L.length;M++)J.add(L[M].UserId);L.length>J.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${L.length-J.size}`)}}}Object(D.a)(H,"CommentDiagnosticHelpers",
null,[])},1585:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(7);class f{constructor(a){this.rj=a}get zk(){return this.rj&&this.rj.Vi?this.rj:null}FTa(a,k){return this.zk?this.zk.y5e(a,!0)?this.zk.FTa(a,k,!0,!0,!1):(l.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(D.a)(f,"PageViewWrapper",null,[])},1586:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(56),f=c(155),a=c(7),k=c(81),x=c(61);class y{constructor(m,
r,z){a.ULS.shipAssertTag(6305502,307,!!m);this.properties=m;this.Hc=r;this.qT=z}ddi(){return this.properties.ja(f.a.IP,"")}H1i(){return!0}JAj(){let m=!1,r=null;const z=this.ddi();if(this.qT||""!==z)try{({Ova:r,returnValue:m}=this.Lnc(z))}catch(v){a.ULS.shipAssertTag(4203138,307,!1),this.Hc.Yb(k.a.Zna,{["Reason"]:x.a.g4e}),l.a.K_(r)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Hc.Yb(k.a.U1,{["Reason"]:x.a.Aif});return{returnValue:m,fHd:r}}}Object(D.a)(y,"AStringInputImportStrategy",
null,[531])},1587:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.Y$=[]}A6h(){const f=new l;for(let a=0;a<this.Y$.length;a++)f.add(this.J(a));return f}get count(){return this.Y$.length}J(f){return this.Y$[f]}Z(f,a){return this.Y$[f]=a}add(f){this.Y$.push(f)}clear(){Array.clear(this.Y$)}contains(f){return Array.contains(this.Y$,f)}getRange(f,a){const k=new l;for(let x=0;x<a;x++)k.add(this.J(f+x));return k}indexOf(f){return Array.indexOf(this.Y$,f)}insert(f,a){Array.insert(this.Y$,
f,a)}remove(f){return Array.remove(this.Y$,f)}removeAt(f){Array.removeAt(this.Y$,f)}removeRange(f,a){for(let k=0;k<a;k++)Array.removeAt(this.Y$,f)}reverse(){this.Y$.reverse()}sort(){this.Y$.sort()}toArray(){return Array.clone(this.Y$)}}Object(D.a)(l,"List",null,[])},1589:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.generalException="GeneralException";l.invalidArgument="InvalidArgument";l.notImplemented="NotImplemented";l.eAb="AccessDenied";l.RVm="ItemNotFound";l.notSupported=
"NotSupported";l.apiNotAvailable="ApiNotAvailable";l.notAllowed="NotAllowed";l.avn="OperationCancelled";l.userNotSignedIn="UserNotSignedIn";l.userAborted="UserAborted";l.invalidResourceUrl="InvalidResourceUrl";l.invalidGrant="InvalidGrant";l.clientError="ClientError";l.serverError="ServerError";Object(D.a)(l,"ErrorCodes",null,[])},1590:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.id=f}}Object(D.a)(l,"DesignerPaneToggleData",null,[])},1592:function(D,I,c){c.d(I,
"a",function(){return x});D=c(0);var l=c(1868),f=c(546),a=c(6),k=c(1058);class x{constructor(y){this.VVl=(m,r)=>{const z=this.Uei(m),v=this.Zc.Tf(r);return v.zb(z)?(v.ld(z),new l.a(v.currentNode,r,m)):null};this.UVl=(m,r)=>{let z=null,v=null;const G=this.Uei(m);r=this.Zc.Tf(r);({rootNode:z,Zja:v}=this.rko(r,m,G,z,v));return z&&v?new l.a(z,v,m):null};this.ZVl=m=>{m=this.Zc.Tf(m);return(this.v9(2)||this.v9(4))&&m.zb(36)?(m.ld(36),this.KCl(m.currentNode)):(this.v9(8)||this.v9(16))&&m.zb(37)?(m.ld(37),
this.TZh(m.currentNode)):this.v9(32)&&m.zb(40)?32:this.v9(1)&&m.zb(8)?1:0};this.Zc=y;this.LCl=this.ZVl;this.wCl=this.VVl;this.vCl=this.UVl;this.bDl=31;this.Nig=this.cWl()}p8h(y){const m=[],r=this.LCl(y);if(r){var z=this.wCl(r,y);z&&(m[m.length]=z)}for(const v of this.Nig)v!==r&&v&&(z=this.vCl(v,y))&&(m[m.length]=z);return m}v9(y){return!!y&&!!(this.bDl&y)}rko(y,m,r,z,v){if(y.zb(7)){y.ld(7);if(8===r||37===r||39===r)for(var G=y.Qd();G;){if(G.type===r)if(37===r){if((8===m||16===m)&&m===this.TZh(G)){z=
y.currentNode;break}}else{z=y.currentNode;break}G=y.Kj()}z&&y.Gz()&&(G=this.Zc.Tf(z),k.b(G,r,m)&&(v=y.currentNode))}return{rootNode:z,Zja:v}}cWl(){const y=[];this.v9(1)&&(y[y.length]=1);this.v9(2)&&(y[y.length]=2);this.v9(4)&&(y[y.length]=4);this.v9(8)&&(y[y.length]=8);this.v9(16)&&(y[y.length]=16);this.v9(32)&&(y[y.length]=32);return y}Uei(y){let m=8;switch(y){case 1:case 2:case 4:m=8;break;case 8:case 16:m=37;break;case 32:m=39}return m}TZh(y){y=y.properties.getValue(a.a.m4);return this.v9(8)&&
1===y?8:this.v9(16)&&!y?16:0}KCl(y){y=y.getValue(a.a.bac);return this.v9(2)&&x.BLm(y)?2:this.v9(4)&&x.ZKm(y)?4:0}static bF(){return new x(new f.a)}static get instance(){return null!=x.HAg?x.HAg:x.HAg=x.bF()}static BLm(y){return y&&1!==y&&2!==y?!1:!0}static ZKm(y){return 3===y||4===y||5===y?!0:!1}}Object(D.a)(x,"WordFindContextHelper",null,[332])},1600:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(92),f=c(1525);class a{constructor(k){this.taskManager=k}zEa(k,x){const {priority:y=2,
delay:m=0}=null!==x&&void 0!==x?x:{},r=new f.a,z=async()=>await k();x=new l.a(y,1,m,()=>{z().then(r.resolve).catch(r.reject)});this.taskManager.Xb(x);return r.completion}}Object(D.a)(a,"TaskDispatcher",null,[])},1601:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(135),f=c(2),a=c(7);class k{constructor(x,y){this.PQ=x;this.X5=y}aK(x,y,m){x={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:l.a.create().toString(),
["email"]:y,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(m)})},["survey"]:{["surveyId"]:x},["telemetry"]:this.x_a(),["web"]:this.kBb()};this.nja(JSON.stringify(x),{["Content-Type"]:"application/json"})}x_a(){const x=f.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:f.AFrameworkApplication.buildVersion,["featureArea"]:"EditorAi",["audienceGroup"]:x.AudienceGroup,["osBuild"]:x.OsVersion,["platform"]:x.Platform,
["processSessionId"]:x.WACSessionID,["flights"]:f.AFrameworkApplication.K.kb("FlightId"),["loggableUserId"]:f.AFrameworkApplication.K.kb("LoggableUserId"),["tenantId"]:f.AFrameworkApplication.K.kb("TenantId")}}nja(x,y,m=0){3<m||this.X5.zEa(()=>{this.PQ.sj("https://petrol.office.microsoft.com/v1/feedback",2,x,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.nja(x,y,m+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",
m)},null)},{delay:this.lTl(m)})}lTl(x=0){let y=0;1===x?y=200:1<x&&(y=200+500*(x-1));return y}kBb(){const x=f.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:x.Browser,["browserVersion"]:x.BrowserVersion,["dataCenter"]:x.WACDatacenter}}}Object(D.a)(k,"EditorAiSurveysApiClient",null,[])},1603:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);class l{constructor(a){this.selectedRating=a}}Object(D.a)(l,"EditorAiRatingData",null,[]);class f{constructor(a,k,x){this.rating=[new l(a)];
this.comment=[k,...x]}}Object(D.a)(f,"EditorAiSurveyData",null,[])},1609:function(D,I,c){var l=c(1534);D=c(0);class f{}Object(D.a)(f,"SerializableAnchorDataV1",null,[]);class a{}Object(D.a)(a,"SerializableCpDataV1",null,[]);var k=c(997);c.d(I,"a",function(){return x});c.d(I,"c",function(){return y});c.d(I,"b",function(){return m});c.d(I,"d",function(){return r});const x=z=>new l.a(z.RK,z.PS,z.TS,c(1639).versionedDeserialize(z.OS),z.PE,z.TE,c(1639).versionedDeserialize(z.OE),z.DK,z.SI),y=z=>{const v=
new f;v.RK=z.Rbe;v.PS=z.ASa;v.TS=z.p8a;v.DK=z.IH;v.SI=z.shapeId;z.ZR&&(v.OS=r(z.ZR));z.rHa&&(v.PE=z.rHa);z.Kmc&&(v.TE=z.Kmc);z.b5&&(v.OE=r(z.b5));return v},m=z=>{if(!z)return null;const v=new k.a(z.CP);v.gwa=null!=z.FB?z.FB:0;v.hha=null!=z.FE?z.FE:0;v.eva=null!=z.CB?z.CB:0;v.fva=null!=z.CE?z.CE:0;v.mQa=null!=z.HB?z.HB:0;v.Rha=null!=z.HE?z.HE:0;v.dza=null!=z.R?z.R:0;v.dwa=null!=z.E?z.E:0;v.Jza=null!=z.TW?z.TW:0;v.wya=null!=z.PB?z.PB:0;v.symbols=null!=z.SYM?z.SYM:0;v.hxa=null!=z.IE?z.IE:0;v.dya=null!=
z.OO?z.OO:0;v.tua=null!=z.AX?z.AX:0;v.kva=null!=z.CCI?z.CCI:0;v.dryDeletion=null!=z.DD?z.DD:0;return v},r=z=>{if(!z)return null;const v=new a;v.CP=z.cp;v.VS=1;0<z.gwa&&(v.FB=z.gwa);0<z.hha&&(v.FE=z.hha);0<z.eva&&(v.CB=z.eva);0<z.fva&&(v.CE=z.fva);0<z.mQa&&(v.HB=z.mQa);0<z.Rha&&(v.HE=z.Rha);0<z.dza&&(v.R=z.dza);0<z.dwa&&(v.E=z.dwa);0<z.Jza&&(v.TW=z.Jza);0<z.wya&&(v.PB=z.wya);0<z.symbols&&(v.SYM=z.symbols);0<z.hxa&&(v.IE=z.hxa);0<z.dya&&(v.OO=z.dya);0<z.tua&&(v.AX=z.tua);0<z.kva&&(v.CCI=z.kva);0<z.dryDeletion&&
(v.DD=z.dryDeletion);return v}},1618:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a="",k="",x=""){this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=k;this.Email=x}}Object(D.a)(l,"CommentTaskPerson",null,[920])},1619:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k,x,y=!1){this.priority=this.completion=-1;this.type=f;this.user=a;this.time=k;this.recordId=x;this.isLossy=y}}Object(D.a)(l,"HistoryRecord",null,[])},1620:function(D,
I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(503),f=c(392),a=c(480);class k{constructor(){this.zJg=null;this.yY=!1;this.PLb=this.Jfb=null;this.Zx=new l.a(new f.a);this.VU=new l.a(new f.a);this.i4f=this.MHb=!1;this.vIa=!0}get xm(){return a.a.xm}set xm(x){a.a.xm=x}get jeb(){return this.zJg}set jeb(x){this.zJg=x}}k.Jj=1;Object(D.a)(k,"CommentsState",null,[])},1621:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.yellow="FFFF00";l.vZm="00FF00";l.VEk="00FFFF";l.ZHl="FF00FF";l.blue=
"0000FF";l.red="FF0000";l.Ndn="000080";l.Gwj="008080";l.green="008000";l.purple="800080";l.Z8m="800000";l.Chn="808000";l.gray="808080";l.nxo="C0C0C0";l.black="000000";Object(D.a)(l,"FontHighlightColorEnum",null,[])},1622:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.oaa={};this.oaa.ops=[]}Jca(f){const a=this.oaa.ops;if(a.length){var k=a.length-1;const x=a[k];if(!x.attributes){x.insert+=f;a[k]=x;this.oaa.ops=a;return}}k={};k.insert=f;Array.add(a,k)}dBf(f,a){const k=
{};this.tlj(k,a);Array.add(this.oaa.ops,this.o5b(f,k))}HAf(f,a,k,x=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;a={};a.atmention=y;f=this.o5b(f,a);k&&(y={},y.contentId=k.contentId,a={},a.atmention=y,x&&(y.isCurrentUser=k.isCurrentUser),f.optional=a);Array.add(this.oaa.ops,f)}insertImage(f,a){f=this.o5b(f,{});const k={};k.base64=a.base64;a={};a.image=k;f.optional=a;Array.add(this.oaa.ops,f)}eri(f,a){const k={};k.link=a.link;this.tlj(k,a);Array.add(this.oaa.ops,this.o5b(f,
k))}Z8b(){return Sys.Serialization.JavaScriptSerializer.serialize(this.oaa)}o5b(f,a){const k={};k.insert=f;k.attributes=a;return k}tlj(f,a){this.zPb(a.weight>=l.V3d,f,"weight",a.weight);this.zPb(a.italic,f,"italic",!0);this.zPb(a.underline,f,"underline",!0);this.zPb(a.strikethrough,f,"strikethrough",!0);this.zPb(!!a.highlight,f,"highlight",a.highlight);this.zPb(!!a.color,f,"color",a.color);this.zPb(!!a.paragraph,f,"paragraph",a.paragraph)}zPb(f,a,k,x){f&&(a[k]=x)}static xFb(f){return Sys.Serialization.JavaScriptSerializer.deserialize(f,
!0)}}l.V3d=700;Object(D.a)(l,"DeltaFormatCreator",null,[875])},1623:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(593),f=c(392);class a{constructor(k=!1){this.bN=null;this.U2a=!1;k&&(this.bN=new l.a(new f.a))}}Object(D.a)(a,"OpenCommentInfo",null,[])},1624:function(D,I,c){c.d(I,"b",function(){return r});c.d(I,"a",function(){return z});c.d(I,"c",function(){return v});c.d(I,"d",function(){return G});c.d(I,"e",function(){return F});var l=c(20),f=c(2),a=c(117),k=c(7),x=c(457),y=c(441),
m=c(261);const r=()=>l.a.pu,z=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,v=H=>!!H&&H.isConnected,G=(H,L,J,M)=>{if(!L||!L.isConnected)return H.dispose(),!1;const P=L.Ui(),N=L.ja(a.a.MJ,m.a.Nt),K={};K[x.a.nodeId]=L.id.toString();K[x.a.cellId]=P.Am.toString();K[x.a.fileId]=P.vr;K[x.a.Nua]=P.contentReplicator.Lt.toString();K[x.a.VM]=P.contentReplicator.VM;K[x.a.yX]=J.toString();K[x.a.lcid]=f.AFrameworkApplication.lcid.toString();K[x.a.accessToken]=f.AFrameworkApplication.accessToken;
K[x.a.classId]=L.Nc.toString();K[x.a.MJ]=N;M=M||{};for(const O of y.a(M))K[O]=M[O];for(const O of y.a(K))H.l5b(O,K[O]);return!0},F=(H,L,J)=>{const M={};M.IsResponseNull=!L;L&&(M.OperationResult=L.StatusCode,M.RevisionListLength=L.RevisionList?L.RevisionList.length.toString():"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",M);J&&J.isConnected&&(L&&!L.StatusCode?(J.uJ().contentReplicator.fF(null,null,null),H.wYo()):H.vNb(null,L?L.StatusCode:14))}},1625:function(D,I,c){var l=
this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1840),I);f(c(1841),I)},1626:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.neighborhood=null;this.mentionLength=
this.mentionStart=0}}Object(D.a)(l,"InsightsParameters",null,[])},1630:function(D,I,c){c.d(I,"a",function(){return l});c.d(I,"b",function(){return f});D=c(0);var l;(function(a){a[a.Unknown=-1]="Unknown";a[a.A$o=0]="RichText";a[a.b$o=1]="PlainText";a[a.$9o=2]="Picture";a[a.n7o=3]="ComboBox";a[a.Y7o=4]="DropDownList";a[a.g7o=5]="BuildingBlockGallery";a[a.Date=6]="Date";a[a.t$o=7]="RepeatSectionItem";a[a.l7o=8]="CheckBox";a[a.s$o=9]="RepeatSection";a[a.kLj=10]="Bibliography";a[a.aap=11]="TableOfContents";
a[a.WOj=12]="NumberOfContentControlKinds"})(l||(l={}));Object(D.b)("ContentControlKind",l);const f=a=>{for(let k=0;k<l.WOj;++k)if(l[k]===a)return k;return l.Unknown}},1631:function(D,I,c){c.d(I,"c",function(){return y});c.d(I,"b",function(){return m});c.d(I,"a",function(){return r});var l=c(39),f=c(594),a=c(64),k=c(63),x=c(277);const y=(z,v,G)=>{var F=z.characterData.length;if(v>G||G>F)return null;a:{for(H of z.dH)if(F=H.mc,F.qe&&F===k.InteractiveViewManager.instance.zd){var H=F;break a}H=null}if(!H)return null;
H=z.vj(H.$b);if(!H)return null;F=[];z=z.qa;for(let J=z.nca(v);J<z.length;J++){var L=z.J(J);if(L.cp>G||L.cp===G&&v!==G)break;(L=x.a.Hwa(H,L.cp))&&0>Array.indexOf(F,L)&&F.push(L)}return F},m=z=>{let v=null;for(const F of z){var G=l.a.getElementBounds(F);v?(z=v,z.x>G.x&&(z.x=G.x),z.x+z.width<G.x+G.width&&(z.width=G.x+G.width-z.x),z.y>G.y&&(z.y=G.y),z.y+z.height<G.y+G.height&&(z.height=G.y+G.height-z.y)):v=G}v||(v=new Sys.UI.Bounds(0,0,0,0));return v},r=(z,v)=>{z=m(z);if(!z.width&&!z.height)return null;
const G=document.createElement("div");G.id=v;G.style.position="absolute";G.style.left=z.x+"px";G.style.top=z.y+"px";G.style.width=z.width+"px";G.style.height=z.height+"px";G.style.zIndex="-9999";a.d(G,f.a.KAb,"true");return G}},1632:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===
x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1862),I);f(c(1863),I);f(c(1864),I);f(c(1865),I);f(c(1866),I)},1633:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.source=f}}Object(D.a)(l,"AcceptAllActionData",null,[])},1635:function(D,I,c){c.d(I,"a",function(){return K});D=c(0);var l=c(711),f=c(26),a=c(9),k=c(17),x=c(23),y=c(8),m=c(12),r=c(754),z=c(548),v=c(240),G=c(69),F=c(75),H=c(110),L=c(1208),J=c(1533),
M=c(864);c.n(M);var P=c(1552),N=c(865);class K{constructor(O,V,W,T,Y,ba,Z){this.sMa=O;this.ib=V;this.Nn=W;this.zn=T;this.cab=Y;this.t3j=ba;this.TVb=Z}noa(O){return(O=this.zn.noa(O))&&Object(G.a)(l.a,O.errorDetails)&&!O.errorDetails.$3a()?O:null}WEa(O){return this.cab.WEa(O)}qmf(O){if(!O)return null;if(r.a(O.annotationType)){if((O=O.content)&&O.suggestions&&!K.u2b(O))return O}else if(O.annotationType===z.a.getTypeName()){if((O=O.content)&&O.suggestions)return O}else if(O.annotationType===M.FlagAnnotation.getTypeName()&&
(O=O.content)&&O.results)return O;return null}iNd(O,V,W){let T=null,Y=null,ba=null;var Z=this.Nn.eQc(O,0);if(!Z||!Z.count)return{returnValue:!1,annotation:T,q3i:Y,u0e:ba};for(const ea of Z){if(V&&(ea.Ac!==O.cpBegin||ea.end!==O.cpEnd))continue;Z=this.qmf(ea.intent);if(!Z||W&&!W(Z))continue;let ha;({stop:ha}=K.Bpj(Y,Z)).returnValue&&(T=ea.intent,Y=Z,ba=f.a.createTextRange(O.node,ea.Ac,ea.end));if(ha)break}return{returnValue:!!Y,annotation:T,q3i:Y,u0e:ba}}Z2h(O,V){let W=null;for(const T of O){if(T.type)continue;
O=this.qmf(T.intent);if(!O||V&&!V(O))continue;let Y;({stop:Y}=K.Bpj(W,O)).returnValue&&(W=O);if(Y)break}return W}Bhi(O,V,W,T,Y){const ba=new F.a;if(T.BWd){var Z=this.Nn.LPa(O,0,ea=>{if(V>ea.Ac||ea.Ac>W)return!1;ea=this.qmf(ea.intent);return!ea||K.u2b(ea)||T.X4c&&!T.X4c(ea)?!1:!0});for(const ea of Z)ba.add(ea)}if(T.AWd){Z=this.zn.s4(O,ea=>{if(V>ea.Ac||ea.Ac>W)return!1;ea=ea.errorDetails;return ea.$3a()||T.P3c&&!T.P3c(ea)?!1:!0});for(const ea of Z)ba.add(ea)}if(T.zWd){O=this.cab.Lof(O,ea=>V>ea.Ac||
ea.Ac>W||T.cLc&&!T.cLc(ea.LD)?!1:!0);for(const ea of O)ba.add(ea)}ba.Sc(Y);return ba}Oof(O,V){return Math.min(Math.abs(V-O.Ac),Math.abs(V-O.end))}b4l(O,V,W,T){let Y,ba=0;T?(T=0,Y=V-1):(T=V+1,Y=O.characterData.length);W=this.Bhi(O,T,Y,W,(Z,ea)=>this.Oof(Z,V)-this.Oof(ea,V));if(!W.count)return{returnValue:null,offset:ba};ba=V<W.J(0).Ac||V>W.J(0).end?this.Oof(W.J(0),V):0;return{returnValue:f.a.createTextRange(O,W.J(0).Ac,W.J(0).end),offset:ba}}urf(O,V,W,T){let Y=0;var ba=({offset:Y}=this.b4l(O,V,W,T)).returnValue;
if(ba)return{returnValue:ba,offset:Y};ba=this.sMa.RMh(O,T);if(!ba)return{returnValue:null,offset:Y};for(Y=T?V:O.characterData.length-V;ba.X8();){O=ba.Zw;V=this.Bhi(O,0,O.characterData.length,W,(Z,ea)=>Z.Ac===ea.Ac?Z.end-ea.end:Z.Ac-ea.Ac);if(V.count)return W=T?V.J(V.count-1):V.J(0),Y+=T?O.characterData.length-W.end:W.Ac,{returnValue:f.a.createTextRange(O,W.Ac,W.end),offset:Y};Y+=O.characterData.length}return{returnValue:null,offset:Y}}trf(O,V,W,T){return this.urf(O,V,W,T).returnValue}YKc(O,V,W){let T=
0,Y=1;this.trf(O,V,W,!1)&&Y++;this.trf(O,V,W,!0)&&(T++,Y++);return{index:T,count:Y}}zPl(O,V,W){let T;const Y=({offset:T}=this.urf(O,V<O.characterData.length?V+1:V,W,!0)).returnValue;if(Y&&!T)return Y;V=({offset:O}=this.urf(O,1<V?V-1:0,W,!1)).returnValue;return Y&&V?T<O?Y:V:Y?Y:V}fgj(O,V){let W=null;a.App.za&&Object(H.a)(L.MainView,a.App.za.jb.qc)&&(W=a.App.za.jb.qc);if(!W)return!1;this.ib.Bc(k.SelectionEditor.Fj(x.SelectionFactory.Tn(O),!0,!1));O=W.Vs.Oam();const T=(O-250)/2;W.Vs.z5(100<T?100-100*
T/O:-1,void 0,void 0,Y=>{window.setTimeout(()=>{V(Y)},0)});return!0}sLb(O,V,W=4,T=!0){const Y=()=>{V.Ri.aE||V.BN(new J.a(O,W,!1,T,void 0,!0))};V.Ri.dismiss();this.t3j.select(O.node,O.cpBegin,O.cpBegin);if(!this.TVb.LKd(O.node))return this.fgj(O,()=>{Y()});Y();return!0}static u2b(O){if(!O)return!0;if(!O.M_||!O.M_.state)return!1;O=O.M_.state;return 60===O||70===O}static Bpj(O,V){const W=Object(N.b)()&&P.a.XXd(V)||v.a.getTypeNameFor(V)===z.a.getTypeName();return{returnValue:!O||W||r.a(v.a.getTypeNameFor(V))&&
O.priority>V.priority,stop:W}}ARf(O,V,W,T,Y=4,ba=!0){O=this.fRl(O);if(!O)return!1;V=this.GQh(O,V,W,T);return this.sLb(O,V,Y,ba)}fRl(O){var V=this.ib.hb.lb;for(const W of V)if(y.ParagraphReader.Wb(W.node)&&(V=W.contextId,V===m.a.Tc||V===m.a.Jd||V===m.a.paragraph))return this.zPl(W.node,V!==m.a.paragraph?W.cpBegin:0,O);return null}GQh(O,V,W,T){return this.ZEm(O)?V:this.aJm(O)?T:W}ZEm(O){return this.iNd(O,!0,null).returnValue}aJm(O){return!!this.WEa(O)}}Object(D.a)(K,"SuggestionNavigator",null,[])},
1636:function(D,I,c){c.d(I,"c",function(){return f});c.d(I,"a",function(){return a});c.d(I,"b",function(){return k});var l=c(25);const f=(x,y,m)=>{if(!l.c(x)&&"#text"!==x.nodeName&&(y?x.setAttribute("unselectable","on"):x.setAttribute("unselectable","off"),m))for(x=x.firstChild;x;)f(x,y,!0),x=x.nextSibling},a=x=>{x=document.createElement(x);x.setAttribute("unselectable","on");return x},k=(x,y)=>{if(!l.c(x)){var m=x.className;if(l.c(m)||-1===m.indexOf(y))y=m.trim()+" "+y,y=y.trim(),x.className=y}}},
1637:function(D,I,c){c.d(I,"a",function(){return r});D=c(0);var l=c(7),f=c(54),a=c(2),k=c(188),x=c(22),y=c(290),m=c(31);class r{constructor(){this.Mfa=null}sme(){try{this.Mfa||(this.Mfa=x.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(z){l.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+z)}}uuf(z,v){return this.Mfa?this.Mfa.getToken(z,v):new Promise(G=>{x.a.instance.Ta("Common.App.SearchCommon.ISearchOAuthManager").execute(F=>{F?(this.Mfa=F,this.Mfa.getToken(z,
v).then(H=>G(H))):G(null)})})}Q1l(){this.sme();return this.Mfa?this.Mfa.getToken("Search",a.AFrameworkApplication.CMf):null}ygi(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.sme();return this.Mfa?this.Mfa.getToken("Search",a.AFrameworkApplication.Eig):null}lfm(){this.sme();return this.Mfa?
this.Mfa.getToken("Search",this.ifm()):null}ifm(){return a.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")}jcm(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.sme();return this.Mfa?this.Mfa.getToken("SmartLookup",this.gcm()):null}gcm(){return a.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")}R1l(){return Object(f.a)(this,
this.Q1l,"getLokiTokenPromise")}Fdm(){return Object(f.a)(this,this.ygi,"getSubstrateTokenPromise")}pQb(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Lb.pQb}Xfm(){const z={};this.pQb()&&(z.Loki=this.R1l(),z.Substrate=this.Fdm());return z}QZc(z){k.a.gIa(Object.assign(new y.a,{name:"Events",dataFields:[Object.assign(new m.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new m.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}C0m(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.QZc(!1);return!1}).then(()=>{this.QZc(!0);return!0}):new Promise((z,v)=>{const G=x.a.instance.resolve("Common.IDynamicScriptLoaderProvider").aA;G?G.loadScript("tellme-strings").then(()=>{this.QZc(!0);z(!0)}).catch(()=>{this.QZc(!1);v(!1)}):(this.QZc(!1),v(!1))})}static GRm(){return!!a.AFrameworkApplication.ua&&(a.AFrameworkApplication.ua.Lb.IXc||a.AFrameworkApplication.ua.Lb.ldc)}static P_d(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Lb.ldc}}
Object(D.a)(r,"ReactSharedHeaderSearchUtils",null,[])},1639:function(D,I,c){c.r(I);c.d(I,"validateCpDataV1",function(){return f});c.d(I,"isEqual",function(){return a});c.d(I,"isSupportedCpVersion",function(){return k});c.d(I,"validateVersionedCpData",function(){return y});c.d(I,"versionedDeserialize",function(){return m});var l=c(1609);const f=r=>"number"!==typeof r.CP||null!=r.FB&&"number"!==typeof r.FB||null!=r.FE&&"number"!==typeof r.FE||null!=r.HB&&"number"!==typeof r.HB||null!=r.HE&&"number"!==
typeof r.HE||null!=r.CB&&"number"!==typeof r.CB||null!=r.CE&&"number"!==typeof r.CE||null!=r.R&&"number"!==typeof r.R||null!=r.E&&"number"!==typeof r.E||null!=r.TW&&"number"!==typeof r.TW||null!=r.PB&&"number"!==typeof r.PB||null!=r.SYM&&"number"!==typeof r.SYM||null!=r.IE&&"number"!==typeof r.IE||null!=r.OO&&"number"!==typeof r.OO||null!=r.AX&&"number"!==typeof r.AX||null!=r.CCI&&"number"!==typeof r.CCI||null!=r.DD&&"number"!==typeof r.DD?!1:!0,a=(r,z)=>r||z?r&&z&&r.CP===z.CP&&r.FB===z.FB&&r.FE===
z.FE&&r.HB===z.HB&&r.HE===z.HE&&r.CB===z.CB&&r.CE===z.CE&&r.R===z.R&&r.E===z.E&&r.TW===z.TW&&r.PB===z.PB&&r.SYM===z.SYM&&r.IE===z.IE&&r.OO===z.OO&&r.AX===z.AX&&r.CCI===z.CCI&&r.DD===z.DD?!0:!1:!0,k=r=>1===r,x=r=>{let z=r,v=0;"number"===typeof z.VS&&(v=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,bqg:v};z=null;for(let G=0;G<r.length;G++){const F=r[G];1===F.VS&&F.VS>v&&(v=F.VS,z=r[G])}return{returnValue:z,bqg:v}},y=r=>{const z=({bqg:r}=x(r)).returnValue;if(!z)return!1;
switch(r){case 0:case 1:return f(z);default:return!1}},m=r=>{if(!r)return null;const z=({bqg:r}=x(r)).returnValue;if(!z)return null;switch(r){case 0:case 1:return l.b(z);default:return null}}},1652:function(D,I,c){D=c(0);var l=c(753),f=c(19),a=c(170),k=c(79),x=c(2),y=c(22),m=c(7),r=c(1456),z=c(12),v=c(103),G=c(26),F=c(3),H=c(1068),L=c(132),J=c(17),M=c(23),P=c(100),N=c(8);class K{static get fvh(){K.Dqc||(K.Dqc=[],K.Tec(l.a.qg("ar-sa")),K.Tec(l.a.qg("de-de")),K.Tec(l.a.qg("es-es")),K.S0(l.a.qg("en-029"),
l.a.qg("en-us")),K.S0(l.a.qg("en-au"),l.a.qg("en-us")),K.S0(l.a.qg("en-bz"),l.a.qg("en-us")),K.S0(l.a.qg("en-ca"),l.a.qg("en-us")),K.S0(l.a.qg("en-gb"),l.a.qg("en-us")),K.S0(l.a.qg("en-id"),l.a.qg("en-us")),K.S0(l.a.qg("en-my"),l.a.qg("en-us")),K.S0(l.a.qg("en-ph"),l.a.qg("en-us")),K.S0(l.a.qg("zh-tw"),l.a.qg("en-us")),K.Tec(l.a.qg("fr-fr")),K.S0(l.a.qg("hr-ba"),l.a.qg("hr-hr")),K.S0(l.a.qg("it-ch"),l.a.qg("it-it")),K.S0(l.a.qg("nb-no"),l.a.qg("nn-no")),K.Tec(l.a.qg("nl-nl")),K.S0(l.a.qg("ro-md"),
l.a.qg("ro-ro")),K.S0(l.a.qg("ru-md"),l.a.qg("ru-ru")),K.S0(l.a.qg("sr-latn-ba"),l.a.qg("sr-latn-cs")),K.S0(l.a.qg("sr-latn-me"),l.a.qg("sr-latn-cs")),K.S0(l.a.qg("sr-latn-rs"),l.a.qg("sr-latn-cs")),K.Tec(l.a.qg("sr-cyrl-cs")),K.S0(l.a.qg("sv-fi"),l.a.qg("sv-se")));return K.Dqc}static Tec(Sa){K.Dqc[Sa.languageId]=Sa.LCID}static S0(Sa,Eb){K.Dqc[Sa.LCID]=Eb.LCID}static g8h(Sa){var Eb=l.a.qg(Sa);if(!Eb)return 0;Eb=K.fvh[Eb.LCID]||K.fvh[Eb.languageId]||0;return Eb===Sa?0:Eb}}K.Dqc=null;Object(D.a)(K,
"AutoCorrectListFallback",null,[]);var O=c(354),V=c(86),W=c(155),T=c(117),Y=c(6),ba=c(16),Z=c(5),ea=c(84),ha=c(375),la=c(36),ia=c(58),sa=c(96),Oa=c(43),Ra=c(1538);class Na extends Ra.a{constructor(Sa,Eb,Jb,vb,ac,dc){super(Sa,Eb,Jb,vb,dc);this.FY=ac}get bD(){return!0}get commandId(){return F.a.VGk}set bD(Sa){super.bD=Sa}}Object(D.a)(Na,"ARegexCorrectAction",Ra.a,[]);class Da extends Na{static get Ulb(){if(null!=Da.vCg)var Sa=Da.vCg;else(Sa=y.a.instance.Oa("Box4.List.IListCommands"))||m.ULS.sendTraceTag(512357316,
393,50,"IListCommands was tried to be resolved before it was registered."),Sa=Da.vCg=Sa;return Sa}static get Jn(){return null!=Da.zCg?Da.zCg:Da.zCg=y.a.instance.resolve("Box4.List.IListEditor")}static get Fd(){return null!=Da.QCg?Da.QCg:Da.QCg=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [Sa,Eb]=this.FY;return Eb?Sa.replace(Eb,"%1"):Sa}}Object(D.a)(Da,"AListAutoCorrectAction",Na,[]);var ra=c(139);class xa extends Da{get commandId(){return F.a.NGk}Jna(Sa){if(xa.Ulb){var Eb=Z.GraphIterator.eb(Sa);
Eb.rd();la.OutlineElementNavigator.Wd(Eb);if(xa.Jn.mhe(Eb,this.FY[0])){var Jb=xa.Fd.tw(Eb),vb=this.FY[0],ac=f.a.charAt(vb,0),dc=this.h2l(ac),Cc=ha.a.V_(1,dc.listStyle);Jb&&Cc.Fxf(Jb)||(Jb=new Oa.GraphTransaction(15),Jb.Qt(Eb),this.Ld.Ge(G.a.createTextRange(Sa,this.NG,this.T0+1),"",!0,!1),xa.Jn.Uho(Cc),Sa=new O.DictionaryPropertySet,Sa.setValue(W.a.flf,!0),ac&&(Cc.LQ=ac,Sa.setValue(T.a.LQ,Cc.LQ)),Sa.setValue(Y.a.nv,dc.levelText),Sa.setValue(ba.a.font,dc.fontName),"-"===ac&&V.Health.instance.recordKpiUsage("DashBulletAutoCreate",
0,xa.xB,null),ra.a.wY&&(Sa.setValue(T.a.Qpa,"autocorrect"),Sa.setValue(T.a.uia,vb)),xa.Ulb.PNk(Cc.listType,Cc.listStyle,Sa),Jb.dispose())}}}h2l(Sa){const Eb={listStyle:0,levelText:ea.a.sJd,fontName:ea.a.DKc};switch(Sa){case "*":return{...Eb,listStyle:1};case "-":return{...Eb,levelText:"-",fontName:sa.a.GH};default:return Eb}}static pG(Sa,Eb,Jb,vb,ac){return new xa(null,Sa,Eb,Jb,vb,ac)}static WT(Sa,Eb,Jb,vb,ac){return new xa(Sa,ia.a(Sa).Bb,Eb,Jb,vb,ac)}}xa.xB="wwaengidc";xa.r5f=["[\\*](?![\\*])","[\\-](?![\\-])"];
Object(D.a)(xa,"BulletListAction",Da,[]);var fa=c(82);class oa extends Na{constructor(Sa,Eb,Jb,vb,ac,dc){super(Sa,Eb,Jb,vb,ac,dc);this.Mwc=!1;this.bD=!Sa;oa.lp=new fa.a}get bD(){return this.Mwc}set bD(Sa){this.Mwc=Sa}xDb(Sa){this.E6e(Sa.innerText,(Eb,Jb,vb)=>{Sa.innerText=f.a.substring(Sa.innerText,0,Eb)+vb+f.a.right(Sa.innerText,Jb)})}Jna(Sa){this.E6e(N.ParagraphReader.text(Sa).substring(this.NG,this.T0),(Eb,Jb,vb)=>{this.Ld.Ge(G.a.createTextRange(Sa,this.NG+Eb,this.NG+Jb),vb,!0,!1)})}E6e(Sa,Eb){if(!(2>
this.FY.length)&&this.FY[1]){var Jb=this.FY[1];oa.lp.count||this.Z0i();oa.lp.nb(Jb)&&(Sa=Sa.lastIndexOf(Jb),-1!==Sa&&Eb(Sa,Sa+Jb.length,oa.lp.J(Jb)))}}}Object(D.a)(oa,"ADictionarySequenceReplacerAction",Na,[]);class ta extends oa{get commandId(){return F.a.s2e}Z0i(){oa.lp.Z("--","\u2014");oa.lp.Z(" -- "," \u2013 ");oa.lp.Z(" - "," \u2013 ");oa.lp.Z("-- ","\u2014");oa.lp.Z(" --"," \u2013");oa.lp.Z(" -"," \u2013")}static pG(Sa,Eb,Jb,vb,ac){return new ta(null,Sa,Eb,Jb,vb,ac)}static WT(Sa,Eb,Jb,vb,ac){return new ta(Sa,
ia.a(Sa).Bb,Eb,Jb,vb,ac)}}Object(D.a)(ta,"DashAction",oa,[]);class Ka extends oa{constructor(Sa,Eb,Jb,vb,ac,dc,Cc){super(Sa,Eb,Jb,vb,ac,dc);this.ga=Cc}get commandId(){return F.a.OGk}Z0i(){oa.lp.Z(":)","\ud83d\ude0a");oa.lp.Z(":-)","\ud83d\ude0a");oa.lp.Z(":|","\ud83d\ude10");oa.lp.Z(":-|","\ud83d\ude10");oa.lp.Z(":(","\ud83d\ude41");oa.lp.Z(":-(","\ud83d\ude41");oa.lp.Z(";)","\ud83d\ude09");oa.lp.Z(";-)","\ud83d\ude09");oa.lp.Z(":D","\ud83d\ude00");oa.lp.Z(":-D","\ud83d\ude00");oa.lp.Z(":')","\ud83d\ude02");
oa.lp.Z("=D","\ud83d\ude03");oa.lp.Z(":>","\ud83d\ude06");oa.lp.Z(":->","\ud83d\ude06");oa.lp.Z(":3","\ud83d\ude0a");oa.lp.Z(":-3","\ud83d\ude0a");oa.lp.Z("B-)","\ud83d\ude0e");oa.lp.Z("*-*","\ud83d\ude0d");oa.lp.Z(":*","\ud83d\ude19");oa.lp.Z(":-*","\ud83d\ude19");oa.lp.Z(":X","\ud83d\ude36");oa.lp.Z(":-X","\ud83d\ude36");oa.lp.Z(":O","\ud83d\ude2e");oa.lp.Z(":-O","\ud83d\ude2e");oa.lp.Z(":#","\ud83e\udd10");oa.lp.Z(":-#","\ud83e\udd10");oa.lp.Z(":P","\ud83d\ude1b");oa.lp.Z(":-P","\ud83d\ude1b");
oa.lp.Z(";P","\ud83d\ude1c");oa.lp.Z(";-P","\ud83d\ude1c");oa.lp.Z(":-/","\ud83d\ude15");oa.lp.Z("$-$","\ud83e\udd11");oa.lp.Z(":S","\ud83d\ude16");oa.lp.Z(":-S","\ud83d\ude16");oa.lp.Z(":[","\ud83d\ude1f");oa.lp.Z(":-[","\ud83d\ude1f");oa.lp.Z(":\u2019(","\ud83d\ude22");oa.lp.Z(":'(","\ud83d\ude22");oa.lp.Z("@-@","\ud83d\ude31")}Jna(Sa){this.E6e(N.ParagraphReader.text(Sa).substring(this.NG,this.T0),(Eb,Jb,vb)=>{Eb=G.a.createTextRange(Sa,this.NG+Eb,this.NG+Jb);Jb={};Jb.MenuItemId=vb;this.ga.Kf(Eb,
F.a.$jb,2,!1,null,Jb,null)})}static pG(Sa,Eb,Jb,vb,ac,dc){return new Ka(null,Sa,Eb,Jb,vb,ac,dc)}static WT(Sa,Eb,Jb,vb,ac,dc){return new Ka(Sa,ia.a(Sa).Bb,Eb,Jb,vb,ac,dc)}}Object(D.a)(Ka,"EmojiAction",oa,[]);class va{constructor(Sa,Eb,Jb,vb){this.HS=Sa;this.Dyd=Eb;this.txc=vb;this.WF=Jb}uzi(){if(!this.WF)return!1;this.HS=this.HS.trimStart();return this.HS===this.WF?!0:!1}AVm(){if(!this.HS)return!1;const Sa=this.HS.lastIndexOf(" ");return-1!==Sa&&"."===this.HS.charAt(Sa-1)&&"."===this.HS.charAt(Sa-
3)?!0:!1}zVm(){if(!this.HS)return!1;var Sa=this.HS.lastIndexOf(" ");return-1!==Sa&&(Sa=this.HS.substring(0,Sa-1).lastIndexOf(" "),"."===this.HS.charAt(Sa+2))?!0:!1}ROm(){return this.uzi()&&(1===this.WF.length&&"."===this.Dyd||"."===this.HS.charAt(1))?!0:!1}SOm(){return this.WF?0<="\\/".indexOf(this.Dyd)||3===this.WF.length&&0<="\\/".indexOf(this.WF.charAt(1))?!0:!1:!1}ONm(){return this.WF?0<=this.WF.indexOf("@")?!0:!1:!1}OB(){if(!this.WF)return!1;for(const Sa of va.kvf())if(f.a.startsWith(this.WF+
this.Dyd,Sa))return!0;return!1}sNm(){return this.WF?"i"===this.WF&&0<=va.quotes.indexOf(this.Dyd)?!0:!1:!1}xHm(){if(!this.HS)return!1;const Sa=f.a.J4a(this.HS,this.HS.length-1);if(-1!==Sa&&this.HS.substring(Sa+1,this.HS.length)===this.WF){const Eb=this.HS.charAt(Sa-1);if(0<=va.bbg.indexOf(Eb)||0<=va.quotes.indexOf(Eb)&&0<=va.bbg.indexOf(this.HS.charAt(Sa-2)))return!0}return!1}JTk(){return!this.HS||this.AVm()||this.ROm()||this.SOm()||this.zVm()||this.ONm()||this.OB()?!1:this.uzi()||this.sNm()||this.xHm()?
!0:!1}static kvf(){return va.T3g||(va.T3g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}va.bbg=".!?";va.quotes="'\"";va.T3g=null;Object(D.a)(va,"FirstLetterUpperCaseRules",null,[]);class La{constructor(Sa){this.WF=Sa}xHl(){if(!this.WF)return null;for(let Sa=0;Sa<La.jji().length;Sa++)if(this.WF===La.jji()[Sa])return La.Cjm()[Sa];return null}static jji(){return La.cVg||(La.cVg=["1/2","1/4","3/4"])}static Cjm(){return La.bVg||(La.bVg=["\u00bd","\u00bc","\u00be"])}}La.cVg=null;La.bVg=null;Object(D.a)(La,
"FractionsCollection",null,[]);class za extends Ra.a{constructor(Sa,Eb,Jb,vb,ac,dc){super(Sa,Eb,Jb,vb,dc);this.cJh=ac}get bD(){return!0}get commandId(){return F.a.PGk}xDb(Sa){Sa.innerText=f.a.substring(Sa.innerText,0,this.NG)+this.cJh+f.a.right(Sa.innerText,this.T0)}Jna(Sa){this.Ld.Ge(G.a.createTextRange(Sa,this.NG,this.T0),this.cJh,!0,!1)}set bD(Sa){super.bD=Sa}static pG(Sa,Eb,Jb,vb,ac){return new za(null,Sa,Eb,Jb,vb,ac)}}Object(D.a)(za,"FractionsReplaceCorrectAction",Ra.a,[]);class Ca extends Da{get commandId(){return F.a.RGk}Jna(Sa){if(Ca.Ulb){var Eb=
Z.GraphIterator.eb(Sa);Eb.rd();la.OutlineElementNavigator.Wd(Eb);if(Ca.Jn.mhe(Eb,this.FY[0])){var [Jb,vb]=this.FY,ac=Ca.Ign(vb),dc=f.a.Bdc(vb)?4:2,Cc=G.a.createTextRange(Sa,this.NG,this.T0+1);Ca.Jn.X2b(Sa,Eb,dc,ac,Cc,Jb,this.levelText,Ca.Ulb)}}}static pG(Sa,Eb,Jb,vb,ac){return new Ca(null,Sa,Eb,Jb,vb,ac)}static WT(Sa,Eb,Jb,vb,ac){return new Ca(Sa,ia.a(Sa).Bb,Eb,Jb,vb,ac)}static Ign(Sa){if(!Sa)return 0;Sa=f.a.Zg(Sa);if(!f.a.aYd(Sa.charAt(0)))return 0;const Eb=Sa.charCodeAt(0)-97+1;let Jb;for(Jb=1;Jb<
Sa.length&&Sa.charAt(Jb)===Sa.charAt(0);Jb++);return 26*(Jb-1)+Eb}}Object(D.a)(Ca,"LetterListAction",Da,[]);var ua=c(121);class ib extends Da{get commandId(){return F.a.X2b}Jna(Sa){if(ib.Ulb){var Eb=Z.GraphIterator.eb(Sa);Eb.rd();la.OutlineElementNavigator.Wd(Eb);if(ib.Jn.mhe(Eb,this.FY[0])){var [Jb,vb]=this.FY,ac=parseInt(vb);if(!(99999999<=ac)){var dc=G.a.createTextRange(Sa,this.NG,this.T0+1);ua.a.R0d()&&ua.a.ylm();ib.Jn.X2b(Sa,Eb,1,ac,dc,Jb,this.levelText,ib.Ulb)}}}}static pG(Sa,Eb,Jb,vb,ac){return new ib(null,
Sa,Eb,Jb,vb,ac)}static WT(Sa,Eb,Jb,vb,ac){return new ib(Sa,ia.a(Sa).Bb,Eb,Jb,vb,ac)}}Object(D.a)(ib,"NumberListAction",Da,[]);class bb extends Ra.a{get bD(){return!0}get commandId(){return F.a.TGk}xDb(){}Jna(Sa){const Eb=G.a.createTextRange(Sa,this.T0-2,this.T0),Jb=new Oa.GraphTransaction(15);Jb.Db(Sa);let vb=!1,ac=null,dc=0;for(;dc<Sa.qa.length;){var Cc=Sa.qa.J(dc),Ec=Cc.u9;const rc=Cc.DU;if(Cc.cp>=Eb.cpBegin){Cc.cp>Eb.cpBegin||!Cc.formatting?ac=vb?Cc.formatting:this.Ld.hZ(Sa,dc,Eb.cpBegin,ac):(ac=
Cc.formatting,rc&&(vb=!1),Ec&&(vb=!0));dc++;break}Cc.formatting&&(ac=Cc.formatting);rc&&(vb=!1);Ec&&(vb=!0);dc++}for(;dc<Sa.qa.length;){Ec=Sa.qa.J(dc);if(Ec.cp>=Eb.cpEnd){if(Ec.cp>Eb.cpEnd||!Ec.formatting&&!Ec.Oh)vb||this.Ld.hZ(Sa,dc,Eb.cpEnd,ac);vb||bb.Xn.jra(ac,!0);break}Ec.formatting&&(vb||bb.Xn.jra(ac,!0),ac=Ec.formatting);Cc=Ec.u9;Ec=Ec.DU;Cc&&(vb=!0);!Cc&&Ec&&(vb=!1);dc++}Jb.dispose()}set bD(Sa){super.bD=Sa}static get Xn(){return null!=bb.Pyg?bb.Pyg:bb.Pyg=y.a.instance.resolve("Box4.IFormattingEditor")}static pG(Sa,
Eb,Jb,vb){return new bb(null,Sa,Eb,Jb,vb)}}Object(D.a)(bb,"OrdinalsReplaceCorrectAction",Ra.a,[]);var mb=c(93),yb=c(216),ab;(function(Sa){Sa[Sa.u5i=0]="rand";Sa[Sa.v5i=1]="randOld";Sa[Sa.hKi=2]="lorem"})(ab||(ab={}));Object(D.b)("RandTextType",ab);class Ga extends Na{constructor(Sa,Eb,Jb,vb,ac,dc){super(Sa,Eb,Jb,vb,ac,dc);Ga.yOe||Ga.OAo()}static COm(){var Sa;return null===(Sa=x.AFrameworkApplication.K)||void 0===Sa?void 0:Sa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",
!0)}get commandId(){return F.a.UGk}Jna(Sa){if(!(Sa.Gs||ra.a.getInstance().Nv&&(ra.a.getInstance().ZFf?mb.ListItemReader.isListItem(Sa):yb.a.mpa(Sa)))){var Eb=this.Uab.Pa.node===Sa,Jb=5,vb=3;if(this.FY[0].startsWith("=rand.old")){var ac=ab.v5i;Jb=3}else if(this.FY[0].startsWith("=rand"))ac=ab.u5i;else if(this.FY[0].startsWith("=lorem"))ac=ab.hKi;else return;this.FY[1]&&(Jb=parseInt(this.FY[1]));this.FY[2]&&(vb=parseInt(this.FY[2]));if(!(20<vb||100<Jb)){Sa.uJ().mF.V7(7);var dc=Z.GraphIterator.eb(Sa);
dc.rd();la.OutlineElementNavigator.Wd(dc);Ga.Yf.Iz(dc,!1,!1);Ga.Yf.fJ(dc);var Cc=!1;switch(ac){case ab.u5i:ac=Ga.yOe;break;case ab.v5i:ac=Ga.Qah;break;case ab.hKi:ac=Ga.P4g;Cc=!0;break;default:return}var Ec=0;for(let hb=0;hb<Jb;++hb){const fb=[];for(var rc=0;rc<vb;rc++)fb.push(ac[Ec++%ac.length]);rc=G.a.Oc(dc.currentNode,0);if(Cc){const Nb=v.FormattingReader.Vr(rc);Ga.Xn.Yl(Nb,Y.a.noProof,!0)}this.Ld.Ge(rc,fb.join(Ga.COm()?"":" "),!0,!1);hb<Jb-1&&(la.OutlineElementNavigator.Wd(dc),Ga.Yf.Iz(dc,!1,
!1),Ga.Yf.fJ(dc))}Jb=dc.currentNode;dc=Z.GraphIterator.eb(Sa);dc.rd();la.OutlineElementNavigator.Wd(dc);dc.vg();Eb&&(this.Uab=M.SelectionFactory.ne(Jb,N.ParagraphReader.textLength(Jb)))}}}static get Yf(){return null!=Ga.vDg?Ga.vDg:Ga.vDg=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get Xn(){return null!=Ga.Tyg?Ga.Tyg:Ga.Tyg=y.a.instance.resolve("Box4.IFormattingEditor")}static OAo(){Ga.yOe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Ga.Qah=["The quick brown fox jumps over the lazy dog. "];Ga.P4g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static pG(Sa,
Eb,Jb,vb,ac){return new Ga(null,Sa,Eb,Jb,vb,ac)}static WT(Sa,Eb,Jb,vb,ac){return new Ga(Sa,ia.a(Sa).Bb,Eb,Jb,vb,ac)}}Ga.yOe=null;Ga.Qah=null;Ga.P4g=null;Object(D.a)(Ga,"RandAction",Na,[]);class Za{constructor(Sa,Eb,Jb,vb){this.pattern=vb&8?new RegExp(Sa,"i"):new RegExp(Sa);this.Jtm=Eb;this.pkm=Jb;this.flags=vb}}Object(D.a)(Za,"RegexAutoCorrectEntry",null,[]);class Ub extends Da{get commandId(){return F.a.WGk}Jna(Sa){if(Ub.Ulb){var Eb=Z.GraphIterator.eb(Sa);Eb.rd();la.OutlineElementNavigator.Wd(Eb);
if(Ub.Jn.mhe(Eb,this.FY[0])){var [Jb,vb]=this.FY,ac=Ub.Jgn(vb);if(!(0>=ac)){var dc=f.a.Bdc(vb.charAt(0))?5:3,Cc=G.a.createTextRange(Sa,this.NG,this.T0+1);Ub.Jn.X2b(Sa,Eb,dc,ac,Cc,Jb,this.levelText,Ub.Ulb)}}}}static pG(Sa,Eb,Jb,vb,ac){return new Ub(null,Sa,Eb,Jb,vb,ac)}static WT(Sa,Eb,Jb,vb,ac){return new Ub(Sa,ia.a(Sa).Bb,Eb,Jb,vb,ac)}static pvl(){Ub.NMa||(Ub.NMa={},Ub.NMa.M=1E3,Ub.NMa.D=500,Ub.NMa.C=100,Ub.NMa.L=50,Ub.NMa.X=10,Ub.NMa.V=5,Ub.NMa.I=1)}static Jgn(Sa){if(!Sa)return 0;Ub.pvl();Sa=f.a.ZA(Sa);
let Eb=0,Jb=0;for(let vb=Sa.length-1;0<=vb;vb--){const ac=Ub.NMa[f.a.charAt(Sa,vb).toString()];Jb=ac<Eb?Jb-ac:Jb+ac;Eb=ac}return Jb}}Ub.NMa=null;Ub.r5f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Sa=>`\\(?(${Sa})[\\.\\)\\-]`);Object(D.a)(Ub,"RomanListAction",Da,[]);var Xb=c(40);class zb extends Ra.a{constructor(Sa,Eb,Jb,vb,ac,dc){super(Sa,Eb,Jb,Jb+1,dc);this.vlk=
vb;this.YOg=ac;this.k0c=!1}get bD(){return!1}get commandId(){return F.a.XGk}xDb(Sa){Sa.innerText=f.a.substring(Sa.innerText,0,this.NG)+this.YOg+f.a.right(Sa.innerText,this.T0)}Jna(Sa){this.Ld.Ge(G.a.createTextRange(Sa,this.NG,this.T0),this.vlk,!0,!1);this.Ld.Ge(G.a.createTextRange(Sa,this.NG,this.NG+1),this.YOg,!0,!1)}set bD(Sa){super.bD=Sa}static pG(Sa,Eb,Jb,vb,ac,dc){if("'"!==Jb&&'"'!==Jb)return null;var Cc=Z.GraphIterator.eb(Sa);Cc.rd();la.OutlineElementNavigator.Wd(Cc);if(Xb.OutlineElementReader.In(Cc.currentNode))return null;
vb=!Eb||f.a.ada(vb)||-1!==Array.indexOf(zb.Ztn,vb);Cc="'"===Jb;return new zb(dc,Sa,Eb,Jb+"",vb?Cc?"\u2018":"\u201c":Cc?"\u2019":"\u201d",ac)}}zb.Ztn=["[","{","("];Object(D.a)(zb,"SmartQuoteCorrectAction",Ra.a,[]);class Ib extends Ra.a{constructor(Sa,Eb,Jb,vb,ac,dc){super(Sa,Eb,Jb,vb,dc);this.XOg=ac}get bD(){return Ib.Mwc}set bD(Sa){Ib.Mwc=Sa}get commandId(){return F.a.YGk}LHj(){this.Epd=this.lCh();this.Epd||(this.v3g=!1,this.mZg="MatchTextIsNotTheSame")}xDb(Sa){Sa.innerText=f.a.substring(Sa.innerText,
0,this.NG)+this.XOg+f.a.right(Sa.innerText,this.T0)}Jna(Sa){this.Ld.Ge(G.a.createTextRange(Sa,this.NG,this.T0),this.XOg,!0,!1)}static WT(Sa,Eb,Jb,vb,ac){const dc=ia.a(Sa);return new Ib(Sa,dc?dc.Bb:null,Eb,Jb,vb,ac)}static pG(Sa,Eb,Jb,vb,ac){return new Ib(null,Sa,Eb,Jb,vb,ac)}}Ib.Mwc=!1;Object(D.a)(Ib,"StringReplaceCorrectAction",Ra.a,[]);class $a extends Ra.a{constructor(Sa,Eb,Jb,vb,ac,dc,Cc,Ec){super(Sa,Eb,Jb,vb,ac);this.Ik=dc;this.V6j=Cc;this.ED=Ec}get bD(){return!0}get commandId(){return F.a.ZGk}xDb(Sa){let Eb=
f.a.substring(Sa.innerText,this.NG,this.T0);Eb.charAt(0)!==Eb.charAt(0).toUpperCase()&&(Eb=Eb.charAt(0).toUpperCase()+Eb.substring(1,Eb.length));Sa.innerText=f.a.substring(Sa.innerText,0,this.NG)+Eb+f.a.right(Sa.innerText,this.T0)}Jna(Sa){const Eb=this.NG,Jb=this.NG+1,vb=Sa.characterData.substring(Eb,Jb).charAt(0);if(!f.a.Bdc(vb)){const ac=G.a.createTextRange(Sa,Eb,Jb);this.THm(ac)||this.ED&&this.ED.LXc(Sa,Eb,Jb)||this.Ld.Ge(ac,vb.toUpperCase().toString(),!0,!1)}}THm(Sa){return this.V6j?!!this.Ik&&
this.Ik.n9(Sa):!1}set bD(Sa){super.bD=Sa}static WT(Sa,Eb,Jb,vb){const ac=ia.a(Sa);return new $a(Sa,ac?ac.Bb:null,Eb,Jb,vb,null,!1,null)}static pG(Sa,Eb,Jb,vb,ac,dc){return new $a(null,Sa,Eb,Jb,vb,ac,!0,dc)}}Object(D.a)($a,"UpperFirstLetterAutoCorrectAction",Ra.a,[]);class Hb{constructor(Sa,Eb){this.txc=Eb;this.WF=Sa}w_o(){const Sa=Number.parseInvariant(this.WF.substring(0,this.WF.length-2));switch(Number.parseInvariant(this.WF.charAt(this.WF.length-3).toString())){case 1:return 11===Sa?"th":"st";
case 2:return 12===Sa?"th":"nd";case 3:return 13===Sa?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}dPm(){var Sa=l.a.qg(this.txc);if(!Sa||!Sa.name.toLowerCase().startsWith("en")||!this.WF||2>=this.WF.length)return!1;for(Sa=0;Sa<Hb.rUd().length;Sa++)if(this.WF.toLowerCase().endsWith(Hb.rUd()[Sa])){if(RegExp("^\\d+$").test(this.WF.substr(0,this.WF.length-2))){const Eb=this.w_o();if(this.WF.toLowerCase().endsWith(Hb.rUd()[Sa])&&Eb===Hb.rUd()[Sa])return!0}break}return!1}static rUd(){return Hb.$8g||
(Hb.$8g=["st","nd","rd","th"])}}Hb.$8g=null;Object(D.a)(Hb,"ValidateOrdinalsRule",null,[]);c.d(I,"a",function(){return Ya});class Ya{constructor(Sa,Eb,Jb,vb,ac,dc,Cc){this.fBc=[];this.jUb=[];this.Cqc=[];this.gte=new Set;this.obb=-1;this.YXg=this.Ifa=!1;this.p4j=Sa;this.Ld=Eb;this.Ik=Jb;this.ga=vb;this.SV=dc;this.ED=Cc;ac?(this.Ifa=ac.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.YXg=ac.$("HyperlinkUrlValidationIsEnabled"),m.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Ifa})):
(m.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Ifa=!1)}xkb(Sa){return 0<=Ya.t2e.indexOf(Sa)}lHf(Sa){return 0<=Ya.u2e.indexOf(Sa)}TEf(Sa){return Sa.toLowerCase()===Sa}Bdc(Sa){return Sa.toUpperCase()===Sa}aYd(Sa){return Sa.toLowerCase()!==Sa.toUpperCase()}xKm(Sa,Eb,Jb,vb){return(new va(Sa,Eb,Jb,vb)).JTk()}fSl(Sa){do{if(Sa.getAttribute("xml:lang"))return l.a.qg(Sa.getAttribute("xml:lang"))||l.a.MUc;if(Sa.getAttribute("lang"))return l.a.qg(Sa.getAttribute("lang"))||
l.a.MUc;Sa=Sa.parentNode}while(Sa&&1===Sa.nodeType);return l.a.MUc}wof(Sa){return l.a.qg(v.FormattingReader.language(v.FormattingReader.Vr(Sa)))||l.a.MUc}CNd(Sa,Eb){0>Eb&&(Eb=0);let Jb=-1;const vb=Ya.t2e.length;for(let ac=0;ac<vb;++ac){const dc=Sa.lastIndexOf(f.a.charAt(Ya.t2e,ac),Eb);dc>Jb&&(Jb=dc)}Sa=f.a.J4a(Sa,Eb);Sa>Jb&&(Jb=Sa);return Jb}IBl(Sa){for(let Eb=0;Eb<Sa.length;++Eb)if(this.aYd(f.a.charAt(Sa,Eb)))return Eb;return-1}Yjf(Sa,Eb){if(!Sa||0>Eb)return-1;let Jb=Eb;Jb=Jb?this.CNd(Sa,Jb-1):-1;
Jb=Jb>f.a.J4a(Sa,Eb-1)?Jb:f.a.J4a(Sa,Eb-1);Jb++;return Jb}$Zh(Sa,Eb,Jb){this.wMc(Eb);if(!this.jUb[Eb]){Eb=K.g8h(Eb);if(0>=Eb)return null;this.wMc(Eb);if(!this.jUb[Eb])return null}if(Jb&&this.Cqc[Eb]&&Array.contains(this.Cqc[Eb],Sa+Jb))return null;Jb=this.jUb[Eb][f.a.Zg(Sa)];if("string"!==typeof Jb||Jb===Sa||!Jb)return null;var vb=this.IBl(Sa);if(0>vb||this.TEf(f.a.charAt(Sa,vb)))return Jb;Eb=!0;for(vb+=1;vb<Sa.length;++vb){const ac=f.a.charAt(Sa,vb);Eb&&!this.Bdc(ac)&&(Eb=!1)}return Eb?null:f.a.ZA(f.a.substring(Jb,
0,1))+f.a.right(Jb,1)}WBl(Sa,Eb,Jb,vb){a.a.mark(4666);const ac=this.fSl(Eb).LCID;let dc=0,Cc=Sa;const Ec=Eb.innerText;var rc=Ec.lastIndexOf(" ",Sa);if(this.ADf(Ec.substring(rc+1,Sa)))return a.a.mark(4667),null;rc=null;var hb=!1;do{Cc=Cc?this.CNd(Ec,Cc-1):-1;if(-1===Cc&&!Jb){hb=Eb;var fb=null;if(!this.xkb(Ec.charAt(0))){do{for(;hb&&!hb.previousSibling;)hb=hb.parentNode;hb&&(hb=hb.previousSibling,fb=hb.innerText)}while(hb&&!fb);if(hb&&fb&&!this.xkb(f.a.charAt(fb,fb.length-1)))return a.a.mark(4667),
null}hb=!0}fb=f.a.substring(Ec,Cc+1,Sa);++dc;var Nb=this.$Zh(fb,ac,vb.toString());if(Nb)rc=Ib.WT(Eb,Cc+1,Sa,Nb,this.Ld),Ya.BLf();else for(const Fb of this.fBc)if(!(Fb.flags&1&&!(Jb&&1>Cc)||Fb.flags&4||Fb.flags&2&&" "!==vb)&&(Nb=Fb.pattern.exec(fb))){rc=Fb.Jtm(Eb,Cc+1,Sa,Nb,this.Ld,this.ga);break}}while(!hb&&!rc&&dc<Ya.bMi&&0<=Cc);a.a.mark(4667);return rc}UBl(Sa,Eb,Jb){const vb=Sa.node;let ac=N.ParagraphReader.text(vb);0>Eb&&(Eb=Sa.cpBegin);Sa=this.wof(Sa).LCID;if(this.ADf(ac.substring(f.a.J4a(ac,
Eb)+1,Eb)))return null;var dc=-1,Cc=P.a.q9b(vb);for(var Ec=0;Ec<Cc.length;Ec++)if(Eb>Cc[Ec].cpEnd)dc=Cc[Ec].cpEnd;else{if(Eb>Cc[Ec].cpBegin)return null;break}Cc=null;Ec=(Ec=Eb)?this.CNd(ac,Ec-1):-1;Ec<dc&&(Ec=dc-1);dc=f.a.substring(ac,Ec+1,Eb);dc=dc.trimStart();if(1>Ec)for(const rc of this.fBc){let hb=ac;" "!==Jb&&(hb=ac+Jb);if(rc.pattern.exec(hb))return null}ac=ac.substring(0,Eb);if(!this.xKm(ac,Jb.toString(),dc,Sa))return null;dc.charAt(0).toUpperCase()!==dc.charAt(0)&&(Cc=$a.pG(vb,Ec+1,Eb,this.Ld,
this.Ik,this.ED));return Cc}BZh(Sa,Eb,Jb){Sa=M.SelectionFactory.oo(Sa,!1);if(!Sa)return null;Sa=Sa.Rc;return J.SelectionEditor.ef(Sa)?this.UBl(Sa,Eb,Jb):null}ADf(Sa){return f.a.DR(Sa)}Bjf(Sa,Eb,Jb,vb){a.a.mark(4666);const ac=Sa.node,dc=this.wof(Sa).LCID,Cc=N.ParagraphReader.text(ac);0>Eb&&(Eb=Sa.cpBegin);if(Jb&&!this.xkb(f.a.charAt(Cc,Eb))||this.ADf(Cc.substring(f.a.J4a(Cc,Eb)+1,Eb)))return a.a.mark(4667),null;Sa=-1;Jb=P.a.q9b(ac);for(var Ec=0;Ec<Jb.length;Ec++)if(Eb>Jb[Ec].cpEnd)Sa=Jb[Ec].cpEnd;
else{if(Eb>Jb[Ec].cpBegin)return null;break}Jb=0;Ec=Eb;let rc=null;do{Ec=Ec?this.CNd(Cc,Ec-1):-1;Ec<Sa&&(Ec=Sa-1);const fb=f.a.substring(Cc,Ec+1,Eb);++Jb;var hb=null;let Nb=!1;if(H.a.sTh){const Fb=Cc+String.fromCharCode(vb);Nb=this.fBc.some(nb=>nb.pattern.exec(Fb))}Nb||(hb=this.$Zh(fb,dc,null));if(hb)this.SV.nTa&&(rc=Ib.pG(ac,Ec+1,Eb,hb,this.Ld),Ya.BLf());else for(const Fb of this.fBc)if(!(Fb.flags&1&&-1!==Ec||Fb.flags&4&&vb!==k.a.Ls||Fb.flags&2&&vb!==k.a.zJa)&&(hb=Fb.pattern.exec(fb))){rc=Fb.pkm(ac,
Ec+1,Eb,hb,this.Ld,this.ga);if(rc.commandId!==F.a.s2e&&!this.SV.nTa||rc.commandId===F.a.s2e&&!this.SV.l6c)rc=null;break}}while(0<=Ec&&Ec>=Sa&&!rc&&Jb<Ya.bMi);a.a.mark(4667);return rc}AZh(Sa,Eb,Jb){Sa=M.SelectionFactory.oo(Sa,!1);if(!Sa)return null;Sa=Sa.Rc;return J.SelectionEditor.ef(Sa)?this.Bjf(Sa,Eb,!1,Jb):null}IZh(Sa,Eb){var Jb=M.SelectionFactory.oo(Sa,!1);if(!Jb)return null;let vb=Jb.Rc;Jb.Vw&&Jb.Rc.contextId!==z.a.Uc&&0<=Eb&&(vb=G.a.Oc(Sa,Eb));if(!J.SelectionEditor.ef(vb)||P.a.vxa(vb,!1))return null;
Jb=N.ParagraphReader.text(vb.node);Sa=0<Eb?f.a.J4a(Jb,Eb-1)+1:f.a.J4a(Jb,Jb.length-1)+1;Eb=0<Eb?Eb:Jb.length;Jb=f.a.substring(Jb,Sa,Eb);return!Jb||this.YXg&&!P.a.y4a(Jb)||!f.a.DR(Jb)&&!f.a.BVc(Jb)||!Ya.Sp.AYn(vb,Sa,Eb)?null:this.p4j.e$k(vb.node,Sa,Eb)}MZh(Sa,Eb){var Jb=M.SelectionFactory.oo(Sa,!1);if(!Jb)return null;var vb=Jb.Rc;if(!J.SelectionEditor.ef(vb))return null;0>Eb&&(Eb=vb.cpBegin);var ac=N.ParagraphReader.text(vb.node);Jb=this.Yjf(ac,Eb);const dc=Ya.u2e.length;for(let Cc=0;Cc<dc;++Cc){const Ec=
ac.lastIndexOf(f.a.charAt(Ya.u2e,Cc),Eb-1);Ec>Jb&&(Jb=Ec+1)}ac=f.a.substring(ac,Jb,Eb);if(!ac)return null;vb=this.wof(vb).LCID;return(new Hb(ac,vb)).dPm()?bb.pG(Sa,Jb,Eb,this.Ld):null}xZh(Sa,Eb){var Jb=M.SelectionFactory.oo(Sa,!1);if(!Jb)return null;Jb=Jb.Rc;if(!J.SelectionEditor.ef(Jb))return null;0>Eb&&(Eb=Jb.cpBegin);var vb=N.ParagraphReader.text(Jb.node);Jb=this.Yjf(vb,Eb);vb=f.a.substring(vb,Jb,Eb);return vb?(vb=(new La(vb)).xHl())?za.pG(Sa,Jb,Eb,vb,this.Ld):null:null}TCl(Sa,Eb,Jb,vb,ac){var dc=
M.SelectionFactory.oo(Sa,!1);if(!dc)return null;dc=dc.Rc;if(Jb>Eb||!J.SelectionEditor.ef(dc))return null;0>Eb&&(Eb=dc.cpBegin);if(0>Eb)return null;dc=N.ParagraphReader.text(dc.node);return zb.pG(Sa,Jb,ac,Eb?dc.charAt(Eb-1):"\x00",this.Ld,vb)}mAb(Sa,Eb,Jb,vb){this.fBc.push(new Za(`^${Sa}$`,Eb,Jb,vb))}eOf(Sa){if(this.jUb[this.obb]){const Eb=this.jUb[this.obb];for(const Jb in Sa)Eb[Jb]=Sa[Jb]}else this.jUb[this.obb]=Sa}iOf(Sa){this.Cqc[this.obb]?this.Cqc[this.obb].push(...(Sa||[])):this.Cqc[this.obb]=
Sa}E_m(Sa,Eb){var Jb;this.gte.has(Eb)||(this.gte.add(Eb),null===(Jb=x.AFrameworkApplication.He)||void 0===Jb?void 0:Jb.sj(Sa,1,null,null,!1,3,vb=>{this.obb=Eb;try{Object(r.a)(vb.data.se)}catch(ac){m.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:vb.data?vb.data.se:""})}this.obb=-1},()=>{this.zul(Eb)},null,void 0,void 0,void 0,void 0,"27"))}zul(Sa){Sa=K.g8h(Sa);0<Sa&&this.wMc(Sa)}static get sHk(){return null!=Ya.Uug?Ya.Uug:Ya.Uug=(()=>Ya.lvh.map(([Sa,...Eb])=>
(new Za(`^${Sa}`,...Eb)).pattern))()}static get lvh(){return null!=Ya.Vug?Ya.Vug:Ya.Vug=(()=>[...xa.r5f.map(Sa=>[Sa,xa.WT,xa.pG,3]),["\\(?(\\d+)[\\.\\)\\-]",ib.WT,ib.pG,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",Ca.WT,Ca.pG,3],...Ub.r5f.map(Sa=>[Sa,Ub.WT,Ub.pG,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",Ca.WT,Ca.pG,3]])()}N_m(){this.wMc(1033);this.mAb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ga.WT,Ga.pG,5);this.mAb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ga.WT,Ga.pG,5);this.mAb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Ga.WT,Ga.pG,5);Ya.lvh.forEach(Sa=>this.mAb(...Sa));this.mAb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",ta.WT,ta.pG,0);this.mAb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Ka.WT,Ka.pG,0);this.mAb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Ka.WT,Ka.pG,0)}wMc(Sa){this.gte.has(Sa)||this.E_m(L.a.vKk(String.format("Acl/Acl{0}.js",Sa)),Sa)}static BLf(){y.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(Sa=>{Sa.logActivity("AutocorrectStringMatch",null)})}static get Sp(){return null!=Ya.Dzg?Ya.Dzg:
Ya.Dzg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}Ya.t2e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Ya.u2e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Ya.bbg=".!?";Ya.bMi=5;Object(D.a)(Ya,"AutoCorrectRules",null,[524])},1657:function(D,I,c){D=c(0);var l=c(34),f=c(7),a=c(457),k=c(575),x=c(54),y=c(2),m=c(38);const r=(Y,ba,Z)=>{if(Y){var ea=0;do{try{Y();break}catch(ha){if(f.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",
ea,Z,ha.message,ha.stack),ea>=ba)break}ea++}while(1)}};var z=c(92),v=c(28),G=c(203),F=c(182),H=c(45),L=c(312),J=c(20),M=c(135);class P{constructor(Y,ba,Z,ea,ha,la,ia,sa,Oa=!0,Ra=null,Na=!1){this.$Yh="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.El=this.Duc=this.lAe=this.EZa=this.tkd=this.yE=this._form=null;this.Mh=!1;this.gz=this.ukd=this.Tdb=null;this._parent=Y;this.j5j=ba;this.Ffk=Z;this.fVg=ha;this.jCa=ia;this.hJg=sa;this.GMg=Ra;this.qWe=!1;this.i6j=ea.$("CanaryRenewalForFileUploadIsEnabled");
this.eZo=!1;(this.pcb=Na)||this.k7k(la);Oa&&this.xqi()}get Ucj(){return this.Ffk}get sessionId(){return this.jCa}get iFrame(){return this._iframe}get fU(){return this.yE}get rLb(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get UYh(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get INm(){return this.pcb?!1:F.b(this._iframe.contentWindow.location.pathname,this.$Yh,0)}get aAk(){return!J.a.lpa&&
y.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}xqi(){this.gz=M.a.create().toString();this.pcb?this.thf():this.WBk()}k7k(Y){this._iframe=document.createElement("iframe");this._iframe.className=Y;this._iframe.id=Y;this.fVg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.EZa=Object(x.a)(this,this.NXf,"onUploadFrameLoad");m.a.addHandler(this._iframe,"load",this.EZa)}BKd(Y=null){y.AFrameworkApplication.ua.y$d();
if(!this.yE)return f.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";m.a.addHandler(this.yE,"change",()=>{this.lAl(Y)});r(Object(x.a)(this,this.TYh,"fileInputClick"),1,"DoFileOpenDialog");return this.yE.value}lAl(Y){Y&&Y(this.yE.value)}mAl(){this.tkd&&(this.tkd.innerText=this.q$h())}uUn(Y){m.a.addHandler(this.yE,"change",()=>{Y(this.q$h())})}q$h(){let Y=null;if(this.yE.value){const ba=this.yE.value,Z=ba.lastIndexOf("\\");0<Z&&(Y=ba.substring(Z+1,ba.length))}return Y?Y:""}TYh(){try{f.ULS.sendTraceTag(35939520,
322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.yE.click()}catch(Y){throw f.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}}dad(){this.eSm()?this.cvj():(this.Xog(),this._form.submit())}eSm(){return(this.i6j||this.pcb)&&!(void 0===window.self.FormData||null===window.self.FormData)}Khj(Y){if(Y){const ba=this.xJh();this.El=new XMLHttpRequest;this.El.open("POST",ba);this.El.setRequestHeader("X-CorrelationId",this.gz);this.M2m(Y);
this.El.onreadystatechange=Object(x.a)(this,this.Zza,"uploadResponseReceived");this.El.send(Y)}}M2m(Y){if(!J.a.lpa&&Y.get){var ba=Y.get("ImageId");Y=window.self.navigator;ba={["CorrelationId"]:this.gz,["Canary"]:y.AFrameworkApplication.canary,["ImageNodeId"]:ba};Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?Y.webkitConnection:null)&&(ba.effectiveType=Y.effectiveType,ba.downlink=Y.downlink,ba.type=Y.type,ba.rtt=Y.rtt);f.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",
ba)}}cvj(){try{this.Xog();f.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const Y=new (Type.parse("FormData"))(this._form);this.Khj(Y)}catch(Y){f.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Y.message),this.Igc(null)}}bvj(Y){try{if(this.Xog(),f.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.H_o(Y)){this.ukd=Y;this._form.contains(this.yE)&&
this._form.removeChild(this.yE);var ba=new (Type.parse("FormData"))(this._form);ba.append("applicationfileInput",Y.blob,Y.filename);this.Khj(ba)}else this.Igc(null)}catch(Z){f.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Z.message),this.Igc(null)}}H_o(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(f.ULS.sendTraceTag(578380442,322,10,
"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",f.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),!1)}Zza(){if(4===this.El.readyState)if(200===this.El.status){f.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",
this.gz);const Y=this.El.getResponseHeader("X-NewKey"),ba=this.MGm(this.El);let Z=!1;if(void 0!==Y&&null!==Y&&ba&&(Z=this.r_o(Y),!this.qWe&&Z)){f.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.gz);this.qWe=!0;this.kId();void 0!==this.ukd&&null!==this.ukd?this.bvj(this.ukd):this.cvj();return}f.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",
this.qWe,ba,!(void 0===Y||null===Y),Z,this.gz);this.Igc(this.El.responseText)}else f.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.El.status,this.El.responseText?!1:!0,this.gz),this.Igc(null)}MGm(Y){try{const ba=l.a(Y.responseText).Responses;if(void 0!==ba&&null!==ba&&1===ba.length){const Z=ba[0];if(void 0!==Z&&null!==Z&&2===Z.length&&28===Z[1].StatusCode)return!0}}catch(ba){}return!1}r_o(Y){L.a.Fng(Y);return y.AFrameworkApplication.canary!==
Y?!1:!0}Xog(){this.Tdb||(this.Tdb=new Date)}dispose(){this.Mh||(this.pcb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),m.a.removeHandler(this._iframe,"load",this.EZa),this.EZa=null),this.lAe&&(m.a.removeHandler(this.yE,"change",this.lAe),this.lAe=null),this.UYh&&(this.Duc&&(m.a.removeHandler(this.yE,"change",this.Duc),this.Duc=null),this.tkd=null),this.yE=this._form=this._parent=this._iframe=null,this.Mh=!0,this.Tdb=null,f.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}l5b(Y,
ba){if(this._form){var Z;(Z=this._form.querySelector("input[name="+Y+"]"))?Z.value=ba:(Z=this.laf(),Z.type="hidden",Z.id=Y,Z.name=Y,Z.value=ba,this._form.appendChild(Z))}}laf(){return this.pcb?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}NXf(){try{if(!this._iframe.contentWindow.document.body)return}catch(ba){this.cSc();return}if(!(this._initialized||this.rLb&&J.a.YH))this.thf();else if(!this.rLb||!J.a.YH||this.INm){let ba;ba=J.a.Kt?this._iframe.contentWindow.document.body.innerText:
this.eZo?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var Y=this._iframe.contentWindow.document.body.innerText.toLowerCase();const Z=0<=Y.indexOf("responses")||0<=Y.indexOf("wopisrc");Y=0<=Y.indexOf("http error");!Z&&Y&&f.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.Igc(ba)}}thf(){if(!this._initialized){var Y=this.XC("uploadForm");
const ba=this.XC("fileInput"),Z=this.xJh();this.D9k();this._form.id=Y;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=Z;this.yE.type="file";this.hJg&&(this.yE.accept=this.hJg,this.GMg&&(this.yE.capture=this.GMg));this.yE.id=ba;this.yE.name=ba;this.aAk&&(this.yE.multiple=!0);!this.UYh||J.a.Kt||J.a.pu||(this.Duc=Object(x.a)(this,this.mAl,"fileInputChangedHandleAccessibility"),m.a.addHandler(this.yE,"change",this.Duc),this.tkd=v.a.Yrh(this._form,this.yE,"InputFileDescription"));
this.fVg&&(this.pcb||(Y=this._iframe.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=y.AFrameworkApplication.ua,this.yE.style.fontFamily=Y.Sza,this.yE.style.fontSize=Y.Xmg,this.yE.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&this.l5b("__REQUESTDIGEST",Y.value);this.kId();this._form.appendChild(this.yE);this._initialized=!0;this.j5j(this)}}D9k(){if(this.pcb)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.yE=document.createElement("input");
else{this._form=this._iframe.contentWindow.document.createElement("form");const Y=this._iframe.contentWindow.document;Y.body.appendChild(this._form);this.yE=Y.createElement("input")}}WBk(){this._parent.appendChild(this._iframe);this.rLb&&J.a.YH&&this.thf()}xJh(){var Y=new G.QueryStringBuilder(this.$Yh);y.AFrameworkApplication.aga(Y);this.Kdo(Y);Y=Y.toString();if(J.a.lj||J.a.YH||J.a.pu)Y=H.a.w8b(Y);return Y}EAd(){const Y=new z.a(2,1,0,Object(x.a)(this,this.delayedDispose,"delayedDispose"),4);y.AFrameworkApplication.oc.Xb(Y)}}
Object(D.a)(P,"UploadFrame",null,[10]);var N=c(19),K=c(255),O=c(9),V=c(1782);class W extends P{constructor(Y,ba,Z,ea,ha,la,ia=null,sa=!1){super(Y,ba,Z,ea,ha,"WACUploadFrame",y.AFrameworkApplication.userSessionId,la,!1,ia,sa)}XC(Y){return O.App.za.mj(Y)}Kdo(Y){K.a.instance.rAb(Y)}kId(){y.AFrameworkApplication.canary&&this.l5b(a.a.canary,y.AFrameworkApplication.canary);O.App.za.jb.activeSection.KH&&this.l5b(a.a.KH,O.App.za.jb.activeSection.KH)}itf(Y){let ba=null,Z;({group:Z}=k.a.S1(Y)).returnValue?
ba=Z.Responses[0]:f.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return ba}cSc(){f.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const Y=new V.a;Y.StatusCode=14;this.Ucj(Y);this.EAd()}Igc(Y){Y?(Y=N.a.Ouj(Y),Y=Y.replace(RegExp("&amp;","g"),"&"),(Y=this.itf(Y))?(this.Ucj(Y),this.EAd()):this.cSc()):this.cSc()}}Object(D.a)(W,"Box4UploadFrame",
P,[]);c.d(I,"a",function(){return T});class T extends W{constructor(Y,ba,Z,ea,ha,la=null,ia=!1){super(Y,ba,Z,ea,ha,T.SJl(),la,ia);this.xqi()}static SJl(){return T.Tjh.join(",")+","+T.AWe.join(",")}kId(){super.kId();this.l5b(a.a.Grb,"1");this.l5b(a.a.JSb,"1")}cSc(){super.cSc();f.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}itf(Y){const ba=super.itf(Y);if(!ba)try{const Z=l.a(Y);k.a.Hlf(Z)}catch(Z){f.ULS.sendTraceTag(41697633,
322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",Z.toString())}return ba}}T.Tjh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");T.AWe=[".webp"];Object(D.a)(T,"Box4ImageUploadFrame",W,[])},1659:function(D,I,c){D=c(0);var l=c(135),f=c(60),a=c(354),k=c(55),x=c(3),y=c(730),m=c(18),r=c(5),z=c(299),v=c(43),G=c(1331),F=c(827),H=c(117),L=c(46),J=c(16),M=c(6),P=c(155),N=c(41),K=c(7),O=c(1877),V=c(687),W=c(1713),T=c(124),Y=c(1564);class ba{constructor(ia,sa,Oa,Ra,Na,Da){this.V6b=this.JH=null;this.Rlf=
sa;if(ia[V.a.KRc])this.tR=ia[V.a.KRc],this.EFc=ia[V.a.EFc],this.V6b=Array(4),this.V6b[0]=ia[V.a.Ugb],this.V6b[1]=ia[V.a.Vgb],this.V6b[2]=ia[V.a.Wgb],this.V6b[3]=ia[V.a.Tgb],this.V1o=ia[V.a.width],this.Qrm=ia[V.a.height],this.Kxa=void 0!==ia[V.a.Kxa]?"true"===ia[V.a.Kxa].toLowerCase():void 0,this.Is=Oa,this.K6b=Ra;else{sa=ia[V.a.Ugb];const ra=ia[V.a.Vgb],xa=ia[V.a.Wgb],fa=ia[V.a.Tgb];Da&&Da.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==sa&&void 0!==ra&&void 0!==xa&&void 0!==fa?(this.Ugb=
sa,this.Vgb=ra,this.Wgb=xa,this.Tgb=fa):(this.Ugb=ia[V.a.left],this.Vgb=ia[V.a.right],this.Wgb=ia[V.a.top],this.Tgb=ia[V.a.bottom]);this.width=ia[V.a.width];this.height=ia[V.a.height];this.rotationAngle=ia[V.a.angle];this.hBn=ia[V.a.gBn];this.Is=Oa;this.K6b=Ra;this.Afb=Na;this.DFa=2;this.flipH=this.NX(ia,V.a.flipH);this.flipV=this.NX(ia,V.a.flipV);this.qfn();this.rTo()}}rTo(){this.JH||(this.JH=Array(4),this.JH[0]=T.a.xG(this.Ugb),this.JH[1]=T.a.xG(this.Vgb),this.JH[2]=T.a.xG(this.Wgb),this.JH[3]=
T.a.xG(this.Tgb))}qfn(){var ia=Y.c(this.rotationAngle);if(45<=ia&&135>=ia||225<=ia&&315>=ia){ia=this.width/2;const sa=this.height/2;this.Ugb-=ia-sa;this.Vgb+=ia-sa;this.Wgb-=sa-ia;this.Tgb+=sa-ia}}NX(ia,sa){if(ia.hasOwnProperty(sa))return ia[sa]}}Object(D.a)(ba,"JsonToDocumentXmlResponseCommonParams",null,[]);class Z extends ba{constructor(ia,sa,Oa,Ra,Na,Da){super(ia,sa,Oa,Ra,Na,Da);this.pAk="string"===typeof ia[V.a.RBd]?ia[V.a.RBd]:null;this.D7b="string"===typeof ia[V.a.D7b]?ia[V.a.D7b]:null}}Object(D.a)(Z,
"JsonToDocumentXmlResponseDrawingParams",ba,[]);var ea=c(520);class ha extends ba{constructor(ia,sa,Oa,Ra,Na,Da){var ra,xa,fa,oa,ta;super(ia,sa,Oa,Ra,Na,Da);this.sYo=ia[V.a.QAn];this.l3k=ia[V.a.IAn];this.DFa=1;this.l3k||(this.DFa=0,this.JH=ea.a.instance.loa(T.a.xG(this.width),T.a.xG(this.height),this.rotationAngle));this.nYf=this.NX(ia,V.a.Pgc);this.D8d=this.NX(ia,V.a.D8d);this.oYf=this.NX(ia,V.a.oYf);this.XIj=this.NX(ia,V.a.WIj);this.Hoe=this.NX(ia,V.a.Hoe);this.Fqg=this.NX(ia,V.a.Fqg);this.C5c=
null!==(ra=this.NX(ia,V.a.C5c))&&void 0!==ra?ra:"";this.extension=ia[V.a.extension];this.yva=null!==(xa=this.NX(ia,V.a.left))&&void 0!==xa?xa:0;this.Ava=null!==(fa=this.NX(ia,V.a.top))&&void 0!==fa?fa:0;this.zva=null!==(oa=this.NX(ia,V.a.right))&&void 0!==oa?oa:0;this.xva=null!==(ta=this.NX(ia,V.a.bottom))&&void 0!==ta?ta:0;this.lockAspectRatio=this.NX(ia,V.a.lockAspectRatio);this.Hwh=this.NX(ia,V.a.dja);this.borderStyle=this.NX(ia,V.a.zqa);this.borderColor=this.NX(ia,V.a.wHa);this.TJk=void 0!==this.Hwh||
void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.NX(ia,V.a.altTextDescription);this.alphaModFix=this.NX(ia,V.a.alphaModFix)}}Object(D.a)(ha,"JsonToDocumentXmlResponsePictureParams",ba,[]);c.d(I,"a",function(){return la});class la{constructor(ia,sa,Oa,Ra,Na,Da,ra,xa,fa,oa,ta,Ka,va,La,za,Ca,ua){this.Bab=this.azb=null;this.Eld=ia;this.jBe=sa;this.lK=Oa;this.Lm=Ra;this.Sl=Na;this.Kc=Da;this.x0j=xa;this.eSg=ra;this.Rj=fa;this.Jo=oa;this.tdk=ta;this.rdk=Ka;this.Ga=va;this.TV=
La;this.od=za;this.N6j=Ca;this.Q4j=ua}lqa(ia,sa,Oa,Ra,Na,Da,ra){Da.stop();ra?K.ULS.sendTraceTag(575522565,3001,10,ia):K.ULS.sendTraceTag(575522566,3001,10,ia);this.eSg?(Ra=this.Kc.Pc(7,x.a.LRc),Ra.Db(Oa),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&sa.Gb.setValue(H.a.jPa,!1),sa.Gb.setValue(L.a.s0,0),sa.Gb.setValue(J.a.sia,sa.JOk),sa.Gb.setValue(J.a.ria,sa.HOk),Ra.dispose()):Ra();this.Bab&&this.Bab(ia);Na()}xgc(ia,sa,Oa,Ra,Na,Da,ra){K.ULS.sendTraceTag(575522567,
3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.li});var xa=ia.data.se,fa=null;try{fa=JSON.parse(xa)}catch(ta){this.lqa("Failed to parse incoming JSON blob.",sa,Na,Ra,Oa,ra,!1);return}if(O.a.error in fa)this.lqa("Error code returned from WordGraphicsEditorHandler endpoint: "+fa[O.a.error],sa,Na,Ra,Oa,ra,!1);else{xa=10;var oa=1;try{xa=parseInt(fa[V.a.Is]),oa=parseInt(fa[V.a.K6b])}catch(ta){this.lqa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",
sa,Na,Ra,Oa,ra,!1);return}Oa=ia.data.request?y.a.cNc(ia.data.request.get_body()):null;ia=null;ia=sa.Gb;Ra=sa.getId();sa=ia.getValue(M.a.Is);sa=sa!==xa&&(5===sa||5===xa||this.Dpm(ia,fa));5===xa?(fa=new ha(fa,this.jBe,xa,oa,Oa,this.Ga),ia=this.rQl(Na,Da,fa,sa,ia,Ra)):(fa=new Z(fa,this.jBe,xa,oa,Oa,this.Ga),ia=this.qQl(Na,Da,fa,sa,ia,Ra));fa=this.Kc.Pc(7,x.a.LRc);xa=Na;m.ImageReader.h9(Na)&&sa&&(xa=r.GraphIterator.eb(Na),xa.zb(12),xa=xa.parentNode);fa.Db(xa);ia();this.lK.jIa(Da);fa.dispose();if(this.Sl&&
this.Sl!==l.a.nil){const ta=xa.Ui();null===ta||void 0===ta?void 0:ta.contentReplicator.forceOutbound(()=>{K.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.li});ra.stop();const Ka=new f.a(this.Sl,1);this.Lm.B4b(ta,Ka);const va=this.Eld.properties;null!=va&&Object(z.a)(()=>{const La=new v.GraphTransaction(3,x.a.c9);La.Db(Na);va.setValue(H.a.w5,1);La.dispose()})},null,null)}this.azb&&this.azb(Na)}}ash(ia,
sa){ia.ye(O.a.Q_f,"false");ia.ye(O.a.Rlf,this.jBe);ia.ye(O.a.Q9e,"0");ia.WI(V.a.Afb,window.self.devicePixelRatio.toString());void 0!==sa&&null!==sa&&(sa=this.Jo.nn(sa.ek),sa=this.Jo.vi(sa),ia.ye(V.a.Is,G.a[sa]));this.N6j&&(ia.ye(V.a.sWd,"true"),ia.ye(V.a.Evm,this.Q4j.toString()))}Klh(ia){if(this.eSg){ia=ia.ek;var sa=this.Jo.nn(ia);if(!sa)return null;const Oa=new W.a(this.x0j,sa),Ra=this.Kc.Pc(15,x.a.LRc);Ra.Db(ia.node);this.j0i(sa,!1);sa.setValue(M.a.Is,sa.ja(M.a.Is,10));Ra.Qj=x.a.LRc;Ra.HGa(this.Sl,
1);Ra.dispose();return Oa}sa=new a.DictionaryPropertySet;this.j0i(sa,!0);return(ia=this.Rj.vSh(ia,sa,this.Sl))&&ia.blob?new W.a(ia.blob.id,ia.blob.properties):null}gTd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}j0i(ia,sa){ia.setValue(J.a.sia,k.a.Kl(this.tdk,0));ia.setValue(J.a.ria,k.a.Kl(this.rdk,1));this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!sa?ia.setValue(H.a.jPa,!0):ia.setValue(L.a.s0,1);ia.setValue(P.a.F4,!0)}qQl(ia,
sa,Oa,Ra,Na,Da){const ra=xa=>{this.Eld.UTo(Oa,xa,ia)};return this.lPi(Ra,Na,ia)?this.U5h(sa,Na,Da,ra):()=>{ra(Na)}}rQl(ia,sa,Oa,Ra,Na,Da){const ra=xa=>{this.Eld.VTo(Oa,xa,ia)};return this.lPi(Ra,Na,ia,Oa)?this.U5h(sa,Na,Da,ra):()=>ra(Na)}lPi(ia,sa,Oa,Ra){return ia?!0:Ra?m.ImageReader.kSd(sa,Oa.Lc,!1)!==Ra.nYf:!1}U5h(ia,sa,Oa,Ra){const Na=F.a.instance.Ced;Na.Yw(sa);Na.id=Oa;return()=>{this.Eld.F1n(ia,Oa,Na,this.TV,Ra)}}ylo(ia){this.azb=ia}Qfo(ia){this.Bab=ia}Dpm(ia,sa){return this.od.isFeatureEnabled(48)&&
(ia.hasProperty(N.a.tR)&&!sa[V.a.KRc]||!ia.hasProperty(N.a.tR)&&sa[V.a.KRc])?!0:!1}}Object(D.a)(la,"GraphicsEditorJsonToDocumentXmlRequestHelper",null,[579])},1660:function(D,I,c){D=c(0);var l=c(75),f=c(54),a=c(323),k=c(337);class x{constructor(G,F,H,L=0,J=0,M=null,P=null){this.commandId=G;this.controlId=F;this.timeStamp=H;this.commandSurface=a.a[L];this.Qx=k.a[J];this.contentType=M;this.Ske=P}}Object(D.a)(x,"CommandActionInfo",null,[]);class y{constructor(){this.VSj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}dVm(G){return!this.VSj.exec(G)}}
Object(D.a)(y,"EventsCacheLoggingUtils",null,[]);var m=c(2),r=c(1837),z=c(657);c.d(I,"a",function(){return v});class v{constructor(){this.L4g=null;this.oJe=20;this.Huc=this.hhd=this.Khd=null}init(){this.L4g=new y;this.Khd=new l.a;this.hhd=new l.a;this.Huc=new l.a;this.oJe=m.AFrameworkApplication.K.lc("MaxCommandClickedEventQueueSize",20);r.a.Lvk(Object(f.a)(this,this.q_k,"commandClickEventRaised"));z.a.instance.bph(Object(f.a)(this,this.fOn,"recordActionEvent"))}lmg(G){G.count>this.oJe&&G.removeAt(this.oJe)}q_k(G,
F){this.Khd.insert(0,new x(F.commandId,F.controlId,F.time,F.commandSurface,F.Qx,F.contentType));this.lmg(this.Khd)}fOn(G,F){this.hhd.insert(0,new x(F.actionName,F.controlId,F.timeStamp,F.commandSurface,F.Qx,F.contentType,F.Ske));this.lmg(this.hhd);this.L4g.dVm(F.actionName)&&(this.Huc.insert(0,new x(F.actionName,F.controlId,F.timeStamp,F.commandSurface,F.Qx,F.contentType,F.Ske)),this.lmg(this.Huc))}dPc(){return this.Khd}bib(){return this.hhd}static get instance(){return v._instance||(v._instance=
new v)}}v._instance=null;Object(D.a)(v,"CommandClickEventsCache",null,[])},1662:function(D,I,c){D=c(0);class l{}Object(D.a)(l,"AuthContext",null,[]);var f=c(2),a=c(466);c.d(I,"a",function(){return k});class k{static getAuthContext(){const x=f.AFrameworkApplication.K.kb("UserPrincipalName")||"";let y=x;f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(y=a.OAuthManagerSettings.bhn||x);return Object.assign(new l,{upn:x,loginHint:y,authority:a.OAuthManagerSettings.authority,
authorityType:k.sPd(),tenantId:f.AFrameworkApplication.K.kb("TenantId")||""})}static sPd(){let x=0;const y=k.Z3h();"aad"===y.toLowerCase()?x=2:"msa"===y.toLowerCase()&&(x=1);return x}static Z3h(){return f.AFrameworkApplication.K.kb("HostAuthType")||""}}Object(D.a)(k,"OAuthIdentity",null,[])},1663:function(D,I,c){c.r(I);D=c(0);var l=c(1828),f=c(54),a=c(1830),k=c(447),x=c(1831),y=c(173),m=c(2),r=c(97),z=c(90),v=c(532),G=c(231),F=c(11),H=c(67),L=c(79),J=c(101),M=c(92),P=c(28),N=c(56),K=c(39),O=c(20),
V=c(13);class W{constructor(ba){this.a4d=4;this.uah=0;this.wQg=this.xMg=this.Rbh=this.ERg=this.jdh=this.pCa=this.s0b=this.Pw=this.igh=this.MUg=this.NUg=this.hCa=this.IYa=this.Hye=this.GWa=this.yWa=this.W=this.D6=this.FAa=null;O.a.txa&&(this.a4d=6);this.xv=ba;this.QZ=J.KeyInputManager.ic(L.a.a2,0);this.render()}get containerElement(){return this.W}dispose(){var ba=m.AFrameworkApplication.ua.lD;const Z=m.AFrameworkApplication.ua.mD;ba.sc(F.a.click,this.W,Object(f.a)(this,this.LSi,"onContainerClick"));
ba.sc(F.a.uB,this.W,Object(f.a)(this,this.MSi,"onContainerDoubleClick"));Z.sc(F.a.sh,this.W,Object(f.a)(this,this.NSi,"onContainerKeyPress"));this.yWa&&(ba.sc(F.a.click,this.yWa,Object(f.a)(this,this.PUf,"onDeleteButtonClick")),Z.hrb(this.yWa,this.wQg));this.GWa&&(ba.sc(F.a.click,this.GWa,Object(f.a)(this,this.XUf,"onDoneButtonClick")),Z.hrb(this.GWa,this.ERg));this.hCa&&(ba.sc(F.a.click,this.hCa,Object(f.a)(this,this.C7d,"onSaveButtonClick")),Z.hrb(this.hCa,this.jdh));this.FAa&&(ba.sc(F.a.click,
this.FAa,Object(f.a)(this,this.mUf,"onCancelButtonClick")),Z.hrb(this.FAa,this.xMg));this.IYa&&(ba.sc(F.a.click,this.IYa,Object(f.a)(this,this.VWf,"onReplyButtonClick")),Z.hrb(this.IYa,this.Rbh));this.Pw&&(Z.sc(F.a.qu,this.Pw,Object(f.a)(this,this.gHa,"onKeyEvent")),Z.sc(F.a.sh,this.Pw,Object(f.a)(this,this.gHa,"onKeyEvent")),O.a.ri&&(ba=m.AFrameworkApplication.ua.Rmc,ba.sc(F.a.KIc,this.Pw,Object(f.a)(this,this.aHa,"onCompositionEvent")),ba.sc(F.a.E4b,this.Pw,Object(f.a)(this,this.aHa,"onCompositionEvent")),
ba.sc(F.a.F4b,this.Pw,Object(f.a)(this,this.aHa,"onCompositionEvent"))),v.a.instance.sc(F.a.paste,this.Pw,Object(f.a)(this,this.y1c,"onPaste")));this.pCa=this.s0b=this.Pw=this.FAa=this.hCa=this.Hye=this.GWa=this.IYa=this.yWa=this.W=null}focus(){H.FocusManager.instance().iD(y.AFrame.Qr);this.W.focus();this.xv.Wq.Onf().ak.Zy(this.W)}n0h(){H.FocusManager.instance().iD(a.a.BIc);this.Pw.focus();this.xv.Wq.Onf().ak.Zy(this.Pw);2===this.xv.Xq&&this.Pw.value&&0<this.Pw.value.length&&K.a.K7c(this.Pw);const ba=
this.xv.Wq.zda.v2c,Z=K.a.y2a(ba,this.W);Z.y+this.W.clientHeight>ba.scrollTop+ba.clientHeight&&(ba.scrollTop=Z.y+this.W.clientHeight-ba.clientHeight)}oDl(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.FAa.style.display="none";this.Pw.style.display="none";H.FocusManager.qmg(this.Pw);H.FocusManager.qmg(this.hCa);H.FocusManager.instance().ae(a.a.BIc).kr(this.QZ);H.FocusManager.instance().J6a(a.a.BIc);J.KeyInputManager.instance.sc(F.a.qu,this.Pw,Object(f.a)(this,this.gHa,"onKeyEvent"));
J.KeyInputManager.instance.sc(F.a.sh,this.Pw,Object(f.a)(this,this.gHa,"onKeyEvent"));if(O.a.ri){const ba=m.AFrameworkApplication.ua.Rmc;ba.sc(F.a.KIc,this.Pw,Object(f.a)(this,this.aHa,"onCompositionEvent"));ba.sc(F.a.E4b,this.Pw,Object(f.a)(this,this.aHa,"onCompositionEvent"));ba.sc(F.a.F4b,this.Pw,Object(f.a)(this,this.aHa,"onCompositionEvent"))}v.a.instance.sc(F.a.paste,this.Pw,Object(f.a)(this,this.y1c,"onPaste"));this.D6.removeChild(this.Pw);this.D6.removeChild(this.s0b);this.pCa=this.s0b=this.Pw=
null;this.Fog();this.Ccd();this.focus()}Ccd(){this.Oaj(this.igh,this.NUg,this.MUg,this.Hye,this.W)}render(){var ba=k.a("a",this.Dia("cc"),"CommentContainer");P.a.ir(ba,P.a.jga,a.a.I0k);ba.tabIndex=0;this.xv.Af&&(ba.className+=" Reply1");var Z=k.a("div",this.Dia("ch"),"CommentHeaderRow");const ea=k.a("span",this.Dia("ca"),"CommentAuthor UIFontBold");ea.innerText=this.xv.author;Z.appendChild(ea);const ha=k.a("span",this.Dia("ct"),"CommentDate");ha.innerText=W.Xfl(this.xv.date,this.xv.Wq.Wfl,this.xv.Wq.IHo);
Sys.UI.DomElement.addCssClass(ha,m.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");Z.appendChild(ha);const la=k.a("span",this.Dia("ci"),"CommentStatusIcon");Z.appendChild(la);let ia=null;this.xv.yIb&&(ia=x.a.l0a(this.Dia("cl"),a.a.K_k,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ia,m.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ia.tabIndex=0,Z.appendChild(ia));this.D6=k.a("div",this.Dia("cn"),"CommentContent");let sa=null,Oa=null,
Ra=null;this.xv.yIb?(sa=k.a("textarea",this.Dia("ce"),a.a.LFh+" UIFont"),sa.rows=this.a4d,sa.cols=50,sa.tabIndex=0,P.a.ir(sa,"title",CommonUIStrings.l_CommentContent),this.D6.appendChild(sa),Oa=k.a("div","","CommentTextMeasurementContainer"),Ra=k.a("textarea","",a.a.LFh+" UIFont"),Ra.rows=1,Ra.cols=50,Ra.style.visibility="hidden",Ra.spellcheck=!1,Oa.appendChild(Ra),this.D6.appendChild(Oa),2===this.xv.Xq&&(sa.value=this.xv.text.join("\n")+"\n")):this.Fog();const Na=k.a("div","","CommentFooterRow"),
Da=k.a("span",this.Dia("cf"),""),ra=x.a.l0a(this.Dia("cr"),a.a.C0k+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);ra.tabIndex=0;ra.setAttribute(P.a.oh,P.a.L3);Da.appendChild(ra);const xa=x.a.l0a(this.Dia("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);xa.tabIndex=0;const fa=xa.childNodes[0].childNodes[0];Da.appendChild(xa);const oa=x.a.l0a(this.Dia("cx"),a.a.M_k+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,
"Delete_16x16x32",!1);xa.tabIndex=0;Da.appendChild(oa);Na.appendChild(Da);const ta=k.a("span",this.Dia("cfa"),""),Ka=x.a.l0a(this.Dia("cs"),a.a.D0k,CommonUIStrings.l_CommentSaveCommentButton,null);x.a.APb(Ka,!1);Ka.tabIndex=0;ta.appendChild(Ka);Na.appendChild(ta);this.Oaj(la,Da,ta,fa,ba);this.xv.Wq.XIh||(ea.setAttribute("Unselectable","on"),ha.setAttribute("Unselectable","on"));ba.appendChild(Z);ba.appendChild(this.D6);ba.appendChild(Na);this.W=ba;this.GWa=xa;this.Hye=fa;this.yWa=oa;this.IYa=ra;this.hCa=
Ka;this.Pw=sa;this.s0b=Oa;this.pCa=Ra;this.FAa=ia;this.NUg=Da;this.MUg=ta;this.igh=la;ba=m.AFrameworkApplication.ua.lD;Z=m.AFrameworkApplication.ua.mD;ba.ob(F.a.click,this.W,Object(f.a)(this,this.LSi,"onContainerClick"));ba.ob(F.a.uB,this.W,Object(f.a)(this,this.MSi,"onContainerDoubleClick"));Z.ob(F.a.sh,this.W,Object(f.a)(this,this.NSi,"onContainerKeyPress"));this.GWa&&(ba.ob(F.a.click,this.GWa,Object(f.a)(this,this.XUf,"onDoneButtonClick")),this.ERg=Z.sob(this.GWa,Object(f.a)(this,this.XUf,"onDoneButtonClick"),
L.a.Ls));this.IYa&&(ba.ob(F.a.click,this.IYa,Object(f.a)(this,this.VWf,"onReplyButtonClick")),this.Rbh=Z.sob(this.IYa,Object(f.a)(this,this.VWf,"onReplyButtonClick"),L.a.Ls));this.hCa&&(ba.ob(F.a.click,this.hCa,Object(f.a)(this,this.C7d,"onSaveButtonClick")),this.jdh=Z.sob(this.hCa,Object(f.a)(this,this.C7d,"onSaveButtonClick"),L.a.Ls));this.yWa&&(ba.ob(F.a.click,this.yWa,Object(f.a)(this,this.PUf,"onDeleteButtonClick")),this.wQg=Z.sob(this.yWa,Object(f.a)(this,this.PUf,"onDeleteButtonClick"),L.a.Ls));
this.FAa&&(ba.ob(F.a.click,this.FAa,Object(f.a)(this,this.mUf,"onCancelButtonClick")),this.xMg=Z.sob(this.FAa,Object(f.a)(this,this.mUf,"onCancelButtonClick"),L.a.Ls));sa&&(Z.ob(F.a.qu,sa,Object(f.a)(this,this.gHa,"onKeyEvent")),Z.ob(F.a.sh,sa,Object(f.a)(this,this.gHa,"onKeyEvent")),O.a.ri&&(ba=m.AFrameworkApplication.ua.Rmc,ba.ob(F.a.KIc,sa,Object(f.a)(this,this.aHa,"onCompositionEvent"),null),ba.ob(F.a.E4b,sa,Object(f.a)(this,this.aHa,"onCompositionEvent"),null),ba.ob(F.a.F4b,sa,Object(f.a)(this,
this.aHa,"onCompositionEvent"),null)),v.a.instance.ob(F.a.paste,sa,Object(f.a)(this,this.y1c,"onPaste")),this.Rno())}xlj(ba){x.a.APb(this.hCa,ba)}Dia(ba){return ba+"_"+this.xv.id}Oaj(ba,Z,ea,ha,la){switch(this.xv.DTa){case 0:case 1:this.lrj(ba,0);break;case 2:case 4:ba.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(la,"SaveFailure"),Sys.UI.DomElement.addCssClass(la,"NoReply"),this.lrj(ba,1)}this.xv.done?(Sys.UI.DomElement.addCssClass(la,"CommentIsDone"),ha.className=z.getImageClass("CheckboxChecked_16x16x32")):
(Sys.UI.DomElement.removeCssClass(la,"CommentIsDone"),ha.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.xv.yIb?(Sys.UI.DomElement.addCssClass(la,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(la,"SelectedComment"),ba.style.display="none",Z.style.display="none",ea.style.display="inline",0===this.xv.Wq.mode&&(this.xlj(!1),x.a.APb(this.FAa,!1))):(1===this.xv.Ija?(Sys.UI.DomElement.addCssClass(la,"SelectedComment"),Sys.UI.DomElement.removeCssClass(la,"SelectedParentComment"),Z.style.display=
1!==this.xv.Wq.mode||3===this.xv.DTa||this.xv.UQa?"none":"inline"):(2===this.xv.Ija?(Sys.UI.DomElement.removeCssClass(la,"SelectedComment"),Sys.UI.DomElement.addCssClass(la,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(la,"SelectedComment"),Sys.UI.DomElement.removeCssClass(la,"SelectedParentComment")),Z.style.display="inline"),ea.style.display="none")}lrj(ba,Z){N.a.HC(ba);switch(Z){case 0:Z=document.createElement("img");Z.alt=CommonUIStrings.l_CommentProgressTooltip;Z.src=r.a.Iba("progress16.gif");
ba.appendChild(Z);break;case 1:Z=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),ba.appendChild(Z)}ba.style.display="inline-block"}Fog(){N.a.K_(this.D6);var ba=this.xv.text;1===ba.length&&ba[0]&&(ba=ba[0].split("\n"));for(const Z of ba)ba=k.a("p","","CommentContentPara"),ba.innerText=Z||"\u00a0",this.xv.Wq.XIh||ba.setAttribute("Unselectable","on"),this.D6.appendChild(ba)}Rno(){const ba=H.FocusManager.instance().ae(a.a.BIc);ba.parent=y.AFrame.Qr;G.a.instance.L1b(a.a.BIc,
this.Pw);ba.bindAction(J.KeyInputManager.ic(L.a.Wqe,2),V.a.Gg);ba.bindAction(this.QZ,V.a.f8e);ba.bindAction(J.KeyInputManager.ic(L.a.m6,0),V.a.T0a);ba.bindAction(J.KeyInputManager.ic(L.a.yea,0),V.a.T0a);ba.kr(H.FocusManager.instance().LW);ba.kr(H.FocusManager.instance().MW)}LSi(ba){if(this.xv.yIb&&ba.Hb.target===this.Pw)return!0;this.xv.iXf();return!0}MSi(){this.xv.oTi();return!0}NSi(ba){let Z=!1;ba.Hb.keyCode===L.a.Ls&&(0===this.xv.Ija?this.xv.iXf():this.xv.oTi(),Z=!0);return Z}PUf(){if(this.yWa.disabled)return!0;
this.xv.Nia();return!0}XUf(){if(this.GWa.disabled)return!0;this.xv.Osn();return!0}VWf(){if(this.IYa.disabled)return!0;this.xv.Gqn();return!0}C7d(){if(this.hCa.disabled)return!0;this.xv.oMb(this.Pw.value);return!0}mUf(){if(this.FAa.disabled)return!0;this.xv.OLb();return!0}gHa(ba){if(ba.Hb.ctrlKey&&ba.Hb.keyCode===L.a.Ls)return 0<this.Pw.value.length&&this.C7d(null),!0;if(ba.Hb.keyCode===L.a.a2)return!0;this.onTextEntered(ba.eventName===F.a.qu&&ba.Hb.charCode===L.a.Ls);return!1}aHa(){this.onTextEntered(!1);
return!1}y1c(){const ba=new M.a(0,1,0,()=>{this.onTextEntered(!1)},1);m.AFrameworkApplication.oc.Xb(ba);return!1}onTextEntered(ba){if(0!==this.xv.Wq.mode&&(this.xlj(0<this.Pw.value.length),!O.a.txa)){this.s0b.clientWidth!==this.Pw.clientWidth&&(this.s0b.style.width=this.Pw.clientWidth+"px");this.pCa.value=this.Pw.value+"___";this.uah>this.Pw.value.length&&(this.pCa.rows=1);for(var Z=0,ea=Number.MAX_VALUE;1<=(Z=this.pCa.scrollHeight-this.pCa.clientHeight)&&Z<ea;)ea=Z,this.pCa.rows++;this.pCa.rows<
this.a4d?this.Pw.rows=this.a4d:(ba&&this.pCa.rows++,this.Pw.rows=this.pCa.rows);this.uah=this.Pw.value.length}}static Xfl(ba,Z,ea){if(!ba||isNaN(ba.getDate()))return"";let ha=ea;const la=new Date;if(la.getFullYear()!==ba.getFullYear()||la.getMonth()!==ba.getMonth()||la.getDate()!==ba.getDate())ha=String.format(CommonUIStrings.l_CommentLongDateFormat,Z,ea);return ba.localeFormat(ha)}}Object(D.a)(W,"CommentViewObject",null,[10,1086]);var T=c(135);c.d(I,"Comment",function(){return Y});class Y{constructor(ba,
Z,ea,ha,la,ia,sa,Oa,Ra=!1,Na=null,Da=null,ra=null){this.ZJg=this.$Jg=this.aSg=null;this.zvd=0;this.edb=2;this.LAa=0;this.Pye=this.mO=null;this.dFf=!1;this.objectId=null;this.UQa=!1;this._id=ba;this.nWg=Z;this.MKg=ea;this.Nid=ha;this.qud=la;this.KKa=ia;this.cO=sa;this.lWg=Oa;this.yHh=Ra;this.hVj=Na;this.iVj=Da;this.usersByReactionType=ra;this.Zi=l.a.instance}get id(){return this._id}set id(ba){this._id=ba}get author(){return this.O_d?CommonUIStrings.l_RemovedAuthorName:this.MKg}get authorId(){return this.hVj}get W2b(){return this.iVj}get date(){return this.O_d?
null:this.Nid}set date(ba){this.Nid=ba}get done(){return this.KKa}set done(ba){this.KKa!==ba&&(this.KKa=ba,this.mO&&this.mO.Ccd())}get lki(){return this.lWg}set lki(ba){this.lWg=ba}get Af(){return this.qud}set Af(ba){this.qud=ba}get text(){return this.cO}set text(ba){this.cO=ba;this.mO&&this.mO.Fog()}get Qwa(){return this.nWg}set Qwa(ba){this.nWg=ba}get Y0a(){return this.aSg}set Y0a(ba){this.aSg=ba}get IFc(){return this.$Jg}set IFc(ba){this.$Jg=ba}get HFc(){return this.ZJg}set HFc(ba){this.ZJg=ba}get Ija(){return this.zvd}set Ija(ba){this.zvd!==
ba&&(this.zvd=ba,this.mO&&this.mO.Ccd())}get DTa(){return this.edb}set DTa(ba){this.edb===ba||0===this.edb&&2===ba||3===this.edb||(this.edb=ba,this.mO&&this.mO.Ccd())}get Xq(){return this.LAa}set Xq(ba){if(this.LAa!==ba){const Z=this.yIb&&0===ba;this.LAa=ba;Z&&this.mO&&this.mO.oDl()}}get yIb(){return 1===this.LAa||2===this.LAa}get O_d(){return!!this.Zi&&this.Zi.Mda}get containerElement(){return this.mO?this.mO.containerElement:null}get Wq(){return this.Zi}get yz(){return this.Pye}set yz(ba){this.Pye=
ba}dispose(){this.mO&&(this.mO.dispose(),this.mO=null)}render(){this.mO=new W(this);return this.mO.containerElement}m5a(){this.mO&&this.mO.Ccd()}focus(){this.iXf();this.mO.focus();this.yIb&&this.mO.n0h()}toString(){let ba="[null]";this.cO&&0<this.cO.length&&(ba=30<this.cO[0].length?this.cO[0].substr(0,30)+"...":this.cO[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.MKg||"[null]",this.Nid?this.Nid.toString():"[null]",this.qud||"[null]",this.KKa,ba)}iXf(){2===
this.Wq.mode||3===this.Wq.mode?this.yIb&&this.mO.n0h():(H.FocusManager.instance().iD(y.AFrame.Qr),1!==this.zvd&&this.Wq.selectComment(this._id))}oTi(){this.Wq.TCo&&0===this.LAa&&(H.FocusManager.instance().iD(y.AFrame.Qr),this.LAa=2,this.edb=0,this.Wq.editComment(this,null))}uln(){3===this.Wq.mode&&(H.FocusManager.instance().iD(y.AFrame.Qr),this.LAa=0,this.edb=2,this.Wq.G5e())}Nia(){H.FocusManager.instance().iD(y.AFrame.Qr);this.Wq.deleteComment(this)}Osn(){this.Wq.HBb(this,!this.KKa)}Gqn(){2!==this.Wq.mode&&
(H.FocusManager.instance().iD(y.AFrame.Qr),this.Wq.addReply(this.qud||this._id,null))}oMb(ba){H.FocusManager.instance().iD(y.AFrame.Qr);this.cO=Array(1);this.cO[0]=ba;1===this.LAa?this.Wq.hva(this):this.Wq.Lfb(this)}OLb(){H.FocusManager.instance().iD(y.AFrame.Qr);this.Wq.zda.v2c&&this.Wq.zda.v2c.focus();1===this.LAa?(this.Wq.deleteComment(this),this.Wq.Qee(this.Af)):this.uln()}static YJh(ba,Z,ea,ha){const la=T.a.create().toString();ba=new Y(la,Y.glm,ba,new Date,Z,!1,[],ea,!1,m.AFrameworkApplication.K.kb("PresenceUserId"),
m.AFrameworkApplication.K.kb("PresenceProvider"));ba.LAa=1;ba.edb=0;ba.Pye=ha;return ba}}Y.glm=null;Y.hZi=-1;Object(D.a)(Y,"Comment",null,[10,732])},1664:function(D,I,c){D=c(0);var l=c(1217),f=c(2050),a=c(1095),k=c(8),x=c(103),y=c(43),m=c(26),r=c(23),z=c(303),v=c(767),G=c(944),F=c(60),H=c(2),L=c(775),J=c(20),M=c(79),P=c(397),N=c(753),K=c(19),O=c(15),V=c(7),W=c(369),T=c(863),Y=c(368),ba=c(864),Z=c(506),ea=c(1048),ha=c(31);class la{constructor(){this.NLe=void 0}onKeyPressed(xa){return this.NLe?this.NLe(xa):
!1}setKeyPressHandler(xa){this.NLe=xa}}var ia=c(1454),sa=c(1635),Oa=c(1552),Ra=c(1527);c.d(I,"a",function(){return ra});var Na;(function(xa){xa[xa.bLj=0]="ArrowDown";xa[xa.cLj=1]="ArrowUp";xa[xa.U6o=2]="ArrowLeft";xa[xa.V6o=3]="ArrowRight";xa[xa.End=4]="End";xa[xa.XMj=5]="Enter";xa[xa.f8o=6]="Escape";xa[xa.tNj=7]="Home";xa[xa.V$o=8]="Space";xa[xa.Tab=9]="Tab"})(Na||(Na={}));Object(D.b)("KeyIdentifier",Na);var Da;(function(xa){xa.Seen="Seen";xa.Tried="Tried";xa.Kept="Kept";xa.Rejected="Rejected"})(Da||
(Da={}));Object(D.b)("EngagementType",Da);class ra extends G.a{constructor(xa,fa,oa,ta,Ka,va,La,za,Ca,ua,ib,bb,mb,yb,ab,Ga,Za,Ub,Xb){super();this.ga=xa;this.Oe=fa;this.Ld=oa;this.xD=ta;this.ib=Ka;this.FI=va;this.oA=La;this.PV=za;this.DBa=Ca;this.NI=ib;this.JK=bb;this.UBa=mb;this.NTj=yb;this.Nn=ab;this.kd=Ga;this.pC=Za;this.QF=Ub;this.Kc=Xb;this.lik=0;this.FRe=!1;this.BJe=1E3;this.oik=3500;this.rwd="ContextIQSignalId";this.gSe=0;this.E_g=!0;this.Gna=()=>{this.DBa.reset();this.I1m()};this.l1c=(zb,Ib)=>
{for(const $a of Ib.Mj)zb=$a.intent,8===zb.type&&(0<=$a.pKb?(zb=zb.Kb.paragraph,Ib=this.Nn.uRd(zb,8,$a.cpBegin,$a.cpEnd),1<=Ib.count&&Ib.J(0)&&(Ib=zb.characterData.indexOf("@",Ib.J(0).Ac),this.Nn.gng(zb,$a.cpBegin,$a.cpEnd),Ib=new l.a(8,Ib,Ib+1,F.a.create()),this.Nn.IGa(zb,Ib))):this.BBa.Sv(O.a.I9e,!0,void 0,void 0,void 0,void 0))};ua&&ua.execute(zb=>this.Ola=zb);this.BBa=new ea.a;this.g2g=new la;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.M2h(!0);this.o2h();this.Ld.$Ze(this.l1c);
this.NTj.tob(this);this.hfa=[new f.a(Ra.a.veb,Ra.a.veb)]}onSessionClose(){}onSessionConnect(){this.M2h(!1);this.o2h()}onSessionDisconnect(){}get vHb(){return this.hfa}static PAk(xa){return xa.results&&0!==xa.results.length?xa.results[0].entityType===ba.EntityType.Topic:!1}static tBi(xa){return ra.ZLj()&&Oa.a.IVc(xa)&&this.PAk(xa)?!0:ra.YLj()?xa.isStealth:!1}static UQd(xa){var fa,oa;if(0!==(null===(fa=null===xa||void 0===xa?void 0:xa.results)||void 0===fa?void 0:fa.length))return null===(oa=null===
xa||void 0===xa?void 0:xa.results[0])||void 0===oa?void 0:oa.entityType}MQa(xa,fa){return Oa.a.MQa(xa,fa,Z.a.xfb)}t0a(xa,fa){xa=Oa.a.A8b(xa,!1,Z.a.xfb);if(!xa||!xa.contains(fa))return null;fa=this.Oe.rha(fa);return ra.tBi(null===fa||void 0===fa?void 0:fa.content)?Ra.a.BBd:Ra.a.veb}wob(xa){ra.ped()&&!this.Cv&&(this.Cv=xa,this.UBa.QCa((fa,oa)=>{fa=oa.paragraphNode;const ta=oa.rja;for(const Ka of oa.contents)1!=Ka.wG&&0!=Ka.wG||Oa.a.Twf(Ka.element,fa,Ka.intents,this.LFc,this.rIa,this.JK,this.Cv,ta,!1,
Z.a.xfb)}))}o2h(){const xa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),fa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),oa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),ta=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),Ka=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",
!1),va=ra.qed()&&ra.ACf?void 0:[Object.assign(new ba.CustomProp,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],La=Object.assign(new T.a,{parentPath:["Signal",ba.ClientConfigSignal.getTypeName()],items:[Object.assign(new W.a,{id:"ClientConfigSignal",body:Object.assign(new ba.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new ba.SessionConfig,{clientConfig:Object.assign(new ba.ClientConfig,{ecc:Object.assign(new ba.EccConfig,
{enabled:ra.sed()||ra.qed(),entities:[Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:va}),Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.Loop,enabled:xa,queryPrefix:["@"]})],bestMatch:Object.assign(new ba.BestMatchConfig,{enabled:ra.Xrg()}),scopes:Object.assign(new ba.ScopeConfig,{enabled:!1})}),flag:Object.assign(new ba.FlagConfig,
{enabled:ra.ped(),entities:[Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Loop,enabled:xa&&Ka}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Topic,enabled:ta}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Address,enabled:oa}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Satori,enabled:fa})]}),nudge:Object.assign(new ba.NudgeConfig,{enabled:!1}),prediction:Object.assign(new ba.PredictionConfig,{enabled:!1})})})})})]});this.oA.Uk().then(()=>
{this.PV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:La}));V.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}M2h(xa){const fa=Object.assign(new T.a,{parentPath:["Signal",ba.StartupSignal.getTypeName()],items:[Object.assign(new W.a,{id:"SessionStartupSignal",body:Object.assign(new ba.StartupSignal,{timestamp:Date.now()})})]});this.oA.Uk().then(()=>{xa&&this.cC();this.PV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,
{operation:fa}));V.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}cC(){ra.sed()&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Oe.ob(this,ba.EccResultAnnotation.getTypeName()),V.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Oe.ob(this,ba.UserInitiatedResultAnnotation.getTypeName()),V.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));
ra.ped()&&(this.Oe.ob(this,ba.FlagResultAnnotation.getTypeName()),V.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}NRo(xa,fa,oa,ta,Ka){const va=void 0===fa?!1:this.gSe>fa;this.Ri.aE&&!va&&(xa=this.s2h(xa),ta&&xa.suggestionGroups&&0<xa.suggestionGroups.length&&(xa.suggestionGroups[0].previewData=ta.substring(Ka+1,ta.length)),this.Ri.definition=xa,fa&&(this.gSe=fa));fa?(ta=Date.now(),oa=[Object.assign(new ha.a,{name:this.rwd,string:oa}),Object.assign(new ha.a,{name:"ContextIQMenuOpen",
bool:this.Ri.aE}),Object.assign(new ha.a,{name:"ContextIQStaleAnnotation",bool:va})],this.BBa.FZc("ContextIQUserInitUserPerceivedLatency",ta-fa,1,!0,void 0,oa)):V.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}s2h(xa){if(xa){var fa=[],oa=[];switch(xa.annotationType){case ba.UserInitiatedResultAnnotation.getTypeName():var ta=xa.content;if(!ta)return;for(var Ka of ta.results)fa=fa.concat(Ka.results);
ta=Z.a.P_a;break;case ba.EccResultAnnotation.getTypeName():Ka=xa.content;if(!Ka)return;for(const va of Ka.entityResults)fa=fa.concat(va.entities);ra.Xrg()&&(oa=null===(ta=Ka.treatments)||void 0===ta?void 0:ta.bestMatchEntries);ta=Z.a.P_a;break;case ba.FlagAnnotation.getTypeName():fa=fa.concat(xa.content.results);ta=Z.a.xfb;break;default:return}xa={annotationId:xa.id,results:fa,bestMatchResults:oa};if(fa=this.E_g)this.E_g=!1;return{...z.g,id:ta,suggestionGroups:[{type:ta,isContentPending:!1,contentData:xa,
isFirstInvoke:fa}]}}}async getPersonImageUrl(xa,fa){xa=new L.a(xa,"O365",fa,xa);if(this.Ola&&this.Ola.getPersonaIconPropertiesArray&&(xa=await this.Ola.getPersonaIconPropertiesArray([xa]),0<xa.length&&xa[0].authorImageURL))return xa[0].authorImageURL}static Gpe(){return ra.sed()||ra.ped()}static sed(){return ra.zpe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static qed(){return ra.zpe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",
!1)}static ped(){return ra.zpe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",!1)}static YLj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static XLj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CIQFlagsIgnoreOnce",!1)}static Xrg(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",
!1)}static ZLj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlagsLimitIsEnabled",!1)}static zpe(){return!J.a.Xca&&!J.a.E4}static get S7a(){return ra.nik}awo(xa){if(this.Ola){var fa={...z.g,id:Z.a.P_a,suggestionGroups:[{type:Z.a.P_a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},oa=!1;this.ga.e0(O.a.gUa)&&(oa=!0);this.Ri.Vja(xa,fa,this,!0,!1,null,this.Gna,null,!1,ta=>{ta.shouldIgnoreFocusEvent=Ka=>{var va;return this.FRe?!0:Ka===
(null===(va=this.kd.ve)||void 0===va?void 0:va.editingElement)};ta.getPersonImageUrl=this.getPersonImageUrl},oa,!1,this.g2g)}else V.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}jEh(){this.Ri.dismiss()}onKeyDown(xa){if(xa&&xa.Hb){switch(xa.Hb.keyCode){case M.a.yea:var fa=Na.bLj;break;case M.a.OL:fa=Na.End;break;case M.a.Ls:fa=Na.XMj;break;case M.a.l6:fa=Na.tNj;break;case M.a.Fw:fa=Na.Tab;break;case M.a.m6:fa=Na.cLj}void 0!==fa&&(xa.Hb.stopPropagation(),
xa.Hb.preventDefault(),this.g2g.onKeyPressed(fa))}}GB(xa,fa){if(xa&&xa.content&&fa===v.a.getTypeName()&&(xa.annotationType===ba.UserInitiatedResultAnnotation.getTypeName()||xa.annotationType===ba.EccResultAnnotation.getTypeName())){var oa=fa=void 0,ta=void 0,Ka=0,va=xa.parentPath.split("\\");if(va&&6===va.length)if(oa=va[5],va=Date.now(),oa in ra.S7a){clearTimeout(ra.S7a[oa].ZHo);fa=ra.S7a[oa].startTime;ta=ra.S7a[oa].rwo;Ka=ra.S7a[oa].MCd;delete ra.S7a[oa];const La=[Object.assign(new ha.a,{name:this.rwd,
string:oa})];this.BBa.FZc("ContextIQUserInitALLatency",va-fa,1,!0,void 0,La)}else V.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else V.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");this.NRo(xa,fa,oa,ta,Ka)}}get types(){return[Z.a.P_a,Z.a.xfb]}Lng(xa,fa){this.Ri.aE&&this.Ri.Lng(xa,fa)}get LFc(){return!P.SessionStatusManager.instance.Uj&&1!=H.AFrameworkApplication.ua.mode}rIa(xa){return xa&&
Oa.a.IVc(xa)?!sa.a.u2b(xa):!1}BN(xa){if(ra.Gpe()){var fa,oa;if(P.SessionStatusManager.instance.Uj||!this.LFc||!({annotation:fa,u0e:oa}=this.JK.iNd(xa.ml,xa.gif,this.rIa)).returnValue)return!1;if(fa.annotationType===ba.FlagAnnotation.getTypeName()){let ta=!1;this.ga.e0(O.a.gUa)&&(ta=!0);const Ka=this.s2h(fa);xa=this.Ri.Vja(oa,Ka,this,xa.sRa,xa.GOa,null,va=>{(null===va||void 0===va?void 0:va.cardType)===Z.a.xfb&&(null===va||void 0===va?0:va.tMf)&&this.BBa.Sv(O.a.jHd,!0,void 0,void 0,void 0,void 0,{chf:Da.Tried,
entityType:ra.UQd(fa.content)})},null,!1,null,ta);this.Ri.DPb({tMf:!0,cardType:Z.a.xfb});xa&&this.BBa.Sv(O.a.jHd,!0,void 0,void 0,void 0,void 0,{chf:Da.Seen,entityType:ra.UQd(fa.content)});return xa}return!1}}zNo(xa,fa){this.Oe.Vza(xa,70);const oa=this.pC.r6h(xa,0);if(oa){const ta=new a.a;ta.contentDescriptor=oa;ta.annotationType=xa.annotationType;ta.state=70;this.QF.setState(fa,ta)}}executeAction(xa,fa,oa,ta){var Ka,va,La,za=Date.now();if(!fa)return!1;var Ca=null===(Ka=this.Ri.definition)||void 0===
Ka?void 0:Ka.id;switch(xa.actionType){case z.b.Apply:this.Ri.DPb({cardType:Ca,tMf:!1});this.LUd(xa.descriptorData,fa,oa,ta);Ca===Z.a.xfb&&(fa={chf:Da.Kept,entityType:ra.UQd(null===(va=this.Oe.rha(xa.descriptorData.annotationId))||void 0===va?void 0:va.content)},this.BBa.Sv(O.a.jHd,!0,void 0,void 0,void 0,void 0,fa));this.jEh();break;case z.b.ClearSearch:this.FRe=!0;this.clearSearch(fa,oa,ta,!1);this.Ri.aE&&(this.Oqj(),Ca=k.ParagraphReader.text(fa).substring(0,oa+1),this.hmf(fa,Ca,oa,za));this.FRe=
!1;break;case z.b.Retry:this.Ri.aE&&(this.Oqj(),Ca=k.ParagraphReader.text(fa).substring(0,ta),this.hmf(fa,Ca,oa,za));break;case z.b.OpenEditorPane:if(32!==this.ga.processAction(O.a.gUa,2))return V.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",xa.actionType),!1;break;case z.b.IgnoreOnce:if(!ra.XLj)return!1;oa=this.Oe.rha(null===(La=xa.descriptorData)||void 0===La?void 0:La.annotationId);this.zNo(oa,fa.Lc);za=this.Kc.Pc(3);try{za.Db(fa),fa.gl(16,!0)}finally{za&&
za.dispose()}this.BBa.Sv(O.a.jHd,!0,void 0,void 0,void 0,void 0,{chf:Da.Rejected,entityType:ra.UQd(oa.content)});this.Ri.DPb({tMf:!1,cardType:Ca});this.Ri.dismiss();break;default:return V.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",xa.actionType),!1}return!0}hmf(xa,fa,oa,ta){var Ka,va;const La=oa.toString(),za=xa.id.toString(),Ca=za+"-"+La;var ua=++this.lik;const ib=Ca+"-"+ua;ua=(ua=x.FormattingReader.QQd(xa,oa,k.ParagraphReader.textLength(xa)))?
x.FormattingReader.language(ua):H.AFrameworkApplication.lcid;ua=null!==(va=null===(Ka=N.a.qg(ua))||void 0===Ka?void 0:Ka.LOd)&&void 0!==va?va:"";fa.length>this.BJe&&(oa-=fa.length-this.BJe,fa=fa.slice(-this.BJe));const bb=Object.assign(new T.a,{parentPath:["Signal",ia.a.getTypeName(),za,La,Ca],items:[Object.assign(new W.a,{id:ib,body:Object.assign(new ia.a,{languageId:ua,startOfSentence:!0,text:fa,timestamp:Date.now(),userInitQuery:!0})})]});this.oA.Uk().then(()=>{this.PV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,
{operation:bb}));V.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const mb=[Object.assign(new ha.a,{name:this.rwd,string:ib})];this.BBa.FZc("ContextIQUserInitSignalGenerationLatency",Date.now()-ta,1,!0,void 0,mb)});"@"===fa.slice(-1)&&oa===fa.length-1&&(Ka=this.Nn.uRd(xa,8,oa,oa))&&0===Ka.count&&(Ka=new l.a(8,oa,oa+1,F.a.create()),this.Nn.IGa(xa,Ka));xa=setTimeout(()=>{this.Pto(ib)},this.oik);ra.S7a[ib]={startTime:ta,rwo:fa,MCd:oa,ZHo:xa}}EUo(){if(this.Ri.aE&&this.Ri.definition&&
this.Ri.definition.suggestionGroups&&this.Ri.definition.suggestionGroups[0]){const xa=this.Ri.definition;xa.suggestionGroups[0].isContentPending=!0;this.Ri.definition=xa}}Oqj(){this.Ri.definition={...z.g,id:Z.a.P_a,suggestionGroups:[{type:Z.a.P_a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}Pto(xa){if(xa in ra.S7a){var fa=ra.S7a[xa].startTime;fa=void 0===fa?!1:this.gSe>fa;!fa&&this.Ri.aE&&(this.Ri.definition={...z.g,id:Z.a.P_a,suggestionGroups:[{type:Z.a.P_a,isContentPending:!1,
errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});xa=[Object.assign(new ha.a,{name:this.rwd,string:xa}),Object.assign(new ha.a,{name:"ContextIQMenuOpen",bool:this.Ri.aE}),Object.assign(new ha.a,{name:"ContextIQStaleSignal",bool:fa})];this.BBa.FZc("ContextIQUserInitALTimeout",1,0,!0,void 0,xa)}}LUd(xa,fa,oa,ta){var Ka=xa.type;switch(Ka){case ba.EntityType.File:this.insertHyperlink(fa,oa,ta,xa.fileName,xa.url+"?web=1");break;case ba.EntityType.People:ra.ACf?
this.insertHyperlink(fa,oa,ta,xa.displayName,"mailto:"+xa.primaryEmailAddress):this.dNo(xa,fa,oa,ta);break;case ba.EntityType.Loop:this.FBm(xa,fa,oa,ta);break;case ba.EntityType.Address:this.GAm(xa,fa,oa,ta);break;case ba.EntityType.Satori:Ka="https://www.bing.com/search?q="+xa.title.replace(" ","+");this.insertHyperlink(fa,oa,ta,xa.title,Ka);break;case ba.EntityType.Topic:this.insertHyperlink(fa,oa,ta,xa.title,xa.url);break;default:V.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",
Ka)}}dNo(xa,fa,oa,ta){const Ka=xa.primaryEmailAddress,va=new L.a(Ka,"O365",xa.displayName,Ka);this.Ola.checkUserAccess(va).then(La=>{La.UserCanWrite?(V.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.oUc(fa,oa,ta,va)):this.$Aj(va,fa,oa,ta)},()=>{V.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.$Aj(va,fa,oa,ta)})}$Aj(xa,fa,oa,ta){this.Ola.grantUsersAccess([xa]).then(Ka=>{let va=!1;Ka.Details&&
(va=Ka.Details.Result[0].UserCanWrite);va?(V.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.oUc(fa,oa,ta,xa)):(V.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(fa,oa,ta,!0))},()=>{V.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}oUc(xa,fa,oa,ta){this.Nn.gng(xa,fa,oa);this.BBa.Sv(O.a.I9e,!0,void 0,void 0,void 0,void 0);this.FI.oUc(xa,fa,oa,ta.DisplayName,ta.Email)}insertHyperlink(xa,
fa,oa,ta,Ka){if(xa){var va=new y.GraphTransaction(15),La=ta+" ";try{va.Db(xa);this.Nn.gng(xa,fa,oa);this.BBa.Sv(O.a.I9e,!0,void 0,void 0,void 0,void 0);this.Ld.Ge(m.a.createTextRange(xa,fa,oa),La);const za=K.a.sac(Ka);this.xD.qG(m.a.createTextRange(xa,fa,fa+ta.length),za,!1,!1,!1);this.ib.Bc(r.SelectionFactory.ne(xa,fa+La.length))}finally{va&&va.dispose()}}else V.ULS.sendTraceTag(509612897,3034,15,"Paragraph node is undefined/null.")}FBm(xa,fa,oa,ta){if(fa){var Ka=new y.GraphTransaction(15);try{Ka.Db(fa);
this.Ld.Ge(m.a.createTextRange(fa,oa,ta),"");this.ib.Bc(r.SelectionFactory.ne(fa,oa));const va=xa.id;va===Z.a.w6m?this.ga.processAction(O.a.uUc,2):va===Z.a.t6m?this.ga.processAction(O.a.hUc,2):va===Z.a.v6m?this.ga.processAction(O.a.kXd,2):V.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{Ka&&Ka.dispose()}}else V.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}GAm(xa,fa,oa,ta){if(fa){var Ka=new y.GraphTransaction(15);try{Ka.Db(fa);const va=
K.a.sac(xa.url);this.xD.qG(m.a.createTextRange(fa,oa,ta),va,!1,!1,!1);this.ib.Bc(r.SelectionFactory.ne(fa,ta));const La=this.Oe.rha(xa.annotationId);this.Oe.Vza(La,60)}finally{Ka&&Ka.dispose()}}else V.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(xa,fa,oa,ta){if(xa){var Ka=new y.GraphTransaction(15);ta||(fa+=1);try{Ka.Db(xa),this.Ld.Ge(m.a.createTextRange(xa,fa,oa),""),this.ib.Bc(r.SelectionFactory.ne(xa,fa))}finally{Ka&&Ka.dispose()}}else V.ULS.sendTraceTag(529413333,
3034,15,"Paragraph node is undefined/null.")}I1m(){this.NI.execute(xa=>{xa.logActivity("CIQ_AtInvoke",null)})}}ra.ACf=!1;ra.nik={};Object(D.a)(ra,"ContextIQIntentProvider",G.a,[292,334])},1666:function(D,I,c){D=c(0);var l=c(332),f=c(249);class a{constructor(x,y,m,r,z,v,G){this.Yi=x;this.focusManager=y;this.eF=m;this.clickInputManager=r;this.Jjc=z;this.YZi=v;this.bPh=G;this.gR=this.zCb();this.eF.J7(this.gR.name);this.clickInputManager.L1b(this.gR.name,this.Yi,this.gR.hVa);x=this.R$e();this.focusManager.ffb(this.Yi,
this.gR,x)}focus(){this.focusManager.kg(this.gR.name)}get isFocused(){return this.focusManager.currentScope===this.gR}addIsFocusChangedHandler(x){this.gR.K7(()=>x(!0));this.gR.UZa(()=>x(!1))}Hnh(x){this.gR.SZa(x)}dispose(){var x;this.focusManager.J6a(this.gR.name);this.focusManager.currentScope||this.focusManager.kg(null!==(x=this.bPh)&&void 0!==x?x:f.a.Un)}zCb(){var x;const y=this.focusManager.ae(this.Jjc);y.parent=null!==(x=this.YZi)&&void 0!==x?x:f.a.xp;y.hVa=!0;y.R6c=!0;y.$H=!0;return y}R$e(){const x=
new l.DOMFocusListing(()=>this.Yi);x.Mm(8);return x}}Object(D.a)(a,"EditorAiFocusScopeImpl",null,[]);c.d(I,"a",function(){return k});class k{constructor(x,y,m,r){this.options=x;this.focusManager=y;this.eF=m;this.clickInputManager=r}registerScope(x){return new a(x,this.focusManager,this.eF,this.clickInputManager,this.options.Jjc,this.options.YZi,this.options.bPh)}}Object(D.a)(k,"EditorAiFocusManagerImpl",null,[])},1675:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.handler=
null}}Object(D.a)(l,"SetAnnotationResultCallbackParameters",null,[])},1677:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static get ahc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}l.LEb="fontInfoTaskPane";l.experienceId="modernfontpicker";Object(D.a)(l,"FontInfoPaneConstants",null,[])},1678:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.endDate=this.startDate=null}}Object(D.a)(l,"CommentTaskSchedule",null,[])},1679:function(D,
I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(80);class f{static get hd(){return null!=f.$wg?f.$wg:f.$wg=new l.a}static Mvk(a){f.hd.addHandler(f.PSi,a)}static swk(a){f.hd.addHandler(f.nVi,a)}}f.PSi="OnCopyComment";f.nVi="OnPasteComment";Object(D.a)(f,"CommentEventsManager",null,[])},1680:function(D,I,c){c.d(I,"a",function(){return l});const l={Yif:"TasksFeatureUsage",AFo:"TaskExperienceDegraded",Hke:"TaskCreate",Ike:"TaskEngagement"}},1683:function(D,I,c){c.d(I,"c",function(){return x});c.d(I,
"b",function(){return y});c.d(I,"a",function(){return m});var l=c(75),f=c(7),a=c(2),k=c(34);const x=r=>{if(!r)return null;let z;try{z=k.b(r)}catch(v){z=null,f.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",v)}return z},y=(r,z)=>{let v=[];if(r.breadcrumbs&&0<r.breadcrumbs.length)v=r.breadcrumbs;else{const G=r.service_info;G&&G.friendly_service_name&&Array.add(v,G.friendly_service_name);r.display_path&&Array.addRange(v,r.display_path)}return v.join(z?
" \u00ab ":" \u200f\u00bb ")},m=(r,z=!1)=>{if(!r)return[];if(!r.documents)return f.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!r.documents.items)return f.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];r=r.documents.items;const v=new l.a;for(let F=0;F<r.length;F++){const H=r[F];var G=H.web_url;if(!G){f.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!H.url){f.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}G=String.format("{0}?web=1",H.url)}const L=
{};L.DocumentUrl=G;L.MruId=H.mru_id;{G=H;let J=G.title;J?(G.extension&&(J=String.format("{0}.{1}",J,G.extension)),G=J):(f.ULS.sendTraceTag(578352837,202,15,"empty file title"),G="")}L.FileName=G;L.IsPinned=H.is_pinned;L.Path=y(H,a.AFrameworkApplication.isRtl);z&&(L.App=H.app,L.TimeStamp=H.time_stamp);v.add(L)}return v.toArray()}},1684:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.Callback="action";Object(D.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1685:function(D,
I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1842),I);f(c(1843),I);f(c(1844),I);f(c(1845),I);f(c(1846),I);f(c(1847),I)},1686:function(D,I,c){var l=this&&this.aB||(Object.create?
function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1848),I);f(c(1849),I)},1687:function(D,I,c){var l=this&&this.aB||(Object.create?
function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1850),I);f(c(1851),I)},1689:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);class l{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(D.a)(l,"CalloutButtonProps",null,[])},1690:function(D,I,c){function l(){a||(f.Health.instance.addQosPillar("AsyncCollab"),a=!0)}c.d(I,"a",function(){return l});var f=c(86);let a=!1},1691:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a=0,k=!1){this.vHj=!1;this.paragraphNode=f;this.cSf=a;this.vHj=k}}Object(D.a)(l,"ReviewActionArgs",null,[])},1695:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);class l{constructor(f=0,a=0,k=0,x=0,y="",m="",r="",z="",v="0pt",G="0pt",F="0pt",H="0pt"){this.borderTopStyle=f;this.borderRightStyle=a;this.borderBottomStyle=k;this.borderLeftStyle=x;this.borderTopColor=y;this.borderRightColor=m;this.borderBottomColor=r;this.borderLeftColor=z;this.borderTopWidth=v;this.borderRightWidth=G;this.borderBottomWidth=F;this.borderLeftWidth=H}}Object(D.a)(l,"TableCellBorderProperties",null,[])},1696:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f=
"",a="",k="",x=""){this.ISk=f;this.HSk=a;this.FSk=k;this.GSk=x}}Object(D.a)(l,"TableCellMarginProperties",null,[])},1700:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(43);c(6);var f=c(7);class a{constructor(k,x){this.k5m=()=>{f.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.Sxa=(y,m)=>{f.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",m)};this.Dub=x}Phj(k,x,
y,m=null,r=null,z=null){if(k){var v=new l.GraphTransaction(0);v.Db(k);k.setValue(x,y);v.dispose();try{this.Dub(15,!1,m||this.k5m,r||this.Sxa,z,null,null)}catch(G){f.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",G.message)}}else f.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(D.a)(a,"AutoSaveParamsUpdateService",null,[399])},1701:function(D,I,c){c.d(I,"a",function(){return f});
D=c(0);var l=c(7);class f{constructor(a){this.Hxj=a}ge(a,k){if(a){var x=this.Hxj();a();a=this.Hxj();l.ULS.sendTraceTag(555307094,345,50,`${k}-${a-x}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}Object(D.a)(f,"PerfLogger",null,[480])},1702:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.paragraphNode=f;this.state=a}}Object(D.a)(l,"ReviewCompletedArgs",null,[])},1703:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.index=f;this.count=
a}}Object(D.a)(l,"DesignerReviewPosition",null,[])},1704:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(l||(l={}));Object(D.b)("BlueDotHighlightContextType",l);class f{constructor(a,k,x=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=l.empty){this.es=a;this.DGc=k;this.iJo=x;this.nJk=y}}Object(D.a)(f,"BlueDotHighlightContext",null,[])},1705:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.rv=
this.Go=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.wxa=!1;this.CMb=this.WKb=5;this.gna=this.XE=this.uIc=0;this.b_k=!1}}Object(D.a)(l,"SectionPropertiesData",null,[])},1706:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(193);class l extends c.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(D.a)(l,"ErrorViewProps",c.a,[])},1707:function(D,I,c){c.d(I,"a",
function(){return l});D=c(0);c=c(193);class l extends c.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(D.a)(l,"MultiActionButtonProps",c.a,[])},1708:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaInfo",null,[])},1709:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);class l{}Object(D.a)(l,"PersonaIdentifiers",null,[])},1710:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);I=c(1144);c=c(1078);class l{}l.k1=[new I.a(1440,1440,1440,1440),new I.a(720,720,720,720),new I.a(1440,1440,1080,1080),new I.a(1440,1440,2880,2880),new I.a(1440,1440,1800,1800)];l.Dqa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),new c.a(11907,16839),new c.a(8391,11907)];Object(D.a)(l,"PredefinedPageProperties",null,[])},1712:function(D,I,c){c.d(I,"a",function(){return F});
D=c(0);var l=c(203),f=c(2),a=c(22),k=c(20),x=c(18),y=c(1331),m=c(255),r=c(439),z=c(7),v=c(457),G=c(687);class F{constructor(H,L,J,M,P,N,K,O,V,W,T,Y,ba,Z){this.nr=H;this.nvb=L;this.Ga=J;this.Lp=M;this.Mr=P;this.rE=N;this.dba=K;this.P$a=O;this.L$a=V;this.N$a=W;this.O$a=T;this.Kab=Y;this.Lab=ba;this.Lod=Z}build(H,L,J,M){const P=new l.QueryStringBuilder("WordOart.ashx");f.AFrameworkApplication.aga(P);P.ye(v.a.nodeId,L.id.toString());L=x.ImageReader.X7l(L,H.Lc);P.ye(G.a.lJd,L?L.ja(r.a.jTf,""):"");P.ye(G.a.width,
this.Lp.toString());P.ye(G.a.height,this.Mr.toString());P.ye(G.a.Z2c,this.dba.toString());P.ye(G.a.Z0n,y.a[this.nvb]);L=this.Ga.$("WordEditorImageCropIsEnabled");P.ye(G.a.dNh,L.toString());L&&(P.ye(G.a.top,this.P$a.toString()),P.ye(G.a.bottom,this.L$a.toString()),P.ye(G.a.left,this.N$a.toString()),P.ye(G.a.right,this.O$a.toString()));L=this.Ga.$("WordEditorImageRotateIsEnabled");P.ye(G.a.qej,L.toString());L&&(P.ye(G.a.angle,this.rE.toString()),P.ye(G.a.flipH,this.Kab?"true":"false"),P.ye(G.a.flipV,
this.Lab?"true":"false"));P.ye(G.a.Q_f,J?"true":"false");P.ye(G.a.strict,this.Lod?"true":"false");this.Ga.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.nr&&this.nr.pyf&&P.ye(G.a.Y2a,this.nr.pyf);(H=H.Ui())?(P.ye(v.a.fileId,H.vr),P.ye(v.a.cellId,H.Am.toString())):z.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",P.toString());H=a.a.instance.Oa("Box4.IFeatureHelper");H=!!H&&H.isFeatureEnabled(51);P.ye(G.a.Tql,"true");P.ye(G.a.nAm,H.toString());
P.ye(G.a.JUh,"true");H&&P.ye(G.a.z0i,H.toString());P.ye(G.a.qAm,"true");m.a.instance.rAb(P);J&&M&&!k.a.Kt&&P.WI(G.a.Afb,window.self.devicePixelRatio.toString());P.ye(G.a.qvh,"true");return P.toString()}}Object(D.a)(F,"WordOartEndpointUrlBuilder",null,[])},1713:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(16);class f{constructor(a,k){this._id=a;this.Gb=k;this.JOk=k.ja(l.a.sia,0);this.HOk=k.ja(l.a.ria,0)}getId(){return this._id}}Object(D.a)(f,"GraphicsEditorImageContainer",null,[607])},
1714:function(D,I,c){c.d(I,"a",function(){return K});D=c(0);var l=c(60),f=c(2),a=c(124),k=c(203),x=c(18),y=c(520),m=c(730),r=c(6),z=c(155),v=c(46),G=c(16),F=c(41),H=c(439),L=c(117),J=c(1005),M=c(7),P=c(687),N=c(1712);class K{constructor(O,V,W,T,Y,ba){this.properties=null;this.nr=V;this.Rj=T;this.Ga=Y;this.iA=ba}UTo(O,V,W){O.tR||(V.setValue(r.a.FFc,O.pAk),V.setValue(r.a.PMd,O.D7b));this.pKj(O,V,W)}VTo(O,V,W){V.setValue(r.a.WMb,O.sYo);x.ImageReader.kSd(V,W.Lc,!1)!==O.nYf&&V.zg(r.a.R9d,z.a.at,z.a.pqa,
v.a.l9a);if(O.D8d)V.setValue(G.a.Fda,l.a.Ff(O.D8d));else{var T=this.yKh(O.nYf,O.oYf,O.extension);W.Lc.Su(T);V.setValue(G.a.Fda,T.id)}O.Hoe?V.setValue(v.a.l9a,l.a.Ff(O.Hoe)):O.XIj&&(T=this.yKh(O.XIj,O.Fqg,O.extension),W.Lc.Su(T),V.setValue(v.a.l9a,T.id));V.ja(r.a.S9d,"")!==O.C5c&&(""!==O.C5c?V.setValue(r.a.S9d,O.C5c):V.removeProperty(r.a.S9d));0===O.yva&&0===O.Ava&&0===O.zva&&0===O.xva||this.Rj.pcg(V,O.Ava,O.xva,O.yva,O.zva);void 0!==O.lockAspectRatio?V.setValue(r.a.lY,O.lockAspectRatio):V.setValue(r.a.lY,
!1);O.TJk&&(this.OPb(V,r.a.dja,O.Hwh),this.OPb(V,r.a.zqa,O.borderStyle),this.OPb(V,r.a.wHa,O.borderColor));void 0!==O.altTextDescription&&V.setValue(r.a.kY,O.altTextDescription);this.OPb(V,F.a.alphaModFix,O.alphaModFix);this.pKj(O,V,W);O=y.a.instance.Zhf(V);V.setValue(r.a.Gda,O)}yKh(O,V,W){const T=new J.a(524345);T.setValue(H.a.jTf,O);T.setValue(H.a.Pgc,O);T.setValue(v.a.iAl,l.a.Ff(O).guid);T.setValue(r.a.Doi,V);T.setValue(H.a.ljf,f.AFrameworkApplication.rootQuerySignature);T.setValue(v.a.RYh,W);
return T}pKj(O,V,W){O.tR?(this.properties=V,V.setValue(F.a.tR,O.tR),O.EFc&&V.setValue(F.a.QBd,O.EFc),V.setValue(F.a.Mwa,O.V1o),V.setValue(F.a.Nwa,O.Qrm),V.setValue(F.a.YPa,O.V6b),V.setValue(r.a.Is,O.Is),V.setValue(r.a.Pgb,O.K6b),V.setValue(v.a.s0,0),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&V.setValue(L.a.jPa,!1),V.setValue(L.a.w5,0),this.OPb(V,F.a.L3a,O.Kxa),this.Vmh(V,W,!1,!0),this.QVk(V)):(V.setValue(r.a.DFa,O.DFa),V.setValue(z.a.at,
O.DFa?O.hBn:""),O.Afb&&V.setValue(z.a.IHb,O.Afb),V.setValue(r.a.Is,O.Is),V.setValue(r.a.Pgb,O.K6b),V.setValue(r.a.Gda,O.JH),V.setValue(G.a.sia,a.a.xG(O.width)),V.setValue(G.a.ria,a.a.xG(O.height)),V.setValue(v.a.B_f,a.a.xG(O.width)),V.setValue(v.a.z_f,a.a.xG(O.height)),V.setValue(z.a.BFa,-1),V.setValue(z.a.AFa,-1),V.setValue(G.a.yxa,!0),V.setValue(r.a.DJ,O.rotationAngle),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&V.setValue(L.a.jPa,
!1),V.setValue(v.a.s0,0),O.DFa&&this.Vmh(V,W,!0,!1),this.RVk(V));5!=x.ImageReader.vi(V)?this.TVk(V):this.PVk(V);this.OPb(V,r.a.kSc,O.flipH);this.OPb(V,r.a.ySc,O.flipV)}F1n(O,V,W,T,Y=null){O=this.Rj.A1n(O.ek,V,W,T);null==O?M.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):Y&&Y(O)}Vmh(O,V,W,T){let Y=!1;var ba=this.iA.ru(V);ba&&ba.rf(r.a.MGf)&&(Y=!0);ba=x.ImageReader.mca(O);V=(new N.a(this.nr,x.ImageReader.vi(O),this.Ga,x.ImageReader.iF(O),x.ImageReader.EG(O),x.ImageReader.h0(O),
x.ImageReader.Uib(O),Math.max(ba.top,0),Math.max(ba.bottom,0),Math.max(ba.left,0),Math.max(ba.right,0),x.ImageReader.jRd(O),x.ImageReader.GFb(O),Y)).build(V,O,!0,!1);T&&(T=new k.QueryStringBuilder(V),T.ye(P.a.sWd,"true"),V=T.toString());O.setValue(r.a.Rgb,V);W&&m.a.PPb(O,1,f.AFrameworkApplication.K,this.nr)}OPb(O,V,W){void 0===W||null===W?O.removeProperty(V):O.setValue(V,W)}RVk(O){O.removeProperty(F.a.tR);O.removeProperty(F.a.QBd);O.removeProperty(F.a.Mwa);O.removeProperty(F.a.Nwa);O.removeProperty(F.a.YPa);
O.removeProperty(F.a.A5d);O.removeProperty(F.a.vpl);O.removeProperty(F.a.L3a)}TVk(O){O.removeProperty(r.a.R9d);O.removeProperty(r.a.WMb);O.removeProperty(G.a.Fda);O.removeProperty(r.a.S9d)}PVk(O){O.removeProperty(r.a.PMd);O.removeProperty(r.a.FFc);O.removeProperty(F.a.tR);O.removeProperty(F.a.QBd)}QVk(O){O.removeProperty(r.a.FFc);O.removeProperty(z.a.at);O.removeProperty(G.a.sia);O.removeProperty(G.a.ria);O.removeProperty(r.a.Gda);O.removeProperty(z.a.pqa);O.removeProperty(r.a.PMd);O.removeProperty(r.a.DJ)}}
Object(D.a)(K,"GraphicsEditorImageEditor",null,[580])},1715:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupApplicationInterface",null,[])},1716:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k,x,y,m){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=f;this.url=a;this.spWebUrl=k;this.uniqueId=x;this.size=y;this.lastModified=m}}Object(D.a)(l,"FileInfo",null,[])},1723:function(D,
I,c){c.d(I,"a",function(){return f});D=c(0);I=c(232);var l=c(111);class f extends I.a{constructor(){super();this.CellId=this.FileId=null}el(){return 37}static construct(a){const k=new f;k.FileId=a.Ui().vr;k.CellId=l.a(a.Lc.id);return k}}Object(D.a)(f,"LastSavedRevisionRequest",I.a,[])},1743:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(7);c=c(258);class f extends c.a{constructor(a,k,x,y){super(f.e3e);this.Al=a;this.aj=k;this.view=x;this.options=y}initialize(){super.initialize();const a=
this.options.iPb==this.aj.tba(this.view.ed,{pP:this.options.pP,Gca:this.options.Nac,Toa:this.options.Lac,oP:this.options.oP});a&&!this.mia&&l.ULS.sendTraceTag(557114691,3028,50,this.EO(this.Al,!0,`satisfiedIfBlank=${this.options.iPb}`));this.xg(a)}Nd(){super.Nd()}}f.e3e="BlankDocumentConditionId";Object(D.a)(f,"BlankDocumentCondition",c.a,[])},1747:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.alt=this.ariaLabel=this.src=null;this.src=f}}Object(D.a)(l,"ImageProps",
null,[])},1749:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);var l=c(60),f=c(8),a=c(12),k=c(7),x=c(15),y=c(1544),m=c(1530),r=c(1539),z=c(1533);class v{constructor(G,F,H,L,J,M,P){this.aTi=(N,K)=>{K&&K.data&&K.data.ml&&(N=new z.a(K.data.ml,1,!0),this.Exe.BN(N))};this.dWi=(N,K)=>{K&&K.data&&K.data.ml&&K.data.ml.node&&this.QZj.dPi(this.Exe,K.data.ml.node)};this.njc=(N,K,O)=>{N=K.view.qe?K.view:null;if(!N||!N.mb)return 8;N=N.mb.hb.J(0).Pa;return f.ParagraphReader.Wb(N.node)?1===O?32:2===O?(O=
new z.a(N,2,!1),this.Exe.BN(O),32):2:2};this.t5b=(N,K,O)=>{var V,W;N=K.view.qe?K.view:null;if(!N||!N.mb)return 8;N=null===(V=N.mb.hb.J(0))||void 0===V?void 0:V.Pa;return N&&N.node?f.ParagraphReader.Wb(N.node)?1===O?32:2===O?(O=N.node,V=f.ParagraphReader.text(N.node),K=N.cpBegin,N=N.cpEnd-K,0<N&&(V=V.substr(K,N)),N=Math.floor(Math.random()*v.afj),K=l.a.create(),k.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:K,
["textLength"]:V.length,["paragraphLength"]:f.ParagraphReader.textLength(O),["paragraphRole"]:null===(W=this.w7.FA(O))||void 0===W?void 0:W.role,["styleId"]:N},this.G9j.pRd()),W=[new y.c(new m.d(K,3,null,null,!1,N,V),O,N,V,T=>{this.DVb.U4c(r.a.create(T));this.DVb.nic({role:27,paragraphNode:T,placeholder:!1})},3)],this.qek.sCd(W),32):2:2:8};this.ga=G;this.Exe=F;this.QZj=H;this.DVb=L;this.qek=J;this.w7=M;this.G9j=P}initialize(){this.ga.fb(x.a.njc,a.a.view,this.njc,1028);this.DVb.Nwk(this.dWi);this.DVb.Ivk(this.aTi);
this.ga.fb(x.a.t5b,a.a.view,this.t5b,4)}dispose(){this.ga.Vv(x.a.t5b,a.a.view,this.t5b);this.DVb.WZn(this.aTi);this.DVb.s_n(this.dWi);this.ga.Vv(x.a.njc,a.a.view,this.njc)}}v.afj=5;Object(D.a)(v,"DesignerActionListener",null,[1022,10])},1751:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(D.a)(l,"CritiqueAction",null,[])},1760:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.ePj="PageContentOrigin";
this.SMj=500;this.sug=["resize"];this.xHo=f=>()=>{!this.Gld&&f&&(this.Gld=setTimeout(()=>this.mDh(),this.SMj),f())}}addHandler(f){this.tOb();this.qLa=this.xHo(f);this.Htn(this.qLa);this.sug.forEach(a=>{window.addEventListener(a,this.qLa)})}tOb(){var f;this.mDh();null===(f=this.hlh)||void 0===f?void 0:f.disconnect();this.sug.forEach(a=>{window.removeEventListener(a,this.qLa)});this.qLa=void 0}mDh(){this.Gld&&(clearTimeout(this.Gld),this.Gld=void 0)}Htn(f){this.hlh=new MutationObserver(f);(f=document.getElementsByClassName(this.ePj)[0])&&
this.hlh.observe(f,{attributes:!0,attributeFilter:["style"]})}}Object(D.a)(l,"EditorAiWindowEventManager",null,[])},1761:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(38),f=c(11);class a{constructor(k){var x,y;this.lm=k;this.gS=null;this.gS=null===(y=null===(x=this.lm)||void 0===x?void 0:x.zd)||void 0===y?void 0:y.container}addHandler(k){this.gS&&(this.tOb(),this.qLa=k,l.a.addHandler(this.gS,f.a.scroll,this.qLa),l.a.addHandler(this.gS,f.a.resize,this.qLa))}tOb(){this.gS&&this.qLa&&
(l.a.removeHandler(this.gS,f.a.scroll,this.qLa),l.a.removeHandler(this.gS,f.a.resize,this.qLa))}}Object(D.a)(a,"EditorAiPositionManager",null,[])},1762:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===
x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1957),I);f(c(1958),I);f(c(1959),I);f(c(1960),I);f(c(1961),I);f(c(1962),I)},1764:function(D){var I="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(I){var c=new Uint8Array(16);D.exports=function(){I(c);return c}}else{var l=Array(16);
D.exports=function(){for(var f=0,a;16>f;f++)0===(f&3)&&(a=4294967296*Math.random()),l[f]=a>>>((f&3)<<3)&255;return l}}},1765:function(D){for(var I=[],c=0;256>c;++c)I[c]=(c+256).toString(16).substr(1);D.exports=function(l,f){f=f||0;return[I[l[f++]],I[l[f++]],I[l[f++]],I[l[f++]],"-",I[l[f++]],I[l[f++]],"-",I[l[f++]],I[l[f++]],"-",I[l[f++]],I[l[f++]],"-",I[l[f++]],I[l[f++]],I[l[f++]],I[l[f++]],I[l[f++]],I[l[f++]]].join("")}},1766:function(D,I,c){c.d(I,"a",function(){return l});const l={dyj(f){return"function"===
typeof f?{execute:f}:f}}},1768:function(D,I,c){var l=c(0),f=c(1829),a=c(365),k=c(608),x=c(60),y=c(22),m=c(2045),r=c(2),z=c(107),v=c(92),G=c(1622),F=c(185);class H{constructor(bc,Bc){this.CommentId=bc;this.ResolveState=Bc}}Object(l.a)(H,"CommentProperties",null,[]);var L=c(582),J=c(2048),M=c(2049),P=c(1663),N=c(2047),K=c(192),O=c(1827);class V extends O.a{constructor(bc,Bc="",ad="",zd="",Xd=!1){super(bc,Bc,ad,zd,Xd);this.DateUtc=null}}Object(l.a)(V,"CommentReactionUser",O.a,[]);var W;(function(bc){bc[bc.like=
1]="like"})(W||(W={}));Object(l.b)("ReactionType",W);var T;(function(bc){bc[bc.first=0]="first";bc[bc.done=0]="done";bc[bc.undone=1]="undone";bc[bc.addComment=2]="addComment";bc[bc.deleteComment=3]="deleteComment";bc[bc.editComment=4]="editComment";bc[bc.addReaction=5]="addReaction";bc[bc.removeReaction=6]="removeReaction";bc[bc.last=7]="last"})(T||(T={}));Object(l.b)("CommentChangeType",T);var Y=c(241),ba=c(1457),Z=c(247);class ea{constructor(){this.seh=this.Hgh=!1;this.klk=[]}get unc(){return this.klk}get WQb(){return this.Hgh}set WQb(bc){this.Hgh=
bc;for(const Bc of this.unc)Bc.WQb=bc}get KPb(){return this.seh}set KPb(bc){this.seh=bc;for(const Bc of this.unc)Bc.KPb=bc}D8a(bc){for(const Bc of this.unc)bc=Bc.D8a(bc);return bc}}Object(l.a)(ea,"AggregateCommentTaskPersonTransformer",null,[928]);var ha=c(7),la=c(135),ia=c(1619);class sa{constructor(bc,Bc){this.C8j=new Z.a(()=>Bc.D8a(bc.value))}USl(){return new Date}k0a(bc,Bc,ad){if(0===bc)throw ha.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const zd=la.a.create().toString();ad=new ia.a(bc,this.C8j.value,ad,zd,!1);ad.commentId=Bc;ha.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",bc);return ad}}Object(l.a)(sa,"HistoryRecordFactory",null,[930]);var Oa=c(1678);class Ra{constructor(bc,Bc,ad,zd,Xd,Gd){this.isLossy=bc;this.title=Bc;this.assignees=ad;this.schedule=zd;this.completion=Xd;this.priority=Gd}}Object(l.a)(Ra,"CommentTaskState",null,[]);class Na{constructor(){this.commentId=
null}}Object(l.a)(Na,"HistoryItem",null,[]);class Da{constructor(bc,Bc,ad,zd,Xd,Gd,Ze){this.HEe=!1;if(1!==Bc.type)throw Error.argument("createRecord");this.ctc=ad;this.Zsc=zd;this.$sc=Xd;this.O6g=1;this.vmd=bc;this.E$j=Gd;this._state=new Ra(!1,this.ctc,Ze,new Oa.a,this.$sc,this.Zsc);this._history=[];this.sLh(Bc)}w5b(bc,Bc){if(1!==bc.type)throw Error.argument("createRecordTemplate");const ad=Da.Ydm(bc,this.O6g);this.O6g++;return Object.assign(new ia.a(Bc,bc.user,bc.time,ad),{commentId:bc.commentId})}get gEi(){return this.history[this.history.length-
1]}get Jli(){return this.state.completion===this.$sc}get Ili(){return this.state.priority===this.Zsc}get Kli(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Lli(){return this.state.title===this.ctc}sLh(bc){bc=Object.assign(new Na,{commentId:bc.commentId,records:[bc]});this.history.push(bc)}U3h(bc){let Bc=-1;for(let ad=0;ad<this.state.assignees.length;ad++)if(this.vmd.equals(this.state.assignees[ad],
bc)){Bc=ad;break}return Bc}Foo(bc){const Bc=this.gEi,ad=Bc.records[Bc.records.length-1];return this.vmd.equals(ad.user,bc.user)&&Bc.commentId===bc.commentId&&ad.time.getTime()===bc.time.getTime()?!0:!1}kYo(bc){switch(bc.type){case 2:-1===this.U3h(bc.assignee)&&this.state.assignees.push(bc.assignee);break;case 3:const Bc=this.U3h(bc.assignee);0<=Bc&&this.state.assignees.splice(Bc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=bc.schedule;break;case 6:this.state.completion=
bc.completion;break;case 9:this.state.title=bc.title;break;case 10:this.state.priority=bc.priority;break;case 0:this.state.isLossy=!0;break;case 1:ha.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.HEe=!0;break;case 8:this.HEe=!1;break;case -1:ha.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}bc.isLossy&&(this.state.isLossy=!0);this.Foo(bc)?this.gEi.records.push(bc):this.sLh(bc)}get isDeleted(){return this.HEe}get state(){return this._state}get history(){return this._history}KYl(bc){if(!bc)return this.history;
const Bc=Array.clone(this.history),ad=Bc[0],zd=ad.records.shift();if(!this.E$j){var Xd=this.w5b(zd,4);ad.records.unshift(Xd)}!bc.Jli&&this.Jli&&(Xd=this.w5b(zd,6),Xd.completion=this.$sc,ad.records.unshift(Xd));!bc.Ili&&this.Ili&&(Xd=this.w5b(zd,10),Xd.priority=this.Zsc,ad.records.unshift(Xd));!bc.Kli&&this.Kli&&(Xd=this.w5b(zd,5),Xd.schedule=new Oa.a,ad.records.unshift(Xd));!bc.Lli&&this.Lli&&(Xd=this.w5b(zd,9),Xd.title=this.ctc,ad.records.unshift(Xd));bc.isDeleted&&(bc=this.w5b(zd,8),ad.records.unshift(bc));
return Bc}static Ydm(bc,Bc){return"Synthesized-"+bc.recordId+"-"+Bc}}Object(l.a)(Da,"CommentTaskStateBuilder",null,[]);class ra{constructor(bc,Bc,ad,zd){this.id=bc;this.commentId=Bc;this.currentState=ad;this.history=zd}}Object(l.a)(ra,"CommentTaskItem",null,[]);var xa=c(1618);const fa=bc=>{const Bc=new xa.a(bc.UserId,bc.Provider,bc.DisplayName,bc.Email);Bc.IsCurrentUser=bc.IsCurrentUser;return Bc};var oa=c(1824);class ta{static clone(bc){bc=ta.AYk(bc.extensions);return new oa.a(bc)}static bEh(bc){return bc?
ta.clone(bc):null}static isEmpty(bc){return!bc.extensions||!bc.extensions.count}static Xe(bc){return!bc||ta.isEmpty(bc)}static AYk(bc){if(!bc)return null;const Bc=new a.a;bc.forEach((ad,zd)=>{Bc.add(ad,zd);return!0});return Bc}}Object(l.a)(ta,"ExtensionListExtensions",null,[]);class Ka{static clone(bc){var Bc=fa(bc.user);Bc=new ia.a(bc.type,Bc,bc.time,bc.recordId,bc.isLossy);Bc.commentId=bc.commentId;Bc.anchorExtensionList=ta.bEh(bc.anchorExtensionList);Bc.recordExtensionList=ta.bEh(bc.recordExtensionList);
bc.assignee&&(Bc.assignee=fa(bc.assignee));if(bc.schedule){var ad=bc.schedule;const zd=new Oa.a;zd.startDate=ad.startDate;zd.endDate=ad.endDate;Bc.schedule=zd}Bc.completion=bc.completion;Bc.title=bc.title;Bc.priority=bc.priority;Bc.undoId=bc.undoId;return Bc}}Object(l.a)(Ka,"HistoryRecordExtensions",null,[]);class va{constructor(bc,Bc,ad,zd,Xd,Gd,Ze,Fe=!1){this.vmd=bc;this.Usd=Bc;this.GMa=ad;this.xYj=zd;this.ctc=Xd;this.Zsc=Gd;this.$sc=Ze;this.lod=Fe}idl(bc,Bc,ad,zd=null){if(!bc)throw ha.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Bc)throw ha.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!ad||!ad.length)throw ha.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==ad[0].type)throw ha.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Xd=[],Gd=null,Ze=this.wHn(ad);
for(var Fe of ad)if(!Ze.contains(Fe.recordId))if(ad=this.hii(Fe.commentId,zd),ad=this.zJl(Fe,ad),1===ad.type){let ag=[];this.lod&&Gd&&Gd.state&&(ag=Gd.state.assignees);Gd=new Da(this.vmd,ad,this.ctc,this.Zsc,this.$sc,this.lod,ag);Xd.push(Gd)}else if(Gd)Gd.kYo(ad);else throw ha.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");
Ze=null;Fe=[];if(Gd){Gd.isDeleted||(Ze=Gd.state);Gd=null;for(var bf of Xd)Xd=bf.KYl(Gd),Array.addRange(Fe,Xd),Gd=bf}bf=this.hii(Bc,zd);Ze&&(Ze.completion=this.J1k(Bc,zd,Ze.completion));return new ra(bc,bf,Ze,Fe)}y2h(bc,Bc,ad,zd=null){if(!Bc)throw ha.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(ad&&!bc)throw ha.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Xd=[],Gd=this.GMa.USl();if(ad){var Ze=
this.GMa.k0a(1,bc,Gd);Xd.push(Ze)}Ze=null;if(Bc.assigneeUpdate){if(!Bc.assigneeUpdate.assigneesToAdd||!Bc.assigneeUpdate.assigneesToRemove)throw ha.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Fe=0;Fe<Bc.assigneeUpdate.assigneesToAdd.length;Fe++){var bf=this.tLh(2,Bc.assigneeUpdate.assigneesToAdd[Fe],bc,Gd);bf&&Xd.push(bf)}for(Fe=0;Fe<Bc.assigneeUpdate.assigneesToRemove.length;Fe++)(bf=this.tLh(3,Bc.assigneeUpdate.assigneesToRemove[Fe],
bc,Gd))&&Xd.push(bf)}else Bc.assignee&&(ad||(Ze=this.GMa.k0a(4,bc,Gd),Xd.push(Ze)),Fe=this.GMa.k0a(2,bc,Gd),Ze=this.Usd.D8a(Bc.assignee),Fe.assignee=Ze,Xd.push(Fe));Bc.title?(zd=this.GMa.k0a(9,bc,Gd),zd.title=Bc.title,Xd.push(zd)):ad&&zd&&(Fe=this.GMa.k0a(9,bc,Gd),Fe.title=this.xYj.Ngm(zd,Ze),Xd.push(Fe));if(Bc.schedule){if(Bc.schedule.startDate>Bc.schedule.endDate)throw ha.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");zd=this.GMa.k0a(5,bc,Gd);
zd.schedule=Bc.schedule;Xd.push(zd)}if(void 0!==Bc.completion&&null!==Bc.completion){zd=Bc.completion;if(0>zd||100<zd)throw ha.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");ad||ha.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",zd);ad=this.GMa.k0a(6,bc,Gd);ad.completion=zd;Xd.push(ad)}if(void 0!==Bc.priority&&null!==Bc.priority){Bc=Bc.priority;if(0>Bc||10<Bc)throw ha.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),
Error.argumentOutOfRange("priority");bc=this.GMa.k0a(10,bc,Gd);bc.priority=Bc;Xd.push(bc)}return Xd}tLh(bc,Bc,ad,zd){if(2!==bc&&3!==bc)return ha.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;bc=this.GMa.k0a(bc,ad,zd);bc.assignee=this.Usd.D8a(Bc);return bc}wHn(bc){const Bc=new k.a,ad=new k.a;for(let zd=bc.length-1;0<=zd;zd--){const Xd=bc[zd],Gd=ad.contains(Xd.recordId);Gd||-1!==Xd.type||(ad.contains(Xd.undoId)?ha.ULS.sendTraceTag(578670598,
327,50,"Multiple Undo records attempting to undo the same record."):ad.add(Xd.undoId));if(Gd||-1===Xd.type)Bc.contains(Xd.recordId)?ha.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Bc.add(Xd.recordId)}return Bc}zJl(bc,Bc){const ad=Ka.clone(bc);ad.commentId=Bc;ad.user=this.Usd.D8a(bc.user);ad.assignee=this.Usd.D8a(bc.assignee);return ad}J1k(bc,Bc,ad){let zd=ad;bc&&Bc&&(({value:Bc}=Bc.Fc(bc)).returnValue?(zd=Bc.ResolveState?
100:100===ad?0:ad,zd!==ad&&ha.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",bc)):ha.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",bc));return zd}hii(bc,Bc){let ad=bc;bc&&Bc&&(({value:Bc}=Bc.Fc(bc)).returnValue?ad=Bc.CommentId:(ha.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",bc),ad=bc));return ad}}
Object(l.a)(va,"CommentTaskTranslatorImpl",null,[929]);var La=c(1050),za=c(1222);class Ca{constructor(){this.Xgb=CommonUIStrings.l_Ellipsis}Ngm(bc,Bc){if(!bc)throw ha.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var ad=G.a.xFb(bc)}catch(bf){throw ha.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var zd=bc=0,Xd=0;const Gd=RegExp("\\s+","g"),Ze=new Sys.StringBuilder;
for(var Fe of ad.ops)Fe.attributes&&Fe.attributes.atmention&&Fe.attributes.atmention.email&&Bc&&(ad=Fe.attributes.atmention.email,0<ad.length&&(ad===Bc.UserId||ad===Bc.Email||ad===La.a.yhb(Bc.UserId))&&(zd=bc,Xd=zd+Fe.insert.length)),ad=Fe.insert.replace(Gd," "),bc+=ad.length,Ze.append(ad);!Xd&&Bc&&ha.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Bc.Provider);Bc=Ze.toString().trimEnd();bc=Bc.length;255<bc?(Fe=(255-(Xd-zd))/2,0>zd-Fe?(bc=za.a.instance.K1a(Bc,255-this.Xgb.length),
Xd=Bc.substring(0,bc)+this.Xgb,bc="Trimmed End"):Xd+Fe>bc?(zd=za.a.instance.c2a(Bc,bc-255+this.Xgb.length),Xd=this.Xgb+Bc.substring(zd,bc),bc="Trimmed Start"):(zd=za.a.instance.c2a(Bc,zd-Fe+this.Xgb.length),bc=za.a.instance.K1a(Bc,Xd+Fe-this.Xgb.length),Xd=this.Xgb+Bc.substring(zd,bc)+this.Xgb,bc="Trimmed Both")):(bc="No Trim",Xd=Bc);ha.ULS.sendTraceTag(592998804,327,50,bc);return Xd}}Object(l.a)(Ca,"ContentExtractor",null,[]);class ua{constructor(bc,Bc){this.w4j=bc;this.D8j=Bc;this.KPb=this.WQb=
!1}D8a(bc){if(!bc)return null;if(void 0===bc.UserId||null===bc.UserId)throw ha.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(bc.IsCurrentUser||!this.w4j.equals(this.D8j.value,bc))return bc;bc=fa(bc);bc.IsCurrentUser=!0;return bc}}Object(l.a)(ua,"EnsureIsCurrentUserSetTransformer",null,[928]);class ib{constructor(){this.KPb=this.WQb=!1}D8a(bc){if(!bc)return null;if(void 0===bc.UserId||null===bc.UserId)return bc;if(!bc.Email||""===bc.Email){let Bc;
if(Bc=La.a.yhb(bc.UserId))return bc=fa(bc),bc.Email=Bc,bc}return bc}}Object(l.a)(ib,"RestoreEmailTransformer",null,[928]);class bb{constructor(){this.KPb=this.WQb=!1}D8a(bc){if(!bc)return null;if(void 0!==bc.UserId&&null!==bc.UserId)return bc;switch(this.WQb?this.KPb?2:1:0){case 0:if(void 0===bc.UserId||null===bc.UserId)throw ha.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");bc=fa(bc);break;case 1:if(void 0===bc.Id||null===bc.Id)throw ha.ULS.sendTraceTag(593368214,
327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===bc.Email||null===bc.Email)throw ha.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Bc=bb.i_i(bc.Id,bc.Email,null);if(!Bc||""===Bc)throw ha.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var ad=r.AFrameworkApplication.K.kb("HostAuthType")||"";if("aad"!==ad.toLowerCase()||Bc.startsWith("S::")){if("msa"===ad.toLowerCase())throw ha.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");ha.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",ad)}else throw ha.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");bc=new xa.a(Bc,"AD",bc.DisplayName,bc.Email);break;case 2:if(void 0===bc.UserPrincipalName||null===bc.UserPrincipalName)throw ha.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==bc.SuggestionSubtype&&null!==bc.SuggestionSubtype)if("OrganizationUser"===bc.SuggestionSubtype)Bc="AD";else throw ha.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",bc.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw ha.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");ad=bb.i_i(bc.Id,bc.UserPrincipalName,bc.AadObjectId);if(!ad||""===ad)throw ha.ULS.sendTraceTag(593368205,327,
10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Bc&&!ad.startsWith("S::"))throw ha.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");bc=new xa.a(ad,Bc,bc.Name,bc.UserPrincipalName);break;default:throw ha.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return bc}static i_i(bc,Bc,ad){if(!Bc||""===Bc)return ha.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),bc;if(ad&&""!==ad)return"S::"+
Bc+"::"+ad;if(!bc||""===bc)return ha.ULS.sendTraceTag(593368217,327,50,"Missing ID"),bc;if(bc.startsWith("S::"))return bc;if(-1!==bc.indexOf("@")){ad=bc.split("@");if(la.a.isValid(ad[0]))return"S::"+Bc+"::"+ad[0];ha.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return bc}}Object(l.a)(bb,"UserIdCanonicalizationTransformer",null,[928]);class mb{constructor(bc,Bc,ad=!1,zd=!1){this.h0j=bc;this.zMg=Bc;this.p9j=ad;this.lod=zd}f8k(){const bc=new La.a;var Bc=new Z.a(mb.xSl);
const ad=new ea;this.zMg&&(ad.unc.push(new bb),ad.unc.push(new ib));this.h0j&&ad.unc.push(new ua(bc,Bc));ad.WQb=this.zMg;ad.KPb=this.p9j;Bc=new sa(Bc,ad);const zd=new Ca;return new va(bc,ad,Bc,zd,mb.nhl,mb.ehl,mb.fhl,this.lod)}static xSl(){const bc=new xa.a(r.AFrameworkApplication.K.kb("PresenceUserId")||"",r.AFrameworkApplication.K.kb("PresenceProvider")||"",r.AFrameworkApplication.userName||"");bc.IsCurrentUser=!0;return bc}}mb.nhl="";mb.ehl=5;mb.fhl=0;Object(l.a)(mb,"CommentTaskTranslatorFactory",
null,[919]);var yb=c(42),ab=c(164),Ga=c(13),Za=c(5),Ub=c(51),Xb=c(9),zb=c(174),Ib=c(48),$a=c(23),Hb=c(736),Ya=c(37),Sa=c(8),Eb=c(1217),Jb=c(17),vb=c(26),ac=c(76),dc=c(287),Cc=c(128),Ec=c(528),rc=c(204),hb=c(392),fb=c(715),Nb=c(370),Fb=c(63),nb=c(236),pb=c(12),Xa=c(251),Pb=c(6),Va=c(703),tb=c(593),cb=c(355),Mb=c(54),mc=c(609),Cb=c(110),Ja=c(82),Wa=c(223),xb=c(1478),ic=c(34),qc=c(1052);class Lc{create(){return new qc.a}}Object(l.a)(Lc,"CommentNodeFactory",null,[349]);var Ac=c(1208),gd=c(1072),Md=c(1518),
ie=c(1581);class hf{constructor(){this.nMc=this.O$c=null;this.JLd=this.qje=!1;this.gOa=this.zDa=null}}Object(l.a)(hf,"CommentAnchorParaNodesStatus",null,[]);var Ue=c(1411),Kd=c(16);class Wc extends Ue.a{constructor(bc){super();this.Pek=bc}get index(){return 2}run(){this.Pek()}kFh(bc,Bc){Bc.property===Kd.a.$e&&this.IY()}}Object(l.a)(Wc,"CommentContentPropertyTracker",Ue.a,[]);var Zc=c(1509);class Nc{constructor(bc,Bc){this.hhc=bc;this.nsi=Bc}}Object(l.a)(Nc,"CommentIntentIdentifier",null,[]);var ge=
c(1041),$d=c(1223),te=c(195),Se=c(161);class tc extends Ue.a{constructor(bc,Bc){super();this.p$a=new tb.a(new ge.a);this.R0b=new $d.a(Zc.c);this.S0b=new te.ScriptSharpLegacyMap;this.Mak=bc;this.Obk=Bc;this.S0b.add(Pb.a.Gba,1);this.S0b.add(Pb.a.EH,0);this.S0b.add(Kd.a.$e,0);this.S0b.add(Pb.a.RQ,2)}get index(){return 4}run(){let bc="";for(const Bc of this.p$a)if(this.Mak(Bc),this.R0b.nb(Bc.id))for(const ad of this.R0b.J(Bc.id))bc+="_"+ad;this.Obk(bc);this.p$a.clear();this.R0b=new $d.a(Zc.c)}x0k(bc,
Bc){bc=Bc.property;if(bc===Pb.a.Gba||bc===Pb.a.EH||bc===Kd.a.$e||Se.App.$oe&&bc===Pb.a.t4b||bc===Pb.a.RQ)this.p$a.add(Bc.node),this.S0b.nb(bc)&&(this.R0b.nb(Bc.node.id)||this.R0b.add(Bc.node.id,new mc.a),this.R0b.J(Bc.node.id).add(this.S0b.J(bc))),this.IY();Md.a.XNh.has(Bc.node.id.toString())&&bc===Pb.a.cF&&ha.ULS.sendTraceTag(521484097,327,15,"Durable ID changed of a Cut Pasted Comment")}J0k(bc,Bc){Bc.property===Kd.a.vo&&(bc=Bc.node,bc.AIb&&(this.p$a.add(bc),this.IY()))}HFo(bc,Bc){this.p$a.add(Bc.node);
this.IY()}}Object(l.a)(tc,"CommentNodeTransactionCompletedProcessor",Ue.a,[]);var dd=c(1583),Ed=c(1623);class Qd{constructor(){this.Tye=new Map;this.WBe=new Map}Ppk(bc,Bc){if(this.Tye.has(bc))throw Error("DuplicateDurableId");if(this.WBe.has(Bc))throw Error("DuplicateGuardId");this.Tye.set(bc,Bc);this.WBe.set(Bc,bc)}VXl(bc){return this.Tye.get(bc)}E7h(bc){return this.WBe.get(bc)}}Object(l.a)(Qd,"CommentIdMapper",null,[]);var Ad=c(15),Oe=c(1532),pf=c(1680),Fh=c(1584),Ig=c(115),Jh=c(114);c.d(I,"a",
function(){return xg});class xg extends f.a{constructor(bc,Bc,ad,zd,Xd,Gd,Ze,Fe,bf,ag,Xf,vf,Bg,ob,$b,Uc,Pd,ze,Me,af,Hg,wi,Wi,Mf,Zg,zf=null,ii){super();this.Bx=bc;this.rIe=Bc;this.mIe=ad;this.Kc=zd;this.HXj=Xd;this.jwb=Gd;this.mXe=Ze;this.Urc=Fe;this.Ga=bf;this.od=ag;this.Nn=Xf;this.BYb=vf;this.XZ=Bg;this.qYb=ob;this.G3g=$b;this.Mg=Uc;this.Lm=Pd;this.IVa=ze;this.$i=Me;this.u2=af;this.mK=Hg;this.qZa=wi;this.DBc=Wi;this.Yrc=[];this.aWa=[];this.BUe=new a.a(0);this.zud=new a.a;this.Gxd=new tb.a(cb.a.jh());
this.$Te=new tb.a(cb.a.jh());this.yjd=null;this.Vtb=new a.a;this.xxe=!1;this.rhd=new k.a;this.hZg=!1;this.Jve=new Set;this.gve=0;this.MZ=[];this.XVb=2;this.rCa=new a.a(!1);this.ezc=new k.a;this.Stc=new Map;this.mhd=new Qd;this.nhd=0;this.GXj=5;this.KLb=(Af,jg)=>{Af=jg.paragraphNode;for(const Rf of jg.contents)this.Oha(Rf.element,Af,Rf.intents,Rf.wG)};this.X0c=(Af,jg)=>{if(Af.Lc.id.equals(this.vd.id)){this.IVa.MHa(7);var Rf=Af.getValue(Pb.a.EH),lj=Af.getValue(Pb.a.cF).toString();Rf=this.Mg.fhb?this.Stc.has(lj)?
this.Stc.get(lj):lj:Rf;Rf=this.UD(Rf);if(jg){if(Rf){this.Px&&this.Px.Af===Rf.id&&(ha.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.mK.logKpiFailure(Oe.a.uGd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Oe.a.fGd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));jg=Rf.Af?"The comment is a reply":"";lj=Zc.k(Af,x.a.nil).toString();const Qh=Zc.h(Af,x.a.nil).toString();if(this.rhd.contains(Rf.id)&&!Md.a.LIm(Rf.Y0a)){this.rhd.remove(Rf.id);const ei=
+new Date-+Rf.date;ha.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",Zc.a(Rf),ei,lj,Qh,jg)}else ha.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Zc.a(Rf),lj,Qh,jg);this.Zi.LKc(Rf);this.PPh(Af.id)}}else if(!Rf){this.mK.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();y.a.instance.Oa("WordEditor.Comments.EditorCommentManager")||ha.ULS.sendTraceTag(525379405,
327,10,"comment Manager resolve failed");if(this.Mg.oDb&&!this.$i.yY){this.u2.i$("OnCommentInit",Object.assign(new dd.a,{BTi:()=>{this.GUf(Af);this.lOb()}}));return}this.Mg.Yq||this.$i.yY||this.u2.i$("OnCommentInit");this.FKn(Af)||this.GUf(Af)}this.xxe=!0}};this.lOb=(Af=null)=>{this.Mg.uRb&&this.lqi();this.Mg.uRb&&this.hul();this.mJ.nOb(void 0,Af);this.IVa.MHa(8)};this.kXi=(Af,jg,Rf)=>{if(Af.Lc.id.equals(this.vd.id)){var lj=Af.ja(Pb.a.taskId,"");if(""===lj)ha.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");
else{if(jg)if(this.$Te.add(lj),lj=this.qYb.value.hhi(Af),void 0!==lj&&null!==lj)this.Vtb.remove(lj);else{ha.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Gxd.add(lj),jg=this.qYb.value,Af=jg.hhi(Af),void 0!==Af&&null!==Af)for(this.Vtb.J(Af)?this.Vtb.Z(Af,lj):this.Vtb.add(Af,lj),Af=jg.jhi(lj),jg=0;jg<Af.length;jg++){var Qh=Af[jg].commentId;Qh&&(Qh=Number.parseInvariant(Qh),this.Vtb.J(Qh)||this.Vtb.add(Qh,lj))}else{ha.ULS.sendTraceTag(591971723,
3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}Rf&&this.lOb()}}};this.kSo=Af=>{if(Md.a.wYd(Af)){const Rf=this.f0(Af.id.toString());if(Rf){const lj={text:Rf.text,done:Rf.done};var jg=Za.GraphIterator.eb(Af);Rf.text=this.nFb(jg);this.QIi(Rf.text);Rf.done=Af.ja(Pb.a.Gba,!1);Af.hasProperty(Pb.a.RQ)&&(jg=(jg=Af.getValue(Pb.a.RQ))?ic.b(jg||""):null,Rf.usersByReactionType=jg,Fh.a.cCh(Rf.usersByReactionType),this.EUk(Rf));this.nSo(Af,Rf);Rf.Af||this.sSo(Af,
Rf);!this.Mg.gva||!this.EE||this.Px&&this.Px.id===Rf.id||this.EE.fireEvent(10,{comment:Rf,ARi:lj})}}else this.od.isFeatureEnabled(116)&&72===Af.type?this.kXi(Af,!1,!1):this.mSo(Af)};this.iul=()=>{const Af=this.QPd();for(this.Yrc.sort((jg,Rf)=>{const lj=jg.ja(Pb.a.wM,null),Qh=Rf.ja(Pb.a.wM,null);if(!lj&&Qh)return-1;if(!Qh&&lj)return 1;jg.hasProperty(Pb.a.ADa)&&Rf.hasProperty(Pb.a.ADa)?(jg=jg.getValue(Pb.a.ADa),Rf=Rf.getValue(Pb.a.ADa),Rf=jg<Rf):(jg=new Date(jg.getValue(Pb.a.AIc)),Rf=new Date(Rf.getValue(Pb.a.AIc)),
Rf=jg<Rf);return Rf?-1:1});this.Yrc.length;){const jg=this.Yrc[0];Af.qjb(jg)&&(Af.wj(jg),this.Zi.addComment(this.dId(Af),null),this.Zi.mode=1);Array.removeAt(this.Yrc,0)}if(Af.Ub(1))for(;Af.Jf(1););this.od.isFeatureEnabled(116)&&this.qYb.value.lhi();this.xxe&&(this.lOb(),this.xxe=!1)};this.Cll=Af=>{1===Af&&(Wa.WoncaApp.Zke.HJh(),this.BYb.value.o7a(!0,"CommentInboundFailed"));this.XZ.aI(Ub.a.p$e,this.RDi)};this.Yha=Af=>{if(!this.Mg.Yq||Af.done)return!1;if(Af.Xq===m.a.beingCreated)return!0;if(Af.objectId){if(this.rHm(Af))return!1;
if(!this.LNm(Af.objectId)||Af.Af)return!0;for(const jg of this.$O())if(jg.Af===Af.id)return!0}return!1};xg.lK=zf;this.Vqd=new tb.a(cb.a.jh());!this.Mg.oDb&&this.Mg.Yq||qc.a.cTa(this.X0c);Zg.QCa(this.KLb);Mf&&(Mf.Fx((Af,jg)=>{Af=Zc.o(this.MZ,jg.node.id);0<this.MZ.length&&(!Af||Af===this.MZ.length-1)&&(this.XVb=1,this.MZ=[])}),ii.execute(Af=>{this.EE=Af}),r.AFrameworkApplication.XH&&(r.AFrameworkApplication.le("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.Mg.hHk&&this.$ok()))}$ok(){z.a.instance.Xb(new v.a(5,
1,0,()=>{const bc=this.Kc.Pc(7);bc.Db(this.JJa);var Bc=Xb.App.za.jb.Yc;Bc&&(Bc=zb.PageNavigator.instance.hP(Bc),Bc=Za.GraphIterator.eb(Bc),Bc.Qd(),Bc.Qd(),Bc.Qd(),Bc.Qd(),Ib.a.instance.Bc($a.SelectionFactory.gJ(Bc.currentNode,0,0)),Bc=new G.a,Bc.Jca("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),this.JCb(Ib.a.instance.hb.lb,"Microsoft Word",Bc),bc.dispose(),yb.a("ShareTUICommentCreated"),
ha.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get mJ(){return this.Zi}get f0e(){return this.$g}get RDi(){return null!=this.kCg?this.kCg:this.kCg=Object.assign(new Hb.a,{X7:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Wma:1})}get Zs(){return this.Kc}get mx(){return this.Bx.value}get vd(){return this.mx.vd}get JJa(){return this.rIe.value}get CDa(){return this.mIe.value}get mb(){return this.jwb.value}get TY(){return this.Ga.kb("PresenceUserId")}get i6a(){return this.Ga.kb("PresenceProvider")}Oha(bc,
Bc,ad,zd){if(ad&&this.Px&&(!this.Px||!this.Px.Af)){var Xd=!1;for(const Gd of ad)if(3===Gd.type)switch(Xd=!0,ad=Zc.n(this.MZ,Gd.id),-1<ad&&(this.MZ[ad].hhc=Bc.id),bc.classList.add(Ya.a.bLd),zd){case 1:bc.classList.add(Ya.a.Gff);break;case 0:bc.classList.add(Ya.a.Hff)}Xd||bc.classList.remove(Ya.a.bLd,Ya.a.Hff,Ya.a.Gff);this.IVa.MHa(3)}}Pnf(bc=!1){return this.mXe.THl(this.$g,r.AFrameworkApplication.va.mode,Bc=>!this.Mg.KQb||!bc||this.Yha(Bc))}snf(bc){return this.mXe.hOl(this.Zi.model.$O(),r.AFrameworkApplication.va.mode,
bc)}csf(bc){if(!bc||!bc.Af)return bc;bc=bc.Af;for(let Bc=0;Bc<this.$g.length;Bc++)if(this.$g[Bc].id===bc)return this.$g[Bc];return null}e8k(){const bc=[];if(this.od.isFeatureEnabled(116)){var Bc=this.qYb.value;for(const ad of Bc.lhi())(Bc=this.O2h(ad))&&bc.push(Bc)}return bc}swm(bc){if(!this.aWa)throw F.a.invalidOperation("UpdateContent must have been called before this.");for(let Bc=0;Bc<this.aWa.length;Bc++)if(this.aWa[Bc].id===bc)return Bc;return-1}lqi(){const bc=new Ja.a;for(const ad of this.$g)if(ad.objectId&&
ad.Qwa){var Bc=x.a.Ff(ad.objectId);if((Bc=this.vd.Eb(Bc))&&Bc.hasProperty(Pb.a.cF))if(Bc=Bc.getValue(Pb.a.cF).toString(),bc.nb(Bc)){const zd=bc.J(Bc).CommentId;this.mOj(zd,ad,Bc)}else bc.add(Bc,new H(ad.id,ad.done))}this.yjd=bc}mOj(bc,Bc,ad){bc!==Bc.Qwa?(ha.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",ad,Bc.objectId,Bc.Qwa,bc),this.mK.logKpiFailure(Oe.a.w4b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:Oe.a.v4b,isInternal:!0})):ha.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",ad,Bc.Qwa,Bc.objectId)}O2h(bc){const Bc=this.G3g.value;var ad=this.qYb.value;const zd=ad.t$b(bc);if(void 0===zd||null===zd)return ha.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",bc),null;ad=ad.jhi(bc);try{return Bc.idl(bc,zd.toString(),ad,this.yjd)}catch(Xd){return ha.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",Xd.message),null}}S5h(bc=!1,Bc=!1){const ad=new k.a,zd=Bc?Zc.j():new Set;this.rCa.keys.forEach(Xd=>{zd.has(Xd)||bc&&this.rCa.J(Xd)||ad.add(Xd);return!0});return ad}jSd(){if(!this.$g)return 0;let bc=0;for(const Bc of this.$g)Bc.Af||bc++;return bc}AVc(bc){var Bc,ad;return(null===(ad=null===(Bc=this.Px)||void 0===Bc?void 0:Bc.yz)||void 0===ad?void 0:ad.draftId)===bc}Spk(bc){var Bc;if(bc.Xq===m.a.beingCreated){if(this.Zi.mode=2,this.nbb=bc,
this.mb.hb){var ad=this.mb.hb.lb;if(ad&&ad.Pa){ad=this.VWo(ad);for(var zd=0;zd<ad.length;zd++){var Xd=ad.J(zd).node;if(!Sa.ParagraphReader.Wb(Xd)||!(-1!==ad.J(zd).cpBegin&&-1!==ad.J(zd).cpEnd||-1!==ad.J(zd).Ij&&-1!==ad.J(zd).np))continue;var Gd=-1===ad.J(zd).cpBegin?ad.J(zd).Ij:ad.J(zd).cpBegin;const Ze=-1===ad.J(zd).cpEnd?ad.J(zd).np:ad.J(zd).cpEnd,Fe=x.a.create();this.Nn.IGa(Xd,new Eb.a(3,Gd,Ze,Fe));this.MZ.push(new Nc(Xd.id,Fe));this.xqk(null===(Bc=bc.yz)||void 0===Bc?void 0:Bc.draftId,Xd,Gd,ad)}}}}else this.b5f(bc);
ad=({index:Bc}=this.kme(bc)).returnValue;zd=null;if(!bc.Af){Xd=this.S5h();bc.Xq!==m.a.beingCreated&&(zd=this.xbm(bc),Xd.remove(bc.objectId));Xd=({index:Gd}=this.u3l(zd,Xd)).returnValue;Bc=-1<Gd?Gd:Bc;Gd=0;if(Xd)for(;Bc<this.$g.length&&this.$g[Bc].Af;)Bc++;if(!Xd&&this.Mg.Yq&&bc.Xq===m.a.beingCreated)for(Xd=0;Xd<Bc;Xd++)this.$g[Xd].Af||this.$g[Xd].done||Gd++;this.KBo(bc,Gd)}ad&&(Array.insert(this.$g,Bc,bc),this.Mg.gva&&this.EE&&bc.Xq!==m.a.beingCreated&&(bc.Af?this.EE.fireEvent(10,{comment:bc,changeType:"replyAdded"}):
this.EE.fireEvent(11,{comment:bc})),this.Vpk(bc,zd))}VWo(bc){if(this.Mg.xxl){var Bc=Jb.SelectionEditor.Fxl(bc);Bc&&(this.mb.Bc(Bc),bc=Bc)}else Jb.SelectionEditor.Il(bc)&&(Bc=Jb.SelectionEditor.c0(bc.Pa,!1))&&(this.mb.Bc(Bc),bc=Bc);return bc}xqk(bc,Bc,ad,zd){this.Mg.contentNavigationApiEnabled&&bc&&Bc&&zd&&this.DBc.AZe({contentId:bc,containerContentType:0,d$:{Bd:ad,aN:Bc.Bl}},{selection:zd})}Vpk(bc,Bc){if(this.Mg.contentNavigationApiEnabled&&bc&&!bc.Af&&bc.Xq!==m.a.beingCreated){var ad=this.vd.Eb(bc.objectId);
if(ad){var zd=Zc.k(ad,x.a.nil);zd=this.vd.Eb(zd);zd=Md.a.rwa(zd,ad.id,!1);(null===zd||void 0===zd?0:zd.Kb)&&(null===zd||void 0===zd?0:zd.paragraph)?this.DBc.AZe({contentId:bc.id,containerContentType:0,d$:{Bd:zd.Kb.cp,aN:zd.paragraph.Bl}},{selection:Bc}):ha.ULS.sendTraceTag(520717896,327,10,`comment object id: ${ad.id},
        commentStartRangeObject Valid: ${!!zd},
        containingProperties Valid: ${!(null===zd||void 0===zd||!zd.Kb)},
        paragraph valid: ${!(null===zd||void 0===zd||!zd.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}hva(bc){super.hva(bc);this.rhd.add(bc.id)}r1n(bc,Bc){this.Mg.contentNavigationApiEnabled&&this.DBc.q1n(bc,Bc)}KBo(bc,Bc){this.Mg.Yq&&bc.Xq===m.a.beingCreated&&bc.yz&&this.BUe.Z(bc.yz.draftId,Bc)}Hfm(bc){return this.BUe.J(bc)}e9i(bc){this.BUe.remove(bc)}OZl(bc){let Bc=0,ad=0;for(let zd=0;zd<this.$g.length;zd++){if(this.$g[zd].id===bc.id){ad=zd;break}this.$g[zd].Af||this.$g[zd].done||Bc++}return{returnValue:ad,uHo:Bc}}etf(bc){var Bc=null,ad=this.vd.Eb(bc);
bc=Md.a.jca(ad,this.vd,!0);ad=Md.a.jca(ad,this.vd,!1);bc&&ad&&(Bc=$a.SelectionFactory.ne(bc.Kb.paragraph,bc.Kb.cp),Bc=$a.SelectionFactory.Dy(Bc,vb.a.Oc(ad.Kb.paragraph,ad.Kb.cp)));bc&&ad||this.mK.logKpiFailure(Oe.a.w4b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return Bc}xbm(bc){bc=x.a.Ff(bc.objectId);return this.etf(bc)}S6f(bc,Bc){var ad=this.vd.Eb(bc);if(ad){var zd=this.vd.Eb(Zc.k(ad));ad=this.vd.Eb(Zc.h(ad));if(zd===ad)for(ad=0;ad<zd.qa.length&&!zd.qa.J(ad).JNo(bc,Bc);ad++);}}u3l(bc,
Bc){let ad=-1;var zd=null;bc||(bc=this.mb.hb?this.mb.hb.lb:null);if(!bc||!bc.Pa)return{returnValue:null,index:ad};const Xd=this.zdi(bc.Pa);if(!Xd)return{returnValue:null,index:ad};var Gd=Md.a.h0l(Xd.iterator.currentNode,bc.Pa.cpBegin,this.Mg.Yq,Bc);Gd&&(zd=this.f0(Gd.$j.toString()),Gd=Array.indexOf(this.$g,zd),zd=0<=Gd?zd:null,ad=0<=Gd?Gd+1:ad);zd||(bc=this.Q5h(Xd,bc.Pa,this.Mg.Yq,Bc),zd=0<=bc?this.$g[bc]:null,ad=0<=bc?bc:ad);return{returnValue:zd,index:ad}}eQl(bc=null){var Bc=null;Bc=this.mb.hb.lb;
return Bc&&Bc.Pa?this.jWl(Bc.Pa,this.Mg.Yq,bc):null}zdi(bc){const Bc=new Za.GraphIterator;Bc.set(bc.node);return Bc.gp()?ac.a.zs(Bc,Bc.origin):null}jWl(bc,Bc,ad=null){const zd=this.zdi(bc);bc=this.Q5h(zd,bc,Bc,ad);return-1<bc?this.$g[bc]:null}Q5h(bc,Bc,ad,zd=null){let Xd=-1;if(bc)for(Bc=Bc.cpBegin;-1===Xd&&bc.moveNext();)Sa.ParagraphReader.kh(bc.iterator)&&((Bc=Md.a.ePc(bc.iterator.currentNode,Bc,ad,zd))&&(Xd=Array.indexOf(this.$g,this.f0(Bc.$j.toString()))),Bc=0);return Xd}Dui(bc){const Bc=bc.toString();
return this.rCa.nb(Bc)&&this.rCa.J(Bc)||this.ezc.contains(bc)&&this.vd.Uwa(bc)&&this.vd.Eb(bc).ja(Pb.a.Gba,!1)}Zij(bc,Bc=!1){if(bc=this.fPc(bc))bc.dFf=!Bc}BFf(bc){return this.rCa.nb(bc.toString())||this.ezc.contains(bc)&&this.vd.Uwa(bc)&&!this.vd.Eb(bc).ja(Pb.a.wM,null)}b5f(bc){!bc.objectId||bc.Af||this.rCa.nb(bc.objectId)||this.rCa.add(bc.objectId,bc.done)}deleteComment(bc){bc&&!bc.Af&&(this.Mg.Yq&&bc.Xq!==m.a.beingCreated?this.rCa.remove(bc.objectId):bc.Xq===m.a.beingCreated&&this.oCj());this.rhd.remove(bc.id);
return super.deleteComment(bc)}Vof(bc){return bc&&bc.hasProperty(Pb.a.cF)?bc.rf(Pb.a.cF).toString():""}fPc(bc){if(!bc)return null;if(this.Mg.fhb)return this.UD(bc);for(const Bc of this.$g){const ad=this.vd.Eb(x.a.Ff(Bc.objectId));if(this.Vof(ad)===bc.toString())return bc=ad.rf(Pb.a.EH),this.UD(bc)}return null}S3f(bc,Bc=!1){if(bc&&Md.a.wYd(bc)&&this.od.isFeatureEnabled(116)){const ad=this.Vof(bc);if(""!==ad){if(Bc){let zd;if(this.yjd&&({value:zd}=this.yjd.Fc(ad,zd)).returnValue&&zd.ResolveState===
bc.ja(Pb.a.Gba,!1))return}(bc=this.Vtb.J(Number.parseInvariant(ad)))&&this.Gxd.add(bc)}}}FKn(bc){const Bc=this.Nnf(bc);let ad=!1;Bc.qje&&Bc.JLd||(this.ezc.add(bc.id),ad=!0,this.JSi(bc));return ad}JSi(bc){L.a.E3(r.AFrameworkApplication.oc,()=>{this.GUf(bc);this.ezc.remove(bc.id);this.ezc.count||(this.lOb(),this.mJ.vTo())},"DelayLoadCommentNodeIntoModel")}GUf(bc){if(!this.Zi&&(ha.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.nhd<this.GXj)){this.nhd+=1;this.JSi(bc);ha.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.nhd}`);return}const Bc=this.QPd();Bc.wj(bc);if(Bc.Gz()){let ad;try{ad=this.dId(Bc)}catch(zd){ha.ULS.VA(512553930,327,10,zd,"create comment from comment node failed")}if(!ad){ha.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===bc||void 0===bc?void 0:bc.id}`);this.mK.logKpiFailure(Oe.a.w4b,"CommentCreationFailed",{isInternal:!0},{name:Oe.a.v4b,isInternal:!0});return}this.Zi.addComment(ad,null);2!==this.Zi.mode&&3!==this.Zi.mode&&(this.Zi.mode=
1);this.S3f(bc);this.Xfn(ad);this.lIj(ad)}else this.Yrc.push(bc);this.u2.i$("OnCommentNodeAdded",{commentNode:bc})}Xfn(bc){this.Mg.Yq&&!this.$i.xm&&this.mJ.Sz&&bc.Af&&this.mJ.Sz.id===bc.Af&&this.mJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,bc.author),!1)}Nnf(bc){const Bc=new hf;Bc.O$c=Zc.k(bc,x.a.nil);Bc.nMc=Zc.h(bc,x.a.nil);bc=Bc.O$c.equals(x.a.nil);const ad=Bc.nMc.equals(x.a.nil);bc||(Bc.zDa=this.vd.Eb(Bc.O$c),Bc.qje=!!Bc.zDa&&Bc.zDa.isConnected);ad||(Bc.gOa=this.vd.Eb(Bc.nMc),
Bc.JLd=!!Bc.gOa&&Bc.gOa.isConnected);return Bc}UVh(bc,Bc){const ad=this.swm(bc);-1!==ad&&Array.removeAt(this.aWa,ad);Bc||((bc=this.O2h(bc))?this.aWa.push(bc):ha.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}hul(){for(const bc of this.Gxd)this.UVh(bc,!1);this.Gxd.clear();for(const bc of this.$Te)this.UVh(bc,!0);this.$Te.clear()}kme(bc){var Bc=this.$g.length,ad=!1;if(bc.Af){var zd=(ad=this.UD(bc.Af))&&ad.objectId?this.vd.Eb(x.a.Ff(ad.objectId)):null;zd=!!zd&&zd.hasProperty(Pb.a.ADa);
Bc=Array.indexOf(this.$g,ad);ad=0>Bc;for(Bc+=1;Bc<this.$g.length&&this.$g[Bc].Af===bc.Af&&this.$g[Bc]!==this.Px&&!(zd&&bc.date<this.$g[Bc].date);)Bc++}return{returnValue:!ad,index:Bc}}Vsm(){const bc=new tc(this.kSo,this.lOb),Bc=Xb.App.ni.zl;Bc.Te(40).Mo(Object(Mb.a)(bc,bc.x0k,"commentPropertyChanged"));Bc.Te(12).Mo(Object(Mb.a)(bc,bc.J0k,"commentTextChanged"));this.od.isFeatureEnabled(116)&&Bc.Te(72).Mo(Object(Mb.a)(bc,bc.HFo,"taskPropertyChanged"));dc.GraphTransactionManager.instance.ara(bc,3)}QIi(bc){this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&bc&&0!==bc.length&&(bc=G.a.xFb(bc[0]),1<bc.ops.length||0===bc.ops.length||("\n"===bc.ops[0].insert&&(this.gve+=1),3<this.gve&&ha.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}EUk(bc){if(bc&&this.Jve.has(bc.id)){var Bc=bc.usersByReactionType[1];for(let ad=0;Bc&&ad<Bc.length;ad++)if(Bc[ad].UserId===this.TY)return;ha.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${bc.objectId} removed by inbound changes`)}}sSo(bc,Bc){this.MYk(Bc);
const ad=this.Mg.Yq;ad&&this.zpm(Bc)?(this.Ihl(Bc),this.S3f(bc),this.BWo(Bc)):ad||this.S3f(bc,!0)}mSo(bc){const Bc=new Za.GraphIterator;Bc.set(bc);Bc.zb(40);Bc.ld(40);if(Bc.currentNode){if(bc=this.f0(Bc.currentNode.id.toString())){const ad={done:bc.done,text:bc.text};bc.text=this.nFb(Bc);this.QIi(bc.text);!this.Mg.gva||!this.EE||this.Px&&this.Px.id===bc.id||this.EE.fireEvent(10,{comment:bc,ARi:ad})}}else ha.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Cc.a[bc.type])}BWo(bc){if(!this.$i.xm){var Bc=
new mc.a;this.wne(bc,Bc);0<Bc.count&&Va.b(Bc)}}Ihl(bc){const Bc=new v.a(0,1,0,()=>{this.lSo(bc)},137,void 0,!0);r.AFrameworkApplication.oc.Xb(Bc)}MYk(bc){var Bc;null!==(Bc=this.Px)&&void 0!==Bc&&Bc.yz&&this.Px.yz.sessionType!==J.a.metadata&&(Bc=this.Px,bc.Af||!bc.done||Bc.Af!==bc.id&&Bc.id!==bc.id||(ha.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",Bc.Xq),this.mK.logKpiFailure(Oe.a.uGd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Oe.a.fGd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),Bc.Xq===m.a.beingCreated?(this.Zi.clearSelection(),this.deleteComment(Bc),this.selectComment(bc)):Bc.Xq===m.a.beingEdited&&(Bc.Xq=m.a.normal,Bc.DTa=M.a.succeeded,this.Zi.G5e())))}nSo(bc,Bc){var ad;const zd=null===(ad=Bc.yz)||void 0===ad?void 0:ad.draftId;if(this.Mg.fhb){if(bc=bc.getValue(Pb.a.cF).toString(),Bc.id!==bc){if(!Bc.Af)for(ad=Array.indexOf(this.$g,Bc)+1;ad<this.$g.length&&this.$g[ad].Af===Bc.id;ad++)this.$g[ad].Af=bc;ha.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");Bc.id=bc;this.Stc.has(bc)&&this.Stc.delete(bc)}}else if(bc=bc.getValue(Pb.a.EH),Bc.id!==bc){if(!Bc.Af)for(ad=Array.indexOf(this.$g,Bc)+1;ad<this.$g.length&&this.$g[ad].Af===Bc.id;ad++)this.$g[ad].Af=bc;Bc.id=bc}zd&&this.r1n(zd,Bc.id)}zpm(bc){return this.rCa.nb(bc.objectId)&&this.rCa.J(bc.objectId)!==bc.done}lSo(bc){this.rCa.Z(bc.objectId,bc.done);if(bc.done)if(this.mJ.$nc(bc),this.$i.xm)this.mJ.p1c(bc,!0);else{var Bc=new v.a(0,1,0,()=>{this.mJ.p1c(bc,!0,!1);this.zud.remove(bc.id)},
139);this.zud.add(bc.id,Bc);r.AFrameworkApplication.oc.Xb(Bc);this.lz&&bc.id===(void 0===this.lz.Af||null===this.lz.Af?this.lz.id:this.lz.Af)&&this.mJ.clearSelection()}else this.mJ.$nc(bc),Bc=null,({value:Bc}=this.zud.Fc(bc.id)).returnValue?(r.AFrameworkApplication.oc.Ze(Bc),this.zud.remove(bc.id)):this.mJ.p1c(bc,!1)}KUi(){this.pym();this.nym();r.AFrameworkApplication.K.$("IsDocumentOwner")||y.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(bc=>{bc.logActivity("ShowTUIForCommentAwareness",
null)})}nym(){this.Mg.uRb&&this.lqi();this.Mg.uRb&&(this.aWa=this.e8k(),gd.a.cTa(this.kXi))}pym(){!this.Mg.oDb&&this.Mg.Yq&&qc.a.cTa(this.X0c);this.Vsm();this.Usm()}Usm(){const bc=new Wc(this.iul),Bc=Xb.App.ni.zl;Bc.Te(39).Mo(Object(Mb.a)(bc,bc.kFh,"commentContainerPropertyChanged"));this.od.isFeatureEnabled(116)&&Bc.Te(71).Mo(Object(Mb.a)(bc,bc.kFh,"commentContainerPropertyChanged"));dc.GraphTransactionManager.instance.ara(bc,3)}f0(bc){for(let Bc=0;Bc<this.$g.length;Bc++){const ad=this.$g[Bc];if(ad.objectId===
bc)return ad}return null}Xtk(bc){if(bc)for(const Bc of bc)Bc&&this.Vqd.add(Bc)}WWk(){this.Vqd.clear()}tYe(bc,Bc){Array.insert(this.$g,Bc,bc);this.b5f(bc);this.V1m(bc);Bc=this.tQd(bc);this.Vqd.contains(Bc)&&(bc.dFf=!0,this.Vqd.remove(Bc))}lIj(bc){Zc.p(bc)||ha.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${bc.objectId}`)}V1m(bc){ha.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Zc.a(bc)} `)}dId(bc){40!==bc.Ue&&ha.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const Bc=bc.currentNode;var ad=Bc.getValue(Pb.a.t4b),zd=Bc.getValue(Pb.a.EH);const Xd=Bc.getValue(Pb.a.cF).toString(),Gd=Bc.getValue(Pb.a.AIc);let Ze=null,Fe=null;if(Bc.hasProperty(Pb.a.RQ)){var bf=Bc.getValue(Pb.a.RQ);Ze=bf?ic.b(bf||""):null;Fh.a.cCh(Ze)}Bc.hasProperty(Pb.a.ADa)&&(Fe=Bc.getValue(Pb.a.ADa));let ag=null,Xf=null;Bc.hasProperty(Pb.a.cGd)&&Bc.hasProperty(Pb.a.zIc)&&(ag=Bc.getValue(Pb.a.cGd),Xf=Bc.getValue(Pb.a.zIc));bf=Zc.k(Bc,x.a.nil).toString();const vf=Zc.h(Bc,x.a.nil).toString(),
Bg=Bc.ja(Pb.a.Gba,!1),ob=Bc.ja(Pb.a.wM,null),$b=Bc.ja(Pb.a.vjb,!1);let Uc;Bc.attrString?(zd=this.J8k(Bc.attrString),Uc=zd.paragraphs,zd=zd.Qwa.toString()):Uc=this.nFb(bc);ad=new P.Comment(this.Mg.fhb?Xd:zd,zd,ad,Fe||new Date(Gd),this.Mg.fhb?this.mhd.E7h(ob):ob,Bg,Uc,P.Comment.hZi,$b,Xf,ag,Ze);ad.IFc=bf;ad.HFc=vf;ad.objectId=Bc.id.toString();ad.Y0a=Xd;this.Lmh(Xd,zd);bc.ld(39);return ad}J8k(bc){let Bc=bc.NCl(new Ec.a(0));const ad=new G.a;let zd=0;for(;Bc&&!Bc.Ype();){let Xd=void 0;Bc.Ayi||(Xd=bc.XC(Bc));
const Gd=bc.Iha(Bc.eae),Ze=Gd&&Gd.properties.get("2");Gd&&Gd.properties.forEach(()=>{});const Fe=new N.a;"para"==Ze?zd=null===Gd||void 0===Gd?void 0:Gd.properties.get("5417"):Ze||(Fe.weight=(null===Gd||void 0===Gd?0:Gd.properties.get("1436"))?G.a.V3d:0,ad.dBf(Xd,Fe),ad.Jca("\n"));Bc=bc.k4l(Bc)}return{Qwa:zd,paragraphs:[ad.Z8b()]}}Lmh(bc,Bc){(!bc||Number.parseInvariant(bc)>=Md.a.YLi)&&ha.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${bc}`);Bc||ha.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${Bc}`);
try{this.mhd.Ppk(bc,Bc)}catch(ad){"DuplicateDurableId"===ad.message?ha.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${bc} with Guard Id: ${Bc}`):"DuplicateGuardId"===ad.message?ha.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${Bc} with Durable Id: ${bc}`):ha.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${ad}`)}}nFb(bc){var Bc;if(40!==bc.Ue)return ha.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",bc.Ue),this.Urc.hlg([]);
let ad=bc.Ue+":";const zd=bc.Qp();0<zd?(bc.Qd(),ad+=bc.Ue+":"):(ha.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(Bc=bc.currentNode)||void 0===Bc?void 0:Bc.id}`),Bc=new Ig.a,Bc.inStaging=!0,this.mK.logKpiFailure(Oe.a.w4b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Oe.a.fGd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Bc},Jh.a));Bc=Array(zd);for(let Xd=0;Xd<zd;Xd++){bc.Qd();ad+=bc.Ue+":";const Gd=bc.currentNode;Gd.AIb=!0;Bc[Xd]=
Gd;Gd.qa||ha.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+ad);!Gd.qa&&this.Mg.fbo&&(r.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.zp());bc.rc();bc.Kj();ad+=Xd<zd-1?":"+bc.Ue+":":":"}return this.Urc.hlg(Bc)}zp(){if(Wa.WoncaApp.Zke){var bc=new xb.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);
bc.Cd=1;bc.xe(1,WoncaIntl.WoncaStrings.l_SendErrorReport);bc.xe(0,WoncaIntl.WoncaStrings.l_NoThanks);bc.rV(1);bc.rx(Ub.a.p$e,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.Cll,!1)}else this.XZ.aI(Ub.a.p$e,this.RDi)}tQd(bc){if(!bc||!bc.objectId)return"";bc=x.a.Ff(bc.objectId);bc=this.vd.Eb(bc);return this.Vof(bc)}n7l(bc){return this.tQd(bc.Af?this.UD(bc.Af):bc)}TQn(bc,Bc){if(this.od.isFeatureEnabled(116))if(this.Mg.Mda)ha.ULS.sendTraceTag(595128897,3003,
50,"RecordTaskChanges no ops because filter PII flag on"),this.lOb();else{this.qZa.Sv(Ga.a.deg);var ad=null===Bc||void 0===Bc?void 0:Bc.taskId,zd=!ad;zd?this.qZa.logKpiUsage(pf.a.Hke,0):this.qZa.logKpiUsage(pf.a.Ike,0);try{const bf=this.qYb.value,ag=this.tQd(bc);if(""===ag)this.J2d(zd,"FailedDurableIdForComment");else{var Xd=this.n7l(bc);if(""===Xd)this.J2d(zd,"FailedDurableIdForParentComment");else if(zd&&bc.yz.sessionType!==J.a.create&&bc.yz.sessionType!==J.a.reply)ha.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",bc.yz.sessionType),this.qZa.logKpiFailure(pf.a.Hke,"FailedTaskCreateInvalidSessionType");else{var Gd=null;bc.yz.sessionType!==J.a.metadata&&(Gd=ag);var Ze=this.G3g.value;var Fe=K.a.Xe(bc.text)?Ze.y2h(Gd,Bc,zd):Ze.y2h(Gd,Bc,zd,bc.text[0]);0<Fe.length?zd?(bf.igb(Number.parseInvariant(Xd),Fe)||this.qZa.logKpiFailure(pf.a.Hke,"TaskCreateFailed"),this.lOb()):(this.qZa.logKpiUsage(pf.a.Ike,0),bf.kCk(ad,Fe)||this.qZa.logKpiFailure(pf.a.Ike,
"TaskEngagementFailed")):this.J2d(zd,"HistoryRecordsLengthZero")}}}catch(bf){this.J2d(zd,"RecordTaskChangesFailed")}}}J2d(bc,Bc){const ad={name:pf.a.AFo,isInternal:!0};bc?this.qZa.logKpiFailure(pf.a.Hke,Bc,ad):this.qZa.logKpiFailure(pf.a.Ike,Bc,ad)}xAd(bc,Bc){if(bc){var ad=r.AFrameworkApplication.userName,zd=Bc.toString();bc.usersByReactionType||(bc.usersByReactionType={});var Xd=bc.usersByReactionType[zd];ad=new V(this.TY,this.i6a,ad);ad.DateUtc=new Date;Xd?Xd.push(ad):bc.usersByReactionType[zd]=
[ad];ha.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",Bc,bc.Af?"reply":"parent",bc.objectId);zd=[bc];this.mK.Sv(Ad.a.y0k,{succeeded:!0,customData:{reactionType:W[Bc]}});this.f5c(zd,T.addReaction);this.Jve.add(bc.id)}}Cce(bc,Bc){if(bc&&bc.usersByReactionType){var ad=bc.usersByReactionType[Bc.toString()];if(ad&&ad.length){for(let zd=0;zd<ad.length;zd++)if(ad[zd].UserId===this.TY){Array.removeAt(ad,zd);break}ha.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
Bc,bc.Af?"reply":"parent",bc.objectId);ad=[bc];this.mK.Sv(Ad.a.A0k,{succeeded:!0,customData:{reactionType:W[Bc]}});this.Jve.delete(bc.id);this.f5c(ad,T.removeReaction)}}}f5c(bc,Bc){const ad=this.Kc.Pc(15);ad.Db(this.JJa);this.mx.mF.V7(3);switch(Bc){case T.deleteComment:for(Bc=0;Bc<bc.length;Bc++){var zd=bc[Bc];if(zd.Xq===m.a.beingCreated)this.Mg.contentNavigationApiEnabled&&this.DBc.remove(zd.yz.draftId),this.mJ.Yng();else{var Xd=x.a.Ff(zd.objectId);(Xd=this.vd.Eb(Xd))&&Md.a.KJd(Xd,this.vd);ha.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${zd.objectId}]`);this.Mg.gva&&this.EE&&(zd.Af?this.EE.fireEvent(10,{comment:zd,changeType:"replyDeleted"}):this.EE.fireEvent(7,{comment:zd}));this.Mg.contentNavigationApiEnabled&&this.DBc.remove(zd.id)}}break;case T.addComment:this.Zi.mode=1;bc=bc[0];bc.date=new Date;Bc=this.Ial(bc);zd=Bc.getValue(Pb.a.cF).toString();bc.Y0a=zd;this.Mg.fhb&&this.Stc.set(zd,bc.id);zd=bc.text;Xd=this.QPd();if(bc.Af){var Gd=this.UD(bc.Af),Ze=this.vd.Eb(x.a.Ff(Gd.objectId));
Bc.setValue(Pb.a.wM,Ze.getValue(Pb.a.EH));this.addReply(Bc,zd,this.vd,Xd,Ze);ha.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${bc.objectId}][ParentObjectId:${Gd.objectId}]`)}else(Gd=this.mb.hb.lb)&&Gd.Pa&&(Jb.SelectionEditor.Il(Gd)&&(Ze=Jb.SelectionEditor.c0(Gd.Pa,!1))&&(this.mb.Bc(Ze),Gd=Ze,ha.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Sa.ParagraphReader.Wb(Gd.Pa.node)&&Sa.ParagraphReader.Wb(Gd.Rc.node)&&(this.kAb(Bc,zd,Xd,Gd),ha.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${bc.objectId}]`)));zd=Bc.ja(Pb.a.EH,null);bc.Qwa=zd;bc.DTa=M.a.sentToServer;bc.DTa=M.a.succeeded;bc.objectId=Bc.id.toString();this.b5f(bc);this.lIj(bc);this.Lmh(bc.Y0a,bc.Qwa);this.Mg.gva&&this.EE&&(bc.Af?this.EE.fireEvent(10,{comment:bc,changeType:"replyAdded"}):this.EE.fireEvent(11,{comment:bc}));break;case T.editComment:this.Zi.mode=1;bc=bc[0];Bc=x.a.Ff(bc.objectId);Bc=this.vd.Eb(Bc);zd=bc.Qwa;bc.Qwa||(zd=Bc.getValue(Pb.a.EH),ha.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${bc.objectId} while editing`),zd=this.Mg.fhb?zd:bc.id);this.yDj(Bc,bc.text,zd);ha.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${bc.objectId}]`);bc.DTa=M.a.sentToServer;bc.DTa=M.a.succeeded;this.Mg.gva&&this.EE&&this.EE.fireEvent(10,{comment:bc,changeType:bc.Af?"replyEdited":"edited"});break;case T.addReaction:case T.removeReaction:Bc=bc[0];bc=x.a.Ff(Bc.objectId);bc=this.vd.Eb(bc);(Bc=(Bc=Bc.usersByReactionType)?ic.c(Bc):"")&&bc.setValue(Pb.a.RQ,
Bc);break;case T.done:case T.undone:for(Bc=0;Bc<bc.length;Bc++)zd=bc[Bc],Xd=x.a.Ff(zd.objectId),this.vd.Eb(Xd).setValue(Pb.a.Gba,zd.done),ha.ULS.sendTraceTag(594124932,327,50,`${zd.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${zd.objectId}]`),this.Mg.gva&&this.EE&&this.EE.fireEvent(10,{comment:zd,changeType:zd.done?"resolved":"reopened"})}this.Lm.nF();ha.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");ad.dispose()}QPd(){const bc=new Za.GraphIterator;
bc.set(this.mx);this.CDa.o5a(bc);return bc}P7c(){return this.Kgj(!0)}Q7c(){return this.Kgj(!1)}Kgj(bc){if(!this.$g.length)return null;let Bc=this.lz;do{if(Bc){const ad=this.Mg.Yq&&!this.$i.xm;Bc=bc?this.hWl(Bc,ad):this.iWl(Bc,ad)}else Bc=bc?this.$g[0]:this.$g[this.$g.length-1];if(!Bc)return null}while(Bc.Af&&""!==Bc.Af);this.selectComment(Bc);return Bc}ZJh(bc,Bc,ad,zd,Xd){const Gd=this.HXj.create(1074135127);this.Mg.Mda&&(Bc=CommonUIStrings.l_RemovedAuthorName,ad=null);Gd.setValue(Pb.a.commentId,
Y.a.zF());Gd.setValue(Pb.a.cF,Md.a.Uof());Gd.setValue(Pb.a.hOa,r.AFrameworkApplication.userSessionId);Gd.setValue(Pb.a.EH,bc);Gd.setValue(Pb.a.t4b,Bc);Gd.setValue(Pb.a.EFh,Bc);Gd.setValue(Pb.a.AIc,ad?ba.a.GOd(ad,"MM/dd/yyyy HH:mm:ss",ba.a.dataCulture):"");Gd.setValue(Pb.a.ADa,ad);Gd.setValue(Pb.a.Gba,zd);Xd&&(bc=Xd?ic.c(Xd):"",Gd.setValue(Pb.a.RQ,bc));Gd.setValue(Pb.a.zIc,this.TY);Gd.setValue(Pb.a.cGd,this.i6a);return Gd}Ial(bc){var Bc;const ad=this.ZJh(bc.id,bc.author,bc.date,bc.done,null!==(Bc=
bc.usersByReactionType)&&void 0!==Bc?Bc:{});bc.Af&&(this.Mg.fhb?((Bc=this.mhd.VXl(bc.Af))||ha.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${bc.Af}`),bc=Bc):bc=bc.Af,ad.setValue(Pb.a.wM,bc));return ad}addReply(bc,Bc,ad,zd,Xd){this.addComment(bc,Bc,zd);Bc=xg.Znh(bc,ad,Xd,!0);ad=xg.Znh(bc,ad,Xd,!1);Bc&&Zc.v(bc,Bc.Kb.paragraph.id);ad&&(Zc.u(bc,ad.Kb.paragraph.id),ad.Kb.paragraph.id||ha.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}kAb(bc,Bc,ad,
zd){this.addComment(bc,Bc,ad);let Xd,Gd;({start:Bc,end:Xd,startCp:ad,endCp:Gd,Sth:Ze}=this.POk());Ze&&(zd.Pa.node===Bc&&(ad=rc.a.uib(zd,!0)),zd.Rc.node===Xd&&(Gd=rc.a.uib(zd,!1)));if(-1===ad||-1===Gd){this.hZg||0!==this.XVb||(this.mK.logKpiFailure(Oe.a.o8e,"DraftSelectionLost",{isInternal:!0},{name:Oe.a.v4b,isInternal:!0}),this.hZg=!0);Bc=zd.Pa.node;ad=rc.a.uib(zd,!0);Xd=zd.Rc.node;Gd=rc.a.uib(zd,!1);if(2<zd.length){var Ze=[];for(let Fe=0;Fe<zd.length;Fe++)Ze.push(zd.J(Fe).node.id);this.Enh(bc,Ze)}ha.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.XVb)}else if(2<this.MZ.length){Ze=[];for(zd=0;zd<this.MZ.length;zd++)Ze.push(this.MZ[zd].hhc);this.Enh(bc,Ze)}Md.a.J1b(Bc,bc.id,ad,!0);Md.a.J1b(Xd,bc.id,Gd,!1);Zc.v(bc,Bc.id);Zc.u(bc,Xd.id);this.oCj();Xd.id||ha.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}Enh(bc,Bc){if(!(2>=Bc.length||!bc||Zc.s(bc))){this.$i.VU.add(bc.id,new tb.a(new hb.a));for(var ad=x.a.zq(Bc[0],Bc[1])?2:1,zd=Bc.length-2;ad<=zd;ad++){const Xd=Bc[ad];this.$i.Zx.nb(Xd)?
this.$i.Zx.J(Xd).bN||(this.$i.Zx.J(Xd).bN=new tb.a(new hb.a)):this.$i.Zx.add(Xd,new Ed.a(!0));this.$i.Zx.J(Xd).U2a=!0;this.$i.Zx.J(Xd).bN.add(bc.id);this.$i.VU.J(bc.id).add(Xd)}}}POk(){let bc=null,Bc=-1,ad=null;var zd=-1;let Xd=!1;if(!this.MZ.length||2!==this.XVb)return{start:bc,end:ad,startCp:Bc,endCp:zd,Sth:Xd};bc=this.vd.Eb(this.MZ[0].hhc);ad=1===this.MZ.length?bc:this.vd.Eb(this.MZ[this.MZ.length-1].hhc);if(Sa.ParagraphReader.Wb(bc)&&Sa.ParagraphReader.Wb(ad)){zd=Ze=>3===Ze.type;let Gd=this.Nn.LPa(bc,
3,zd);Bc=0<Gd.count?Gd.J(0).Ac:-1;bc!==ad&&(Gd=this.Nn.LPa(ad,3,zd));zd=0<Gd.count?Gd.J(0).end:-1;-1===Bc&&null!=bc&&(Bc=bc.qa.first.cp,Xd=!0,ha.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===zd&&null!=ad&&(zd=ad.qa.last.cp,Xd=!0,ha.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.XVb=-1===Bc||-1===zd?0:2;return{start:bc,end:ad,startCp:Bc,endCp:zd,Sth:Xd}}oCj(){for(const bc of this.MZ){const Bc=this.vd.Eb(bc.hhc);Sa.ParagraphReader.Wb(Bc)&&this.Nn.YUa(Bc,
3)}this.MZ=[];this.XVb=2}addComment(bc,Bc,ad){bc.anchor||(ad.xf(bc,1),ad.wj(bc),this.$ij(bc,Bc,ad))}$ij(bc,Bc,ad){let zd=0;var Xd=null;Bc=this.Urc.sIo(Bc,Gd=>{const Ze=new fb.a;ad.xf(Ze,1);ad.wj(Ze);ad.xf(Gd,2);ad.wj(Gd);ad.rc();ad.rc()});for(let Gd=0;Gd<Bc.length;Gd++)Xd=Bc[Gd],zd=Xd.getValue(Pb.a.Wc),xg.il.fVa(Xd),xg.lK&&xg.lK.RNa&&xg.lK.jIa(vb.a.create(Xd));bc.setValue(Pb.a.EH,zd.toString());return Xd}tkb(bc,Bc){return this.HFm(bc,Bc)}Hpm(){return 0<this.MZ.length}JCb(bc,Bc,ad){return bc.Pa&&Sa.ParagraphReader.Wb(bc.Pa.node)&&
Sa.ParagraphReader.Wb(bc.Rc.node)?(Bc=this.ZJh(Sa.ParagraphReader.pR(bc.Rc.node).toString(),Bc?Bc:r.AFrameworkApplication.userName,new Date,!1,{}),ad||(ad=new G.a,ad.Jca("\n")),this.kAb(Bc,[ad.Z8b()],this.QPd(),bc),Bc):null}ys(bc){return!this.mXe.$eg(this.fPc(bc.getValue(Pb.a.cF)))}yDj(bc,Bc,ad){const zd=new Za.GraphIterator;for(zd.set(bc);zd.Qd();)zd.vg();this.$ij(bc,Bc,zd).Dg(Pb.a.Wc,Number.parseInvariant(ad));bc.setValue(Pb.a.EH,ad);if(Bc=this.f0(bc.id.toString()))Bc.yHh=!1;bc.setValue(Pb.a.vjb,
!1)}xDj(bc,Bc){this.yDj(bc,[Sys.Serialization.JavaScriptSerializer.serialize(Bc)],bc.getValue(Pb.a.EH))}LG(bc){bc=this.vd.Eb(x.a.Ff(bc));return!!bc&&bc.ja(Pb.a.LG,!1)}A0i(bc){bc=this.vd.Eb(x.a.Ff(bc));return!!bc&&bc.ja(Pb.a.gHh,!1)}rHm(bc){const Bc=Zc.j();return bc&&Bc.has(bc.objectId)}LNm(bc){const Bc=this.vd.Eb(x.a.Ff(bc));return Bc?this.Fcc(Bc):(ha.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+bc),!1)}Fcc(bc){var Bc=bc.id,ad=Zc.k(bc),zd=Zc.h(bc);if(!x.a.zq(ad,zd))return!1;
ad=bc.Lc.Eb(ad);if(!ad)return!1;zd=({QHc:bc}=this.zJc(ad,Bc,!0)).returnValue;var Xd=({QHc:Bc}=this.zJc(ad,Bc,!1)).returnValue;if(-1===zd||-1===Xd)return!1;ad=ad.qa;zd=ad.J(bc);Xd=ad.J(Bc);if(!zd.hyperlink||!zd.hyperlink.JG||!Xd.Wm)return!1;for(bc+=1;bc<Bc;bc++)if(zd=ad.J(bc),zd.hyperlink||zd.Wm)return!1;return!0}hSc(){return xg.Rpm(this.$g,bc=>this.LG(bc),bc=>this.A0i(bc))}zJc(bc,Bc,ad){let zd;for(zd=0;zd<bc.qa.length;zd++){const Xd=bc.qa.J(zd);if(Xd.nf)for(let Gd=0;Gd<Xd.nf.length;Gd++){const Ze=
Xd.nf.J(Gd);if(Ze.$j.equals(Bc)&&Ze.Qc===ad)return{returnValue:Xd.cp,QHc:zd}}}return{returnValue:-1,QHc:zd}}PPh(bc){if(this.$i.VU.nb(bc)){const Bc=new mc.a;for(const ad of this.$i.VU.J(bc))this.gXn(ad,bc,Bc);this.$i.VU.remove(bc);Va.b(Bc)}}wne(bc,Bc){if(bc.objectId){bc=x.a.Ff(bc.objectId);var ad=this.vd.Eb(bc);if(ad){var zd=Zc.k(ad,x.a.nil);ad=Zc.h(ad,x.a.nil);zd.equals(x.a.nil)||Bc.add(this.vd.Eb(zd));ad.equals(x.a.nil)||Bc.add(this.vd.Eb(ad));if(this.$i.VU.nb(bc))for(const Xd of this.$i.VU.J(bc))Bc.add(this.vd.Eb(Xd))}}}gXn(bc,
Bc,ad){let zd;({value:zd}=this.$i.Zx.Fc(bc,zd));zd&&(zd.bN.remove(Bc),zd.bN.count||(zd.U2a=!1,ad.add(this.vd.Eb(bc))))}static get il(){return null!=xg.gEg?xg.gEg:xg.gEg=y.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return xg.Wl()}static Wl(){if(xg._instance)return xg._instance;const bc=new Z.a(()=>(new mb(!0,!0,!0)).f8k()),Bc=y.a.instance;xg._instance=new xg(new Z.a(()=>Xb.App.za.jb.Yc),new Z.a(()=>Xb.App.za.jb.qc.ed),new Z.a(()=>ie.a.instance),new Nb.a,new Lc,new Z.a(()=>Ib.a.instance),
Bc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),Bc.resolve("WordEditor.Comments.ICommentFormatTranslator"),Bc.resolve("Common.IAppSettingsManager"),Bc.resolve("Box4.IFeatureHelper"),Bc.resolve("Box4.Intent.IIntentRangeEditor"),new Z.a(()=>Xb.App.oS),Bc.resolve("Box4.IKickoutExecutor"),Bc.Re("WordEditor.Tasks.ITaskActor"),bc,Bc.resolve("WordEditor.Comments.CommentsSettings"),Bc.resolve("Box4.IUndoManager"),Bc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),Bc.resolve("WordEditor.Comments.CommentsState"),
Bc.resolve("WordEditor.Comments.WordCommentEventsActor"),Bc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Bc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),Bc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),Xb.App.ni.zl.Te(12),Bc.resolve("Box4.ParagraphRenderEvents"),Bc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Bc.Ta("WordEditor.Extension.RichApiEventManager"));return xg._instance}static Znh(bc,Bc,ad,zd){Bc=Md.a.jca(ad,Bc,zd);if(!Bc)return null;
Bc=Bc.Kb.nf;return Md.a.wAd(bc.id,Bc,Bc.J(0).dv,zd)}HFm(bc,Bc){if(Xb.App.lostSession||(Bc?!Xb.App.ys:!Xb.App.ys&&!Xb.App.ym)||1===bc.mode||!Object(Cb.a)(Ac.MainView,Fb.InteractiveViewManager.instance.zd))return!1;bc=this.KLl();return!bc||nb.a.instance.R_(bc)||nb.a.instance.hia(bc)||bc.contextId===pb.a.M7||Xa.a.NDf(bc)&&Xa.a.bcc()?!1:!0}KLl(){const bc=Fb.InteractiveViewManager.instance.zd;var Bc=bc.mb.ng;this.tHm()&&this.Px&&ab.n(Bc.node)&&(Bc=Za.GraphIterator.eb(Bc.node),Bc.zb(12),Bc=Bc.fo(12),Bc=
$a.SelectionFactory.qna(Bc),bc.mb.Bc(Bc),Bc=bc.mb.ng);return Bc}tHm(){var bc;return null===(bc=this.Ga)||void 0===bc?void 0:bc.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static Rpm(bc,Bc,ad){const zd=new mc.a,Xd=new mc.a,Gd=new Ja.a,Ze=new Ja.a;for(const ag of bc){var Fe=ag.id,bf=ag.objectId;bc=ag.done;const Xf=!!bf&&Bc(bf);Fe&&(bc&&zd.add(Fe),Xf&&Xd.add(Fe),bf&&Gd.Z(Fe,bf));if(Fe=ag.Af)({value:bf}=Ze.Fc(Fe,0)).returnValue||(bf=0),Ze.Z(Fe,bf+1);if(!Fe&&!bc&&
!Xf)return!0}for(const ag of Xd){if(zd.contains(ag))continue;let Xf;if(({value:Xf}=Gd.Fc(ag,Xf)).returnValue&&ad(Xf))return!0;let vf;if(({value:vf}=Ze.Fc(ag,0)).returnValue&&0<vf)return!0}return!1}ZPl(bc){const Bc=[];let ad=this.$g.findIndex(zd=>zd.id===bc);if(-1<ad)for(Bc.push(this.$g[ad]);++ad<this.$g.length&&this.$g[ad].Af===bc;)Bc.push(this.$g[ad]);return Bc}pUl(bc){return this.mhd.E7h(bc)}}xg._instance=null;xg.lK=null;Object(l.a)(xg,"EditorCommentModel",f.a,[718,719,720])},1771:function(D,I,
c){D=c(0);var l=c(397),f=c(135),a=c(42),k=c(303),x=c(3),y=c(7),m=c(15),r=c(1633),z=c(1590);class v{constructor(Z,ea,ha=!1){this.paragraphNode=Z;this.role=ea;this.lsj=ha}}Object(D.a)(v,"DesignerReviewActionData",null,[]);class G{constructor(Z,ea,ha){this.paragraphNode=Z;this.Hq=ea;this.role=ha}}Object(D.a)(G,"TriageActionData",null,[]);class F extends G{constructor(Z,ea){super(Z,0,ea)}}Object(D.a)(F,"RoleTriageActionData",G,[]);class H extends G{constructor(Z,ea,ha){super(Z,1,27);this.styleId=ea;this.yX=
ha}}Object(D.a)(H,"PullQuoteTriageActionData",G,[]);class L extends G{constructor(Z,ea){super(Z,2,28);this.Poa=ea}}Object(D.a)(L,"ImageTriageActionData",G,[]);class J{constructor(Z,ea){this.paragraphNode=Z;this.MJb=ea}}Object(D.a)(J,"ViewOriginalActionData",null,[]);var M=c(134),P=c(1530),N=c(1702);class K{constructor(Z,ea){this.currentNode=Z;this.nextNode=ea}}Object(D.a)(K,"ReviewNavigationArgs",null,[]);class O{constructor(Z,ea){this.paragraphNode=Z;this.isVisible=ea}}Object(D.a)(O,"ReviewVisibilityArgs",
null,[]);class V{constructor(Z){this.Cgk=Z}getSelectedOption(){return this.Cgk}getSeparatorIndexes(){return[1]}}Object(D.a)(V,"DesignerPreviewData",null,[]);var W=c(506),T=c(944),Y=c(1703);c.d(I,"a",function(){return ba});class ba extends T.a{constructor(Z,ea,ha,la,ia,sa,Oa,Ra,Na,Da,ra,xa){super();this.nc=Z;this.Xd=ea;this.bKd=ha;this.Lca=la;this.aj=ia;this.eC=sa;this.Dzj=Oa;this.Xl=Ra;this.Kv=Na;this.cKd=Da;this.Bs=ra;this.Plf=xa;this.Mdb=null;this.Yfd=void 0;this.iwe=0;this.xH=[W.a.mQh]}get types(){return this.xH}get ahj(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get w$d(){return 0}Lro(Z){return 3!==
Z.suggestion.Hq&&!this.Kv.isVisible&&(!this.iwe||!Z.FAb&&1===this.iwe)}BN(Z){var ea;if(!Z.source||l.SessionStatusManager.instance.Uj)return!1;const ha=Z.ml;var la=this.Lca.eQc(ha,1);if(!la||!la.count)return!1;const ia=la.J(0).intent;if(Z.Dlc)return.5!=(null===ia||void 0===ia?void 0:ia.state)&&4!=(null===ia||void 0===ia?void 0:ia.state);const sa=ha.node;if(0==(null===ia||void 0===ia?void 0:ia.state)&&(2==(null===ia||void 0===ia?void 0:ia.suggestion.Hq)||1==(null===ia||void 0===ia?void 0:ia.suggestion.Hq)))return ia.FAb(),
this.Lca.YUa(sa,1),this.eC.T4i(new N.a(sa,1)),!0;if(1==Z.source&&27==(null===ia||void 0===ia?void 0:ia.Wjb)&&(.5==(null===ia||void 0===ia?void 0:ia.state)||4==(null===ia||void 0===ia?void 0:ia.state)))return!1;la=this.Kv.isVisible?this.bKd.Vkl(sa):new Y.a(0,1);let Oa;const Ra=this.u_l(null===(ea=null===ia||void 0===ia?void 0:ia.suggestion)||void 0===ea?void 0:ea.Hq);ea=this.Ri.Vja(ha,{id:"Intent-"+W.a.mQh,suggestionGroups:[{type:Ra,id:Ra,title:ia.description,snippet:this.jEn(this.aj.Hda(ha.node)),
snippetFormatting:[],supportedActions:this.xnf(null===ia||void 0===ia?void 0:ia.suggestion,!0),suggestions:({tao:Oa}=this.NMh(sa)).returnValue,previewData:Oa?new V(Oa):null,isContentPending:!1}],setSize:la.count,positionInSet:la.index},this,Z.sRa,!1,()=>{var Na;this.eC.U4i(new O(sa,!0));this.Kv.isVisible||3===(null===(Na=null===ia||void 0===ia?void 0:ia.suggestion)||void 0===Na?void 0:Na.Hq)||this.iwe++},()=>{this.eC.U4i(new O(sa,!1))},null,!1,Na=>{Na.showDesignerButton=!this.Kv.isVisible;Na.shouldSkipTwoStepReview=
!0;Na.isFormattingSuggestion=0==ia.suggestion.Hq;Na.isMultiParagraphSuggestion=1<ia.qO.length;Na.proactivePromptHintType=this.Lro(ia)?k.e.HideFromReviewCardAndRibbon:k.e.None});a.c(m.a.eun,ea,void 0,void 0,30);return ea}executeAction(Z,ea){var ha,la,ia,sa,Oa;if(!Z||!ea)return!1;const Ra=this.Xl.FA(ea);y.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",Z.actionType,null===Ra||void 0===Ra?void 0:Ra.role,this.Kv.isVisible);const Na=this.cKd.sU(ea);try{switch(Z.actionType){case k.b.Accepted:const Da=
this.nc.Rb(m.a.Szd,2,new v(ea,null===Ra||void 0===Ra?void 0:Ra.role,!0));this.nog(La=>{La.supportedActions=this.xnf(null===Na||void 0===Na?void 0:Na.suggestion,!1)});return this.Kv.isVisible&&32===Da?this.zRf(ea):32===Da;case k.b.Rejected:const ra=this.nc.Rb(m.a.rce,2,new v(ea,null===Ra||void 0===Ra?void 0:Ra.role,!0));2===(null===Na||void 0===Na?void 0:Na.suggestion.Hq)||Object(P.e)(null===Na||void 0===Na?void 0:Na.suggestion)||this.vcd(ea,!1);2===(null===Na||void 0===Na?void 0:Na.suggestion.Hq)&&
this.Ri.dismiss();return this.Kv.isVisible&&32===ra?this.zRf(ea):32===ra;case k.b.Next:case k.b.Previous:return!this.Kv.isVisible||this.zRf(ea,Z.actionType===k.b.Previous);case k.b.Apply:const xa=null===(ha=Z.suggestion)||void 0===ha?void 0:ha.contentData;let fa;switch(null===xa||void 0===xa?void 0:xa.Hq){case 0:fa=new F(ea,xa.role);break;case 1:case 3:const La=xa.q6a;y.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(la=null===Na||void 0===Na?void 0:Na.suggestion)||
void 0===la?void 0:la.id,["newStyleId"]:La});Na.suggestion.q6a=La;fa=new H(ea,La,f.a.create());break;case 2:fa=new L(ea,xa.Poa);break;default:return y.ULS.shipAssertTag(527459665,3016,!1,String.format("DesignerSuggestionType: {0}",xa.Hq)),!1}this.Ri.focus();const oa=this.nc.Rb(m.a.changeDesignerRole,2,fa);this.vcd(ea,!1);return 32===oa;case k.b.AcceptAll:return 32===this.nc.Rb(x.a.heb,2,new r.a(2));case k.b.RejectAll:return 32===this.nc.processAction(m.a.B5c,2);case k.b.SnoozeAll:return 32===this.nc.processAction(m.a.designerSnoozeContextualSuggestions,
2);case k.b.Undo:const ta=this.nc.Rb(m.a.oJa,2,new v(ea,null===Ra||void 0===Ra?void 0:Ra.role));this.vcd(ea,!0);return 32===ta;case k.b.OpenDesignerPane:return 32===this.nc.Rb(m.a.XIa,2,new z.a(6));case k.b.ViewOriginal:const Ka={MJb:Z.descriptorData.isViewingOriginal,ucg:Z.descriptorData.setIsViewingOriginal};if(void 0==(null===Ka||void 0===Ka?void 0:Ka.MJb)||void 0==(null===Ka||void 0===Ka?void 0:Ka.ucg))return y.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",
null===Ka||void 0===Ka?void 0:Ka.MJb,null===Ka||void 0===Ka?void 0:Ka.ucg)),!1;this.Ri.focus();const va=this.nc.Rb(m.a.Idf,2,new J(ea,Ka.MJb));Ka.ucg(!Ka.MJb);this.vcd(ea,!0);return 32===va;case k.b.GiveFeedback:switch(null===(ia=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===ia?void 0:ia.Hq){case 0:return this.Bs.invokeUserFeedback(M.a.NRj),!0;case 1:case 3:return this.Bs.invokeUserFeedback(M.a.TRj),!0;case 2:return this.Bs.invokeUserFeedback(M.a.PRj),!0;default:return y.ULS.shipAssertTag(537658138,
3016,!1,String.format("DesignerSuggestionType: {0}",null===(sa=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===sa?void 0:sa.Hq)),!1}case k.b.ShowMore:switch(null===(Oa=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===Oa?void 0:Oa.Hq){case 2:y.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Na.suggestion.ewm(),this.vcd(ea,!0,!0)}return!0;default:return!1}}catch(Da){return y.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",Da.message,Da.stack)),!1}}zRf(Z,
ea=!1){const ha=this.bKd.E9b(Z,ea)||this.bKd.E9b(Z,!ea);this.eC.QLn(new K(Z,ha,!ea));return!ha||this.bKd.dPi(this,ha)}qXl(Z){switch(Z.Hq){case 0:case 1:case 3:return{...k.h,font:Z.font,cssColor:Z.color,fontSize:Z.fontSize,fontWeight:Z.bold?k.d.Bold:k.d.Normal,italic:Z.italic,underlineType:Z.underline?k.f.Single:k.f.None,backgroundImg:Z.backgroundImg};case 2:break;default:y.ULS.shipAssertTag(527569927,3016,!1,`${Z.Hq}`)}}rZl(Z){if(2===Z.Hq)return{src:Z.imageUrl,width:0,height:0,imageAltText:Z.altText}}NMh(Z){var ea=
null;let ha=null;if(this.Mdb=this.Dzj.n5l(Z)){ha=Array(this.Mdb.options.length);for(Z=0;Z<this.Mdb.options.length;Z++)ea=this.Mdb.options[Z],ha[Z]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",Z),title:ea.title,supportedActions:[k.b.Apply],contentData:ea,image:this.rZl(ea),titleFormatting:[this.qXl(ea)]};ea=(null===ha||void 0===ha?0:ha.length)?ha[this.Mdb.selectedIndex]:void 0}return{returnValue:ha,tao:ea}}nog(Z){this.Ri.definition?this.Ri.definition.suggestionGroups?1===this.Ri.definition.suggestionGroups.length&&
(Z(this.Ri.definition.suggestionGroups[0]),this.Ri.definition=this.Ri.definition):y.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):y.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}vcd(Z,ea,ha=!1){const la=this.cKd.sU(Z);this.nog(ia=>{ia.supportedActions=this.xnf(null===la||void 0===la?void 0:la.suggestion,ea);if(this.Mdb){if(ha){var sa=this.NMh(Z).returnValue;ia.suggestions=sa}sa=this.Dzj.bbm(this.Mdb.options,Z);ia.previewData=new V(ia.suggestions[sa])}})}xnf(Z,
ea){const ha=[];ea?(ha.push(k.b.Accepted),ha.push(k.b.Rejected),0==(null===Z||void 0===Z?void 0:Z.Hq)&&ha.push(k.b.ViewOriginal)):(ha.push(k.b.Next),ha.push(k.b.Undo));this.Kv.isVisible||(this.Xd.YHm()&&this.fFk(la=>{la&&this.nog(ia=>ia.supportedActions.push(k.b.GiveFeedback))})&&ha.push(k.b.GiveFeedback),this.Xd.MIm()&&ha.push(k.b.OpenDesignerPane),ha.push(k.b.SnoozeAll));0===(null===Z||void 0===Z?void 0:Z.Hq)&&ha.push(k.b.AcceptAll);ha.push(k.b.RejectAll);(null===Z||void 0===Z?0:Z.ami())&&ha.push(k.b.ShowMore);
return ha}jEn(Z){const ea=Z.split(" ",10);return 10>ea.length?Z:ea.join(" ")+"\u2026"}static SIm(Z){return Z===W.a.nQh||Z===W.a.oQh||Z===W.a.sQh}u_l(Z){return 2===Z?W.a.oQh:1===Z||3===Z?W.a.sQh:W.a.nQh}fFk(Z){void 0===this.Yfd&&this.Plf.execute(async ea=>{this.Yfd=await ea.isFeatureEnabled(M.a.TOi,!1);Z(this.Yfd)});return!!this.Yfd}}Object(D.a)(ba,"DesignerIntentProvider",T.a,[])},1779:function(D,I,c){D=c(0);var l=c(2),f=c(2059),a=c(397),k=c(181),x=c(80),y=c(312),m=c(9),r=c(597),z=c(7),v=c(575),G=
c(1723);class F{constructor(V,W){this.Sfk=V;this.Tfk=W}}Object(D.a)(F,"LastSavedToHostDetailsEventArgs",null,[1056]);class H{constructor(V,W,T,Y,ba,Z){this.Tkk=5E4;this.NUe=0;this.cwb=new Date(Date.UTC(0,1,1,0,0));this.aZj=6E4;this.QBc=this.lYb=0;this.sa=new x.a;this.Xbo=()=>{z.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.QBc++);this.kf.Fo||this.i8b().then(ea=>{this.sa.raiseEvent(H.xEi,ea);this.n3g=new Date;ea=this.h0b;this.Vl&&!this.Vl.isVisible&&
(ea=this.rjk);this.Xza(ea)}).catch(ea=>{this.Xza(this.Ofm(ea))})};this.uwd=V;this.kf=T;this.e3=ba;this.Ow=Z;this.h0b=W.lc("LastSavedToHostDetailsIntervalMs",6E4);this.qub=W.lc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.rjk=W.lc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.h0b);this.jRe=W.lc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.n3g=new Date;Y.execute(ea=>{this.Vl=ea;this.Vl.$Za((ha,la)=>{this.aY(la)})});0==l.AFrameworkApplication.Kg.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Kg.QLi();
this.Xza(this.h0b)}aY(V){0!==V.newState&&1!==V.newState||0===V.oldState||1===V.oldState||this.kf.Fo||(this.Xza(this.NUe),z.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.n3g,this.NUe))}WQa(){return this.wqo?1==this.kf.networkState:1==this.kf.networkState||3==this.kf.networkState}i8b(){this.cwb=new Date;return new Promise((V,W)=>{if(this.WQa())z.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),
W(0);else if(this.kf.Sca)z.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),W(2);else if(this.Ow.KU)z.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),W(3);else{var T=r.b(G.a.construct(this.s$b()));z.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");var Y=0;Y=this.uwd.sj(H.serviceUrl,2,T,{"Content-Type":"application/json; charset=utf-8"},!1,0,ba=>this.EXm(ba,V,W),ba=>this.FXm(ba,
W),null,null,!0,this.jRe);0>=Y&&(z.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Y.toString()),W(0))}})}FXm(V,W){let T=2;if(V=V.data){if(5===V.status)T=1;else if(7===V.status||13===V.status)T=this.dpo?0:1;z.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",V.status))}else z.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");W(T)}EXm(V,W,T){if(V=V.data){var Y={},ba=V.Aj?V.Aj[y.a.VQ]:"";
Y.HttpStatus=V.Qe;Y.Correlation=ba;Y.Id=V.id;z.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Y);(V=this.Jva(V.se))?(this.e3.bVa(V),W(new F(V.LastSavedRevisionId,V.RevisionSequenceNumber))):(z.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),T(2))}else z.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),T(2)}Xza(V){0!==this.lYb&&window.clearTimeout(this.lYb);this.lYb=window.setTimeout(this.Xbo,V);z.ULS.sendTraceTag(525100416,
3037,50,"LastSavedToHostDetails request queued with timeout "+V)}s$b(){const V=m.App.za.jb.qc;return V?V.ed:null}Ofm(V){return 1===V?this.NUe:0===V?this.Tkk:3===V?this.h0b:this.qub}Jva(V){let W;return({group:W}=v.a.S1(V)).returnValue?W.Responses[0]:null}Jxk(V){this.sa.addHandler(H.xEi,V)}async g1h(){const V=new Promise((W,T)=>{window.setTimeout(T,3E3)});await Promise.race([V,this.i8b()]).then(()=>{z.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{z.ULS.sendTraceTag(509100304,
3038,15,"LSTHDM ran Synchronously: Failure")})}luj(){0!==this.lYb&&(z.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.lYb),this.lYb=0)}wtj(V){z.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",V);this.Xza(V)}get gec(){return this.cwb.getTime()}get ANh(){return this.aZj}VC(){const V={};V.LastScanTime=this.cwb.toISOString();V.RunCounter=this.QBc;return V}get dpo(){return null!=this.kFg?this.kFg:this.kFg=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}get wqo(){return null!=this.nFg?this.nFg:this.nFg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotCheckAppNetworkStatusTimeout",!1):!1}}H.xEi="ULSTHD";H.serviceUrl=m.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(D.a)(H,"LastSavedToHostDetailsManager",null,[1029,49]);var L=c(255),J=c(2094),M=c(12),
P=c(15);class N{constructor(V,W,T){this.yqm=V;this.cza=W;this.DXm=T;this.ZZf=()=>{const Y=this.yqm();return 32!==Y?Y:!this.cza||this.cza.KU?32:8};this.RUo=(Y,ba,Z,ea,ha)=>{this.DXm.Xza(parseInt(ha.toString()));return 32}}Tb(V){V.ra(P.a.ZZf,M.a.view,this.ZZf);V.ra(P.a.YDj,M.a.view,this.RUo);V.Xc(P.a.YDj,101)}}Object(D.a)(N,"LastSavedToHostDetailsManagerActor",null,[]);var K=c(223);c.d(I,"a",function(){return O});class O{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}wc(V){const W=
l.AFrameworkApplication.K;this.W=V;const T=new f.a(l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.He.oZ,l.AFrameworkApplication.He.cPh);this.W.ia("WordEditor.ILastSavedToHostDetailsManager",()=>new H(T,W,this.W.Oa("Common.ISessionStatus")||a.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),L.a.instance,this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).ha();this.a6f()}init(){(new N(()=>K.WoncaApp.IF.hmi(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),
this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Tb(l.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){k.a.instance.Gc(new O)}a6f(){this.W.ia("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new J.a(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),l.AFrameworkApplication.K.lc("LastSavedToHostDetailsIntervalMs",6E4),l.AFrameworkApplication.K.lc("TimerBasedWatchDogGracePeriodInMs",
18E4))).ha()}}Object(D.a)(O,"LastSavedToHostDetailsPackage",null,[1,2])},1780:function(D,I,c){D=c(0);var l=c(504),f=c(463),a=c(11),k=c(1482),x=c(2051),y=c(350),m=c(7),r=c(110),z=c(1539);class v{constructor(J,M,P){this.isVisible=J;this.elements=M;this.content=P}}Object(D.a)(v,"TooltipVisibilityArgs",null,[]);var G;(function(J){J[J.consistency=0]="consistency";J[J.Ymp=1]="pullQuote";J[J.Eqp=2]="suggestedImage";J[J.Zmp=3]="pullQuoteMenu";J[J.Hep=4]="designerPaste"})(G||(G={}));Object(D.b)("DesignerSuggestionType",
G);var F=c(134),H=c(1704);c.d(I,"a",function(){return L});class L extends k.a{constructor(J,M,P,N,K,O,V,W){super();this.Vm=J;this.zr=M;this.NXk=P;this.aOi=N;this.aj=K;this.eC=O;this.gI=V;this.qc=W;this.Xua=this.xFa=null;this.onMouseEnter=T=>{T=T.Uo;this.eC.n5i(new v(!0,[T.DGc],T.iJo));if(T.es&&0<T.es.length){const Y=this.gI.sU(T.es[0]);Y&&Y.suggestion.h3m()}return this.dkj(T)};this.jqa=T=>{this.eC.n5i(new v(!1));return this.oDh(T.Uo)};this.$Ga=T=>{if(L.p4a(T.Uo,this.Xua))return!0;this.eC.RLn(z.a.create(T.Uo.es[0]));
return!0};this.XWf=(T,Y)=>{Y.data?Y.data.isVisible?this.weo(Y.data.paragraphNode):this.uWk():m.ULS.shipAssertTag(573850384,3016,!1)};this.eC.h_e(this.XWf)}Rgo(J){J?(J=this.Vpf(J))&&this.dkj(J):m.ULS.shipAssertTag(589693324,3016,!1)}KWk(){this.oDh(this.xFa)}G7a(J){J=this.aj.fl(J.Bb);return!!J&&this.gI.gXc(J)}q0a(J){const M=J.D_a(0,F.a.mJk,this.zoom),P=[];P.push(this.sna(J.d1,M,J.Hoc[0].y-J.B4[0].y));return P}sna(J,M,P){var N,K=J.Tg.ownerDocument;const O=l.a.createElement(K,f.a.div);O.className=F.a.hJk;
O.style.left=M+"px";O.style.top=P+"px";M=l.a.createElement(K,f.a.div);M.className=F.a.kJk;K=l.a.createElement(K,f.a.div);K.className=F.a.iJk;J=this.aj.fl(J.Bb);P=this.gI.sU(J);if(null===(N=null===P||void 0===P?void 0:P.suggestion)||void 0===N?0:N.Hq)K.className+=String.format(" {0}",G[P.suggestion.Hq]);M.appendChild(K);O.appendChild(M);O.id=L.n4h(J);N=this.Vpf(J,O);1==N.nJk&&(K.className+=String.format(" {0}",F.a.jJk));this.Xua&&this.Xua.es.includes(J)?(O.className+=String.format(" {0}",F.a.n3e),
this.Xua=N):this.xFa&&this.xFa.es.includes(J)&&(O.className+=String.format(" {0}",F.a.m3e),this.xFa=N);this.aOi(a.a.TR,O,this.onMouseEnter,N);this.aOi(a.a.uL,O,this.jqa,N);this.NXk(a.a.click,O,this.$Ga,N);return O}weo(J){if(J){var M=this.Vpf(J);M?(this.gI.sU(J)&&(J=Object.assign(new x.a,{action:0,type:3,GA:M,SJ:this.Xua}),this.zr.EF(J)),this.Xua=M,L.p4a(this.xFa,this.Xua)&&(this.xFa=null)):m.ULS.shipAssertTag(590112344,3016,!1)}else m.ULS.shipAssertTag(590112343,3016,!1)}uWk(){if(this.Xua){var J=
Object.assign(new x.a,{action:1,type:3,GA:null,SJ:this.Xua});this.Xua=null;this.zr.EF(J)}}dkj(J){if(L.p4a(J,this.Xua)||L.p4a(J,this.xFa))return!0;const M=Object.assign(new x.a,{action:2,type:3,GA:J,SJ:this.xFa});this.xFa=J;this.zr.EF(M);return!0}oDh(J){if(L.p4a(J,this.Xua))return!0;J=Object.assign(new x.a,{action:3,type:3,GA:null,SJ:this.xFa});this.xFa=null;this.zr.EF(J);return!0}Vpf(J,M){M=M?M:this.dNl(J);if(!M)return null;const P=this.gI.sU(J);return new H.a(0<(null===P||void 0===P?void 0:P.qO.length)?
null===P||void 0===P?void 0:P.qO:[J],M,L.Uhi(P),L.eNl(P))}static Uhi(J){if(!J)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;switch(J.suggestion.Hq){case 0:return L.jYd(J.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return L.jYd(J.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;
case 2:return L.jYd(J.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static eNl(J){return J?L.jYd(J.state)?1:0:0}static jYd(J){return 0!==J&&.1!==J}dNl(J){var M=null,P=this.Vm.Tf(J);P.zb(11)&&(P.rc(),P=P.currentNode.vj(this.qc.$b))&&(J=String.format("#{0}",L.n4h(J)),M=P.htmlElement.querySelector(J),!M&&Object(r.a)(y.a,
P)&&(M=(M=P.DNd())?M.querySelector(J):null));return M}static n4h(J){return String.format("p{0}{1}",J.id.guid,J.id.n)}static p4a(J,M){return!!M&&!!J&&J.DGc===M.DGc}}Object(D.a)(L,"BlueDotActor",k.a,[568,569])},1781:function(D,I,c){D=c(0);var l=c(638);class f{constructor(k){this.RFa=k.x_l();this.UGb=k.Npf("intCopy");this.o9d=k.Qci("intCopy");this.NBb=k.Cnf("intCopy");this.Seb=k.cnf("intCopy")}static hF(){return f.Ur()}static Ur(){return new f(l.a.instance)}}Object(D.a)(f,"InternalCopyUsageHelper",null,
[]);c.d(I,"a",function(){return a});class a{constructor(k,x,y){this.XW=f.hF();this.ZEd=null;this.lQb=this.Rne=!1;this.ATg=null;this.source=k;this.target=x;this.rZf=y}get vka(){return this.XW}get Qo(){return this.ATg}set Qo(k){this.ATg=k}}Object(D.a)(a,"InternalCopyArguments",null,[])},1782:function(D,I,c){D=c(0);var l=c(1451);class f extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=
null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(D.a)(f,"ALocalCobaltServerResponse",l.a,[]);c.d(I,"a",function(){return a});class a extends f{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(D.a)(a,
"GetChangesResponse",f,[])},1783:function(D,I,c){D=c(0);var l=c(80);class f extends Sys.EventArgs{constructor(){super()}}Object(D.a)(f,"UploadEventArgs",Sys.EventArgs,[]);c.d(I,"a",function(){return a});class a{constructor(){this.sa=new l.a}epg(k){this.sa.raiseEvent("UploadStarted",new f(k,-1))}koc(k,x){this.sa.raiseEvent("UploadComplete",new f(k,x))}static get instance(){return null!=a.pBg?a.pBg:a.pBg=new a}}Object(D.a)(a,"Box4UploadNotifier",null,[557])},1784:function(D,I,c){D=c(0);var l=c(2),f=
c(397),a=c(22),k=c(181),x=c(9),y=c(2094),m=c(223),r=c(51),z=c(7),v=c(2060),G=c(1408),F=c(86),H=c(115),L=c(505);class J{constructor(P,N,K,O,V,W,T,Y){this.gW=null;this.zAc=this.Cfa=0;this.cwb=new Date(Date.UTC(0,1,1,0,0));this.zI={};this.RBc=this.QBc=0;this.qCh=async()=>{var ba;z.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",this.QBc++);if(this.kf.Fo)this.G6c(),this.stop(),z.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",
this.Ow.XUa);else{this.cwb=new Date;var Z={};Z.DocxSaveMonitor_IsUpToDate=null===(ba=this.gW)||void 0===ba?void 0:ba.KU;Z.RSNManager_IsUpToDate=this.Ow.KU;Z.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.Ow.b5b();Z.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.Ow.QHd();z.ULS.sendTraceTag(521413850,3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",Z);if(this.Vl&&!this.Vl.isVisible)z.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",
this.Ow.XUa),this.EDn();else if(ba=this.Ow.yJc(this.hvd),0<ba){ba=this.Q3h(ba);z.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(ba));this.nll&&z.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.VC());if(0==this.Cfa)this.zAc=this.gec;else if(1<this.Cfa){z.ULS.sendTraceTag(524137233,3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.Cfa,this.gec-this.zAc);if(this.UGm&&(!await this.Ow.jVd(this.Cpm)||0===this.Ow.yJc(this.hvd))){this.G6c();return}this.HLi(ba,this.gec);
this.zI.ShouldKickout&&(z.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.zI)),this.XZ.Ydc(this.Q_l()))}this.Cfa++}else this.G6c(),this.TUk()}};this.rCh=async()=>{await this.qCh();this.Ihg()};this.Ow=P;this.kf=N;this.XZ=T;this.Rgk=Y;this.qQe=O;this.hvd=V;this.ngk=W;this.gW=a.a.instance.Oa("Wonca.IDocxSaveMonitor");this.zI.ShouldKickout=!1;this.v_f=this.qAn;this.p0i=this.rAn;K.execute(ba=>{this.Vl=ba});this.kf.yNa(this.KY.bind(this))}get gec(){return this.cwb.getTime()}Q3h(P){return{["NumberOfStaleRevisions"]:P,
["BrowserIsOnline"]:v.a[this.kf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.kf.Fo,["IsSessionExpired"]:this.kf.Sca,["IsSessionLost"]:this.kf.nWc,["HasEmergencyViewDeployed"]:this.kf.Uj,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),["VisibilityManager_AppVisibilityState"]:this.Vl?G.a[this.Vl.JD]:"undefined"}}KY(P,N){if(N){P=Date.now();var K=this.Ow.yJc(this.hvd);0<K&&(K=this.Q3h(K),this.HLi(K,P));this.P7n();this.G3m(N.errorCode)}this.stop();
this.gW=a.a.instance.Oa("Wonca.IDocxSaveMonitor")}TUk(){this.Ow.vVd(this.ngk)&&this.OQo()}OQo(){z.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.Rgk.E5e();L.a.ilf(21)}Q_l(){return this.jSm?r.a.M3o:this.kf.Sca?r.a.WJj:r.a.L3o}stop(){0!==this.RBc&&(window.clearInterval(this.RBc),this.RBc=0);z.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async g1h(){this.ybp&&this.stop();this.rCh();z.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}eAo(P){this.RBc=
window.setTimeout(this.rCh,P);z.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.G6c()}Ihg(){this.RBc=window.setInterval(this.qCh,this.qQe);z.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.G6c()}P7n(){this.d2h(this.zI);z.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.zI))}get Xej(){const P=Object.assign({},this.zI);this.d2h(P);return P}d2h(P){P.shouldKickout||(0==this.Ow.yJc(this.hvd)?(P.NoKickoutReason="No Stale Revisions",P.OldestRevisionCreationTime=this.Ow.V8b()):
this.Vl&&!this.Vl.isVisible?(P.NoKickoutReason="Session not active",P.VisibilityManager_AppVisibilityState=this.Vl.JD):this.fBi&&this.Cfa<=this.p0i?(P.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",P.ScansWithPersistentRunawayDataLoss=this.Cfa):this.Cfa<=this.v_f?(P.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",P.ScansWithPersistentRunawayDataLoss=this.Cfa):P.NoKickoutReason="undefined");P.LastScanTime=this.cwb.toISOString();P.RunCounter=
this.QBc}VC(){const P={};this.gW&&(P.DSM=this.gW.VC());this.Ow&&(P.RSN=this.Ow.VC());return P}G6c(){z.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",this.Cfa,this.zAc);this.zAc=this.Cfa=0}EDn(){this.Cfa=Math.min(this.v_f-1,this.Cfa);this.zAc=Date.now()}fBi(){return 0===this.Vl.JD&&this.kf.WH&&!this.kf.nWc&&!this.kf.Sca&&!this.kf.Uj}HLi(P,N){this.Cfa>this.p0i&&this.fBi()?this.zI.ShouldKickout||
(this.zI.ShouldKickout=!0,this.e2h("Persistent RunawayDataLoss detected in active session",N,P)):this.Cfa>this.v_f&&!this.zI.ShouldKickout&&(this.zI.ShouldKickout=!0,this.e2h("Runaway DataLoss persists for more than 3 minutes.",N,P))}e2h(P,N,K){this.zI.KickoutTime=(new Date(N)).toISOString();this.zI.KickoutReason=P;this.zI.DSM_isUpToDate=this.gW?this.gW.KU:"Undefined";this.zI.SessionInfo=K}G3m(P){const N=this.zI.ShouldKickout;F.Health.instance.recordKpiUsage(J.lqe,1,J.fNd,null);const K=new Map;P&&
K.set("ErrorCode",P.toString());N?(K.set("ShouldKickout","true"),K.set("KickoutTime",this.zI.KickoutTime),K.set("Reason",this.zI.KickoutReason),F.Health.instance.recordKpiSuccess(J.lqe,Object.assign(new H.a,{extendedProperties:K}))):(K.set("ShouldKickout","false"),P=this.zI.NoKickoutReason,K.set("Reason",P),F.Health.instance.recordKpiFailure(J.lqe,P,!1,!1,Object.assign(new H.a,{extendedProperties:K})))}luj(){z.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}wtj(P){z.ULS.sendTraceTag(509686348,
3037,50,"RunawayDataLossMonitor started with interval {0}",P);this.lGf?this.eAo(P):(this.qQe=P,this.Ihg())}get nll(){return null!=this.Fwg?this.Fwg:this.Fwg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",!0)}get Cpm(){return null!=this.qzg?this.qzg:this.qzg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get UGm(){return null!=
this.GBg?this.GBg:this.GBg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get lGf(){return null!=this.dCg?this.dCg:this.dCg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}get rAn(){return null!=this.AEg?this.AEg:this.AEg=l.AFrameworkApplication.K.lc("RunawayDataLossMinimumScansBeforeKickout",1)}get qAn(){return null!=this.zEg?this.zEg:this.zEg=l.AFrameworkApplication.K.lc("RunawayDataLossMaximumScansBeforeKickout",
5)}get jSm(){return 1===this.kf.networkState||3===this.kf.networkState}get ANh(){return this.qQe}}J.lqe="RunAwayDataLossKickout";J.fNd="wwrelfc";Object(D.a)(J,"RunawayDataLossMonitor",null,[48,49]);c.d(I,"a",function(){return M});class M{constructor(){this.kQg=3E4;this.yZj=24E4;this.zZj=12E4;this.W=this.ivd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(x.App.ys||x.App.ym)this.ivd=this.W.resolve(this.name),this.ivd.Ihg(),this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),
0==l.AFrameworkApplication.Kg.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Kg.QLi()}ocl(){return new J(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("Common.ISessionStatus")||f.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),l.AFrameworkApplication.K.lc("RunawayDataLossScanIntervalInMs",this.kQg),this.d8n,this.zZj,a.a.instance.Oa("Box4.IKickoutExecutor"),m.WoncaApp.IF)}wc(P){if(x.App.ys||x.App.ym)this.W=P,P.ia(this.name,
this.ocl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.a6f()}dispose(){this.ivd&&this.ivd.stop()}static main(){k.a.instance.Gc(new M)}a6f(){this.W.ia("WordEditor.RunawayDataLossMonitorWatchDog",()=>new y.a(this.W.resolve(this.name),l.AFrameworkApplication.K.lc("RunawayDataLossScanIntervalInMs",this.kQg),l.AFrameworkApplication.K.lc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get d8n(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",
this.e8n)}get e8n(){return l.AFrameworkApplication.K.lc("RunawayDataLossKickoutIntervalInMs",this.yZj)}}Object(D.a)(M,"WordEditorRunawayDataLossMonitorPackage",null,[1,2])},1787:function(D,I,c){D=c(0);var l=c(31),f=c(1053);class a extends f.a{isUserPromptField(H){return new k(H)}annotationStatusField(H){return new x(H)}annotationCharCountField(H){return new y(H)}userPromptCharCountField(H){return new m(H)}precedingTextsCharCountField(H){return new r(H)}followingTextsCharCountField(H){return new z(H)}promptTriggerSourceField(H){return new v(H)}promptIdField(H){return new G(H)}}
Object(D.a)(a,"AiInserterDataFieldsFactoryImpl",f.a,[]);class k extends l.a{constructor(H){super();this.name="isUserPrompt";this.bool=H}}Object(D.a)(k,"IsUserPromptDataField",l.a,[]);class x extends l.a{constructor(H){super();this.name="annotationStatus";this.int64=H}}Object(D.a)(x,"AnnotationStatusDataField",l.a,[]);class y extends l.a{constructor(H){super();this.name="annotationCharCount";this.int64=H}}Object(D.a)(y,"AnnotationCharCountField",l.a,[]);class m extends l.a{constructor(H){super();this.name=
"userPromptCharCount";this.int64=H}}Object(D.a)(m,"UserPromptCharCountField",l.a,[]);class r extends l.a{constructor(H){super();this.name="precedingTextsCharCount";this.int64=H}}Object(D.a)(r,"PrecedingTextsCharCountField",l.a,[]);class z extends l.a{constructor(H){super();this.name="followingTextsCharCount";this.int64=H}}Object(D.a)(z,"FollowingTextsCharCountField",l.a,[]);class v extends l.a{constructor(H){super();this.name="promptTriggerSource";this.string=H}}Object(D.a)(v,"PromptTriggerSourceField",
l.a,[]);class G extends l.a{constructor(H){super();this.name="promptId";this.string=H}}Object(D.a)(G,"PromptIdField",l.a,[]);l=c(945);c.d(I,"a",function(){return F});class F extends l.a{constructor(H){super(H,"AiInsert");this.fieldsFactory=new a}}Object(D.a)(F,"AiInserterTelemetryLoggerImpl",l.a,[])},1818:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=
!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static Y3h(f){switch(f){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(D.a)(l,"WopiAuthContext",null,[807])},1819:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.Otn="OneDriveWOPI";Object(D.a)(l,"HostApplicationType",null,[])},1820:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.kKj="WAC_Word";
l.QSc=null;Object(D.a)(l,"AddinHostApp",null,[])},1822:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.RoleType=I.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(I.ErrorCode||(I.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";
c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(I.RoleType||(I.RoleType={}))},1823:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.NavigationPaneInputClassifierSignal=I.DesignerInputClassifierSignal=I.DocumentRoleDetectionAnnotation=I.RoleDetectionAnnotation=I.RoleDetectionSettings=I.RoleDetectionCustomMetadata=
I.BasePartialDocumentLevelAnnotation=I.WordNavPaneInputTargetDocumentClassificationAnnotation=I.WordDesignerInputTargetDocumentClassificationAnnotation=I.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=c(194);class f{constructor(F){l.SchemaObject.assign(f,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[f.getTypeName()])}}I.BaseInputTargetDocumentClassificationAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(F){l.SchemaObject.assign(a,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[a.getTypeName()])}}I.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(F){l.SchemaObject.assign(k,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[k.getTypeName()])}}I.WordNavPaneInputTargetDocumentClassificationAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(F){l.SchemaObject.assign(x,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[x.getTypeName()])}}I.BasePartialDocumentLevelAnnotation=x;x.H_=
{T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(F){l.SchemaObject.assign(y,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[y.getTypeName()])}}I.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class m{constructor(F){l.SchemaObject.assign(m,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[m.getTypeName()])}}I.RoleDetectionSettings=m;m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class r{constructor(F){l.SchemaObject.assign(r,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[r.getTypeName()])}}I.RoleDetectionAnnotation=r;r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};
class z{constructor(F){l.SchemaObject.assign(z,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[z.getTypeName()])}}I.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class v{constructor(F){l.SchemaObject.assign(v,
this,F)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[v.getTypeName()])}}I.DesignerInputClassifierSignal=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class G{constructor(F){l.SchemaObject.assign(G,this,F)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[G.getTypeName()])}}I.NavigationPaneInputClassifierSignal=G;G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()}},1824:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.extensions=f}}Object(D.a)(l,"ExtensionList",null,[])},1825:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1781);class l extends c.a{constructor(f,a){super(f.source,f.target,f.rZf);this.xi=f;this.insertAfter=a}get vka(){return this.xi.vka}get Qo(){return this.xi.Qo}set Qo(f){this.xi.Qo=f}}Object(D.a)(l,
"CoreInternalCopyArguments",c.a,[])},1826:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k,x,y=null){this.source=f;this.target=a;this.insertAfter=k;this.zYf=x;this.Qo=y||{}}}Object(D.a)(l,"CoreInternalPasteArguments",null,[])},1827:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a="",k="",x="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=k;this.Email=
x;this.IsCurrentUser=y}}Object(D.a)(l,"OfficeSharedCommentUser",null,[])},1828:function(D,I,c){c.d(I,"a",function(){return J});D=c(0);var l=c(54),f=c(1829),a=c(173),k=c(2),x=c(127),y=c(332),m=c(1386),r=c(770),z=c(536),v=c(1387),G=c(178),F=c(177),H=c(70),L=c(13);class J{constructor(M){this.vaa=this.Wh=this.v2=null;this.sD=0;this.TUb=this.ila=this.Vb=null;this.Deh=!1;this.Fve=null;this.XIh=!0;this.ga=M;this.Tb()}get zda(){return this.v2}get model(){return this.Wh}get lac(){return this.vaa}get Wfl(){return k.AFrameworkApplication.zoo}get IHo(){return k.AFrameworkApplication.aoj}get pil(){return CommonUIStrings.l_DeleteCommentConfirm}get TCo(){return!1}get yA(){return!1}get EPi(){return!1}get rhj(){return!1}get TWh(){return this.ila}set TWh(M){this.ila=
M}get mode(){return this.sD}set mode(M){M!==this.sD&&(this.sD=M,-1!==this.sD&&(this.v2.m5a(),this.Wh.m5a(),0===this.sD&&this.Sgf()))}get gQb(){return this.Deh}set gQb(M){this.Deh=M}get Mda(){return!1}get Zpj(){return!0}dispose(){this.v2&&(this.v2.dispose(),this.v2=null);this.Wh&&(this.Wh.dispose(),this.Wh=null);this.vaa&&(this.vaa.dispose(),this.vaa=null);this.Sgf()}selectComment(M,P=1){const N=this.Wh.UD(M);!N||2===this.mode&&1!==N.Xq||(this.Wh.selectComment(N),this.vaa.highlightComment(N,!0),this.v2.selectComment(N,
P),1===P&&this.gQb&&this.ila.selectComment(M))}P7c(){const M=this.Wh.P7c();M&&(this.vaa.highlightComment(M,!0),this.v2.selectComment(M),this.gQb&&this.ila.selectComment(M.id))}Q7c(){const M=this.Wh.Q7c();M&&(this.vaa.highlightComment(M,!0),this.v2.selectComment(M),this.gQb&&this.ila.selectComment(M.id))}Qee(M){M?this.selectComment(M,0):this.v2.tPi&&this.Onf().ak.Zy(this.v2.tPi)}clearSelection(){this.Wh.clearSelection();this.gQb&&this.ila.selectComment(null);this.vaa.IWk()}paneClosing(){this.yA||(2===
this.sD?(this.clearSelection(),this.deleteComment(this.Wh.Px)):this.clearSelection())}kAb(M){if(1===this.mode){M=f.a.JCb(M);var P=({anchor:N}=this.vaa.f7k()).returnValue;if(N&&0===P)this.addComment(M,N);else{switch(P){case 1:M=CommonUIStrings.l_NewCommentError;break;case 2:M=CommonUIStrings.l_NewCommentInvalidContent;break;default:M=CommonUIStrings.l_NewCommentError}var N=new F.StandardDialog;N.Cd=0;N.Uja(CommonUIStrings.l_DefaultDialogTitle,M,null)}}}addComment(M){0!==this.mode&&(this.Wh.Spk(M),
0===M.Xq||this.EPi||this.selectComment(M.id),this.ga.processAction(L.a.GFh,2))}editComment(M,P){1===this.mode&&M&&(this.Wh.ULc(M,P),this.selectComment(M.id))}G5e(){this.Wh.ORk()}addReply(M,P){1===this.mode&&(M=this.Wh.CJh(M,P),this.selectComment(M.id,0),this.ga.processAction(L.a.KFh,2))}deleteComment(M){if(1!==this.mode)if(2===this.mode){if(1!==M.Xq)return;this.mode=1}else return;this.Zpj&&1!==M.Xq?(this.TUb=M,M=new F.StandardDialog,M.Cd=4,M.rV(2),M.jgg(CommonUIStrings.l_DefaultDialogTitle,this.pil,
Object(l.a)(this,this.xil,"deleteDialogHandler"))):this.LKc(M)}Tb(){this.ga.fb(L.a.G_k,H.a.frame,x.ActionManager.Lf,64);this.ga.fb(L.a.H_k,H.a.frame,x.ActionManager.Lf,64);this.ga.fb(L.a.fFh,H.a.frame,x.ActionManager.Lf,64);this.ga.ra(L.a.f8e,H.a.frame,x.ActionManager.Lf);this.ga.ra(L.a.mFh,H.a.frame,x.ActionManager.Lf);this.ga.ra(L.a.nFh,H.a.frame,x.ActionManager.Lf);this.ga.fb(L.a.N_k,H.a.frame,x.ActionManager.Lf,64);this.ga.fb(L.a.O_k,H.a.frame,x.ActionManager.Lf,64);this.ga.ra(L.a.GFh,H.a.frame,
x.ActionManager.Lf);this.ga.ra(L.a.HFh,H.a.frame,x.ActionManager.Lf);this.ga.ra(L.a.KFh,H.a.frame,x.ActionManager.Lf);this.ga.fb(L.a.E0k,H.a.frame,x.ActionManager.Lf,64);this.ga.fb(L.a.G0k,H.a.frame,x.ActionManager.Lf,64);this.ga.fb(L.a.F0k,H.a.frame,x.ActionManager.Lf,64);this.ga.ra(L.a.MFh,H.a.frame,x.ActionManager.Lf);this.ga.ra(L.a.w5a,H.a.frame,()=>{this.w5a();return 32})}xil(M){1===M?this.LKc(this.TUb):(this.TUb&&this.selectComment(this.TUb.id),this.TUb=null)}LKc(M){const P=M.Af;1===M.Xq?this.ga.processAction(L.a.f8e,
2):this.ga.processAction(L.a.mFh,2);this.TUb=null;this.gQb||this.clearSelection();M=this.Wh.deleteComment(M);for(let N=0;N<M.length;N++)M[N].dispose();this.Qee(P)}HBb(M,P){0!==this.mode&&(this.ga.processAction(P?L.a.nFh:L.a.MFh,2),this.Wh.HBb(M,P))}hva(M){this.Wh.hva(M);this.mode=1;this.ga.processAction(L.a.HFh,2)}Lfb(M){this.Wh.Lfb(M);this.mode=1}U0k(M,P){this.Wh.TQn(M,P)}bUc(){}Sgf(){}BQb(M,P,N,K,O){return this.v2.BQb(M,P,N,K,O)}AV(M,P,N,K,O){return this.v2.AV(M,P,N,K,O)}Onf(){var M=this.Vb.getRegion(a.AFrame.Qr);
if(!M){const P=this.Vb.ae(a.AFrame.Qr);M=new y.DOMFocusListing(()=>this.zda.v2c);M.uja=!0;M.Mm(3);M.Mm(2);M.Mm(4);M.Mm(1);M.Mm(6);M.Mm(5);this.Vb.Vma(()=>this.zda.v2c,P,M);M=this.Vb.getRegion(a.AFrame.Qr);M.fTa();M.xP=!0;M.$_a=!0;P.kr(this.Vb.LW);P.kr(this.Vb.MW)}return M}xAd(M,P){0!==this.mode&&this.Wh.xAd(M,P)}Cce(M,P){0!==this.mode&&this.Wh.Cce(M,P)}w5a(){G.UISurfaces.IM().then(M=>{var P=Object.assign(new m.a,{target:this.rhj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new v.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});P=M.callout(P);const N=Object.assign(new z.a,{expirationOptions:Object.assign(new r.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.Fve=M.addNotification(P,N)})}dismiss(){G.UISurfaces.IM().then(M=>{M.removeNotification(this.Fve);return this.Fve=null})}static get instance(){return J._instance||
(J.factory?J._instance=J.factory():null)}static set instance(M){J._instance=M}}J._instance=null;J.factory=null;Object(D.a)(J,"CommentManager",null,[722,723,10])},1829:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(2),f=c(946);class a{constructor(){this.Zi=null;this.$g=[];this._changes=[];this.nbb=this.t_b=this.lz=null}get qt(){return this.lz}get Px(){return this.nbb}initialize(k){this.Zi=k}dispose(){const k=this.$g.length;for(let x=0;x<k;x++)this.$g[x].dispose();this.$g=[]}m5a(){this.lz&&
this.lz.m5a();this.t_b&&this.t_b.m5a()}selectComment(k){this.clearSelection();k.Ija=1;this.lz=k;if(k.Af){var x=Array.indexOf(this.$g,k);for(--x;0<=x;x--){const y=this.$g[x];if(y.id===k.Af){y.Ija=2;this.t_b=y;break}}}l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Lb.zpa&&f.ShyRibbon.sfb(1,0)}P7c(){if(!this.$g.length)return null;let k;k=this.lz?this.N5h(this.lz,!0):this.$g[0];this.selectComment(k);return k}Q7c(){if(!this.$g.length)return null;let k;k=this.lz?this.$Pl(this.lz):this.$g[this.$g.length-
1];this.selectComment(k);return k}clearSelection(){this.lz&&(this.lz.Ija=0,this.lz=null);this.t_b&&(this.t_b.Ija=0,this.t_b=null)}ULc(k,x){this.Zi.mode=3;k.Xq=2;k.DTa=0;k.yz=x;this.nbb=k}ORk(){this.nbb=null;this.Zi.mode=1}CJh(k,x){var y=this.UD(k);this.Zi.mode=2;this.nbb=k=c(1663).Comment.YJh(l.AFrameworkApplication.userName,k,y.lki,x);for(x=this.$g.length-1;0<=x;x--)if(y=this.$g[x],y.Af===k.Af||y.id===k.Af){Array.insert(this.$g,x+1,k);break}return k}hva(k){this.NFh(k,2)}Lfb(k){this.NFh(k,4)}deleteComment(k){const x=
[],y=Array.indexOf(this.$g,k);for(;y<this.$g.length;){const m=this.$g[y];if(m.id===k.id||m.Af===k.id)Array.removeAt(this.$g,y),Array.add(x,m);else break}this.f5c(x,3);-1<Array.indexOf(x,this.nbb)&&(this.nbb=null,this.Zi.mode=1);return x}HBb(k,x){const y=[];let m=Array.indexOf(this.$g,k);for(;m<this.$g.length;){const r=this.$g[m];if(r.id===k.id||r.Af===k.id)r.done=x,Array.add(y,r),m++;else break}this.f5c(y,x?0:1)}$O(){return Array.clone(this.$g)}P$b(){return!!this.$g&&!!this.$g.length}UD(k){for(let x=
0;x<this.$g.length;x++){const y=this.$g[x];if(y.id===k)return y}return null}N5h(k,x){k=Array.indexOf(this.$g,k);return k===this.$g.length-1?x?this.$g[0]:null:this.$g[k+1]}hWl(k,x=!1){let y=k=Array.indexOf(this.$g,k);do if(y=y===this.$g.length-1?0:y+1,!x||!this.$g[y].done)return this.$g[y];while(y!==k);return this.$g[k]}$Pl(k){return(k=Array.indexOf(this.$g,k))?this.$g[k-1]:this.$g[this.$g.length-1]}iWl(k,x=!1){let y=k=Array.indexOf(this.$g,k);do if(y=y?y-1:this.$g.length-1,!x||!this.$g[y].done)return this.$g[y];
while(y!==k);return this.$g[k]}xAd(){}Cce(){}NFh(k,x){const y=[];k.Xq=0;Array.add(y,k);this.f5c(y,x);this.nbb=null}static JCb(k){return c(1663).Comment.YJh(l.AFrameworkApplication.userName,null,c(1663).Comment.hZi,k)}}Object(D.a)(a,"CommentModel",null,[10,719])},1830:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.BIc="CommentPaneTextbox";l.sGd="CommentPane";l.M_k="CommentDeleteButton";l.D0k="CommentSaveButton";l.C0k="CommentReplyButton";l.K_k="CommentCancelButton";l.LFh="CommentTextEntry";
l.I0k="CommentTabHelp";Object(D.a)(l,"CommentManagerConstants",null,[])},1831:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(447),f=c(90),a=c(28);class k{dispose(){}static l0a(x,y,m,r=null,z=!0){var v=z?"":m;x=l.a("a",x,"StandardButton "+y);x.title=v;x.tabIndex=0;v=null;r?(v=f.createClusteredImage(16,16,r,"StandardButtonImage",!0,null),v.setAttribute(a.a.oh,a.a.rz),x.appendChild(v)):Sys.UI.DomElement.addCssClass(x,"StandardButtonNoImage");z?(r=l.a("span",null,"StandardButtonLabel"),
r.innerText=m,x.appendChild(r)):Sys.UI.DomElement.addCssClass(v,"StandardButtonImageNoText");x.setAttribute(a.a.oh,a.a.L3);return x}static APb(x,y){void 0!==x&&null!==x&&(x.disabled=!y,y?(y=a.a.uM,Sys.UI.DomElement.removeCssClass(x,"DisabledButton"),Sys.UI.DomElement.removeCssClass(x,"cui-disabled")):(y=a.a.pp,Sys.UI.DomElement.containsCssClass(x,"DisabledButton")||Sys.UI.DomElement.addCssClass(x,"DisabledButton"),Sys.UI.DomElement.containsCssClass(x,"cui-disabled")||Sys.UI.DomElement.addCssClass(x,
"cui-disabled")),a.a.ir(x,a.a.Q1e,y))}}Object(D.a)(k,"SimpleButtonFactory",null,[10])},1833:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);var l=c(79),f=c(11),a=c(2),k=c(20),x=c(19),y=c(42),m=c(7),r=c(3),z=c(9);class v{constructor(G,F,H,L,J="@"){this.yPe=this.Xod=this.YDe=this.ee=null;this.d2g=this.yvb=this.wla=this.gta=this.hLg=!1;this.sfa=0;this.nfg=!1;this.sMb=()=>{this.reset()};this.JNa=M=>{this.sfa=M.Hb.keyCode;var P=M.Hb.rawEvent.key;P&&P!==this.Ena||(this.nfg=!0);return this.wla&&this.Xod?
M.Hb.keyCode===l.a.a2||M.Hb.keyCode===l.a.Ls||M.Hb.keyCode===l.a.Fw?(P=!1,M.Hb.keyCode===l.a.a2?(m.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),P=!0):M.Hb.keyCode===l.a.Ls?m.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):M.Hb.keyCode===l.a.Fw&&m.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Xod(M),P&&this.reset(),!0):M.Hb.keyCode===l.a.yea||M.Hb.keyCode===l.a.m6||M.Hb.keyCode===
l.a.b2||M.Hb.keyCode===l.a.c2||M.Hb.keyCode===l.a.l6||M.Hb.keyCode===l.a.OL?(this.Xod(M),!0):!1:!1};this.Dra=M=>{if(this.nfg||this.wla){this.nfg=!1;var P=this.IQc(),N=this.tPc(M.Hb.target),K=M.Hb.rawEvent.inputType;return(void 0!==K&&null!==K||this.sfa!==l.a.oC&&this.sfa!==l.a.Z1)&&"deleteContentBackward"!==K&&"deleteContentForward"!==K?this.pli(P,N,M.Hb.target):!1}};this.eIk=M=>{if(1!==M.Hb.rawEvent.key.length)return!1;const P=this.IQc(),N=this.tPc(M.Hb.target);return this.pli(P,N,M.Hb.target)};
this.tRa=M=>{if(!this.wla)return!1;const P=this.IQc(),N=this.tPc(M.Hb.target);(M.Hb.keyCode===l.a.oC||M.Hb.keyCode===l.a.Z1||(M.Hb.keyCode===l.a.HVa||M.Hb.keyCode===l.a.Jpc)&&M.Hb.ctrlKey)&&this.Wwf(P,N,M.Hb.target);return!1};this.G2e=(M,P)=>{this.sfa=P.fCf?l.a.oC:P.isDelete?l.a.Z1:this.sfa;this.wla&&(P.fCf?this.Alm(P.MDi):P.isDelete&&this.hmm(P.MDi))};this.ze=G;this.nk=F;this.Fqc=H;this.kd=L;this.Ena=J;this.reset()}Peb(G,F){this.gta||(this.gta=!0,G.mxa?this.Qeb(F):G.fga(()=>{this.gta||this.Qeb(F)}))}dispose(){this.yvb&&
(z.App.za.Umc.sc(f.a.input,this.kd.ve.editingElement,this.Dra),this.yvb=!1);this.hLg&&(this.ee.sc(f.a.bDd,this.kd.ve.editingElement,this.eIk),this.hLg=!1);this.d2g&&(this.ee.sc(f.a.eG,this.kd.ve.editingElement,this.JNa),this.ee.sc(f.a.sh,this.kd.ve.editingElement,this.tRa));z.App.za.Oda(this.sMb);this.kuj()}N5f(G){this.YDe=G}W5f(G){this.yPe=G}O5f(G){this.Xod=G}kIk(){this.wla=!0;a.AFrameworkApplication.le("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}kuj(){this.wla=
!1}aE(){return this.wla}Qeb(G){this.ee=G;if(!this.kd.zd)m.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.kd.zd.Vi){if(z.App.MGc&&k.a.Zje||k.a.pu)z.App.za.Umc.ob(f.a.input,this.kd.ve.editingElement,this.Dra,null),this.yvb=!0;this.ee&&(this.ee.ob(f.a.eG,this.kd.ve.editingElement,this.JNa),this.ee.ob(f.a.sh,this.kd.ve.editingElement,this.tRa),this.d2g=!0);this.Fqc.jph(this.G2e);z.App.za.u_(this.sMb)}}pli(G,F,H){if(1>F)return!1;G=G.replace(new RegExp(v.newLine,
"g"),"");const L=G.charAt(F-1);this.wla&&L!==this.Ena?this.Wwf(G,F,H):this.wla||L!==this.Ena?this.wla&&L===this.Ena&&m.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.YDe&&(this.reset(),this.$En(F,G)&&(this.kIk(),this.Wwf(G,F,H),m.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===F?"true":"false")));return this.wla}reset(){this.gta=!1;this.kuj();this.yPe&&this.yPe()}tPc(G){return this.nk.I8b(2,G)}IQc(){return this.ze.sw().innerText}$En(G,
F){return 0>G-2||this.mTk(F.charAt(G-2))?!0:!1}mTk(G){return x.a.ada(G)||"("===G}Wwf(G,F,H){if(!G||""===G||0>F)this.reset();else{const {ogj:L,MCd:J}=this.VWm(G,F);this.YDe(L,H,J)}}VWm(G,F){const H=this.rMl(G,F);if(0<=H&&F<=G.length)return{ogj:G.substring(H,F),MCd:H};this.reset();return{ogj:"",MCd:H}}rMl(G,F){let H=-1,L=F;for(L;0<=L&&63>=F-L;L--)if(G.charAt(L)===this.Ena){H=L;break}63<F-L&&-1==H&&y.c(r.a.kOo,!0,void 0,void 0,void 0,void 0);return H}Alm(G){G=this.tPc(G.Hb.target);G=this.IQc().charAt(G-
1);this.wla&&G===this.Ena&&this.reset()}hmm(G){G=this.tPc(G.Hb.target);G=this.IQc().charAt(G);this.wla&&G===this.Ena&&this.reset()}}v.newLine="\n";Object(D.a)(v,"AtMentionsListener",null,[13])},1834:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);var l=c(7),f=c(78),a=c(766),k=c(122),x=c(8),y=c(347),m=c(1835);class r{constructor(v,G){this.MSc=v;this.bVc=G}G7h(){return this.bVc?this.MSc.Ac:this.MSc.end}wfo(v){this.bVc?this.MSc.Ac=v:this.MSc.end=v}sxi(v,G){const F=this.G7h()+(this.bVc?0:-1);return F>=
v&&F<G}}Object(D.a)(r,"HitRangeEdge",null,[]);class z{get Yc(){return null}get nj(){return null}get rpa(){return!1}get GCf(){return!1}lZe(){}A4d(){return!1}Emg(){return!1}r8h(v){return f.f(v,()=>!1)}ZEa(){return null}S3d(v,G,F,H,L){G=G||[];F=F||[];const J=[];let M=0,P=0,N=0;for(;M<G.length||P<F.length;){const K=M<G.length&&P<F.length?G[M].Ac<F[P].Ac?G[M++]:F[P++]:M<G.length?G[M++]:F[P++];J[N]=m.a.createInstance(K.Ac,K.end,v,N,H,L);++N}return J}LYl(v,G){if(!G)return null;if(!x.ParagraphReader.kHh(v))return this.kjb(v.characterData,
G);const F=this.vim(v,k.AParagraphNode.HNc);v=this.zim(v,F);G=this.kjb(v,G);if(!G)return G;G=this.$Bn(G);this.xWn(G,F);return G=this.XAl(G,F)}vim(v,G){G=Object(y.c)(G);const F=Object(y.a)(G);return[...x.ParagraphReader.TQc(v)].map(H=>{H.isVisible=F(H);return H})}zim(v,G){G=G.filter(F=>F.isVisible);return x.ParagraphReader.TTd(v,G)}$Bn(v){const G=[];for(const F of v)G.push(new r(F,!0)),G.push(new r(F,!1));return G}xWn(v,G){if(0!==v.length){var F=0,H=0;for(const L of G){if(F>=v.length)break;if(L.isVisible)for(;F<
v.length;){G=v[F];if(!G.sxi(L.R3.cp-H,L.cpEnd-H))break;G.wfo(G.G7h()+H);F++}else H+=L.cpEnd-L.R3.cp}}}XAl(v,G){if(0===v.length)return[];const F=[];let H=0,L=!1;for(const J of G){if(H>=v.length)break;if(J.isVisible)for(;H<v.length;){G=v[H];if(!G.sxi(J.R3.cp,J.cpEnd))break;G.bVc?L=!0:!G.bVc&&L&&(F.push(G.MSc),L=!1);H++}else L=!1}return F}jAi(){return!1}tAi(){return!1}kjb(v,G){if(G&&v){let F;const H=[];try{for(;F=G.exec(v);){const L=new a.a(F.index,G.lastIndex);H.push(L)}return H}catch(L){l.ULS.sendTraceTag(522846819,
313,15,L instanceof SyntaxError?"Invalid regular expression":`errorName: ${L.name}`)}}return null}oce(){}}Object(D.a)(z,"BaseFindManagerHelper",null,[668])},1835:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k,x,y,m,r){this.id=++l.Jfk;this.iLg=f;this.vab=a;this.V6g=k;this.tXg=x;this.Zj=y;this.wZg=m;this.jp=r;this.next=this.previous=null}get Ac(){return this.iLg}get end(){return this.vab}get type(){return this.Zj}ici(){return this.jp.ZEa(this.nodeId)}get nodeId(){return this.V6g}get iQa(){return this.tXg}get ZXd(){return this.wZg}a6k(f){this.iLg=
f.Ac;this.vab=f.end;this.V6g=f.nodeId;this.tXg=f.iQa;this.Zj=f.type;this.wZg=f.ZXd}static createInstance(f,a,k,x,y,m){const {FindManagerHelper:r}=c(1549);return new l(f,a,k,x,y,m,r.instance)}}l.Jfk=0;Object(D.a)(l,"FindResult",null,[688])},1836:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(54),f=c(92),a=c(20);class k{constructor(x,y,m){this.Ks=this.MXf=null;this.rch=this.Ycb=this.qch=this.bCa=0;this.wkd=null;this._context=x;this.Ib=y;this.Ga=m;this.m6b=!1;this.Vne=!0;this.b4n();this.rLb=
this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ga}get retryCount(){return this.bCa}get Q5n(){return this.qch}get V6a(){return this.Ycb}get R5n(){return this.rch}Hgc(x){this.Ks=x;if(!this.m6b){if(this.Vne){if(this.rLb&&a.a.YH){this.wkd=x.BKd(Object(l.a)(this,this.aVf,"onFileChosen"));return}this.wkd=x.BKd(null);if(!this.gAa(this.wkd,x))return}this.ePa(x,null)}}aVf(x){if(this.gAa(x,this.Ks)){if(a.a.YH||a.a.lj)this.wkd=x;this.ePa(this.Ks,null)}}O1c(){this.MXf&&
this.MXf()}X5n(x){if(!x||this.retryCount>=this.Q5n)return!1;this.bCa=this.retryCount+1;const y=new f.a(2,1,this.V6a,()=>{this.nde(x)},110);this.Ib.Xb(y);this.V6a<this.R5n&&(this.Ycb=2*this.V6a);return!0}b4n(){this.bCa=0;this.qch=this.K.lc("Box4UploadRetryCount",20);this.Ycb=this.K.lc("Box4UploadRetryDelayStart",200);this.rch=this.K.lc("Box4UploadRetryDelayMax",3200);this.Ks&&(this.Ks.dispose(),this.Ks=null)}}Object(D.a)(k,"FileUploader",null,[])},1837:function(D,I,c){c.d(I,"a",function(){return f});
D=c(0);var l=c(2);c=c(80);class f{static Lvk(a){f.yug.addHandler(f.SEh,a)}static jLn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&f.yug.raiseEvent(f.SEh,a)}}f.SEh="CommandClickEvent";f.yug=new c.a;Object(D.a)(f,"CommandClickEvents",null,[])},1838:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.ErrorCode=I.FormattingSuggestionsRange=I.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";
c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(I.FormattingSuggestionType||(I.FormattingSuggestionType={}));(function(c){c[c.Paragraph=
0]="Paragraph";c[c.List=1]="List"})(I.FormattingSuggestionsRange||(I.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(I.ErrorCode||(I.ErrorCode={}))},1839:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.FormattingSuggestionsSummaryAnnotation=I.FormattingSuggestionsAnnotation=void 0;const l=c(194);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}I.FormattingSuggestionsAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1840:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1841:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.PullQuotesSignal=I.DocumentPullQuoteAnnotation=I.PullQuoteAnnotation=void 0;const l=c(194);class f{constructor(x){l.SchemaObject.assign(f,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[f.getTypeName()])}}I.PullQuoteAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}I.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,
this,x)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}I.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1842:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1843:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1844:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1845:function(D,I,
c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToImageAnnotation=void 0;var l=c(194);D=function(){function f(a){l.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};
f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();I.TextToImageAnnotation=D},1846:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToImageSignal=void 0;var l=c(194);D=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};f.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();I.TextToImageSignal=D},1847:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToImageTraceSignal=void 0;var l=c(194);D=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_=
{T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();I.TextToImageTraceSignal=D},1848:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1849:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.ThemeExtractorSignal=I.ThemeExtractorAnnotation=void 0;const l=c(194);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}I.ThemeExtractorAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1850:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.TableType=
void 0;D=I.TableType||(I.TableType={});D[D.Other=0]="Other";D[D.SimpleHeaded=1]="SimpleHeaded"},1851:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TableTypeAnnotation=void 0;const l=c(194);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}I.TableTypeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1852:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);c(1565);var l=c(1626),f=c(2),a=c(19);c(1550);c(34);var k=c(7),x=c(1414),y=c(9),m=c(17),r=c(122),z=c(8);class v{constructor(G=2E3){this.dmk=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.Zbb=G}oIm(){v.kU();return!0}LUm(){return!0}getSelectedText(){const G=v.kU();return this.rTd(G)}btf(){const G=
v.kU();return this.obm(G)}rTd(G){return this.sfi(G,!0)}obm(G){return this.sfi(G,!1)}sfi(G,F){try{return this.nbm(G,F)}catch(H){k.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",H)}return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0})}nbm(G,F){var H=null;let L=!1;F&&G&&G.Vw&&m.SelectionEditor.ef(G.Pa)&&m.SelectionEditor.hlb(G.Pa)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),L=m.SelectionEditor.ef(G.Pa),(H=
m.SelectionEditor.c0(G.Pa,!1))&&H.Vw&&0<=H.Pa.cpBegin&&0<=H.Pa.cpEnd&&1>=H.Pa.cpEnd-H.Pa.cpBegin&&(H=null));H&&(G=H);if(!G)return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0});const J=new Sys.StringBuilder;H=F=0;const M=[],P=G.length;let N=null;for(let W=0;W<P;W++){var K=G.J(W);if(!z.ParagraphReader.Wb(K.node)||Array.contains(M,K.node.Bl))continue;M.push(K.node.Bl);const T=x.a.create(K.cpBegin,K.cpEnd),Y=z.ParagraphReader.Ehb(K.node,r.AParagraphNode.HNc,null,T);f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&L&&(N=this.Kyl(Y,T.Bd));let ba=Y,Z=0;var O=z.ParagraphReader.$f(K.node,!0,!0,!0);K=z.ParagraphReader.$f(K.node,!1,!0,!0);let ea=0;for(;ba.length<this.Zbb&&(O||K);){if(!(ea%2)&&O){var V=z.ParagraphReader.text(O,r.AParagraphNode.HNc);V&&(ba=V+" "+ba,Z+=V.length+1);O=z.ParagraphReader.$f(O,!0,!0,!0)}1===ea%2&&K&&(ba=(V=z.ParagraphReader.text(K,r.AParagraphNode.HNc))?ba+" "+V:ba,K=z.ParagraphReader.$f(K,!1,!0,!0));ea++}O=W===P-1;W||-1===T.Bd||(F=T.Bd);H+=O&&-1!==T.endCp?T.endCp:Y.length;J.append(ba);
f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&L&&N&&(F=N.start,H=N.start+N.length);F+=Z;H+=Z;O||(J.append(" "),H++)}for(G=r.AParagraphNode.NP(J.toString()," ");F<H&&a.a.Pv(G.charCodeAt(F));)F++;for(;H>F&&a.a.Pv(G.charCodeAt(H-1));)H--;return this.Pyk(G,F,H)}Kyl(G,F){for(var H;null!==(H=this.dmk.exec(G));){const L=H.index;H=H[0].length;if(F>=L&&F<=L+H)return{start:L,length:H}}return null}Pyk(G,F,H){if(G.length>this.Zbb){var L=H-F;if(L>
this.Zbb)G=G.substr(F,this.Zbb),H=this.Zbb,F=0;else{L=Math.max(F-Math.floor((this.Zbb-L)/2),0);let J;J=Math.min(L+this.Zbb,G.length);L=Math.max(J-this.Zbb,0);F-=L;H-=L;G=G.substring(L,J)}}return Object.assign(new l.a,{neighborhood:G,mentionStart:F,mentionLength:H-F})}static kU(){var G=y.App.za.jb.qc;if(!G)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;G=G.mb;return G&&G.hb&&G.hb.length?G.hb.lb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(D.a)(v,"Box4InsightsSelection",null,[642,643])},1853:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(402);class l extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(D.a)(l,"IconGalleryButtonProps",c.a,[])},1854:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.y=this.x=0}}Object(D.a)(l,"IPoint",null,[])},1855:function(D,I,c){c.d(I,"a",function(){return a});
D=c(0);var l=c(19),f=c(7);c=c(1586);class a extends c.a{constructor(k,x,y,m,r){super(k,x,r);this.hk=y;this.ifh=r}Lnc(k){let x;if(this.qT&&!k)return f.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,Ova:null};if(this.ifh){if(this.hk)return x=this.hk.JZf(k,!1),{returnValue:!0,Ova:x};f.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}x=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var y=0;y<k.length-1;y++){const m=document.createElement("p");
m.innerText=this.hZc(k[y]);x.appendChild(m)}y=document.createElement("span");y.innerText=l.a.lMc(k[k.length-1]);x.appendChild(y);return{returnValue:!0,Ova:x}}hZc(k){return l.a.lMc(k.length?k:" ")}}Object(D.a)(a,"MultiLineTextImportStrategy",c.a,[])},1856:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(862);class l extends c.a{constructor(f,a,k,x,y=null,m=0,r=0,z=null,v=null,G=null,F=null){super(y?y.V9:null,y?y.IB:null,y?y.uya:null,y?y.cultureName:null,y?y.HCa:null);this.src=f;this.alt=
a;this.width=k;this.height=x;this.maxWidth=m;this.maxHeight=r;this.href=z;this.Ejl=v;this.Lif=G;this.AFd=F}}Object(D.a)(l,"ImageSemanticArgs",c.a,[])},1857:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(111);class f{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,k,x,y,m,r,z,v,G,F,H,L,J,M,P,N=null){const K=new f;K.ImageId=a;K.Src=k;K.Alt=x;K.Width=y;K.Height=m;K.Desc=r;K.LockId=z;K.ImageAnchorId=v;K.IsImageFromPaste=G;K.EditContainerWidth=F;K.LocalizedPicture=H;K.IsLayoutSizeSetByUser=L;if(J&&0<J.length){K.ContentNodes=Array(J.length);a=0;for(const O of J)K.ContentNodes[a]=l.a(O),a++}K.RunId=M;K.WordId=P;K.ClipServiceArgs=N;return K}}Object(D.a)(f,"PastedPicture",null,[])},1858:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);
var l=c(22);c=c(589);class f extends c.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}el(){return 31}static construct(a,k,x=null,y=!1){const m=new f;m.DataUriPictures=k;m.PastedPictures=a;(a=l.a.instance.Oa("Box4.IFeatureHelper"))&&a.isFeatureEnabled(11)&&a.isFeatureEnabled(51)&&
(m.ClipServicePictures=y,m.ChartsPasteFromXLOIsEnabled=!0,m.InkEditingInCanvasSupportedIsEnabled=!0,m.PictureEditingInIllustrationCanvasIsEnabled=!0,m.InkExternalPartFileFormatFixIsEnabled=!0);x&&x.length&&(m.FileId=x);return m}}Object(D.a)(f,"PicturePasteRequest",c.a,[])},1859:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k,x=!1){this.REb=f;this.LDi=a;this.IQk=k;this.AWm=x}}Object(D.a)(l,"ClearSpecificFormattingProperties",null,[])},1862:function(D,I){Object.defineProperty(I,
"__esModule",{value:!0})},1863:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.SuggestionCategory=void 0;D=I.SuggestionCategory||(I.SuggestionCategory={});D[D.TextRelatedImage=0]="TextRelatedImage";D[D.AbstractImage=1]="AbstractImage";D[D.Icon=2]="Icon"},1864:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1865:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1866:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToSuggestionSignal=
void 0;var l=c(194);D=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();I.TextToSuggestionSignal=D},1867:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(92),f=c(192),a=c(7),k=c(110),x=c(57);class y{constructor(m,
r,z,v,G,F,H,L,J){this.Bzd=0;this.zW=null;this.Zdb="";this.sXb=this.qAe=!1;this.ZKa=this.G7=null;this.c8f=!1;this.yWb=null;this.Vzo=M=>{this.ZKa===M&&(this.ZKa=null,this.G7?this.Zdb=this.Hfa.u3c(this.zW.text):(this.aUf(),this.findInternal(null)),this.rtj())};this.findInternal=()=>{this.G7=null;if(!this.I5e())if(!this.Hfa.OMb(this.Zdb).length)this.kfb(),this.Hpb(!0);else if(!this.g9f())switch(this._state){case 0:this.x1o();break;case 1:this.c6i()}};this.Hab=m;this.Hfa=r;this.b1j=z;this.jp=v;this.pIe=
G;this.kyb=F;this.j1j=H;this.zWb=L;this.Oj=J;this._state=2;this.ZL=0}get vqg(){return this.Bzd}set vqg(m){this.Bzd=m}get Noc(){return this.Bzd}set Noc(m){this.Bzd=m}get taskManager(){return this.pIe.value}get COb(){return this.kyb.value}get S6c(){return this.j1j.value}get sBl(){return this.qAe}Hpb(m){(this.qAe=m)&&this.Hab&&this.Hab.P7b()}get Qjf(){return null}get DNc(){return this.yWb}find(m){this.zW=m;this.gXk();this.ZKa=new l.a(2,1,this.vqg,this.Vzo,51);this.taskManager.Xb(this.ZKa)}G_a(){}f9f(){}Kji(){}Pji(){}rmi(){return!1}gXk(){this.G7&&
(this.taskManager.Ze(this.G7),this.G7=null);this.ZKa&&(this.taskManager.Ze(this.ZKa),this.ZKa=null)}x1o(){var m=(new Date).getTime();this.lSi();const r=this.y1o(m);this._state||(this.G7=new l.a(2,1,this.Noc,this.findInternal,52),this.taskManager.Xb(this.G7));m=(new Date).getTime()-m;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:m,["Count"]:r})}Hvf(m,r,z=!0){this.UBh(m);if(Object(k.a)(59,m))if(12===m.type)this.Nkm(m,r,this.sXb,z);else{const v=this.jp.kjb(m.ZEa(),this.DNc);z&&(v&&
0<v.length?this.PTa(m,v):m.bna());z=this.jp.S3d(m.id,v,null,r,this.sXb);this.VAd(m.id,z,m,r);this.ENf(m)}}Nkm(m,r,z,v=!0){const G=[];var F=this.jp.r8h(m);if(!f.a.Xe(F)&&(this.ENf(m),v))for(var H of F)F=this.jp.kjb(H.ZEa(),this.DNc),f.a.Xe(F)?this.bna(H):(this.PTa(H,F),G.push(F));H=x.a.Sj?this.jp.LYl(m,this.DNc):this.jp.kjb(m.ZEa(),this.DNc);this.bna(m);!f.a.Xe(H)&&v&&this.PTa(m,H);z=this.jp.S3d(m.id,H,G,r,z);this.VAd(m.id,z,m,r)}y1o(m){let r=this._state=0;const z=this.igi();this.M1i();const v=this.rmj();
do this.TXf(),r++;while(this.K8e(z)&&(new Date).getTime()-m<y.uMi);v&&v.dispose();this.LTf();return r}aUf(){}rtj(){}I5e(){return!1}kfb(){}g9f(){return!1}c6i(){}lSi(){}UBh(){}PTa(){}bna(){}ENf(){}VAd(){}LTf(){}igi(){return null}M1i(){}rmj(){return null}TXf(){}K8e(){return!1}}y.uMi=200;Object(D.a)(y,"BaseFindManager",null,[1328])},1868:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a,k){this.rootNode=f;this.Zja=a;this.V7b=k}}Object(D.a)(l,"FindNodeContext",null,[])},1874:function(D,
I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a=null,k=null,x=null){this.iconSet={};this.iconSet["default"]=f;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=x}}Object(D.a)(l,"IconSetContainer",null,[])},1877:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(457);class l extends c.a{constructor(){super()}}l.Q9e="conversionRequestType";l.Q_f="png";l.Rlf="gc2json";l.strict="strict";l.qxl="existingcontent";l.error="error";Object(D.a)(l,"GraphicsEditorParameters",
c.a,[])},1890:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f){this.Psb=0;this.Dqd=isFinite(f)?Math.max(f,8):8;this.kp=Array(this.Dqd);this.Xj=this.deb=this.BYa=0;this.cPg=this.F6h(this.Dqd)}get count(){return this.Xj}get isEmpty(){return!this.count}enqueue(f){this.count===this.Psb&&this.Zvm();this.kp[this.deb]=f;this.deb++;this.deb===this.Psb&&(this.deb=0);this.Xj=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const f=this.kp[this.BYa];this.BYa++;
this.BYa===this.Psb&&(this.BYa=0);this.Xj=this.count-1;this.count<=this.cPg&&this.hgl();return f}RY(){if(!this.count)throw Error.create("Empty Queue");return this.kp[this.BYa]}Zvm(){this.Qkj(2*this.Psb)}hgl(){const f=Math.max(this.Psb/2,this.Dqd);this.count>f||this.Qkj(f)}Qkj(f){const a=Array(f);let k=0;if(this.BYa<this.deb||!this.count)for(var x=this.BYa;x<this.deb;x++)a[k]=this.kp[x],k++;else{for(x=this.BYa;x<this.Psb;x++)a[k]=this.kp[x],k++;for(x=0;x<this.deb;x++)a[k]=this.kp[x],k++}this.kp=a;
this.Psb=f;this.BYa=0;this.deb=k;this.cPg=this.F6h(f)}F6h(f){return f<=this.Dqd?-1:Math.floor(.25*f)}}Object(D.a)(l,"Queue",null,[])},1957:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1958:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.AiInsertAnnotationV2=I.AiInsertAnnotation=void 0;const l=c(194);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}I.AiInsertAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotationV2"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.AiInsertAnnotationV2=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1959:function(D,I){Object.defineProperty(I,
"__esModule",{value:!0});I.CountLimitType=void 0;D=I.CountLimitType||(I.CountLimitType={});D[D.character=0]="character";D[D.word=1]="word";D[D.sentence=2]="sentence";D[D.paragraphs=3]="paragraphs"},1960:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.LimitCount=I.AiInsertSignalV2=I.AiInsertSignal=void 0;const l=c(194);class f{constructor(x){l.SchemaObject.assign(f,this,x)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[f.getTypeName()])}}I.AiInsertSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignalV2"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}I.AiInsertSignalV2=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,this,x)}static getTypeName(){return"AugLoop_AiInsert_LimitCount"}static getBaseTypes(){return[]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[k.getTypeName()])}}I.LimitCount=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1961:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.Status=void 0;D=I.Status||(I.Status={});D[D.Success=0]="Success";D[D.BlockedByShortInputFilter=1]="BlockedByShortInputFilter";D[D.BlockedByLanguageDetector=2]="BlockedByLanguageDetector";D[D.BlockedByPrefilter=3]="BlockedByPrefilter";D[D.BlockedByContentModerator=4]="BlockedByContentModerator";D[D.BlockedByPostfilter=5]="BlockedByPostfilter";D[D.FailedToGenerateContent=
6]="FailedToGenerateContent";D[D.UnexpectedError=7]="UnexpectedError";D[D.InvalidInputError=8]="InvalidInputError";D[D.MissingTemplateError=9]="MissingTemplateError"},1962:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.QualityStatus=void 0;const l=c(194);class f{constructor(a){l.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_AiInsert_QualityStatus"}static getBaseTypes(){return[]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
I.QualityStatus=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1967:function(D,I,c){var l=c(1764),f=c(1765),a,k,x=0,y=0;D.exports=function(m,r,z){z=r&&z||0;var v=r||[];m=m||{};var G=m.node||a,F=void 0!==m.SDh?m.SDh:k;if(null==G||null==F){var H=l();null==G&&(G=a=[H[0]|1,H[1],H[2],H[3],H[4],H[5]]);null==F&&(F=k=(H[6]<<8|H[7])&16383)}H=void 0!==m.ldn?m.ldn:(new Date).getTime();var L=void 0!==m.QQi?m.QQi:y+1,J=H-x+(L-y)/1E4;0>J&&void 0===m.SDh&&(F=F+1&16383);(0>J||H>x)&&void 0===m.QQi&&(L=0);if(1E4<=
L)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");x=H;y=L;k=F;H+=122192928E5;m=(1E4*(H&268435455)+L)%4294967296;v[z++]=m>>>24&255;v[z++]=m>>>16&255;v[z++]=m>>>8&255;v[z++]=m&255;m=H/4294967296*1E4&268435455;v[z++]=m>>>8&255;v[z++]=m&255;v[z++]=m>>>24&15|16;v[z++]=m>>>16&255;v[z++]=F>>>8|128;v[z++]=F&255;for(F=0;6>F;++F)v[z+F]=G[F];return r?r:f(v)}},1968:function(D,I,c){var l=c(1764),f=c(1765);D.exports=function(a,k,x){x=k&&x||0;"string"==typeof a&&(k="binary"===a?Array(16):null,a=null);
a=a||{};a=a.random||(a.S6n||l)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(k)for(var y=0;16>y;++y)k[x+y]=a[y];return k||f(a)}},1973:function(D,I,c){c.r(I);D=c(0);var l=c(2),f=c(92),a=c(2054),k=c(7),x=c(69),y=c(54),m=c(110),r=c(247),z=c(546),v=c(370),G=c(76),F=c(3),H=c(9),L=c(62),J=c(43),M=c(1058),P=c(5),N=c(95);class K extends L.a{constructor(){super(new N.a(33));this.Sjf=this.e$f=0}JWd(){return 0}XGa(){const bb=new J.GraphTransaction(3);bb.Db(this);const mb=new P.GraphIterator;mb.set(this);if(mb.Gz()){const yb=
mb.Qd();mb.set(yb);const ab=M.b(mb,this.e$f,this.Sjf),Ga=new P.GraphIterator;Ga.set(this);Ga.Qd();Ga.vg();ab&&mb.currentNode!==yb&&Ga.xf(mb.currentNode,-2)}bb.dispose()}}Object(D.a)(K,"FindTrackingNode",L.a,[]);var O=c(17),V=c(48),W=c(8),T=c(1867),Y=c(1868);class ba{constructor(bb){this.Zc=bb;bb=[];bb.push(1);this.Nig=bb}p8h(bb){const mb=this.Zc.yk();mb.set(bb);const yb=[];mb.zb(8)&&(mb.ld(8),yb.push(new Y.a(mb.currentNode,bb,1)));return yb}static bF(){return new ba(new z.a)}static get instance(){return null!=
ba.tAg?ba.tAg:ba.tAg=ba.bF()}}Object(D.a)(ba,"FindContextHelper",null,[332]);var Z=c(1549),ea=c(365),ha=c(107),la=c(16);class ia{constructor(bb,mb,yb,ab,Ga,Za,Ub,Xb,zb){this.Ao=null;this.XWb=this.ZBe=!1;this.aab=this.EJg=this.p$a=null;this.kch=!1;this.LY=(Ib,$a)=>{Ib=$a.node;$a.property===la.a.vo&&this.zWc(Ib)&&this.YGb(Ib,3)};this.jnb=(Ib,$a)=>{Ib=$a.node;this.zWc(Ib)&&this.YGb(Ib,2)};this.Pia=(Ib,$a)=>{Ib=$a.node;$a=$a.ZCf;!this.eB.sBl&&$a||!this.zWc(Ib)||this.YGb(Ib,1)};this.processDirtyNodes=
()=>{const Ib=this.he.Vf("UserAction","ProcessDirtyNodesInFindResultsTime");this.Ao=null;const $a=this.Kc.Pc(3);$a.Db(this.jp.Yc);0<this.addedNodes.count&&(this.XWb=!0,this.oNg(this.addedNodes,this.eB.Oj));0<this.QKc.count&&this.oNg(this.QKc,this.eB.Oj);if(0<this.tfb.count){const Hb=!this.Uek(this.tfb,this.eB,this.jp,this.Tek);this.XWb=this.XWb||Hb}$a.dispose();this.eB.Oj.irb();this.ypb(this.XWb);this.Rfj();Ib.stop()};this.C9n=()=>{this.tFd();if(0<this.tfb.count||0<this.addedNodes.count||0<this.QKc.count)this.Ao=
new f.a(2,1,500,this.processDirtyNodes,53),this.Ib.Xb(this.Ao)};this.eB=bb;this.iW=mb;this.jp=yb;this.Ib=ab;this.Kc=Ga;this.oNg=Za;this.Uek=Ub;this.Tek=Xb;this.he=zb;this.reset();this.Rfj=this.C9n;this.jp.oce(this.LY,this.Pia,this.jnb)}get tfb(){return this.p$a}get addedNodes(){return this.EJg}get QKc(){return this.aab}get fdj(){return this.kch}get ypm(){return 0<this.tfb.count||0<this.QKc.count}start(){this.ZBe=!0;this.ypb(!1)}stop(){this.reset()}reset(){this.ZBe=!1;this.ypb(!1);this.p$a=new ea.a;
this.EJg=new ea.a;this.aab=new ea.a;this.tFd()}zWc(bb){return!!bb.Lc&&!!this.jp.nj&&bb.Lc.id.equals(this.jp.nj.id)}YGb(bb,mb){if(this.ZBe&&Object(m.a)(59,bb)&&!this.eB.COb.m6c)if(this.eB.Oj.x8a||this.eB.Oj.Elb.length){switch(mb){case 1:this.tfb.nb(bb.id)||this.addedNodes.Z(bb.id,bb);break;case 2:this.tfb.nb(bb.id)&&this.tfb.remove(bb.id);this.addedNodes.nb(bb.id)?this.addedNodes.remove(bb.id):this.QKc.Z(bb.id,bb);break;case 3:this.tfb.Z(bb.id,bb)}this.Rfj()}else 2!==mb&&this.ypb(this.XWb=!0)}tFd(){this.Ao&&
(this.Ib.Ze(this.Ao),this.Ao=null)}ypb(bb){this.fdj!==bb&&(this.kch=bb,this.iW.ypb(bb));bb||(this.XWb=!1)}static bF(bb,mb){return new ia(bb,mb,Z.FindManagerHelper.instance,ha.a.instance,new v.a,ia.AWk,ia.aWn,ia.$Vn,H.App.za.Iq)}static createInstance(bb,mb){return ia._instance||(ia._instance=ia.bF(bb,mb))}static aWn(bb,mb,yb,ab){let Ga=!1;const Za=ia.sii(bb,ia.O9m);for(let Ub=0;Ub<Za.length;++Ub){const Xb=!ab(Za[Ub],mb,yb);Ga=Ga||Xb;bb.remove(Za[Ub].id)}return!Ga}static $Vn(bb,mb,yb){const ab=mb.Oj;
bb.bna();const Ga=bb.id,Za=ab.e$b(Ga);if(Za)mb=yb.kjb(bb.ZEa(),mb.DNc),yb=yb.S3d(Ga,mb,null,Za.type,Za.ZXd),bb.PTa(mb),ab.jde(Ga,yb);else return!1;return!0}static AWk(bb,mb){const yb=ia.sii(bb,ia.N9m);for(let ab=0;ab<yb.length;++ab){const Ga=yb[ab],Za=Ga.id;Ga.bna();mb.S5c(Za);bb.remove(Za)}}static sii(bb,mb){const yb=[];let ab=mb;bb.forEach((Ga,Za)=>{yb.push(Za);--ab;return ab?!0:!1});return yb}}ia.O9m=5;ia.N9m=15;ia._instance=null;Object(D.a)(ia,"FindResultAppEventCoordinator",null,[1354]);class sa{constructor(bb,
mb){this.wzb=this.NTb=0;this.Gsc=this.YCc=this.Eka=null;this.H0b=0;this.Yvb=null;this.iW=bb;this.lla=mb;this.NYa=new ea.a;this.oyb=new ea.a;this.icb=new ea.a;this.iab=new ea.a;this.MYa=new ea.a(0);this.ABc=new ea.a;for(bb=0;bb<mb.length;++bb)this.MYa.Z(mb[bb],0);this.Elb=[]}get ME(){return this.Eka}set ME(bb){this.Eka=bb;bb=Array(1);bb[0]=this.Eka;this.iW.fPa(3,bb)}get I$(){return this.YCc}set I$(bb){this.YCc=bb}get b4(){return this.Gsc}set b4(bb){this.Gsc=bb}get HEa(){let bb=null;for(const mb of this.lla)if(bb=
this.NYa.J(mb))break;return bb}get bYe(){return this.NTb}ehe(bb){bb!==this.NTb&&(this.NTb=bb)}get ika(){return this.wzb}Okc(bb){bb!==this.wzb&&(this.wzb=bb,this.iW&&!this.wzb&&(this.iW.sfe(0),this.iW.$ge(0)))}get x8a(){return this.H0b}get cec(){return this.Yvb}jYe(bb,mb){if(bb&&!(0>=bb.length)){var yb=bb[0].type,ab=mb,Ga=ab?ab.next:this.NYa.J(yb);ab||this.NYa.Z(yb,bb[0]);for(const Za of bb){const Ub=Za;this.ABc.Z(Ub.id,Ub);ab&&(ab.next=Ub);Ub.previous=ab;ab=Ub}ab&&(ab.next=Ga);Ga&&(Ga.previous=ab);
mb&&bb[0].nodeId.equals(mb.nodeId)||this.icb.Z(bb[0].nodeId,bb[0]);!Ga&&ab&&this.oyb.Z(ab.type,ab);this.cec===mb&&(this.Yvb=ab);this.MYa.Z(yb,this.MYa.J(yb)+bb.length);this.Okc(this.ika+bb.length);this.H0b=this.x8a+bb.length;this.iW&&this.iW.fPa(0,bb)}}ZAd(bb){!bb||0>=bb.length||this.jYe(bb,this.oyb.J(bb[0].type))}rmh(bb){!bb||0>=bb.length||(this.cec&&this.cec.type!==bb[0].type&&(this.Yvb=null),this.jYe(bb,this.cec))}S5c(bb){const mb=this.e$b(bb);if(mb){bb=mb;for(var yb=0;bb;){++yb;if(!bb.next||!bb.nodeId.equals(bb.next.nodeId))break;
bb=bb.next}this.a$i(mb,bb)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",bb.toString())}a$i(bb,mb){let yb=0,ab=0;const Ga=[];let Za=bb;for(;Za!==mb.next;){const Ub=this.FAi(Za);this.icb.J(Za.nodeId).id===Za.id&&(Za.next&&Za.next.nodeId.equals(Za.nodeId)?(this.icb.Z(Za.nodeId,Za.next),Ub&&this.iab.Z(Za.nodeId,Za.next)):(this.icb.remove(Za.nodeId),Ub&&this.iab.remove(Za.nodeId)));this.cec&&this.cec.id===Za.id&&(this.Yvb=bb.previous);this.I$&&this.I$.id===
Za.id&&(this.I$=this.vrf(Za,bb));this.b4&&this.b4.id===Za.id&&(this.b4=this.vrf(Za,bb));this.ME&&this.ME.id===Za.id&&(this.ME=this.vrf(Za,bb));this.ABc.remove(Za.id);Ga.push(Za);Za=Za.next;Ub?++ab:++yb}bb.previous?bb.previous.next=mb.next:mb.next?this.NYa.Z(mb.type,mb.next):this.NYa.remove(mb.type);mb.next?mb.next.previous=bb.previous:bb.previous?this.oyb.Z(bb.type,bb.previous):this.oyb.remove(bb.type);mb.next=null;bb.previous=null;this.MYa.Z(bb.type,this.MYa.J(bb.type)-yb);this.Okc(this.ika-yb);
this.H0b=this.x8a-(yb+ab);this.iW&&this.iW.fPa(1,Ga)}jde(bb,mb){const yb=this.e$b(bb);if(yb){const ab=[],Ga=[],Za=[];let Ub=yb,Xb,zb=0;do zb<mb.length?(Ub.a6k(mb[zb]),ab.push(Ub)):(Ga.push(Ub),this.I$&&this.I$.id===Ub.id&&0<ab.length&&(this.I$=ab[ab.length-1])),++zb,Xb=Ub,Ub=Ub.next;while(Ub&&Xb.nodeId.equals(Ub.nodeId));for(;zb<mb.length;++zb)Za.push(mb[zb]);0<Ga.length&&this.a$i(Ga[0],Ga[Ga.length-1]);0<Za.length&&this.jYe(Za,0<ab.length?ab[ab.length-1]:yb);mb=ab.length;if(0<mb){if(this.iab.nb(bb)){this.iab.remove(bb);
this.Okc(this.ika+mb);let Ib,$a;(Ib=this.MYa).Z($a=ab[0].type,Ib.J($a)+mb)}this.iW&&this.iW.fPa(4,ab)}}else k.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",bb.toString())}zDh(){this.icb=new ea.a;this.iab=new ea.a;this.NYa=new ea.a;this.oyb=new ea.a;this.ABc=new ea.a;for(let bb=0;bb<this.lla.length;++bb)this.MYa.Z(this.lla[bb],0);this.ME=null;this.ehe(0);this.b4=this.I$=this.Yvb=null;this.Okc(0);this.H0b=0;this.iW&&this.iW.fPa(2,null)}ELi(){this.iab=
new ea.a;this.icb.forEach((bb,mb)=>{this.iab.Z(bb,mb);return!0});for(let bb=0;bb<this.lla.length;++bb)this.MYa.Z(this.lla[bb],0);this.ME=null;this.ehe(0);this.Yvb=null;this.Okc(0);this.iW&&this.iW.fPa(2,null)}e$b(bb){return this.icb.nb(bb)?this.icb.J(bb):null}jP(bb){let mb=null;this.ABc.nb(bb)&&(mb=this.ABc.J(bb));return mb}C8h(bb){return this.NYa.nb(bb)?this.NYa.J(bb):null}j0l(bb){return this.oyb.nb(bb)?this.oyb.J(bb):null}irb(){var bb=0;if(this.ME){bb=0;const ab=this.ME.type;var mb=this.NYa.J(ab);
if(mb){for(var yb=1;mb&&this.ME.id!==mb.id;)this.FAi(mb)||++yb,mb=mb.next;mb&&(bb=yb)}if(mb){mb=0;for(yb=0;yb<this.lla.length&&this.lla[yb]!==ab;++yb)mb+=this.MYa.J(this.lla[yb]);bb=mb+bb}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.ME=null,bb=0}this.ehe(bb);this.iW&&(this.iW.sfe(this.bYe),this.iW.$ge(this.ika))}r2a(bb){return this.gSd(bb,!1)}WSd(bb){return this.gSd(bb,!0)}gSd(bb,mb){let yb=mb?bb.previous:bb.next,
ab=bb.type;for(;!yb&&(ab=this.a4l(ab,mb),yb=mb?this.j0l(ab):this.C8h(ab),ab!==bb.type););return yb||bb}g9b(bb){return this.A5h(bb,!1)}Z$h(bb){return this.A5h(bb,!0)}A5h(bb,mb){let yb=this.gSd(bb,mb);for(;yb.nodeId.equals(bb.nodeId)&&yb.id!==bb.id;)yb=this.gSd(yb,mb);return yb}a4l(bb,mb){let yb=0;for(let ab=0;ab<this.lla.length;++ab)if(bb===this.lla[ab]){yb=ab;break}mb?(--yb,0>yb&&(yb=this.lla.length-1)):(++yb,yb===this.lla.length&&(yb=0));return this.lla[yb]}vcj(){this.Yvb=null}vrf(bb,mb){bb=this.r2a(bb);
bb.id===mb.id&&(bb=null);return bb}FAi(bb){return this.iab.nb(bb.nodeId)}static createInstance(bb,mb,yb=!1){return yb?new sa(bb,mb):sa._instance||(sa._instance=new sa(bb,mb))}}sa._instance=null;Object(D.a)(sa,"FindResultManager",null,[1327]);class Oa{constructor(bb,mb){this.gkm=yb=>{const ab=this.jp.nj.Eb(yb.nodeId);if(ab){if(this.xC.ME){var Ga=this.jp.nj.Eb(this.xC.ME.nodeId);(Ga=Object(x.a)(59,Ga))?Ga.aDh():k.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",
["NodeId"]:this.xC.ME.nodeId})}ab.rNf(yb.iQa,yb.type)?(this.xC.ME=yb,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:yb.id})):c(1973).FindManager.instance.rmi()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:ab.id,["HitIndexInNode"]:yb.iQa,["ResultId"]:yb.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:ab.id,["HitIndexInNode"]:yb.iQa,["ResultId"]:yb.id});this.xC.irb()}else k.ULS.sendTraceTag(4069059,
313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:yb.nodeId})};this.xC=bb;this.jp=mb;this.ovf=this.gkm}Nji(){const bb=this.xC.ME?this.xC.r2a(this.xC.ME):this.xC.HEa;this.ovf(bb)}fkm(){const bb=this.xC.ME?this.xC.WSd(this.xC.ME):this.xC.HEa;this.ovf(bb)}Rji(bb){const mb=this.xC.jP(bb);mb?this.ovf(mb):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:bb})}static bF(bb){return new Oa(bb,Z.FindManagerHelper.instance)}static createInstance(bb){return Oa._instance||
(Oa._instance=Oa.bF(bb))}}Oa._instance=null;Object(D.a)(Oa,"FindResultNavigator",null,[1326]);var Ra=c(19),Na=c(1222);L=c(146);class Da{static OMb(bb){const mb=[];var yb=RegExp('"[^"\\r\\n]*"',"ig"),ab=bb.match(yb);let Ga;if(ab&&0<ab.length)for(Ga=0;Ga<ab.length;Ga++){var Za=ab[Ga].split('"').join("");Za=Za.trim();Za=Za.split(Da.z$c).join(" ");if(""!==Za){mb.push(Za);var Ub=Za.split(Da.punctuation).join(" ");Ub=Ub.trim();Ub=Ub.split(Da.z$c).join(" ");""!==Ub&&Ub!==Za&&mb.push(Ub)}}bb=bb.split(yb).join(" ");
yb=Na.a.instance.KNl(bb);if(!yb.length)return mb.sort(Da.Fsj),mb;ab=yb[0];for(Ga=1;Ga<yb.length;Ga++)if(Ub=yb[Ga],2!==ab.QL||2!==Ub.QL)Za=bb.substring(ab.cp,Ub.cp),Za=Za.trim(),Da.qDi(Za,ab)&&mb.push(Za),ab=Ub;Za=bb.substring(ab.cp,bb.length);Za=Za.trim();Da.qDi(Za,ab)&&mb.push(Za);mb.sort(Da.Fsj);return mb}static qDi(bb,mb){return""!==bb&&'"'!==bb&&1!==mb.QL}static H1n(bb){for(let mb=0;mb<bb.length;mb++)bb[mb]=bb[mb].split(Da.z$c).join("\\s+");return bb}static Fsj(bb,mb){return bb.length>mb.length?
-1:bb.length===mb.length?0:1}}Da.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");Da.z$c=RegExp("\\s+");Da.NRn=[new L.a(RegExp("\\[","g"),"\\["),new L.a(RegExp("\\]","g"),"\\]"),new L.a(RegExp("\\\\","g"),"\\\\"),new L.a(RegExp("\\^","g"),"\\^"),new L.a(RegExp("\\$","g"),"\\$"),new L.a(RegExp("\\.","g"),"\\."),new L.a(RegExp("\\|","g"),"\\|"),new L.a(RegExp("\\+","g"),"\\+"),new L.a(RegExp("\\(","g"),"\\("),new L.a(RegExp("\\)","g"),"\\)"),new L.a(RegExp("\\?","g"),
"\\?"),new L.a(RegExp("\\*","g"),"\\*")];Object(D.a)(Da,"SearchAndFindUtils",null,[]);class ra{u3c(bb){return Ra.a.$ga(bb,Da.NRn)}OMb(bb){bb=Da.OMb(bb);return bb=Da.H1n(bb)}Q1i(){return null}H0d(){return!1}static get instance(){return null!=ra.VAg?ra.VAg:ra.VAg=new ra}}Object(D.a)(ra,"QueryProcessor",null,[935]);var xa=c(731),fa=c(22),oa=c(12),ta=c(26),Ka=c(649),va=c(766),La=c(204),za=c(236);class Ca{constructor(){this.n6c=this.transaction=null;this.Tqb=this.e8f=0;this.b8f=this.pgb=null}}Object(D.a)(Ca,
"ReplaceAllContext",null,[]);class ua{constructor(bb,mb,yb,ab,Ga,Za,Ub,Xb,zb,Ib,$a){this.pmn=(Hb,Ya,Sa,Eb,Jb)=>{let vb=null;if(Hb>Ya)for(vb=Sa;0<Ya&&vb.nodeId.equals(Jb.id);)vb=this.xC.r2a(vb),--Ya;else 0<Hb?vb=this.xC.g9b(Sa):Eb.nodeId!==Jb.id&&(vb=Eb);return vb};this.rDh=()=>{const Hb=this.xC.Elb;if(Hb&&0<Hb.length){const Ya=this.Kc.Pc(3);Ya.Db(this.jp.nj.Eb(Hb[0]));for(let Sa=0;Sa<Hb.length;++Sa){const Eb=this.jp.nj.Eb(Hb[Sa]);Eb?Eb.bna(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",
Hb[Sa])}Ya.dispose();Array.clear(this.xC.Elb)}};this.dsn=(Hb,Ya)=>{this.rBc=!0;this.D9i();const Sa=new Ca;Sa.n6c=Hb?Hb:"";Sa.b8f=Ya;Sa.Tqb=this.xC.ika;Hb=this.Kc.Pc(15);Hb.Db(this.jp.Yc);Sa.transaction=Hb;this.dxl(Sa,Hb)};this.Iln=(Hb,Ya)=>{Hb=new xa.a(null,this.WGn,Hb);const Sa=this.jp.Yc;Sa&&Sa.uJ().mF.V7(9);Hb.Ml("ReplaceAll");Ya.iIa(Hb);Hb.run()};this.Tpn=(Hb,Ya)=>{Hb=this.he.Vf("UserAction","OnProcessReplaceAll");if(this.XQm(Ya))return this.x1k(Ya),!1;let Sa=Ya.pgb;Sa||(Sa=this.xC.HEa);Ya.pgb=
this.xC.g9b(Sa);const Eb=this.jp.nj.Eb(Sa.nodeId);if(!Eb)return k.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Sa.id,Sa.nodeId),!0;const Jb=Eb.GPa();if(Jb&&Jb.length)if(this.vTk(Eb,Jb[0].Ac,Jb[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",Eb.id);else{let vb=0;for(let ac=0;ac<Jb.length;++ac){Ya.e8f+=1;const dc=this.replaceText(this.eB.Qjf,Eb,Ya.n6c,ta.a.createTextRange(Eb,Jb[ac].Ac+vb,Jb[ac].end+
vb));vb+=Ya.n6c.length-(Jb[ac].end-Jb[ac].Ac)+dc;Eb.bdg(0,Ya.n6c.length)}0<Ya.n6c.length&&this.xC.Elb.push(Sa.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Sa.id,Sa.nodeId);Hb.stop();return!0};this.kkn=Hb=>{Hb.transaction.dispose();this.rBc=!1;this.eB.G_a(!1);Hb.b8f&&Hb.b8f(Hb.e8f,Hb.Tqb)};this.Eqn=(Hb,Ya,Sa,Eb)=>{!Hb.matchCase&&0<Sa.length&&(Hb=Ya.ZEa().substr(Eb.cpBegin,Eb.cpEnd-Eb.cpBegin),Sa=this.eSk(Sa,Hb));return this.sBc(Eb,
Sa,!0,!1)};this.eB=bb;this.xC=mb;this.jp=yb;this.Kc=ab;this.oIe=Ga;this.p6j=Ub;this.mJg=Xb;this.sBc=zb;this.B8j=Ib;this.he=$a;this.rBc=!1;this.qAo=this.dsn;this.WGn=this.Tpn;this.x1k=this.kkn;this.dxl=this.Iln;this.D9i=this.rDh;this.replaceText=this.Eqn;this.eSk=ua.ujn;this.h4l=this.pmn}get CL(){return this.oIe.value}get m6c(){return this.rBc}replace(bb){var mb=!1;if(this.m6c)return k.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),mb;if(this.CL.dfl){var yb=
this.CL.k4;const Za=yb.node;yb.contextId===oa.a.paragraph&&(yb=ta.a.createTextRange(Za,0,W.ParagraphReader.textLength(Za)));var ab=Object(x.a)(59,Za);if(ab){var Ga=new va.a(yb.cpBegin,yb.cpEnd);Ga=ab.g$h(Ga);if(Ga!==Ka.a.invalid&&0<=Ga){if(this.DBh(yb))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),mb;this.rBc=!0;mb=this.Kc.Pc(15);mb.Db(Za);this.replaceText(this.eB.Qjf,ab,bb,yb);mb.dispose();this.D9i();ab.bdg(Ga,bb.length);0<bb.length&&this.xC.Elb.push(Za.id);
bb=this.xC.e$b(Za.id);yb=this.xC.r2a(bb);ab=ab.GPa();ab=this.jp.S3d(Za.id,ab,null,bb.type,bb.ZXd);this.xC.jde(Za.id,ab);(yb=this.h4l(ab.length,Ga,bb,yb,Za))?this.eB.S6c.Rji(yb.id):this.xC.irb();mb=!0;this.rBc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");
mb?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this.eB.c8f=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.eB.S6c.Nji());return mb}replaceAll(bb,mb){this.m6c?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.xC.ika?this.qAo(bb,mb):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}DBh(bb){const mb=this.p6j(bb);!mb&&this.mJg.value&&this.B8j.value&&this.mJg.value(bb.node);
return mb}vTk(bb,mb,yb){return this.DBh(ta.a.createTextRange(bb,mb,yb))}XQm(bb){return bb.pgb===this.xC.HEa}static get ig(){return null!=ua.pvg?ua.pvg:ua.pvg=fa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static bF(bb,mb){const yb=new r.a(()=>H.App.xd&&H.App.xd.Yp?Object(y.a)(H.App.xd.Yp,H.App.xd.Yp.$F,"acquireAndApplyLock"):null);return new ua(bb,mb,Z.FindManagerHelper.instance,new v.a,new r.a(()=>La.a.instance),new r.a(()=>V.a.instance),Object(y.a)(za.a.instance,za.a.instance.WHm,"isContextSetInLockedRange"),
yb,Object(y.a)(ua.ig,ua.ig.Ge,"replaceTextRange"),new r.a(()=>H.App.xd.So),H.App.za.Iq)}static createInstance(bb,mb){return ua._instance||(ua._instance=ua.bF(bb,mb))}static ujn(bb,mb){const yb=Ra.a.Zg(mb);!Ra.a.localeCompare(Ra.a.ZA(mb),mb)&&Ra.a.localeCompare(yb,mb)?bb=Ra.a.ZA(bb):Ra.a.Bdc(mb.charAt(0))&&!Ra.a.TEf(mb.charAt(0))&&(mb=Ra.a.ZA(bb.substr(0,1)),bb=1===bb.length?mb:mb+bb.substr(1,bb.length-1));return bb}}ua._instance=null;Object(D.a)(ua,"ReplaceManager",null,[1257]);c.d(I,"FindManager",
function(){return ib});class ib extends T.a{constructor(bb,mb,yb,ab,Ga,Za,Ub,Xb,zb,Ib,$a,Hb,Ya,Sa,Eb,Jb=!1){super(bb,mb,yb,Ga,Za,Ya,Sa,$a,Hb);this.kla=this.$Bc=null;this.Dzd=!1;this.CCa=this.X$a=this.Mbb=null;this.muc=0;this.fxd=ab;this.jwb=Ub;this.Zc=Xb;this.Kc=zb;this.DNe=Ib;this.i1j=Eb;this.Qxc=[];this._state=2;this.Nyb=!Jb;this.stb=new K;this.jp.lZe(this.stb);this.Y_b=new K;this.jp.lZe(this.Y_b);this.jp.Yc&&(this.Mbb=this.jp.nj);this.vqg=400;this.Noc=100}get mb(){return this.jwb.value}get Qjf(){return this.$Bc}get INd(){return this.i1j.value}G_a(bb=
!0){this.COb&&this.COb.m6c||(this.kfb(bb),this.Hab.reset(),this.Zdb="",this.fxd&&this.INd.stop(),this.hXk(),this.Olj(null))}hXk(){this.G7&&(this.taskManager.Ze(this.G7),this.G7=null);this.ZKa&&(this.taskManager.Ze(this.ZKa),this.ZKa=null)}kfb(bb=!0){!this.Mbb&&0<this.Oj.x8a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.Oj.x8a&&this.Mbb){let yb=this.Oj.HEa;const ab=yb.nodeId;if(this.Mbb.Eb(ab)){const Ga=this.Kc.Pc(3);for(Ga.Db(this.Mbb.Eb(ab));yb;){const Za=
this.Mbb.Eb(yb.nodeId);var mb=Object(x.a)(59,Za);if(mb){if(this.Nyb&&(mb.bna(void 0,bb),W.ParagraphReader.Wb(Za)&&(mb=this.jp.r8h(Za))))for(const Ub of mb)Ub.bna(void 0,bb);Za.gl(16,!0)}yb=this.Oj.g9b(yb);if(!yb||yb.nodeId.equals(ab))break}Ga.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Oj.zDh()}bb&&this.COb&&this.COb.rDh();this.Bcj();this.Qxc=[];this.yWb=this.$Bc=null;this.ZL=0;this.c8f=this.Dzd=!1}f9f(){const bb=this.zW;this.kfb();
bb&&""!==bb.text&&this.find(bb)}rmi(){return this.fxd&&this.INd.ypm}Xcj(){10>this.muc?(this.muc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.muc}),this.find(this.zW)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.va.processAction(F.a.M3b,2),this.muc=0)}c6i(){var bb=(new Date).getTime();let mb=!1;this.Oj.x8a||(mb=!0);let yb=0;if(!mb){this.Oj.I$||(this.Oj.I$=this.Oj.HEa);this.Oj.b4||(this.Oj.b4=this.Oj.I$,this.Oj.ME=
null);let ab=null,Ga=!0;for(;!mb&&this.Oj.b4&&(new Date).getTime()-bb<T.a.uMi;){const Za=this.Oj.b4,Ub=this.jp.nj.Eb(Za.nodeId);Ub?(Ga&&(ab=this.Kc.Pc(3),ab.Db(Ub),Ga=!1),Za.ZXd&&!this.X$a&&(this.X$a=Ub),this.Oj.b4=this.Oj.g9b(this.Oj.b4),mb=!this.Oj.b4||this.Oj.b4.nodeId.equals(this.Oj.I$.nodeId),this.Hvf(Ub,Za.type,this.Nyb),++yb):this.Oj.S5c(Za.nodeId)}ab&&ab.dispose()}this.Oj.irb();mb&&(this.Oj.b4=null,this.Dzd?this._state=0:(this._state=2,this.Hpb(!0)));this.G7=new f.a(2,1,this.Noc,Object(y.a)(this,
this.findInternal,"findInternal"),52);this.taskManager.Xb(this.G7);bb=(new Date).getTime()-bb;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:bb,["Count"]:yb,["Total"]:this.Oj.ika,["TotalWithDirty"]:this.Oj.x8a})}TDn(){this.kfb();this.ZL=0;if(this.jp.GCf&&this.Nyb){var bb=this.mb;if(bb){var mb=bb.hb.lb;if(mb){var yb=H.App.za.jb.qc;(yb=yb?yb.Vs:null)&&yb.g8a();mb=O.SelectionEditor.Fj(mb,!1,!1);bb.Bc(mb);yb&&yb.d_a()}}}bb=this.hll();this.kla=this.b1j.p8h(bb)}Plj(){this.Olj(this.kla[this.ZL].Zja)}Olj(bb){this.olo(bb);
this.jjj(bb)}Bcj(){this.X$a=null;this.sXb=!1}srf(bb){const mb=this.Zc.yk();mb.set(bb);if(!mb.zb(7))return mb.reset(),null;if(this.jp.A4d(mb,7,0))return bb=mb.currentNode,mb.reset(),bb;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");mb.reset();return null}hll(){if(this.jp.GCf){var bb=this.mb;if((bb=bb?bb.hb.lb:null)&&this.Nyb)return bb.Rc.Vk?(bb=bb.Rc,O.SelectionEditor.lv(bb)?(bb=bb.node,Object(m.a)(59,bb)?bb:this.srf(bb)):Object(m.a)(59,bb.node)?bb.node:this.srf(bb.node)):
this.srf(this.jp.Yc);bb=this.Zc.yk();bb.set(this.jp.Yc);if(this.jp.Emg(bb,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const mb=bb.currentNode;bb.reset();return mb}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");return null}xtf(){const bb=this.Zc.yk();bb.set(this.Y_b);if(1===bb.Qp())return bb.Qd(),bb.currentNode;k.ULS.sendTraceTag(4069019,313,15,
"Something went wrong in GetStartingNode...");return null}olo(bb){const mb=this.Kc.Pc(3);mb.Db(this.Y_b);const yb=this.Zc.yk();yb.set(this.Y_b);yb.Gz()&&(yb.Qd(),yb.vg());bb&&(yb.xf(bb,81),bb=this.kla[this.ZL],this.Y_b.e$f=bb.rootNode.type,this.Y_b.Sjf=bb.V7b);mb.dispose()}rSl(){if(this.stb){var bb=this.Zc.yk();bb.set(this.stb);if(bb.Qp())return bb.Qd(),bb.currentNode;bb=this.DNe(this.jp.Yc);bb.moveNext();if(bb.currentNode)return bb.currentNode}k.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");
return null}jjj(bb){const mb=this.Kc.Pc(3);mb.Db(this.stb);const yb=this.Zc.yk();yb.set(this.stb);yb.Gz()&&(yb.Qd(),yb.vg());bb&&(yb.xf(bb,81),bb=this.kla[this.ZL],this.stb.e$f=bb.rootNode.type,this.stb.Sjf=bb.V7b);mb.dispose()}Kji(){let bb=this.Oj.ME||this.Oj.HEa;if(bb){for(var mb=!1,yb=!0;bb;){var ab=this.jp.nj.Eb(bb.nodeId);if(ab=Object(x.a)(59,ab))if(mb=ab.sNf(bb.type)){yb&&(bb=this.Oj.r2a(bb));break}else bb=this.Oj.r2a(bb);else if(yb=bb,bb=this.Oj.g9b(bb),this.Oj.S5c(yb.nodeId),!bb||yb.nodeId.equals(bb.nodeId))break;
yb=!1}mb?(this.Oj.ME=bb,this.Oj.irb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}Pji(){let bb=this.Oj.ME||this.Oj.HEa;if(bb){for(var mb=!1,yb=!0;bb;){var ab=this.jp.nj.Eb(bb.nodeId);if(ab=Object(x.a)(59,ab))if(mb=ab.wLi(bb.type)){yb&&(bb=this.Oj.WSd(bb));break}else bb=this.Oj.WSd(bb);else if(yb=bb,bb=this.Oj.Z$h(bb),this.Oj.S5c(yb.nodeId),!bb||yb.nodeId.equals(bb.nodeId))break;yb=!1}mb?(this.Oj.ME=bb,k.ULS.sendTraceTag(4065249,
313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Oj.irb()}}CRk(){return 2===this._state&&(this.c8f||this.fxd&&this.INd.fdj)}aUf(){this.jp.rpa?(this.Zdb=this.Hfa.u3c(this.zW.text),this.Mbb=this.jp.nj,this.Bcj()):this.Xcj()}rtj(){this.fxd&&this.INd.start()}I5e(){if(!this.jp.rpa||this.Mbb!==this.jp.nj)return this.kfb(),this.Xcj(),!0;this.muc=0;return!1}g9f(){const bb=this.Hfa.OMb(this.Zdb),mb=this.CRk();let yb=!1;if(mb||this.jp.jAi(this.$Bc,
this.Qxc,this.zW,bb)){yb=!0;this.Hpb(!1);this.Hab.update();this.Hab.Vjf();!mb&&this.jp.tAi(this.$Bc,this.Qxc,this.zW,bb)?(this.Oj.ELi(),this.Oj.b4=null,this._state=1):(this.TDn(),this.Plj(),this._state=0,this.Dzd=!0);this.$Bc=this.zW;this.Qxc=bb;try{this.yWb=this.zWb.b$b(this.Qxc.join("|"),this.zW)}catch(ab){return k.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.zW.matchCase,this.zW.matchWholeWord),this.yWb=null,
this._state=2,this.Hpb(!0),!0}this.G7=new f.a(2,1,this.Noc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Xb(this.G7)}return yb}lSi(){if(!this.X$a){const bb=this.Zc.yk();bb.set(1===this.kla[this.ZL].V7b?this.jp.Yc:this.kla[this.ZL].rootNode);this.jp.Emg(bb,this.kla[this.ZL].rootNode.type,this.kla[this.ZL].V7b)?(this.X$a=bb.currentNode,bb.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),bb.reset(),this.G7=new f.a(2,1,this.Noc,Object(y.a)(this,
this.findInternal,"findInternal"),52),this.taskManager.Xb(this.G7))}}LTf(){this.Oj.irb();this.jjj(this.CCa.currentNode);this.CCa.currentNode===this.xtf()&&(this.ZL++,this.ZL===this.kla.length?(this.ZL=0,this._state=2,this.Dzd=!1,this.Hpb(!0)):this.Plj());this.CCa=null}igi(){return this.xtf()}M1i(){const bb=this.rSl();this.CCa=this.Zc.yk();this.CCa.set(bb);this.CCa.T1(this.kla[this.ZL].rootNode)}rmj(){const bb=this.Kc.Pc(3);bb.Db(this.CCa.currentNode);return bb}TXf(){this.Hvf(this.CCa.currentNode,
this.kla[this.ZL].V7b,this.Nyb);this.jp.A4d(this.CCa,this.kla[this.ZL].rootNode.type,this.kla[this.ZL].V7b)}K8e(bb){return!!this.CCa.currentNode&&!this.CCa.currentNode.id.equals(bb.id)}UBh(bb){!this.sXb&&this.X$a&&bb.id===this.X$a.id&&this.xtf().id!==this.X$a.id&&0<this.Oj.x8a&&(this.sXb=!0,this.Oj.vcj())}VAd(bb,mb,yb,ab){const Ga=this.Oj.e$b(bb);Ga?this.Oj.jde(bb,mb):this.sXb?this.Oj.rmh(mb):this.Oj.ZAd(mb);this.Nyb&&!this.Oj.ME&&0<mb.length&&yb.sNf(ab)&&(this.Oj.ME=Ga?Ga:mb[0],this.Oj.I$||(this.Oj.I$=
this.Oj.ME))}PTa(bb,mb){bb.PTa(mb)}bna(bb){this.Nyb&&bb.bna()}ENf(bb){bb.gl(16,!0)}static bF(bb,mb,yb,ab,Ga=!1){mb||(mb=ra.instance);yb||(yb=ba.instance);const Za=sa.createInstance(bb,yb.Nig,Ga),Ub=new r.a(()=>ua.createInstance(ib.instance,ib.instance.Oj)),Xb=new r.a(()=>Oa.createInstance(ib.instance.Oj)),zb=new r.a(()=>ia.createInstance(ib.instance,bb));return new ib(bb,mb,yb,ab,Z.FindManagerHelper.instance,new r.a(()=>l.AFrameworkApplication.oc),new r.a(()=>V.a.instance),new z.a,new v.a,G.a.createInstance,
a.a.instance,Za,Ub,Xb,zb,Ga)}static get instance(){return ib._instance}static createInstance(bb,mb=null,yb=null,ab=!1,Ga=!1){return Ga?ib.bF(bb,mb,yb,ab,!0):ib.instance||(ib._instance=ib.bF(bb,mb,yb,ab))}}ib._instance=null;Object(D.a)(ib,"FindManager",T.a,[])},1975:function(D,I,c){D=c(0);var l=c(22),f=c(2),a=c(241),k=c(42),x=c(6),y=c(16),m=c(46),r=c(7),z=c(69),v=c(110),G=c(75),F=c(88),H=c(208),L=c(12),J=c(5),M=c(596),P=c(103),N=c(827),K=c(1045),O=c(36),V=c(220),W=c(206),T=c(83);class Y{constructor(zb){this.eqa=
zb}}Object(D.a)(Y,"ValidParentData",null,[]);var ba=c(40),Z=c(334),ea=c(665),ha=c(363),la=c(664),ia=c(514);class sa{constructor(){this.g6b=0}}Object(D.a)(sa,"BelowOutlineElementData",null,[]);var Oa=c(636),Ra=c(870),Na=c(538);class Da extends Oa.a{constructor(zb,Ib,$a,Hb){super(4,Hb);this.e6b=zb;this.dAb=Ib;this.xGc=$a}B$b(){var zb=this.e6b;if(!zb)return r.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const Ib=[],$a=new Ra.a(this.e6b.id,
this.e6b.Wc,this.dAb?this.dAb.id:null);""!==zb.characterData&&zb.characterData&&(zb=new Na.DeleteTextUpdateHint(this.e6b.id,0,zb.characterData),Ib.push(zb));Ib.push($a);return Ib}}Object(D.a)(Da,"DeleteParagraphOperation",Oa.a,[]);var ra=c(949),xa=c(468);class fa extends Oa.a{constructor(zb,Ib,$a,Hb,Ya){super(3,Ya);this.gqa=zb;this.iSa=Ib;this.Zdn=$a;this.Zxa=Hb}B$b(){const zb=[];var Ib=new ra.AddParagraphUpdateHint(this.Zxa.id,this.Zxa.Wc,this.gqa?this.gqa.id:null);zb.push(Ib);""!==this.Zxa.characterData&&
this.Zxa.characterData&&(Ib=new xa.a(this.Zxa.id,0,this.Zxa.characterData),zb.push(Ib));return zb}}Object(D.a)(fa,"InsertNewParagraphOperation",Oa.a,[]);var oa=c(948);class ta extends Oa.a{constructor(zb,Ib,$a,Hb){super(2,Hb);this.gqa=zb;this.iSa=Ib;this.Q3d=$a}B$b(){const zb=[],Ib=new oa.MergeParagraphUpdateHint(this.gqa.id,this.gqa.Wc,this.gqa.characterData.length,this.iSa.id,this.iSa.Wc,this.Q3d.id,this.Q3d.Wc);zb.push(Ib);return zb}}Object(D.a)(ta,"MergeParagraphOperation",Oa.a,[]);var Ka=c(869);
class va extends Oa.a{constructor(zb,Ib,$a,Hb,Ya){super(1,Ya);this.c5=zb;this.Xsj=Ib;this.dAb=$a;this.xGc=Hb}B$b(){const zb=[],Ib=new Ka.a(this.c5.id,this.c5.Wc,this.Xsj,this.dAb.id,this.dAb.Wc,this.xGc.id,this.xGc.Wc);zb.push(Ib);return zb}}Object(D.a)(va,"SplitParagraphOperation",Oa.a,[]);var La=c(374),za=c(9),Ca=c(534),ua=c(43),ib=c(1104),bb=c(32),mb=c(122),yb=c(236),ab=c(8),Ga=c(180),Za=c(13),Ub=c(93);c.d(I,"a",function(){return Xb});class Xb{constructor(zb,Ib,$a,Hb,Ya,Sa,Eb=null,Jb=null,vb=null,
ac=null,dc=null){this.$U=dc;this.BK=zb;this.zK=Ib;this.Ef=$a;this.W6=Eb;this.Yu=Jb;this.nz=vb;this.eq=ac}iok(zb){var Ib;(null===(Ib=za.App.xd)||void 0===Ib?0:Ib.So)&&za.App.xd.Yp.$F(zb)}qza(zb,Ib,$a,Hb=!1){O.OutlineElementNavigator.Ce(zb);ab.ParagraphReader.kh(zb)?Xb.il.mq.qza(zb,Ib,$a):bb.TableReader.isTable(zb)&&14===zb.Ue&&(Ib=(new ha.a(1,$a)).Ut,$a=Object(z.a)(Z.TableNode,zb.currentNode),this.Zlj($a,Ib,Hb));O.OutlineElementNavigator.Wd(zb)}Zlj(zb,Ib,$a=!1){zb&&Object(v.a)(Z.TableNode,zb)&&($a?
Ib?(zb.setValue(x.a.$d,Ib),Ib=bb.TableReader.eh(zb),Xb.Gk.Kcg(zb,Ib)):zb.removeProperty(x.a.$d):zb.$d=Ib)}get mq(){return K.a.jGb}get qE(){return this.Yu||(this.Yu=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get uc(){return this.nz||(this.nz=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Pd(){return null!=this.cHg?this.cHg:this.cHg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Bj(){return null!=this.PGg?this.PGg:this.PGg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Jn(){return this.zK.value}get Fd(){return this.Ef.value}get xL(){return this.BK.value}get Uf(){return yb.a.instance}get KD(){return null!=
this.Uvg?this.Uvg:this.Uvg=l.a.instance.Oa("Box4.IContentControlConverter")}hgb(){const zb=N.a.instance.createInstance(393229);zb.setValue(y.a.yL,V.a.first);zb.setValue(y.a.gel,new Date);zb.boc();return zb}dbl(){const zb=new ib.a;zb.setValue(y.a.yL,V.a.first);return zb}Uff(zb,Ib,$a=!1){ba.OutlineElementReader.kGf(zb)?(zb=ba.OutlineElementReader.isRtl(zb),$a?this.SPb(Ib,zb):this.RPb(Ib,zb)):this.WYn(Ib)}Lkc(zb,Ib){const $a=O.OutlineElementNavigator.Hl(zb);ba.OutlineElementReader.In($a)!==Ib&&(this.RPb($a,
Ib),zb.anchor.oY(4))}RPb(zb,Ib){const $a=new ua.GraphTransaction(7);$a.Db(zb);this.SPb(zb,Ib);const Hb=new J.GraphIterator;Hb.set(zb);La.a.instance.SDm(Hb);if(Hb.zb(10)){const Ya=Hb.ld(10);Hb.Ub(1)===zb&&this.xL.RPb(Ya,Ib)}$a.dispose()}SPb(zb,Ib){let $a=null,Hb=null;if(F.a.instance.J(1)&&zb.isConnected){$a=ab.ParagraphReader.vw(zb,!0,!0);Hb=new G.a;for(let Ya=0;Ya<$a.count;Ya++)12===$a.J(Ya).type&&Hb.add($a.J(Ya).VD())}zb.properties.setValue(y.a.c1,Ib);if(F.a.instance.J(1)&&$a&&Hb)if($a.count!==Hb.count)r.ULS.shipAssertTag(35973010,
376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",$a.count,Hb.count);else for(zb=0;zb<$a.count;zb++)this.Bj.sV($a.J(zb),Hb.J(zb),this.Pd.tg)}WYn(zb){zb.properties.removeProperty(y.a.c1)}fJ(zb,Ib=null,$a=!1){var Hb,Ya=null;let Sa=null;if(!ba.OutlineElementReader.Bh(zb))return r.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let Eb=null,Jb=null,vb=0;Ib&&(Eb=Ib.formatting,Jb=Ib.zka,vb=Ib.languageId);$a||({gqa:Ya,iSa:Sa}=this.$2h(zb,
Ya,Sa));Ib=H.a.instance.createInstance(393230);Ib.setValue(y.a.vo,"");zb.xf(Ib,2);zb.wj(Ib);Xb.il.vOb(Ib);Xb.il.r7m(Ib);Xb.il.fVa(Ib);this.iok(Ib);f.AFrameworkApplication.XH&&!f.AFrameworkApplication.naj&&(f.AFrameworkApplication.le("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),(null===(Hb=f.AFrameworkApplication.K)||void 0===Hb?0:Hb.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.kHk());Eb&&(Ib.qa.first.formatting.Tj=Eb);vb||(vb=f.AFrameworkApplication.lcid);
zb.currentNode.Dg(y.a.c7c,zb.currentNode.ja(y.a.c7c,vb));zb.currentNode.setValue(x.a.BSa,0);Jb&&this.qE.YJ(Jb,Ib,!0);!$a&&Ya&&($a=new ia.a(Ib),Ya=new fa(Ya,Sa,Ya,$a,Ib.Mna),zb.currentNode.uJ().mF.BH(Ya));return Ib}kHk(){if(this.$U){for(var zb,Ib=this.$U.fkf();Ib;){const $a=Ib.node;if(0<ab.ParagraphReader.textLength($a,9)&&(zb=mb.AParagraphNode.OVl($a.characterData.trim()),0<zb.length))break;Ib=Ib.next}zb&&32===f.AFrameworkApplication.va.Rb(Za.a.renameFile,2,zb)&&this.eq&&(this.eq.execute($a=>{$a.logActivity("AutoRenameDocumentCallout",
null)}),k.a("AutoRenameDocumentSuccess"))}}$2h(zb,Ib,$a){$a=new J.GraphIterator;$a.jd(zb);Ib=null;$a.HDf?$a.currentNode.uJ().mF.V7(6):(O.OutlineElementNavigator.X0($a,!0,!1),Ib=this.bRd($a));$a.jd(zb);$a=this.g4h($a);return{gqa:Ib,iSa:$a}}g4h(zb){const Ib=new J.GraphIterator;Ib.jd(zb);zb=null;Ib.lGa||(O.OutlineElementNavigator.$r(Ib,!0,!1),zb=this.bRd(Ib));return zb}bRd(zb,Ib=!1){zb=O.OutlineElementNavigator.Ce(zb,!0);return zb?this.l9h(zb,Ib):(r.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),
null)}l9h(zb,Ib=!1){if(12===zb.type)return Ib?new ia.a(zb):new la.a(zb);zb.uJ().mF.V7(5);return new ea.a(zb)}iYk(zb,Ib){var $a=Ib.currentNode.clone();zb.QH($a,null,1);zb.wj($a);$a.Eba=Ib.currentNode;O.OutlineElementNavigator.Ce(Ib);Ib.e9&1&&Ib.currentNode.PSb(null);$a=Ib.currentNode.clone();$a.IIa=Ib.currentNode.IIa;$a.PL=Ib.currentNode.PL;zb.QH($a,null,2);zb.wj($a);zb.w0(1);$a.Eba=Ib.currentNode;$a.setValue(x.a.Wc,a.a.zF());Ib.ot(11)}vOb(zb){zb.Ub(2)&&zb.vg()}s1n(zb,Ib){const $a=zb.currentNode;O.OutlineElementNavigator.Ce(zb);
const Hb=zb.currentNode;O.OutlineElementNavigator.Wd(zb);Ib.zJ(1);O.OutlineElementNavigator.Ce(Ib);zb.xf(Ib.currentNode,2);Ib.vg();var Ya=new J.GraphIterator;Ya.jd(Ib);if(Ya.Ub(1)){const Sa=new J.GraphIterator;Sa.jd(zb);const Eb=new Y(null);if(!this.Xhm(Sa,Ya.currentNode,Eb))return;M.g(Sa,null,1,1,Ya,-1)}Ib.vg();Ya=null;zb.MM(1)&&(Ya=zb.currentNode);for(zb.rc();W.OutlineNavigator.I9(Ib);)zb.QH(Ib.currentNode,Ya,1),Ya=Ib.currentNode,Ib.vg();zb.wj($a);zb.wj(Hb);zb.vg()}G$(zb,Ib,$a,Hb,Ya,Sa,Eb=!1,Jb=
!1){var vb=ba.OutlineElementReader.Bh(zb),ac=ba.OutlineElementReader.Bh(Ib),dc=$a.isValid&&$a.contextId===L.a.Tc;vb&&ac&&dc||r.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",vb,ac,dc);var Cc=zb.currentNode;this.vOb(Ib);ac=Ib.Ue;let Ec,rc=null;vb=dc=null;let hb=!1;O.OutlineElementNavigator.Ce(zb);const fb=zb.Ue;if(ab.ParagraphReader.kh(zb)){Ec=zb.currentNode;(dc=Object(z.a)(mb.AParagraphNode,Ec))?dc.qa&&dc.qa.length||
r.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",dc):r.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");dc=new ia.a(dc);(hb=$a.cpBegin===ab.ParagraphReader.textLength(Ec))&&(vb=this.g4h(Ib));const Nb=Ib.currentNode;rc=this.fJ(Ib,void 0,!0);Xb.il.mUa(zb,Ib,$a,Ya,Sa,Eb,Jb);Hb?(Ya=this.uc.Ro(Ec))&&this.qE.YJ(Ya,rc,!0):hb&&(Ya=this.uc.Ro(Ec))&&((Jb=Ya.ja(m.a.Zd,null))?(Ya=this.uc.ZC(rc).jj(Jb),this.qE.YJ(Ya,rc,!1)):this.qE.YJ(Ya,rc,!0));this.Uff(Cc,
Nb)}O.OutlineElementNavigator.Wd(zb);O.OutlineElementNavigator.Wd(Ib);O.OutlineElementNavigator.Ce(zb);(Cc=Object(z.a)(mb.AParagraphNode,zb.currentNode))?Cc.qa&&Cc.qa.length||r.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Cc):r.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Cc=new ia.a(Cc);O.OutlineElementNavigator.Wd(zb);(zb=rc)?zb.qa&&zb.qa.length||r.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",
zb):(r.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),r.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:hb,["moveText"]:Sa,["overrideParagraphStyle"]:Hb,["sourceOutlineElementContentNodeType"]:fb,["destinationOutlineElementNodeType"]:ac,["alwaysMoveEopToDestinationPara"]:Eb}));hb?($a=new ia.a(zb),$a=new fa(dc,vb,Cc,$a,zb.Mna),Ib.currentNode.uJ().mF.BH($a)):($a=Sa?new va(dc,$a.cpBegin,Cc,new ia.a(zb),zb.Mna):new va(dc,$a.cpBegin,new ia.a(zb),Cc,zb.Mna),Ib.currentNode.uJ().mF.BH($a));
return zb}Nzh(zb,Ib){O.OutlineElementNavigator.Ce(zb);let $a=ab.ParagraphReader.At(zb.currentNode)&&this.hRk(zb);const Hb=zb.currentNode;$a=Ib?$a&&!this.Uf.Oxn(Hb):$a&&!this.Uf.Exn(Hb);O.OutlineElementNavigator.Wd(zb);return $a}hRk(zb){return ab.ParagraphReader.kh(zb)&&!ab.ParagraphReader.Qfb(zb.currentNode)}merge(zb,Ib,$a,Hb,Ya=null,Sa=!1,Eb,Jb=!1,vb=!1,ac=!1){var dc;if(zb.currentNode.id===Ib.currentNode.id)return!1;let Cc;const Ec=new J.GraphIterator;Ec.jd(Ib);Eb=this.bRd(Ec);Ec.jd(zb);Cc=this.bRd(Ec,
!0);if(!this.Nzh(Ib,!0)||!this.Nzh(zb,!1))return!1;if(this.Uf.fh){O.OutlineElementNavigator.Ce(zb);O.OutlineElementNavigator.Ce(Ib);var rc=ab.ParagraphReader.kh(zb)?zb.currentNode:null,hb=ab.ParagraphReader.kh(Ib)?Ib.currentNode:null;O.OutlineElementNavigator.Wd(zb);O.OutlineElementNavigator.Wd(Ib);if(rc&&hb&&!this.Uf.Ozh(rc,hb,!1)){if(!this.KD||!this.Uf.Ozh(rc,hb,!0))return!1;this.KD&&(this.KD.FBj(rc,!1),this.KD.FBj(hb,!0))}}rc=Object(z.a)(mb.AParagraphNode,zb.currentNode);rc=($a||!rc||!rc.characterData.length)&&
!Ub.ListItemReader.jg(zb);Jb||this.Jn.merge(zb,Ib,rc,Ya);O.OutlineElementNavigator.Ce(zb);Ya=zb.currentNode.Mna;O.OutlineElementNavigator.Ce(Ib);if(ab.ParagraphReader.kh(Ib)){Jb=Ib.currentNode;if(null===(dc=za.App.xd)||void 0===dc?0:dc.So)if(dc=zb.currentNode,rc=Ca.CoauthLockEditor.getInstance(),rc.I7a(this.Uf.P8b(Jb))||rc.I7a(this.Uf.P8b(dc)))return Ib.rc(),zb.rc(),!1;dc=!1;(Jb=zb.parentNode)&&ba.OutlineElementReader.qpa(Jb)&&(dc=Ub.ListItemReader.jg(Jb));(Jb=this.Koo(ab.ParagraphReader.isEmpty(zb),
dc,$a,Hb,vb))&&(rc=this.uc.Btf(Ib))&&this.qE.YJ(rc,zb.currentNode,!0);$a&&(rc=Ib.currentNode,hb=zb.currentNode,(Jb||dc)&&Ga.b(rc,hb),vb&&Hb||this.W6.iNi(rc,hb,dc),f.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),ac&&(vb=this.Z5k(hb,rc),r.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",vb)));$a=Xb.il.merge(zb,Ib,$a,Hb,Sa);Sa=Ec.currentNode;Hb=zb.currentNode;zb.rc();$a&&ba.OutlineElementReader.isEmpty(Ib,!0)&&this.R0a(Ib);zb=new ta(Cc,
Eb,new la.a(Sa),Ya);Hb.uJ().mF.BH(zb);return!0}Ib.rc();zb.rc();return!1}Z5k(zb,Ib){let $a=null;Ib&&Ib.qa&&0<Ib.qa.length&&Ib.qa.first.Oh&&($a=Ib.qa.first.formatting);return $a&&zb&&zb.qa&&0<zb.qa.length&&P.FormattingReader.t3k(zb.qa)?(zb.qa.last.formatting=$a.yf(zb.qa.last),!0):!1}Koo(zb,Ib,$a,Hb,Ya){return Ib?!1:$a?!(Hb&&Ya):zb}YBm(zb){const Ib=new J.GraphIterator;Ib.set(zb.node);Ib.rd();O.OutlineElementNavigator.Wd(Ib);const $a=this.Zoa(Ib),Hb=this.Zoa(Ib);this.G$(Ib,$a,zb,!1,!0,!0);ba.OutlineElementReader.isEmpty(Ib,
!1)&&(this.Jn.Lda(Ib),Ib.vg());ba.OutlineElementReader.isEmpty($a,!1)&&!ba.OutlineElementReader.Mkb($a)&&(this.Jn.Lda($a),$a.vg());return Hb}Iz(zb,Ib,$a,Hb=null,Ya=!1,Sa=!0){if(!this.dRk(zb))return null;const Eb=zb.currentNode;var Jb=!1;Sa&&(Jb=Ub.ListItemReader.jg(zb),Ya=Ib||Ya||!ba.OutlineElementReader.isEmpty(zb,!1),Jb=this.Jn.kso(Jb,Ya));Ya=Ib?zb.MM(1):zb.currentNode;zb.rc();$a=this.xL.akb(zb,Ya,$a,Hb);if(!$a)return null;this.Uff(Eb,$a);Sa&&Jb&&this.Jn.DKo(zb,Ib,Eb,$a);return $a}dRk(zb){return ba.OutlineElementReader.Bh(zb)&&
(zb=zb.parentNode,T.OutlineReader.o_d(zb)||ba.OutlineElementReader.qpa(zb)||ba.OutlineElementReader.ZQa(zb))?!0:!1}Vya(zb){const Ib=new J.GraphIterator;Ib.set(zb);Ib.rd();Ib.ot(11);let $a=null,Hb=null;({gqa:$a,iSa:Hb}=this.$2h(Ib,$a,Hb));let Ya=-1;12===zb.type&&(Ya=zb.Mna);Ib.currentNode?(Ib.currentNode.uJ().mF.BH(new Da(this.l9h(zb,!0),$a,Hb,Ya)),this.R0a(Ib)):r.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}R0a(zb){if(zb.Fs(1)){const Ib=new sa,$a=new J.GraphIterator;
$a.jd(zb);this.NMl($a,Ib)&&this.mq.SKc(zb,-Ib.g6b)}zb.vg();bb.TableReader.hx(zb)&&this.KCn(zb)}$Af(zb,Ib,$a){if(!T.OutlineReader.ix(zb)&&!ba.OutlineElementReader.Bh(zb))return null;const Hb=this.dbl();0<$a&&$a<V.a.last&&Hb.setValue(y.a.yL,Math.min(V.a.nil,$a));zb.QH(Hb,Ib,1);return Hb}$Bm(zb,Ib){if(!ba.OutlineElementReader.Bh(zb)&&!ba.OutlineElementReader.pL(zb)||!T.OutlineReader.Axa(zb.parentNode)&&!ba.OutlineElementReader.qpa(zb.parentNode))return null;const $a=zb.currentNode;let Hb;Hb=zb.currentNode;
zb.rc();Ib=this.$Af(zb,Hb,Ib);zb.wj($a);return Ib}KCn(zb){ba.OutlineElementReader.pL(zb)&&(zb.Fs(1)||zb.vg());this.J_h(zb,!1);this.Gqh(zb)}J_h(zb,Ib){var $a,Hb=null;for($a=zb.Ub(1);$a;){var Ya=!1;ba.OutlineElementReader.ZQa($a)&&!zb.Fs(1)&&(Ya=!0);var Sa=$a;$a=zb.Ni(1);if(Ya)Ya=new J.GraphIterator,Ya.set(Sa),Ya.rd(),Ya.vg();else if(ba.OutlineElementReader.ZQa(Sa)){if(Hb){Ya=new J.GraphIterator;Ya.set(Hb);var Eb=new J.GraphIterator;Eb.set(Sa);Eb.rd();Ya.xf(Eb.currentNode,1);Eb.vg();Eb=ba.OutlineElementReader.tha(Sa);
Eb===V.a.nil&&(Eb=1);const Jb=ba.OutlineElementReader.tha(Sa);(Eb=Math.max(0,Jb-Eb))?Sa.setValue(y.a.yL,Math.min(V.a.nil,Eb)):(Ya.wj(Sa),zb.Ub(1),M.e(Ya),Ya.rc());Ib&&this.J_h(Ya,!0)}}else Hb=Sa}Ib=null;Hb=V.a.last+1;for($a=zb.Ub(1);$a;$a=zb.Ni(1))if(ba.OutlineElementReader.pL(zb))Sa=ba.OutlineElementReader.tha($a),Hb>Sa&&(Hb=Sa,Ib=$a);else{zb.rc();return}if(Ib){for($a=zb.Ub(1);$a;$a=zb.Ni(1))$a!==Ib&&($a=ba.OutlineElementReader.tha($a),zb.currentNode.setValue(y.a.yL,Math.min(V.a.nil,$a-Hb)));Hb+=
ba.OutlineElementReader.tha(zb.currentNode);zb.currentNode.setValue(y.a.yL,Math.min(V.a.nil,Hb));$a=new J.GraphIterator;$a.jd(zb);$a.wj(Ib);$a.Ub(1);M.e($a)}}Xhm(zb,Ib,$a){var Hb=ba.OutlineElementReader.tha(zb.currentNode);if(1===Hb)return!0;if(ba.OutlineElementReader.pL(zb))return!1;if(!zb.pib(1)||this.WOm(zb,Ib))return zb.currentNode.setValue(y.a.yL,Math.min(V.a.nil,1)),!0;if($a.eqa&&zb.wj($a.eqa)){if(ba.OutlineElementReader.pL(zb)&&1===Hb+ba.OutlineElementReader.tha(zb.currentNode))return $a.eqa=
zb.zJ(1),zb.rc(),!0;zb.rc()}if($a.eqa&&zb.wj($a.eqa)||!$a.eqa&&zb.Ub(1)){if(zb.currentNode!==Ib&&zb.Jf(1)&&ba.OutlineElementReader.pL(zb)&&1===Hb+ba.OutlineElementReader.tha(zb.currentNode))return $a.eqa=null,!0;zb.rc()}if(zb.qjb(Ib)&&this.VOm(zb,Ib)){for($a=zb.Ub(1);$a;$a=zb.Ni(1))if($a!==Ib){var Ya=ba.OutlineElementReader.tha($a);$a.setValue(y.a.yL,Math.min(V.a.nil,Ya+(Hb-1)))}zb.currentNode.setValue(y.a.yL,Math.min(V.a.nil,1));return!0}if(1>Hb)return Hb=this.$Af(zb,$a.eqa,1-Hb),zb.wj(Hb),$a.eqa=
null,!0;if(1<Hb){zb.currentNode.setValue(y.a.yL,Math.min(V.a.nil,1));Ib=null;for(Ya=zb.Ub(1);Ya;){if(ba.OutlineElementReader.pL(zb)){Ya.setValue(y.a.yL,Math.min(V.a.nil,Hb-1+ba.OutlineElementReader.tha(Ya)));Ya=zb.Ni(1);continue}Ib||(Ib=this.$Bm(zb,Hb-1));const Sa=Ya;Ya=M.i(zb,Ib,1);Ya===Ib&&(Ya=zb.Ni(1));$a.eqa===Sa&&($a.eqa=Ib,Ib=null)}return!0}return!1}WOm(zb,Ib){return J.GraphIterator.$ba(()=>{if(1===zb.pib(1)){const $a=zb.Ub(1);zb.rc();if($a===Ib)return!0}return!1})}VOm(zb,Ib){return J.GraphIterator.$ba(()=>
{let $a;for($a=zb.Ub(1);$a;$a=zb.Ni(1))if($a!==Ib&&!ba.OutlineElementReader.pL(zb))return zb.rc(),!1;return!0})}NMl(zb,Ib){Ib.g6b=0;do{const $a=zb.currentNode;if(zb.Ub(1))Ib.g6b-=ba.OutlineElementReader.tha($a);else{if(T.OutlineReader.ix(zb)||null===zb.currentNode)return!1;if(3!==zb.role||!zb.Nha(1))for(;!zb.Ni(1);)if(Ib.g6b+=ba.OutlineElementReader.tha(zb.currentNode),T.OutlineReader.ix(zb)||null===zb.currentNode)return!1}}while(ba.OutlineElementReader.pL(zb));return!0}Zoa(zb,Ib=!1){return this.eXd(zb,
!1,Ib)}XBm(zb){return this.eXd(zb,!0,!1)}eXd(zb,Ib,$a=!1){const Hb=new J.GraphIterator;Hb.jd(zb);zb=new J.GraphIterator;zb.jd(Hb);this.Iz(zb,Ib,!1,null,$a);zb.currentNode.setValue(y.a.yL,Math.min(V.a.nil,ba.OutlineElementReader.tha(Hb.currentNode)));Hb.Ub(1)&&M.g(zb,null,1,1,Hb,-1);return zb}Gqh(zb){if(ba.OutlineElementReader.d3n(zb)){1!==ba.OutlineElementReader.tha(zb.currentNode)&&zb.currentNode.setValue(y.a.yL,V.a.first);for(var Ib=zb.Ub(1);Ib;)if(ba.OutlineElementReader.pL(zb)){Ib=new J.GraphIterator;
Ib.jd(zb);Ib.rc();const $a=new J.GraphIterator;$a.jd(zb);$a.Ub(1);M.g(Ib,zb.currentNode,1,1,$a,-1);Ib=zb.Ggb(1)}else this.Gqh(zb),Ib=zb.Ni(1)}}static get Gk(){return null!=Xb.oGg?Xb.oGg:Xb.oGg=l.a.instance.resolve("Box4.ITableEditor")}static get il(){return Xb.Ts||(Xb.Ts=l.a.instance.resolve("Box4.IParagraphEditor"))}static set il(zb){Xb.Ts=zb}}Xb.Ts=null;Object(D.a)(Xb,"OutlineElementEditor",null,[354])},1976:function(D,I,c){D=c(0);var l=c(135),f=c(45),a=c(22),k=c(2),x=c(60),y=c(645),m=c(92),r=c(86),
z=c(397),v=c(353),G=c(19),F=c(354),H=c(55),L=c(177),J=c(42),M=c(34),P=c(13),N=c(1587),K=c(117),O=c(6),V=c(16),W=c(155),T=c(7),Y=c(457),ba=c(687),Z=c(575),ea=c(115),ha=c(18),la=c(250),ia=c(252),sa=c(26),Oa=c(35);class Ra{constructor(yb){this.ez=null;this.p5g=!1;this.Ip=null;this.jM=new N.a;this.zDe=new N.a;this.zc=yb}get Mmb(){Oa.a(4281429,307,this.jM.count===this.zDe.count);return this.jM.count}get D3d(){return this.p5g}set D3d(yb){this.p5g=yb}a3b(yb){this.ez=yb}get yX(){return null}Oqh(yb,ab){this.jM.add(yb);
this.zDe.add(ab)}}Ra.kmb=2712;Object(D.a)(Ra,"APicturePasteHandler",null,[532]);var Na=c(255),Da=c(3),ra=c(9),xa=c(1156),fa;(function(yb){yb[yb.unknown=0]="unknown";yb[yb.other=1]="other";yb[yb.file=2]="file";yb[yb.blob=3]="blob";yb[yb.odp=4]="chromeExtension";yb[yb.cid=5]="cid"})(fa||(fa={}));Object(D.b)("UnsupportedUrlScheme",fa);var oa=c(261),ta=c(43),Ka=c(8),va=c(1857),La=c(1858),za=c(1783);class Ca{constructor(){this.delay=this.retry=0}}Object(D.a)(Ca,"ForceInboundData",null,[]);class ua{constructor(yb,
ab,Ga,Za){this.fVd=!1;this.request=yb;this.V2n=ab;this.url=Za;this.lCm=Ga}}Object(D.a)(ua,"PicturePasteRequestInfo",null,[]);var ib=c(394);c.d(I,"a",function(){return mb});const bb=["ImageInsertFailed"];class mb extends Ra{constructor(yb,ab,Ga,Za,Ub,Xb=null,zb=null,Ib=!1,$a=null,Hb=null){super(yb);this.Sl=l.a.nil;this.lB=new N.a;this.gMa=0;this.Dxc=this.ych=null;this.Jah=!1;this.CAc=null;this.Xkd=new N.a;this.Zp=null;this.eEn=()=>{var Ya=this.IMl(),Sa=131073;this.U7j&&(Sa=1073872970);Ya=f.a.Rn(Ya,
Y.a.cellId,this.Ip.Am.toString());Ya=f.a.Rn(Ya,Y.a.yX,this.Sl.toString());Ya=f.a.Rn(Ya,Y.a.classId,Sa.toString());this.Ip.KH&&(Ya=f.a.Rn(Ya,Y.a.KH,this.Ip.KH));Ya=f.a.Rn(Ya,Y.a.Grb,"1");Ya=f.a.Rn(Ya,ba.a.imageType,"1");Ya=Na.a.instance.CZe(Ya);this.Ip.contentReplicator&&this.Ip.contentReplicator.JJb&&(Ya=f.a.Rn(Ya,Y.a.k3e,"1"));let Eb=0;Sa=Ya;var Jb=new N.a;const vb=new N.a,ac=new N.a,dc=new N.a,Cc=new N.a,Ec=new N.a;var rc="",hb=a.a.instance.Oa("Box4.IFeatureHelper");hb=!!hb&&hb.isFeatureEnabled(11)&&
hb.isFeatureEnabled(51);for(let pb=0;pb<this.Mmb;pb++){var fb=this.zDe.J(pb);T.ULS.shipAssertTag(7869452,307,!!fb.src);T.ULS.shipAssertTag(7869453,307,""!==fb.src);T.ULS.shipAssertTag(7869454,307,19922944>fb.src.length);const Xa=this.jM.J(pb);var Nb=Xa.node.ja(K.a.MJ,oa.a.Nt);this.uUo(Xa.blob,fb);var Fb=fb.alt;var nb=fb.Ejl;nb||(nb=Fb,Fb="");const Pb=Xa.blob;Nb=va.a.construct(Pb?Pb.id.toString():Xa.node.id.toString(),fb.src,Fb,fb.width,fb.height,nb,Nb,Xa.yU,!!Pb&&Pb.properties.ja(O.a.fia,!1),Pb?Pb.properties.ja(K.a.Wga,
-1):-1,Pb?Pb.properties.ja(O.a.amb,Box4Intl.Box4Strings.l_Picture):"",Xa.node.properties.ja(V.a.yxa,!1),null,null,null,fb.AFd);fb.src.startsWith("data:")?(nb=!1,hb&&fb.AFd?(nb=!0,fb=Cc,Fb=Ec):(fb=ac,Fb=dc),fb.add(Nb),Fb.add(Xa),nb=La.a.construct(fb.toArray(),!nb,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ip.vr:null,nb),nb=M.c(nb),nb.length>mb.h$m?(T.ULS.shipAssertTag(7869456,307,1<fb.count),fb.remove(Nb),Fb.remove(Xa),nb=this.lB.count?(new x.a(this.Sl,Eb)).toString():
this.Ip.contentReplicator.Lt.toString(),Sa=f.a.Rn(Sa,Y.a.Nua,nb),Sa=f.a.Rn(Sa,Y.a.ohc,Eb.toString()),ha.ImageReader.Kzf&&(Sa=f.a.Rn(Sa,Y.a.JSb,"1")),this.lB.add(new ua(La.a.construct(fb.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ip.vr:null),rc,Fb,Sa)),Eb+=ac.count,fb=new N.a,fb.add(Nb),Fb=new N.a,Fb.add(Xa)):rc=nb):(Jb.add(Nb),vb.add(Xa))}ac.count&&(Sa=Ya,nb=this.lB.count?(new x.a(this.Sl,Eb)).toString():this.Ip.contentReplicator.Lt.toString(),Sa=
f.a.Rn(Sa,Y.a.Nua,nb),Sa=f.a.Rn(Sa,Y.a.ohc,Eb.toString()),ha.ImageReader.Kzf&&(Sa=f.a.Rn(Sa,Y.a.JSb,"1")),rc=La.a.construct(ac.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ip.vr:null),this.lB.add(new ua(rc,M.c(rc),dc,Sa)),Eb+=ac.count,this.Xkd.add(mb.clf));Jb.count&&(Sa=Ya,nb=this.lB.count?(new x.a(this.Sl,Eb)).toString():this.Ip.contentReplicator.Lt.toString(),Sa=f.a.Rn(Sa,Y.a.Nua,nb),Sa=f.a.Rn(Sa,Y.a.ohc,Eb.toString()),Sa=f.a.Rn(Sa,Y.a.JSb,"1"),Jb=
La.a.construct(Jb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ip.vr:null),this.lB.add(new ua(Jb,M.c(Jb),vb,Sa)),k.AFrameworkApplication.zia("WoInc325;WoInc325cf"),this.Xkd.add(this.QUg));Cc.count&&(Sa=Ya,nb=this.lB.count?(new x.a(this.Sl,Eb)).toString():this.Ip.contentReplicator.Lt.toString(),Sa=f.a.Rn(Sa,Y.a.Nua,nb),Sa=f.a.Rn(Sa,Y.a.ohc,Eb.toString()),Sa=f.a.Rn(Sa,Y.a.JSb,"1"),Ya=La.a.construct(Cc.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?
this.Ip.vr:null,!0),this.lB.add(new ua(Ya,M.c(Ya),Ec,Sa)),this.Xkd.add(this.QUg));T.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.lB?this.lB.count:-1)+" picture paste requests to send");this.fpb()};this.picturePasteRequestSucceeded=Ya=>{var Sa;T.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",this.YYl(Ya));if(({group:Eb}=Z.a.S1(Ya.data.se)).returnValue){var Eb=Eb.Responses[0];if(Eb.StatusCode)if(46!==Eb.StatusCode||this.lB.J(this.gMa).fVd){T.ULS.sendTraceTag(51212675,
322,15,"Picture paste request failed with reason "+Eb.StatusCode);Ya=Object.assign(new ea.a,{extendedProperties:new Map});Ya.extendedProperties.set("statuscode",Eb.StatusCode.toString());if(null===(Sa=k.AFrameworkApplication.K)||void 0===Sa?0:Sa.$("ShouldLogPicturesExtendedHealthKpis")){var Jb={name:ib.c.Bac,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Ya};Ya.extendedProperties.set("ErrorLevel","warning");this.og.logKpiFailure({kpiName:ib.c.CFa,
errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Ya},optionalVeto:Jb})}else r.Health.instance.recordQosError("PictureRemotePasteFailed",bb,!1,!0,!1,!1,Ya);this.Fmm()}else this.lB.J(this.gMa).fVd=!0,this.fpb();else{Eb=Sa="";Ya&&Ya.data&&Ya.data.Aj&&(ba.a.cI in Ya.data.Aj&&Ya.data.Aj[ba.a.cI]&&(Eb=Ya.data.Aj[ba.a.cI]),"X-CorrelationId"in Ya.data.Aj&&Ya.data.Aj["X-CorrelationId"]&&(Sa=Ya.data.Aj["X-CorrelationId"]));T.ULS.sendTraceTag(595068929,
307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",Eb,Sa);(null===(Jb=k.AFrameworkApplication.K)||void 0===Jb?0:Jb.$("ShouldLogPicturesExtendedHealthKpis"))&&this.og.logKpiSuccess({kpiName:ib.c.CFa});this.CAc&&(this.CAc.stop(),this.CAc=null);this.gMa++;this.CCj&&this.fpb();this.ych=this.Ip.contentReplicator.Lt;let vb=null;vb=Object.assign(new Ca,{retry:0,delay:this.Xkd.J(this.gMa-1)});Ya=new m.a(2,1,mb.clf,()=>{this.Ip.contentReplicator.B0f(this.Z0h,vb)},124);this.Ib.Xb(Ya)}}else T.ULS.sendTraceTag(7869457,
307,10,"PicturePasteRequestSucceeded received null or empty server response group"),Ya=new y.a(Ya.data),this.vhc(Ya)};this.Z0h=Ya=>{const Sa=!x.a.zq(this.ych,this.Ip.contentReplicator.Lt);T.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",Sa);if(Sa)this.Fzh();else{const Eb=Ya?Ya:null;if(Ya&&Eb&&Eb.retry<mb.BGl){Eb.retry+=1;Ya=new m.a(2,1,Eb.delay,()=>{this.Ip.contentReplicator.B0f(this.Z0h,Eb)},125);this.Ib.Xb(Ya);return}Ya=mb.clf;null!=Eb&&(Ya=Eb.delay);Ya=new m.a(2,1,Ya,
()=>{this.Ip.contentReplicator.B0f(null,null)},125);this.Ib.Xb(Ya);this.Gzh()}mb.bTf--;k.AFrameworkApplication.va.processAction(P.a.W8a,2);za.a.instance.koc(this.Ip,0);this.aug();this.Tw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.vhc=Ya=>{var Sa,Eb="",Jb="";Ya&&Ya.data&&Ya.data.Aj&&("X-CorrelationId"in Ya.data.Aj&&Ya.data.Aj["X-CorrelationId"]&&(Eb=Ya.data.Aj["X-CorrelationId"]),ba.a.cI in Ya.data.Aj&&Ya.data.Aj[ba.a.cI]&&(Jb=Ya.data.Aj[ba.a.cI]));Jb=""===Jb?"":String.format("[Operation Result: {0}]",
Jb);Eb=""===Eb?"":String.format("[X-CorrelationID: {0}]",Eb);T.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",Jb,Eb,Ya.data.Qe,z.SessionStatusManager.instance.WH);9===Ya.data.status||this.lB.J(this.gMa).fVd?(za.a.instance.koc(this.Ip,127),this.mBh(),this.CAc=null,(null===(Sa=k.AFrameworkApplication.K)||void 0===Sa?0:Sa.$("ShouldLogPicturesExtendedHealthKpis"))?(Ya=Object.assign(new ea.a,{extendedProperties:new Map([["HttpStatus",String(Ya.data.Qe)],
["ConnectionState",String(z.SessionStatusManager.instance.WH)],["OperationResult",Jb],["CorrelationId",Eb],["ErrorLevel","warning"]])}),this.og.logKpiFailure({kpiName:ib.c.CFa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Ya},optionalVeto:{name:ib.c.Bac,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):r.Health.instance.recordQosError("PictureRemotePasteFailed",bb,!1,!0,
!1,!1,null)):(this.lB.J(this.gMa).fVd=!0,this.fpb())};this.og=v.a.getInstance(ib.a);this.Rj=ab;this.Ib=Ga;this.Lm=Za;this.he=ra.App.za.Iq;this.ADe=Xb;this.o7=zb;this.w9j=Ib;this._operationId=$a;this.lgk=Hb;this.QUg=k.AFrameworkApplication.K.lc("PicturePasteHttpForceInboundDelay",3E3);this.Jah=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;ra.App.Smc.addHandler(this);this.U7j=!!Ub&&Ub.isFeatureEnabled(123)}get Tw(){return this.Zp||(this.Zp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get uhc(){return ra.App.uhc}get pMi(){return this.Mmb===
ra.App.MNf}get CCj(){return this.gMa!==this.lB.count}aug(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const yb=a.a.instance.Ta("Common.ISystemInitiatedFeedback");yb&&yb.execute(ab=>{ab.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get yX(){return this.Sl}hya(yb){var ab;yb.alt.length>Ra.kmb&&(yb.alt=yb.alt.substring(0,G.a.Jz(yb.alt,Ra.kmb)?Ra.kmb-1:Ra.kmb));this.og.logKpiUsage({kpiName:ib.c.CFa,
kpiType:0});if(this.o7&&mb.cMm(yb)){this.w9j&&J.c(Da.a.Vyl);var Ga="unknown";this.Jah&&(yb=new URL(yb.src),Ga=fa[xa.a.QQo(yb.protocol)]);T.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,Ga,this.lgk);yb=Object.assign(new ea.a,{extendedProperties:new Map});yb.extendedProperties.set("protocol",Ga);(null===(ab=k.AFrameworkApplication.K)||void 0===ab?0:ab.$("ShouldLogPicturesExtendedHealthKpis"))?(ab={name:ib.c.Bac,
errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:yb},yb.extendedProperties.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:ib.c.CFa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:yb},optionalVeto:ab})):r.Health.instance.recordQosError("PictureRemoteWithLocalPath",bb,!0,!0,!1,!1,yb);this.yvo()}else ab=new F.DictionaryPropertySet,yb=this.Ifj(yb),null!==yb.AFd&&"chart"===
yb.AFd.type&&ab.setValue(O.a.Is,7),this.Rj.z$d(ab,yb.width,yb.height,!0),T.ULS.shipAssertTag(7869444,307,Ka.ParagraphReader.Wb(this.zc.currentNode)),this.CAc=this.he.Vf("WebServiceCall",mb.KAn),T.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",yb.width,yb.height)),Ga=sa.a.rw(this.zc.currentNode),ab=this.Rj.iXd(Ga,ab),this.Oqh(ab,yb)}BWf(){0<this.Mmb&&(this.Sl=l.a.create(),this.Ip=this.jM.J(0).node.Ui(),T.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",
this.Mmb),this.D3d&&(T.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.Euo()),za.a.instance.epg(this.Ip),this.aug(),this.Ip.contentReplicator.forceOutbound(this.eEn,null,null))}cge(yb){if(0<this.Mmb){const Ga=yb.ja(O.a.fia,!1),Za=yb.ja(W.a.WXc,!1),Ub=yb.ja(W.a.F4,!1);yb=yb.ja(K.a.Wga,-1);for(let Xb=0;Xb<this.jM.count;Xb++){var ab=this.jM.J(Xb).blob;ab&&(ab=ab.properties,ab.setValue(O.a.fia,Ga),ab.setValue(W.a.WXc,Za),ab.setValue(W.a.F4,Ub),ab.setValue(K.a.Wga,yb),this.Rj.N$f(ab,
yb))}}}L5a(){}Ifj(yb){var ab=la.WordSectionNavigator.instance.OJ(this.zc.Cn);if(!ab)return yb;var Ga=H.a.Ki(mb.Qf.EB(ab)-mb.Qf.Awa(ab)-mb.Qf.toa(ab),1);ab=H.a.Ki(mb.Qf.Ft(ab)-mb.Qf.xJ(ab)-mb.Qf.jL(ab),0);T.ULS.shipAssertTag(7869449,307,0<=Ga);T.ULS.shipAssertTag(7869450,307,0<=ab);if(yb.height>Ga){const Za=Ga/yb.height;yb.height=Ga;yb.width=Math.floor(yb.width*Za)}yb.width>ab&&(Ga=ab/yb.width,yb.width=ab,yb.height=Math.floor(yb.height*Ga));return yb}yvo(){const yb=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;
if(!this.Dxc||this.Dxc.message!==yb&&!this.Dxc.ypa)this.Dxc=this.o7.sva(yb,!1),this.o7.qA(this.Dxc)}IMl(){if(this.ADe&&this.ADe.cjp())return this.ADe.khp();var yb=new Sys.Net.WebRequest;yb.set_url("PicturePaste.ashx");yb=yb.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(yb=f.a.Rn(yb,Y.a.fileId,this.Ip.vr));return yb}uUo(yb,ab){if(yb&&ab){const Ga=H.a.jf(ha.ImageReader.WC(yb.properties),0);yb=H.a.jf(ha.ImageReader.NH(yb.properties),1);0<Ga&&Ga<ab.width&&
(ab.width=Ga,ab.height=yb)}}fpb(){const yb={},ab=l.a.create().toString();yb[mb.correlationID]=ab;k.AFrameworkApplication.He.sj(this.lB.J(this.gMa).url,2,this.lB.J(this.gMa).V2n,yb,!1,2,this.picturePasteRequestSucceeded,this.vhc,null,void 0,void 0,void 0,void 0,"26");mb.bTf++;T.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",ab)}YYl(yb){return yb&&yb.data?yb.data.Qe:-1}Fmm(){za.a.instance.koc(this.Ip,127);this.mBh()}mBh(){T.ULS.shipAssertTag(7869458,
307,this.CCj);const yb=new ta.GraphTransaction(15);yb.Db(this.jM.J(0).node);for(let ab=this.gMa;ab<this.lB.count;ab++){const Ga=this.lB.J(ab).lCm;for(let Za=0;Za<Ga.count;Za++){const Ub=Ga.J(Za).blob.properties;this.Rj.QTa(Ub,Box4Intl.Box4Strings.l_PastedImageFailed);ha.ImageReader.ikj(Ub)}}yb.dispose();this.Lm.k4b(this.Ip,!1);this.Ezh()}Euo(){const yb=new L.StandardDialog;yb.Cd=0;yb.rx(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,
ra.App.MNf),null,!0);k.AFrameworkApplication.va.processAction(Da.a.I_i,2)}lnn(yb,ab){yb.alt.length>Ra.kmb&&(yb.alt=yb.alt.substring(0,G.a.Jz(yb.alt,Ra.kmb)?Ra.kmb-1:Ra.kmb));const Ga=new F.DictionaryPropertySet;this.Rj.z$d(Ga,yb.width,yb.height);ab=this.Rj.iXd(ab,Ga);yb=this.Ifj(yb);this.Oqh(ab,yb)}Ezh(){}Fzh(){}Gzh(){}yVd(){return!!mb.bTf}static get Qf(){return ia.a.instance}static cMm(yb){return!!yb&&!!yb.src&&!xa.a.EBi(yb.src)}}mb.clf=1E3;mb.BGl=4;mb.KAn="PicturePasteRequestTime";mb.correlationID=
"X-CorrelationId";mb.bTf=0;mb.h$m=20971520;Object(D.a)(mb,"Box4ImageSteward",Ra,[533])},1978:function(D,I,c){D=c(0);var l=c(54),f=c(90),a=c(11),k=c(28);class x extends Sys.UI.Control{constructor(H,L,J,M){super(document.createElement("div"));this.DZ=this.Oka=this.XL=this.aw=this.T2=this.a$a=this.rcb=null;this.vvc=this.Xab=!1;this.content=this._title=null;this.Bka=0;this.vvh=null;this.oga=0;this.IWi=null;this.khh=H;this.qZb=L;this.qk=J;this.eEh=M;this.ej=L.ownerDocument;this.xVd=this.Ht=this.aT=!1}get T9(){this.rcb||
(this.rcb=this.ej.createElement("div"),this.rcb.id=this.mj("WACCalloutOuter"),this.rcb.className="WACCalloutOuter",this.rcb.setAttribute(k.a.oh,k.a.auh),this.rcb.style.width=this.Bka+"px");return this.rcb}get vGc(){if(!this.a$a){this.a$a=this.ej.createElement("div");this.a$a.id=this.mj("WACCalloutBeakContainer");this.a$a.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";if(5===this.oga||6===this.oga||4===this.oga)H="CalloutBeakBottomFilled_32x16x32";H=f.createClusteredImage(32,
16,H,"WACCalloutBeak",!0,"");this.a$a.appendChild(H)}return this.a$a}set vGc(H){this.a$a=H}get UH(){return this.aT}get title(){return this._title}set title(H){this._title!==H&&(this._title=H,this.Oka&&(this.Oka.innerText=this._title))}get Ht(){return this.Xab}set Ht(H){this.Xab!==H&&(this.Xab=H,this.T2&&(this.T2.contains(this.XL)&&!this.Xab?this.T2.removeChild(this.XL):!this.T2.contains(this.XL)&&this.Xab&&this.Kmh()))}get xVd(){return this.vvc}set xVd(H){this.vvc!==H&&(this.vvc=H,this.T2&&(this.T2.contains(this.Oka)&&
!this.vvc?this.T2.removeChild(this.Oka):!this.T2.contains(this.Oka)&&this.vvc&&this.uoh()))}show(){this.aT||(this.Z8k(),this.YI(),this.qZb.appendChild(this.T9),this.T9.style.display="Block",this.elo(),this.aT=!0,this.IWi&&this.IWi())}dismiss(){this.aT&&(this.Bkl(),this.qZb.removeChild(this.T9),this.aT=!1,this.eEh&&this.eEh())}dispose(){this.dismiss();this.Oka=this.XL=this.aw=this.a$a=this.T2=this.rcb=null;Sys.Component.prototype.dispose.call(this)}mj(H){return this.get_element().id+H}Z8k(){this.T2=
this.ej.createElement("div");this.T2.id=this.mj("WACCalloutHeader");this.T2.className="WACCalloutHeader";this.Ht&&this.Kmh();this.xVd&&this.uoh();this.aw=this.ej.createElement("div");this.aw.id=this.mj("WACCalloutContent");this.aw.className="WACCalloutContent";this.aw.style.width=190<this.Bka?this.Bka-26+"px":"164px";this.aw.appendChild(this.content);this.T9.appendChild(this.vGc);this.T9.appendChild(this.T2);this.T9.appendChild(this.aw)}Kmh(){this.XL=this.ej.createElement("a");this.XL.className="WACCalloutCloseAnchor";
this.XL.id=this.mj("WACCalloutCloseAnchor");this.XL.href="#";this.T2.appendChild(this.XL);const H=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.XL.appendChild(H)}uoh(){this.Oka=this.ej.createElement("div");this.Oka.className="WACCalloutTitle UIFontBold";this.Oka.style.width=190<this.Bka?this.Bka-30+"px":"160px";this.Oka.id=this.mj("WACCalloutTitle");this.Oka.innerText=this.title;this.T2.contains(this.XL)?this.T2.insertBefore(this.Oka,
this.XL):this.T2.appendChild(this.Oka)}elo(){var H=this.khh;let L;if(1===this.oga){var J=this.vvh.y+16;L=-16}else 2===this.oga||3===this.oga||0===this.oga?(J=H.y+H.height+15,L=-15):(J=H.y-this.T9.clientHeight-15-2,L=this.T9.clientHeight-1);this.T9.style.top=J+"px";this.vGc.style.top=L+"px";1===this.oga?(H=this.vvh.x-16,this.T9.style.left="50%",this.T9.style.marginLeft=-this.Bka/2+"px",J=Sys.UI.DomElement.getBounds(this.T9),this.vGc.style.left=H-J.x+"px"):(J=H.x+this.khh.width/2,2===this.oga||5===
this.oga?(H=20,J-=36):0===this.oga||4===this.oga?(H=this.Bka/2-16,J-=this.Bka/2):(H=this.Bka-20-32,J=J-this.Bka+36),this.T9.style.left=J+"px",this.vGc.style.left=H+"px")}YI(){this.Ht&&!this.DZ&&(this.DZ=Object(l.a)(this,this.xga,"closeHandler"),this.qk.ob(a.a.click,this.XL,this.DZ,null))}Bkl(){this.Ht&&this.DZ&&(this.qk.sc(a.a.click,this.XL,this.DZ),this.DZ=null)}xga(){this.dismiss();return!0}}Object(D.a)(x,"Callout",Sys.UI.Control,[1007]);class y extends x{constructor(H,L,J,M,P,N=null){super(H,J,
P.M1,N);this.Z5g=0;this.Bka=this.K2l(M);this.G0b=L;this.Ti=P;this.YHo=7;this.Qq=this.G0b.ownerDocument.createElement("div");this.Qq.className="ModalCalloutControlOverlay";this.Qq.tabIndex=0;this.G0b.insertBefore(this.Qq,this.G0b.firstChild)}show(){this.UH||(this.Ti.y$d(),this.Ti.pga(!1),this.Qq.style.zIndex=String(this.Ti.JCa),super.show(),this.Pz(),this.Z5g=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.YHo))}dismiss(){this.UH&&(this.Ti.Yba(!1),this.R$(),this.G0b&&this.G0b.contains(this.Qq)&&
this.G0b.removeChild(this.Qq),super.dismiss(),window.clearTimeout(this.Z5g))}Pz(){this.Ti.u_(Object(l.a)(this,this.dismiss,"dismiss"));this.Ti.lD.ob(a.a.click,this.Qq,Object(l.a)(this,this.onClick,"onClick"))}R$(){this.Ti.Oda(Object(l.a)(this,this.dismiss,"dismiss"));this.Ti.lD.sc(a.a.click,this.Qq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}K2l(H){let L=0;switch(H){case 0:L=190;break;case 1:L=250;break;case 2:L=300;break;case 3:L=360}return L}}Object(D.a)(y,"ModalCallout",
x,[]);var m=c(7),r=c(536),z=c(178);class v extends y{constructor(H,L,J,M,P,N=null){super(H,L,J,M,P,N);this.iT=null}show(){if(!this.UH){const H=Object.assign(new r.a,{onShow:()=>{y.prototype.show.call(this)}});z.UISurfaces.IM().then(L=>{const J=L.externalNotification();this.iT=L.addNotification(J,H);return null},L=>{m.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null})}}dismiss(){this.UH&&this.iT&&(z.UISurfaces.IM().then(H=>{H.removeNotification(this.iT);return this.iT=
null},H=>{m.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(D.a)(v,"ReactManagedModalCallout",y,[]);var G=c(2);c.d(I,"a",function(){return F});class F{static kLh(H,L,J,M){return G.AFrameworkApplication.ua.Lb.eRa?new v(H,L,J,M,G.AFrameworkApplication.ua,null):new y(H,L,J,M,G.AFrameworkApplication.ua,null)}}Object(D.a)(F,"ModalCalloutControlFactory",null,[])},1982:function(D,I,c){D=c(0);var l=c(55),f=c(124),a=c(19),k=c(2),x=c(85);
class y{constructor(F,H){this.value=F;this.RHl=H}get nZd(){return this.RHl}}Object(D.a)(y,"ElementValueWrapper",null,[]);class m extends y{constructor(F,H,L){super(F,H);this.wAi=L}}Object(D.a)(m,"DimensionWrapper",y,[]);var r=c(1695),z=c(1696),v=c(7);c.d(I,"a",function(){return G});class G{static get Uni(){return G.k4j}static get rke(){return G.Kjk}static get pke(){return G.Jjk}static Vuf(F,H,...L){H=G.Bii(H);let J=!1;H||(H=G.cim(F,...L),J=!!H);return new y(H,J)}static Bii(F){for(const H of F)if(void 0!==
H&&null!==H&&""!==H)return H.trim();return null}static cim(F,...H){for(const L of H)if(H=F.getAttribute(L),void 0!==H&&null!==H&&(H+="",void 0!==H&&null!==H&&""!==H))return H.trim();return null}static Z7l(F,H){H=parseFloat(H);if(isNaN(H))return 0;switch(F){case "px":return Math.round(H);case "pt":return Math.round(l.a.SY(H,0,!1));case "in":return Math.round(l.a.Fca(H,0,!1));case "cm":return Math.round(l.a.Fca(f.a.gBh(H),0,!1));case "mm":return Math.round(l.a.Fca(f.a.gBh(.1*H),0,!1));default:return H}}static Qde(F,
H,...L){F=G.Vuf(F,H,...L);L=0;H=!1;if(F.value){H=F.value.endsWith("%");let J;H?(L="%",J=a.a.substring(F.value,0,F.value.length-1)):F.nZd?(L="px",J=F.value):(L=F.value.substr(F.value.length-2),isNaN(parseFloat(L))?J=a.a.substring(F.value,0,F.value.length-2):(L="px",J=F.value));L=G.Z7l(L,J)}return new m(L,F.nZd,H)}static Oii(F){return G.Qde(F,[F.style.width],"width","WIDTH","Width")}static A9h(F){return G.Qde(F,[F.style.height],"height","HEIGHT","Height")}static xJ(F){return G.Qde(F,[F.style.marginLeft],
"leftmargin","LEFTMARGIN","LeftMargin")}static jL(F){return G.Qde(F,[F.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static him(F){F=G.Vuf(F,[F.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return F.value&&F.value in G.rke&&void 0!==G.rke[F.value]&&null!==G.rke[F.value]?G.rke[F.value]:0}static rTm(F){F=G.Bii([F.style.borderCollapse]);return!!F&&!(void 0===F||null===F)&&("collapse"===F||"COLLAPSE"===F||"Collapse"===F)}static CMl(F){return G.Vuf(F,[F.style.backgroundColor,
F.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static x5k(F){const H=a.a.substring(F,0,1),L=a.a.substring(F,1,2);F=a.a.substring(F,2,3);return H+H+L+L+F+F}static nva(F){let H="";if(!F||""===F)return H;H=F.trim();if(H.startsWith("rgb")){H=a.a.substring(H,H.indexOf("(")+1,H.length-1);F=H.split(",");if(3!==F.length)return"";H="";for(let J=0;J<F.length;J++){var L=parseInt(F[J]);if(isNaN(L)||0>L||255<L)return"";L=L.toString(16);1===L.length&&(L="0"+L);H+=L}return a.a.ZA(H)}if(G.Uni[a.a.Zg(H)])return G.Uni[a.a.Zg(H)];
H.startsWith("#")&&(H=a.a.substring(H,1,H.length));if(isNaN(parseInt(H,16)))return"";3===H.length&&(H=G.x5k(H));return 6!==H.length?"":H}static Dyn(F){var H=F.indexOf("mso-tab-count");if(-1===H)return 0;const L=RegExp("([\\d])");let J="";for(H=H+13+1;H<F.length;H++){const M=F.charAt(H).toString();if(L.test(M))J+=M;else break}F=0;""!==J&&(F=parseInt(J));return F}static OUd(F,H){const L=G.CMl(F);L&&""!==L&&H.hv(J=>J.t$(G.nva(L)))}static Q4h(F){var H,L=F.style;if(!L)return null;let J=G.pke[L.borderTopStyle];
const M=G.nva(L.borderTopColor);let P=L.borderTopWidth,N=G.pke[L.borderRightStyle];const K=G.nva(L.borderRightColor);let O=L.borderRightWidth,V=G.pke[L.borderBottomStyle];const W=G.nva(L.borderBottomColor);let T=L.borderBottomWidth,Y=G.pke[L.borderLeftStyle];const ba=G.nva(L.borderLeftColor);L=L.borderLeftWidth;k.AFrameworkApplication.le("gdea6103;0df65435");if(null===(H=k.AFrameworkApplication.K)||void 0===H?0:H.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))F=
F.getAttribute("border"),null!==F&&(J=this.lkc(F,J),V=this.lkc(F,V),Y=this.lkc(F,Y),N=this.lkc(F,N),P=this.mkc(F,P),O=this.mkc(F,O),T=this.mkc(F,T),L=this.mkc(F,L),v.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new r.a(J,N,V,Y,M,K,W,ba,P,O,T,L)}static mkc(F,H){return""===H?F+"px":H}static lkc(F,H){return 0===H?"0"===F?1:11:H}static AOl(F){var H=F.querySelectorAll("[class^=TableCellContent]");H=1===H.length?H[0]:void 0;return(F=(null===H||void 0===
H?0:H.style)?H.style:F.style)?new z.a(F.paddingTop,F.paddingRight,F.paddingBottom,F.paddingLeft):null}}G.k4j=x.a.Z5("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson",
"DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray",
"696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue",
"ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3",
"mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip",
"FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8",
"tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");G.Kjk=x.a.Z5("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);G.Jjk=x.a.Z5("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(D.a)(G,"DefaultHtmlTranslatorHelper",
null,[])},1985:function(D,I,c){D=c(0);var l=c(7),f=c(54),a=c(2),k=c(215),x=c(211),y=c(92);class m{constructor(){this.E3d=22;this.z9f=1E3;this.T5n=2E4;this.Y5n=18E4}}Object(D.a)(m,"Config",null,[]);c.d(I,"a",function(){return r});class r{constructor(z){this._url=this.vv=null;this.PYa=this.OYa=0;this.Wdb=!1;this.q2c="";this.fch=this._body=this._headers=null;this.o7=z}send(z,v,G,F,H,L){this._url=z;this.vv=H;this.Wdb=L;this._body=v;this._headers=G;this.fch=F;this.makeRequest(null)}makeRequest(){a.AFrameworkApplication.He.sj(this._url,
1,this._body,this._headers,!0,2,Object(f.a)(this,this.mMb,"onRequestSucceeded"),Object(f.a)(this,this.lqa,"onRequestFailed"),null,void 0,void 0,void 0,void 0,"16",void 0,void 0,void 0,this.fch)}mMb(z){var v=r.nT;this.E6c();var G=z.data.yja;let F=null;if(G){r.XUm(G)||(G=Sys.Net.XMLDOM(z.data.se,!0));if("undefined"===typeof G.selectSingleNode){v=z.data.se||"[null]";800<v.length&&(v=v.substring(0,400)+"[...]"+v.substring(v.length-400,v.length));l.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',
v);this.L2a(z.data);return}F=G.selectSingleNode("/docdata/status")}a.AFrameworkApplication.bva&&z.data.Aj[k.PageStats.DMb]&&(this.q2c+=z.data.Aj[k.PageStats.DMb].toString());F&&("InProgress"===F.text&&this.OYa++<r.Yt.E3d||"ServiceBusy"===F.text&&3>this.PYa++)?(l.ULS.sendTraceTag(39387397,301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",F.text,this.OYa+this.PYa,this._url),this.XHa(r.Yt.z9f*(this.OYa+this.PYa))):(G=F?F.text:null,l.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",
G,this._url),4<v&&l.ULS.sendTraceTag(524104657,301,15,"Request Complete. Result: {0}; Url: {1}; Retry: {2}",G,this._url,v),a.AFrameworkApplication.bva&&""!==this.q2c&&(z.data.Aj[k.PageStats.DMb]=this.q2c,this.q2c=""),this.vv(!0,G,z.data))}lqa(z){this.Wdb?(r.cCa||(r.Lbb=new Date,r.cCa=!0,r.nT=1),(new Date).getTime()-r.Lbb.getTime()<r.Yt.Y5n?(this.retryOnFailure(4<=r.nT?r.Yt.T5n:r.Yt.z9f),4===r.nT&&(r.jzc=this.o7.sva(CommonUIStrings.l_NetworkProblemToast,!0),this.o7.qA(r.jzc))):this.L2a(z.data)):4>
r.nT?this.retryOnFailure(2*r.Yt.z9f):this.L2a(z.data)}XHa(z){z=new y.a(2,1,z,Object(f.a)(this,this.makeRequest,"makeRequest"),94);a.AFrameworkApplication.oc.Xb(z)}retryOnFailure(z){this.XHa(z);r.nT++}L2a(z){l.ULS.sendTraceTag(524104658,301,15,"Request failed - giving up (failures "+r.nT+"): "+this._url);this.vv(!1,null,z)}E6c(){r.cCa=!1;r.nT=0;if(r.jzc){this.o7.removeEntry(r.jzc);r.jzc=null;const z=this.o7.sva(CommonUIStrings.l_NetworkRestoredToast,!1);z.image=3;this.o7.qA(z)}}static z8(z,v,G){return r.gpl(z,
v,G)}static gpl(z,v,G){if(x.a.instance.Uua()&&a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.tyf)return!1;(new r(G)).send(z,null,null,null,v,!1);return!0}static XUm(z){return!!z&&"undefined"!==typeof z.selectSingleNode}}r.Lbb=null;r.cCa=!1;r.nT=0;r.jzc=null;r.Yt=new m;Object(D.a)(r,"ClientRequestWithRetry",null,[])},1986:function(D,I,c){D=c(0);class l{constructor(a){this.next=null;this.data=a}}Object(D.a)(l,"QueueNode",null,[]);c.d(I,"a",function(){return f});class f{constructor(){this.Gub=
this.Esb=null;this.Xj=0}get count(){return this.Xj}get isEmpty(){return!this.count||!this.Esb||!this.Gub}enqueue(a){a=new l(a);this.isEmpty?this.Gub=this.Esb=a:this.Esb=this.Esb.next=a;this.Xj=this.count+1}back(){return this.isEmpty?null:this.Esb.data}dequeue(){if(this.isEmpty)return null;const a=this.Gub;this.Gub=a.next;this.Xj=this.count-1;this.Gub||(this.Esb=null);return a.data}clear(){this.Gub=this.Esb=null;this.Xj=0}toArray(){const a=Array(this.count);let k=this.Gub;for(let x=0;x<this.count&&
k;x++)a[x]=k.data,k=k.next;return a}}Object(D.a)(f,"Queue",null,[])},2043:function(D,I,c){c.d(I,"b",function(){return l});c.d(I,"e",function(){return f});c.d(I,"d",function(){return a});c.d(I,"c",function(){return k});c.d(I,"h",function(){return x});c.d(I,"a",function(){return y});c.d(I,"f",function(){return m});c.d(I,"g",function(){return r});var l;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=1]="Inline";z[z.Floating=2]="Floating"})(l||(l={}));var f;(function(z){z[z.Undefined=0]="Undefined";
z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(f||(f={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=10]="Heavy"})(a||(a={}));var k;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";
z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(k||(k={}));var x;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]="DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=7]="DashLine";z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=
10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=17]="WavyDoubleLine"})(x||(x={}));var y;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";z[z.Justified=3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=
7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var m;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";z[z.PageNumbers=11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";
z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(m||(m={}));var r;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(r||(r={}))},2045:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.normal=0]="normal";f[f.beingCreated=1]="beingCreated";f[f.beingEdited=2]="beingEdited"})(l||(l={}));Object(D.b)("CommentType",l)},2047:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.atmention=
this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(D.a)(l,"DeltaAttributes",null,[])},2048:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static nqf(f){return f===l.create?0:f===l.reply?1:f===l.edit?2:f===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(D.a)(l,"CommentSessionType",null,[])},2049:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);var l;(function(f){f[f.unsaved=0]="unsaved";f[f.sentToServer=1]="sentToServer";f[f.succeeded=2]="succeeded";f[f.failed=3]="failed";f[f.saveNotNeeded=4]="saveNotNeeded"})(l||(l={}));Object(D.b)("CommentSaveStatus",l)},2050:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.className=f;this.MRc=a}}Object(D.a)(l,"HighlightCssClassPair",null,[])},2051:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.type=this.action=0;this.SJ=this.GA=
null}}Object(D.a)(l,"HighlightOperation",null,[])},2052:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);I=c(232);var l=c(111);class f extends I.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=null}el(){return 36}static Jba(a,k){const x=new f;x.FileId=a;x.LastKnownPaginationRevision=l.a(k);return x}}Object(D.a)(f,"PaginationRequest",I.a,[])},2054:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{b$b(f,a){let k="g";a.matchCase||a.v3d||(k+="i");if(a.matchPrefix||
a.matchWholeWord)f="\\b"+f;if(a.matchSuffix||a.matchWholeWord)f+="\\b";return new RegExp(f,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;Object(D.a)(l,"FindUtils",null,[1114])},2056:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this._text=f;this.Iuc=a}get text(){return this._text}get matchCase(){return this.mJb(1)}get matchWholeWord(){return this.mJb(2)}get v3d(){return this.mJb(4)}get matchPrefix(){return this.mJb(8)}get matchSuffix(){return this.mJb(16)}get ignorePunct(){return this.mJb(32)}get ignoreSpace(){return this.mJb(64)}mJb(f){return(this.Iuc&
f)===f}static createQuery(f,a){return new l(f,a)}}Object(D.a)(l,"Query",null,[1112])},2057:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.none=0]="none";f[f.matchCase=1]="matchCase";f[f.wholeWordOnly=2]="wholeWordOnly";f[f.wildCards=4]="wildCards";f[f.prefix=8]="prefix";f[f.suffix=16]="suffix";f[f.ignorePunct=32]="ignorePunct";f[f.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(D.b)("QueryFilters",l)},2058:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=
c(168),f=c(173),a=c(2),k=c(67),x=c(201);class y extends l.a{constructor(m,r=!1){super(m,!1,r)}get uWc(){return!1}get dL(){return x.a.bLc+"/modeless"}get Glb(){return null}set Glb(m){}get Clb(){return null}set Clb(m){}Qh(m,r=null,z=null){this.uT&&(z.isModal=!1);super.Qh(m,r,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Jc)this.OEj(),a.AFrameworkApplication.ua.ux.$w(f.AFrame.KOf),super.hide()}Gqk(){const m=
a.AFrameworkApplication.ua.ux,r=a.AFrameworkApplication.ua.Dp;m.J7(this.dL);m.wT(this.dL);r.ae(this.dL).parent=f.AFrame.xp}NCa(){k.FocusManager.iK()&&(super.NCa(),this.Gqk(),a.AFrameworkApplication.ua.ux.QI(f.AFrame.KOf))}D6f(){if(k.FocusManager.iK()&&!a.AFrameworkApplication.Lk){const m=k.FocusManager.instance();m.dS(this.dL);const r=m.getRegion(this.dL);r&&r.ak.Zy(null);m.J6a(this.dL)}}Jda(){"DL"===this.ECa||"DP"===this.ECa?super.Jda():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?
(this.OEj(),this.ivh()&&this.$rj(this.Jc.clientHeight,this.Jc.clientWidth)):this.IL()}IL(){this.$rj(l.a.gQg,l.a.nQg)}$rj(m,r){if(this.Clb&&this.Glb){let z,v;z=x.a.r$d+this.Glb;v=x.a.q$d+this.Clb;z+m>this.EB()&&(z=this.EB()-m);v+r>this.Ft()&&(v=this.Ft()-r);this.asj(z,v)}else super.IL()}Arf(m){if(!m)return null;m.endsWith("px")&&(m=m.substring(0,m.length-2));return x.a.Lcc(m)?((m=parseInt(m))||(m=1),m):null}OEj(){if(this.Jc&&this.Jc.style){var m=this.Arf(this.Jc.style.top);m&&(this.Glb=m-x.a.r$d);
if(m=a.AFrameworkApplication.isRtl?this.Arf(this.Jc.style.right):this.Arf(this.Jc.style.left))this.Clb=m-x.a.q$d}}}Object(D.a)(y,"ModelessCustomDialog",l.a,[])},2059:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);var l=c(7),f=c(2),a=c(312),k=c(199),x=c(645),y=c(773),m=c(774),r=c(19);class z{constructor(v,G=null,F=-1,H=null){this.n_=v;this.mkh=H||(()=>G);this.Sid=F}sj(v,G,F,H,L,J,M,P,N,K=null,O=!1,V=null,W=null){const T=new XMLHttpRequest;let Y="";J="";2===G?(Y="POST",F&&(J=F)):Y="GET";G={};
this.n_&&(v=a.a.IAd(G,v,a.a.NSb,f.AFrameworkApplication.d9a,this.n_));T.open(Y,v,!0);this.SMk(G,v);if(H)for(let Z in H)T.setRequestHeader(Z,r.a.$C(H[Z]));for(let Z in G)T.setRequestHeader(Z,G[Z]);v=V||this.Sid;0<v&&(T.timeout=v);v=[];Array.add(v,a.a.VQ);H=new Sys.Net.WebRequest;const ba=new y.a(1,2,H,v,L,M,P,N,O,K,W);T.onreadystatechange=()=>{this.eqn(T,ba)};try{T.send(J)}catch(Z){l.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}d$b(){return 1}eqn(v,G){if(this.VUk(v,
G)&&4===v.readyState)if(v.getResponseHeader(a.a.ahf)&&f.AFrameworkApplication.pMc)f.AFrameworkApplication.pMc();else{var F=v.getResponseHeader(a.a.D5e);a.a.Fng(F);this.yWo(v,G);v.status===k.a.$y?(G.status=2,G.mI(new m.a(G))):(G.status=v.status&&v.status!==k.a.Uic?v.status===k.a.jja?5:3:7,G.j4(new x.a(G)))}}SMk(v,G){v["X-xhr"]=1;f.AFrameworkApplication.VQa&&(v[a.a.t2d]=1);f.AFrameworkApplication.buildVersion&&(v[a.a.hSa]=r.a.$C(f.AFrameworkApplication.buildVersion));let F=null;this.mkh&&(F=this.mkh());
F&&(v[a.a.xdd]=F);f.AFrameworkApplication.canary&&(v[a.a.Qua]=r.a.$C(f.AFrameworkApplication.canary),f.AFrameworkApplication.bmb&&l.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",v[a.a.Qua]));f.AFrameworkApplication.accessToken&&(a.a.LBb(G,f.AFrameworkApplication.bX)||(v[a.a.IEc]=r.a.$C(f.AFrameworkApplication.accessToken)),a.a.LBb(G,f.AFrameworkApplication.lba)||(v[a.a.JEc]=f.AFrameworkApplication.rua.toString()));f.AFrameworkApplication.userType&&(v[a.a.coe]=r.a.$C(f.AFrameworkApplication.userType))}yWo(v,
G){G.Qe=v.status?v.status:k.a.Uic;try{G.se=v.responseText;if(void 0!==G.wTa&&null!==G.wTa){G.Aj={};for(let F=0;F<G.wTa.length;++F){const H=G.wTa[F];G.Aj[H]=v.getResponseHeader(H)}}G.Fhe&&(G.yja=v.responseText&&v.responseText.length?v.responseXML:null)}catch(F){l.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",G.id,G.request.get_url(),4===v.readyState)}}VUk(v,G){return v?G?!0:(l.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(l.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(v,G,F){return new z(v,null,F,G)}}Object(D.a)(z,"SimpleClientRequestSender",null,[852])},2060:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.connected=0]="connected";f[f.disconnected=1]="disconnected";f[f.connecting=2]="connecting";f[f.timeout=3]="timeout"})(l||(l={}));Object(D.b)("AppNetworkConnectivityState",l)},2061:function(D,
I,c){c.d(I,"a",function(){return l});D=c(0);class l{fPa(){}P7b(){}$ge(){}sfe(){}reset(){}Vjf(){}update(){}ypb(){}dispose(){}}Object(D.a)(l,"FindStatusManagerStub",null,[321,10])},2069:function(D,I,c){c.d(I,"b",function(){return l});c.d(I,"a",function(){return f});var l;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(l||(l={}));var f;(function(a){a.left="left";a.center=
"center";a.right="right";a.both="both"})(f||(f={}))},2070:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);var l=c(768);class f{static for(a){return[l.a.getTypeName(),a.getTypeName()]}}Object(D.a)(f,"RequestSignalParentPath",null,[])},2071:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(767),f=c(1766);class a{constructor(k){this.Qdd=!1;this.operation=k}static f8b(k){return new a(k)}GTc(){this.Qdd=!0;return this}Loe(k){this.BGd=this.u4e(k);return this}build(){let k;this.BGd&&(k=
{GTc:this.Qdd,BGd:this.BGd});return{operation:this.operation,p9f:k}}u4e(k){const {annotation:x,$ec:y,jt:m="add"}=k,r=f.a.dyj(y);return(z,v)=>z.annotationType!==x.getTypeName()||v!==this.i9l(m)?!1:r.execute(z)}i9l(k){switch(k){case "add":return l.a.getTypeName();case "update":return l.n.getTypeName();case "delete":return l.b.getTypeName();default:throw Error(`Unknown operation type: "${k}"`);}}}Object(D.a)(a,"AugloopRequestBuilder",null,[1784,1785,1786])},2072:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);class l{constructor(f){this.parentId=f;this.execute=a=>a.parentPath.endsWith(this.parentId)}}Object(D.a)(l,"ParentIdAnnotationMatcher",null,[1782])},2092:function(D,I,c){D=c(0);var l=c(1618),f=c(1619),a=c(1678),k=c(224),x=c(34);class y{}y.eventType="Type";y.ohb="Time";y.eventId="Id";y.Quh="AttributionId";y.Ruh="AttributionProvider";y.Puh="AttributionName";y.zuh="AssigneeId";y.Auh="AssigneeProvider";y.yuh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.eFh="Anchor";y.anchorExtensionList=
"AnchorExtensionList";y.Q_i="Percent";y.priority="Priority";y.undoId="UndoId";y.isLossy="IsLossy";y.recordExtensionList="RecordExtensionList";Object(D.a)(y,"Key",null,[]);var m=c(365),r=c(1824);const z=G=>{if(!G)return null;let F=null;G=m.a.CCb(G,H=>H.toString(),H=>H.toString());0<G.count&&(F=new r.a(G));return F};c.d(I,"a",function(){return v});class v{cbg(G){if(!G)return"[]";G=v.m5k(G);return x.c(G)}i6b(G){G=x.b(G||"[]");return v.W4k(G)}static vea(G,F){throw Error.argument(G,F);}static J9b(G,F){F=
F.toString();return F in G?G[F].toString():null}static AGb(G,F){F=F.toString();F in G||v.vea("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return G[F].toString()}static qqf(G,F){F=F.toString();F in G||v.vea("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return Number.parseInvariant(G[F].toString())}static l5l(G,F,H){F=F.toString();return F in G?Boolean.parse(G[F].toString()):H}static m5l(G,F){F=F.toString();return F in
G?G[F]:null}static hig(G){G=new Date(G);isNaN(G.getUTCMilliseconds())&&v.vea("dateTime","Date and time is in invalid format");return G}static xcf(G){return G.toISOString()}static wKh(G,F){return z(v.m5l(G,F))}static n5k(G){const F={};F[y.eventType]=G.type;F[y.ohb]=v.xcf(G.time);F[y.eventId]=G.recordId;G.isLossy!==v.uyi&&(F[y.isLossy]=G.isLossy);G.user&&(G.user.UserId&&G.user.Provider&&G.user.DisplayName||v.vea("record","HistoryRecord has invalid attribution"),F[y.Quh]=G.user.UserId,F[y.Ruh]=G.user.Provider,
F[y.Puh]=G.user.DisplayName);G.commentId&&(F[y.eFh]=G.commentId);if(G.anchorExtensionList&&G.anchorExtensionList.extensions){var H=G.anchorExtensionList.extensions.enc();F[y.anchorExtensionList]=H}G.recordExtensionList&&G.recordExtensionList.extensions&&(H=G.recordExtensionList.extensions.enc(),F[y.recordExtensionList]=H);switch(G.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:G.assignee&&G.assignee.UserId&&G.assignee.Provider&&G.assignee.DisplayName||v.vea("record","HistoryRecord has invalid assignee");
F[y.zuh]=G.assignee.UserId;F[y.Auh]=G.assignee.Provider;F[y.yuh]=G.assignee.DisplayName;break;case 5:G.schedule||v.vea("record","Schedule history record must have a schedule object");G.schedule.startDate&&(F[y.startDate]=v.xcf(G.schedule.startDate));G.schedule.endDate&&(F[y.endDate]=v.xcf(G.schedule.endDate));break;case 6:(0>G.completion||100<G.completion)&&v.vea("record","Progress history record must have a completion >= 0 and <= 100");F[y.Q_i]=G.completion;break;case 10:(0>G.priority||10<G.priority)&&
v.vea("record","Priority history record must have a completion >= 0 and <= 10");F[y.priority]=G.priority;break;case 9:G.title||v.vea("record","SetTitle history record must have a title");F[y.title]=G.title;break;case -1:G.undoId||v.vea("record","Undo history record must have an id to undo");F[y.undoId]=G.undoId;break;default:v.vea("record","Unsupported history record type")}return F}static w5k(G){var F=null,H=v.J9b(G,y.Quh);const L=v.J9b(G,y.Ruh),J=v.J9b(G,y.Puh);if(H||L||J)H&&L&&J||v.vea("dictionary",
"Record has invalid attribution user"),F=new l.a(H,L,J);F=new f.a(v.qqf(G,y.eventType),F,v.hig(v.AGb(G,y.ohb)),v.AGb(G,y.eventId));F.commentId=v.J9b(G,y.eFh);F.anchorExtensionList=v.wKh(G,y.anchorExtensionList);F.recordExtensionList=v.wKh(G,y.recordExtensionList);F.isLossy=v.l5l(G,y.isLossy,v.uyi);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee=new l.a(v.AGb(G,y.zuh),v.AGb(G,y.Auh),v.AGb(G,y.yuh));break;case 5:F.schedule=new a.a;if(H=v.J9b(G,y.startDate))F.schedule.startDate=
v.hig(H);if(G=v.J9b(G,y.endDate))F.schedule.endDate=v.hig(G);break;case 10:F.priority=v.qqf(G,y.priority);(0>F.priority||10<F.priority)&&v.vea("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:F.completion=v.qqf(G,y.Q_i);(0>F.completion||100<F.completion)&&v.vea("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:F.title=v.AGb(G,y.title);break;case -1:F.undoId=v.AGb(G,y.undoId);break;default:v.vea("dictionary","Unsupported history record type")}return F}static m5k(G){const F=
Array(G.length);for(let H=0;H<G.length;++H)F[H]=v.n5k(G.J(H));return F}static W4k(G){const F=new k.a;for(const H of G)G=v.w5k(H),F.add(G);return F}}v.uyi=!1;Object(D.a)(v,"JsonTaskHistorySerialization",null,[750])},2093:function(D,I,c){D=c(0);class l{constructor(){this.Cig=new Set}subscribe(z){this.Cig.add(z)}unsubscribe(z){this.Cig.delete(z)}GB(z,v){for(const G of this.Cig)try{G.filter(z,v)&&G.action(z,v)}catch{}}}Object(D.a)(l,"DelegatingAnnotationEventHandlerImpl",null,[]);var f=c(398),a=c(368),
k=c(247),x=c(1525);class y{constructor(){this.z_=[]}enqueue(z){var v;this.z_.push(z);null===(v=this.promise)||void 0===v?void 0:v.resolve()}async dequeue(){0===this.z_.length&&(this.promise=new x.a,await this.promise.completion);return this.z_.shift()}}Object(D.a)(y,"BlockingQueue",null,[]);class m{constructor(z,v,G,F){this.rA=z;this.t2b=v;this.J3=G;this.Xnn=async()=>{await f.a.Uk();return this.J3.getAugLoopRuntimeManager()};this.Zej=new k.a(this.Xnn);this.Dok=this.tok(F.map(H=>H.getTypeName()))}async executeRequest(z){const v=
z.operation;if(z=z.p9f)return z=this.Ino(z),await this.submitOperation(v),z;await this.submitOperation(v)}async jxl(z){const v=z.operation;z=z.p9f;if(!z)throw Error("Streaming request must have result handling");z=this.Nno(z);await this.submitOperation(v);return z}async dispose(){await this.Zej.value;for(const z of this.Dok)this.rA.sc(this.t2b,z)}Ino(z){const v=z.GTc,G=z.BGd;let F;return(new Promise(H=>{F={filter:G,action:L=>{v?H(L):H(L.content)}};this.t2b.subscribe(F)})).finally(()=>{this.t2b.unsubscribe(F)})}Nno(z){const v=
z.GTc,G=z.zCf;z=z.FGd;const F=new x.a,H=new y,L={filter:z,action:J=>{H.enqueue(v?J:J.content)}};this.t2b.subscribe(L);return{chunks:this.mol({[Symbol.asyncIterator](){return{async next(){const J=await H.dequeue();return G(J)?(F.resolve(J),{value:void 0,done:!0}):{value:J,done:!1}}}}},()=>{this.t2b.unsubscribe(L)}),completion:F.completion}}async *mol(z,v){try{for await(const G of z)yield G}finally{v()}}async submitOperation(z){(await this.Zej.value).submitOperation(Object.assign(new a.a,{operation:z}))}tok(z){const v=
new Set;for(const G of z)v.add(G)&&this.rA.ob(this.t2b,G);return v}}Object(D.a)(m,"AugloopAsyncClientImpl",null,[1810]);c.d(I,"a",function(){return r});class r{constructor(z,v){this.rA=z;this.J3=v}d5b(z){return new m(this.rA,new l,this.J3,z.VBd)}}Object(D.a)(r,"AugloopAsyncClientFactory",null,[])},2094:function(D,I,c){D=c(0);var l=c(2),f=c(7),a;(function(x){x[x.B8o=0]="Healthy";x[x.t9o=1]="MissedScan";x[x.D9o=2]="NeedsReset";x[x.C7o=3]="CriticalUnresponsive";x[x.c9o=4]="KickoutComponent"})(a||(a=
{}));Object(D.b)("TimerBasedWatchDogStatus",a);c.d(I,"a",function(){return k});class k{constructor(x,y,m){this.kvd=this.v2g=this.x3g=this.cVb=this.EBa=0;this.SNi=3;this.wJd=3E4;this.A0b=x;this.x$a=y;this.Uji=m}R6a(){this.EBa=0}async ccn(){const x=Date.now(),y=this.A0b.gec;this.kvd++;if(this.v2g==y&&this.Zro(x,this.x3g))return{["WatchDogScanTime"]:x,["LastComponentScanTime"]:y,["ComponentStatus"]:a[this.cVb],["ActionTaken"]:"None. Skipping to Match Interval"};this.v2g=y;this.x3g=x;this.x$a=this.A0b.ANh;
this.cVb=this.X5h(x,y);3===this.cVb&&(await this.KOo(),this.cVb=this.X5h(x,this.A0b.gec));return this.tAk(this.cVb,x,y)}oVm(){return 0===this.cVb}X5h(x,y){let m=0;x>y+Math.max(this.x$a,this.wJd)+this.Uji&&(m=0===this.EBa?1:this.EBa<this.SNi?2:this.EBa===this.SNi?3:4);return m}tAk(x,y,m){const r={};r.WatchDogScanNumber=this.kvd;r.WatchDogScanTime=y;r.LastComponentScanTime=m;r.ComponentStatus=a[x];r.ExpectedComponentScanInterval=this.x$a;r.GraceTimeInMS=this.Uji;r.ActualTimeBetweenWatchDogAndComponentScans=
y-m;switch(x){case 0:r.ActionTaken="None";this.EBa=0;break;case 1:this.EBa++;r.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.EBa++;r.ActionTaken="Component restarted";f.ULS.sendTraceTag(509686347,3037,15,"Restarting Component with interval {0}",this.x$a);this.A0b.luj();x=this.x$a;this.lGf&&(x=Math.min(this.x$a,this.wJd/2));this.A0b.wtj(x);break;case 3:this.EBa++;r["ActionTaken?"]="Attempted Synchronous run: "+a[x];break;case 4:f.ULS.sendTraceTag(512570578,3037,10,"Component is not Responding. WatchDog would kickout now"),
r["ActionTaken?"]="Kickout would happen here",r.ShouldKickout=!0,this.EBa++}r.NextExpectedComponentScanTimeInMs=m+(this.EBa+1)*this.x$a;r.MissedScans=this.EBa;return r}async KOo(){return this.A0b.g1h()}Zro(x,y){return y+this.x$a>x}get lGf(){return null!=this.cCg?this.cCg:this.cCg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}}Object(D.a)(k,"TimerBasedWatchDog",null,[1144])},2096:function(D,I,c){D=c(0);class l{constructor(k){this.result=
null;this.q7i=k}exec(k){return(this.result=this.q7i.exec(k))?!0:!1}vJ(){return this.result.index}HRd(){return this.q7i.lastIndex}}Object(D.a)(l,"RegularExpressionWrapper",null,[]);var f=c(19);c.d(I,"a",function(){return a});class a{u3c(k){return this.ltj(k).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}Q1i(k){var x=k.text;x=k.v3d?this.gzo(x):this.ltj(x);if(k.ignorePunct||k.ignoreSpace){let y="";k.ignoreSpace&&(y+="\\s");k.ignorePunct&&(y+=a.FIn);y="["+y+"]*";for(let m=1;m<
x.length;m++)if(!k.v3d||"{"!==x[m].charAt(0)&&"@"!==x[m].charAt(0))x[m]=y+x[m]}return x.join("")}OMb(k){return[k]}H0d(k){for(let x=0;x<k.length;++x){const y=k.charAt(x);let m=0;if("["===y){if(!({QD:m}=this.QSm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("<"===y){if(!this.NSm(k.substr(x)))return!1}else if(">"===y){if(!x)return!1}else if("{"===y){if(!x||!({QD:m}=this.PSm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("@"===y){if(!x||!this.OSm(k.substr(x)))return!1}else if("("===y){if(!({QD:m}=
this.MSm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}h_h(k,x){let y,m;m=y=0;if(k.length<=x)return{returnValue:!1,QD:y,Edd:m};const r=k.length;var z=k.charAt(x);if("["===z)for(z=x+1;z<r;z++){if("]"===k.charAt(z)&&1!==z-x)return y=z,m=5,{returnValue:!0,QD:y,Edd:m}}else if("{"===z)for(z=-1,x+=1;x<r;x++){let v=k.charAt(x);if(","===v)z=x;else if("}"===v)return m=-1===z?6:1!==x-z?7:8,y=x,{returnValue:!0,QD:y,Edd:m}}return{returnValue:!1,QD:y,Edd:m}}iOo(k,
x,y){let m;if((m=x)||1!==k.length)switch(k.charAt(x+1)){case "{":let r,z;if(!({QD:r,Edd:z}=this.h_h(k,x+1)).returnValue)return{returnValue:this.lJa("*",y,!1),QD:m};k=this.lJa("*",y,!0)+this.lJa(k.substring(x+1,r+1),z);m=r;if(7===z||8===z)k+="?";return{returnValue:k,QD:m};case "@":return m=x+1,{returnValue:this.lJa("*",y,!0),QD:m};case "*":if(!x){for(m++;"*"===k.charAt(m);)m++;if(m===k.length)return{returnValue:this.lJa("*",y,!0),QD:m}}return{returnValue:this.lJa("*",y,!1),QD:m};default:return{returnValue:this.lJa("*",
y,!1),QD:m}}else return{returnValue:this.lJa(k,y,!0),QD:m}}lJa(k,x,y=!1){const m=k.length;switch(x){case 5:return"!"===k.charAt(1)&&2<m?"([^"+this.R1i(k.substr(2,m-3))+"]\u0640*)":"(["+this.R1i(k.substr(1,m-2))+"]\u0640*)";case 6:return k;case 7:return k;case 9:return"+?";case 8:return k;case 3:return"\\b";case 4:return"\\b";case 1:return".";case 2:return y?"(.+?)":"(.*?)";case 10:return k}return null}Qii(k){switch(k){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}kDn(k){return"["===
k||"]"===k||"\\"===k||"("===k||")"===k?String.format("\\{0}",k):"'"===k||"\u2018"===k||"\u2019"===k||'"'===k||"\u201c"===k||"\u201d"===k||f.a.ada(k)?this.F1f(k):k}R1i(k){const x=[];for(let y=0;y<k.length;++y)x[y]=this.kDn(k.charAt(y));return x.join("")}QSm(k){let x;var y;x=-1;var m=new l(RegExp("\\[.+?\\]","g"));if(m.exec(k)){if(y=m.vJ())return{returnValue:!1,QD:x};x=m.HRd()}else return{returnValue:!1,QD:x};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(k.substring(1,x-1)))return{returnValue:!1,QD:x};
y=new l(RegExp("[^!\\[]-[^\\]]","g"));for(k.substring(0,x);y.exec(k.substring(0,x));){m=y.vJ();const r=RegExp("[-]","g");m=k.substring(m,y.HRd()).split(r);if(m[0].charAt(0)>m[1].charAt(0))return{returnValue:!1,QD:x}}return{returnValue:!0,QD:x}}NSm(k){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(k)?!1:!0}PSm(k){let x;x=-1;var y;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(k))return{returnValue:!1,QD:x};const m=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(m.exec(k)){if(y=m.vJ())return{returnValue:!1,
QD:x};x=m.HRd();y=RegExp("[{,}]","g");y=k.substring(0,x).split(y);if(4===y.length&&(k=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),k>=y))return{returnValue:!1,QD:x}}else return{returnValue:!1,QD:x};return{returnValue:!0,QD:x}}OSm(k){return(new l(RegExp("\\@\\{","g"))).exec(k)?!1:!0}MSm(k){let x;x=-1;let y;const m=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(m.exec(k)){y=m.vJ();x=m.HRd();if(y)return{returnValue:!1,QD:x};if(this.H0d(k.substring(1,x-1)))return{returnValue:!0,
QD:x}}return{returnValue:!1,QD:x}}gzo(k){const x=[],y=k.length;let m=0;for(let r=0;r<y;++r){const z=m,v=k.charAt(r);let G=0,F=0;"["===v||"\\"===v||"^"===v||"$"===v||"."===v||"|"===v||"+"===v||"("===v||")"===v||"?"===v||"*"===v||"<"===v||">"===v||"@"===v||"?"===v||"{"===v?"["!==v&&"{"!==v||!({QD:G,Edd:F}=this.h_h(k,r)).returnValue?"?"===v||"<"===v||">"===v||"@"===v?(F=this.Qii(v),x[z]=this.lJa(v,F)):"*"===v?(F=this.Qii(v),x[z]=({QD:G}=this.iOo(k,r,F)).returnValue,r=G):"("===v||")"===v?(F=10,x[z]=this.lJa(v,
F)):x[z]=String.format("\\{0}",v):(x[z]=this.lJa(k.substr(r,G+1-r),F),r=G):x[z]="'"===v||"\u2018"===v||"\u2019"===v||'"'===v||"\u201c"===v||"\u201d"===v||"-"===v||"\u2013"===v||"\u2014"===v||f.a.ada(v)?"["+this.F1f(v)+"]":"\u2026"===v?"\\.\\.\\.":v;""!==x[z]&&0===F&&(x[z]=r<k.length-1&&("@"===k.charAt(r+1)||"{"===k.charAt(r+1))?"("+x[z]+"\u0640*)":x[z]+"\u0640*");m++}return x}ltj(k){const x=[];for(let y=0;y<k.length;++y){const m=k.charAt(y);x[y]="["===m||"\\"===m||"^"===m||"$"===m||"."===m||"|"===
m||"+"===m||"("===m||")"===m||"?"===m||"*"===m?String.format("\\{0}",m):"'"===m||"\u2018"===m||"\u2019"===m||'"'===m||"\u201c"===m||"\u201d"===m||"-"===m||"\u2013"===m||"\u2014"===m||f.a.ada(m)?"["+this.F1f(m)+"]":"\u2026"===m?"\\.\\.\\.":m;""!==x[y]&&(x[y]+="\u0640*")}return x}F1f(k){return"'"===k||"\u2018"===k||"\u2019"===k?"'\u2018\u2019":'"'===k||"\u201c"===k||"\u201d"===k?'"\u201c\u201d':"-"===k||"\u2013"===k||"\u2014"===k?"-\u2013\u2014":f.a.ada(k)?a.mPo:k}static get instance(){return a._instance||
(a._instance=new a)}}a._instance=null;a.mPo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";a.FIn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(D.a)(a,"WordQueryProcessor",null,[935])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20205649/wdjs/WordEditorDSVersionHistoryRemoved.common.js.map