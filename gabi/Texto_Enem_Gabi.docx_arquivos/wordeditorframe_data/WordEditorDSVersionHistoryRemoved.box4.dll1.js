'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1066:function(D,I,c){function l(N,K=self){K.addEventListener("message",function W(V){if(V&&V.data){var {id:T,type:Y,path:ba}=Object.assign({path:[]},V.data),Z=(V.data.Yth||[]).map(m);try{const ha=ba.slice(0,-1).reduce((ia,sa)=>ia[sa],N),la=ba.reduce((ia,sa)=>ia[sa],N);switch(Y){case "GET":var ea=la;break;case "SET":ha[ba.slice(-1)[0]]=m(V.data.value);ea=!0;break;case "APPLY":ea=la.apply(ha,Z);break;case "CONSTRUCT":const ia=
new la(...Z);ea=Object.assign(ia,{[v]:!0});break;case "ENDPOINT":const {port1:sa,port2:Oa}=new MessageChannel;l(N,Oa);ea=x(sa,[sa]);break;case "RELEASE":ea=void 0;break;default:return}}catch(ha){ea={value:ha,[H]:0}}Promise.resolve(ea).catch(ha=>({value:ha,[H]:0})).then(ha=>{const [la,ia]=y(ha);K.postMessage(Object.assign(Object.assign({},la),{id:T}),ia);"RELEASE"===Y&&(K.removeEventListener("message",W),"MessagePort"===K.constructor.name&&K.close())})}});K.start&&K.start()}function f(N){if(N)throw Error("Proxy has been released and is not useable");
}function a(N,K=[],O=function(){}){let V=!1;const W=new Proxy(O,{get(T,Y){f(V);if(Y===F)return()=>r(N,{type:"RELEASE",path:K.map(ba=>ba.toString())}).then(()=>{"MessagePort"===N.constructor.name&&N.close();V=!0});if("then"===Y){if(0===K.length)return{then:()=>W};T=r(N,{type:"GET",path:K.map(ba=>ba.toString())}).then(m);return T.then.bind(T)}return a(N,[...K,Y])},set(T,Y,ba){f(V);const [Z,ea]=y(ba);return r(N,{type:"SET",path:[...K,Y].map(ha=>ha.toString()),value:Z},ea).then(m)},apply(T,Y,ba){f(V);
T=K[K.length-1];if(T===G)return r(N,{type:"ENDPOINT"}).then(m);if("bind"===T)return a(N,K.slice(0,-1));const [Z,ea]=k(ba);return r(N,{type:"APPLY",path:K.map(ha=>ha.toString()),Yth:Z},ea).then(m)},construct(T,Y){f(V);const [ba,Z]=k(Y);return r(N,{type:"CONSTRUCT",path:K.map(ea=>ea.toString()),Yth:ba},Z).then(m)}});return W}function k(N){N=N.map(y);return[N.map(K=>K[0]),Array.prototype.concat.apply([],N.map(K=>K[1]))]}function x(N,K){M.set(N,K);return N}function y(N){for(const [K,O]of J)if(O.Wzh(N)){const [V,
W]=O.serialize(N);return[{type:"HANDLER",name:K,value:V},W]}return[{type:"RAW",value:N},M.get(N)||[]]}function m(N){switch(N.type){case "HANDLER":return J.get(N.name).deserialize(N.value);case "RAW":return N.value}}function r(N,K,O){return new Promise(V=>{const W=z();N.addEventListener("message",function ba(Y){Y.data&&Y.data.id&&Y.data.id===W&&(N.removeEventListener("message",ba),V(Y.data))});N.start&&N.start();N.postMessage(Object.assign({id:W},K),O)})}function z(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}D=c(0);const v=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),H=Symbol("Comlink.thrown"),L=N=>"object"===typeof N&&null!==N||"function"===typeof N,J=new Map([["proxy",{Wzh:N=>L(N)&&N[v],serialize(N){const {port1:K,port2:O}=new MessageChannel;l(N,K);return[O,[O]]},deserialize(N){N.start();return a(N,[],void 0)}}],["throw",{Wzh:N=>L(N)&&H in N,serialize({value:N}){return[N instanceof Error?
{IQa:!0,value:{message:N.message,name:N.name,stack:N.stack}}:{IQa:!1,value:N},[]]},deserialize(N){if(N.IQa)throw Object.assign(Error(N.value.message),N.value);throw N.value;}}]]),M=new WeakMap;c.d(I,"a",function(){return P});class P{static gSj(N){P.wab=N;P.pnk=a(N,[],void 0)}static get Endpoint(){return P.wab}static get hSj(){return P.pnk}}Object(D.a)(P,"WorkerUtils",null,[])},1082:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"WaterlineOverrideSettings",null,[])},
1083:function(D,I,c){D=c(0);var l=c(413),f=c(526),a=c(575),k=c(232);class x extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}el(){return 97}static Jba(G,F,H){const L=new x;L.FileId=G;L.HighWaterline=F;L.LowWaterline=H;return L}}Object(D.a)(x,"GetActivitiesRequest",k.a,[]);class y extends k.a{constructor(G,F,H){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;this.Waterline=F;this.Settings=H}el(){return 107}static Jba(G,F,H){return new y(G,
F,H)}}Object(D.a)(y,"GetRelevantActivitiesRequest",k.a,[]);class m extends k.a{constructor(G,F){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=G;this.WaterlineOverrideSettings=F}el(){return 96}static Jba(G,F){return new m(G,F)}}Object(D.a)(m,"GetWywaActivitiesRequest",k.a,[]);class r{}Object(D.a)(r,"RelevantActivitiesSettings",null,[]);class z extends k.a{constructor(){super();this.FileId=null}el(){return 109}static Jba(G){const F=new z;F.FileId=G;return F}}Object(D.a)(z,"UpdateWaterlineRequest",
k.a,[]);c.d(I,"a",function(){return v});class v{constructor(G,F,H,L,J){this.O$j=G;this.Vud=F;this.oPe=H;this.rqc=L;this.LMg=J}requestWYWAActivities(G){G=m.Jba(this.Vud(),G);return l.a.then(this.z8(G,"wywa"),F=>F)}requestActivities(G,F){G=x.Jba(this.Vud(),G,F);return l.a.then(this.z8(G,"activities"),H=>H)}$2n(){const G=z.Jba(this.Vud());return l.a.then(this.z8(G,"waterline"),F=>F)}requestRelevantActivities(G,F){F=Object.assign(new r,{FirstDocumentOpen:F,MockDataEnabled:!1});G=y.Jba(this.Vud(),G,F);
return l.a.then(this.z8(G,"relevant"),H=>H)}updateActivityState(G){return l.a.Rad(this.LMg,F=>F.bRo(G.itemIds,G.activityStatesToSet,G.activityStatesToReset,G.resetUnseenCount))}requestActivityFeed(){return l.a.Rad(this.LMg,G=>G.getActivityFeed(null))}z8(G,F){const H={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.Rad(this.O$j,L=>L.Wv(this.oPe,H,f.a.OGh(G,this.rqc),F)),L=>{if(!(L&&L.args&&L.args.data&&L.args.data.se))return null;({group:L}=a.a.S1(L.args.data.se));return L&&L.Responses&&
L.Responses.length?L.Responses[0]:null})}}Object(D.a)(v,"SharedActivityRepository",null,[])},1416:function(D,I,c){c.d(I,"a",function(){return f});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.S8o=1]="Inference"})(l||(l={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.Hap=1]="VoiceDictationBadge";a[a.Iap=2]="VoiceDictationPhrase"})(f||(f={}))},1522:function(D,I,c){c.r(I);c.d(I,"Box4PasteSteward",function(){return ba});D=c(0);var l=c(22),f=c(2),a=c(19),k=c(124),x=c(55),y=c(6),m=c(7),r=c(35),z=
c(75),v=c(9),G=c(93),F=c(100),H=c(8),L=c(3),J=c(88),M=c(5),P=c(139),N=c(36),K=c(83),O=c(40),V=c(59),W=c(26),T=c(445),Y=c(1772);class ba extends Y.a{constructor(Z,ea,ha,la,ia,sa,Oa,Ra=null,Na=null){super(Z,Oa,Ra,Na);this._formatting=null;this.gLa=!1;this.gvb=null;this.cXb=-1;this.Nwb=0;this.pDc=new z.a;this.G9m=4294967295;r.a(4223754,307,O.OutlineElementReader.Bh(Z));this.mvb=ea;this.mvb.a3b(this);this.mM=ha;this.mM.a3b(this);this.mq=la;this.Jn=ia;this.$Me=G.ListItemReader.jg(this.zc);ba.tzm();ba.fzm();
ba.Qzm()}get kxa(){return null!=this.CBg?this.CBg:this.CBg=l.a.instance.Oa("Box4.IInternalLinkManager")}get VId(){return this._formatting}get Y4b(){return this.$Me&&!this.mM.aEa}get eDb(){return 0<this.Nwb}reset(){super.reset();this._formatting=this.Fof(!1)}M0e(Z){var ea;r.a(4223762,307,O.OutlineElementReader.Bh(this.zc)||K.OutlineReader.ix(this.zc));this.xfc(!1);var ha=new M.GraphIterator;ha.jd(this.zc);Z=Y.a.Yf.fJ(this.zc,this.qQc(Z));this.rCd(ha,!1);r.a(4223763,307,Z===this.zc.currentNode);r.a(4223764,
307,H.ParagraphReader.Wb(Z));-1!==this._formatting.ww&&ba.il.lE(Z,this._formatting.ww);if(ba.il.mq&&!this.wZ.ypj&&this._formatting.textIndent&&({unit:ia,returnValue:la}=ba.u9d(this._formatting.textIndent),ha=!1,la)){if(0>la){ha=!0;var la=-1*la}var ia=ba.Z9e(la,ia);ha?ba.il.mq.opb(Z,ia):ba.il.mq.Zda(Z,ia)}(ba.Pd.tg||J.a.instance.J(1)&&v.App.Gv.QRb)&&Z.setValue(y.a.XQa,!0);this._formatting.lineSpacing&&ba.il.jD(Z,this._formatting.lineSpacing);f.AFrameworkApplication.le("702j5362;7g13g664");this._formatting.cS&&
(null===(ea=f.AFrameworkApplication.K)||void 0===ea?0:ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(m.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),ba.il.ipb(Z,this._formatting.cS.afterSpacing),ba.il.jpb(Z,this._formatting.cS.beforeSpacing));if(this._formatting.kmc){ea=[];ha=[];ia=[];la=this._formatting.kmc.split(" ");let Oa=1,Ra=0;for(let Na=0;Na<la.length;Na++){var sa=
ba.C5k(la[Na]);const Da=ba.B5k(la[Na]);if(-1!==sa)Oa=sa;else if(-1!==Da)Ra=Da;else{const {unit:ra,returnValue:xa}=ba.u9d(la[Na]);sa=ba.Z9e(xa,ra);if(0<=sa&&sa<=this.G9m)ea.push(sa),ha.push(Oa),ia.push(Ra);else{r.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.kmc+" index: "+Na);break}Oa=1;Ra=0}}0<ea.length&&ba.il.iqk(Z,ea,ha,ia)}this._formatting.paragraph=Z;this.gLa=!0}rCd(Z,ea){r.a(8128518,307,!ea);this.aV&&(0<this.aV&&this.mq.SKc(Z,this.aV),0>this.aV&&this.mq.MSa(Z,this.aV,
0));Z&&this.Jn.pge(Z,this.eDb);this.aV=0}wbd(Z){this.pDc.add(Z)}a7e(){this.aV=0}wda(Z,ea=null){r.a(4223772,307,H.ParagraphReader.kh(this.zc));const ha=this.zc.currentNode;this._formatting.pmg(ha);if(!this.wZ.ymg(this.zc,ea,!1)){var la=ha.qa.last,ia=W.a.rw(ha);this.gLa&&(la.formatting=this._formatting.jR.yf(la),ha.Zl(),this.gLa=!1);Z=this.wZ.axf(Z,ea);this.wZ.y$(this.zc.currentNode,this._formatting.Dda,ea);this.ig.Ge(ia,Z,void 0,void 0,L.a.paste)}}vda(Z){this.wZ.u_d&&this.wZ.kZd(Z)?(this.tF(),this.fE(Z)):
(r.a(4223773,307,H.ParagraphReader.kh(this.zc)),Z=W.a.rw(this.zc.currentNode),this.ig.Uha(Z,ea=>new T.a(ea)))}snb(){this.wZ.gxf(this.zc)}hya(Z){if(ba.mql(Z)){const ea=this.zc.currentNode;H.ParagraphReader.Wb(ea)&&(ea.qhc=Z.Lif)}else this.mvb.hya(Z)}cHa(Z){this._formatting=Z;this.gLa=!0}kSa(Z){r.a(4223774,307,H.ParagraphReader.kh(this.zc));r.a(4223775,307,!this.gvb);r.a(4223776,307,0>this.cXb);this.gvb=Z;this.cXb=H.ParagraphReader.textLength(this.zc.currentNode)}jSa(){r.a(4223777,307,H.ParagraphReader.kh(this.zc));
r.a(4223778,307,!!this.gvb);r.a(4223779,307,0<=this.cXb);let Z=W.a.createTextRange(this.zc.currentNode,this.cXb,H.ParagraphReader.textLength(this.zc.currentNode)),ea="",ha="";this.kxa&&({d6f:ea,SEb:ha}=this.kxa.rmg(F.a.PPa(this.gvb))).returnValue&&(this.gvb=ea,ha&&(this.ig.Ge(Z,ha),Z=W.a.createTextRange(this.zc.currentNode,this.cXb,H.ParagraphReader.textLength(this.zc.currentNode))));ba.Sp.qG(Z,this.gvb,!1);this.gLa=!0;this.gvb=null;this.cXb=-1}fE(Z){this.M0e(Z);this._formatting.dme(this.zc.currentNode);
this.wZ.y$(this.zc.currentNode,this._formatting.Dda,Z,this._formatting.marginLeft,this._formatting.textIndent)}tF(){r.a(4223808,307,H.ParagraphReader.kh(this.zc));ba.Sp.Pul(this.zc.currentNode);N.OutlineElementNavigator.Wd(this.zc)}nnb(){}mnb(){}pSa(){}J5a(){}lya(){r.a(4223809,307,O.OutlineElementReader.Bh(this.zc)||K.OutlineReader.ix(this.zc));let Z=!1;this.eDb||(Z=this.Y4b||!0);Z||(this.aV+=1);this.Nwb++}jya(){this.Nwb--;let Z=!1;this.eDb||(Z=this.Y4b||!0,this.Jn.I9i(this.pDc));Z||--this.aV}hHa(Z){r.a(4223810,
307,O.OutlineElementReader.Bh(this.zc)||K.OutlineReader.ix(this.zc));r.a(4223811,307,!!Z.listStyleType);this.Jn.oge(this.YZm(Z))}kya(){r.a(4223813,307,O.OutlineElementReader.Bh(this.zc))}L5a(Z){this.mvb.L5a(Z)}R9(Z){this.mM.R9(Z)}P9(){this.mM.P9()}k5(Z){this.mM.k5(Z)}Q9(){this.mM.Q9()}O9(Z){this.mM.O9(Z)}N9(){this.mM.N9()}static get il(){return null!=ba.kEg?ba.kEg:ba.kEg=l.a.instance.resolve("Box4.IParagraphEditor")}static get Sp(){return null!=ba.Ezg?ba.Ezg:ba.Ezg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Pd(){return null!=
ba.uHg?ba.uHg:ba.uHg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get HIj(){return null!=ba.jIg?ba.jIg:ba.jIg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get emc(){return ba.wTe}static set emc(Z){ba.wTe=Z}static get vp(){return P.a.getInstance()}static tzm(){ba.X5a[1]=V.StyleReader.wordStyleIdHeading1;ba.X5a[2]=V.StyleReader.wordStyleIdHeading2;ba.X5a[3]=V.StyleReader.wordStyleIdHeading3;ba.X5a[4]=V.StyleReader.bTb;ba.X5a[5]=V.StyleReader.cTb;
ba.X5a[6]=V.StyleReader.dTb;ba.X5a[7]=null}static fzm(){ba.Pxa.unspecified=0;ba.Pxa.defaultUnordered=1;ba.Pxa.defaultOrdered=1;ba.Pxa.none=0;ba.Pxa.disc=1;ba.Pxa.circle=2;ba.Pxa.square=3;ba.Pxa.decimal=1;ba.Pxa.lowerAlpha=2;ba.Pxa.lowerRoman=3;ba.Pxa.upperAlpha=4;ba.Pxa.upperRoman=5}static Qzm(){ba.wTe=ba.HIj.yr()}static C5k(Z){let ea=-1;if(!Z)return ea;Z=Z.toLowerCase();switch(Z){case "left":ea=1;break;case "center":ea=3;break;case "right":ea=4;break;case "decimal":ea=6;break;case "bar":ea=7}return ea}static B5k(Z){let ea=
-1;if(!Z)return ea;Z=Z.toLowerCase();switch(Z){case "blank":ea=0;break;case "dotted":ea=1;break;case "dashed":ea=2;break;case "lined":ea=3}return ea}static rCb(Z){const ea=a.a.substring(Z,0,2),ha=a.a.substring(Z,2,4);return a.a.substring(Z,4,6)+ha+ea}static u9d(Z){let ea=0;const ha=Z.length;var la=a.a.substring(Z,0,ha-2);la=parseFloat(la);Z=a.a.substr(Z,ha-2,2);switch(Z){case "in":ea=3;break;case "px":ea=7;break;case "cm":ea=1;break;case "pt":ea=5;break;default:m.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",
Z),la=0}return{returnValue:la,unit:ea}}static Z9e(Z,ea){let ha=0;switch(ea){case 3:ha=k.a.Mv(Z);break;case 7:ha=x.a.Sy(Z,0);break;case 1:ha=k.a.d6e(Z);break;case 5:ha=k.a.Mv(k.a.T_f(Z));break;default:m.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",Z,ea)}return ha}static mql(Z){return!!Z&&!!Z.Lif&&""!==Z.Lif}}ba.X5a=Array(8);ba.Pxa={};ba.wTe=null;Object(D.a)(ba,"Box4PasteSteward",Y.a,[])},1557:function(D,I,c){D=c(0);var l=
c(2),f=c(2044),a=c(7);const k=(y,m)=>{const r={};let z=null;switch(y){case 0:z="HtmlProcessor";var v=m.a;null!=v&&(r.SessionID=v);var G=m.b.toString();null!=G&&(r.Elements=G);var F=m.c.toString();null!=F&&(r.PrunedElements=F);var H=m.d.toString();null!=H&&(r.TransparentElements=H);var L=m.e.toString();null!=L&&(r.VoidElements=L);var J=m.f.toString();null!=J&&(r.UnknownElements=J);break;case 1:z="WordConverter";var M=m.a;null!=M&&(r.SessionID=M);var P=m.b.toString();null!=P&&(r.BulletsConverted=P);
var N=m.c.toString();null!=N&&(r.NumberedConverted=N);break;case 2:z="FormattingSteward";var K=m.a;null!=K&&(r.SourceApp=K);var O=m.b;null!=O&&(r.Browser=O);var V=m.c;null!=V&&(r.OperationId=V);var W=m.d.toString();null!=W&&(r.Lang=W);var T=m.e.toString();null!=T&&(r.TextDir=T);var Y=m.f.toString();null!=Y&&(r.Bold=Y);var ba=m.g.toString();null!=ba&&(r.Math=ba);var Z=m.h.toString();null!=Z&&(r.Italics=Z);var ea=m.i.toString();null!=ea&&(r.Underline=ea);var ha=m.j.toString();null!=ha&&(r.Strikethrough=
ha);var la=m.k.toString();null!=la&&(r.Subscript=la);var ia=m.l.toString();null!=ia&&(r.Superscript=ia);var sa=m.m.toString();null!=sa&&(r.Fontsize=sa);var Oa=m.n.toString();null!=Oa&&(r.Fontface=Oa);var Ra=m.o.toString();null!=Ra&&(r.GrowFontsize=Ra);var Na=m.p.toString();null!=Na&&(r.ShrinkFontsize=Na);var Da=m.q.toString();null!=Da&&(r.FontColor=Da);var ra=m.r.toString();null!=ra&&(r.FontHighlight=ra);var xa=m.s.toString();null!=xa&&(r.ParagraphStyle=xa);var fa=m.t.toString();null!=fa&&(r.TextAlign=
fa);var oa=m.u.toString();null!=oa&&(r.TextIndent=oa);var ta=m.v.toString();null!=ta&&(r.MarginLeft=ta);var Ka=m.w.toString();null!=Ka&&(r.ParagraphSpaceBefore=Ka);var va=m.x.toString();null!=va&&(r.ParagraphSpaceAfter=va);var La=m.y.toString();null!=La&&(r.LineSpace=La);var za=m.z.toString();null!=za&&(r.CellShadingColor=za);var Ca=m.ba.toString();null!=Ca&&(r.StyleDefinition=Ca);var ua=m.bb.toString();null!=ua&&(r.TabStops=ua);break;case 3:z="SemanticEvents";var ib=m.a;null!=ib&&(r.SessionID=ib);
var bb=m.b.toString();null!=bb&&(r.Text=bb);var mb=m.c.toString();null!=mb&&(r.LineBreak=mb);var yb=m.d.toString();null!=yb&&(r.Image=yb);var ab=m.e.toString();null!=ab&&(r.File=ab);var Ga=m.f.toString();null!=Ga&&(r.FormattingChange=Ga);var Za=m.g.toString();null!=Za&&(r.Anchor=Za);var Ub=m.h.toString();null!=Ub&&(r.Paragraph=Ub);var Xb=m.i.toString();null!=Xb&&(r.Math=Xb);var zb=m.j.toString();null!=zb&&(r.List=zb);var Ib=m.k.toString();null!=Ib&&(r.ListItem=Ib);var $a=m.l.toString();null!=$a&&
(r.RenderAugmentation=$a);var Hb=m.m.toString();null!=Hb&&(r.Span=Hb);break;case 4:z="SemanticTableEvents";var Ya=m.a;null!=Ya&&(r.SessionID=Ya);var Sa=m.b.toString();null!=Sa&&(r.Tables=Sa);var Eb=m.c.toString();null!=Eb&&(r.TableRow=Eb);var Jb=m.d.toString();null!=Jb&&(r.TableCell=Jb);var vb=m.e.toString();null!=vb&&(r.TablePart=vb);break;case 5:z="HtmlEvents";var ac=m.a;null!=ac&&(r.OperationId=ac);var dc=m.b;null!=dc&&(r.SourceApp=dc);var Cc=m.c;null!=Cc&&(r.Browser=Cc);var Ec=null==m.d?null:
m.d.toString();null!=Ec&&(r.Text=Ec);var rc=null==m.e?null:m.e.toString();null!=rc&&(r.A=rc);var hb=null==m.f?null:m.f.toString();null!=hb&&(r.Abbr=hb);var fb=null==m.g?null:m.g.toString();null!=fb&&(r.Acronym=fb);var Nb=null==m.h?null:m.h.toString();null!=Nb&&(r.Address=Nb);var Fb=null==m.i?null:m.i.toString();null!=Fb&&(r.Applet=Fb);var nb=null==m.j?null:m.j.toString();null!=nb&&(r.Area=nb);var pb=null==m.k?null:m.k.toString();null!=pb&&(r.B=pb);var Xa=null==m.l?null:m.l.toString();null!=Xa&&(r.Base=
Xa);var Pb=null==m.m?null:m.m.toString();null!=Pb&&(r.Basefont=Pb);var Va=null==m.n?null:m.n.toString();null!=Va&&(r.Bdo=Va);var tb=null==m.o?null:m.o.toString();null!=tb&&(r.Big=tb);var cb=null==m.p?null:m.p.toString();null!=cb&&(r.Blockquote=cb);var Mb=null==m.q?null:m.q.toString();null!=Mb&&(r.Body=Mb);var mc=null==m.r?null:m.r.toString();null!=mc&&(r.Br=mc);var Cb=null==m.s?null:m.s.toString();null!=Cb&&(r.Button=Cb);var Ja=null==m.t?null:m.t.toString();null!=Ja&&(r.Caption=Ja);var Wa=null==m.u?
null:m.u.toString();null!=Wa&&(r.Center=Wa);var xb=null==m.v?null:m.v.toString();null!=xb&&(r.Cite=xb);var ic=null==m.w?null:m.w.toString();null!=ic&&(r.Code=ic);var qc=null==m.x?null:m.x.toString();null!=qc&&(r.Col=qc);var Lc=null==m.y?null:m.y.toString();null!=Lc&&(r.Colgroup=Lc);var Ac=null==m.z?null:m.z.toString();null!=Ac&&(r.Dd=Ac);var gd=null==m.ba?null:m.ba.toString();null!=gd&&(r.Del=gd);var Md=null==m.bb?null:m.bb.toString();null!=Md&&(r.Dfn=Md);var ie=null==m.bc?null:m.bc.toString();null!=
ie&&(r.Dir=ie);var hf=null==m.bd?null:m.bd.toString();null!=hf&&(r.Div=hf);var Ue=null==m.be?null:m.be.toString();null!=Ue&&(r.Dl=Ue);var Kd=null==m.bf?null:m.bf.toString();null!=Kd&&(r.Dt=Kd);var Wc=null==m.bg?null:m.bg.toString();null!=Wc&&(r.Em=Wc);var Zc=null==m.bh?null:m.bh.toString();null!=Zc&&(r.Fieldset=Zc);var Nc=null==m.bi?null:m.bi.toString();null!=Nc&&(r.Font=Nc);var ge=null==m.bj?null:m.bj.toString();null!=ge&&(r.Form=ge);var $d=null==m.bk?null:m.bk.toString();null!=$d&&(r.Frame=$d);
var te=null==m.bl?null:m.bl.toString();null!=te&&(r.Frameset=te);var Se=null==m.bm?null:m.bm.toString();null!=Se&&(r.H=Se);var tc=null==m.bn?null:m.bn.toString();null!=tc&&(r.Head=tc);var dd=null==m.bo?null:m.bo.toString();null!=dd&&(r.Hr=dd);var Ed=null==m.bp?null:m.bp.toString();null!=Ed&&(r.Html=Ed);var Qd=null==m.bq?null:m.bq.toString();null!=Qd&&(r.I=Qd);var Ad=null==m.br?null:m.br.toString();null!=Ad&&(r.Iframe=Ad);var Oe=null==m.bs?null:m.bs.toString();null!=Oe&&(r.Img=Oe);var pf=null==m.bt?
null:m.bt.toString();null!=pf&&(r.Input=pf);var Fh=null==m.bu?null:m.bu.toString();null!=Fh&&(r.Ins=Fh);var Ig=null==m.bv?null:m.bv.toString();null!=Ig&&(r.Isindex=Ig);var Jh=null==m.bw?null:m.bw.toString();null!=Jh&&(r.Kbd=Jh);var xg=null==m.bx?null:m.bx.toString();null!=xg&&(r.Label=xg);var bc=null==m.by?null:m.by.toString();null!=bc&&(r.Legend=bc);var Bc=null==m.bz?null:m.bz.toString();null!=Bc&&(r.Li=Bc);var ad=null==m.ca?null:m.ca.toString();null!=ad&&(r.Link=ad);var zd=null==m.cb?null:m.cb.toString();
null!=zd&&(r.Map=zd);var Xd=null==m.cc?null:m.cc.toString();null!=Xd&&(r.Math=Xd);var Gd=null==m.cd?null:m.cd.toString();null!=Gd&&(r.Menu=Gd);var Ze=null==m.ce?null:m.ce.toString();null!=Ze&&(r.Meta=Ze);var Fe=null==m.cf?null:m.cf.toString();null!=Fe&&(r.Noframes=Fe);var bf=null==m.cg?null:m.cg.toString();null!=bf&&(r.Noscript=bf);var ag=null==m.ch?null:m.ch.toString();null!=ag&&(r.Object=ag);var Xf=null==m.ci?null:m.ci.toString();null!=Xf&&(r.Ol=Xf);var vf=null==m.cj?null:m.cj.toString();null!=
vf&&(r.Optgroup=vf);var Bg=null==m.ck?null:m.ck.toString();null!=Bg&&(r.Option=Bg);var ob=null==m.cl?null:m.cl.toString();null!=ob&&(r.P=ob);var $b=null==m.cm?null:m.cm.toString();null!=$b&&(r.Param=$b);var Uc=null==m.cn?null:m.cn.toString();null!=Uc&&(r.Pre=Uc);var Pd=null==m.co?null:m.co.toString();null!=Pd&&(r.Q=Pd);var ze=null==m.cp?null:m.cp.toString();null!=ze&&(r.S=ze);var Me=null==m.cq?null:m.cq.toString();null!=Me&&(r.Samp=Me);var af=null==m.cr?null:m.cr.toString();null!=af&&(r.Script=af);
var Hg=null==m.cs?null:m.cs.toString();null!=Hg&&(r.Select=Hg);var wi=null==m.ct?null:m.ct.toString();null!=wi&&(r.Small=wi);var Wi=null==m.cu?null:m.cu.toString();null!=Wi&&(r.Span=Wi);var Mf=null==m.cv?null:m.cv.toString();null!=Mf&&(r.Strike=Mf);var Zg=null==m.cw?null:m.cw.toString();null!=Zg&&(r.Strong=Zg);var zf=null==m.cx?null:m.cx.toString();null!=zf&&(r.Style=zf);var ii=null==m.cy?null:m.cy.toString();null!=ii&&(r.Sub=ii);var Af=null==m.cz?null:m.cz.toString();null!=Af&&(r.Sup=Af);var jg=
null==m.da?null:m.da.toString();null!=jg&&(r.Tables=jg);var Rf=null==m.db?null:m.db.toString();null!=Rf&&(r.Tbody=Rf);var lj=null==m.dc?null:m.dc.toString();null!=lj&&(r.Td=lj);var Qh=null==m.dd?null:m.dd.toString();null!=Qh&&(r.Textarea=Qh);var ei=null==m.de?null:m.de.toString();null!=ei&&(r.Tfoot=ei);var cl=null==m.df?null:m.df.toString();null!=cl&&(r.Th=cl);var ul=null==m.dg?null:m.dg.toString();null!=ul&&(r.Thead=ul);var qi=null==m.dh?null:m.dh.toString();null!=qi&&(r.Title=qi);var Jg=null==m.di?
null:m.di.toString();null!=Jg&&(r.Tr=Jg);var xi=null==m.dj?null:m.dj.toString();null!=xi&&(r.Tt=xi);var Fj=null==m.dk?null:m.dk.toString();null!=Fj&&(r.U=Fj);var km=null==m.dl?null:m.dl.toString();null!=km&&(r.Ul=km);var hg=null==m.dm?null:m.dm.toString();null!=hg&&(r.Var=hg);var Wg=null==m.dn?null:m.dn.toString();null!=Wg&&(r.Unknown=Wg);break;case 6:z="List";var ej=m.a;null!=ej&&(r.SessionID=ej);var tm=m.b.toString();null!=tm&&(r.MaxListLevel=tm)}r.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(r)};
c.d(I,"a",function(){return x});class x{static get npa(){null==x.Jvb&&(x.Jvb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.Jvb}static get syi(){null==x.wFe&&(x.wFe=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return x.wFe}static P0(y){a.ULS.sendTraceTag(524038472,307,50,y)}static K9h(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;return m}static l3m(y){x.npa||x.P0(k(0,y))}static d5h(y){const m=
{};m._sessionID=y;return m}static Tii(y){const m={};m.a=y;m.b=0;m.c=0;return m}static b6m(y){x.npa||x.P0(k(1,y))}static J9h(y,m){const r={};r.c=f.a[y];r.a=m;return r}static k3m(y,m){x.syi&&y&&(y.b=m,x.P0(k(5,y)))}static xfi(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;m.m=0;return m}static V4m(y){x.npa||x.P0(k(3,y))}static yfi(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;return m}static W4m(y){x.npa||x.P0(k(4,y))}static Hpf(y,m){const r={};r.b=f.a[y];r.c=m;
r.d=0;r.e=0;r.f=0;r.g=0;r.h=0;r.i=0;r.j=0;r.k=0;r.l=0;r.m=0;r.n=0;r.o=0;r.p=0;r.q=0;r.r=0;r.s=0;r.t=0;r.w=0;r.x=0;r.y=0;r.z=0;r.u=0;r.v=0;r.ba=0;r.bb=0;return r}static V2m(y,m){x.syi&&y&&(y.a=m,x.P0(k(2,y)))}static D1l(y){const m={};m.a=y;m.b=-1;return m}static K3m(y){!x.npa&&y&&0<=y.b&&x.P0(k(6,y))}}x.Jvb=null;x.wFe=null;Object(D.a)(x,"UsageEditor",null,[])},1566:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(2),f=c(5);class a{static get Gqb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static rib(k,
x=!1){const y=f.GraphIterator.eb(k);y.rd();return(x?y.Ub(4):y.Nha(4))?4:f.GraphIterator.eb(k).zb(36)?16:f.GraphIterator.eb(k).zb(14)?2:f.GraphIterator.eb(k).zb(38)?32:1}}Object(D.a)(a,"ConstructTypeHelper",null,[])},1582:function(D,I,c){c.d(I,"a",function(){return Ra});D=c(0);var l=c(22),f=c(55),a=c(124),k=c(2);I=c(85);var x=c(6),y=c(16),m=c(7),r=c(110),z=c(69),v=c(715),G=c(189),F=c(32),H=c(5),L=c(206),J=c(83),M=c(27),P=c(77),N=c(21),K=c(334),O=c(1522),V=c(213),W=c(260),T=c(713),Y=c(12),ba=c(43),
Z=c(36),ea=c(116),ha=c(40),la=c(272),ia=c(144),sa=c(568),Oa=c(42);class Ra{static get Ftm(){return Ra.i4j}static get Otm(){return Ra.m4j}static get Mtm(){return Ra.l4j}static get Xg(){return null!=Ra.lwg?Ra.lwg:Ra.lwg=V.ContextSetEditor.instance}static get Gk(){return null!=Ra.lGg?Ra.lGg:Ra.lGg=l.a.instance.resolve("Box4.ITableEditor")}static get kD(){return null!=Ra.eGg?Ra.eGg:Ra.eGg=l.a.instance.Oa("Box4.Styles.ITableCellspacingReader")}static zGn(Na,Da){const ra=Na.currentNode;N.forEachCell(Na,
Da.rowSpan,Da.colSpan,(xa,fa,oa)=>{const ta=xa.currentNode;ta!==ra&&(ta.fg=!0,Ra.AQh(xa),!oa&&1<=Da.colSpan&&(ta.colSpan=Da.colSpan),Ra.Vjj(xa,Da.cka,fa,oa,Da.rowSpan,Da.colSpan))})}static iHn(Na,Da){N.forEachCell(Na,Da.rowSpan,Da.colSpan,ra=>{Ra.ZDk(ra);Ra.AQh(ra)})}static ZDk(Na){Na=Na.currentNode;Na.fg=!0;Na.Q4=!0;Na.Qpb=!0}static AQh(Na){Na&&(Na.Ub(1),Object(r.a)(v.a,Na.currentNode)&&Na.vg())}static PEk(Na,Da,ra){0<Da&&(Na=Object(z.a)(G.TableCellNode,Na.currentNode))&&(Na.width=ra?Da:f.a.Kl(Da,
0))}static aDk(Na,Da,ra){if(Na=Object(z.a)(K.TableNode,Na.currentNode))0<Da&&(Na.$d=f.a.Sy(Da,0)),0<ra&&(Na.uu=f.a.Sy(ra,0))}static NEk(Na,Da){void 0!==Da&&null!==Da&&Na.currentNode.properties.setValue(x.a.OIa,Ra.Otm[Da+""])}static YDk(Na,Da){void 0!==Da&&null!==Da&&""!==Da&&(Da=parseInt(O.Box4PasteSteward.rCb(Da),16),Na.currentNode.properties.setValue(y.a.QK,Da))}static xyk(Na){if(Na){if(m.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(Oa.a)("AdjustingColumnWidthAfterPaste",
!0),16==Na.type){var Da=new H.GraphIterator;Da.set(Na);if(Da.zb(14)){var ra=P.a(Da),xa=M.TableCellReader.cP(Na);if(Da.ld(14)){Na=Da.currentNode;var fa=F.TableReader.uha(Da);if(fa){var oa=Array.clone(fa);Da=F.TableReader.aSd(Da);var ta=0,Ka=0;for(var va=0;va<fa.length;va++)va>=ra&&va<ra+xa?Da[va]>fa[va]&&(ta+=Da[va]-fa[va],oa[va]=Da[va]):Ka+=fa[va]>Da[va]?fa[va]-Da[va]:0;(null==Ka||0>=Ka||isNaN(Ka))&&m.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==ta||0>=ta||isNaN(ta))&&
m.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(Ka<ta)for(ra=0;ra<fa.length;ra++)oa[ra]=Da[ra];else for(va=0;va<fa.length;va++)if((va<ra||va>=ra+xa)&&fa[va]>Da[va]){const La=(fa[va]-Da[va])/Ka;oa[va]-=La*ta;(null==oa[va]||0>=oa[va]||isNaN(oa[va]))&&m.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",La)}ra=ia.a.nea+(Ra.kD?Ra.kD.Gwa(Na):0);for(fa=0;fa<oa.length;fa++)if(null==oa[fa]||0>=oa[fa]||isNaN(oa[fa]))m.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),
oa[fa]=f.a.Kl(ra,0);Na.mG=oa}else m.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else m.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static vhm(Na){var Da=new H.GraphIterator;Da.jd(Na);if((Na=L.OutlineNavigator.E9f(Da))&&J.OutlineReader.ix(Da)){Da=Na.rf(x.a.Go);const ra=Na.rf(x.a.marginLeft);Na=Na.rf(x.a.marginRight);return Da-ra-Na}return 0}static UQm(Na){return!(void 0===Na||null===Na||1===Na)}static mkc(Na,Da,ra,xa,fa){if(void 0===Da||null===Da||
""!==Da){switch(Da){case "thin":Da=a.a.c$d(.25);break;case "initial":case "medium":Da=a.a.c$d(.5);break;case "thick":Da=a.a.c$d(1);break;default:Da=Ra.ddm(Da,ra,xa)}fa.currentNode.properties.setValue(Na,Da)}}static lkc(Na,Da,ra){void 0!==Da&&null!==Da&&Da&&ra.currentNode.properties.setValue(Na,Ra.Mtm[Da+""])}static beo(Na,Da,ra){void 0!==Da&&null!==Da&&""!==Da&&(Da=parseInt(O.Box4PasteSteward.rCb(Da),16),ra.currentNode.properties.setValue(Na,Da))}static ddm(Na,Da,ra){let xa=0;const fa=({unit:Na}=
O.Box4PasteSteward.u9d(Na)).returnValue;switch(Na){case 5:xa=a.a.c$d(fa);break;case 1:xa=a.a.OSk(fa);break;case 3:xa=a.a.kpi(fa);break;case 7:xa=f.a.VAn(fa,ra)}if(6===Da||7===Da||10===Da)xa/=3;return Math.round(xa)}static edm(Na,Da){let ra=0;const xa=({unit:Na}=O.Box4PasteSteward.u9d(Na)).returnValue;switch(Na){case 5:ra=a.a.Cya(xa);break;case 1:ra=a.a.c6e(xa);break;case 3:ra=a.a.bxa(xa);break;case 7:ra=f.a.Kl(xa,Da)}return ra}static xfe(Na,Da,ra,xa,fa,oa,ta){if(fa&&(!ta||16===fa.Ue||ta||14!==fa.Ue)&&
12!==ra){if(ta)switch(xa){case 5:xa=x.a.Eza;var Ka=x.a.Ya;var va=x.a.Xa;var La=0;break;case 4:xa=x.a.Dza;Ka=x.a.tb;va=x.a.rb;La=1;break;case 0:xa=x.a.Bza;Ka=x.a.Wa;va=x.a.Va;La=0;break;case 3:xa=x.a.Cza;Ka=x.a.qb;va=x.a.pb;La=1;break;default:return}else switch(xa){case 5:xa=x.a.mRb;Ka=x.a.zqb;va=x.a.qmc;La=0;break;case 4:xa=x.a.lRb;Ka=x.a.yqb;va=x.a.pmc;La=1;break;case 0:xa=x.a.jRb;Ka=x.a.wqb;va=x.a.nmc;La=0;break;case 3:xa=x.a.kRb;Ka=x.a.xqb;va=x.a.omc;La=1;break;default:return}void 0!==fa.currentNode&&
null!==fa.currentNode&&(Ra.UQm(ra)?(Ra.beo(xa,Na,fa),Ra.lkc(Ka,ra,fa),Ra.mkc(va,Da,ra,La,fa)):oa||ta||fa.currentNode.properties.setValue(Ka,"nil"))}}static Vjj(Na,Da,ra,xa,fa,oa){xa||(Ra.bth(Da,Na,!1,!1),Ra.m1e(Da,Na,!0,!1));xa===oa-1&&Ra.m1e(Da,Na,!0,!1);ra||Ra.Cth(Da,Na,!0,!1);ra===fa-1&&Ra.Jsh(Da,Na,!0,!1)}static Ish(Na,Da,ra,xa){Na&&(Ra.Cth(Na,Da,ra,xa),Ra.m1e(Na,Da,ra,xa),Ra.Jsh(Na,Da,ra,xa),Ra.bth(Na,Da,ra,xa))}static Cth(Na,Da,ra,xa){Ra.xfe(Na.borderTopColor,Na.borderTopWidth,Na.borderTopStyle,
5,Da,ra,xa)}static m1e(Na,Da,ra,xa){Ra.xfe(Na.borderRightColor,Na.borderRightWidth,Na.borderRightStyle,4,Da,ra,xa)}static Jsh(Na,Da,ra,xa){Ra.xfe(Na.borderBottomColor,Na.borderBottomWidth,Na.borderBottomStyle,0,Da,ra,xa)}static bth(Na,Da,ra,xa){Ra.xfe(Na.borderLeftColor,Na.borderLeftWidth,Na.borderLeftStyle,3,Da,ra,xa)}static yfe(Na,Da,ra){if(ra&&16===ra.Ue&&""!==Na){switch(Da){case 3:Da=x.a.CUa;var xa=0;break;case 2:Da=x.a.xV;xa=1;break;case 0:Da=x.a.BUa;xa=0;break;case 1:Da=x.a.kS;xa=1;break;default:return}(Na=
Ra.edm(Na,xa))&&ra.currentNode.properties.setValue(Da,Na)}}static vCk(Na,Da){Da&&(Ra.GEk(Da,Na),Ra.RDk(Da,Na),Ra.CCk(Da,Na),Ra.kDk(Da,Na))}static GEk(Na,Da){Ra.yfe(Na.ISk,3,Da)}static RDk(Na,Da){Ra.yfe(Na.HSk,2,Da)}static CCk(Na,Da){Ra.yfe(Na.FSk,0,Da)}static kDk(Na,Da){Ra.yfe(Na.GSk,1,Da)}static HCk(Na,Da,ra,xa){var fa=0;const oa=Array(Na.length);var ta=0;xa&&(ta=(ta=a.a.acd(Ra.vhm(Da)))?ta:1);for(xa=0;xa<Na.length;xa++)oa[xa]=0<ta?ta/100*Na[xa]:f.a.Kl(Na[xa],0),fa+=oa[xa];Na=ra.getValue(y.a.Vz);
xa=new H.GraphIterator;xa.jd(Da);Da=0;if(M.TableCellReader.F0(xa)){if(Na=N.returnToContainingCell(xa))Da=Na.width;ta=P.a(xa);xa=N.returnToContainingTable(xa);if(-1!==ta&&ta<=xa.mG.length){let Ka=0;for(let va=ta;va<ta+Na.colSpan&&va<xa.mG.length;va++)Ka+=xa.mG[va];Da=Math.min(Da,Ka);Da===Ka&&(Da-=f.a.Kl(Ra.Udn,0))}}else if(Na)for(ta=0;ta<Na.length;ta++)Da+=Na[ta];if(0<Da&&fa>Da&&fa)for(fa=Da/fa,Da=0;Da<oa.length;Da++)oa[Da]*=fa;ra.setValue(y.a.Vz,oa)}static SDk(Na,Da){Na.currentNode.setValue(x.a.G1,
f.a.Kl(Da,1))}static Tko(Na){var Da,ra;m.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Oa.a)("SettingTableSelectionBounds",!0);var xa=Na.hb,fa=Na.ng;Na=Ra.Xg.lR(fa,16);if(fa=Ra.Xg.HT(fa,14))if(fa=fa.node,!fa||14!==fa.type)m.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Na)m.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(ra=null===(Da=null===xa||void 0===xa?void 0:xa.lb)||void 0===Da?void 0:Da.Ke)||void 0===
ra?0:ra.Pa)&&xa.lb.Ke.Pa.contextId===Y.a.E1&&W.TableBorderSelectionCache.SPa()&&0<W.TableBorderSelectionCache.SPa().length)){W.TableBorderSelectionCache.$Tc(fa);Da=W.TableBorderSelectionCache.q$;Da.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;Da.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;Da.topMostRowSelected=Number.MAX_SAFE_INTEGER;Da.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(ra=0;ra<Na.length;ra++){if(Na.getContext(ra).contextId!==Y.a.Ew)return;xa=Na.getContext(ra).node;if(!M.TableCellReader.Xr(xa)){var oa=
new H.GraphIterator;oa.set(xa);if(oa.zb(14)&&N.getContainingTable(oa)===fa){oa.ld(14);oa=M.TableCellReader.SEa(oa,xa);if(!oa)return;Array.add(W.TableBorderSelectionCache.SPa(),new T.a(xa,oa.rowIndex,oa.Bo,xa.rowSpan,xa.colSpan));Da.leftMostColumnSelected=Math.min(Da.leftMostColumnSelected,oa.Bo);Da.rightMostColumnSelected=Math.max(Da.rightMostColumnSelected,oa.Bo);Da.topMostRowSelected=Math.min(Da.topMostRowSelected,oa.rowIndex);Da.bottomMostRowSelected=Math.max(Da.bottomMostRowSelected,oa.rowIndex)}}}W.TableBorderSelectionCache.q$=
Da}}else m.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static Dfj(Na){var Da;if(Na&&14===Na.type){m.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(Oa.a)("ScalingColumnWidthForCCP",!0);var ra=new H.GraphIterator;ra.set(Na);if(ra.rd()&&F.TableReader.hx(ra)){var xa=Na.mG,fa=F.TableReader.aSd(ra),oa=N.returnToContainingCell(ra),ta=N.getContainingTable(ra);if(oa&&ta){var Ka=P.a(ra),va=M.TableCellReader.cP(oa);if(ra.ld(14)){var La=F.TableReader.uha(ra);ra=0;for(let za=
Ka;za<Ka+va;za++)ra+=La[za];Ka=ia.a.LM(oa,ta,x.a.kS,x.a.Aa,0);oa=ia.a.LM(oa,ta,x.a.xV,x.a.Ba,0);ra-=f.a.Kl(Ka+oa,0);(null==ra||0>=ra||isNaN(ra))&&m.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",Ka,oa);oa=0;for(ta=0;ta<xa.length;ta++)oa+=xa[ta];ta=ra/oa;(null==ta||0>=ta||isNaN(ta))&&m.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");Ka=0;for(va=0;va<xa.length;va++)La=xa[va],xa[va]*=ta,xa[va]<fa[va]&&(xa[va]=fa[va],1>ta&&(null===(Da=k.AFrameworkApplication.K)||
void 0===Da?0:Da.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(ta=(ra-fa[va])/(oa-La))),Ka+=xa[va];Ka>ra&&(xa=Array.clone(fa));Da=ia.a.nea+(Ra.kD?Ra.kD.Gwa(Na):0);for(fa=0;fa<xa.length;fa++)if(null==xa[fa]||0>=xa[fa]||isNaN(xa[fa]))m.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),xa[fa]=f.a.Kl(Da,0);Da=new ba.GraphTransaction(4);Da.Db(Na);Na.mG=xa;Da.dispose()}}}else m.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else m.ULS.sendTraceTag(524932511,
3022,15,"Table node should not be null")}static K1n(Na){if(!Na||!F.TableReader.aHf(Na)||1!=Na.Qp())return m.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;m.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Oa.a)("ReplaceTableContentForExternalPaste",!0);let Da=new H.GraphIterator;Da.set(Na.currentNode);Da.zb(14);Z.OutlineElementNavigator.Ce(Da);const ra=new H.GraphIterator;ra.set(Na.currentNode);ra.zb(14);if(!ra.ld(14)||!Da||
14!=Da.currentNode.type)return null;if(Na=N.getContainingTableCell(Da))if(Na=M.TableCellReader.SEa(ra,Na)){if(W.TableBorderSelectionCache.yRc())var xa=this.qbm();else{xa=F.TableReader.eg(Da.currentNode)-(F.TableReader.eg(ra.currentNode)-Na.rowIndex);var fa=F.TableReader.eh(Da.currentNode)-(F.TableReader.eh(ra.currentNode)-Na.Bo);this.Wsk(ra,xa,fa);xa=new la.a(Na.Bo,F.TableReader.eh(ra.currentNode)-1,Na.rowIndex,F.TableReader.eg(ra.currentNode)-1)}if(!xa)return null;fa=xa.bottomMostRowSelected-xa.topMostRowSelected+
1;var oa=xa.rightMostColumnSelected-xa.leftMostColumnSelected+1;fa=Math.min(fa,F.TableReader.eg(Da.currentNode));oa=Math.min(oa,F.TableReader.eh(Da.currentNode));for(let ta=0;ta<fa;ta++){N.moveToCell(ra,ta+xa.topMostRowSelected,xa.leftMostColumnSelected);N.moveToCell(Da,ta,0);for(let Ka=0;Ka<oa;Ka++)ta==Na.rowIndex-xa.topMostRowSelected&&Ka==Na.Bo-xa.leftMostColumnSelected||this.sOi(Da,ra),N.moveToNextColumn(ra),N.moveToNextColumn(Da);ra.ot(14);Da.ot(14)}N.moveToCell(ra,Na.rowIndex,Na.Bo);Na.rowIndex-
xa.topMostRowSelected<F.TableReader.eg(Da.currentNode)&&Na.Bo-xa.leftMostColumnSelected<F.TableReader.eh(Da.currentNode)?N.moveToCell(Da,Na.rowIndex-xa.topMostRowSelected,Na.Bo-xa.leftMostColumnSelected):Da=null;this.sOi(Da,ra);ra.ot(14);N.moveToCell(ra,xa.topMostRowSelected,xa.leftMostColumnSelected);ra.Qd();return ra.currentNode}}static ozn(Na){if(Na&&F.TableReader.aHf(Na)&&1==Na.Qp()){m.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Oa.a)("PasteTableBelowTable",!0);var Da=
new H.GraphIterator;Da.set(Na.currentNode);Na=ea.a.eb(Na.currentNode);Da.gp()&&Na.gp()&&(Z.OutlineElementNavigator.X0(Na,!1,!0),ha.OutlineElementReader.Bh(Na)&&1==Na.Qp()&&(Z.OutlineElementNavigator.Ce(Da),Z.OutlineElementNavigator.Ce(Na),Da&&Na&&Da.currentNode!=Na.currentNode&&F.TableReader.isTable(Da)&&F.TableReader.isTable(Na)&&this.zan(Da,Na)&&(m.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),Da.vg(),Da.vg())))}else m.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static sOi(Na,
Da){if(Da&&M.TableCellReader.isTableCell(Da)){var ra=Da.Qp();if(Na&&M.TableCellReader.isTableCell(Na)&&Na.Gz())for(;Na.Gz();)Na.Qd(),Da.xf(Na.currentNode,Na.role),Na.vg();else ra--;for(;0<ra--;)Da.Qd(),Da.vg()}}static zan(Na,Da){if(!F.TableReader.isTable(Na)||!F.TableReader.isTable(Da))return!1;var ra=F.TableReader.eh(Na.currentNode),xa=F.TableReader.eh(Da.currentNode);if(ra!=xa)return m.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;ra=F.TableReader.eg(Na.currentNode);
xa=F.TableReader.eg(Da.currentNode);const fa=new ba.GraphTransaction(4);fa.Db(Da.currentNode);Da.currentNode.setValue(y.a.Gza,ra+xa);for(fa.dispose();Na.Gz();){Na.Qd();Da.xf(Na.currentNode,1);ra=new H.GraphIterator;ra.set(Na.currentNode);Na.vg();ra.Qd();do ra.currentNode&&16==ra.currentNode.type&&(ra.currentNode.YE=Da.currentNode);while(ra.Gt())}return!0}static Wsk(Na,Da,ra){m.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Oa.a)("AddRowAndColumnForExternalCCP",
!0);Ra.jBa=sa.a.D9b;0<Da&&(N.moveToLastRow(Na),m.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+Da),this.Gk.insertRows(Na,!1,Da,this.jBa),m.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Na.ld(14));0<ra&&(m.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+ra),this.Gk.insertColumns(Na,F.TableReader.eh(Na.currentNode),!1,ra,this.jBa),m.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static qbm(){return W.TableBorderSelectionCache?W.TableBorderSelectionCache.q$:
null}}Ra.Udn=8;Ra.ifn="Normal Table";Ra.fPh="Table Grid";Ra.jBa=null;Ra.i4j=I.a.Z5("MsoNormalTable","Normal Table","MsoTableGrid",Ra.fPh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2",
"MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5",
"MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2",
"MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5",
"MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");Ra.m4j=I.a.Z5("0","center","1","top","2","center","3","bottom");Ra.l4j=I.a.Z5("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(D.a)(Ra,"Box4TableStewardHelper",null,[])},1588:function(D,I,c){c.d(I,"a",function(){return V});D=c(0);var l=c(75),f=c(190),a=c(22),k=c(170),x=c(2),y=c(241),m=c(6),r=c(81),z=c(61),v=c(9),G=c(43),F=c(443),H=c(213),L=c(236),J=c(8),M=c(251),
P=c(18),N=c(12),K=c(282),O=c(3);class V{static get Xg(){return H.ContextSetEditor.instance}static get Uf(){return L.a.instance}static get Hc(){return f.a.instance}static fx(){return V.Zm||(V.Zm=a.a.instance.Ta("Box4.IExternalSelectionManager"))}static get RA(){return null!=V.mEg?V.mEg:V.mEg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static Qfm(){this.kO||(this.kO=new l.a,this.kO.add(O.a.WA),this.kO.add(O.a.font),this.kO.add(O.a.cZ),this.kO.add(O.a.Vua),this.kO.add(O.a.bold),this.kO.add(O.a.Wy),
this.kO.add(O.a.superscript),this.kO.add(O.a.subscript),this.kO.add(O.a.L_a),this.kO.add(O.a.Sua),this.kO.add(O.a.pDa),this.kO.add(O.a.f6e),this.kO.add(O.a.qDa),this.kO.add(O.a.K_a),this.kO.add(O.a.m0),this.kO.add(O.a.z1),this.kO.add(O.a.JC),this.kO.add(O.a.yfb),this.kO.add(O.a.WHc));return this.kO}static Ibc(W){return V.Qfm().contains(W)?!0:!1}static jw(W,T,Y,ba,Z){var ea=!0;if(!T.view.qe)return 2;var ha=T.view,la=ha.mb;la&&la.hb.lb||(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.noSelection}),ea=!1);V.Xg.IDa(P.ImageReader.$Vc,
ha.mb.ng)&&(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.l9e}),ea=!1);if(V.Xg.IDa(P.ImageReader.B3a,ha.mb.ng))return V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.UIc}),8;var ia=!V.Ibc(W);V.Uf.Mbc(ha.mb.ng,ia)&&(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.ZE}),ea=!1);V.Xg.IDa(P.ImageReader.fZd,ha.mb.ng)&&(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.g9e}),ea=!1);V.Xg.IDa(K.c,ha.mb.ng)&&(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.h9e}),ea=!1);V.Xg.IDa(M.a.LDf,ha.mb.ng)&&(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.f9e}),ea=!1);V.Xg.hAa(J.ParagraphReader.AU,ha.mb.ng)&&(V.Hc.Yb(r.a.Ye,
{["Reason"]:z.a.yO}),ea=!1);V.fx()&&V.fx().instance&&V.fx().instance.EU(ha.mb.ng)&&(V.Hc.Yb(r.a.Ye,{["Reason"]:z.a.o1a}),ea=!1);var sa=null;la&&la.hb.lb&&(sa=la.hb.lb);if(1===Y||!ea||!sa)return ea?32:8;ea=W===O.a.qec||W===O.a.Y3b||W===O.a.rjc||W===O.a.r8b;ha=W===O.a.ANb||W===O.a.qDb||W===O.a.Gic;ia=W===O.a.WTa||W===O.a.XTa||W===O.a.jD;const Oa=new G.GraphTransaction(15);Oa.Db(sa.Pa.node);sa=new l.a;let Ra=!1;if(ea||ha||ia)k.a.mark(7121),T=V.Xg.i2h(T.ek);else{k.a.mark(7119);T=F.OutlineElementGeneralizer.nha(la.hb,
!0);if(!T)return V.Hc.Yb(r.a.Zna,{["Reason"]:z.a.WMd}),Oa.dispose(),8;la=W===O.a.j3a||W===O.a.Rjb;T.gx&&la&&(Ra=V.jqm(sa,T))}(W===O.a.y9||W===O.a.qec||W===O.a.Aba||W===O.a.Y3b||W===O.a.o$||W===O.a.rjc||W===O.a.NEa||W===O.a.r8b)&&T.gx&&1<T.length&&V.kqm(T)&&(Z||(Z={}),Object.getType(Z)===Object&&(Z.InContextSet=!0));x.AFrameworkApplication.va.Kf(T,W,Y,!0,ba,Z);Ra&&V.ofn(sa,T,Z);Oa.dispose();v.App.za.updateCommandUI();ea||ha||ia?k.a.mark(7122):k.a.mark(7120);return 32}static jqm(W,T){if(!T.gx)return!1;
let Y=!1,ba=!1;for(let ea=0;ea<T.length;ea++)if(T.getContext(ea).Vk){var Z=T.getContext(ea).node;Z&&(Z=V.RA.Hib(Z),2===Z.specialIndentType?(Y=!0,W.add(ea)):1!==Z.specialIndentType&&Z.specialIndentType||(ba=!0))}return ba&&Y}static ofn(W,T,Y){if(T.gx)for(let Z=0;Z<W.count;Z++){var ba=T.getContext(W.J(Z));if(!ba.Vk)continue;ba=ba.node;const ea=V.RA.Hib(ba);2!==ea.specialIndentType||y.a.pxa(Y.value,ea.KB)||ba.setValue(m.a.$d,ea.KB-ea.hea)}}static Eeg(W,T){let Y=!0;T.contextId!==N.a.paragraph?Y=!1:V.Uf.m4a(T)?
(V.Hc.Yb(r.a.rn,{["Reason"]:z.a.ZE}),Y=!1):V.fx()&&V.fx().instance&&V.fx().instance.EU(T)?(V.Hc.Yb(r.a.rn,{["Reason"]:z.a.o1a}),Y=!1):T.Vk&&(T=T.node,J.ParagraphReader.Wb(T)&&T.UQ&&(V.Hc.Yb(r.a.rn,{["Reason"]:z.a.yO}),Y=!1));return{returnValue:1!==W&&Y,xy:Y?32:8}}static kqm(W){if(!W.gx)return!1;let T=1;for(let ba=0;ba<W.length;ba++){var Y=W.getContext(ba);if(Y&&Y.Vk&&Y.contextId===N.a.paragraph&&(Y=Y.node))if(Y=J.ParagraphReader.Kx(Y),!ba)T=Y;else if(Y!==T)return!0}return!1}}V.Zm=null;V.kO=null;Object(D.a)(V,
"FormattingActionHelper",null,[])},1591:function(D,I,c){c.d(I,"a",function(){return f});c.d(I,"b",function(){return a});var l=c(2);const f=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=
()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1604:function(D,I,c){c.r(I);D=c(0);var l=c(2),f=c(127),a=c(22),k=c(55),x=c(354),y=c(43),m=c(5);class r{fdf(Va,tb,cb){return 1===cb?32:r.Ril(tb.node)}static Ril(Va){const tb=new m.GraphIterator;tb.set(Va);tb.gp();Va=new y.GraphTransaction(7);Va.Qt(tb);tb.vg();Va.dispose();return 32}}Object(D.a)(r,"DeleteOutlineLevelContentStrategy",null,
[]);var z=c(155),v=c(174),G=c(79),F=c(213),H=c(17),L=c(23),J=c(8),M=c(103),P=c(36),N=c(206),K=c(83),O=c(26);class V{constructor(Va){this.Lm=null;this.uma=Va}get PAb(){return null!=this.Qug?this.Qug:this.Qug=a.a.instance.Oa("Box4.IAutoCorrectRules")}get hX(){return null!=this.Sug?this.Sug:this.Sug=a.a.instance.Oa("Box4.IAutoCorrectScheduler")}get eN(){return null!=this.RDg?this.RDg:this.RDg=a.a.instance.Oa("Box4.Pages.IPageContentEditor")}get xL(){return null!=this.oDg?this.oDg:this.oDg=a.a.instance.Oa("Box4.IOutlineEditor")}get Qg(){return this.Lm||
(this.Lm=this.uma())}mFi(Va,tb,cb){if(this.xL&&V.Xn){var Mb=F.ContextSetEditor.Aqf(tb);Va=Mb.node;H.SelectionEditor.Fk(Mb)&&(Mb=O.a.Oc(Va,J.ParagraphReader.textLength(Va)));var mc=M.FormattingReader.language(M.FormattingReader.Vr(Mb));Mb=m.GraphIterator.eb(cb.ed);V.ai.W6c(Mb);var Cb=Va=null;if(Mb)for(let Ja=Mb.Ub(1);Ja&&!Cb;Ja=Mb.Ni(1))K.OutlineReader.Axa(Ja)&&(Cb=Ja);if(Mb&&!Cb){if(!this.eN||!this.xL)return;Va=new y.GraphTransaction(7);Va.Qt(Mb);Cb=this.eN.uId(Mb);this.xL.P7(Mb,!0);mc&&(P.OutlineElementNavigator.Ce(Mb),
Mb=O.a.Oc(Mb.currentNode,0),V.Xn.jge(M.FormattingReader.Vr(Mb),mc))}mc=L.SelectionFactory.oo(Cb,!0);cb.mb.Bc(mc);H.SelectionEditor.ef(tb)&&(cb=m.GraphIterator.eb(tb.node),cb.gp(),N.OutlineNavigator.E9f(cb),this.PAb&&this.hX&&K.OutlineReader.JA(cb,tb,!0)&&(tb=this.PAb.Bjf(tb,-1,!1,G.a.Fw))&&this.hX.Pfj(tb));this.Qg&&this.Qg.nF();Va&&Va.dispose()}}static get Xn(){return null!=V.Wyg?V.Wyg:V.Wyg=a.a.instance.Oa("Box4.IFormattingEditor")}static get instance(){return null!=V.ABg?V.ABg:V.ABg=V.Wl()}static Wl(){return new V(()=>
a.a.instance.Oa("Box4.IUndoManager"))}static get ai(){return v.PageNavigator.instance}}Object(D.a)(V,"TitleViewEditor",null,[]);var W=c(48),T=c(471),Y=c(641),ba=c(21),Z=c(12),ea=c(282),ha=c(3);class la{constructor(){this.KZj=new r;this.fdf=(Va,tb,cb,Mb,mc)=>this.KZj.fdf(Va,tb,cb,Mb,mc)}Tb(Va){const tb=this.bQh.odf.bind(this.bQh),cb=this.fdf,Mb=this.RPh.Wil.bind(this.RPh);this.x5f(Va,tb,cb,Mb);Va.ra(ha.a.backspace,Z.a.Tc,Mb);Va.ra(ha.a.backspace,Z.a.Jd,Mb);Va.ra(ha.a.backspace,Z.a.Uc,f.ActionManager.cR);
Va.ra(ha.a.backspace,Z.a.outline,cb);Va.ra(ha.a.backspace,Z.a.view,tb);Va.Xc(ha.a.backspace,1124);Va.ra(ha.a.Hva,Z.a.Tc,f.ActionManager.cR);Va.ra(ha.a.Hva,Z.a.Jd,Mb);Va.ra(ha.a.Hva,Z.a.Uc,f.ActionManager.cR);Va.ra(ha.a.Hva,Z.a.outline,cb);Va.ra(ha.a.Hva,Z.a.view,tb);Va.fb(ha.a.QId,Z.a.view,tb,1124);Va.ra(ha.a.HH,Z.a.Tc,Mb);Va.ra(ha.a.HH,Z.a.Jd,Mb);Va.ra(ha.a.HH,Z.a.Uc,f.ActionManager.cR);Va.ra(ha.a.HH,Z.a.outline,cb);Va.ra(ha.a.HH,Z.a.view,tb);Va.Xc(ha.a.HH,1124);Va.fb(ha.a.Cbf,Z.a.view,tb,1124);
Va.fb(ha.a.Cna,Z.a.view,la.Cna,1028)}x5f(){}static get ai(){return v.PageNavigator.instance}static get Yf(){return null!=la.rDg?la.rDg:la.rDg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get eN(){return null!=la.ODg?la.ODg:la.ODg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get xL(){return null!=la.nDg?la.nDg:la.nDg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Zb(){return null!=la.cyg?la.cyg:la.cyg=a.a.instance.Oa("Box4.IFeatureHelper")}static Cna(Va,tb,cb,Mb,
mc){Mb=tb.view;if(!Mb.mb||!Mb.mb.hb.lb||H.SelectionEditor.Il(Mb.mb.hb.lb))return 8;if(1===cb)return 32;cb=Mb.mb.hb;const Cb=cb.lb;var Ja=Cb.Pa,Wa=null,xb=!1;if(cb.HJ){if(Ja.contextId===Z.a.outline&&1===cb.length){for(Va=m.GraphIterator.eb(Ja.node);Va.Qd();)Va.vg();la.xL.P7(Va,!0);P.OutlineElementNavigator.Ce(Va);Va=L.SelectionFactory.ne(Va.currentNode,0);Mb.mb.Bc(Va);return 32}var ic=Ja.node;Wa=null;if(ea.c(Ja)){var qc=ic.pe(Mb.$b);qc&&(qc=qc.qnp)&&0<=qc.width&&0<=qc.height&&(Wa=new T.a(k.a.Kl(qc.x,
0),k.a.Kl(qc.y,1)));Wa||(Wa=Y.a(ic))}else Wa=Y.a(Ja.node);Ja=m.GraphIterator.eb(Ja.node);Ja.gp();la.ai.W6c(Ja);ic=la.eN.uId(Ja);Y.b(ic,Wa.x,Wa.y);la.xL.P7(Ja,!0);Wa=L.SelectionFactory.oo(ic,!0)}else if(1===cb.length){xb=cb.last;Ja=W.a.ICb(xb);if(la.Zb&&la.Zb.isFeatureEnabled(26)&&F.ContextSetEditor.instance.ygg(Ja).returnValue)return 2;xb=xb.Rc;xb=!cb.Ov&&(H.SelectionEditor.Fk(xb)||J.ParagraphReader.nm(xb)||H.SelectionEditor.l9(xb))}xb&&(xb=H.SelectionEditor.Fj(Cb,!1,!1,void 0,!1),Mb.mb.Bc(xb),l.AFrameworkApplication.va.Kf(tb,
ha.a.newLine,2,!1,null,mc),Wa=Mb.mb.hb.lb,Mb.mb.Bc(Cb));mc||(mc=new x.DictionaryPropertySet);mc.setValue(z.a.zLc,!0);l.AFrameworkApplication.va.Kf(tb,ha.a.HH,2,!0,null,mc);if(Wa&&Wa.Pa.isValid)return Mb.mb.Bc(Wa),32;cb.HJ&&V.instance.mFi(Va,tb.ek,Mb);H.SelectionEditor.Il(Mb.mb.hb.lb)||l.AFrameworkApplication.va.Kf(tb,ha.a.newLine,2,!1,null,mc);return 32}static Qil(Va,tb){if(1===tb)return 32;tb=new y.GraphTransaction(7);tb.Db(Va);la.Yf.Vya(Va);tb.dispose();return 32}}Object(D.a)(la,"ADeleteActor",
null,[]);var ia=c(9),sa=c(236),Oa=c(259),Ra=c(1518),Na=c(60),Da=c(19),ra=c(110),xa=c(69),fa=c(117),oa=c(699),ta=c(57);class Ka{get Uf(){return sa.a.instance}Wil(Va,tb,cb,Mb,mc){Mb=null===mc||void 0===mc?void 0:mc.Vcd;if(1===cb)return 32;var Cb=Va===ha.a.backspace;if(this.Uf.fh){if(this.Uf.dxi(tb)&&Ka.Fga&&(cb=tb.clone(),cb.Sb+=1,--cb.Fb,this.Uf.vdc(cb)))return Ka.Fga.y8i([cb]),32;if(this.Uf.REf(tb,Cb))return 2}if(Ka.fx()&&Ka.fx().instance&&Ka.fx().instance.EU(tb))return 4;var Ja=tb.node;let Wa=tb.cpBegin;
cb=tb.cpEnd;let xb=tb.Fb,ic=tb.Sb;const qc=J.ParagraphReader.text(Ja),Lc=qc.length;let Ac=!1;if(Wa===cb){if(Cb&&!Wa||!Cb&&Wa===Lc)return 2;Cb?({cp:Wa,returnValue:Ac}=this.Uf.qOi(Ja,Wa),Ac||({cp:Wa,Zma:xb,returnValue:Ac}=this.Uf.pOi(tb,Wa,xb)),Ac||(Wa--,Da.a.Jz(qc,Wa)&&Wa--),Va=ha.a.F2e):({cp:cb,returnValue:Ac}=this.Uf.Ecn(Ja,cb),Ac||({cp:cb,Zma:ic,returnValue:Ac}=this.Uf.Dcn(tb,cb,ic)),Ac||(cb++,Da.a.Jz(qc,cb)&&cb++),Va=ha.a.zPh)}tb=Wa===cb?O.a.Oc(Ja,Wa):O.a.createTextRange(Ja,Wa,cb);Ac&&this.Uf.fh&&
(Cb?tb.Fb=xb:tb.Sb=ic);if(!this.Uf.vdc(tb))return 2;this.w1b(Ja);Cb=new y.GraphTransaction(15);Cb.Qj=Va;Cb.Db(Ja);Ja=Object(ra.a)(oa.a,mc)&&mc.C1a;if(!Ka.Pd.tg||Ja||ta.a.sr&&Ka.nDa.S_d(W.a.instance.hb.lb))this.SPh(tb,Mb);else{Ja=Ka.Pd.p_a();try{const gd=Ka.Dh.B$c(tb);let Md;if(({type:Md}=gd.gUd()).returnValue){const ie=Object(xa.a)(85,mc);ie&&ie.ja(fa.a.$Cf,!1)||!ta.a.sr&&4===Md?Ka.Pd.c6a=Md:Ka.Pd.Us(Md)}mc=0;for(let ie=gd.length-1;0<=ie;--ie){let hf;const Ue=({x0d:hf}=gd.getContext(ie)).returnValue;
hf?(Ka.Sp.Imb(Ue,null),mc+=Ka.Bj.Epb(Ue,2),Ka.Bj.UHd=cb+mc):this.SPh(Ue,Mb)}}finally{Ja&&Ja.dispose()}}Cb.dispose();return 32}w1b(){}static get Pd(){return null!=Ka.dHg?Ka.dHg:Ka.dHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Bj(){return null!=Ka.QGg?Ka.QGg:Ka.QGg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Dh(){return null!=Ka.yHg?Ka.yHg:Ka.yHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Sp(){return null!=
Ka.Fzg?Ka.Fzg:Ka.Fzg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static fx(){return Ka.Zm||(Ka.Zm=a.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Fga(){Ka.Jub||(Ka.Jub=a.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return Ka.Jub.instance}static get nDa(){return null!=Ka.hvg?Ka.hvg:Ka.hvg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}Ka.Zm=null;Ka.Jub=null;Object(D.a)(Ka,"ADeleteParagraphContentStrategy",null,[]);var va=c(169),La=c(813),za=c(158),
Ca=c(227),ua=c(78),ib=c(75),bb=c(82);class mb extends Ka{constructor(){super()}get ig(){return null!=this.ovg?this.ovg:this.ovg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Vq(){return null!=this.evg?this.evg:this.evg=a.a.instance.Ta("Box4.ContentControlConfigSettings")}get rfc(){return null!=this.aDg?this.aDg:this.aDg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get sX(){return null!=this.Pvg?this.Pvg:this.Pvg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get dca(){return null!=
this.pyg?this.pyg:this.pyg=a.a.instance.resolve("Box4.IFieldEditor")}SPh(Va,tb){this.fil(Va,tb)}Myk(Va,tb,cb,Mb){this.Vq.instance&&this.Vq.instance.fh&&(Va.cpBegin===tb.cpBegin?Va.Fb=tb.Fb:cb&&(Va.Fb=cb.Jb&&cb.Jb.length?0:-1),Va.Sb=Mb)}w1b(Va){const {DeleteActor:tb}=c(1604);tb.w1b(Va)}fil(Va,tb){var cb=Va.node;const Mb=Ca.b([new va.a(Va.cpBegin,Va.cpEnd)],this.$gm(Va));var mc=new bb.a,Cb=[];mb.DZk(cb,Mb,mc,Cb);for(const Ja of mc.keys)1<mc.J(Ja)&&La.a.QRi(Na.a.Ff(Ja));this.rXn(cb,Cb);this.rfc.YHc(cb);
cb=Va.Sb;mc=!!this.Vq.instance&&this.Vq.instance.fh;for(Cb=Mb.length-1;0<=Cb;Cb--)cb=this.deleteRange(Va,Mb[Cb],cb,mc,tb)}$gm(Va){const tb=[],cb=Va.node;var Mb=ua.f(cb,Ja=>Ja.Yma);for(var mc of Mb)Mb=mc.Kb.cp,tb.push(new va.a(Mb,Mb+1));mc=[];za.a.aL?this.dca&&(mc=this.dca.npf(cb,Va)):mc=J.ParagraphReader.EPa(cb);for(var Cb of mc)this.GOm(Cb,Va)&&tb.push(Cb);Cb=!!this.Vq.instance&&this.Vq.instance.ipa;this.Vq.instance&&this.Vq.instance.fh||!Cb||!cb.Gs||(mb.EHh&&mb.EHh.pWn(Va),this.sX&&tb.push(...this.sX.cof(cb).toArray()));
return Ca.a(tb)}GOm(Va,tb){return za.a.aL?this.dca?!this.dca.tvi(Va,tb):!1:!Va.ZK||!mb.FDf(Va,tb)}rXn(Va,tb){const cb=new ib.a;for(const Mb of tb)for(tb=0;tb<Mb.length;){tb=this.f$h(Mb,tb,0);if(-1===tb)break;let mc=this.f$h(Mb,tb+1,3);if(-1===mc)break;if(Mb.J(tb).ZK)for(;mc>=tb;){const Cb=Mb.J(mc);cb.add(Cb.oe);Mb.remove(Cb);mc--}tb=mc+1}Va.Mqa(cb)}f$h(Va,tb,cb){for(;tb<Va.length;tb++){const Mb=Va.J(tb);if(1===Mb.WB&&Mb.Mf===cb)return tb}return-1}deleteRange(Va,tb,cb,Mb,mc){const Cb=tb.Ac,Ja=tb.end;
tb=null;Mb&&(tb=Va.node.qa.zh(Cb));Cb<Ja&&(Mb=O.a.createTextRange(Va.node,Cb,Ja),this.Myk(Mb,Va,tb,cb),this.ig.Ge(Mb,"",void 0,void 0,ha.a.tGc,!1,mc));return cb=tb&&tb.Jb&&tb.Jb.length?tb.Jb.length:-1}static get EHh(){return null!=mb.Yvg?mb.Yvg:mb.Yvg=a.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator")}static FDf(Va,tb){return Va.Ac>=tb.cpBegin&&Va.end<=tb.cpEnd}static DZk(Va,tb,cb,Mb){let mc=0;Va=Va.qa;for(const Cb of tb)for(;mc<Va.length;){tb=Va.J(mc);if(tb.cp>=Cb.Ac&&tb.cp<Cb.end&&
(tb.Vc&&tb.Vc.m3k&&Mb.push(tb.Vc),tb.Fh))for(let Ja=0;Ja<tb.Fh.length;Ja++){const Wa=tb.Fh.J(Ja).un.toString();cb.nb(Wa)?cb.Z(Wa,cb.J(Wa)+1):cb.Z(Wa,1)}++mc}}}Object(D.a)(mb,"DeleteParagraphContentStrategy",Ka,[]);class yb{static get aH(){return Oa.a.instance}static rjl(Va,tb,cb){if(1===cb)return 32;Va=tb.node;return yb.aH.ZDd(Va)?la.Qil(Va,cb):32}}Object(D.a)(yb,"DeleteUnsupportedObjectStrategy",null,[]);var ab=c(170),Ga=c(309),Za=c(190),Ub=c(373),Xb=c(7),zb=c(1045),Ib=c(871),$a=c(40),Hb=c(116),
Ya=c(401),Sa=c(531),Eb=c(1628),Jb=c(139),vb=c(443),ac=c(849),dc=c(166),Cc=c(138),Ec=c(204),rc=c(508),hb=c(32),fb=c(122);class Nb{constructor(Va,tb,cb,Mb,mc){this.F0o=Va;this.n$=cb;this.Ad=Mb;this.actionId=tb;this.Vcd=mc}}Object(D.a)(Nb,"DeleteActionData",null,[]);var Fb=c(1026);class nb{constructor(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb,ic){this.TPh=Va;this.Uf=tb;this.aH=cb;this.Sp=Mb;this.q0=mc;this.aj=Cb;this.NZi=Ja;this.ig=Wa;this.Pd=xb;this.nDa=ic}cKo(Va){return!H.SelectionEditor.nl(Va)&&!H.SelectionEditor.Nca(Va)}Hbm(Va,
tb,cb){var Mb;let mc,Cb,Ja;if(!tb&&Va&&Va.Vw&&(Mb=Va.Pa)&&H.SelectionEditor.ef(Mb)&&this.aj.Wb(Mb.node)&&(mc=Mb.node.qa.zh(Mb.cpBegin))&&mc.Wm&&(Cb=this.nPl(mc))&&Cb.hyperlink.JG&&(Ja=this.vbm(Va,Cb.cp)))return Ja;if(!Va)return null;if(ta.a.Sj&&(Mb=this.XNo(Va,tb)))return Mb;if(!cb)return Va;tb=H.SelectionEditor.FEa(Va,!tb,{SA:!1,Hs:!0,RC:!0,oE:!0});return L.SelectionFactory.Dy(Va,tb.Pa,!1)}nPl(Va){const tb=Va.paragraph.qa;let cb=null;Va=Va.cp;for(let Mb=0;Mb<tb.length;Mb++){const mc=tb.J(Mb);if(mc.cp>=
Va)break;mc.Wm&&(cb=null);mc.hyperlink&&(cb=mc)}return cb}ybm(Va,tb){var cb=Va.Pa.node;if(tb){if(tb=H.SelectionEditor.iUa(Va.Pa.node,Va.Pa.cpBegin,!0),Va=L.SelectionFactory.Dy(Va,O.a.Oc(Va.Pa.node,tb),!1),cb=cb.qa.zh(tb),cb.A0||cb.BU)Va.Pa.Fb=0}else if(tb=H.SelectionEditor.iUa(Va.Pa.node,Va.Pa.cpBegin,!1),Va=L.SelectionFactory.Dy(Va,O.a.Oc(Va.Pa.node,tb),!1),cb=cb.qa.zh(tb),cb.A0||cb.BU)Va.Pa.Fb=cb.Dw+cb.uN;Va.kcc=!0;return Va}XNo(Va,tb){var cb=Va.Pa;let Mb=null;if(!Va.Vw||!cb||!H.SelectionEditor.ef(cb))return null;
if(this.aj.Wb(cb.node)&&(Mb=tb?cb.node.qa.zh(cb.cpBegin):cb.node.qa.Aib(cb.cpBegin-1))&&Mb.JR)return this.ybm(Va,tb);cb=m.GraphIterator.eb(Va.Pa.node);if(!cb.zb(8))return null;P.OutlineElementNavigator.Wd(cb);let mc=!1;const Cb=[];if(tb?Mb&&Mb.Oh:0===Va.Pa.cpBegin){do(Va=tb?P.OutlineElementNavigator.$r(cb,!0,!0,!1):P.OutlineElementNavigator.X0(cb,!0,!0,!1))&&(null===Va||void 0===Va?0:Va.rQa)?(Cb.push(O.a.create(P.OutlineElementNavigator.Ce(cb))),P.OutlineElementNavigator.Wd(cb)):mc=!0;while(!mc);
if(0<Cb.length)return tb=new dc.Selection(tb?Cb:Cb.reverse(),tb),tb.kcc=!0,tb}return null}vbm(Va,tb){var cb=H.SelectionEditor.GEa(Va,{SA:!1,Hs:!1,RC:!0,oE:!0});if(!cb||!cb.Vw||cb.Pa.node!==Va.Pa.node)return null;cb=cb.Pa;if(cb.cpBegin!==cb.cpEnd)return null;const Mb=this.aj.text(cb.node);for(let mc=cb.cpBegin-1;mc>=tb;mc--)if(!Da.a.Pv(Mb.charCodeAt(mc)))return L.SelectionFactory.Dy(Va,O.a.Oc(cb.node,mc+1),!1);return L.SelectionFactory.Dy(Va,O.a.Oc(cb.node,tb),!1)}odf(Va,tb,cb,Mb,mc){var Cb,Ja;if(1===
cb)return 32;(cb=null===(Ja=null===(Cb=tb.view)||void 0===Cb?void 0:Cb.mb)||void 0===Ja?void 0:Ja.ng)&&F.ContextSetEditor.instance.rOh(cb).filter(J.ParagraphReader.AU).forEach(Wa=>{var xb;return null===(xb=J.ParagraphReader.HPa(Wa.node))||void 0===xb?void 0:xb.Zge("delete_selection")});Ja=!1;Va===ha.a.Cbf?(Va=ha.a.HH,Ja=!0):Va===ha.a.QId?(Va=ha.a.backspace,Ja=!0):Va===ha.a.Hva&&(tb=new Sa.a(ia.App.za.jb.qc));if(!tb.view.qe)return 2;Cc.GrippersManager.instance.hC(!1);Cb=Va===ha.a.HH;cb=Ec.a.D8h(tb);
if(Ja&&this.Uf.fh&&cb&&H.SelectionEditor.Il(cb)&&this.Uf.REf(cb.Pa,!Cb,!0))return 2;Ja=this.Hbm(cb,Cb,Ja);return this.tjl(Va,tb,Mb,mc,Ja,Cb)}tjl(Va,tb,cb,Mb,mc,Cb){var Ja;const Wa=tb.view,xb=Wa.mb;var ic=Mb,qc=Mb;Va===ha.a.Hva&&(qc=ic=null,mc=new dc.Selection(Mb,!0));if(!mc)return 32;const Lc=this.gpo(ic,Cb);if(this.Uf.fh&&nb.Fga&&1===xb.hb.length&&H.SelectionEditor.Il(mc)&&mc.Vw&&nb.Fga.H$n(mc.Pa,Cb)||za.a.aL&&nb.dca&&1===xb.hb.length&&H.SelectionEditor.Il(mc)&&mc.Vw&&nb.dca.I$n(mc.Pa,Cb))return 32;
let Ac;Cb?ab.a.mark(Ac=5009):ab.a.mark(Ac=5011);ic=new y.GraphTransaction(15);ic.Qj=Va;ic.Db(Wa.ed);let gd=null,Md=({l9n:gd}=this.lRl(Va,Mb,xb,mc,gd)).returnValue;var ie=null;({Gie:ie}=F.ContextSetEditor.instance.ygg(Md)).returnValue&&(Md=ie);if(!Md)return ic.dispose(),32;ie=!1;l.AFrameworkApplication.le("b1jb9393;09icj321");if(null===(Ja=l.AFrameworkApplication.K)||void 0===Ja?0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))Ja=Md.node,ie=null===Ja||void 0===
Ja?void 0:Ja.Gs;const hf=new Nb(tb,Va,cb,qc,ie);this.Uf.fh&&nb.Fga&&(qc=F.ContextSetEditor.instance.tO(Md),nb.Fga.y8i(qc));this.mzj(Md);const Ue=this.gPd(Md,mc,Cb);let Kd=null;Cb?Kd=new ac.a(mc):Ue&&(Kd=new ac.a(Ue));let Wc=!1;qc=nb.Ck;if(H.SelectionEditor.ef(Md)){const Zc=Fb.a.H9b(Wa.ed,Lc);qc.ge(()=>{this.ail(tb,cb,Mb,Md,Cb,Kd,mc,Zc,xb,Lc,hf,Ue)},"DVS:DAIPC")}else!this.Pd.tg||ta.a.sr&&this.nDa.S_d(mc)?qc.ge(()=>{Wc=this.d0i(Va,Wa.ed,Md,xb,Lc,hf,Kd,gd)},"DVS:PUD"):(qc.ge(()=>{this.bKo(Va,Wa.ed,Md,
Cb,mc,xb,Lc,hf,Kd)},"DVS:TCDC"),Wc=!0);this.VDl(xb);this.zcj(Md);ic.dispose();ab.a.mark(Ac+1);return Va===ha.a.Hva?Wc?32:8:32}d0i(Va,tb,cb,Mb,mc,Cb,Ja,Wa){tb=Fb.a.H9b(tb,mc);this.cKo(cb)&&tb.z8a(cb);Va=nb.Hc.Ap(Va);Va.properties.Z("CountOfParagraphsDeleted",this.aj.l$e(cb).toString());cb=this.Enl(cb,Mb,mc,tb,Cb,Ja,Wa);Va.end();return cb}bKo(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb){var ic=0,qc=null;const Lc=F.ContextSetEditor.instance.tO(cb),Ac=Lc[Lc.length-1];if(Ac.contextId===Z.a.paragraph||Ac.contextId===Z.a.Uc){var gd=
m.GraphIterator.eb(Ac.node);gd.rd();P.OutlineElementNavigator.Wd(gd);P.OutlineElementNavigator.$r(gd,!0,!1)&&(qc=P.OutlineElementNavigator.Ce(gd))&&(ic=this.aj.textLength(qc))}else ic=this.aj.textLength(Ac.node)-Ac.cpEnd;gd=Object(xa.a)(85,Wa.Ad);if(gd=!!gd&&gd.ja(fa.a.$Cf,!1))this.b0i(Va,tb,cb,Cb,Ja,Wa,xb,!1,gd);else{gd=this.Pd.p_a();try{this.b0i(Va,tb,cb,Cb,Ja,Wa,xb,!0)}finally{gd&&gd.dispose()}}if(ta.a.Sj&&mc.kcc)ic=this.gPd(cb,mc,Mb),this.aj.Wb(ic.Pa.node)&&W.a.instance.Bc(ic);else{if(Mb){if(cb.gx){Va=
Lc.length-1;do mc=Lc[Va],Va--;while(!mc.node.isConnected&&0<=Va)}else mc=cb;if(!this.aj.Wb(mc.node))return;switch(Ac.contextId){case Z.a.paragraph:case Z.a.Uc:ic=qc&&qc.isConnected?0:ic;break;case Z.a.Tc:case Z.a.Jd:break;default:ic=0}ic=L.SelectionFactory.ne(mc.node,this.aj.textLength(mc.node)-ic);mc.Ij===ic.Pa.cpBegin&&(ic.Pa.Fb=mc.Fb)}else{ic=mc.Pa.node;if(!this.aj.Wb(ic))return;qc=mc.Pa.contextId===Z.a.paragraph?0:mc.Pa.contextId===Z.a.Uc?this.aj.textLength(ic):mc.Pa.cpBegin;ic=L.SelectionFactory.ne(ic,
qc)}W.a.instance.Bc(ic)}}b0i(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb=!1){cb=this.qIl(Mb,cb);cb=nb.Dh.B$c(cb);({type:qc}=cb.gUd()).returnValue&&(Wa&&4!==qc?this.Pd.Us(qc):ta.a.sr||(this.Pd.c6a=qc));for(Wa=cb.length-1;0<=Wa;--Wa){var ic=void 0;var qc=({x0d:ic}=cb.getContext(Wa)).returnValue;ic?(ic=xb&&qc.contextId===Z.a.Uc&&Wa===cb.length-1,this.Sp.Imb(qc,2),ic||nb.Bj.Epb(qc,2)):this.d0i(Va,tb,qc,Mb,mc,Cb,Ja,null)}}qIl(Va,tb){if(Object(ra.a)(Ya.a,tb)){Va=vb.OutlineElementGeneralizer.nha(Va.hb,!0);for(let cb=0;cb<
Va.length;cb++)if(Va.getContext(cb).contextId===Z.a.table)return Va}return tb}lRl(Va,tb,cb,Mb,mc){Va===ha.a.Hva?(Va=Ga.a.TDa(tb),mc=rc.SelectionReferenceFactory.instance.NCb()):(mc=null,Va=1===cb.hb.length?W.a.ICb(Mb):cb.ng);return{returnValue:Va,l9n:mc}}SQk(Va){return!Va.Vk||Va.contextId!==Z.a.paragraph||!this.aj.Wb(Va.node)||this.Pd.tg||this.Uf.s_d(Va)?!1:!0}mzj(Va){if(Va.gx)for(let tb=0;tb<Va.length;tb++)this.mzj(Va.getContext(tb));else this.SQk(Va)&&(Va.node.$Dd=!0)}zcj(Va){if(Va.gx)for(let tb=
0;tb<Va.length;tb++)this.zcj(Va.getContext(tb));else Va.Vk&&(Va=Va.node)&&this.aj.Wb(Va)&&(Va.$Dd=!1)}gPd(Va,tb,cb){if(Va.Vk&&H.SelectionEditor.ef(Va)&&!cb){const Mb=Va.node;let mc=Va.cpBegin,Cb=-1;if(({cp:mc}=this.Uf.qOi(Mb,mc)).returnValue)return L.SelectionFactory.ne(Mb,mc);if(({cp:mc,Zma:Cb}=this.Uf.pOi(Va,mc,Cb)).returnValue)return tb=L.SelectionFactory.ne(Mb,mc),tb.Pa.Fb=Cb,tb.Pa.Sb=Cb,tb}tb=ta.a.Sj?H.SelectionEditor.FEa(tb,!cb,{SA:!tb.kcc||tb.Vw,Hs:!1,RC:!1,oE:!0,Tua:H.SelectionEditor.Il(tb)}):
H.SelectionEditor.FEa(tb,!cb,{SA:!0,Hs:!1,RC:!1,oE:!0});this.Uf.fh&&H.SelectionEditor.nl(Va)&&(tb.Pa.Sb=tb.Pa.Fb=cb?Va.Sb:Va.Fb);return tb}ail(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb,ic,qc,Lc){const Ac=nb.Ck;!H.SelectionEditor.JA(Mb.node,Mb,mc)||this.Uf.fh&&this.Uf.dxi(Mb)?Ac.ge(()=>{this.Hil(Mb,mc,Cb,Ja,Wa,xb,ic,qc)},"DVS:IPM"):Ac.ge(()=>{const {response:gd,eZ:Md}=this.Gil(Va,tb,cb,Mb,mc,Ja,Wa,xb,qc,Lc);nb.mQi(Wa,32===gd);Md&&nb.Rqa(xb,Cb)},"DVS:ISE")}knm(Va,tb){Jb.a.wY&&(tb.Ad||(tb.Ad=new x.DictionaryPropertySet),
tb.Ad.setValue(fa.a.Qpa,"delete"),tb.Ad.setValue(fa.a.uia,"backspace"));var cb=Va.bJ;const Mb=nb.Fd.UX(cb),mc=Eb.a.LXm;if(null===mc||void 0===mc?0:mc.NQm(cb,Mb)){Jb.a.wY&&tb.Ad.setValue(fa.a.uia,"backspace-autocorrect");cb=mc.Xzj+" ";const Cb=O.a.Oc(Va,0);this.ig.Ge(Cb,cb);Va=L.SelectionFactory.ne(Va,cb.length);W.a.instance.Bc(Va);Xb.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",mc.Xzj)}return l.AFrameworkApplication.va.Kf(tb.F0o,Mb.Kz?ha.a.JL:ha.a.oD,2,!1,tb.n$,tb.Ad)}Imm(Va,
tb,cb,Mb,mc){let Cb=!1;0<this.NZi.t4(Va).Ut&&(mc=l.AFrameworkApplication.va.Kf(tb,ha.a.Gic,2,!1,cb,Mb),Cb=!0);return{tU:Cb,response:mc}}Pmm(Va,tb,cb,Mb,mc){let Cb=!1;0<this.NZi.DG(Va).Ut&&(mc=l.AFrameworkApplication.va.Kf(tb,ha.a.O5c,2,!1,cb,Mb),Cb=!0);return{tU:Cb,response:mc}}Vnm(Va,tb,cb,Mb,mc){let Cb=!1;nb.mq.ABb(Va)&&(mc=l.AFrameworkApplication.va.Kf(tb,ha.a.SG,2,!1,cb,Mb),Cb=!0);return{tU:Cb,response:mc}}qlm(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb,ic){const qc=new Hb.a;qc.jd(tb);let Lc=!1;if(P.OutlineElementNavigator.QGa(qc,
!1,!Va,!1)){ic=!0;xb=32;Lc=!0;(new m.GraphIterator).jd(qc);P.OutlineElementNavigator.Ce(qc);const gd=qc.currentNode;J.ParagraphReader.jva(gd)&&J.ParagraphReader.HPa(gd).Zge("delete_ip");var Ac=new m.GraphIterator;Ac.set(Ja);(Ac=this.aj.isEmpty(Ac))&&mc&&H.SelectionEditor.l9(mc.Pa)?(cb.z8a(Cb),P.OutlineElementNavigator.Ce(tb),nb.Yf.Vya(tb.currentNode)):gd.FJ?(cb.z8a(Cb),P.OutlineElementNavigator.Wd(qc),qc.vg()):Va&&Ac?this.Uf.zzi(Ja)&&!({eZ:ic}=this.P2i(Va,Ja,gd,mc,ic)).returnValue&&(cb.z8a(Cb),nb.Jn.Lda(tb),
this.TPh.NDn(Ja),tb.vg()):hb.TableReader.isTable(qc)?(cb.z8a(Cb),Va&&(ba.moveToFirstRow(qc),ba.moveToFirstColumn(qc),N.OutlineNavigator.I9(qc),P.OutlineElementNavigator.Ce(qc),Wa.Bc((new ac.a(L.SelectionFactory.ne(qc.currentNode,0))).restore())),xb=2,ic=!1):this.aj.Wb(gd)&&(1==this.aj.textLength(gd)&&(Wa=ua.e(gd),1==Wa.length&&8==Wa[0].qh&&(Wa=O.a.createTextRange(gd,0,1),this.ig.Ge(Wa,"",void 0,void 0,ha.a.tGc))),({eZ:ic}=this.P2i(Va,Ja,gd,mc,ic)).returnValue||(Mb.actionId==ha.a.backspace&&cb.rnc(Ja),
this.TPh.bil(Va,cb,Cb,tb,Ja,qc)))}return{tU:Lc,response:xb,eZ:ic}}P2i(Va,tb,cb,Mb,mc){if(this.Pd.tg){if(nb.lva){const Cb=Object(ra.a)(fb.AParagraphNode,cb)?nb.lva.HWc(cb):!1,Ja=Object(ra.a)(fb.AParagraphNode,tb)?nb.lva.HWc(tb):!1;if(Cb!==Ja)return{returnValue:!1,eZ:mc};if(!ta.a.sr&&Ja)return this.Uf.fh&&nb.jFk(tb,cb,Va)&&this.Pd.Us(4),{returnValue:!1,eZ:mc}}Va=Va?tb:cb;if(!Object(ra.a)(fb.AParagraphNode,Va))return{returnValue:!1,eZ:mc};tb=Va.qa.last;cb=l.AFrameworkApplication.userName;if(!tb.yi||
tb.yi.authorName!==cb)return nb.Bj.bQb(Va,2),Mb&&(W.a.instance.Bc(Mb),mc=!1),{returnValue:!0,eZ:mc}}return{returnValue:!1,eZ:mc}}dnm(Va,tb,cb,Mb,mc,Cb,Ja,Wa){$a.OutlineElementReader.AKm(tb,Va)||({response:Ja,eZ:Wa}=nb.Bol(cb,Mb,Va,Cb,mc,Ja,Wa));return{tU:!1,response:Ja,eZ:Wa}}Gil(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb,ic){let qc=!1,Lc=2;const Ac=Mb.node;let gd=void 0,Md=!1;const ie=nb.Ck;if(!mc){if(Ac.bJ)return ie.ge(()=>{Lc=this.knm(Ac,xb)},"DVS:HLOE"),{response:Lc,eZ:qc};ie.ge(()=>{({response:Lc,tU:Md}=this.Imm(Ac,
Va,tb,cb,Lc))},"DVS:HIOD");if(Md)return{response:Lc,eZ:qc};ie.ge(()=>{({response:Lc,tU:Md}=this.Pmm(Ac,Va,tb,cb,Lc))},"DVS:HWPF");if(Md)return{response:Lc,eZ:qc};gd=this.M$h(Ac);ie.ge(()=>{({response:Lc,tU:Md}=this.Vnm(gd,Va,tb,cb,Lc))},"DVS:HPOB");if(Md)return{response:Lc,eZ:qc}}null!==gd&&void 0!==gd?gd:gd=this.M$h(Ac);ie.ge(()=>{({response:Lc,tU:Md,eZ:qc}=this.qlm(mc,gd,Ja,xb,ic,Mb,Ac,Wa,Lc,qc))},"DVS:HAOE");if(Md)return{response:Lc,eZ:qc};ie.ge(()=>{({response:Lc,tU:Md,eZ:qc}=this.dnm(mc,gd,tb,
cb,Ja,Cb,Lc,qc))},"DVS:HFLOE");return{response:Lc,eZ:qc}}qpo(Va){return H.SelectionEditor.nl(Va)||this.aH.MCi(Va)||H.SelectionEditor.Nca(Va)}gpo(Va,tb){return Va&&Va.hasProperty(z.a.zLc)?!Va.ja(z.a.zLc,!1):!tb}static get Fd(){return null!=nb.KCg?nb.KCg:nb.KCg=a.a.instance.resolve("Box4.List.IListReader")}static get Jn(){return null!=nb.BCg?nb.BCg:nb.BCg=a.a.instance.resolve("Box4.List.IListEditor")}static get Yf(){return null!=nb.zDg?nb.zDg:nb.zDg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get mq(){return zb.a.jGb}static get Bj(){return null!=
nb.TGg?nb.TGg:nb.TGg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Dh(){return null!=nb.BHg?nb.BHg:nb.BHg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Hc(){return Za.a.instance}static get Fga(){nb.Jub||(nb.Jub=a.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return nb.Jub.instance}static get dca(){nb.Qlf||(nb.Qlf=a.a.instance.Ta("Box4.IFieldEditor"));return nb.Qlf.instance}static get lva(){return null!=
nb.cwg?nb.cwg:nb.cwg=a.a.instance.Oa("Box4.IContentControlReader")}static get Ck(){return Ub.a.instance}VDl(Va){if(1===Va.hb.length&&(Va=Va.hb.J(0),H.SelectionEditor.Il(Va))){var tb=Va.Pa;Va=tb.node;tb=tb.cpBegin;var cb=this.aj.text(Va);tb<cb.length&&0<tb&&" "===cb.charAt(tb-1)&&" "===cb.charAt(tb)&&this.ig.Ge(O.a.createTextRange(Va,tb-1,tb),"\u00a0")}}FHk(Va,tb){if(!tb.hyperlink.c4a){const cb=new y.GraphTransaction(15);try{cb.Db(Va.node),this.q0.fS(Va,tb)}finally{cb&&cb.dispose()}tb.hyperlink.JG&&
this.Pd.Us(2)}}static Bol(Va,tb,cb,Mb,mc,Cb,Ja){if(cb=H.SelectionEditor.FEa(Mb,!cb,{SA:!1,Hs:!1,RC:!1,oE:!0})){Mb=L.SelectionFactory.Dy(Mb,cb.Pa);Cb=32;for(cb=0;cb<Mb.length;++cb){mc.z8a(Mb.J(cb));const Wa=l.AFrameworkApplication.va.Kf(Mb.J(cb),ha.a.HH,2,!0,Va,tb);2!==Wa&&(Cb=Wa)}32===Cb&&(Ja=!0)}return{response:Cb,eZ:Ja}}Enl(Va,tb,cb,Mb,mc,Cb,Ja){let Wa=!1;this.rpo(Va)?(Wa=nb.Ief(Va,!0,tb,cb,Mb,mc))&&nb.wJa(Cb,tb,Ja):this.qpo(Va)?(Wa=nb.Ief(Va,!1,tb,cb,Mb,mc))&&nb.wJa(Cb,tb,Ja):(Mb.normalize(),nb.wJa(Cb,
tb,Ja));return Wa}static wJa(Va,tb,cb){cb&&cb.Rqa()||nb.Rqa(tb,Va)}static Ief(Va,tb,cb,Mb,mc,Cb){var Ja;Mb||K.OutlineReader.$Qa(Va)||(cb=nb.Vbd(cb))&&mc.Dlo(cb);l.AFrameworkApplication.le("b1jb9393;09icj321");if(null===(Ja=l.AFrameworkApplication.K)||void 0===Ja?0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))Cb.Ad?Cb.Ad.Vcd=Cb.Vcd:Cb.Ad={Vcd:Cb.Vcd};Ja=Va instanceof Ya.a?Va.getContext(0).node:Va.node;Ja=nb.F5l(Ja);Va=32===l.AFrameworkApplication.va.Kf(Va,Cb.actionId,
2,tb,Cb.n$,Cb.Ad);nb.mQi(mc,Va,Ja);return Va}static get Xn(){return null!=nb.Zyg?nb.Zyg:nb.Zyg=a.a.instance.resolve("Box4.IFormattingEditor")}static get tUa(){return null!=nb.LFg?nb.LFg:nb.LFg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static F5l(Va){const tb=new Ib.a;if(Va){let cb=null;Va=L.SelectionFactory.oo(Va,!0);if(!Va)Xb.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let Mb=0;Mb<Va.length;Mb++)if(M.FormattingReader.i9e(Va.J(Mb))){cb=Va.J(Mb);break}cb&&((Va=
M.FormattingReader.Vr(cb))&&Va.cache&&Va.cache.OB&&(Va=Va.yf(null),nb.Xn.v5(Va)),Va&&(tb.formatting=Va.Tj,tb.languageId=M.FormattingReader.language(Va)),tb.zka=nb.tUa.Ro(cb.node))}return tb}static mQi(Va,tb,cb){tb?Va.normalize(cb):Va.cancel()}static Rqa(Va,tb){tb&&nb.Ck.ge(()=>{const cb=tb.restore();cb&&Va.Bc(cb)},"DVS:RS")}Hil(Va,tb,cb,Mb,mc,Cb,Ja,Wa){let xb;!tb&&({hyperlink:xb}=this.q0.wcc(Va)).returnValue?(cb=new ac.a(Mb),this.FHk(Va,xb),mc.normalize(),nb.Rqa(Cb,cb)):nb.Ief(Va,!1,Cb,Ja,mc,Wa)&&
(tb&&this.Pd.tg?(tb=nb.Bj.UHd)?(Cb.Bc(L.SelectionFactory.ne(Va.node,tb)),nb.Bj.UHd=null):nb.Rqa(Cb,cb):nb.Rqa(Cb,cb))}static jFk(Va,tb,cb){cb?(cb=Va,Va=tb):cb=tb;tb=nb.lva.Scc(cb,!1);Va=nb.lva.Scc(Va,!0);return!(tb&&Va)}rpo(Va){return Va.gx||K.OutlineReader.$Qa(Va)||this.aj.nm(Va)}static Vbd(Va){return(Va=vb.OutlineElementGeneralizer.nha(Va.hb,!0))&&1===Va.length&&(Va=Va.getContext(0).node,hb.TableReader.HR(Va))?Va:null}M$h(Va){const tb=new m.GraphIterator;tb.set(Va);tb.rd();P.OutlineElementNavigator.Wd(tb);
return tb}}nb.Jub=null;nb.Qlf=null;Object(D.a)(nb,"ADeleteViewStrategy",null,[]);class pb{bil(Va,tb,cb,Mb,mc,Cb){const Ja=Cb.currentNode;P.OutlineElementNavigator.Wd(Cb);Va?(tb.rnc(Cb.currentNode),pb.Uf.nyi(cb,mc,Ja,!1)||pb.Yf.merge(Mb,Cb,!1,!1)):pb.Uf.nyi(cb,Ja,mc,!0)||pb.Yf.merge(Cb,Mb,!1,!1)}NDn(Va){Va&&J.ParagraphReader.Wb(Va)&&(Ra.a.I5c(Va),pb.orl.H_e(Va))}static get Yf(){return null!=pb.uDg?pb.uDg:pb.uDg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get orl(){return null!=pb.Pwg?
pb.Pwg:pb.Pwg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Uf(){return sa.a.instance}}Object(D.a)(pb,"DeleteParagraphNodeStrategy",null,[612]);class Xa extends nb{constructor(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb){super(new pb,Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb)}}Object(D.a)(Xa,"DeleteViewStrategy",nb,[]);c.d(I,"DeleteActor",function(){return Pb});class Pb extends la{constructor(Va,tb,cb,Mb,mc,Cb,Ja,Wa,xb,ic,qc,Lc){super();this.deleteParagraph=(Ac,gd)=>{Ac=gd.node;Ra.a.I5c(Ac);this.Wye.H_e(Ac);this.xn&&
this.xn.instance&&this.xn.instance.iVi(Ac);Ac.Gs&&(this.em.oWn(Ac,!this.fh),this.fh&&this.lVg.instance&&this.lVg.instance.EDj(Ac));return 0};this.LJd=(Ac,gd,Md)=>{2==Md&&(Ac=l.AFrameworkApplication.breadcrumbFolderUrl,Ac&&0!=Ac.length||(Ac=l.AFrameworkApplication.breadcrumbBrandUrl),ia.App.Phb(Ac));return 32};this.$hl=(Ac,gd,Md)=>{({DeleteActor:Ac}=c(1604));if(1===Md)return 32;Md=ia.App.za.Iq.Vf("ModelUpdate","DeleteAnchoredObject");gd=gd.node;const ie=new m.GraphIterator;ie.set(gd);ie.zb(12);const hf=
ie.fo(12);if(sa.a.instance.FWc(hf))return 2;Ac.w1b(hf);Ac=new y.GraphTransaction(7);Ac.Db(gd);ie.vg();Ac.dispose();Md.stop();return 32};this.LZj=new mb;this.MZj=new Xa(sa.a.instance,Oa.a.instance,Cb,Ja,Wa,xb,ic,qc,Lc);this.em=Va;this.evc=tb;this.lVg=cb;this.Wye=Mb;this.xn=mc}get fh(){return this.evc.instance?this.evc.instance.fh:!1}get bQh(){return this.MZj}get RPh(){return this.LZj}x5f(Va,tb,cb,Mb){const mc=yb.rjl,Cb=this.$hl;Va.ra(ha.a.backspace,Z.a.M7,Cb);Va.ra(ha.a.backspace,Z.a.unsupportedObject,
mc);Va.ra(ha.a.HH,Z.a.M7,Cb);Va.ra(ha.a.HH,Z.a.unsupportedObject,mc);Va.ra(ha.a.backspace,Z.a.paragraph,this.deleteParagraph);Va.ra(ha.a.HH,Z.a.paragraph,this.deleteParagraph);Va.ra(ha.a.Hva,Z.a.paragraph,this.deleteParagraph);Va.ra(ha.a.LJd,Z.a.view,this.LJd);Va.Xc(ha.a.Hva,64);super.x5f(Va,tb,cb,Mb)}static w1b(Va){var tb;(null===(tb=ia.App.xd)||void 0===tb?0:tb.So)&&ia.App.xd.Yp.$F(Va)}}Object(D.a)(Pb,"DeleteActor",la,[])},1605:function(D,I,c){c.r(I);D=c(0);var l=c(7),f=c(1450),a=c(1617),k=c(921),
x=c(1548);class y{constructor(ra){this.w$j=ra}initialize(){return Promise.resolve(0)}V1d(){return Promise.resolve(0)}EV(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.w$j}))}ome(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bke(){return!1}bRc(){return"MockAuthTokenStrategy"}}
Object(D.a)(y,"MockAuthTokenStrategy",null,[375]);var m=c(1662);class r{static get(ra,xa,fa){if(!fa)return ra;let oa=0;return Promise.race([ra,new Promise(ta=>{oa=window.setTimeout(()=>{ta(xa)},fa)})]).then(ta=>{window.clearTimeout(oa);return Promise.resolve(ta)}).catch(()=>{window.clearTimeout(oa);return Promise.resolve(xa)})}}Object(D.a)(r,"PromiseWithTimeout",null,[]);var z=c(2),v=c(466);class G{constructor(ra,xa,fa,oa,ta){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=ra;this.scope=xa;this.silentLogin=fa;this.options=oa;this.correlationId=ta}}Object(D.a)(G,"TokenRequestParameters",null,[378]);var F=c(20),H=c(22);class L{constructor(){this.Ekh=null;let ra=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.nka),xa=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Cme);this.d0b=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ra&&""!==ra?ra:"Unspecified",xa&&""!==xa?xa:"Unspecified")}initialize(){return new Promise(ra=>
{H.a.instance.Ta("Common.App.WopiIdentity.IWopiIdentity").execute(xa=>{this.Ekh=xa;ra(0)})})}ae(ra){const xa=["HTTPS:","API:"];let fa=!1;const oa=ra.toLocaleUpperCase();for(const ta of xa)if(oa.startsWith(ta)){fa=!0;break}return fa||this.wLm(ra)?ra+"/.default":ra}wLm(ra){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ra)}V1d(){return Promise.resolve(0)}EV(ra,xa,fa,oa,ta,Ka,va){if(F.a.jRa){ta=v.OAuthManagerSettings.f1o;if(!ta)return xa=Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(xa);if(!Array.contains(ta,ra))return xa=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ra}),Promise.resolve(xa)}ra=this.ae(fa);fa=new G(fa,ra,!oa,null,z.AFrameworkApplication.userSessionId);return this.Ekh.getAccessToken(fa,xa,va).then(La=>Object.assign(new x.a,{IsSuccess:!0,Token:La.accessToken}),La=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:La}))}ome(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bke(){return!1}bRc(){return this.d0b}}Object(D.a)(L,"ParentFrameTokenStrategy",null,[375]);var J=c(54),M=c(756),P=c(75);class N{constructor(){this.reject=this.resolve=null;this.startTime=0;this.o3i=this.svh=null}}Object(D.a)(N,"PromiseWrapper",null,[]);class K{constructor(ra=0){this.jy=0;this.tAc=!1;this.qy=new P.a;this._timeout=ra}enqueue(ra){return new Promise((xa,
fa)=>{this.qy.add(Object.assign(new N,{o3i:ra,resolve:xa,reject:fa}));this.process()})}process(){if(this.tAc||this.jy===this.qy.count)return!1;const ra=this.qy.J(this.jy++);try{this.tAc=!0,ra.o3i().then(xa=>{this.tAc=!1;this.C8e(ra,xa,null,!0)}).catch(xa=>{this.tAc=!1;this.C8e(ra,null,xa,!1)})}catch(xa){this.tAc=!1,this.C8e(ra,null,xa,!1)}return!0}C8e(ra,xa,fa,oa){if(oa){const ta=()=>{ra.resolve(xa);this.process()};0<this._timeout?window.setTimeout(()=>{ta()},this._timeout):ta()}else{const ta=()=>
{ra.reject(fa);this.process()};0<this._timeout?window.setTimeout(()=>{ta()},this._timeout):ta()}}}Object(D.a)(K,"PromiseQueue",null,[]);class O{constructor(){this.correlationId=this.resolve=null}}Object(D.a)(O,"ResolveWithCorrelation",null,[]);var V=c(69),W=c(168),T=c(952),Y=c(87);class ba extends W.a{constructor(ra,xa,fa,oa,ta,Ka){super(!1,!1,!0);this.TQg=this.PAa=null;this.Pta=ra;this.Vdk=fa;this.Oq=oa;this.slk=ta;this.Avb=Ka;this.tH=document.createElement("iframe");this.tH.id="SharedAuthInteractiveFrame";
this.tH.setAttribute("name","SharedAuthInteractiveFrame");this.tH.setAttribute("title","SharedAuthInteractiveFrame");this.tH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.tH.style.border="0";this.tH.style.height="48px";this.tH.style.width="190px";$addHandler(this.tH,"error",Object(J.a)(this,this.Nrn,"onSharedAuthFrameError"));ra=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Pta,xa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",z.AFrameworkApplication.userType);this.tH.src=ra;this.VZj=new Promise(va=>{this.TQg=va});this.UQg=!1}fUa(){this.PAa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.Vdk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(J.a)(this,this.G9k,"createFrame"),["resolveDialogStyles"]:this.TQg}};this.Cd=5;this.Qh(CommonUIStrings.l_SignIn,Object(J.a)(this,this.ioo,"sharedAuthConsentDialogHandler"),
this.PAa)}KFj(ra=!1,xa=5){this.PAa&&this.PAa.bodyControls&&(!0!==Object(V.a)(Object,this.PAa.bodyControls).frameLoaded&&(Object(V.a)(Object,this.PAa.bodyControls).frameLoaded=!0),ra!==Object(V.a)(Object,this.PAa.bodyControls).frameLoadSuccess&&(Object(V.a)(Object,this.PAa.bodyControls).frameLoadSuccess=ra),xa!==this.PAa.dialogButtonsOption&&(this.PAa.dialogButtonsOption=null,this.Cd=xa),this.update(this.PAa))}vvo(ra,xa){const fa=new T.a(Y.a.moo);fa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:ra,["dialogStyles"]:xa};this.Oq.JTa(fa,this.tH.contentWindow,this.Pta)}f1h(){this.KFj(!1,6)}get vnj(){return this.tH}get Ell(){return this.VZj.then(ra=>{this.UQg=!0;return ra})}get Fll(){return this.UQg}Nrn(){this.f1h()}G9k(){return this.tH}ioo(ra){0===ra&&(this.slk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.Avb(null))}}
Object(D.a)(ba,"SharedAuthConsentDialog",W.a,[382]);var Z=c(970),ea=c(86),ha=c(150),la=c(39),ia=c(135),sa=c(115);class Oa{constructor(){this.tH=null;this.qmd=0;this.FYb=this.O0b=this.ete=this.Avb=this.bba=this.Dih=null;this.Oq=new Z.a(null,null);this.d0b="SharedAuthTokenStrategy Unloaded";this.Pta=v.OAuthManagerSettings.koo;this.Geh=v.OAuthManagerSettings.joo;this.zSg=v.OAuthManagerSettings.enableConsoleLogging;this.d0j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.Bik=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.nmk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Icb={};this.z5j=new K(1500)}bRc(){return this.d0b}initialize(){var {OAuthManager:ra}=c(1605);if("loadFrame"in this.Icb)return this.Icb.loadFrame.svh;if(!this.Pta)return ea.Health.instance.recordKpiFailure(ra.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),
l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ra=this.Fje("loadFrame");this.qmd=la.a.We();var xa=this.Pta+this.Geh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.nmk&&(xa+="&webworker=1");this.tH=document.createElement("iframe");this.lAf(this.tH);this.tH.style.cssText="height:0;width:0;display:none;";this.tH.id=
"SharedAuthFrame";this.tH.setAttribute("name","SharedAuthFrame");this.tH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.tH.setAttribute("title","SharedAuthFrame");this.tH.src=xa;document.body.appendChild(this.tH);xa=la.a.We()-this.qmd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",xa,this.tH.src);return ra}V1d(ra){this.ete=ra;const xa=new T.a(Y.a.ynj);xa.Values=this.Zuh(ra);
ra=this.Fje("initFrame");this.Oq.JTa(xa,this.tH.contentWindow,this.Pta);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ra}EV(ra,xa,fa,oa,ta,Ka){const va=new T.a(Y.a.noo),La=this.Dei();va.Values=this.VAj(ra,xa,fa,oa,ta,Ka,La);ra=this.Fje(La);oa&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.z5j.enqueue(()=>new Promise(za=>{this.XMo(Ka,va,za,La)})):(this.Oq.JTa(va,this.tH.contentWindow,
this.Pta),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",xa));return ra}XMo(ra,xa,fa,oa){const ta=this.Icb[oa];ta&&(this.O0b=xa,this.Avb=Object.assign(new O,{resolve:fa,correlationId:oa}),this.bba=new ba(this.Pta,this.Geh,ra,this.Oq,ta,fa),this.bba.fUa())}Dei(){return ia.a.create().toString()}VAj(ra,xa,fa,oa,ta,Ka,va){const La={};La.appName=ra;La.appId=xa;La.target=fa;La.withPopup=oa;La.claims=ta;La.promptMessage=Ka;La.messageCorrelationId=
va;return La}lAf(ra){$addHandler(ra,"load",Object(J.a)(this,this.Qmn,"onIFrameLoaded"));$addHandler(ra,"error",Object(J.a)(this,this.cnb,"onIFrameError"));this.Oq.oba(this.Pta);this.Oq.Fv(Y.a.Bnj);this.Oq.bC(Y.a.Bnj,Object(J.a)(this,this.orn,"onScriptLoaded"));this.Oq.Fv(Y.a.Anj);this.Oq.bC(Y.a.Anj,Object(J.a)(this,this.nrn,"onScriptInitialized"));this.Oq.Fv(Y.a.wnj);this.Oq.bC(Y.a.wnj,Object(J.a)(this,this.rmn,"onGetTokenResponse"));this.Oq.Fv(Y.a.Cnj);this.Oq.bC(Y.a.Cnj,Object(J.a)(this,this.Ynn,
"onLoginResponse"));this.Oq.Fv(Y.a.znj);this.Oq.bC(Y.a.znj,Object(J.a)(this,this.qnn,"onInteractiveFlowReady"));this.Oq.Fv(Y.a.xnj);this.Oq.bC(Y.a.xnj,Object(J.a)(this,this.Bmn,"onHideDialog"));this.Oq.Fv(Y.a.unj);this.Oq.bC(Y.a.unj,Object(J.a)(this,this.vUf,"onCloseDialog"))}Fje(ra){const xa=new N;xa.startTime=la.a.We();const fa=new Promise((oa,ta)=>{xa.resolve=oa;xa.reject=ta});xa.svh=fa;this.Icb[ra]=xa;return fa}Qmn(){const ra=la.a.We()-this.qmd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
ra)}cnb(ra){const {OAuthManager:xa}=c(1605),fa=la.a.We()-this.qmd,oa=Object.assign(new sa.a,{durationMs:fa});ea.Health.instance.recordKpiFailure(xa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,oa);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",fa,this.zSg?JSON.stringify(ra):"")}orn(ra){const {OAuthManager:xa}=c(1605),fa=this.Icb.loadFrame;var oa=la.a.We()-fa.startTime,ta=ra.Values.AuthLibrary.toString();ra=ra.Values.Success.toString();l.ULS.sendTraceTag(573112902,
3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ra,ta,oa);ta&&(this.d0b="SharedAuthTokenStrategy "+ta);ta=Boolean.parse(ra);ta||(ra=ha.a.oG(),void 0!==ra&&null!==ra&&(ra.set("AuthLibrary",this.bRc()),oa=Object.assign(new sa.a,{durationMs:oa,extendedProperties:ra}),ea.Health.instance.recordKpiFailure(xa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,oa)));fa.resolve(ta?0:1)}nrn(ra){if(ra.Values.interactive&&this.O0b&&this.O0b.Values.messageCorrelationId){const fa=
this.O0b.Values.messageCorrelationId.toString();if(ra.Values.interactive&&this.bba){this.bba.Ell.then(oa=>{this.Oq.JTa(this.O0b,this.bba.vnj.contentWindow,this.Pta);this.bba.vvo(fa,oa);this.bba.KFj(!0);this.O0b=null});return}}ra=this.Icb.initFrame;const xa=la.a.We()-ra.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",xa);ra.resolve(0)}rmn(ra){if(ra.Values.messageCorrelationId&&ra.Values.messageCorrelationId.toString()){var xa=ra.Values.messageCorrelationId.toString(),
fa=this.Icb[xa];if(fa){var oa=la.a.We()-fa.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",oa);ra.Values.isSuccess&&ra.Values.isSuccess?fa.resolve(ra.Values.response):fa.reject(ra.Values.response);this.tBj(xa)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}qnn(){if(this.bba.Fll)this.bba.f1h();
else if(this.ete&&this.bba){const ra=new T.a(Y.a.ynj);ra.Values=this.Zuh(this.ete,!0);this.Oq.JTa(ra,this.bba.vnj.contentWindow,this.Pta)}}Bmn(){this.bba&&this.bba.IVd()}vUf(ra){ra.Values.cancelled&&ra.Values.cancelled&&ra.Values.messageCorrelationId&&this.tBj(ra.Values.messageCorrelationId.toString());this.bba&&this.bba.hide()}Zuh(ra,xa=!1){const fa={};fa.appIds=this.fMl();fa.upn=ra.loginHint;fa.authority=ra.authority;fa.authorityType=Object(f.a)(k.a,ra.authorityType);fa.tenantId=ra.tenantId;fa.correlationId=
z.AFrameworkApplication.userSessionId;fa.enableConsoleLogging=this.zSg;fa.enablePopupFlash=this.d0j;fa.skipUpnCheck=this.Bik;fa.interactive=xa;return fa}fMl(){const ra=[],xa=v.OAuthManagerSettings.B0e;for(let oa in xa){var fa=xa[oa];Array.contains(ra,fa)||Array.add(ra,fa)}return ra}ome(ra,xa,fa,oa,ta,Ka){const va=new T.a(Y.a.loo),La=this.Dei();va.Values=this.VAj(ra,xa,fa,oa,ta,Ka,La);this.Dih=va;ra=this.Fje(La);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
xa);this.cto();return ra}bke(){return!0}cto(){this.FYb||(this.FYb=new M.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.FYb.id=16,this.FYb.d_d=!1,this.FYb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Oq.JTa(this.Dih,this.tH.contentWindow,this.Pta)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ua.Lb.Bma(this.FYb,
!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Ynn(ra){if(ra.Values.messageCorrelationId&&ra.Values.messageCorrelationId.toString()){var xa=this.Icb[ra.Values.messageCorrelationId.toString()];if(xa){var fa=la.a.We()-xa.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",fa);ra.Values.isSuccess&&ra.Values.isSuccess?xa.resolve(ra.Values.response):xa.reject(ra.Values.response)}else l.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}tBj(ra){this.Avb&&this.Avb.correlationId===ra&&(this.Avb.resolve(null),this.Avb=null)}}Object(D.a)(Oa,"SharedAuthTokenStrategy",null,[375]);class Ra{constructor(ra){this.t7=ra;this.d0b="UnsupportedAuthTokenStrategy Reason="+a.a[this.t7]}initialize(){return Promise.resolve(0)}V1d(){return Promise.resolve(0)}EV(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:a.a[this.t7],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.t7]+"]"}))}ome(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bke(){return!1}bRc(){return this.d0b}}Object(D.a)(Ra,"UnsupportedAuthTokenStrategy",null,[375]);var Na=c(1512);c.d(I,"OAuthManager",function(){return Da});class Da{constructor(ra=null){this.Z$=
0;this.aaa=null;this.lyb=0;this.R0g=!!window.location.search.match(RegExp("wdpa=1","gi"));const xa=la.a.We();this.f5j=this.Gkl(ra).then(fa=>fa?this.Nwm():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-xa)),fa=ha.a.oG(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.fL()),fa=Object.assign(new sa.a,{durationMs:Math.floor(la.a.We()-xa),extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,
"StrategyPickFailed",!1,!0,fa)),Promise.resolve(1))).then(fa=>0!==fa?Promise.resolve(fa):this.D_m())}Hkl(){if(this.R0g)this.Z$=5,this.aaa=new Ra(this.Z$);else{var ra=v.OAuthManagerSettings.Kbn;ra&&0<ra.length?(this.Z$=1,this.aaa=new y(ra)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.Z$=2,this.aaa=new Ra(this.Z$)):(ra=m.a.getAuthContext().loginHint)&&ra.length?v.OAuthManagerSettings.USc?
(this.Z$=1,this.aaa=new L):(this.Z$=1,this.aaa=new Oa):(this.Z$=3,this.aaa=new Ra(this.Z$)):(this.Z$=4,this.aaa=new Ra(this.Z$))}}fL(){return this.aaa?this.aaa.bRc()||"Unknown":"None"}Gkl(ra=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const xa=la.a.We();return z.AFrameworkApplication.K.yXl().then(fa=>{fa?(this.Hkl(),ra&&(this.aaa=ra),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.ypl,this.fL(),Math.floor(la.a.We()-xa))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(la.a.We()-xa));return Promise.resolve(fa)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(la.a.We()-xa));return Promise.resolve(!1)})}Nwm(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.fL());const ra=la.a.We();return r.get(this.aaa.initialize(),2,v.OAuthManagerSettings.q2f).then(xa=>{if(0===xa)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.fL(),Math.floor(la.a.We()-ra));else if(1===xa){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-
ra));var fa=ha.a.oG();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.fL()),fa=Object.assign(new sa.a,{durationMs:Math.floor(la.a.We()-ra),extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,"StrategyInitFailed",!1,!0,fa))}else 2===xa&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-ra)),fa=ha.a.oG(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.fL()),fa=Object.assign(new sa.a,
{durationMs:Math.floor(la.a.We()-ra),extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,"StrategyInitTimedOut",!1,!0,fa)));return Promise.resolve(xa)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-ra));return Promise.resolve(1)})}D_m(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.fL());const ra=la.a.We();return r.get(this.aaa.V1d(m.a.getAuthContext()),2,
v.OAuthManagerSettings.q2f).then(xa=>{if(0===xa)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.fL(),Math.floor(la.a.We()-ra));else if(1===xa){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-ra));var fa=ha.a.oG();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.fL()),fa=Object.assign(new sa.a,{durationMs:Math.floor(la.a.We()-ra),extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,
"StrategyLoadFailed",!1,!0,fa))}else 2===xa&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-ra)),fa=ha.a.oG(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.fL()),fa=Object.assign(new sa.a,{durationMs:Math.floor(la.a.We()-ra),extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,"StrategyLoadTimedOut",!1,!0,fa)));return Promise.resolve(xa)},()=>{l.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.fL(),Math.floor(la.a.We()-ra));return Promise.resolve(1)})}EV(ra,xa,fa=null){return this.Inc(ra,xa,!1,null,"",fa)}WAj(ra,xa,fa,oa,ta=null){return this.Inc(ra,xa,!0,fa,oa,ta)}Inc(ra,xa,fa,oa,ta,Ka,va=0){va+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ra,this.hPb(ra,xa),this.fL(),va);var La=ha.a.oG();void 0!==La&&null!==La&&
(La.set("AuthLibrary",this.fL()),La.set("AppName",ra),La.set("Target",this.hPb(ra,xa)),ea.Health.instance.recordKpiUsage(Da.kpiName,0,"WacOAuthFC",La));if(!v.OAuthManagerSettings.isEnabled||this.R0g){var za;return this.JLf((za=new x.a,za.IsSuccess=!1,za.Token=null,za.ErrorCode="NotEnabled",za.ErrorMessage="OAuthManager is disabled.",za),ra)}const Ca=v.OAuthManagerSettings.B0e[ra];if(void 0===Ca||null===Ca){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ra);var ua;return this.JLf((ua=new x.a,ua.IsSuccess=!1,ua.Token=null,ua.ErrorCode="DisallowedApp",ua.ErrorMessage="Disallowed appName: "+ra,ua),ra)}const ib=la.a.We();let bb=ib;const mb=this;La=this.f5j.then(Za=>{bb=la.a.We();return mb.REm(ra,Ca,xa,fa,oa,ta,Ka,Za)});za=fa?0:v.OAuthManagerSettings.q2f;let yb;ua=(yb=new x.a,yb.IsSuccess=!1,yb.Token=null,yb.ErrorCode="authTokenStrategy_timeout",yb.ErrorMessage="Auth Strategy timed out after ["+za+"] ms when fetching token",yb);let ab=this,Ga=this;return r.get(La,
ua,za).then(Za=>va<=Da.a$m&&(Za.ErrorCode===Da.Wxj||Za.ErrorCode===Da.MBo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",va,Math.floor(la.a.We()-ib)),ab.Inc(ra,xa,fa,oa,ta,Ka,va)):Za.ErrorCode===Da.zDi&&!fa&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",va,Da.dVh),Da.gtl&&ab.aaa.bke()&&ab.aaa.ome(ra,Ca,xa,fa,oa,ta).then(Ub=>Promise.resolve(ab.F2d(Ub,ra,xa,Ca,ib,bb))).catch(()=>
{let Ub;const Xb=(Ub=new x.a,Ub.IsSuccess=!1,Ub.Token=null,Ub.ErrorCode="authTokenStrategy_failure",Ub.ErrorMessage="LoginPopup failed, GetToken could not be called",Ub);return Promise.resolve(ab.F2d(Xb,ra,xa,Ca,ib,bb))}),Da.dVh)?ab.Inc(ra,xa,!0,oa,ta,Ka,va):Promise.resolve(ab.F2d(Za,ra,xa,Ca,ib,bb))).catch(()=>{let Za;const Ub=(Za=new x.a,Za.IsSuccess=!1,Za.Token=null,Za.ErrorCode="authTokenStrategy_failure",Za.ErrorMessage="Auth Strategy failed with an unknown error",Za);return Promise.resolve(Ga.F2d(Ub,
ra,xa,Ca,ib,bb))})}REm(ra,xa,fa,oa,ta,Ka,va,La){return 1===La||2===La?this.JLf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===La?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ra):this.aaa.EV(ra,xa,fa,oa,ta,Ka,va).then(za=>Promise.resolve(this.nQi(za,!0,ra))).catch(za=>Promise.resolve(this.nQi(za,!1,ra)))}F2d(ra,xa,fa,oa,ta,Ka){const va={},La=la.a.We()-Ka;va.IsSuccess=ra.IsSuccess;va.ErrorCode=ra.IsSuccess?"Success":ra.ErrorCode||"";va.ErrorMessage=
ra.IsSuccess?"Success":this.hPb(xa,ra.ErrorMessage||"");va.Target=this.hPb(xa,fa||"");va.TimeInMS=Math.floor(La);va.LoadTimeInMS=Math.floor(Ka-ta);va.AuthLibrary=this.fL();va.AppName=xa;va.AuthorityType=Object(f.a)(k.a,m.a.sPd());va.UserType=this.Ohm(m.a.getAuthContext());va.IsAuthSupportedInSession=a.a[this.Z$];va.RequestCount=++this.lyb;va.AppId=oa;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(va));ra.IsSuccess||(fa=ha.a.oG(),void 0!==fa&&null!==fa&&(fa.set("AppName",xa),fa.set("AuthLibrary",
this.fL()),fa.set("ErrorCode",ra.ErrorCode),fa.set("ErrorMessage",this.hPb(xa,ra.ErrorMessage)),xa=Object.assign(new sa.a,{durationMs:La,extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,"TryGetTokenFailure",!1,!0,xa)));return ra}JLf(ra,xa){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",xa,this.hPb(xa,ra.ErrorMessage));const fa=ha.a.oG();void 0!==fa&&null!==fa&&(fa.set("AppName",xa),fa.set("AuthLibrary",this.fL()),
fa.set("ErrorCode",ra.ErrorCode),fa.set("ErrorMessage",this.hPb(xa,ra.ErrorMessage)),xa=Object.assign(new sa.a,{extendedProperties:fa}),ea.Health.instance.recordKpiFailure(Da.kpiName,"FailureBeforeGetToken",!1,!0,xa));return Promise.resolve(ra)}Twi(ra){return ra===Na.a.hle}hPb(ra,xa){return this.Twi(ra)&&xa?"REDACTED":xa}Ohm(ra){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!ra.loginHint||1>ra.loginHint.length?"empty":-1<ra.loginHint.indexOf("guest#")?"guest":-1<ra.loginHint.indexOf("ext#")?
"external":0>ra.upn.indexOf("@")?"no-at":"supported"}Sti(){return 1===this.Z$}nQi(ra,xa,fa){let oa=null,ta=null,Ka=null,va=null;ra?ra.ErrorCode||ra.ErrorMessage?(ta=ra.ErrorCode?ra.ErrorCode:Da.cXh,Ka=ra.ErrorMessage?ra.ErrorMessage:"No message"):ra.Token?xa?oa=ra.Token:(ta=Da.fWn,Ka="A rejected promise returned a token."):(ta=Da.cXh,Ka=JSON.stringify(ra)):(ta=Da.Men,Ka="No result came from Auth Token Strategy");ra&&ra.Telemetry&&!this.Twi(fa)&&(va=ra.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(va)));if(ta===Da.ecn||ta===Da.bJo)ta=Da.Wxj,Ka="Auth Library Timed Out";ta===Da.GGk&&-1<Ka.indexOf(Da.znk)&&(ta=Da.zDi);if(ta||Ka)oa=null;return Object.assign(new x.a,{IsSuccess:!!oa,Token:oa,ErrorCode:ta,ErrorMessage:Ka,Telemetry:va})}static get dVh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get gtl(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Da.bJo="token_renewal_error";Da.cXh="Exception";Da.Men="NoResult";Da.fWn="RejectToken";Da.ecn="monitor_window_timeout";Da.Wxj="Timeout";Da.MBo="authTokenStrategy_timeout";Da.GGk="login_required";Da.znk="AADSTS50058";Da.zDi="Cookies Disabled";Da.kpiName="OAuthManager";Da.a$m=2;Object(D.a)(Da,"OAuthManager",null,[318])},1608:function(D,I,c){D=c(0);class l{constructor(y,m,r,z){this.IYj=y;this.Kfk=m;this.Ifk=r;this.Lfk=z}get mHd(){return this.IYj}get Mde(){return this.Kfk}get Kde(){return this.Ifk}get resultType(){return this.Lfk}}
Object(D.a)(l,"SearchContext",null,[1129]);class f{CId(y,m,r,z){var v=r-m;let G;if(100<=v)v=m,G=r;else{v=Math.max(0,m+Math.ceil(v/2)-50);G=Math.min(y.length,v+100);v=Math.max(0,G-100);let H;if(v&&" "!==y.charAt(v-1)){H=Math.min(m,v+10);for(var F=v;F<H;++F)if(" "===y.charAt(F)){v=F+1;break}}if(G!==y.length&&" "!==y.charAt(G))for(H=Math.max(r,G-10),F=G-1;F>=H;--F)if(" "===y.charAt(F)){G=F;break}}y=y.substring(v,G);return new l(y,m-v,r-v,z)}DId(y){return this.CId(y.ici(),y.Ac,y.end,"")}}Object(D.a)(f,
"SearchContextFactory",null,[1110]);var a=c(122),k=c(1591);c.d(I,"a",function(){return x});class x extends f{constructor(){super()}DId(y){let m=y.Ac,r=y.end;const z=({Ac:m,end:r}=x.x6l(y,m,r)).returnValue;y=k.a(y.type);return this.CId(z,m,r,y)}static get instance(){return null!=x.DAg?x.DAg:x.DAg=new x}static x6l(y,m,r){y=y.ici();return x.i9i(y,m,r)}static i9i(y,m,r){const z=a.AParagraphNode.NP(y);if(z.length<y.length){y=y.substring(0,m);const v=a.AParagraphNode.NP(y);y=y.length-v.length;m-=y;r-=y}return{returnValue:z,
Ac:m,end:r}}}Object(D.a)(x,"EditorSearchContextFactory",f,[])},1610:function(D,I,c){D=c(0);var l=c(2),f=c(22),a=c(329),k=c(720),x=c(23),y=c(9),m=c(137),r=c(48),z=c(546),v=c(206),G=c(250),F=c(83),H=c(26),L=c(8),J=c(3),M=c(6),P=c(596),N=c(1063);class K{create(){return new N.a}}Object(D.a)(K,"FootnoteEndnoteContainerNodeFactory",null,[349]);var O=c(533);c.d(I,"a",function(){return V});class V{constructor(W,T,Y,ba,Z,ea,ha,la,ia){this.Ryd=null;V.ga=W;this.zE=Y;this.AMe=ba;this.jYj=ea;this.Zc=ha;this.ib=
Z;this.J$j=la;this.wZj=ia;V.Lh=T}y4d(W,T){this.Hul(W);W.Ub(7);this.zE.Rwi(W,T)||W.Jf(7)}Hul(W){if(this.AMe.szi(W)){var T=!1,Y=!1;if(W.Ub(7)){do{const ba=W.currentNode;if(37===ba.type)switch(ba.getValue(M.a.m4)){case 0:Y=!0;break;case 1:T=!0}}while(W.Ni(7))}Y||this.Nmh(W,0);T||this.Nmh(W,1)}}Nmh(W,T){const Y=this.jYj.create(1074135124);Y.setValue(M.a.m4,T);W.xf(Y,7)}X$n(W){W&&this.Ggj(W.doa)}Ggj(W){W&&(W=x.SelectionFactory.ne(W.Kb.paragraph,W.Kb.cp+1),this.ib.Bc(W))}Idn(W){let T=this.J$j(W);void 0!==
T&&null!==T?this.zE.jpa(T)&&(T=this.zE.Jci(T)):T=W;return this.wZj(T)}Zvo(){this.Ryd?V.Lh.notificationBar.removeEntry(this.Ryd):this.Ryd=V.Lh.notificationBar.sva(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);V.Lh.notificationBar.qA(this.Ryd)}XCk(W,T){W=this.Zc.qoa(W,37,37);let Y=!1;if(W.Qd()){do{const ba=W.currentNode;this.zE.RGf(ba)?this.Tsh(ba,T):Y=!0}while(W.Kj())}Y&&this.Zvo()}Tsh(W,T){P.f(W,Y=>{V.$Gl(Y,T);return!0},12)}Spm(W,T){W=this.zE.KPc(W,T);return W?
(W=this.Zc.Tf(W))?W.Gz():!1:!1}t8h(W,T){W=this.zE.KPc(W,T);W=this.Zc.Tf(W);if(W.Qd()){do if(T=W.currentNode,1===T.getValue(M.a.eoa))return T;while(W.Kj())}return null}static LPc(){return new V(l.AFrameworkApplication.va,y.App.za,O.a.instance,m.PageReader.instance,r.a.instance,new K,new z.a,v.OutlineNavigator.Ddn,G.WordSectionNavigator.Jcf)}static get instance(){return null!=V.NAg?V.NAg:V.NAg=V.LPc()}static get il(){return null!=V.iEg?V.iEg:V.iEg=f.a.instance.resolve("Box4.IParagraphEditor")}static $Gl(W,
T){T.sjb?V.il.mq.Zda(W,F.OutlineReader.LX(W)):V.il.mq.Zda(W,0);W=H.a.createTextRange(W,0,L.ParagraphReader.textLength(W));V.ga.Kf(W,J.a.font,2,!0,new a.a,new k.a(T.fontName));V.ga.Kf(W,J.a.WA,2,!0,new a.a,new k.a(T.fontSize))}}V.ga=null;V.Lh=null;Object(D.a)(V,"FootnoteEndnoteEditor",null,[393])},1617:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.unknown=0]="unknown";f[f.supported=1]="supported";f[f.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";f[f.userUnsupportedNoLoginHint=
3]="userUnsupportedNoLoginHint";f[f.hostUnsupported=4]="hostUnsupported";f[f.perfAutomation=5]="perfAutomation"})(l||(l={}));Object(D.b)("SupportStatus",l)},1627:function(D,I,c){c.d(I,"a",function(){return L});D=c(0);var l=c(354),f=c(60),a=c(22),k=c(155),x=c(7),y=c(110),m=c(69),r=c(12),z=c(103),v=c(531),G=c(122),F=c(100),H=c(8);class L{constructor(J,M,P,N,K,O=null,V="",W=!0,T=!1){this.t1a=this.rje=this.Qob=this.x3i=this.lde=null;this.bWc=!1;this.Mzf=null;this.aTf=0;this.Wke=null;this.context=J;this.ie=
J.view;this.Qw=M;this.Ad=K;this.$R=P;this.n$=N;this.Gja=this.failed=!1;this.B8d=null;this.P3a=this.Occ=!1;this.Rwo=L.H9e(J);this.browserName=V;this.eHj=W;this.MXc=T;this.iVa=!1;this.a5b=0;if(J=Object(y.a)(85,K)?K:null){this.x3i=new l.DictionaryPropertySet;this.x3i.Yw(J);P=J.ja(k.a.Q2c,f.a.nil);this.hIc=P!=f.a.nil?P.toString():f.a.create().toString();if(J.ja(k.a.J_i,!1)){this.Occ=!0;this.P3a=J.ja(k.a.P3a,!1);this.B8d=O;for(O=this.ie.mb.ng;O.gx;)O=O.getContext(0);if(K=Object(m.a)(G.AParagraphNode,O.node)){P=
0;N=H.ParagraphReader.textLength(K);switch(O.contextId){case r.a.Jd:P=O.cpBegin;N=O.cpEnd;break;case r.a.Uc:P=N}this.lde=z.FormattingReader.QQd(O.node,P,O.Fb);x.ULS.shipAssertTag(6305503,307,!!this.lde);K=F.a.q9b(K);for(const Y of K)Y.cpEnd<=P||Y.cpBegin>=N||L.Sp.fS(O.node,Y.hyperlink)}}this.Gja=J.ja(k.a.Gja,!1);this.iVa=J.ja(k.a.iVa,!1);this.Qob=J.ja(k.a.Qob,null)}else this.hIc=f.a.create().toString();M&64&&(this.Gja=!0)}static get Sp(){return null!=L.wzg?L.wzg:L.wzg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static H9e(J){if(J){if(J.gx){for(let M=
0;M<J.length;M++)if(L.H9e(J.getContext(M)))return!0;return!1}if(Object(y.a)(v.a,J))return L.H9e(J.ek);if(H.ParagraphReader.Wb(J.node)&&J.node.zO)return!0}return!1}}Object(D.a)(L,"ClipboardActionArguments",null,[])},1628:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(7),f=c(216),a=c(93);class k{static get LXm(){return k.Cpd}static t7k(x,y,m){try{k.Cpd=k.ual(x,y,m)}catch(r){k.Cpd=null,l.ULS.VA(539787540,393,10,r,"Error in creating autoTriggerTextContext: {0}",r instanceof Error?r.message:
"Unknown Error")}}static wcj(){k.Cpd=null}static ual(x,y,m){if(!a.ListItemReader.jg(y))throw l.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const r=f.a.n1l(y);if(null===r||void 0===r||!r.id)throw l.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),Error("No list node with id found under outline element");y=m.tw(y);if(!y)throw l.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),
Error("No listInfo found for given iterator");return new k(x,r.id,y)}constructor(x,y,m){this.Xzj=x;this.m_m=y;this.i6f={listType:m.listType,listStyle:m.listStyle,YJf:m.Ou}}NQm(x,y){return y&&x&&this.m_m===x.id&&y.listType===this.i6f.listType&&y.listStyle===this.i6f.listStyle&&y.Ou===this.i6f.YJf}}k.Cpd=null;Object(D.a)(k,"AutoTriggerTextContext",null,[])},1629:function(D,I,c){c.d(I,"a",function(){return M});D=c(0);var l=c(22),f=c(60),a=c(43),k=c(640),x=c(137),y=c(546),m=c(174),r=c(9),z=c(108),v=c(6),
G=c(881),F=c(772),H=c(533),L=c(1551),J=c(1610);class M{constructor(P,N,K,O,V,W){this.zE=P;this.fLa=K;this.AMe=O;this.qxe=V;this.Zc=W}KBm(P,N,K){const O=this.L$h(N,P.node),V=P.node.Lc;if(!V)return null;const W=new a.GraphTransaction(15);W.Db(P.node);W.Qj=K;K=this.LBm(O,N);M.MBm(K,V,P,N);W.dispose();return K}L$h(P,N){const K=this.Zc.yk();K.set(N);K.zb(7);K.ld(7);this.fLa.y4d(K,P);return K}LBm(P,N){const K=F.a.createNode();K.properties.setValue(v.a.m4,N);P.xf(K,8);this.qxe.E8k(K,N);return K}static get ig(){return null!=
M.nvg?M.nvg:M.nvg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Dea(){return M.ZW||(M.ZW=new k.WACStyleSet)}static set Dea(P){M.ZW=P}static LPc(){const {FootnoteEndnoteDefaultContentInserter:P}=c(1698);return new M(H.a.instance,L.a.instance,J.a.instance,x.PageReader.instance,P.instance,new y.a)}static get instance(){return null!=M.tBg?M.tBg:M.tBg=M.LPc()}static get ai(){return M.iA||(M.iA=m.PageNavigator.instance)}static set ai(P){M.iA=P}static MBm(P,N,K,O){r.App.xd.So&&r.App.xd.Yp.$F(K.node);
const V=new z.a;V.setValue(v.a.d8b,P.id);V.setValue(v.a.m4,O);const W=N.Su(V,f.a.create());M.ig.Uha(K,T=>G.a.getInstance(T,W,P.id),M.b5h(K.node,O))}static b5h(P,N){let K=null;(P=M.ai.ru(P))&&(P=M.Dea.XX(P))&&(K=P.nFa(N?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return K}}M.ZW=null;M.iA=null;Object(D.a)(M,"FootnoteEndnoteInserter",null,[442])},1634:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static n1n(f,a){l.aMe=f;l.iPe=
a}static k1n(f,a){l.gPe=f;l.uZa=a}static Cei(){return l.gPe===l.uZa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.uZa,l.aMe,l.iPe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.gPe,l.uZa,l.aMe,l.iPe)}}l.gPe=0;l.uZa=0;l.aMe=null;l.iPe=null;Object(D.a)(l,"ReplaceAllContext",null,[])},1654:function(D,I,c){c.r(I);D=c(0);var l=c(2053),f=c(60),a=c(2),k=c(307),x=c(22),y=c(1973),m=c(9),r=c(7),z=c(247),v=c(2055),G=c(13),F=c(15),H=c(1608);class L{constructor(rc=
"",hb="",fb=!1,Nb=!1){this.jOm=fb;this.HRm=Nb;this.actionId=rc;this.DIa=hb}}Object(D.a)(L,"SearchEntryPointContext",null,[]);class J{constructor(rc){this.Nfa=null;this.Rs=!1;this.IN=rc}initialize(){this.G_();this.Pz();this.b8(0)}Pz(){this.Nfa.Pz()}dispose(){this.IN=null}VQc(){return!1}get sG(){return this.Nfa?this.Nfa.sG:0}b8(rc){this.Nfa.b8(rc)}get isVisible(){return this.Rs}oZe(rc){this.Nfa&&this.Nfa.Qbp(rc)}g$i(rc){this.Nfa&&this.Nfa.lnp(rc)}ZFj(rc){this.Nfa&&this.Nfa.Yrp(rc)}bDh(){this.Nfa&&this.Nfa.qdp()}Uee(rc){this.Nfa&&
this.Nfa.Uee(rc)}}Object(D.a)(J,"FindReplacePane",null,[373,10]);var M=c(67),P=c(1413),N=c(1076),K=c(173),O=c(178),V=c(1064),W=c(92),T=c(107),Y=c(86),ba=c(42),Z=c(25),ea=c(398),ha=c(1515),la=c(331),ia=c(1044),sa=c(704),Oa=c(82),Ra=c(1094);class Na{constructor(rc){this.Zqk=(hb,fb)=>{this.Syd.nb(hb)?this.Syd.Z(hb,fb):this.Syd.add(hb,fb);(hb=this.RLl(hb))&&this.bti(fb,hb,this.bIh(la.a.getTypeName()))};this.Syd=new Oa.a;this.RV=new Oa.a;this.annotationType=ha.RoleDetectionAnnotation.getTypeName();rc.gSn(this.Zqk)}GB(rc,
hb){let fb;const Nb=rc.parentPath.substr(rc.parentPath.lastIndexOf("\\")+1),Fb=rc.content;if(!Fb||this.nRm(Fb))""!==Nb&&({value:fb}=this.Syd.Fc(Nb,fb)).returnValue&&this.bti(fb,rc,this.bIh(hb)),hb===la.a.getTypeName()?(hb=null,({value:hb}=this.RV.Fc(Nb,hb)).returnValue?this.RV.Z(Nb,rc):this.RV.add(Nb,rc)):hb===ia.a.getTypeName()&&this.RV.remove(Nb)}bti(rc,hb,fb){const Nb=this.y0l(hb);hb=this.SLl(hb);0<hb&&rc(fb,Nb,hb)}SLl(rc){try{return Number.parseInvariant(rc.id.substr(2))}catch(hb){r.ULS.sendTraceTag(554747009,
367,10,hb.toString())}return-1}RLl(rc){let hb;return({value:hb}=this.RV.Fc(rc,hb)).returnValue?hb:null}r3c(rc){if(rc)for(const hb of rc)this.GB(hb,"AugLoop_Core_AddOperation")}y0l(rc){if(rc=rc.content)switch(rc.roleType){case ha.RoleType.Heading1:return 1;case ha.RoleType.Heading2:return 2;case ha.RoleType.Heading3:return 3;case ha.RoleType.Heading4:return 4;case ha.RoleType.Heading5:return 5;case ha.RoleType.Heading6:return 6;case ha.RoleType.Heading7:return 7;case ha.RoleType.Heading8:return 8;
case ha.RoleType.Heading9:return 9}return-1}nRm(rc){rc=rc.roleType;return rc===ha.RoleType.Heading1||rc===ha.RoleType.Heading2||rc===ha.RoleType.Heading3||rc===ha.RoleType.Heading4||rc===ha.RoleType.Heading5||rc===ha.RoleType.Heading6||rc===ha.RoleType.Heading7||rc===ha.RoleType.Heading8||rc===ha.RoleType.Heading9}bIh(rc){if(rc===la.a.getTypeName()||rc===sa.a.getTypeName())return Ra.a.YYe;if(rc===ia.a.getTypeName())return Ra.a.OJd;throw Error.create("Invalid operation type");}}Object(D.a)(Na,"RoleDetectionAnnotationHandler",
null,[292]);var Da=c(132),ra=c(63),xa=c(1152),fa=c(48),oa=c(75),ta=c(54),Ka=c(196),va=c(174),La=c(655);class za extends Ka.a{constructor(rc,hb){super(rc,hb,m.App.O$);this.f1d=null;this.gQa=this.g3b=0;this.headingsReady=!1;this.Iya=this.GNa=0;this.$Ji=!1;this.A6g=this.bXg=this.fTg=null}get Q0d(){return!0}get HXh(){return this.fTg}get O4d(){return this.A6g}jIj(){this.headingsReady&&(this.bXg.style.display="none",this.gQa||this.g3b?(this.HXh.style.display="none",this.container.style.display="block"):
(this.container.style.display="none",this.HXh.style.display="block"))}get f9(){return super.f9|240}static Maf(rc,hb,fb){var Nb=m.App.za.jb.Yc;if(Nb&&(Nb=va.PageNavigator.instance.hP(Nb))){const Fb=new za(new La.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));Fb.gQa=0;Fb.g3b=0;Fb.f1d=null;Fb.XAb(rc);Fb.fTg=hb;Fb.bXg=fb;Fb.UE(Nb);Fb.headingsReady=!0;Fb.jIj();Fb.A6g=null;return Fb}return null}}Object(D.a)(za,"WordNavigationPaneHeadingsView",Ka.a,[388,56,57,10]);class Ca{constructor(rc){this.RV=
new Oa.a;this.M7g=rc}GB(rc,hb){hb===la.a.getTypeName()?(hb=null,({value:hb}=this.RV.Fc(rc.id,hb)).returnValue?this.RV.Z(rc.id,rc):this.RV.add(rc.id,rc)):hb===ia.a.getTypeName()&&this.RV.remove(rc.id);this.M7g&&this.M7g()}r3c(rc){if(rc)for(const hb of rc)this.GB(hb,la.a.getTypeName())}B8b(){var rc;const hb=[];if(0<(null===(rc=this.RV)||void 0===rc?void 0:rc.count))for(const fb of this.RV.values)hb.push(fb);return hb}}Object(D.a)(Ca,"ContractEntityAnnotationHandler",null,[292]);var ua=c(3);class ib{constructor(rc){this.ga=
rc}Mjn(){this.cancelSearch()}Qln(rc){this.ga.Rb(F.a.uUd,2,rc)}gpn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(ua.a.M3b,2)}qrn(){this.ga.processAction(ua.a.Jjf,2)}onSearchQueryChanged(rc){this.ga.Rb(ua.a.Kjf,2,rc)}atn(){this.ga.processAction(F.a.replace,2)}btn(){this.ga.processAction(F.a.replaceAll,2)}Xsn(){this.ga.processAction(G.a.Fjf,2)}Ysn(){this.ga.processAction(G.a.Xjf,2)}$sn(){this.ga.processAction(ua.a.g1f,2)}Zsn(){this.ga.processAction(ua.a.iSf,2)}fic(rc){this.ga.Rb(F.a.fic,
2,rc)}}Object(D.a)(ib,"FindReplaceActions",null,[385]);var bb=c(249);class mb{}mb.UP=bb.a.Hhb;mb.$gc=0;mb.Fva="FindReplaceTaskPaneData";mb.lS=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(D.a)(mb,"FindReplaceConstants",null,[]);var yb=c(766);class ab{PAj(rc){var hb,fb,Nb;return ea.a.Kib(null===(Nb=null===(fb=null===(hb=m.App.za)||void 0===hb?void 0:hb.jb)||void 0===fb?void 0:fb.Yc)||void 0===Nb?void 0:Nb.vd,rc)}clearSelection(){if(this.SHe){const rc=this.PAj(this.SHe);rc&&rc.bna()}this.SHe=
this.Gdh=null}O$n(rc){this.clearSelection();if(rc){const hb=this.PAj(rc.parentPath);if(hb){const fb=rc.content;fb&&(this.Gdh=rc.id,hb.PTa([new yb.a(fb.range.start,fb.range.start+fb.range.length)]),hb.rNf(0,1));this.SHe=rc.parentPath}}}}Object(D.a)(ab,"RangeAnnotationContentSelector",null,[]);var Ga=c(1634);class Za{constructor(rc){this.U8j=rc}get Oj(){return this.U8j.value}i4l(rc){rc=this.Oj.r2a(rc);return this.GKm(rc)?null:rc}GKm(rc){return rc.id===this.Oj.HEa.id}static get instance(){return null!=
Za.hAg?Za.hAg:Za.hAg=Za.bF()}static bF(){const rc=new z.a(()=>y.FindManager.instance.Oj);return new Za(rc)}}Object(D.a)(Za,"SearchResultOrder",null,[]);var Ub=c(8),Xb=c(204);class zb{constructor(rc){this.oIe=rc}get CL(){return this.oIe.value}getSelectedText(){var rc=this.CL.k4;if(rc){const hb=rc.cpBegin,fb=rc.cpEnd-hb;if(0<fb&&(rc=rc.node,Ub.ParagraphReader.Wb(rc)))return rc.characterData.substr(hb,fb)}return null}static getInstance(){return zb.Wl()}static Wl(){const rc=new z.a(()=>Xb.a.instance);
return new zb(rc)}}Object(D.a)(zb,"SelectionHelper",null,[]);var Ib=c(31),$a=c(115),Hb=c(368),Ya=c(863),Sa=c(240),Eb=c(369),Jb=c(1869),vb=c(370);class ac extends Ka.a{constructor(rc,hb,fb){super(rc,hb,m.App.O$);this.KHa=fb;this.Uli=!1}get Q0d(){return!0}get f9(){return super.f9|248}static Maf(rc){var hb=m.App.za.jb.Yc;const fb=vb.a.instance.Pc(3);return hb&&(hb=va.PageNavigator.instance.hP(hb))?(rc=new ac(new La.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),rc),fb.g9c(rc.$b),rc.UE(hb),fb.dispose(),
rc.Uli=!0,rc):null}}Object(D.a)(ac,"WordNavigationPaneReactHeadingsView",Ka.a,[56,57,10]);class dc extends J{constructor(rc,hb,fb,Nb,Fb,nb,pb,Xa,Pb,Va,tb,cb,Mb){var mc,Cb,Ja;super(rc);this.wub=mb.UP;this.fkk="FindReplaceTaskPaneProps";this.Vb=M.FocusManager.instance();this.fWa=this.MMa=this.YZ=this.uTe=null;this.iUb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.vqc=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Rqd=(null===(mc=a.AFrameworkApplication.K)||void 0===
mc?void 0:mc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(Cb=a.AFrameworkApplication.K)||void 0===Cb?void 0:Cb.$("NavPaneReactHeadings"));this.H$j=null===(Ja=a.AFrameworkApplication.K)||void 0===Ja?void 0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.IEj=()=>{this.isVisible&&this.XId===v.a.intelligentPlaceholder&&this.Hm()};this.kB=new P.a;this.UVg=hb;this.AKa=v.a.headings;this.rEc=l.a.initial;this.Qsa=new oa.a;this.nQ=
"";this.Juc={matchCase:!1,matchWholeWord:!1};this.hPe="";this.XQe=null;this.w3=fb;this.ofh=!1;this.idb=Nb;this.ib=Fb;this.X$j=nb;this.ACa=pb;this.FI=Xa;this.Jrd=!0;this.k7=this.j7=!1;this.Oe=Pb;this.pH=Va;this.Ib=tb;this.PV=cb;this.JOg=Mb;this.Zse&&this.ACa.RVn(()=>{this.Hm()})}get cUe(){return 1}get Zse(){return this.iUb&&this.vqc&&!!this.Oe}get $se(){return this.iUb&&this.H$j&&!!this.Oe}get headingsReady(){return this.Rqd?this.pH.headingsReady:this.Wld?this.Wld.headingsReady:!1}set headingsReady(rc){this.Rqd?
this.pH.headingsReady=rc:this.Wld&&(this.Wld.headingsReady=rc)}get XId(){return this.AKa}vqj(){this.AKa=v.a.headings;this.Hm()}vto(){this.AKa=v.a.contracts;this.Hm()}mqj(){this.AKa=v.a.find;ba.a("NavigationPaneFind");this.Hm()}grj(){this.AKa=v.a.replace;this.Hm()}Hqj(){this.AKa=v.a.intelligentPlaceholder;this.Hm()}W9c(rc){this.ofh=rc;this.Hm()}VQc(){return this.XId===v.a.replace}get sG(){return this.rEc}b8(rc){this.rEc=rc;this.Hm()}oZe(rc){this.ctk(rc);this.Hm()}ctk(rc){const hb=this.X$j(rc[rc.length-
1]);if(hb){let fb=-1;for(let Nb=0;Nb<this.Qsa.count;Nb++)if(hb.id===this.Qsa.J(Nb).id){fb=Nb;break}-1===fb?r.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Qsa.aD(fb,this.BIh(rc))}else this.Qsa.addRange(this.BIh(rc))}g$i(rc){for(const hb of rc)for(rc=this.Qsa.count-1;0<=rc;rc--)if(this.Qsa.J(rc).id===hb.id){this.Qsa.removeAt(rc);break}this.Hm()}ZFj(rc){for(const hb of rc)for(rc=this.Qsa.count-1;0<=rc;rc--)if(this.Qsa.J(rc).id===hb.id){this.Qsa.Z(rc,this.AIh(hb));
break}this.Hm()}bDh(){this.Qsa.clear();this.XQe=null;this.Hm()}Uee(rc){this.XQe=rc?rc.id:null;this.Hm()}BIh(rc){if(!rc)return new oa.a;const hb=new oa.a;for(const fb of rc)hb.add(this.AIh(fb));return hb}AIh(rc){const hb=this.idb.DId(rc);return{id:rc.id,searchBeginIndex:hb.Mde,searchEndIndex:hb.Kde,searchResult:hb.mHd}}kne(){}vXo(){var rc={};this.IN.fic(rc);rc=rc[N.a.Value];this.uTe=Z.c(rc)?"":rc;this.Hm()}DPa(){return this.nQ}uGb(){return this.hPe}acg(rc){this.nQ=rc;this.Hm()}clearSearch(){}initialize(){this.owd=
window.performance.now();const rc=this.Vb.ae(this.wub);rc.parent=K.AFrame.xp;rc.$H=!0;this.G_();this.b8(l.a.initial)}OP(){this.isVisible?(r.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),O.UISurfaces.Mu().then(rc=>{rc.setSelectedTaskPane(this.wub,this.cUe);this.u$();this.Jrd&&this.Blj(!0);return null}).catch(rc=>{dc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],rc)})):(this.c$c(),this.Jrd&&this.Blj(!1))}Blj(rc){const hb=
this.UVg();hb?this.nQ=hb:rc&&this.nQ||(this.nQ="");this.IN.onSearchQueryChanged(this.nQ)}Loa(){O.UISurfaces.Mu().then(rc=>{rc.hideTaskPane(this.wub,this.cUe);return null}).catch(rc=>{dc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],rc)})}G_(){this.w3.tOa();this.YZ=this.w3.x5b(this.Vb);this.Lqk()}c$c(){O.UISurfaces.Mu().then(rc=>{this.owd=window.performance.now();rc.showTaskPane(this.wub,this.vA());rc=[Object.assign(new Ib.a,{name:"Tab",string:this.AKa})];const hb=window.performance.now()-
this.owd;ba.a("NavigationPaneOpen",!0,hb,rc);return null}).catch(rc=>{dc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],rc)})}Hm(){O.UISurfaces.Mu().then(rc=>{rc.updateTaskPane(this.wub,this.vA());return null}).catch(rc=>{dc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],rc)})}vA(){const rc={activeTab:v.a.initial};this.kB.vpb(rc);return Object.assign(new V.a,{title:mb.lS,hideHeader:!1,width:320,location:this.cUe,contentProps:rc,onOpen:()=>{this.Rs=
!0;this.oVn();this.tSn();this.Jrd&&this.u$();m.App.za.updateCommandUI();m.App.za.YZa(this.IEj)},onClose:()=>{try{const hb=window.performance.now();this.$da();this.Rs=!1;this.KPo();this.nQo();this.IN.gpn();this.uTe="";this.rEc=l.a.initial;m.App.za.Nic(this.IEj);m.App.za.updateCommandUI();const fb=window.performance.now()-hb;ba.a("NavigationPaneClose",!0,fb)}catch(hb){dc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],hb)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,
isModernPane:!0})}oVn(){this.Zse&&!this.MMa&&ea.a.Uk().then(()=>{this.MMa=new Na(this.ACa);this.Oe.ob(this.MMa,this.MMa.annotationType);this.Oe.getAnnotationsByType(this.MMa.annotationType).then(rc=>{this.MMa.r3c(rc)})})}nQo(){this.Zse&&this.MMa&&(this.Oe.sc(this.MMa,this.MMa.annotationType),this.MMa=null)}jLo(){if(this.$se){var rc=new Jb.ContractEntitySignal;rc=Object.assign(new Ya.a,{parentPath:["Signal",Sa.a.getTypeNameFor(rc)],items:[Object.assign(new Eb.a,{body:rc})]});this.PV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Hb.a,
{operation:rc}))}}tSn(){this.$se&&!this.fWa&&ea.a.Uk().then(()=>{this.fWa=new Ca(this.Hm);this.Oe.ob(this.fWa,Jb.ContractEntityAnnotation.getTypeName());this.jLo();this.Oe.getAnnotationsByType(Jb.ContractEntityAnnotation.getTypeName()).then(rc=>{this.fWa.r3c(rc)})})}KPo(){this.$se&&this.fWa&&(this.Oe.sc(this.fWa,Jb.ContractEntityAnnotation.getTypeName()),this.fWa=null)}Lqk(){this.kB.AL(this.YVl());this.kB.AL(this.$Vl());this.kB.AL(this.xYl());this.kB.AL(this.pRl());this.kB.AL(this.s_l());this.kB.AL(this.mKl());
this.kB.AL(this.onLinkExecute());this.kB.AL(this.onPivotTabExecute());this.kB.AL(this.fcm());this.kB.AL(this.efm());this.kB.AL(this.YZl());this.kB.AL(this.Tfm());this.kB.AL(this.q$l())}Tfm(){return rc=>{rc.autoDetectedHeadingsToggleDisabled=this.ACa?!this.ACa.aHk():!0}}efm(){return rc=>{rc.type=this.fkk}}onLinkExecute(){return rc=>{rc.onLinkExecute=()=>{this.IN.qrn()}}}onPivotTabExecute(){return rc=>{rc.onPivotTabExecute=hb=>{switch(hb){case v.a.headings:this.vqj();break;case v.a.replace:this.grj();
break;case v.a.contracts:this.vto();break;case v.a.intelligentPlaceholder:this.Hqj();break;default:this.mqj()}Z.b(this.nQ)&&(this.nQ=this.UVg(),this.nQ||(this.nQ=""),Z.b(this.nQ)||(this.IN.onSearchQueryChanged(this.nQ),this.Hm()))}}}fcm(){return rc=>{rc.showOutOfSyncNotification=this.ofh}}$Vl(){return rc=>{rc.findSearchBoxContent={onSearchQueryChanged:hb=>{this.nQ=hb;this.Hm();this.IN.onSearchQueryChanged(hb)},findOptions:this.Juc,matchCase:this.j7,matchWholeWord:this.k7,findSearchText:this.nQ,onClearButtonExecute:()=>
{void 0!==this.nQ&&null!==this.nQ&&""!==this.nQ&&(this.nQ="",this.ib.Bc(null),this.IN.Mjn())},onMatchCaseExecute:()=>{this.Juc.matchCase=!this.Juc.matchCase;this.j7=!this.j7;this.Hm();this.IN.Xsn()},onMatchWholeWordExecute:()=>{this.Juc.matchWholeWord=!this.Juc.matchWholeWord;this.k7=!this.k7;this.Hm();this.IN.Ysn()},onMenuClose:()=>{if(this.YZ)this.YZ.onMenuClose()},onMenuOpen:()=>{if(this.YZ)this.YZ.onMenuOpen()}}}}mKl(){return rc=>{rc.activeTab=this.XId}}YZl(){return rc=>{rc.autoDetectedHeadingsToggleState=
this.ACa?this.ACa.v2e:!1;this.pH.UMc=rc.autoDetectedHeadingsToggleState;!rc.autoDetectedHeadingsToggleState&&this.ACa&&this.ACa.fnc(!1)}}YVl(){return rc=>{const hb={onReplaceAllExecute:()=>{this.IN.btn()},onReplaceExecute:()=>{this.IN.atn()},onReplaceQueryChanged:fb=>{this.hPe=fb;this.Hm()},replaceSearchText:this.hPe};rc.findReplaceContent={searchResults:this.Qsa.toArray(),replaceSearchBoxContent:hb,onNextSearchResultExecute:()=>{this.IN.Zsn()},onPrevSearchResultExecute:()=>{this.IN.$sn()},onSearchResultSelected:fb=>
{const {FindReplaceUIManager:Nb}=c(1654);this.IN.Qln(fb);Nb.KJi(1)},selectedResultId:this.XQe,summaryLabel:this.uTe,explanationText:this.nVl(this.rEc),haveTooManySearchResults:this.rEc===l.a.tooManyResults}}}nVl(rc){switch(rc){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return Ga.a.Cei();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;
default:return""}}q$l(){return rc=>{rc.replaceFollowUpsWithCommentsIsEnabled=!0}}s_l(){return rc=>{var hb=this.FI.bLl();const fb=[];for(const Nb of hb)hb=this.FI.jPd(Nb.Lc,Nb.id),fb.push({id:Nb.id.toString(),intelligentPlaceholderAnchorText:hb});rc.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:fb,onIntelligentPlaceholderInputExecute:Nb=>{this.nQ=Nb;this.AKa=v.a.find;this.Hm();this.IN.onSearchQueryChanged(Nb)},onSearchResultSelected:Nb=>{this.Hm();Nb=f.a.Ff(Nb);this.FI.Y$n(Nb)}}}}xYl(){return rc=>
{let hb=()=>{};this.ACa&&(hb=Object(ta.a)(this.ACa,this.ACa.fnc,"toggleAutoDetectedHeadings"));rc.headingsContent={onHeaderInputExecute:fb=>{this.nQ=fb;this.AKa=v.a.find;this.Hm();ba.a("NavigationPaneFind");this.IN.onSearchQueryChanged(fb)},renderHeadingContent:(fb,Nb,Fb)=>{this.Ib.Xb(new W.a(0,1,100,()=>{var nb=window.performance.now()-this.owd;if(this.Rqd){var pb=this.pH.X9;this.headingsReady=!0;this.Hm();Fb.style.display="none";pb.first&&(fb.style.display="block");this.Ib.Xb(new W.a(1,1,0,()=>
{ac.Maf(this)}))}else this.Wld=za.Maf(fb,Nb,Fb),this.Hm();pb=window.performance.now()-this.owd;ba.a("NavigationPaneHeadingsLoaded",!0,pb,[Object.assign(new Ib.a,{name:"NavPaneReactHeadings",bool:this.Rqd})]);nb=[Object.assign(new Ib.a,{name:"HeadingFetchStart",double:nb}),Object.assign(new Ib.a,{name:"HeadingFetchFinished",double:pb})];ba.a("NavigationPaneHeadingsLoadDetails",!0,void 0,nb)}))},autoDetectedHeadingsToggle:hb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,
headingsList:this.pH.X9,onHeadingChevronClick:fb=>{this.pH.wxl(fb);this.Hm()},onClickHeading:fb=>{if(this.Ib.Qv){r.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",fb);const Nb=window.performance.now();this.Ib.Xb(new W.a(0,1,0,()=>{this.pH.onClickHeading(fb);this.Hm();const Fb=window.performance.now()-Nb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Fb)}))}else this.pH.onClickHeading(fb),this.Hm()},onClickBookmark:fb=>
{if(this.Ib.Qv){r.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",fb);const Nb=window.performance.now();this.Ib.Xb(new W.a(0,1,0,()=>{this.pH.onClickBookmark(fb);this.Hm();const Fb=window.performance.now()-Nb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Fb)}))}else this.pH.onClickBookmark(fb),this.Hm()},onShareHeadingClick:fb=>{this.pH.onShareHeadingClick(fb)},bookmarkIconUrl:Da.a.sg("BookmarkDefault.png")}}}oRl(){var rc,
hb=null===(rc=this.fWa)||void 0===rc?void 0:rc.B8b();if(hb){rc=Array(hb.length);let fb=0;for(const Nb of hb)(hb=Nb.content)&&(rc[fb++]={id:Nb.id,type:hb.type,value:hb.value});return rc}return null}pRl(){return rc=>{rc.contractsContent={onHeaderInputExecute:hb=>{this.nQ=hb;this.AKa=v.a.find;this.Hm();ba.a("NavigationPaneFind");this.IN.onSearchQueryChanged(hb)},contractEntities:this.oRl(),selectedEntityId:this.JOg.Gdh,onEntitySelected:hb=>{var fb;const Nb=null===(fb=this.fWa)||void 0===fb?void 0:fb.B8b();
if(Nb)for(const Fb of Nb)if(Fb.id===hb){this.JOg.O$n(Fb);break}this.Hm()}}}}Ukj(rc){this.Jrd=rc}CVo(rc){this.Ib.Xb(new W.a(0,1,0,()=>{this.pH.uog(rc)&&this.Hm()}))}Bki(rc){this.Ib.Xb(new W.a(0,1,0,()=>{const hb=this.pH.DNb;this.pH.Oil(rc)?this.Hm():0===this.pH.DNb&&0<hb&&this.Hm()}))}Cng(rc,hb){this.Ib.Xb(new W.a(0,1,0,()=>{const fb=this.pH.DNb;this.pH.Cng(rc,hb)?this.Hm():0<this.pH.DNb&&0===fb&&this.Hm()}))}dil(rc){this.Ib.Xb(new W.a(0,1,0,()=>{const hb=this.pH.DNb;this.pH.eil(rc)?this.Hm():0===
this.pH.DNb&&0<hb&&this.Hm()}))}bmo(rc){this.pH.FIo(rc);this.Hm()}cog(rc){this.pH.cog(rc)&&this.Hm()}PJd(rc){this.pH.PJd(rc)&&this.Hm()}HIn(){return 0<this.pH.DNb}u$(){this.Vb.kg(this.wub);r.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}$da(){if(this.w4a()){var rc;(rc=ra.InteractiveViewManager.instance.zd)?(rc=rc.pJ,r.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(rc=this.Vb.XT,r.ULS.sendTraceTag(40469192,312,50,
"Taskpane now hidden with focus on default scope."));this.Vb.kg(rc)}}w4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===this.wub}static getInstance(){return dc.Wl()}static Wl(){return new dc(new ib(a.AFrameworkApplication.va),Object(ta.a)(zb.getInstance(),zb.getInstance().getSelectedText,"getSelectedText"),xa.a.instance,H.a.instance,fa.a.instance,Object(ta.a)(Za.instance,Za.instance.i4l,"getNextSearchResult"),x.a.instance.Oa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
x.a.instance.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Oa("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),T.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new ab)}static recordQosError(rc,hb,fb){const Nb=Object.assign(new $a.a,{extendedProperties:new Map});fb&&Nb.extendedProperties.set("exception",fb);Y.Health.instance.recordQosError(rc,hb,!1,!0,!1,!1,Nb)}}Object(D.a)(dc,
"ReactFindReplacePane",J,[372,373,10]);var Cc=c(1591);c.d(I,"FindReplaceUIManager",function(){return Ec});class Ec{constructor(rc,hb,fb=null,Nb=null,Fb=null,nb=null){this.kid=this.W2=0;this.k7=this.j7=this.lzb=!1;this.jm=this.$6g=this.Eka=null;this.iGa=this.hGe=!1;this.gj=rc;this.Zp=fb;this.idb=Nb;this.F3g=Fb;this.he=nb;Ec.C3b=new L}get hGf(){return this.hGe}set hGf(rc){rc!==this.hGe&&(this.hGe=rc,this.NBh())}$ge(rc){this.W2=rc;this.update();this.W2||this.sG!==l.a.searchComplete&&this.sG!==l.a.tooManyResults?
0<this.W2&&this.sG===l.a.noMatchesFound?this.b8(l.a.searchComplete):this.W2>Ec.Ayj&&this.sG!==l.a.tooManyResults&&(r.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.b8(l.a.tooManyResults)):this.b8(l.a.noMatchesFound)}sfe(rc){this.kid=rc;this.iGa&&this.update();this.F3g&&!this.F3g.value.m6c&&this.xbg()}reset(){}Vjf(){this.he&&(this.jm=this.he.Vf("UserAction","Find"));if(this.iGa||!this.sG)this.iGa=!1,r.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.b8(l.a.searching)}P7b(){var rc;
this.iGa=!0;let hb=this.W2?l.a.searchComplete:l.a.noMatchesFound;if(this.sG!==l.a.tooManyResults&&y.FindManager.instance){const fb=y.FindManager.instance.Oj;0<fb.ika&&(fb.ika>Ec.Ayj?hb=l.a.tooManyResults:this.FWo(fb))}this.b8(hb);this.update();this.jm&&(this.jm.stop(),this.jm=null);Ec.mgj=f.a.create().toString();Ec.KJi(0,this.N5b,this.DPa().length,this.W2);Object(Cc.b)()&&(null===(rc=this.gj)||void 0===rc?0:rc.isVisible)&&(rc={},a.AFrameworkApplication.va.Rb(G.a.kbe,2,rc),rc[k.a.On]&&a.AFrameworkApplication.va.Rb(G.a.NXd,
2,{CommandValueId:{query:this.DPa(),matchCase:this.j7,matchWholeWordOnly:this.k7,totalResultLimit:-1}}))}FWo(rc){const hb=rc.HEa;let fb=hb;const Nb=[];do Nb[Nb.length]=fb,fb=rc.r2a(fb);while(hb!==fb);this.gj.oZe(Nb);this.Eka&&this.gj.Uee(this.Eka)}update(){this.gj&&this.gj.vXo()}get sG(){return this.gj.sG}get N5b(){return this.gj.XId}ypb(rc){this.hGf=rc}NBh(){if(this.hGf)switch(this.sG){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.gj.W9c(!0)}else this.gj.W9c(!1)}b8(rc){if(this.gj.isVisible){switch(rc){case l.a.noMatchesFound:case l.a.searchComplete:this.sG===
l.a.tooManyResults&&(rc=l.a.tooManyResults)}this.gj&&(this.gj.b8(rc),this.NBh());this.update();this.xbg()}}fPa(rc,hb){const fb=this.iGa&&this.sG!==l.a.tooManyResults;switch(rc){case 0:fb&&this.gj.oZe(hb);break;case 1:fb&&this.gj.g$i(hb);break;case 4:fb&&this.gj.ZFj(hb);break;case 2:this.gj.bDh();break;case 3:this.Eka=hb[0],fb&&0<this.W2&&this.gj.Uee(this.Eka)}}get matchCase(){return this.j7}set matchCase(rc){this.j7!==rc&&(this.j7=rc,this.iEj())}get matchWholeWord(){return this.k7}set matchWholeWord(rc){this.k7!==
rc&&(this.k7=rc,this.iEj())}iEj(){this.gj.kne()}DPa(){return this.gj.DPa()}uGb(){return this.gj.uGb()}acg(rc){this.gj.acg(rc)}clearSearch(){this.gj.clearSearch()}get hrj(){return 0<this.W2&&this.sG!==l.a.replaceAllInProgress&&this.sG!==l.a.replaceAllComplete}Mdo(rc){let hb="";rc?hb=0<this.W2?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.DPa(),this.uGb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.DPa(),this.uGb()):
rc||0<this.W2&&(hb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.xbg(hb)}dispose(){this.gj.dispose()}VQc(){return this.gj.VQc()}Fio(rc,hb=!0){rc!==this.N5b&&(rc===v.a.headings?(r.ULS.sendTraceTag(9056651,367,50,""),this.gj.vqj()):rc===v.a.find?this.gj.mqj():rc===v.a.replace?this.gj.grj():rc===v.a.intelligentPlaceholder&&(hb||this.gj.Ukj(hb),this.gj.Hqj()))}hC(rc,hb=!0){this.gj.Ukj(hb);rc?(this.lzb||this.uAf(),this.gj.OP(),this.W2||this.sG===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.gj.b8(l.a.searchComplete):this.b8(l.a.initial)):this.gj.Loa()}uAf(){this.lzb||(this.gj.initialize(),this.lzb=!0)}xbg(rc=""){var hb=this.F$l();hb&&(rc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,rc,hb));this.idb&&hb&&this.Eka&&this.sG!==l.a.tooManyResults&&this.sG!==l.a.replaceAllInProgress&&(hb=this.idb.DId(this.Eka),rc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
rc,hb.mHd));(hb=this.mVl())&&(rc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,rc,hb));this.Zp&&rc&&this.$6g!==rc&&(this.$6g=rc,this.Zp.sendNotification(rc,!0))}F$l(){let rc="";switch(this.sG){case l.a.startSearch:rc=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:rc=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.kid,this.W2);break;case l.a.tooManyResults:this.iGa&&(rc=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.kid,this.W2));break;case l.a.noMatchesFound:rc=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:rc=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:rc=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return rc}mVl(){let rc="";switch(this.sG){case l.a.initial:rc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.SVl());break;case l.a.noMatchesFound:rc=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:rc=Ga.a.Cei();break;case l.a.tooManyResults:rc=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return rc}SVl(){let rc="";this.j7&&this.k7?rc=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.j7?rc=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.k7&&(rc=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return rc}static getInstance(rc){return Ec.Wl(rc)}static Wl(rc){const hb=dc.getInstance();return new Ec(hb,rc,x.a.instance.resolve("Common.Utils.IAriaNotifier"),H.a.instance,new z.a(()=>y.FindManager.instance.COb),m.App.za.Iq)}static KJi(rc,hb=-1,fb=-1,Nb=-1){r.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:rc,["SearchComplete.ResultsCount"]:Nb,
["SearchOpsCorrelation"]:Ec.mgj,["ActionId"]:Ec.C3b.actionId,["SourceControlId"]:Ec.C3b.DIa,["IsNavPanOpenedAlready"]:Ec.C3b.jOm,["IsSearchFromNavPane"]:Ec.C3b.HRm,["CurrentTab"]:hb,["QueryLength"]:fb})}static EOk(rc,hb,fb){hb=void 0!==hb&&null!==hb?void 0===hb.SourceControlId||null===hb.SourceControlId?"Unknown":hb.SourceControlId:rc===F.a.Tpb?"FindKeyboardShorcut":rc===F.a.Vpb?"ReplaceKeyboardShorcut":"Unknown";switch(rc){case F.a.plc:rc="ShowHeadingsPane";break;case F.a.Tpb:rc="ShowFindPane";break;
case F.a.Vpb:rc="ShowReplacePane";break;case F.a.slc:rc="ShowIntelligentPlaceholderPane";break;case F.a.t8a:rc="ToggleNavigationPane";break;default:rc="Unknown"}Ec.C3b=new L(rc,hb,fb,!0)}}Ec.Ayj=100;Ec.mgj=null;Ec.C3b=null;Object(D.a)(Ec,"FindReplaceUIManager",null,[333,321,10])},1655:function(D,I,c){c.r(I);D=c(0);var l=c(173),f=c(101),a=c(79),k=c(2),x=c(22),y=c(67),m=c(1097),r=c(133),z=c(9),v=c(7),G=c(15),F=c(249),H=c(473),L=c(1551),J=c(1831),M=c(28),P=c(332),N=c(11),K=c(447),O=c(17),V=c(266),W=
c(48),T=c(533),Y=c(1699);class ba{constructor(ab,Ga,Za,Ub,Xb,zb,Ib){this.M6g=this.eah=this.XUg=this.EI=this.F9a=this.ETb=this.OAe=this.Lwe=this.sye=this.kW=this.tfa=this.Efa=null;this.Zme=()=>{const $a=this.Gta.i9b(this.EI),Hb=this.Gta.fXl(this.EI);this.Lwe.innerText=$a.toString();this.OAe.innerText=Hb.toString();J.a.APb(this.Efa,1===$a?!1:!0);J.a.APb(this.tfa,$a===Hb?!1:!0)};this.cgo=()=>{const $a=this.Vb.getRegion(F.a.A1a);let Hb;if(this.kW&&!this.kW.disabled)Hb=this.kW;else if(this.Efa.disabled){if(this.tfa.disabled)return;
Hb=this.tfa}else Hb=this.Efa;Hb.focus();$a.ak.Zy(Hb)};this.Fqa=($a,Hb)=>{($a=Hb.pl.lb)&&this.kW&&J.a.APb(this.kW,O.SelectionEditor.Il($a)?!0:!1)};this.o7e=()=>{if(!this.tfa.disabled){const $a=this.Gta.Ckb(this.EI)?G.a.K4d:G.a.J4d;this.ga.processAction($a,2)}return!0};this.p7e=()=>{if(!this.Efa.disabled){const $a=this.Gta.Ckb(this.EI)?G.a.M4d:G.a.L4d;this.ga.processAction($a,2)}return!0};this.n7e=()=>{this.kW&&!this.kW.disabled&&this.ga.processAction(G.a.QEi,2);return!0};this.Vb=ab;this.ga=Ub;this.gg=
Xb;this.ee=zb;this.ib=Ib;this.Gta=Za;this.m8=document.createElement("div");this.m8.classList.add("FootnoteEndnoteActionBarControl");this.m8.style.zIndex=String(V.a.mLd);this.m8.style.position="relative";this.Htc=document.createElement("div");this.Htc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.m8.appendChild(this.Htc);this.Y6k();this.m8.appendChild(this.ETb);this.m8.appendChild(this.F9a);this.QZ=f.KeyInputManager.ic(a.a.a2,0);this.Nym();this.Mym()}cha(ab){v.ULS.shipAssertTag(4520065,
308,this.Gta.jpa(ab));if(this.EI!==ab){this.EI=ab;this.Zme();ab=this.Gta.Ckb(this.EI);this.E9k(ab);this.EI.yph(this.Zme);let Ga="",Za="";const Ub=this.Gta.i9b(this.EI);-1!==Ub&&(Ga=(Ub-1).toString(),Za=(Ub+1).toString());ab?(this.tfa.title=this.tfa.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Za),this.Efa.title=this.Efa.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,
Ga)):(this.tfa.title=this.tfa.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,Za),this.Efa.title=this.Efa.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ga));this.OHa()}}uDb(){this.EI&&(this.kW&&this.kW.parentNode===this.ETb&&this.ETb.removeChild(this.kW),this.pka(),this.EI.a_n(this.Zme),this.EI=null)}dispose(){this.Vb.ae(F.a.A1a).kr(this.QZ)}E9k(ab){3===
this.ga.mode&&(ab=ab?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.kW=this.q$e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",ab,null),M.a.ir(this.kW,M.a.kga,ab),this.ETb.appendChild(this.kW))}Y6k(){this.ETb=document.createElement("div");this.ETb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.F9a=document.createElement("div");this.F9a.classList.add("FootnoteEndnoteActionBarButtonHolder",
"FootnoteEndnoteActionBarRightDiv");this.Efa=this.q$e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.F9a.appendChild(this.Efa);this.Lwe=K.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.F9a.appendChild(this.Lwe);this.sye=K.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.sye.innerText=" / ";this.F9a.appendChild(this.sye);this.OAe=K.b("span","FootnoteEndnoteActionBarTotalCount",
"FootnoteEndnoteActionBar");this.F9a.appendChild(this.OAe);this.tfa=this.q$e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.F9a.appendChild(this.tfa)}q$e(ab,Ga,Za,Ub){ab=J.a.l0a(ab,Ga,Za,Ub,void 0===Ub||null===Ub);ab.setAttribute(M.a.oh,M.a.L3);return ab}Nym(){const ab=this.Vb.ae(F.a.A1a);ab.parent=r.AppFrame.xp;ab.bindAction(this.QZ,G.a.d4);ab.cga(this.cgo)}Mym(){var ab=new P.DOMFocusListing(()=>this.m8);ab.uja=!1;ab.Mm(2);ab.Mm(1);ab=this.Vb.ffb(this.m8,
this.Vb.ae(F.a.A1a),ab);ab.fTa();ab.xP=!0}OHa(){this.kW&&(this.gg.ob(N.a.click,this.kW,this.n7e),this.XUg=this.ee.sob(this.kW,this.n7e,a.a.Ls));this.gg.ob(N.a.click,this.Efa,this.p7e);this.eah=this.ee.sob(this.Efa,this.p7e,a.a.Ls);this.gg.ob(N.a.click,this.tfa,this.o7e);this.M6g=this.ee.sob(this.tfa,this.o7e,a.a.Ls);this.ib.Sw(this.Fqa)}pka(){this.kW&&(this.gg.sc(N.a.click,this.kW,this.n7e),this.ee.hrb(this.kW,this.XUg));this.gg.sc(N.a.click,this.Efa,this.p7e);this.ee.hrb(this.Efa,this.eah);this.gg.sc(N.a.click,
this.tfa,this.o7e);this.ee.hrb(this.tfa,this.M6g);this.ib.ZY(this.Fqa)}static aXl(){return ba.bXl()}static bXl(){return new ba(y.FocusManager.instance(),Y.a.instance,T.a.instance,k.AFrameworkApplication.va,z.App.za.lD,z.App.za.mD,W.a.instance)}}Object(D.a)(ba,"FootnoteEndnoteActionBarControl",null,[440]);var Z=c(231),ea=c(13),ha=c(1610),la=c(1793);class ia{constructor(ab,Ga,Za,Ub,Xb,zb,Ib,$a,Hb,Ya,Sa,Eb){this.BE=null;this.aT=!1;this.aw=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.qZb=
ab;this.P6b=Ga;this.Spc=Za;this.Abk=Ub;this.pLe=Xb;this.hm=zb;this.Sab=Ib;this.gg=$a;this.L9g=Hb;this.j_j=Sa;this.Kr=this.qZb.ownerDocument.createElement("div");this.Kr.id="FootnoteEndnoteControlOverlay";this.Kr.className="EditingSurfaceOverlay";this.vI=this.qRl();this.t1(!1);this.qZb.appendChild(this.Kr);this.qZb.appendChild(this.vI);this.P6b.bind();this.Yh=null;this.ga=Eb;this.fLa=Ya}V3n(){const ab=this.L9g();ab&&ab.Vi&&(ab.Xob=0,ab.zBd())}fDj(ab){if(this.rGc){const Ga=this.rGc.doa;Ga&&(Ga.SDf=
ab)}}get UH(){return this.aT}get rGc(){return this.BE}get dialog(){return this.Yh}get Do(){return null!=this.fzg?this.fzg:this.fzg=x.a.instance.Ta("Common.IZoomManager")}T$e(){this.Yh=la.a.jXl()}F6c(){this.Yh=null}show(ab=!0){this.aT||(this.fDj(!0),this.j_j(),this.t1(!0),this.Pz(),ab&&this.setFocus())}setFocus(){this.aT&&(this.P6b.setInitialSelection(),this.Abk())}update(){this.aT&&(this.BE.isConnected?this.Spc.Zme():this.dismiss())}dismiss(ab=!1,Ga=!1){this.aT&&(this.fDj(!1),this.R$(),this.V3n(),
this.t1(!1),this.pLe(Ga),this.Yh&&(this.ga.processAction(ea.a.$Kc,2),this.Yh=null),!ab&&this.BE&&this.BE.isConnected&&this.fLa.X$n(this.BE),this.uDb())}D2n(ab){const Ga=null!==this.Do.instance?this.Do.instance.ij:1;this.vI.style.width=ab.dHh*Ga+"px";this.aw.style.width=ab.dJc*Ga+"px";this.vI.style.marginLeft=ab.K4b*Ga+"px";this.hm?this.aw.style.marginRight=ab.D9e*Ga+"px":this.aw.style.marginLeft=ab.U4b*Ga+"px";if(ab=this.L9g())ab=ab.BL,this.vI.style.bottom=ab.offsetHeight-ab.clientHeight+"px"}cha(ab){v.ULS.shipAssertTag(4520073,
308,this.Sab.jpa(ab));this.BE!==ab&&(this.BE=ab,this.P6b.cha(ab),this.Spc.cha(this.BE))}dispose(){this.dismiss();this.P6b.dispose();this.Spc.dispose()}Pz(){this.gg&&this.gg.ob(N.a.click,this.Kr,this.onClick)}R$(){this.gg&&this.gg.sc(N.a.click,this.Kr,this.onClick)}qRl(){let ab;ab=document.createElement("div");ab.classList.add("FootnoteEndnoteControl");this.aw=document.createElement("div");this.aw.classList.add("FootnoteEndnoteContent");this.aw.appendChild(this.P6b.m8);this.aw.appendChild(this.Spc.m8);
ab.appendChild(this.aw);return ab}t1(ab){ab=(this.aT=ab)?"":"none";this.Kr.style.display=ab;this.vI.style.display=ab}uDb(){this.BE&&(this.P6b.uDb(),this.Spc.uDb(),this.BE=null)}static tSd(){const ab=z.App.za.jb.qc;return ab&&ab.Vi?ab:null}static eXl(ab,Ga,Za,Ub,Xb){return new ia(ab,Ga,Za,Ub,Xb,k.AFrameworkApplication.isRtl,T.a.instance,Z.a.instance,ia.tSd,ha.a.instance,ia.xnl,k.AFrameworkApplication.va)}static xnl(){k.AFrameworkApplication.va.Rb(ea.a.zjb,2,!0)}}Object(D.a)(ia,"FootnoteEndnoteControl",
null,[439]);var sa=c(821),Oa=c(5),Ra=c(206),Na=c(36),Da=c(8),ra=c(23),xa=c(78),fa=c(1698),oa=c(348),ta=c(985),Ka=c(583),va=c(1463),La=c(63),za=c(110);class Ca extends oa.a{constructor(ab,Ga,Za,Ub,Xb,zb,Ib,$a,Hb,Ya,Sa,Eb,Jb,vb,ac,dc,Cc){super(F.a.lha,Za,Ub,Xb,Ib,$a,Hb,Ya,Sa,Eb,Jb,vb,ac,dc,Cc);this.MOg=ab;this.JYa=zb;this.JYa.Dad=this;Ga(this);this.features.Sig=!0}get Swi(){return!0}Zuf(){const ab=this.MOg.amf(this);return ta.ViewReference.hF(this,ab)}Def(ab){Object(za.a)(Ca,ab)||this.MOg.Aef()}YQc(){return Ka.a.PNi}onResize(){super.onResize();
this.JYa.oWh()}UE(ab,Ga=null){super.UE(ab,Ga);this.JYa.bWh(this.ed.tj)}detach(){this.JYa.nWh();super.detach()}COd(){this.onResize()}static j0a(){const {FootnoteEndnoteControlManager:ab}=c(1655);return new Ca(ab.instance,va.a.R8e,z.App.za.jb,La.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.va,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),
x.a.instance.Ta("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Ta("Common.IZoomManager"),x.a.instance.Oa("Box4.IContentControlViewElementManager"),x.a.instance.Oa("Box4.CpConversionManagerImpl"),x.a.instance.Oa("Box4.ContentControlConfigSettings"),x.a.instance.Oa("Box4.IContentControlReader"),x.a.instance.Oa("Box4.IContentControlBoundaryNavigator"))}}Object(D.a)(Ca,"FootnoteEndnoteEditView",oa.a,[]);class ua{constructor(ab,Ga,Za,Ub=!1){this.Cub=
null;this.YEe=this.DLg=!1;this.mGl=()=>{const Xb=String.format("{0} {1}",this.YEe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Tw.sendNotification(Xb,!0)};this.Vb=ab;this.Gta=Ga;this.efa=Za();this.qnd=Ub;this.m8=document.createElement("div");this.m8.classList.add("FootnoteEndnoteEditControl");this.Htc=
document.createElement("div");this.Htc.classList.add("FootnoteEndnoteEditControlDividerElement");this.Ozb=(new sa.a(this.m8,"WACViewPanel_FootnoteEndnoteEditControl")).pI;this.m8.appendChild(this.Htc);this.m8.appendChild(this.Ozb)}get Tw(){return null!=this.Jug?this.Jug:this.Jug=x.a.instance.resolve("Common.Utils.IAriaNotifier")}cha(ab){v.ULS.shipAssertTag(4520077,308,this.Gta.jpa(ab));this.Cub!==ab&&(this.Cub=ab,this.l2e(this.Cub),this.YEe=this.Gta.Ckb(this.Cub),this.qnd?(this.efa.EPb(M.a.BCd),this.Vb.ae(F.a.lha).K7(this.mGl)):
this.efa.zjj(this.YEe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,M.a.BCd))}uDb(){const ab=T.a.instance.Ckb(this.Cub)?"Footnote":"Endnote";v.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:ab,["CalloutHeight"]:this.m8.scrollHeight});this.Egb();this.Cub=null}bind(){this.DLg||(this.efa.XAb(this.Ozb),this.DLg=!0)}setInitialSelection(){const ab=this.pbm();ab?this.efa.Bc(ab):this.efa.S8c()}dispose(){this.Egb()}l2e(ab){this.Egb();
this.efa.UE(ab,ab.tj)}Egb(){this.efa.detach()}pbm(){let ab=0;var Ga=null,Za=Oa.GraphIterator.eb(this.Cub);Ra.OutlineNavigator.I9(Za);if((Za=Na.OutlineElementNavigator.Ce(Za))&&Da.ParagraphReader.Wb(Za)){if(Ga=ua.b0l(Za)){ab=Ga.Kb.cp+1;Ga=fa.FootnoteEndnoteDefaultContentInserter.dPh;const Ub=Ga.length;ab+Ub<=Da.ParagraphReader.textLength(Za)&&Za.characterData.substr(ab,Ub)===Ga&&(ab+=Ub)}Ga=ra.SelectionFactory.ne(Za,ab)}return Ga}static gXl(){return ua.hXl()}static hXl(){return new ua(y.FocusManager.instance(),
T.a.instance,()=>Ca.j0a(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static b0l(ab){ab=xa.i(ab,10);return 0<ab.length?ab[ab.length-1]:null}}Object(D.a)(ua,"FootnoteEndnoteEditControl",null,[437]);var ib=c(1186);class bb{constructor(ab,Ga){this.YBa=ab;this.hm=Ga}k$b(ab,Ga){ab=this.YBa.k$b(ab);var Za=Ga.clientWidth;const Ub=Ga.scrollLeft,Xb=ab.dHh;let zb=ab.K4b,Ib=ab.K4b,$a=bb.vOf,Hb=bb.wOf,Ya=Xb,Sa=ab.dJc;this.hm?Hb=ab.D9e-Ib:$a=ab.U4b-zb;Za<Xb&&(zb=Math.max(zb-
Ub,0),Ya=Za-zb,this.hm?(Za=Ga.scrollWidth-Ub-Za,Ib=Ga.scrollWidth-ab.K4b-Xb,Hb=Math.max(ab.D9e-Za-Ib,bb.wOf),Sa=Ya-Hb-bb.vOf):($a=Math.max(ab.U4b-Ub-zb,bb.vOf),Sa=Ya-$a-bb.wOf));return new ib.a(zb,Ya,$a,Hb,Sa)}}bb.vOf=25;bb.wOf=50;Object(D.a)(bb,"FootnoteEndnoteViewPositionProvider",null,[]);class mb{constructor(ab,Ga=0,Za=0){this.clientWidth=ab;this.scrollLeft=Ga;this.scrollWidth=Za?Za:ab}}Object(D.a)(mb,"PageViewScrollContainerSizeInfo",null,[]);c.d(I,"FootnoteEndnoteControlManager",function(){return yb});
class yb{constructor(ab,Ga,Za,Ub,Xb,zb,Ib,$a){this.vE=null;this.u$=()=>{this.hp.QI(F.a.lha);this.hp.QI(F.a.A1a);this.hp.$w(l.AFrame.Un);this.Vb.PEc(F.a.lha);this.Vb.kg(F.a.lha)};this.kgo=Hb=>{this.hp.$w(F.a.lha);this.hp.$w(F.a.A1a);this.hp.QI(l.AFrame.Un);this.Vb.yKc(F.a.lha);(Hb||this.Vb.currentScope&&(this.Vb.currentScope.name===F.a.lha||this.Vb.currentScope.name===F.a.A1a))&&this.Vb.kg(l.AFrame.Un)};this.Vb=ab;this.hp=Ga;this.t2j=Za;this.u2j=Ub;this.s2j=Xb;this.YBa=zb;this.Tsa=Ib;this.a_=$a;this.QZ=
f.KeyInputManager.ic(a.a.a2,0);this.nAf();this.wT()}get control(){return this.vE}get dialog(){return this.control.dialog}get Zui(){return this.control.UH}T$e(){this.control.T$e()}F6c(){this.control.F6c()}bind(ab){this.L2k(ab)}Efg(ab){if(this.control.rGc!==ab.e0a)this.control.dismiss();else if(this.Zui)return;this.t6b();this.control.cha(ab.e0a);this.control.show(ab.qhe)}t6b(){if(this.a_){const ab=new m.a(!0);this.a_.IHa(ab)}}bZ(){this.control.setFocus()}pcd(){this.control.update()}Aef(ab,Ga=!1){this.t6b();
this.control.dismiss(ab,Ga)}B2n(ab){const Ga=yb.tSd().BL;ab=this.YBa.k$b(ab,new mb(Ga.clientWidth,Ga.scrollLeft,Ga.scrollWidth));this.control.D2n(ab)}dispose(){this.control.dispose();this.Vb.ae(F.a.lha).kr(this.QZ)}amf(ab){v.ULS.shipAssertTag(4520074,308,!!this.control);v.ULS.shipAssertTag(4520075,308,!!this.control.rGc);return this.bmf(this.control.rGc.id,ab)}L2k(ab){const Ga=this.u2j(),Za=this.s2j();this.vE=this.t2j(ab,Ga,Za,this.u$,this.kgo)}nAf(){const ab=this.Vb.ae(F.a.lha);ab.parent=3===k.AFrameworkApplication.va.mode?
r.AppFrame.PD:r.AppFrame.tic;this.Vb.EYe(F.a.lha);ab.bindAction(this.QZ,G.a.d4)}wT(){this.hp.wT(F.a.lha);this.hp.wT(F.a.A1a)}bmf(ab,Ga){return()=>{const Za=yb.tSd().ed.Lc.Eb(ab);this.Tsa.o7b();if(!Za.isConnected)return v.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.Efg(new H.a(Za,!0));return Ga}}static Wl(){const ab=new bb(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new yb(y.FocusManager.instance(),
z.App.za.ux,ia.eXl,ua.gXl,ba.aXl,ab,L.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static tSd(){const ab=z.App.za.jb.qc;return ab&&ab.Vi?ab:null}static get instance(){return null!=yb.kBg?yb.kBg:yb.kBg=yb.Wl()}}Object(D.a)(yb,"FootnoteEndnoteControlManager",null,[395])},1676:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);var l=c(7),f=c(54),a=c(173),k=c(2),x=c(11),y=c(163),m=c(125),r=c(22);class z{constructor(v,G){this.$t=
null;this.cud=!1;this.$bb=0;this.p2g="";this.nue={};this.UJe=v;this.Vb=G;this.h8g=Object(f.a)(this,this.gWf,"onModalMouseWheel");this.k1g=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Lb.zpa;this.Mw=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Lb.qL}onMenuOpen(){0<this.$bb?this.$bb++:(this.$bb++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(f.a)(this,
this.F3i,"pushTransientFocusScope"),0)}):this.F3i(),this.showModal())}F3i(){this.Vb&&this.Vb.zL(a.AFrame.Iqa,!0)}iOl(){const v=m.f(),G=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.k1g&&G.isActive&&1===G.state?"_ShyRibbon":"")}ggm(v){var G=0;if(this.Mw){if(this.nue[v])return this.nue[v];(G=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");G=G?G.offsetTop:0;this.nue[v]=
G}return G}showModal(){if(!this.$t)if(this.$t=this.createElement("div"),this.$t.setAttribute("id","ReactModalDiv"),this.$t.style.position="absolute",this.$t.style.bottom="0px",this.$t.style.left="0px",this.$t.style.right="0px",this.$t.style.backgroundColor="white",this.$t.style.opacity="0.0",this.Mw){var v=document.getElementById("regionComposerRoot");v&&v.appendChild(this.$t)}else this.UJe.appendChild(this.$t);v=this.iOl();if(v!==this.p2g){const G=this.ggm(v),F=appChrome.selectors.getShyState();
this.k1g&&F.isActive&&1===F.state&&m.a("getRibbonHeight")?this.$t.style.top=String.format("{0}px",G+appChrome.api.getRibbonHeight(m.f())):this.$t.style.top=String.format("{0}px",G);this.p2g=v}this.$t.style.display="block";this.$t.style.visibility="visible";this.$t.style.zIndex="1000";this.cud||(window.addEventListener("wheel",this.h8g,!0),this.a_d()?y.a.instance.ob(x.a.iN,this.$t,Object(f.a)(this,this.b7d,"onModalPointerUp")):y.a.instance.ob(x.a.pointerDown,this.$t,Object(f.a)(this,this.a7d,"onModalPointerDown")),
this.cud=!0)}onMenuClose(){this.$bb--;0<this.$bb||(0>this.$bb?this.$bb=0:this.ini())}tUf(){this.$bb=0;this.oLc();this.ini()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}hni(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===a.AFrame.Iqa&&!k.AFrameworkApplication.oc.Qv&&this.Vb.dS(a.AFrame.Iqa,!1);this.$t&&(this.$t.style.zIndex="-1",this.$t.style.visibility="hidden",this.$t.style.display="none");this.cud&&(window.removeEventListener("wheel",this.h8g,
!0),this.a_d()?y.a.instance.sc(x.a.iN,this.$t,Object(f.a)(this,this.b7d,"onModalPointerUp")):y.a.instance.sc(x.a.pointerDown,this.$t,Object(f.a)(this,this.a7d,"onModalPointerDown")),this.cud=!1)}ini(){this.a_d()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.hni()},0)}):this.hni()}a7d(){this.s6b();this.LRh();this.tUf();this.r7a();return!0}b7d(){this.s6b();this.LRh();this.tUf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.r7a()},0)});return!0}r7a(){4===k.AFrameworkApplication.ua.Lb.Nk&&
k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ua.r7a():this.Vb.kg(a.AFrame.Un)}gWf(v){v.stopPropagation()}s6b(){const v=r.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.s6b()}oLc(){const v=r.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.oLc()}LRh(){k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Lb.dRa&&(this.a_d()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}a_d(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(D.a)(z,"ReactModalDiv",null,[])},1681:function(D,I,c){c.d(I,"a",function(){return f});c.d(I,"b",function(){return a});c.d(I,"c",function(){return k});var l=c(2);const f=(x,y)=>{const m=RegExp("mailto:(.*)").exec(x.url);y.email=m&&2===m.length?m[1]:x.url;y.resolveState=x.kw.charAt(35)===c(1792).ACommentFormatTranslator.fGk?1:0},a=(x,y)=>{y.contentId=x.kw},k=(x,y,m)=>{y.contentId=x.kw;y.isCurrentUser=m.email===l.AFrameworkApplication.K.kb("UserPrincipalName")}},1682:function(D,I,c){c.d(I,
"a",function(){return a});D=c(0);var l=c(1054),f=c(6);class a{constructor(k,x){this.QN=this.xzc=null;this.gb=k;this.v$a=x}get key(){return"COMMENT"}get Xw(){return WordEditorIntl.WordEditorStrings.L_Comment}get a4(){return this.QN}reset(k){this.QN=k.node}gJa(k){let x=null;if(this.xzc&&this.evi(k,this.a4,this.xzc))return x=Object.assign(new l.a,{TG:this.key,contentObject:this.xzc}),{returnValue:!0,aG:x};this.xzc=null;const y=this.v$a.maf(this.a4);if(this.v$a.wCf(y)){let m=y.Qd();for(;m;){if(this.evi(k,
this.a4,m))return this.xzc=m,x=Object.assign(new l.a,{TG:this.key,contentObject:m,description:this.tib()}),{returnValue:!0,aG:x};m=y.Kj()}}return{returnValue:!1,aG:x}}evi(k,x,y){if(this.vpj(y))return!1;const m=this.v$a.o$b(y,!0),r=this.v$a.o$b(y,!1);return m&&r&&this.gb.GWc(x,m,r)&&(x=this.v$a.rwa(m,y.id,!0))&&(m!==this.a4||x.Kb.cp<=k)&&(y=this.v$a.rwa(r,y.id,!1))&&(r!==this.a4||y.Kb.cp>k||y.Kb.cp>=k)?!0:!1}vpj(k){return k.ja(f.a.LG,!1)}tib(){return null}}Object(D.a)(a,"CommentDetailsProvider",null,
[335,336])},1688:function(D,I,c){c.d(I,"a",function(){return f});D=c(0);I=c(152);var l=c(102);class f extends I.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(f,"DocumentTypeClassifierAnnotation",I.a,[])},1692:function(D,I,c){c.d(I,"a",function(){return z});
D=c(0);var l=c(2),f=c(353),a=c(86),k=c(7),x=c(54),y=c(81),m=c(61),r=c(339);class z{constructor(v,G,F,H,L,J){this.UMe=null;this.Y$g=0;this.o3=!1;this.yd=H;this.Pe=G;this.A6=L;this.VCe=F;this.Arc=l.AFrameworkApplication.rfg();this.ave=v.appSettings.ChromeClipboardAccessOperationTimeout;this.yI=0;this.hXj=J;this.E0j=v.$("EnableExternalPasteSupportOnMobileIsEnabled");this.og=f.a.getInstance(r.a.I_a);this.o3=v.$("ShouldLogCcpExtendedHealthKpis")}get FSa(){return this.A6.FSa}process(v,G){if(!this.yI)return this.lzn(G);
if(1===this.yI)return this.oNb(v,G);if(2===this.yI)return this.yI=3,this.UMe(v,G);3===this.yI&&this.A6.Flj(v,G);return!1}lzn(v){let G=!0;this.E0j&&(G=!(v.Qw&1));this.Pe.K4&&G||v.Qw&512?(this.UMe=v.Qw&2?Object(x.a)(this.A6,this.A6.paste,"paste"):Object(x.a)(this.A6,this.A6.t_i,"pasteInternal"),this.yI=2):(this.Arc?(this.yI=1,this.Y$g=Date.now()):this.yI=2,this.UMe=Object(x.a)(this.A6,this.A6.paste,"paste"));r.a.p4m(v);return!0}oNb(v,G){v=!0;if(this.VCe.value.H1i())this.yI=2;else{const F=Date.now()-
this.Y$g;F>this.ave&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",F),this.yd.Yb(y.a.Zna,{["Reason"]:m.a.lYi}),G.$R&&(G.$R.fail("Prepare for paste timed out",!1),this.o3?this.og.logKpiFailure({kpiName:r.a.SNa,errorName:"PreparePasteTimedOut",optionalVeto:{name:r.a.Qnb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",[r.a.Qnb],!1,!0,!0,!1,null)),G.failed=!0,v=!1,this.hXj.l4n())}return v}}Object(D.a)(z,"ClipboardOperationPasteProcessor",
null,[526])},1693:function(D,I,c){c.d(I,"a",function(){return W});D=c(0);I=c(295);var l=c(353),f=c(86),a=c(2),k=c(42),x=c(155),y=c(7),m=c(110),r=c(69),z=c(1450),v=c(54),G=c(88),F=c(3),H=c(81),L=c(61),J=c(1099),M=c(17),P=c(48),N=c(1627),K=c(1694),O=c(339),V=c(115);class W extends I.a{constructor(T,Y,ba,Z,ea,ha,la,ia,sa,Oa,Ra,Na,Da,ra,xa,fa,oa,ta,Ka,va,La,za,Ca,ua,ib,bb,mb,yb=!0){super();this.Pka=this.hw=null;this.WL=this.jz=0;this.Gdb=this.YQe=this.Iaa=this.lh=null;this.e7=!1;this.mT=!0;this.FWg=!1;
this.init(T);this.Ml("ClipboardOperation");this.Ujb(sa,Y,ea,ha,la);this.yd=Oa;this.De=Ra;this.Pe=Na;this.Kc=Da;this.DNg=ra;this.FNg=xa;this.ENg=fa;this.nve=oa;this.LUb=ta;this.ove=Ka;this.Arc=ia;this.mrc=va;this.YMa=La;this.lmk=yb;this.ED=za;this.Ud=Ca;this.Lm=ua;this.a_=ib;this._context=Z;this.Sfa=bb;this.L_b=mb;this.og=l.a.getInstance(O.a.I_a);la&&Object(m.a)(85,la)&&(this.Iaa=Object(r.a)(536,la.ja(x.a.Zua,null)));this.Iaa||(this.Iaa=this.Sfa.N$c());this.hsb=void 0===ba||null===ba?"NotAvailable":
Object(z.a)(K.a,ba);this.Iaa.aCk(this.hsb.split(", "));T=this._context;if(this.L_b){if(!W.Tzh(T,this.nve,this.yd,this.Iaa,yb)){this.qr=8;this.finish();return}this.lh=T.view;this.e7=3===this.lh.YJb;this.jz=0;this.WL=ba;this.Gdb=oa.FSa}else{if(!T.view.qe){this.yd.Yb(H.a.Ye,{["Reason"]:L.a.ALb});this.Iaa.fail("Not in interactive view",!0);this.qr=8;this.finish();return}this.lh=T.view;if(!this.lh.mb){this.yd.Yb(H.a.Ye,{["Reason"]:L.a.noSelection});this.Iaa.fail("No selection manager",!0);this.qr=8;this.finish();
return}this.e7=3===this.lh.YJb;this.jz=0;this.WL=ba;this.Gdb=oa.FSa;if(yb&&!(this.Gdb&&this.Gdb.lb&&this.Gdb.length)){this.yd.Yb(H.a.Ye,{["Reason"]:L.a.noSelection});this.Iaa.fail("No selection when one required",!0);this.qr=8;this.finish();return}}oa=M.SelectionEditor.Il(this.Gdb.lb);oa=!(this.WL&16&&oa);oa=Ka.dHm(ba,this.ng)&&oa;1!==this.behavior&&oa||(oa||this.Iaa.fail("Clipboard operation disabled for selection",!0),this.qr=oa?32:8,this.hra());!this.FWg&&this.Pe.ri&&(k.b("IPadCCP"),this.FWg=!0)}get ng(){this.YQe||
(this.YQe=P.a.v3b(this.Gdb));return this.YQe}Kda(){super.Kda();this.Gdb=null}run(){this.jz||this.setup();1===this.jz&&this.process();2===this.jz&&this.XFo();3===this.jz&&this.UFo();4===this.jz&&this.finish()}setup(){if(this.WL&256&&this.Arc){this.GC||this.LUb.jVk(this,this.WL,this.hsb);this.GC.run();if(this.GC.inProgress)return;this.mT=this.GC.oqa;this.iFd();if(!this.mT){this.Iaa.fail("No access to system clipboard",!0);this.qr=8;this.jz=4;this.o2d();return}}else y.ULS.sendTraceTag(9037319,307,50,
"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.WL,this.hsb,this.Pe.jG,this.actionId);this.WL&32&&!this.De.QYd(this.lh.mb.ng)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.yd.Yb(H.a.Ye,{["Reason"]:L.a.jcf}),this.Iaa.fail("Cut not allowed",!0),this.mrc.show(),this.qr=8,this.jz=4):(this.WL&16||this.WL&32)&&G.a.instance.J(1)&&this.ED.T_d(this.lh.mb.hb.lb)?(this.Iaa.fail("Selected content deleted in coauthoring",!0),this.Ud.CQb(),this.qr=8,this.jz=4):(this.WL&4096&&(this.a_.oic(Object.assign(new J.a,
{JVc:!0,QY:this.hsb})),this.Lm.undo()),this.ove.UDn(this.WL),this.lh.ed?(this.hw=this.Kc.Pc(15),this.hw.Qj=this.actionId,this.hw.Db(this.lh.ed),this.jz=1):(this.Iaa.fail("Interactive view has null target node",!0),this.qr=8,this.jz=4))}process(){if(!this.GC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.WL,this.hsb,this.Pe.jG);y.ULS.shipAssertTag(6305507,307,!this.Pka);this.Pka=new N.a(this._context,this.WL,this.Iaa,this.n$,this.VL,void 0,this.Pe.jG,this.lmk,
this.e7);let T;T=this.WL&65536?Object(v.a)(this.DNg,this.DNg.process,"process"):this.WL&64?Object(v.a)(this.FNg,this.FNg.process,"process"):this.WL&1?Object(v.a)(this.nve,this.nve.process,"process"):Object(v.a)(this.ENg,this.ENg.process,"process");this.WL&16&&this.lh.mb.Lza.c1h();this.YMa.create(this,T,this.Pka).Ml("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.GC);this.GC.run();this.GC.inProgress||(this.iFd(),this.jz=this.Hh?2:3)}XFo(){this.Pka.Occ&&(this.hw.Qj=F.a.typing);this.Pka.bWc&&
this.hw.HGa(this.Pka.Mzf,this.Pka.aTf);this.hw.dispose();this.qr=this.Pka.failed?8:32;this.jz=4}UFo(){if(this.GC){if(this.GC.run(),this.GC.inProgress)return}else if(this.Pka.Occ&&(this.hw.Qj=F.a.typing),this.hw.iIa(this),this.Pka.bWc&&this.hw.HGa(this.Pka.Mzf,this.Pka.aTf),this.hw.dispose(),this.YXe)return;this.qr=this.Pka.failed?8:32;this.jz=4}finish(){this.a_.oic(Object.assign(new J.a,{JVc:!1}));this.hra();32===this.response?y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",
+this.endTime-+this.startTime,this.WL,this.hsb,this.Pe.jG):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.WL,this.hsb,this.Pe.jG);this.Sfa.aha(this.Iaa);(W.vOn||W.Neg)&&this.c2m()}o2d(){const T=!!(this.WL&1),Y=this._context.view;Y&&O.a.o2d(T,Y.mb,this.Pe.jG)}c2m(){if(!(this.WL&4||this.WL&64)){var T=new Map;T.set("isCopy",String.format("{0}",!!(this.WL&16)));T.set("isIPad",String.format("{0}",this.Pe.ri));W.Neg?
(T.set("SkipAria","false"),T.set("ErrorLevel","info"),this.og.logKpiUsage({kpiName:O.a.zEd,kpiType:0,optionalProperties:{extendedProperties:T},blockFutureEmissionDurationInMs:0})):f.Health.instance.recordKpiUsage(O.a.zEd,0,O.a.AEd,T);this.mT||(W.Neg?(T.set("SkipAria","false"),T.set("ErrorLevel","info"),this.og.logKpiFailure({kpiName:O.a.zEd,errorName:O.a.YAh,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:T}},blockFutureEmissionDurationInMs:0})):(T=Object.assign(new V.a,
{extendedProperties:T}),f.Health.instance.recordKpiFailure(O.a.zEd,O.a.YAh,!0,!0,T)))}}static get vOn(){null==W.NOe&&(W.NOe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return W.NOe}static get Neg(){null==W.o3&&(W.o3=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return W.o3}static I4f(T,Y,ba,Z){T&&T.Yb(H.a.Ye,{["Reason"]:ba});Y&&Y.fail(Z,!0)}static Tzh(T,Y,ba=null,Z=null,ea=!0){return T.view.qe?T.view.mb?
!ea||Y.FSa&&Y.FSa.lb&&Y.FSa.length?!0:(W.I4f(ba,Z,L.a.noSelection,"Paste target is invalid"),!1):(W.I4f(ba,Z,L.a.noSelection,"No selection manager"),!1):(W.I4f(ba,Z,L.a.ALb,"Not in interactive view"),!1)}}W.NOe=null;W.o3=null;Object(D.a)(W,"ClipboardOperation",I.a,[])},1694:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.paste=1]="paste";f[f.Vqp=2]="textOnly";f[f.NYi=4]="overtype";f[f.copy=16]="copy";f[f.Aep=32]="deleteSelection";f[f.move=64]="move";f[f.$rp=256]="useSystemClipboard";
f[f.Ygp=512]="forceInternalClipboard";f[f.ZSa=4096]="reformatPastedContent";f[f.zmp=8192]="pasteAsPlainText";f[f.qie=65536]="showPlaceholderGlossary";f[f.gnp=131072]="reformatPastedContentWithDesignerPaste";f[f.$kp=262144]="noSpacesAdjustment";f[f.YMi=524288]="mergeAfterPaste"})(l||(l={}));Object(D.b)("ClipboardActionFlags",l)},1697:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||
m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1860),I);f(c(1861),I)},1698:function(D,I,c){c.r(I);c.d(I,"FootnoteEndnoteDefaultContentInserter",function(){return H});D=c(0);var l=c(22),f=c(60),a=c(2),k=c(36),x=c(546),y=c(26),m=c(6),
r=c(16),z=c(54),v=c(1195),G=c(887),F=c(1629);class H{constructor(L,J,M,P,N=null){this.Zc=L;this.ZWj=J;this.hm=M;H.mh=P;this.lPg=N||H.A$k}get xL(){return null!=this.kDg?this.kDg:this.kDg=l.a.instance.resolve("Box4.IOutlineEditor")}E8k(L,J){var M=this.Zc.yk();M.set(L);this.xL.akb(M,null,!0);H.mh.SPb(M.currentNode,this.hm);L=k.OutlineElementNavigator.Ce(M);H.T5.X8c(J?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,L);M=this.lPg(M.currentNode);H.ig.Ge(M,H.dPh);
this.NBm(L,J)}NBm(L,J){var M=this.ZWj(131073);M.setValue(m.a.Is,1===J?36:35);M.setValue(m.a.Yma,!0);M.setValue(r.a.N$,!0);const P=L.Lc.Su(M,f.a.create());M=this.lPg(L);H.ig.Uha(M,N=>G.a.getInstance(N,P,!0),F.a.b5h(L,J))}static Wl(){return new H(new x.a,Object(z.a)(v.a.instance,v.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get T5(){return null!=H.FFg?H.FFg:H.FFg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get ig(){return null!=
H.uvg?H.uvg:H.uvg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=H.yBg?H.yBg:H.yBg=H.Wl()}static A$k(L){return y.a.Oc(L,0)}}H.dPh=" ";H.mh=null;Object(D.a)(H,"FootnoteEndnoteDefaultContentInserter",null,[459])},1699:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(546),f=c(533),a=c(1551),k=c(1629);class x{constructor(y,m){this.Tsa=m}yUd(y,m,r){return(y=this.Tsa.qbi(y.node,r?y.cpBegin:y.cpEnd,m))?y.v4():null}Tji(y,m){return(y=this.Tsa.I8l(y.node,
y.cpBegin,m))?y.v4():null}static LPc(){return new x(f.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.WAg?x.WAg:x.WAg=x.LPc()}}Object(D.a)(x,"FootnoteEndnoteNavigator",null,[441])},1711:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(1774),f=c(2),a=c(50),k=c(22);class x{constructor(y,m,r,z,v,G){this.sta=y;this.tta=m;this.YCe=r;this.xZ=z;this.ajd=v;this.cUb=G}get wqj(){return!this.tta&&!this.YCe}get lRi(){return 2===this.cUb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get JWh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get foi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get wjb(){return CommonUIStrings.l_OICErrorHelpLink}get Vmi(){return"OICFailure"}get icon(){return 3}get Xzd(){return 2===this.cUb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}jNn(y){this.yRi(y)}lZm(y){this.yRi(y)}yRi(y){let m=
10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").aJf(this.cUb),m=3):2===y&&((!this.YCe||this.YCe(this.xZ))&&this.tta&&l.a.instance.Qal(this.tta,this.sta,this.xZ),m=5);(0===y||1===y)&&this.sta&&this.sta(this.xZ);f.AFrameworkApplication.u6c(a.a.bYi,this.ajd,m);this.dispose()}dispose(){this.xZ=this.tta=this.sta=null}}Object(D.a)(x,"AOICErrorDialogWithTrial",null,[10])},1772:function(D,I,c){D=c(0);var l=c(2),f=c(20),a=c(22),k=c(753),x=c(1557),y=c(35);class m{constructor(va,La=null){this.Y$j=
va;this.z3=La||x.a.Hpf(f.a.gBb,"")}get Oy(){return this.Y$j}get Ic(){return this.z3}wcg(va){this.Ic.d++;return this.Oy.wcg(va)}Lkc(va){this.Ic.e++;return this.Oy.Lkc(va)}EL(va){this.Ic.f++;return this.Oy.EL(va)}qpb(va){this.Ic.h++;return this.Oy.qpb(va)}H5(va){this.Ic.i++;return this.Oy.H5(va)}Oja(va){this.Ic.j++;return this.Oy.Oja(va)}pIa(va){this.Ic.k++;return this.Oy.pIa(va)}jra(va){this.Ic.l++;return this.Oy.jra(va)}Ufe(va){this.Ic.m++;return this.Oy.Ufe(va)}OTa(va,La=!1){this.Ic.n++;return this.Oy.OTa(va,
La)}Hwf(){this.Ic.o++;return this.Oy.Hwf()}zgg(){this.Ic.p++;return this.Oy.zgg()}Xv(va){this.Ic.q++;return this.Oy.Xv(va)}oza(va){this.Ic.r++;return this.Oy.oza(va)}Akc(va){this.Ic.g++;return this.Oy.Akc(va)}Z8c(va){return this.Oy.Z8c(va)}upb(va){this.Ic.s++;return this.Oy.upb(va)}Dge(va){this.Ic.s++;return this.Oy.Dge(va)}Xaf(va){this.Ic.ba++;return this.Oy.Xaf(va)}Afe(va){this.Ic.s++;return this.Oy.Afe(va)}spb(va){this.Ic.s++;return this.Oy.spb(va)}ZPb(va){this.Ic.t++;return this.Oy.ZPb(va)}Vge(va){this.Ic.u++;
return this.Oy.Vge(va)}Lja(va){this.Ic.v++;return this.Oy.Lja(va)}odg(va){this.Ic.bb++;return this.Oy.odg(va)}y$(va){return this.Oy.y$(va)}t$(va){this.Ic.z++;return this.Oy.t$(va)}R8f(){return this.Oy.R8f()}bea(va,La){this.Ic.w++;this.Ic.x++;return this.Oy.bea(va,La)}jD(va){this.Ic.y++;return this.Oy.jD(va)}JC(){return this.Oy.JC()}clone(){return new m(this.Oy.clone(),this.Ic)}}Object(D.a)(m,"FormattingStewardUsageCollector",null,[191]);class r extends m{constructor(va,La=null){super(va,La)}get K9(){return this.Oy}get ww(){return this.K9.ww}set ww(va){this.K9.ww=
va}get textIndent(){return this.K9.textIndent}get marginLeft(){return this.K9.marginLeft}get kmc(){return this.K9.kmc}get cS(){return this.K9.cS}get lineSpacing(){return this.K9.lineSpacing}get O5(){return this.K9.O5}get leftIndent(){return this.K9.leftIndent}get Dda(){return this.K9.Dda}get paragraph(){return this.K9.paragraph}set paragraph(va){this.K9.paragraph=va}get jR(){return this.K9.jR}get umc(){return this.K9.umc}dme(va){return this.K9.dme(va)}pmg(va){return this.K9.pmg(va)}clone(){const va=
this.Oy.clone();return new r(va,this.Ic)}}Object(D.a)(r,"FormattingStewardUsageCollector",m,[576,191]);var z=c(8),v=c(375),G=c(871),F=c(36),H=c(206),L=c(83),J=c(40),M=c(60),P=c(354),N=c(136),K=c(19),O=c(86),V=c(55),W=c(16),T=c(6),Y=c(46),ba=c(115),Z=c(593),ea=c(355),ha=c(142),la=c(59),ia=c(98),sa=c(186),Oa=c(1621),Ra=c(148),Na=c(26),Da=c(1406),ra=c(886);class xa{constructor(va,La,za,Ca,ua,ib,bb,mb,yb,ab,Ga=null){var Za;this.tE=this._paragraph=null;this.xsd=0;this.VMg=this.ysd=null;this.Faa=0;this.xxb=
this.umc=this.leftIndent=this.O5=this.Wxc=this.cS=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=va;this.Be=La;this.Yu=za;this.nz=Ca;this.vK=ua;this.MWb=ib;this.ola=bb;this.vVb=mb;this.MWa=yb;this.Aub=ab;Ga?(y.a(4223818,307,!!Ga.tE),this.tE=Ga.tE.dna(this.paragraph),this.xsd=Ga.khc,this.ysd=Ga.wZf,Ga.cS&&(this.cS=new Da.a,this.cS.afterSpacing.value=Ga.cS.afterSpacing.value,this.cS.beforeSpacing.value=Ga.cS.beforeSpacing.value,null===(Za=l.AFrameworkApplication.K)||void 0===Za?
0:Za.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.cS.afterSpacing.unit=Ga.cS.afterSpacing.unit,this.cS.beforeSpacing.unit=Ga.cS.beforeSpacing.unit),Ga.lineSpacing&&(this.Wxc=Ga.lineSpacing.clone()),this.Faa=Ga.Faa,this.umc=Ga.umc.clone(),this._textIndent=Ga.textIndent,this._marginLeft=Ga.marginLeft,this._tabStops=Ga.kmc,this.O5=Ga.O5,this.leftIndent=Ga.leftIndent,Ga.Dda&&(this.xxb=Ga.Dda)):(this.tE=new sa.a(this.paragraph,0),this.tE.formatting=
new Ra.a(this.tE,M.a.nil),La=Na.a.rw(va),La=this.vK.Vr(La),this.gfo(La),this.Hso(va)?(this.MWb.Bgo(this.tE.formatting,La),va.hasProperty(W.a.Ih)?this.Faa=va.getValue(W.a.Ih):this.Faa=0):this.Faa=-1,this.xsd=0,this.cS=this.ysd=null,this.Aub&&(this.cS=this.MWb.hFa(va),this.Wxc=this.MWb.XFb(va),this.O5=this.MWb.n$b(va),this.leftIndent=this.MWb.nU(va)),this.umc=new P.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(va){y.a(4223816,307,!!va&&z.ParagraphReader.Wb(va));this._paragraph=
va}get jR(){return this.tE.formatting}get khc(){return this.xsd}get wZf(){return this.ysd}get nw(){return this.VMg}get ww(){return this.Faa}set ww(va){y.a(4223817,307,1===va||2===va||3===va||6===va);this.Faa=va}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get kmc(){return this._tabStops}get lineSpacing(){return this.Wxc}get Dda(){return this.xxb}get uc(){return this.nz}gfo(va){const La=this.vK.language(va);La&&this.Be.xcg(this.tE.formatting,La,0,va.cache.ZIb,!1)}Hso(va){va=
this.uc.wg(this.uc.Ro(va));return va===la.StyleReader.ape||va===la.StyleReader.wordStyleIdNormal||va===la.StyleReader.Uoc||va===la.StyleReader.styleIdNormal}wcg(va){(va=k.a.qg(va))&&this.Be.jge(this.tE.formatting,va.LCID);return!0}Lkc(){return!1}EL(va){this.Be.EL(this.tE.formatting,va);return!0}qpb(va){this.Be.Wy(this.tE.formatting,va);return!0}H5(va){this.Be.H5(this.tE.formatting,va);return!0}Oja(va){this.Be.Oja(this.tE.formatting,va);return!0}pIa(va){this.Be.pIa(this.tE.formatting,va);return!0}jra(va){this.Be.jra(this.tE.formatting,
va);return!0}Ufe(va){if(0>=va)return!1;this.Be.WA(this.tE.formatting,va);return!0}OTa(va,La){if(!va||""===va)return!1;if(({z0h:za}=N.FontUtils.BBj(va)).returnValue)return this.Be.Kja(this.tE.formatting,za.fontName),!0;var za=!1;const Ca=N.FontUtils.dSa(va);La&&this.klb(Ca,this.ola)&&(this.ola.rna(va),za=!0);if(this.klb(Ca,this.vVb)||this.klb(Ca,this.MWa))za=!0;za&&this.Be.Kja(this.tE.formatting,Ca);return za}klb(va,La){return!!La&&La.isEnabled&&La.klb(va)}Hwf(){this.Be.qki(this.tE.formatting);return!0}zgg(){this.Be.Arj(this.tE.formatting);
return!0}Xv(va){var {Box4PasteSteward:La}=c(1522);if(null===va||""===va)return!1;va=La.rCb(va);La=null;this.Dda&&this.Dda.hasOwnProperty(T.a.listLevel.id.toString())&&(La=this.Dda[T.a.listLevel.id.toString()]);this.Be.Xv(this.tE.formatting,va,La);return!0}oza(va){const {Box4PasteSteward:La}=c(1522);if(!va||""===va||!xa.Wjm().contains(va))return!1;this.Be.oza(this.tE.formatting,La.rCb(va));return!0}Akc(va){this.Be.Akc(this.tE.formatting,va);return!0}Z8c(va){let La=0;switch(K.a.Zg(va)){case "small-caps":La=
1;break;case "uppercase":La=2}this.Be.Yl(this.tE.formatting,Y.a.capitalization,La);return!0}t$(va){const {Box4PasteSteward:La}=c(1522);if(!va||""===va)return!1;this.umc.setValue(W.a.QK,parseInt(La.rCb(va),16));return!0}spb(va){return 0>=va?!1:this.Dge(this.uc.vdm(va))}upb(va){this.JC();this.xsd=va;return!0}Xaf(va){var {Box4PasteSteward:La}=c(1522),za=new Map;za.set("Source","CreateStyleCCP_FormattingSteward");O.Health.instance.recordKpiUsage(ha.a.FJj,0,ha.a.xB,za);za=ia.a.sdm(va);va=[];va.push(za);
(va=ia.a.cFc(va,this.paragraph))?(La.emc=this.uc.yr(),y.b(593078085,3017,50,"Custom style created via paste.")):(La=new Map,La.set("Source","CreateStyleCCP_FormattingSteward"),La.set("IsStyleNull",(!za).toString()),La=Object.assign(new ba.a,{extendedProperties:La}),O.Health.instance.recordKpiFailure(ha.a.FJj,"UnableToCreateStyle",!1,!0,La));return va}Dge(va){const {Box4PasteSteward:La}=c(1522);return va&&0<va.length&&La.emc&&La.emc.jj(va)?(this.ysd=va,!0):!1}Afe(va){const {Box4PasteSteward:La}=c(1522);
return va&&0<va.length&&La.emc&&La.emc.jj(va)?(this.VMg=va,!0):!1}pmg(va){if(this.nw){va=this.uc.ZC(va);if(!va)return y.a(41968715,307,!1),!1;(va=va.jj(this.nw))&&this.Be.E7a(this.tE.formatting,va);return!0}return!1}bea(va,La){this.cS=new Da.a;this.cS.beforeSpacing=this.ojo(va);this.cS.afterSpacing=this.njo(La);return!0}ojo(va){return new ra.a(4,va)}njo(va){return new ra.a(4,va)}jD(va){if(!va)return!1;const La=parseFloat(K.a.substring(va,0,K.a.Zg(va).indexOf("px")));if(!isNaN(La))return this.Wxc=
new ra.a(3,V.a.Sy(La,1)),!0;va=parseFloat(K.a.substring(va,0,K.a.Zg(va).indexOf("%")));return isNaN(va)?!1:(this.Wxc=new ra.a(2,va/100),!0)}ZPb(va){let La=0;if(!va||""===va)return!1;switch(va){case "left":La=1;break;case "center":La=2;break;case "right":La=3;break;case "justify":La=6}if(!La)return!1;this.ww=La;return!0}Vge(va){this._textIndent=va;return!0}Lja(va){this._marginLeft=va;return!0}odg(va){this._tabStops=va;return!0}y$(va){this.xxb=JSON.parse(va);return this.Dda?!0:!1}JC(){this.tE.formatting=
new Ra.a(this.tE,M.a.nil);return!0}R8f(){this.Faa=0;return!0}dme(va){var {Box4PasteSteward:La}=c(1522);if(0<this.khc&&La.X5a[this.khc]){y.a(4223819,307,1<=this.khc);y.a(4223820,307,7>=this.khc);La=this.uc.ZC(va);if(!La)return y.a(4223821,307,!1),!1;La=La.jj(c(1522).Box4PasteSteward.X5a[this.khc]);this.Yu.YJ(La,va,!1);return!0}if(this.wZf){La=this.uc.ZC(va);if(!La)return y.a(41968716,307,!1),!1;La=La.jj(this.wZf);this.Yu.YJ(La,va,!1);return!0}return!1}clone(){return new xa(this.paragraph,this.Be,this.Yu,
this.nz,this.vK,this.MWb,this.ola,this.vVb,this.MWa,this.Aub,this)}static Wjm(){xa.o_||(xa.o_=new Z.a(ea.a.jh()),xa.o_.add(Oa.a.yellow),xa.o_.add(Oa.a.vZm),xa.o_.add(Oa.a.VEk),xa.o_.add(Oa.a.ZHl),xa.o_.add(Oa.a.blue),xa.o_.add(Oa.a.red),xa.o_.add(Oa.a.Ndn),xa.o_.add(Oa.a.Gwj),xa.o_.add(Oa.a.green),xa.o_.add(Oa.a.purple),xa.o_.add(Oa.a.Z8m),xa.o_.add(Oa.a.Chn),xa.o_.add(Oa.a.gray),xa.o_.add(Oa.a.nxo),xa.o_.add(Oa.a.black));return xa.o_}}xa.o_=null;Object(D.a)(xa,"FormattingSteward",null,[576,191]);
class fa{ymg(){return!1}axf(va){return va}gxf(){}y$(){}oge(){}kZd(){return!1}get u_d(){return!1}jD(){}bea(){}Mge(){}get ypj(){return!1}}Object(D.a)(fa,"NoOpPasteStewardBridge",null,[552]);var oa=c(75);class ta{constructor(va,La){this.Hfn=va;this.Ifn=La||"Normal"}}Object(D.a)(ta,"NoteTagInfoBox4",null,[]);c.d(I,"a",function(){return Ka});class Ka{constructor(va,La,za=null,Ca=null){this.DFl=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.q$g=0;this.zc=va;this.f7=La;this.wZ=
Ca||new fa;this.Ic=za||x.a.Hpf(f.a.gBb,"")}get ig(){return null!=this.mvg?this.mvg:this.mvg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.xyg?this.xyg:this.xyg=a.a.instance.Oa("Box4.IFontService")}get cEa(){return null!=this.uwg?this.uwg:this.uwg=a.a.instance.Oa("Box4.CustomFontService")}get Gsl(){return null!=this.Vwg?this.Vwg:this.Vwg=a.a.instance.Oa("Box4.IEmbeddedFontService")}reset(){}get FKc(){return this.Fof(!1)}Fof(va){y.a(4223770,307,J.OutlineElementReader.Bh(this.zc));
const La=F.OutlineElementNavigator.Ce(this.zc);F.OutlineElementNavigator.Wd(this.zc);y.a(4223771,307,!!La&&z.ParagraphReader.Wb(La));va=new xa(La,Ka.Xn,Ka.qE,Ka.uc,Ka.M8,Ka.oHl,this.fontService,this.cEa,this.Gsl,this.DFl,void 0,va);return new r(va,this.Ic)}wda(){}vda(){}snb(){}hya(){}cHa(){}kSa(){}jSa(){}fE(){}tF(){}nnb(){}mnb(){}pSa(){}J5a(){}lya(){}jya(){}hHa(){}kya(){}L5a(){}xfc(va){J.OutlineElementReader.Bh(this.zc)?(Ka.Yf.Zoa(this.zc,!0),F.OutlineElementNavigator.$r(this.zc,!1,!1)):L.OutlineReader.ix(this.zc)?
H.OutlineNavigator.I9(this.zc)?va?(this.zc.vg(),Ka.xL.P7(this.zc,!1)):Ka.Yf.vOb(this.zc):Ka.xL.P7(this.zc,!1):y.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zc.Ue)}qQc(va){let La=null;if(va&&va.V9&&va.cultureName)try{La=Object.assign(new G.a,{languageId:k.a.qg(va.cultureName).LCID})}catch(za){y.a(8128526,307,!1,"Setting up culture {0} encountered {1}",va.cultureName,za)}La||null==this.f7||(La=Object.assign(new G.a,{languageId:this.f7}));return La}get aV(){return this.q$g}set aV(va){this.q$g=
va}rCd(){}wbd(){}a7e(){}get Y4b(){return!1}get eDb(){return!1}YZm(va){var La=1;if(va.gyi){var za=0;switch(va.listStyleType){case 1:La=0;break;case 7:La=1;break;case 8:La=2;break;case 9:La=3;break;case 10:La=4;break;case 11:La=5}}else switch(za=1,va.listStyleType){case 1:La=0;break;case 3:La=1;break;case 4:La=2;break;case 5:La=3}var Ca=v.a,ua=Ca.V_,ib=va.uya;const bb=new oa.a;for(const mb of ib)ib=new ta(mb.Hfn,mb.Ifn),bb.add(ib);Ca=ua.call(Ca,za,La,bb,va.listId,va.listLevel,va.levelText,va.font);
3!==va.Zr&&(Ca.e6=va.Zr);va.gyi&&!va.Uti&&(Ca.dC=0<va.listId&&0<=va.listLevel&&!va.nhc?va.Olc:va.$el);!Ca.Kz||3!==Ca.listStyle&&5!==Ca.listStyle||(Ca.ww="right");(va=va.TJf)&&Ca.propertySet.Yw(va);Ca.o8b=!0;this.wZ.oge(this.zc);return Ca}R9(){}P9(){}k5(){}Q9(){}O9(){}N9(){}static get Yf(){return null!=Ka.BDg?Ka.BDg:Ka.BDg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get xL(){return null!=Ka.qDg?Ka.qDg:Ka.qDg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Xn(){return null!=Ka.Yyg?
Ka.Yyg:Ka.Yyg=a.a.instance.resolve("Box4.IFormattingEditor")}static get qE(){return null!=Ka.hIg?Ka.hIg:Ka.hIg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get uc(){return null!=Ka.LIg?Ka.LIg:Ka.LIg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get M8(){return null!=Ka.bzg?Ka.bzg:Ka.bzg=a.a.instance.resolve("Box4.IFormattingReader")}static get oHl(){return null!=Ka.czg?Ka.czg:Ka.czg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}Ka.Ef=null;Object(D.a)(Ka,
"Box4PasteStewardBase",null,[560,180,181])},1774:function(D,I,c){D=c(0);var l=c(54),f=c(7),a=c(2),k=c(50),x=c(464),y=c(22);class m{constructor(P,N,K,O){this.gJe=null;this.ajd=O;this.sta=P;this.tta=N;this.xZ=K;this.Xeh=this.UKb.yqo;P=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.L9j=P[0];this.K9j=P[1]}get UKb(){return this.gJe||(this.gJe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get wjb(){return CommonUIStrings.l_OICErrorHelpLink}get D9c(){return this.Xeh}get qLi(){return this.L9j}get pLi(){return this.K9j}get oLi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Xeh?
3:2}get KMc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get XGd(){return!!this.tta}get LMc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}o4f(P){this.T0c(P)}GJf(P){this.T0c(P)}T0c(P){let N=10;this.tta&&1===P&&(this.tta(this.xZ),N=1);this.sta&&this.sta(this.xZ);this.lN(N)}HLb(){x.Redirect.showHelp("OICFailure");this.lN(2)}sTf(){this.UKb.SEi();this.lN(4)}lN(P){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.ajd,P);a.AFrameworkApplication.u6c(k.a.$Xi,this.ajd,P)}dispose(){this.xZ=this.sta=this.tta=null}}Object(D.a)(m,"AOICErrorDialog",null,[10]);var r=c(38),z=c(177);class v extends m{constructor(P,N,K,O){super(P,N,K,O);this.Ybb=this.OF=null;P=document.createElement("span");P.id="errorMessageText";P.innerText=this.errorMessage;P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));this.OF=document.createElement("a");this.OF.href="#";this.OF.innerText=this.wjb;P.appendChild(this.OF);
r.a.addHandler(this.OF,"click",Object(l.a)(this,this.HLb,"oicErrorHelpLinkHandler"));N=new z.StandardDialog;N.ug=this.id;this.D9c?(K=document.createElement("span"),O=document.createElement("span"),K.innerText=this.qLi,O.innerText=this.pLi,this.Ybb=document.createElement("a"),this.Ybb.href="#",this.Ybb.innerText=this.oLi,P.appendChild(document.createElement("br")),P.appendChild(K),P.appendChild(this.Ybb),P.appendChild(O),r.a.addHandler(this.Ybb,"click",Object(l.a)(this,this.sTf,"oicErrorMacOfferLinkHandler"))):
this.XGd&&(P.appendChild(document.createElement("br")),P.appendChild(document.createElement("br")),K=document.createElement("span"),K.innerText=this.KMc,P.appendChild(K));this.XGd?(N.Cd=1,N.xe(1,this.LMc)):N.Cd=0;N.pv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.GJf,"legacyOICErrorDialogHandler"),P);N.C5("errorMessageText")}dispose(){this.OF&&(r.a.removeHandler(this.OF,"click",Object(l.a)(this,this.HLb,"oicErrorHelpLinkHandler")),this.OF=null);this.Ybb&&(r.a.removeHandler(this.Ybb,"click",
Object(l.a)(this,this.sTf,"oicErrorMacOfferLinkHandler")),this.Ybb=null);super.dispose()}}Object(D.a)(v,"OICErrorDialog",m,[]);class G{constructor(P,N,K){this.sta=N;this.tta=P;this.xZ=K}get id(){return"OICErrorDialogWithDownload"}get KWh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get wjb(){return CommonUIStrings.l_OICErrorHelpLink}get KMc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get LMc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}o4f(P){this.T0c(P)}GJf(P){this.T0c(P)}T0c(P){let N=
10;1===P&&(this.tta(this.xZ),N=1);this.sta&&this.sta(this.xZ);this.lN(N)}HLb(){x.Redirect.showHelp("OICFailure");this.lN(2)}lN(P){a.AFrameworkApplication.u6c(k.a.aYi,3,P)}dispose(){this.xZ=this.tta=this.sta=null}}Object(D.a)(G,"AOICErrorDialogWithDownload",null,[10]);class F extends G{constructor(P,N,K){super(P,N,K);this.OF=null;P=document.createElement("span");P.id="errorMessageText";P.innerText=this.KWh;P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));this.OF=
document.createElement("a");this.OF.href="#";this.OF.innerText=this.wjb;P.appendChild(this.OF);r.a.addHandler(this.OF,"click",Object(l.a)(this,this.HLb,"oicErrorHelpLinkHandler"));P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));N=document.createElement("span");N.innerText=this.KMc;P.appendChild(N);N=new z.StandardDialog;N.ug=this.id;N.Cd=1;N.xe(1,this.LMc);N.pv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.GJf,"legacyOICErrorDialogHandler"),P);N.C5("errorMessageText")}dispose(){this.OF&&
(r.a.removeHandler(this.OF,"click",Object(l.a)(this,this.HLb,"oicErrorHelpLinkHandler")),this.OF=null);super.dispose()}}Object(D.a)(F,"OICErrorDialogWithDownload",G,[]);var H=c(168);class L extends m{constructor(P,N,K,O){super(P,N,K,O);N={["errorMessage"]:this.errorMessage};N.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.wjb,["onExecute"]:V=>{this.HLb(V)}};this.D9c?(N.macOfficePreLinkText=this.qLi,N.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.oLi,
["onExecute"]:V=>{this.sTf(V)}},N.macOfficePostText=this.pLi):this.XGd&&(N.errorFileDownloadOffer=this.KMc);P=new H.a(!1,!1,!0);this.XGd?(P.Cd=1,P.xe(1,this.LMc)):P.Cd=0;P.ug=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};P.Qh(this.dialogTitle,Object(l.a)(this,this.o4f,"reactOICErrorDialogHandler"),N)}}Object(D.a)(L,"ReactOICErrorDialog",m,[]);class J extends G{constructor(P,N,K){super(P,N,K);N={["errorMessage"]:this.KWh,["errorFileDownloadOffer"]:this.KMc};N.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.wjb,["onExecute"]:O=>{this.HLb(O)}};P=new H.a(!1,!1,!0);P.Cd=1;P.xe(1,this.LMc);P.ug=this.id;N={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:N};P.Qh(this.dialogTitle,Object(l.a)(this,this.o4f,"reactOICErrorDialogHandler"),N)}}Object(D.a)(J,"ReactOICErrorDialogWithDownload",G,[]);c.d(I,"a",function(){return M});class M{constructor(){this.JLa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Lb.pF}Pal(P,N,K){this.JLa?new L(P,N,null,K):new v(P,N,null,
K)}Qal(P,N,K){this.JLa?new J(P,N,K):new F(P,N,K)}Ral(P,N,K,O,V){const {ReactOICErrorDialogWithTrial:W}=c(1875),{OICErrorDialogWithTrial:T}=c(1876);this.JLa?new W(P,N,K,null,O,V):new T(P,N,K,null,O,V)}static get instance(){return M._instance||(M._instance=new M)}}M._instance=null;Object(D.a)(M,"OICErrorDialogFactory",null,[995])},1775:function(D,I,c){c.r(I);D=c(0);var l=c(307),f=c(1854),a=c(953),k=c(354),x=c(2),y=c(60),m=c(353),r=c(22),z=c(127),v=c(101),G=c(79),F=c(1452),H=c(190),L=c(39),J=c(20),M=
c(269),P=c(155),N=c(7),K=c(247),O=c(110),V=c(69),W=c(304),T=c(12),Y=c(26),ba=c(3),Z=c(9),ea=c(133),ha=c(531),la=c(48),ia=c(1693),sa=c(1692),Oa=c(339),Ra=c(295);class Na extends Ra.a{constructor(za,Ca,ua,ib,bb,mb){super();this.init(za);this.Ml("DummyClipboardOperation");this.Ujb(x.AFrameworkApplication.va,Ca,ib,bb,mb);this._context=ua;this.qr=8;this.hra()}run(){this.ubb=!0;this.t8c(this._context);this.n6a();this.qr=32}}Object(D.a)(Na,"DummyClipboardOperation",Ra.a,[]);Ra=c(1586);class Da extends Ra.a{constructor(za,
Ca,ua,ib,bb){super(za,Ca,bb);this.hk=ua;this.ERe=ib}Lnc(za){let Ca;if(this.qT&&!za)return N.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Ova:null};Ca=null;if(this.ERe&&!this.qT){const ua=this.properties.ja(P.a.B_i,"");ua&&(Ca=this.hk.Onb(ua))}Ca||(Ca=this.hk.Onb(za));return{returnValue:!0,Ova:Ca}}}Object(D.a)(Da,"HtmlStringImportStrategy",Ra.a,[]);var ra=c(1855);class xa extends ra.a{constructor(za,Ca,ua,ib,bb){super(za,Ca,ua,ib,bb)}ddi(){return this.properties.ja(P.a.QMb,
"")}Lnc(za){x.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.ifh){if(this.hk)return za=this.hk.JZf(za,!0),{returnValue:!0,Ova:za};N.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Lnc(za)}hZc(za){za=super.hZc(za);return za.length&&" "!==za?za:"\u00a0"}}Object(D.a)(xa,"MultiLinePlainTextImportStrategy",ra.a,[]);class fa extends Ra.a{constructor(za,Ca,ua){super(za,Ca,ua)}Lnc(za){({ClipboardActor:Ca}=
c(1775));if(this.qT&&!za)return N.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Ova:null};var Ca=Ca.mzn;Ca.innerText=za;return{returnValue:!0,Ova:Ca}}}Object(D.a)(fa,"PlainTextImportStrategy",Ra.a,[]);var oa=c(81),ta=c(61);class Ka{constructor(za){this.P4=this.KFf=!1;this.Qfa=za}H1i(){this.KFf||(this.KFf=!0,this.P4=!1,this.Qfa.oNb(()=>{this.P4=!0}));return this.P4}JAj(){this.KFf=!1;const za=this.Qfa.paste();return za?za.hasChildNodes()?{returnValue:!0,fHd:za}:(N.ULS.sendTraceTag(7891019,
307,50,"DOM innerText empty."),Ka.Hc.Yb(oa.a.U1,{["Reason"]:ta.a.Aif}),{returnValue:!1,fHd:za}):(N.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Ka.Hc.Yb(oa.a.jEb,{["Reason"]:ta.a.jjg}),{returnValue:!1,fHd:za})}static get Hc(){return H.a.instance}}Object(D.a)(Ka,"SystemClipboardImportStrategy",null,[531]);var va=c(251);c.d(I,"ClipboardActor",function(){return La});class La{get nEi(){return this.PLa}set nEi(za){this.PLa=za}constructor(za,Ca,ua,ib,bb,mb,yb,ab,Ga,Za,Ub,Xb,zb,Ib,$a,
Hb,Ya,Sa){this.zgd=null;this.PLa=0;this.Fld=this.fEc=!1;this.Lsb=l.a.On;this.a$c=()=>{const Eb=Array(1);Eb.push("PasteRecoveryFloatie");var Jb=this.Yck.FPa();Jb=Object.assign(new f.a,{x:Jb.x,y:Jb.y});this.YL.showFloatie(Jb,Eb,1);return 32};this.sHb=()=>{this.YL.C0&&this.YL.dismissFloatie();return 32};this.k4i=(Eb,Jb,vb,ac,dc)=>{if(1===vb)return 32;dc[a.a.On]=!1;return 32};this.Xql=(Eb,Jb,vb,ac,dc,Cc)=>{N.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Ec=Cc.DataTransfer;Cc=Ec.getData("text/html");
Ec=Ec.getData("text/plain");let rc=!1;const hb=new k.DictionaryPropertySet;0<Cc.length?(N.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),hb.setValue(P.a.IP,Cc),rc=!0):0<Ec.length&&(N.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),hb.setValue(P.a.QMb,Ec),rc=!0);if(rc){const fb=this.my.J(Jb);return this.DFd.create(Eb,Jb,fb,new K.a(()=>this.XKc(fb,hb)),vb,ac,dc,hb)}return null};this.B3f=(Eb,Jb,vb,ac,dc)=>{if(Jb="object"===typeof dc?dc:null)this.M_b?
this.geo(Eb,this.PLa,Jb):Eb===ba.a.Sae?(Eb=this.PLa!==ba.a.ZSa&&this.PLa!==ba.a.$Sa&&this.PLa!==ba.a.Oya,Jb[this.Lsb]=this.PLa===ba.a.ZSa||Eb):Eb===ba.a.Tae?Jb[this.Lsb]=this.PLa===ba.a.$Sa:Eb===ba.a.x3f&&(Jb[this.Lsb]=this.PLa===ba.a.Oya);return 32};this.pX=(Eb,Jb,vb,ac,dc,Cc)=>{if((x.AFrameworkApplication.UY||x.AFrameworkApplication.xF)&&!x.AFrameworkApplication.RDb||va.a.eia(vb)&&va.a.bcc())return new Na(Eb,Jb,vb,ac,dc,Cc);let Ec=this.my.J(Jb);1!==ac&&Ec&1&&(this.PLa=Jb);if(1!==ac){var rc=Object(O.a)(85,
Cc)?Cc:null;Cc?(Ec&1&&(this.zgd=rc),rc=rc?rc.ja(P.a.QY,0):0,Jb===ba.a.paste&&rc===ba.a.F_a?Ec=this.my.J(ba.a.F_):Jb===ba.a.Z9&&rc===ba.a.wBb&&(Ec=this.my.J(ba.a.I9d))):!Cc&&Ec&4096&&(Cc=this.zgd,rc=Object(O.a)(85,Cc)?Cc:null)&&(rc=rc.ja(P.a.Q2c,y.a.nil),N.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",rc))}return this.DFd.create(Eb,Jb,Ec,new K.a(()=>this.XKc(Ec,Cc)),vb,ac,dc,Cc)};this.UFn=(Eb,Jb,vb,ac,dc)=>this.i5e(Eb,Jb,vb,dc);this.TFn=(Eb,Jb,vb,ac,dc)=>this.i5e(Eb,
Jb,vb,dc);this.SFn=(Eb,Jb,vb,ac,dc)=>this.i5e(Eb,Jb,vb,dc);this.t4d=(Eb,Jb,vb,ac,dc,Cc)=>{Cc=Y.a.Oc(la.a.instance.hb.lb.Pa.node,Cc);return this.pX(Eb,Jb,vb,ac,dc,Cc)};this.lXj=za;this.Qfa=Ca;this.yd=ua;this.hk=ib;this.ga=mb;this.Ygd=Za;this.LUb=Ub;this.ze=Xb;this.ag=zb;this.Vb=Ga;this.L_b=Ib;this.M_b=$a;this.Yck=Hb;this.YL=Ya;this.VFe=Sa;this.og=m.a.getInstance(Oa.a.I_a);ab&&(this.fEc=ab.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.Fld=this.M_b&&ab.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));
this.my=new W.a;this.my.Z(ba.a.paste,257);this.my.Z(ba.a.Z9,8449);this.my.Z(ba.a.F_,1);this.my.Z(ba.a.o3a,1);this.my.Z(ba.a.DAb,1);this.my.Z(ba.a.VCa,1);this.my.Z(ba.a.BXd,513);this.my.Z(ba.a.ZSa,4097);this.my.Z(ba.a.$Sa,12289);this.my.Z(ba.a.Oya,131073);this.my.Z(ba.a.NZf,7);this.my.Z(ba.a.H9d,1);this.my.Z(ba.a.I9d,8193);this.my.Z(ba.a.copy,272);this.my.Z(ba.a.OGc,16);this.my.Z(ba.a.cut,304);this.my.Z(ba.a.i4e,48);this.my.Z(ba.a.s4d,64);this.my.Z(ba.a.t4d,64);this.my.Z(ba.a.qie,65536);this.my.Z(ba.a.Iff,
1);this.Fld&&this.my.Z(ba.a.Snb,this.my.J(ba.a.I9d))}get zUa(){return null!=this.ZFg?this.ZFg:this.ZFg=r.a.instance.Oa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.sGg?this.sGg:this.sGg=r.a.instance.Oa("Common.Utils.Telemetry.ITelemetry")}get DFd(){return this.lXj.value}get cEo(){return this.Qfa}Tb(){this.ga.fb(ba.a.xJn,T.a.application,this.k4i,97);this.ga.fb(ba.a.yJn,T.a.application,this.k4i,97);this.ga.fb(ba.a.Sae,T.a.application,this.B3f,97);this.ga.fb(ba.a.Tae,
T.a.application,this.B3f,97);this.ga.fb(ba.a.x3f,T.a.application,this.B3f,97);this.ga.vT(ba.a.i4e,T.a.view,this.pX,1028);this.ga.leb(ba.a.OGc,T.a.view,this.pX);this.ga.vT(ba.a.Iff,T.a.view,this.Xql,1028);this.ga.vT(ba.a.F_,T.a.view,this.pX,1028);this.ga.vT(ba.a.o3a,T.a.view,this.pX,1028);this.ga.vT(ba.a.DAb,T.a.view,this.pX,1028);this.ga.vT(ba.a.VCa,T.a.view,this.pX,1028);this.L_b&&this.ga.fb(ba.a.F_a,T.a.view,this.SFn,1028);this.M_b&&this.ga.fb(ba.a.wBb,T.a.view,this.TFn,1028);this.ga.vT(ba.a.paste,
T.a.view,this.pX,1028);this.ga.vT(ba.a.Z9,T.a.view,this.pX,1028);this.ga.vT(ba.a.I9d,T.a.view,this.pX,1028);this.ga.vT(ba.a.H9d,T.a.view,this.pX,1028);this.ga.vT(ba.a.NZf,T.a.view,this.pX,1028);this.ga.vT(ba.a.ZSa,T.a.view,this.pX,1028);this.ga.vT(ba.a.$Sa,T.a.view,this.pX,1028);this.ga.ra(ba.a.HOb,T.a.view,z.ActionManager.Lf);this.ga.ra(ba.a.I_i,T.a.view,z.ActionManager.Lf);this.ga.ra(ba.a.F_i,T.a.view,z.ActionManager.Lf);this.ga.ra(ba.a.G_i,T.a.view,z.ActionManager.Lf);this.ga.ra(ba.a.H_i,T.a.view,
z.ActionManager.Lf);this.ga.ra(ba.a.E_i,T.a.view,z.ActionManager.Lf);this.ga.leb(ba.a.s4d,T.a.view,this.pX);this.ga.leb(ba.a.t4d,T.a.view,this.t4d);this.ga.leb(ba.a.BXd,T.a.view,this.pX);this.ga.leb(ba.a.qie,T.a.view,this.pX);this.Fld&&(this.ga.fb(ba.a.kHc,T.a.view,this.UFn,1028),this.ga.vT(ba.a.Snb,T.a.view,this.pX,1028));this.ga.ra(ba.a.sNh,T.a.view,z.ActionManager.Lf);this.ga.ra(ba.a.WNh,T.a.view,z.ActionManager.Lf);this.VFe&&(this.ga.fb(ba.a.a$c,T.a.view,this.a$c,96),this.ga.fb(ba.a.sHb,T.a.view,
this.sHb,96))}u5(){if(this.Vb){const za=this.Vb.ae(ea.AppFrame.PD);this.Fld&&za.bindAction(v.KeyInputManager.ic(G.a.csb,v.KeyInputManager.Ph|4),ba.a.kHc)}else N.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}geo(za,Ca,ua){switch(Ca){case ba.a.$Sa:case ba.a.Z9:case ba.a.Snb:Ca=ba.a.Tae;break;case ba.a.Oya:Ca=ba.a.x3f;break;default:Ca=ba.a.Sae}ua[this.Lsb]=za===Ca}A7l(){const za=Object(O.a)(85,this.zgd)?this.zgd:null;return za?za.ja(P.a.Q2c,y.a.nil):
y.a.nil}i5e(za,Ca,ua,ib){if(1===ua){if(!Object(O.a)(ha.a,Ca)||!this.Ygd||va.a.eia(Ca)&&va.a.bcc())return 8;ua=new K.a(()=>this.XKc(this.my.J(ba.a.F_),ib));const bb=this.Ygd.create(ua,Object(V.a)(85,ib));ua=new sa.a(x.AFrameworkApplication.K,F.a.instance,ua,H.a.instance,bb,this.LUb);return ia.a.Tzh(Ca,ua)?32:8}if(2===ua){if(this.Apo(Z.App.MZa))return this.F_a(za);Z.App.zic(()=>{this.F_a(za)});return 32}return 2}F_a(za){if(!this.ze)return N.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),
8;var Ca=this.ze.xib();if(!Ca)return N.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ca=Ca.Vn;if(!Ca)return N.ULS.sendTraceTag(592454659,307,10,"No document"),8;N.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",za);this.og.logKpiUsage({kpiName:Oa.a.SNa});this.ag.Ysl(za);za=L.a.cEb(Ca,"paste");Ca=this.ag.oml();N.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",Ca);if(za)return N.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.og.logKpiSuccess({kpiName:Oa.a.SNa}),
32;this.Bmm();N.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.og.logKpiFailure({kpiName:Oa.a.SNa,errorName:"ExecCommandFailed"});return 8}Bmm(){this.zUa&&(this.zUa.DQb(),Oa.a.o2d(!0,la.a.instance,J.a.jG));if(this.telemetry){const za=this.telemetry.N$c();za.G2b("CallExecCommandPasteOperation");za.fail("call to execCommand('paste') failed",!0);this.telemetry.aha(za)}}Apo(za){let Ca=!1;this.Vb?this.Vb.currentScope?Ca=!this.Vb.mDf(this.Vb.currentScope.name):N.ULS.sendTraceTag(573388235,
307,10,"No CurrentScope"):N.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ca){N.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Vb.currentScope.name);if(1>za)return N.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Vb.Hkf();return!1}return!0}XKc(za,Ca){return za&256?new Ka(this.cEo):za&2?za&4096?new Da(Ca,this.yd,this.hk,Z.App.instance.XVc,Z.App.instance.dUa):new fa(Ca,this.yd,Z.App.instance.dUa):Ca.hasProperty(P.a.QMb)?new xa(Ca,this.yd,this.hk,
this.fEc,Z.App.instance.dUa):new Da(Ca,this.yd,this.hk,Z.App.instance.XVc,Z.App.instance.dUa)}static get mzn(){return M.a.pTd("Box4PasteScratchPad")}Szh(za,Ca,ua,ib){return!x.AFrameworkApplication.UY&&!x.AFrameworkApplication.xF||x.AFrameworkApplication.RDb?(za=this.pX(null,za?ba.a.cut:ba.a.copy,Ca,1,ua,ib))?za.response:8:8}}Object(D.a)(La,"ClipboardActor",null,[])},1792:function(D,I,c){c.r(I);D=c(0);var l=c(19),f=c(2046),a=c(1832);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}
Object(D.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);var x=c(2047),y=c(1622),m=c(8),r=c(74),z=c(16),v=c(7),G=c(1681);c.d(I,"ACommentFormatTranslator",function(){return F});class F{constructor(H){this.Mg=H}bCk(H,L){const J=m.ParagraphReader.text(L);let M=null,P=null,N=null,K=0;var O=0,V=!1;let W="";for(L.qa||J&&J.length&&"\n"!==J||v.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");K<L.qa.length;){const Y=L.qa.J(K),ba=Y.cp;var T=Y.formatting?Y.formatting.En:
null;W+=l.a.substring(J,V?O+1:O,ba);Y.Wm&&M&&(O=new f.a,O.fullName=W.startsWith("@")?W.substr(1):W,G.a(M,O),V=new k,G.c(M,V,O),H.HAf(W,O,V,!0),W="",M=null);Y.Wm&&P&&(O=N||new x.a,O.link=P.url,H.eri(W,O),W="",P=null);M&&P||""===W||(this.Mg.TAb&&N?(H.dBf(W,N),N=null):H.Jca(W),W="");Y.hyperlink&&(Y.hyperlink.kw?M=Y.hyperlink:Y.hyperlink.url&&(P=Y.hyperlink));this.Mg.TAb&&T&&(N=new x.a,N.weight=T.ja(z.a.bold,!1)?y.a.V3d:0,N.italic=T.ja(z.a.italic,!1),N.underline=T.ja(z.a.underline,!1),N.strikethrough=
T.ja(z.a.strikethrough,!1),T.hasProperty(z.a.highlight)&&(O=T.getValue(z.a.highlight),N.highlight=r.a.aF(O)),T.hasProperty(z.a.fontColor)&&(T=T.getValue(z.a.fontColor),N.color=r.a.aF(T)));O=ba;V=!!Y.blob;K++}}}F.eGk="_@_";F.fGk="Z";Object(D.a)(F,"ACommentFormatTranslator",null,[454])},1793:function(D,I,c){D=c(0);var l=c(168),f=c(19),a=c(28),k=c(22),x=c(2),y=c(162),m=c(161);class r{static get Yg(){return l.a.Bz(r.Sm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}
r.Sm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(D.a)(r,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(15),v=c(3);c.d(I,"a",function(){return G});class G extends l.a{constructor(F,H,L){super();this.yWg=!1;this.jW=null;this.jGl=J=>{switch(J){case 1:this.ga.processAction(z.a.M0h,2);break;case 2:this.ga.processAction(z.a.N0h,2);break;case 0:this.ga.processAction(z.a.O0h,2)}};this.Eu=H;this.KS=!1;this.HWb=G.OFl;this.Lh=F;this.ga=L;this.ug="FootnoteEndnoteFormattingOptionsDialog";this.Cd=2;this.Yg=r.Yg;this.xe(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.xe(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Qh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.jGl,null);this.sjb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.jW}set fontName(F){this.jW=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Lh.updateCommandUI()}get fontSize(){return this.HWb}get sjb(){return this.yWg}set sjb(F){this.yWg=F;this.pBn()}L9(){this.CDd("FontStyleComboBox",
"FontPlaceholder",z.a.qOd.toString(),z.a.W3i.toString(),z.a.h3c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.CDd("FontSizeComboBox","FontPlaceholder",z.a.rOd.toString(),v.a.g4c.toString(),z.a.i3c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.jY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.jY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.SGc("NoStyle","IndentPlaceholderStyles",
z.a.Q0h.toString(),z.a.X3i.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.SGc("FirstLineIndent","IndentPlaceholderStyles",z.a.P0h.toString(),z.a.d3f.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}CDd(F,H,L,J,M,P,N){L=y.c(F,L,!0,!0,J,M,f.a.vf(P),!0,N);this.gId(F,H,L,"Medium")}SGc(F,H,L,J,M,P,N){L=y.f(F,L,J,f.a.vf(M),f.a.vf(P),N);this.gId(F,H,L,"Large",P)}gId(F,H,L,J,M=null){H=document.getElementById(H);
this.Eu.RZa(F,L);L=this.Eu.vFb(F,J);M&&a.a.eCd(L,String.format("{0}Label",F),M);H.appendChild(L);this.Eu.Cqa(F)}pBn(){this.Eu.Cqa("NoStyle");this.Eu.Cqa("FirstLineIndent")}dispose(){this.KS||(this.Eu.YY("FontStyleComboBox"),this.Eu.YY("FontSizeComboBox"),this.Eu.YY("NoStyle"),this.Eu.YY("FirstLineIndent"),this.KS=!0);this.Lh.updateCommandUI();super.dispose()}static get KUa(){return k.a.instance.resolve("Common.IStandaloneRootController").eea}static kXl(){return new G(m.App.hn,G.KUa,x.AFrameworkApplication.va)}static jXl(){return G.kXl()}}
G.OFl=-1;Object(D.a)(G,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1821:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(f,a){this.fi=this.Fpd=0;this.VVg=a;this.Yjk=f}Amb(){return this.Fpd-this.fi>=this.Yjk}reset(){this.fi=this.Fpd=this.VVg()}update(){this.Fpd=this.VVg()}}Object(D.a)(l,"TimeBasedTaskYieldStrategy",null,[603])},1832:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.contentId=""}}Object(D.a)(l,"AtMentionOptionalAttributes",
null,[])},1860:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.ObjectSchemaType=I.ObjectSemantic=I.SequenceType=I.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(I.IntentIds||(I.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(I.SequenceType||(I.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(I.ObjectSemantic||(I.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(I.ObjectSchemaType||(I.ObjectSchemaType={}))},1861:function(D,I,c){Object.defineProperty(I,"__esModule",
{value:!0});I.SearchSuggestionAnnotation=I.SearchSuggestionSignal=void 0;const l=c(194);class f{constructor(k){l.SchemaObject.assign(f,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[f.getTypeName()])}}I.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1869:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.az:m.writable||m.configurable))m={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1870),I);f(c(1871),I);f(c(1872),I);f(c(1873),I)},1870:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1871:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1872:function(D,I,c){Object.defineProperty(I,
"__esModule",{value:!0});I.ContractEntityAnnotation=void 0;const l=c(194);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}I.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},
1873:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.ContractEntitySignal=void 0;const l=c(194);class f{constructor(a){l.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}I.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1875:function(D,I,c){c.r(I);c.d(I,"ReactOICErrorDialogWithTrial",
function(){return k});D=c(0);var l=c(54);I=c(1711);var f=c(464),a=c(168);class k extends I.a{constructor(x,y,m,r,z,v){super(x,y,m,r,z,v);y={["errorMessage"]:this.JWh,["offerString"]:this.lRi};x=new a.a(!1,!1,!0);this.wqj?(x.Cd=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.wjb,["onExecute"]:()=>{f.Redirect.showHelp(this.Vmi)}}):(x.Cd=4,x.xe(2,this.foi));x.xe(1,this.Xzd);x.ug=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Qh(this.dialogTitle,Object(l.a)(this,
this.jNn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(D.a)(k,"ReactOICErrorDialogWithTrial",I.a,[])},1876:function(D,I,c){c.r(I);c.d(I,"OICErrorDialogWithTrial",function(){return a});D=c(0);var l=c(54);I=c(1711);var f=c(177);class a extends I.a{constructor(k,x,y,m,r,z){super(k,x,y,m,r,z);k=document.createElement("span");k.innerText=this.JWh;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.lRi;k.appendChild(x);
x=new f.StandardDialog;this.wqj?(x.Cd=1,x.JYe(this.wjb,this.Vmi)):(x.Cd=4,x.xe(2,this.foi));x.xe(1,this.Xzd);x.ug=this.id;x.pv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.lZm,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(D.a)(a,"OICErrorDialogWithTrial",I.a,[])},1878:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||
function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});f(c(1879),I);f(c(1880),I)},1879:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1880:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.SearchProviderAnnotation=I.SearchProviderSignal=void 0;const l=c(194);class f{constructor(k){l.SchemaObject.assign(f,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}I.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1969:function(D,
I,c){function l(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?M.JUn():M.main();Wg.main(ka);lj.main(ka);z.a.instance.Gc(new zg,0,ka);z.a.instance.Gc(new Uo,0,ka);Wp(ka);Un(ka)}var f=c(0),a=c(7),k=c(1605),x=c(1617),y=c(2),m=c(86),r=c(466),z=c(181),v=c(34),G=c(39),F=c(20),H=c(85),L=c(22),J=c(115);class M{get name(){return"Common.App.OAuth.OAuthPackage"}wc(ka){ka.register(318,"Common.App.OAuth.IOAuthManager").ha().Sd(()=>
new k.OAuthManager)}init(){const ka=L.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.VNo(ka)}VNo(ka){const db=y.AFrameworkApplication.K.kb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===db){var Gb=r.OAuthManagerSettings.uJc;if(Gb&&Gb.IsEnabled){var cc=Gb.Application,xc=r.OAuthManagerSettings.authority;if(void 0!==cc&&null!==cc&&cc.length&&void 0!==xc&&null!==xc&&xc.length){var Vc=x.a[ka.Z$],Wd=F.a.jG,
re=ka.fL();try{var od=new Map;void 0!==od&&null!==od?(od.set("SupportStatus",Vc),od.set("Browser",Wd),od.set("AuthStrategy",re)):od=null}catch(ve){od=null}m.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",od);var Be=G.a.We();ka.EV("Core",cc).then(ve=>{const Wf=Math.floor(G.a.We()-Be);Vc=x.a[ka.Z$];Wd=F.a.jG;re=ka.fL();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Wf,ve.IsSuccess,Vc,ve.ErrorCode,db,Wd,re);od&&(od.set("SupportStatus",Vc),od.set("Browser",Wd),od.set("AuthStrategy",re));var lg=Object.assign(new J.a,{durationMs:Wf,extendedProperties:od});if(ve.IsSuccess){if(m.Health.instance.recordKpiSuccess("WacCorePFT",lg),ve="Bearer "+ve.Token,y.AFrameworkApplication.He.Bdd=ve,lg=Gb.Endpoint){var Kh=G.a.We();y.AFrameworkApplication.He.W1b(lg,1,null,{["Authorization"]:ve},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Vg=>{var Gk=Math.floor(G.a.We()-
Kh),wl=null;Vg.Eo?Vg="Canceled":Vg.Ei?Vg="Faulted":(wl=Vg.result,Vg=wl.succeeded?"Completed":"Failed");Gk={["TaskResult"]:Vg,["BrowserTokenDurationMS"]:Wf,["BrowserValidationDurationMS"]:Gk};wl&&(Gk.HttpStatus=wl.args.data.Qe,wl.succeeded&&(wl=v.a(wl.args.data.se),Gk.ServerValidationDurationMS=wl.ElapsedMilliseconds,Gk.ServerValidationResult=wl.ValidatedToken,Gk.KMSI=wl.KMSI,Gk.Scopes=wl.Scopes,Gk.TokenExpirationS=Math.floor(parseInt(wl.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===Vg?50:15,H.a.toJSON(Gk))})}}else m.Health.instance.recordKpiFailure("WacCorePFT",ve.ErrorCode,!1,!1,lg)}).catch(ve=>{var Wf=Math.floor(G.a.We()-Be);Wf=Object.assign(new J.a,{durationMs:Wf,extendedProperties:od});m.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+ve.toString(),!1,!1,Wf)})}}}}dispose(){}static main(){z.a.instance.Gc(new M)}static JUn(){z.a.instance.Gc(new M,0,!0)}}Object(f.a)(M,"OAuthPackage",null,[1,2]);var P=c(373),N=c(365),K=c(19);class O{constructor(){this.nvd=
new N.a}HNo(ka,db){if(!ka)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ka=K.a.Zg(ka);if(this.nvd.nb(ka))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ka),!1;this.nvd.Z(ka,db);return!0}r6l(ka){if(!ka)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ka=K.a.Zg(ka);return this.nvd.nb(ka)?this.nvd.J(ka):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",
ka),null)}}Object(f.a)(O,"SdxPaneSuppressionManager",null,[]);var V=c(247),W=c(255),T=c(9);class Y{constructor(ka){this.DKe=0;this.jak=ka}Amb(){return this.DKe>=this.jak}reset(){this.DKe=0}update(){this.DKe++}}Object(f.a)(Y,"NodeCountBasedTaskYieldStrategy",null,[603]);var ba=c(1821);class Z{constructor(){this.l8c=new Set}tob(ka){this.l8c.add(ka)}bQo(ka){this.l8c.delete(ka)}Ern(){return()=>{this.l8c.forEach(ka=>{ka.onSessionClose()})}}Frn(){return()=>{this.l8c.forEach(ka=>{ka.onSessionConnect()})}}Grn(){return()=>
{this.l8c.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(f.a)(Z,"AlSessionLifeEventNotifier",null,[578]);var ea=c(1402),ha=c(80),la=c(92),ia=c(60),sa=c(6),Oa=c(1515),Ra=c(152),Na=c(331),Da=c(1044),ra=c(704),xa=c(240),fa=c(409),oa=c(676),ta=c(417),Ka=c(403);class va{constructor(){this.token=null}}Object(f.a)(va,"ReleaseAnnotationParameters",null,[]);class La{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(La,"SetAnnotationMetadataParameters",null,[]);class za{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(f.a)(za,"SetAnnotationStateParameters",null,[]);var Ca=c(593),ua=c(355),ib=c(75),bb=c(82),mb=c(596),yb=c(1217),ab=c(305),Ga=c(754),Za=c(8),Ub=c(398);class Xb extends Sys.EventArgs{constructor(ka,db){super();this.annotation=ka;this.yeb=db}}Object(f.a)(Xb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var zb=c(1017);class Ib{constructor(ka){this.y0e=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(ka.items&&0<ka.items.length){const db=Ib.DSd(ka.parentPath);this.annotations=Array(ka.items.length);let Gb=0;for(const cc of ka.items){const xc=Object.assign(new zb.a,{id:cc.id,parentPath:db,content:cc.body,annotationType:xa.a.getTypeNameFor(cc.body),parentRevId:ka.parentRevId});this.annotations[Gb++]=xc}this.y0e=xa.a.getTypeNameFor(ka)}}static DSd(ka){return ka?ka.join("\\"):""}}Object(f.a)(Ib,"AnnotationOperation",null,[]);class $a extends Sys.EventArgs{constructor(ka){super();this.annotationType=
ka}}Object(f.a)($a,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class Hb extends Sys.EventArgs{constructor(ka,db){super();this.annotation=ka;this.opType=db}}Object(f.a)(Hb,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Ya{constructor(){this.newState=this.oldState=0;this.handlers=new ib.a}}Object(f.a)(Ya,"AnnotationResultStateUpdateData",null,[]);var Sa=c(609),Eb=c(1011);class Jb{constructor(){this.v0e=this.RAk=this.w0e=null}}Object(f.a)(Jb,"AnnotationCallbacks",null,[]);class vb{constructor(ka,
db,Gb,cc,xc,Vc){this.p1b=null;this.lAc=new N.a(0);this.AEc=new N.a;this.Mfd=new N.a;this.Rsd=new Sa.a;this.DWf=null;this.oi=ka;this.GLa=db;this.QF=Gb;this.pC=cc;this.JI=xc;this.od=Vc}D1o(ka,db,Gb,cc){this.pC.ubc(ka)&&this.oi.ge(()=>{if(!this.p1b){this.p1b=new N.a;var xc=Za.ParagraphReader.vw(Ub.a.getRootNode(),!0,!0);for(const Vc of xc)Vc&&(xc=Vc.ja(sa.a.Wc,0))&&(this.p1b.add(xc,Vc.id),this.lAc.Z(Vc.id.toString(),xc))}this.GLa.CWf(ka,(Vc,Wd)=>{if(Vc){var re=this.pC.Fai(ka);Vc.contentDescriptor.Rv===
re&&((re=this.JXl(Vc))?Vc.xeb?(re=this.v$e(Vc,re))&&(Wd?Gb(Wd,Vc.contentDescriptor):db(re,Vc.contentDescriptor)):cc(Vc.contentDescriptor):this.Chl(Vc,Object.assign(new Jb,{w0e:db,RAk:Gb,v0e:cc})))}})},"PAS:FEPAOT")}JXl(ka){if(3===ka.contentDescriptor.Rv){let db;return({value:db}=this.p1b.Fc(ka.contentDescriptor.paragraphId)).returnValue?db:null}if(4===ka.contentDescriptor.Rv)return ia.a.nil;a.ULS.sendTraceTag(592525442,vb.Fi,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}sLm(ka,
db){if(3===ka.contentDescriptor.Rv)return db=this.JI.value.Eb(db).getValue(sa.a.oj),ka.contentDescriptor.oj===db;if(4===ka.contentDescriptor.Rv&&db===ia.a.nil)return!0;a.ULS.sendTraceTag(592525443,vb.Fi,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}Chl(ka,db){if(3===ka.contentDescriptor.Rv){const Gb=ka.contentDescriptor.paragraphId;this.AEc.nb(Gb)||this.AEc.add(Gb,new ib.a);this.AEc.J(Gb).add(cc=>{12===cc.type&&this.p1b.add(Gb,cc.id);ka.xeb?(cc=this.v$e(ka,cc.id))&&db.w0e(cc,
ka.contentDescriptor):db.v0e(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Rv)if(ka.xeb){const Gb=this.v$e(ka,ia.a.nil);Gb&&db.w0e(Gb,ka.contentDescriptor)}else db.v0e(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,vb.Fi,15,"DelayCallbackForAnnotation: Unsupported content type")}v$e(ka,db){if(this.sLm(ka,db)){if(db=this.pC.$en(ka.xeb,ka.contentDescriptor,db.toString()))return this.Mfd.Z(db.id,ka.F6a),db}else this.od.isFeatureEnabled(90)&&this.QF.fFc(ka);return null}BFj(ka,db){const Gb=
this.pC.ZPd(ka);Gb&&(db===Da.a.getTypeName()?this.kMo(ka,Gb):this.WLo(ka,Gb))}kMo(ka,db){this.pC.ubc(ka.annotationType)&&(this.QF.hTa(this.JI.value,db,ka.annotationType),this.Mfd.remove(ka.id))}WLo(ka,db){if(this.pC.ubc(ka.annotationType)){db=Object.assign(new Eb.a,{xeb:this.pC.VAk(ka),contentDescriptor:db,annotationType:ka.annotationType});db=this.QF.addAnnotation(this.JI.value,db);this.Mfd.Z(ka.id,db);const Gb=this.pC.$ii(ka.annotationType);Gb&&this.Rsd.contains(Gb)&&(this.oi.ge(()=>{var cc=Za.ParagraphReader.vw(Ub.a.getRootNode(),
!0,!0);if(cc&&0<cc.count){const xc=new ib.a;for(const Vc of cc)(cc=vb.ASd(Vc))&&xc.add(cc);0<xc.count&&this.QF.Lnh(this.JI.value,Gb,xc.toArray())}},"PAS:TAOCPA"),this.Rsd.remove(Gb))}}knb(ka){if(this.p1b)if(ka){var db=ka.ja(sa.a.Wc,0);if(db&&(this.lAc.Z(ka.id.toString(),db),({value:db}=this.AEc.Fc(db)).returnValue))for(const Gb of db)Gb(ka)}else a.ULS.sendTraceTag(592525445,vb.Fi,10,"OnParagraphNodeConnected: Invalid node")}kVi(ka,db){if(ka){var Gb=ka.id.toString();ka=ka.ja(sa.a.Wc,0);var cc=0;({value:cc}=
this.lAc.Fc(Gb)).returnValue&&(3===db?(this.AEc.remove(cc),this.lAc.remove(Gb)):2===db?this.lAc.Z(Gb,ka):a.ULS.sendTraceTag(592525447,vb.Fi,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,vb.Fi,10,"UpdatePersistedAnnotations: Invalid node")}k$l(ka){let db;return({value:db}=this.Mfd.Fc(ka)).returnValue?db:ia.a.nil}nYo(ka,db,Gb){ka?db?this.GLa.hdi(ka,cc=>{if(cc){const Wd=vb.ASd(db,Gb);if(Wd){var xc=Array(cc.length),Vc=!1;for(let re=
0;re<cc.length;re++)if(Vc||Wd!==cc[re])xc[re]=cc[re];else{const od=vb.ASd(db);if(!od)return;Vc=!0;xc[re]=od;cc[re]=od}Vc&&this.QF.Lnh(this.JI.value,ka,xc)}}}):a.ULS.sendTraceTag(588863697,vb.Fi,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,vb.Fi,10,"UpdateWorkflowParagraphVersion: null workflowType")}xjo(ka){ka?this.Rsd.add(ka):a.ULS.sendTraceTag(588863698,vb.Fi,10,"SetPendingWorkflow: null workflowType")}iXk(ka){ka?this.Rsd.remove(ka):a.ULS.sendTraceTag(588105731,
vb.Fi,10,"ClearPendingWorkflow: null workflowType")}static ASd(ka,db=0){if(!ka)return null;db||(db=ka.ja(sa.a.oj,0));ka=Za.ParagraphReader.pR(ka);if(db&&ka)return String.format("{0}{1}{2}",ka,vb.Uxn,db);a.ULS.sendTraceTag(588091606,vb.Fi,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",db?"valid":"0",ka?"valid":"0");return null}}vb.Fi=389;vb.Uxn="-";Object(f.a)(vb,"PersistedAnnotationStorage",null,[600]);class ac{constructor(){this.config=this.token=null}}Object(f.a)(ac,"UpdateAnnotationConfigParameters",
null,[]);var dc=c(121),Cc=c(1194),Ec=c(335),rc=c(1412),hb=c(864),fb=c(204),Nb=c(1101);class Fb{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf=null,lg){this.$cb=lg;this.sa=new ha.a;this.tAa=new bb.a;this.p6=new bb.a;this.rD=new bb.a;this.Fse=new bb.a;this.itc=new Ca.a(ua.a.jh());this.cMe=new ib.a;this.YTb=new bb.a;this.Bse=new bb.a;this.Ofd=new bb.a;this.ZTb=new bb.a;this.pqc=new bb.a;this.Pfd=new bb.a;this.$hd=new bb.a;this.ard=[];this.brd=[];this.uyc=null;this.kak=new Ca.a(ua.a.jh());this.Dse=new Map;
this.ftc=new Map;this.Brc=null;this.Hka=new bb.a;this.qKc=null;this.g$g=this.lZg=0;this.SYa=null;this.Pel=()=>{if(this.ard.length||this.brd.length)try{0<this.ard.length&&this.A8m(),0<this.brd.length&&this.wPo()}finally{this.vXk()}else this.Ib.Ze(this.uyc),this.uyc=null};this.rXk=()=>{const Kh=new ib.a;for(const Vg of this.rD.values)if(Kh.add(Vg),Kh.count===Fb.uak)break;for(const Vg of Kh)this.I0a(Vg),this.tPb(Vg,Da.a.getTypeName());this.rD.count||(this.Ib.Ze(this.Brc),this.Brc=null)};this.l1c=(Kh,
Vg)=>{for(const Gk of Vg.Mj)Kh=Gk.intent,!Kh.type&&this.fpo(Kh.intent,Gk.cpBegin,Gk.cpEnd,Gk.pKb)&&this.I0a(Kh.intent)};this.X5j=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.Lgk=ka.BB("SendReleaseMessageAnnotationList")||[];this.od=Be;this.UJa=Wf;this.GLa=Vc;this.QF=Wd;this.Nn=Gb;this.pC=re;this.Qaa=od;this.JI=cc;this.oi=db;this.Ib=xc;L.a.instance.resolve("Box4.ICharacterPropertiesEditor").$Ze(this.l1c);this.Zs=ve;this.aUj=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.M5j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.z7j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.s0g=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.$cb&&this.Mnm();this.mz=fb.a.instance}get q8i(){return this.ZTb}set q8i(ka){this.ZTb=ka}ob(ka,db){a.ULS.sendTraceTag(41521862,Fb.Fi,50,"New registration for annotation type: {0}.",db);this.addHandler(ka,
db);this.TXe(db).catch(Gb=>{a.ULS.sendTraceTag(594396739,Fb.Fi,10,"Failed to activate annotation type {0}: {1}",db,Gb.toString())})}addHandler(ka,db){if(ka&&db&&""!==db){var Gb=null;({value:Gb}=this.ZTb.Fc(db,Gb)).returnValue?Gb.add(ka):(Gb=new ib.a,Gb.add(ka),this.ZTb.add(db,Gb))}else a.ULS.sendTraceTag(41521861,Fb.Fi,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!db,""===db)}sc(ka,db){a.ULS.sendTraceTag(41521863,Fb.Fi,50,"Unregister handler for annotation type: {0}.",
db);let Gb=null;({value:Gb}=this.ZTb.Fc(db,Gb)).returnValue&&(Gb.remove(ka),Gb.count||(a.ULS.sendTraceTag(41521864,Fb.Fi,50,"Unregister all handlers for annotation type: {0}.",db),this.ZTb.remove(db),this.vin(db)))}Slj(ka){this.qKc||(this.qKc=this.Zs.Pc(2),this.qKc.Db(ka))}vXk(){var ka;null===(ka=this.qKc)||void 0===ka?void 0:ka.dispose();this.qKc=null}SJh(){this.uyc||(this.uyc=new la.a(4,2,100,this.Pel,141),this.Ib.Xb(this.uyc))}A8m(){let ka;ka=Array.dequeue(this.ard);const db=Ub.a.eGb(this.JI.value,
ka);if(db)if(db.tj){this.Slj(db);var Gb=null;if(({value:Gb}=this.pqc.Fc(ka,Gb)).returnValue){this.pqc.remove(ka);for(const cc of Gb)this.B8m(db,cc)}else a.ULS.sendTraceTag(50663568,Fb.Fi,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.kak.add(ka);else a.ULS.sendTraceTag(50436127,Fb.Fi,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}B8m(ka,db){var Gb=db.content.range;Gb=new yb.a(0,Gb.start,Gb.start+Gb.length,ia.a.create(),db,cc=>{this.Fse.Z(db.id,
cc.toString())});this.Nn.IGa(ka,Gb);this.sa.Z8&&this.sa.raiseEvent(Fb.Wfc,new Hb(db,Na.a.getTypeName()))}OLi(ka){const db=Ub.a.F2a(ka.parentPath);let Gb=null;({value:Gb}=this.pqc.Fc(db,Gb)).returnValue||(Gb=new ib.a,this.pqc.add(db,Gb),this.ard.push(db));Gb.add(ka);this.SJh()}D8m(ka,db){this.oi.ge(()=>{let Gb;if(({value:Gb}=this.p6.Fc(ka,Gb)).returnValue){var cc=this.epj(ka);for(const xc of Gb){let Vc;({value:Vc}=this.rD.Fc(xc,Vc)).returnValue&&db(Vc)&&Fb.lIb(Vc)&&(this.OLi(Vc),cc&&this.sa.raiseEvent(Fb.Wfc,
new Hb(Vc,Da.a.getTypeName())))}}},"AS:MIFAT")}xPo(ka,db){this.oi.ge(()=>{let Gb;if(({value:Gb}=this.p6.Fc(ka,Gb)).returnValue)for(const cc of Gb){let xc;({value:xc}=this.rD.Fc(cc,xc)).returnValue&&db(xc)&&Fb.lIb(xc)&&this.fng(xc)}},"AS:UIFAT")}Cin(ka){var db=Ub.a.yJ(ka);let Gb=null;if(({value:Gb}=this.tAa.Fc(db,Gb)).returnValue){db=0;for(var cc=new ib.a;Gb.count>db;){var xc=Gb.J(db),Vc=null;({value:Vc}=this.rD.Fc(xc,Vc)).returnValue&&Fb.lIb(Vc)?this.pC.w9c(ka,Vc)?this.I0a(Vc,!this.od.isFeatureEnabled(90)):
(xc=Vc.content.range,Vc=new yb.a(0,xc.start,xc.start+xc.length,ia.a.create(),Vc),cc.add(Vc),db++):db++}0<cc.count&&this.Nn.CNf(ka,cc)}}wPo(){let ka="";ka=Array.dequeue(this.brd);const db=Ub.a.eGb(this.JI.value,ka);if(db&&12===db.type){this.Slj(db);var Gb=null;({value:Gb}=this.Pfd.Fc(ka,Gb)).returnValue?(this.Nn.hcd(cc=>Gb.contains(cc.intent),db,0),this.Pfd.remove(ka)):a.ULS.sendTraceTag(50663570,Fb.Fi,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,
Fb.Fi,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}fng(ka){let db;({value:db}=this.Fse.Fc(ka.id,db)).returnValue||(db=Ub.a.F2a(ka.parentPath));this.Fse.remove(ka.id);var Gb=null;({value:Gb}=this.Pfd.Fc(db,Gb)).returnValue||(Gb=new ib.a,this.Pfd.add(db,Gb),this.brd.push(db));Gb.add(ka);this.SJh();Gb=null;({value:Gb}=this.pqc.Fc(db,Gb)).returnValue&&Gb.remove(ka)}Krk(ka){const db=ka.id;var Gb=ka.annotationType;const cc=ka.parentPath;if(this.pC.Rkb(ka)){var xc=Ub.a.Kib(this.JI.value,
cc);if(xc&&(xc=xc.ja(sa.a.oj,0).toString(),ka.parentRevId&&xc!==ka.parentRevId))return!1}xc=null;({value:xc}=this.p6.Fc(Gb,xc)).returnValue||(xc=new ib.a,this.p6.add(Gb,xc));xc.add(db);Gb=null;({value:Gb}=this.tAa.Fc(cc,Gb)).returnValue||(Gb=new ib.a,this.tAa.add(cc,Gb));Gb.add(db);this.rD.add(db,ka);this.C1o(ka);return!0}C1o(ka){const db=this.pC.t3h(ka);if(0===db.length)this.SRh(ka);else{let Gb=!1;this.GLa.tpn(db,ka.annotationType,(cc,xc)=>{this.rD.nb(ka.id)?(xc=this.pC.jlb(ka,Ub.a.VLl(ka)),!cc&&
xc?this.qog(ka,10,!1):cc&&this.qog(ka,cc),Gb||(this.SRh(ka),Gb=!0)):xc.eUa=!0})}}SRh(ka){const db=Fb.lIb(ka);db&&this.OLi(ka);!db&&this.sa.Z8&&this.sa.raiseEvent(Fb.Wfc,new Hb(ka,Na.a.getTypeName()))}YCj(ka,db,Gb,cc){let xc=!0;this.oi.ge(()=>{if(cc.startsWith(Ub.a.ADb)){var Vc=ka.id,Wd=null;if(db===Da.a.getTypeName())this.I0a(ka);else if(({value:Wd}=this.rD.Fc(Vc,Wd)).returnValue)a.ULS.sendTraceTag(41418891,Fb.Fi,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Vc,ka.annotationType),
this.rD.Z(Vc,ka);else if(!this.Krk(ka)){xc=!1;return}Gb&&db===Na.a.getTypeName()&&cc!==Ub.a.ADb&&this.cMe.add(ka.annotationType)}this.tPb(ka,db)},"AS:UAS");return xc}Neo(ka){if(ka)for(const db of ka)this.tPb(db,ra.a.getTypeName()),ka=db.content,this.$hd.nb(ka.categoryName)?this.$hd.Z(ka.categoryName,db):this.$hd.add(ka.categoryName,db);else a.ULS.sendTraceTag(592802119,Fb.Fi,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}uvk(ka){this.sa.addHandler(Fb.Wfc,ka)}iph(ka){this.sa.addHandler(Fb.ZRi,
ka)}tbc(ka){return this.YTb.nb(ka)}tvk(ka){this.sa.addHandler(Fb.N5d,ka)}OZn(ka){this.sa.removeHandler(Fb.N5d,ka)}epj(ka){return!Ub.a.Xe(ka)&&Ga.a(ka)&&this.sa.Z8}I0a(ka,db=!0){if(this.rD.nb(ka.id)){var Gb=this.rD.J(ka.id);this.rD.remove(ka.id);var cc=null;({value:cc}=this.tAa.Fc(ka.parentPath,cc)).returnValue?(cc.remove(ka.id),Fb.lIb(Gb)&&this.fng(Gb)):a.ULS.sendTraceTag(50734169,Fb.Fi,15,"DeleteAnnotationFromStorage: No annotations in given parent path");cc=null;({value:cc}=this.p6.Fc(ka.annotationType,
cc)).returnValue?cc.remove(ka.id):a.ULS.sendTraceTag(50734170,Fb.Fi,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.epj(ka.annotationType)?this.sa.raiseEvent(Fb.Wfc,new Hb(Gb,Da.a.getTypeName())):this.tPb(ka,Da.a.getTypeName());db&&this.Qaa.BFj(Gb,Da.a.getTypeName())}}Mmf(ka,db,Gb=!1){const cc=new ib.a;var xc;if(!({value:xc}=this.p6.Fc(ka,xc)).returnValue)return cc;for(const Vc of xc)this.rD.nb(Vc)?(ka=this.rD.J(Vc),(xc=this.pC.ZPd(ka))&&(db.equals(xc)||
Gb&&db.overlaps(xc))&&cc.add(ka)):a.ULS.sendTraceTag(577843217,Fb.Fi,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Vc);return cc}HJd(ka){let db=null;if(({value:db}=this.p6.Fc(ka,db)).returnValue){ka=db.toArray();for(const Gb of ka){let cc;({value:cc}=this.rD.Fc(Gb,cc)).returnValue&&this.I0a(cc)}}}gIm(ka){return xa.a.getTypeNameFor(ka)===Ec.a.getTypeName()}fvi(ka){var db,Gb;return(null===(Gb=null===(db=this.$cb)||void 0===db?void 0:db.Bai)||void 0===Gb?void 0:
Gb.call(db))===Cc.a.ppc&&ka&&0===ka.priority?this.$cb.Kad(ka.context.substr(ka.startInContext,ka.range.length)):!1}d3i(ka,db){this.oi.ge(()=>{a.ULS.F$(Fb.Fi,100)&&a.ULS.sendTraceTag(41418894,Fb.Fi,100,"Operation of type {0} with path {1} received",xa.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const Gb=new Ib(ka);for(const cc of Gb.annotations)if(cc.annotationType===hb.FlagResultAnnotation.getTypeName()){const xc=cc.content.results.map(Vc=>{var Wd;const re=null===(Wd=Vc.M_)||void 0===Wd?void 0:
Wd.seq;Wd=void 0===re?cc.id:cc.id+"_"+re;return{id:Wd,body:{...Vc,id:Wd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.d3i({items:xc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},db)}else Gb.y0e===Na.a.getTypeName()&&this.Rro(cc)?(y.AFrameworkApplication.le("g8469255;j5hhe441"),this.s0g&&(this.SYa||(this.SYa=Nb.a.rPd()),this.lZg++,this.SYa.qmh("AnnotationSkippedDueToInvalidContextCount",this.lZg.toString()))):this.KUd(cc,db,Gb.y0e,!0)}catch(Gb){a.ULS.sendTraceTag(41418898,
Fb.Fi,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",Gb.message,Gb.stack)}},"AS:PO")}Rro(ka){var db;y.AFrameworkApplication.le("01dfc961;05c12706");if(this.z7j&&Ga.a(ka.annotationType)){var Gb;let xc=Gb=null;if(this.mz){Gb=this.mz.k4;var cc=null===Gb||void 0===Gb?void 0:Gb.node;Gb=Ub.a.F2a(ka.parentPath);if(Ub.a.eGb(this.JI.value,Gb)!==cc)return!1;ka=ka.content;Gb=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);xc=null===(db=null===cc||
void 0===cc?void 0:cc.characterData)||void 0===db?void 0:db.substring(ka.range.start,ka.range.start+ka.range.length);this.s0g&&ka&&0===ka.priority&&(db=0<ka.range.start?cc.characterData.charAt(ka.range.start-1):null,cc=ka.range.start+ka.range.length<cc.characterData.length?cc.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&xc&&Gb&&xc===Gb&&(db&&db.match("[A-Za-z0-9]")||cc&&cc.match("[A-Za-z0-9]"))&&(this.SYa||(this.SYa=Nb.a.rPd()),this.g$g++,this.SYa.qmh("partialWordAnnotationsCount",
this.g$g.toString())))}return xc&&Gb&&xc!==Gb?!0:!1}return!1}KUd(ka,db,Gb,cc){if(this.gIm(ka.content)&&this.fvi(ka.content))this.Vza(ka,70);else{var xc=ka.parentPath;Gb!==Da.a.getTypeName()&&cc||this.c9i(ka);cc&&Gb===Na.a.getTypeName()&&Ga.a(ka.annotationType)&&ka.content.isHotCritique&&this.M5j?this.ftc.set(ka.id,{annotation:ka,time:Date.now()}):(cc=ka.annotationType,Ub.a.Xe(cc)||cc!==fa.a.getTypeName()?!Ub.a.Xe(cc)&&Ga.a(cc)&&ka.content&&0==ka.content.priority&&dc.a.N4?(ka=Ub.a.F2a(xc))&&ka==dc.a.lKl()&&
a.ULS.sendTraceTag(539870169,Fb.Fi,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):Gb!==Da.a.getTypeName()&&this.itc.contains(xc)?a.ULS.sendTraceTag(41418897,Fb.Fi,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",xc,ka.id):this.WCj(ka,xc,Gb,db):a.ULS.sendTraceTag(595342670,Fb.Fi,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",xc))}}QWn(ka){if(ka&&ka.annotationType&&this.pC.ubc(ka.annotationType)){var db;
if(({value:db}=this.p6.Fc(ka.annotationType,db)).returnValue&&(ka=this.pC.ZPd(ka)))for(const Gb of db){let cc;({value:cc}=this.rD.Fc(Gb,cc)).returnValue&&(db=this.pC.ZPd(cc))&&(ka.equals(db)||ka.overlaps(db))&&this.I0a(cc)}}}tPb(ka,db){this.oi.ge(()=>{let Gb=null;if(({value:Gb}=this.q8i.Fc(ka.annotationType,Gb)).returnValue)for(const cc of Gb)cc.GB(ka,db)},"AS:SATH")}qXk(){a.ULS.sendTraceTag(50860999,Fb.Fi,50,"ClearStorage: Initiated Clearing Storage");this.Brc||(this.Brc=new la.a(4,2,100,this.rXk,
142),this.Ib.Xb(this.Brc))}activateAnnotation(ka,db){let Gb;if(({value:Gb}=this.Ofd.Fc(ka,Gb)).returnValue){if(Gb.contains(db))return Promise.resolve(null);Gb.add(db)}else{let cc;this.Ofd.add(ka,(cc=new ib.a,cc.add(db),cc))}return this.TXe(ka)}TXe(ka){a.ULS.sendTraceTag(41521865,Fb.Fi,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.YTb.nb(ka))return Promise.resolve(null);var db=null;if(({value:db}=this.Bse.Fc(ka,db)).returnValue)return db;this.Aok(ka);db=null;this.UJa&&(db=this.UJa());
if(db){const Gb=new Ka.a;Gb.annotationType=ka;this.aUj&&(this.Hka.nb(ka)||this.Hka.Z(ka,new Ya),Gb.stateUpdateHandler=(cc,xc)=>{this.Hka.J(ka).oldState=cc;this.Hka.J(ka).newState=xc;for(const Vc of this.Hka.J(ka).handlers)Vc(ka,cc,xc)});db=db.activateAnnotation(Gb);this.Bse.add(ka,db);return db.then(cc=>{this.Bse.remove(ka);this.YTb.add(ka,cc.token);this.XCj(cc.token,ka);this.sa.raiseEvent(Fb.N5d,new $a(ka,!0));this.Knm(ka);return cc})}return Promise.reject(Error.create("Error during annotation activation"))}Knm(ka){const db=
this.pC.$ii(ka);db&&this.GLa.hdi(db,Gb=>{if(this.Qaa.DWf){var cc=Za.ParagraphReader.vw(Ub.a.getRootNode(),!0,!0);if(cc&&0<cc.count){let xc=0;for(const Vc of cc){cc=vb.ASd(Vc);if(!cc)continue;let Wd=!1;for(;xc<Gb.length;){if(cc===Gb[xc]){Wd=!0;break}xc++}if(!Wd){this.Qaa.DWf(db);break}xc++}}}})}Aok(ka){this.Qaa.D1o(ka,(db,Gb)=>{0<this.Mmf(ka,Gb,!0).count||this.YCj(db,Na.a.getTypeName(),!0,db.parentPath)},(db,Gb)=>{if(3!==Gb.Rv)a.ULS.sendTraceTag(591541786,Fb.Fi,15,"Annotation moved to unsupported location type: {0}",
Gb.Rv);else if(db.Rv!==Gb.Rv)a.ULS.sendTraceTag(591541787,Fb.Fi,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",db.Rv,Gb.Rv);else{db=this.Mmf(ka,db);for(const xc of db){const Vc=xc.content;db=Ub.a.Kib(this.JI.value,xc.parentPath);if(!db){a.ULS.sendTraceTag(591541788,Fb.Fi,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Nn.hcd(Wd=>Wd.intent===Vc,db,0))break;var cc=Gb.Eua;cc=new yb.a(0,cc,cc+Gb.Dua,null,Vc);this.Nn.IGa(db,
cc)}}},db=>{for(const Gb of this.Mmf(ka,db))this.I0a(Gb,!1)})}releaseAnnotation(ka,db){let Gb;if(({value:Gb}=this.Ofd.Fc(ka,Gb)).returnValue){Gb.contains(db)&&Gb.remove(db);if(0<Gb.count)return Promise.resolve(!1);this.Ofd.remove(ka)}a.ULS.sendTraceTag(593790408,Fb.Fi,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.Nhj(ka)}vin(ka){var db=null;if(({value:db}=this.p6.Fc(ka,db)).returnValue){a.ULS.sendTraceTag(41418899,Fb.Fi,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ka);for(const Gb of db)if(db=null,({value:db}=this.rD.Fc(Gb,db)).returnValue){const cc=db.parentPath;let xc=null;({value:xc}=this.tAa.Fc(cc,xc)).returnValue&&(xc.remove(Gb),xc.count||this.tAa.remove(cc));this.rD.remove(Gb);Fb.lIb(db)&&this.fng(db)}this.p6.remove(ka)}Array.contains(this.Lgk,ka)&&this.Nhj(ka)}Nhj(ka){let db=null,Gb=null;this.UJa&&(Gb=this.UJa());if(Gb){if(({value:db}=this.YTb.Fc(ka,db)).returnValue){const cc=new va;cc.token=db;this.YTb.remove(ka);this.sa.raiseEvent(Fb.N5d,new $a(ka,
!1));return Gb.releaseAnnotation(cc)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}AFi(){this.oi.ge(()=>{if(this.X5j){var ka=Ub.a.getRootNode();if(ka){var db=new bb.a;mb.f(ka,Gb=>{var cc=Ub.a.yJ(Gb),xc=null;if(({value:xc}=this.tAa.Fc(cc,xc)).returnValue)for(const Vc of xc)cc=null,({value:cc}=this.rD.Fc(Vc,cc)).returnValue&&(cc.parent=Gb,cc.kWc=!0,cc.NMb=2,db.nb(cc.annotationType)||db.Z(cc.annotationType,new ib.a),db.J(cc.annotationType).add(Vc),
xc=null,({value:xc}=this.p6.Fc(cc.annotationType,xc)).returnValue&&xc.remove(cc.id));return!0},12);for(const Gb of this.p6.keys)if(ka=null,({value:ka}=this.p6.Fc(Gb,ka)).returnValue)for(const cc of ka)if(ka=null,({value:ka}=this.rD.Fc(cc,ka)).returnValue){let xc=null;ka.parentPath===Ub.a.ADb?(ka.NMb=1,ka.parent=null):({value:xc}=this.rD.Fc(ka.parentPath,xc)).returnValue?(ka.NMb=3,ka.parent=xc):(ka.NMb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,Fb.Fi,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ka.id));ka.kWc=!0;db.nb(ka.annotationType)||db.Z(ka.annotationType,new ib.a);db.J(ka.annotationType).add(cc)}else a.ULS.sendTraceTag(41997840,Fb.Fi,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",cc);else a.ULS.sendTraceTag(41997841,Fb.Fi,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",Gb);this.p6=db;this.cMe.clear()}else a.ULS.sendTraceTag(41554058,Fb.Fi,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Fb.Fi,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}UAk(ka){this.d3i(ka,!0)}Dsn(ka,db){this.oi.ge(()=>{const Gb=db?db+String.format("\\{0}",ka.id):Ub.a.yJ(ka);a.ULS.sendTraceTag(41418900,Fb.Fi,50,"OnTileDeleted: Tile delete event received for tile {0}.",Gb);this.itc.contains(Gb)||this.itc.add(Gb);var cc=null;if(({value:cc}=this.tAa.Fc(Gb,cc)).returnValue){a.ULS.sendTraceTag(41418901,Fb.Fi,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",cc.count,
Gb);for(const xc of cc)cc=null,({value:cc}=this.rD.Fc(xc,cc)).returnValue&&(this.tPb(cc,Da.a.getTypeName()),this.sa.Z8&&this.sa.raiseEvent(Fb.Wfc,new Hb(cc,Da.a.getTypeName())),this.rD.remove(xc));this.tAa.remove(Gb)}},"AS:OTD")}Csn(ka){ka=Ub.a.yJ(ka);this.itc.remove(ka)&&a.ULS.sendTraceTag(41418902,Fb.Fi,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}pWo(ka){if(ka){a.ULS.sendTraceTag(50436131,Fb.Fi,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var db=new bb.a;
for(var Gb of ka)ka=null,({value:ka}=db.Fc(Gb.parentPath,ka)).returnValue||(ka=new bb.a,db.add(Gb.parentPath,ka)),ka.Z(Gb.id,Gb);for(const cc of db){db=Ub.a.Kib(this.JI.value,cc.key);if(!db){a.ULS.sendTraceTag(50436160,Fb.Fi,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}Gb=new ab.a([0]);for(let xc=0,Vc=db.qa.length;xc<Vc;xc++)ka=db.qa.J(xc),ka.Mj&&Gb.gVa(ka.Mj,void 0,(Wd,re)=>{if(re){var od=null,Be=re.intent;Be&&({value:od}=cc.value.Fc(Be.id,od)).returnValue&&(Be=new oa.a,
Be.start=re.Kb.cp,Be.length=Wd.Kb.cp-Be.start,od.content.range=Be,od.bqa=!1)}})}}else a.ULS.sendTraceTag(50436130,Fb.Fi,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,Fb.Fi,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.TXe(ka).then(()=>{const db=new ib.a;this.oi.ge(()=>{if(Ub.a.Xe(ka)||ka!==fa.a.getTypeName()){this.cMe.contains(ka)&&this.AFi();var Gb=null;if(({value:Gb}=this.p6.Fc(ka,Gb)).returnValue){a.ULS.sendTraceTag(41418903,
Fb.Fi,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var cc=new ib.a;for(const xc of Gb)Gb=null,({value:Gb}=this.rD.Fc(xc,Gb)).returnValue&&(Gb.bqa&&cc.add(Gb),db.add(Gb));cc&&0<cc.count&&Fb.lIb(cc.J(0))&&this.pWo(cc)}}else for(cc of this.$hd.values)db.add(cc);db.count||a.ULS.sendTraceTag(41418904,Fb.Fi,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return db},db=>{a.ULS.sendTraceTag(41418905,Fb.Fi,10,"Exception occurred while fetching annotations of type {0}: {1}",
ka,db);return null})}rha(ka){let db=null;return({value:db}=this.rD.Fc(ka,db)).returnValue?db:null}Nmf(ka){let db=null;if(this.tAa.nb(ka))for(const Gb of this.tAa.J(ka))if(ka=this.rha(Gb))db||(db=new ib.a),db.add(ka);return db}uKb(ka){return(ka=this.rha(ka))?(ka.kWc||this.AFi(),ka):null}Vza(ka,db){this.qlo(ka,db);this.qog(ka,db);this.tPb(ka,ra.a.getTypeName())}nRo(ka,db){this.iVo(ka,db);this.zio(ka,Ub.a.ULl(ka));this.tPb(ka,ra.a.getTypeName())}oRo(ka,db){ka=this.pC.t3h(ka);for(const Gb of ka)this.QF.bog(this.JI.value,
Gb,db)}qlo(ka,db){let Gb=null;this.UJa&&(Gb=this.UJa());Gb&&(ka=this.WLl(ka,db))&&Gb.setAnnotationState(ka)}qog(ka,db,Gb=!0){if(ka&&Fb.Zti(ka)){var cc=this.rha(ka.id);!ka.content||cc&&ka.content===cc.content||Ub.a.setAnnotationState(ka,db);cc&&cc.content&&Ub.a.setAnnotationState(cc,db);Gb&&this.sa.Z8&&(70===db||60===db)&&this.sa.raiseEvent(Fb.ZRi,new Xb(ka,db))}}WLl(ka,db){let Gb=null;ka&&(Gb=Object.assign(new za,{id:ka.id,value:db}),Ub.a.Xe(ka.parentPath)||(Gb.parentPath=ka.parentPath.split("\\")));
return Gb}zio(ka,db){const Gb=this.UJa?this.UJa():null;Gb&&(ka=this.TLl(ka,db))&&Gb.setAnnotationMetadata(ka)}iVo(ka,db){if(ka&&Fb.Zti(ka)){var Gb=this.rha(ka.id);!ka.content||Gb&&ka.content==Gb.content||Ub.a.vij(ka,db);Gb&&Gb.content&&Ub.a.vij(Gb,db)}}TLl(ka,db){if(!ka)return null;const Gb=new La;Gb.id=ka.id;Gb.value=db;Ub.a.Xe(ka.parentPath)||(Gb.parentPath=ka.parentPath.split("\\"));return Gb}fpo(ka,db,Gb,cc){const xc=ka.content;if(this.pC.Rkb(ka)&&xc){const Vc=xc.range.start+xc.range.length;if(0<
cc&&Vc<=Gb||0>cc&&Vc<=Gb+cc)return!1;if(0<cc&&xc.range.start>=db||0>cc&&xc.range.start>=Gb)return xc.range.start+=cc,!1}return!this.od.isFeatureEnabled(63)&&xc&&xc.M_?(ka=this.pC.jlb(ka,60),!(60===xc.M_.state&&ka)):!0}vmh(ka,db){this.Hka.nb(db)||this.Hka.Z(db,new Ya);this.Hka.J(db).handlers.add(ka);ka(db,this.Hka.J(db).oldState,this.Hka.J(db).newState)}L8i(ka,db){this.Hka.nb(db)&&this.Hka.J(db).handlers.contains(ka)&&this.Hka.J(db).handlers.remove(ka)}static Zti(ka){ka=xa.a.getBaseTypesFor(ka.content);
return Array.contains(ka,Ra.a.getTypeName())}static lIb(ka){if(void 0===ka.content||null===ka.content||""===Ub.a.F2a(ka.parentPath))return!1;const db=xa.a.getBaseTypesFor(ka.content);return Array.contains(db,ta.a.getTypeName())&&ka.annotationType!==Oa.RoleDetectionAnnotation.getTypeName()}mRo(ka){ka?(this.Dse.AugLoop_Text_Critique=ka,ka=this.tbc("AugLoop_Text_Critique")?this.YTb.J("AugLoop_Text_Critique"):null,this.XCj(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Fb.Fi,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}XCj(ka,db){if(ka&&this.Dse[db]){const Gb=new ac;Gb.token=ka;Gb.config=this.Dse[db];this.UJa&&(this.UJa().updateAnnotationConfig(Gb),a.ULS.sendTraceTag(540615553,Fb.Fi,50,"Annotation configuration has been updated for annotation type: {0}.",db))}}c9i(ka){let db=null;({value:db}=this.rD.Fc(ka.id,db)).returnValue&&(ka.annotationType=db.annotationType);this.ftc.has(ka.id)&&this.ftc.delete(ka.id)}WCj(ka,db,Gb,cc){this.QWn(ka);this.YCj(ka,Gb,cc,db)&&this.Qaa.BFj(ka,Gb)}hTa(ka){const db=
ka.parentPath,Gb=Da.a.getTypeName();this.c9i(ka);this.Vza(ka,70);this.itc.contains(db)||this.WCj(ka,db,Gb,!0)}J1l(ka){const db=new ib.a;ka=this.p6.Fc(ka).value;if(null===ka)return db;for(const Gb of ka)ka=this.rD.Fc(Gb).value,null!==ka&&db.push(ka);return db}async Mnm(){await Object(rc.b)();this.X8i()}X8i(){const ka=this.J1l(Ec.a.getTypeName());for(const db of ka)this.fvi(db.content)&&this.hTa(db)}}Fb.Fi=389;Fb.Wfc="OnAnnotationOperation";Fb.ZRi="OnAnnotationLocalStateChange";Fb.N5d="OnAnnotationActivationChange";
Fb.uak=20;Object(f.a)(Fb,"AnnotationStorage",null,[601]);class nb{constructor(){this.Pee=null;this.F9c=!1}}Object(f.a)(nb,"AugmentationLoopStateManager",null,[599]);var pb=c(199),Xa=c(575),Pb=c(69),Va=c(104),tb=c(597),cb=c(232);class Mb extends cb.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}el(){return 102}static construct(ka,db,Gb,cc,xc,Vc){const Wd=new Mb;Wd.ExpectedEndRevisionId=ka;Wd.OriginString=db;Wd.Authorization=Gb;Wd.AugLoopSeedUrl=cc;Wd.FileId=xc;Wd.SeedBatchesInParallelIsEnabled=Vc;Wd.AddDocumentKindTypeToPathIsEnabled=!0;Wd.CheckOnDemandNodeVersionEnabled=!0;Wd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Wd}}Object(f.a)(Mb,"FullFileAugLoopSeedingRequest",cb.a,[]);class mc{constructor(){this.authToken=this.url=this.rYi=null}}Object(f.a)(mc,"ReseedingTaskInfo",null,
[]);class Cb{constructor(ka,db,Gb,cc,xc,Vc){this.jaa=null;this.iVg=!1;this.EVb=null;this.xPe=0;this.K3c=(Wd,re)=>{Wd=re.zba;this.EVb&&Va.AT(Wd,od=>od===this.EVb)&&(re.httpStatusCode!==pb.a.$y||re.cI||2!==re.D_f?re.httpStatusCode!==pb.a.$y||re.cI||1!==re.D_f?this.wdj(()=>{a.ULS.sendTraceTag(50861003,Cb.Fi,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",re.httpStatusCode,
re.cI,re.D_f,re.Sr)}):(this.hO.F9c=!1,this.jaa.Mic(this.K3c),this.Oe.qXk(),a.ULS.sendTraceTag(50861002,Cb.Fi,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Wd=Object(Pb.a)(mc,this.EVb),this.y4i(re.s6n,Wd.rYi,Wd.url,Wd.authToken)):this.wdj(()=>{a.ULS.sendTraceTag(50861001,Cb.Fi,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.vAl=Wd=>{if(void 0===Wd||null===Wd||void 0===Wd.data||null===Wd.data||void 0===Wd.data.se||null===Wd.data.se)a.ULS.sendTraceTag(41445393,
Cb.Fi,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Wd.data.Qe!==pb.a.$y)a.ULS.sendTraceTag(41445394,Cb.Fi,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Wd.data.Qe);else try{let re;({group:re}=Xa.a.S1(Wd.data.se)).returnValue?re.Responses&&re.Responses.length?(Wd=null,re&&re.Responses&&re.Responses.length&&(Wd=re.Responses[0])?(this.e3.bVa(Wd),Wd.StatusCode?a.ULS.sendTraceTag(41445398,Cb.Fi,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",
Wd.StatusCode):a.ULS.sendTraceTag(41445399,Cb.Fi,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Wd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,Cb.Fi,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,Cb.Fi,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):
a.ULS.sendTraceTag(41445395,Cb.Fi,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(re){a.ULS.sendTraceTag(41445400,Cb.Fi,10,"FileSeedingSuccessCallback: {0}",re.message)}};this.uAl=Wd=>{void 0===Wd||null===Wd||void 0===Wd.data||null===Wd.data||void 0===Wd.data.se||null===Wd.data.se?a.ULS.sendTraceTag(41445401,Cb.Fi,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,Cb.Fi,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",
Wd.data.Qe)};this.WUj=ka.$("AugLoopServerSideSeedingIsEnabled");this.UUj=ka.$("AugLoopReseedingIsEnabled");this.VUj=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.r5g=ka.lc("MaxReseedingRetries",1);this.Wf=db;this.jmd=Gb;this.hO=cc;this.e3=xc;this.Oe=Vc;T.App.za&&T.App.za.jb&&T.App.za.jb.Yc&&T.App.za.jb.Yc.contentReplicator&&(this.jaa=T.App.za.jb.Yc.contentReplicator)}iAm(ka,db,Gb){if(this.WUj){var cc=this.hO.Pee;cc&&cc.trim().length?this.iVg?this.UUj&&(a.ULS.sendTraceTag(50861E3,Cb.Fi,50,
"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.xPe=0,this.jaa?(this.hO.F9c=!0,this.jaa.oFc(this.K3c),this.EVb=Object.assign(new mc,{rYi:ka,url:db,authToken:Gb}),this.jaa.fF(null,null,this.EVb)):a.ULS.sendTraceTag(592814793,Cb.Fi,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,Cb.Fi,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.y4i(cc,ka,db,Gb),this.iVg=!0):a.ULS.sendTraceTag(41445391,Cb.Fi,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
Cb.Fi,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}wdj(ka){this.xPe<this.r5g?(a.ULS.sendTraceTag(594384E3,Cb.Fi,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.xPe,this.r5g),this.jaa.fF(null,null,this.EVb)):(this.hO.F9c=!1,this.jaa.Mic(this.K3c),ka())}y4i(ka,db,Gb,cc){const xc=Mb.construct(ka,db,cc,Gb,y.AFrameworkApplication.rootQuerySignature,this.VUj);
a.ULS.sendTraceTag(595178454,Cb.Fi,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.jmd.l3a.execute(()=>{this.dtk(xc)})}dtk(ka){a.ULS.sendTraceTag(595178453,Cb.Fi,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Wf.sj(T.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,tb.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.vAl,this.uAl,ka);a.ULS.sendTraceTag(42016906,
Cb.Fi,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}Cb.Fi=389;Object(f.a)(Cb,"FullFileAugLoopSeedingService",null,[]);class Ja{constructor(){}}Object(f.a)(Ja,"RuntimeManagerInitializationTracker",null,[]);var Wa=c(707);class xb{getAugLoopRuntimeManager(){return Wa.a.getAugLoopRuntimeManager()}}Object(f.a)(xb,"AlFactoryWrapper",null,[597]);class ic{Uk(){return Ub.a.Uk()}}Object(f.a)(ic,"UtilsWrapper",null,[596]);var qc=c(753),Lc=c(55),Ac=c(16),gd=c(46),Md=c(155),ie=c(2043),
hf=c(5),Ue=c(103),Kd=c(217),Wc=c(26),Zc=c(351),Nc=c(392),ge=c(96),$d=c(57);class te{constructor(ka,db,Gb,cc,xc){this.Ga=ka;this.Ef=Gb;this.Zo=cc;this.ue=xc;this.hpa=this.Ga.$("WordDesignerCaptionDetectionEnabled")}Ago(ka,db){ka.listType=this.B1l(db);ka.outlineLevel=Za.ParagraphReader.voa(db);ka.indentation=te.iqf(this.Zo.nU(db));ka.alignment=te.zmf(Za.ParagraphReader.Kx(db));ka.isInsideTable=this.isInsideTable(db);ka.isInsideTOC=db.Dr;ka.rightIndentation=te.iqf(this.Zo.A2a(db));var Gb=this.Zo.n$b(db);
ka.specialIndentType=te.Ccm(Gb);ka.specialIndentBy=te.iqf(Gb);ka.listType!==ie.e.NoList&&this.hio(db,ka);this.klo(db,ka);Gb=[];this.hpa&&(Gb=this.KFn(db));ka.formattedRanges=this.rXl(db,Gb);this.hpa&&null!=Gb&&(ka.objectReferences=0<Gb.length?Gb:void 0)}rXl(ka,db){var Gb=ka.qa?ka.qa.length:0,cc=Ue.FormattingReader.Vr(Wc.a.create(ka));let xc=ge.a.GH,Vc=0,Wd=ge.a.DM/2;cc&&(Wd=Ue.FormattingReader.Wn(cc,Ac.a.fontSize,ge.a.DM)/2,xc=Ue.FormattingReader.Wn(cc,Ac.a.font,ge.a.GH),Vc=Ue.FormattingReader.language(cc));
cc="Normal";var re=this.ue.Ro(ka);re&&(cc=re.getValue(gd.a.la)||"Normal",re.hasProperty(Ac.a.font)&&(xc=re.getValue(Ac.a.font)));if(Gb){--Gb;re=[];let Vg=null,Gk=void 0,wl=null;this.hpa&&ka.hasProperty(Ac.a.Ln)&&(wl=ka.getValue(Ac.a.Ln));const el=ka.properties.ja(sa.a.Sga,null);for(let Ki=0;Ki<Gb;Ki++){var od=ka.qa.J(Ki),Be=ka.Lc,ve=null;this.hpa&&(ve=te.juf(ka,wl,Ki));od.nf&&(Vg=te.LSo(Be,od.nf,Vg));od.hyperlink&&od.hyperlink.url?Gk=od.hyperlink.url:od.Wm&&(Gk=void 0);var Wf=ka.qa.J(Ki+1).cp-1;Be=
od.cp;Wf=Wf-od.cp+1;let xj=!1,Hk=!1,Zh=!1,Ho=Wd,Xh=0,Mm=0,Mn=cc,wj=void 0,cn=Vc,oh=xc,Gl;if(od.formatting){var lg=od.formatting;xj=Ue.FormattingReader.Wn(lg,Ac.a.bold,!1);Hk=Ue.FormattingReader.Wn(lg,Ac.a.italic,!1);Zh=Ue.FormattingReader.Wn(lg,Ac.a.underline,!1);Ho=Ue.FormattingReader.Wn(lg,Ac.a.fontSize,2*Wd)/2;Xh=Ue.FormattingReader.Wn(lg,gd.a.capitalization,0);Mm=Ue.FormattingReader.Wn(lg,Ac.a.fontColor,0);cn=Ue.FormattingReader.language(lg)||Vc;oh=Ue.FormattingReader.Wn(lg,Ac.a.font,xc);Mn=cc;
var Kh=lg.En;Kh&&(Kh=Kh.ja(gd.a.nw,null))&&!Kh.equals(ia.a.nil)&&lg.paragraph.Lc&&(lg=lg.paragraph.Lc.Eb(Kh))&&(Mn=(new Kd.a(lg)).getValue(gd.a.la))}this.hpa&&(Gl=this.Drf(ve),null!=Gl&&this.yoh(db,ve,Gl,re.length,ie.b.Inline));Vg&&(wj=0<Vg.count);od={isDeleted:this.JIm(el,od,Ki,Gk),fontFamily:oh,fontWeight:xj?ie.d.Bold:ie.d.Normal,fontSize:Ho,italic:Hk,underline:Zh?ie.h.SingleLine:ie.h.None,capitalization:te.xIh(Xh),color:Mm,styleName:Mn,isFollowUp:wj,languageId:te.nIh(cn),start:Be,length:Wf,link:Gk,
isReference:te.isReference(od)?!0:void 0,objectType:null!==Gl&&void 0!==Gl?Gl:void 0};ve=0<re.length?re[re.length-1]:void 0;te.iRk(ve,od)?ve.length+=od.length:re.push(od)}return re}return[{fontFamily:xc,fontWeight:ie.d.Normal,fontSize:Wd,italic:!1,underline:ie.h.None,capitalization:te.xIh(0),color:0,styleName:cc,isFollowUp:void 0,languageId:te.nIh(Vc),start:0,length:ka.characterData.length}]}JIm(ka,db,Gb,cc){if(this.LB()){if(db.blob||db.formatting&&db.formatting.cache&&db.formatting.cache.ZIb||cc)return!0;
if(ka&&Gb<ka.length)return ka[Gb]}return $d.a.Sj&&db.JR?!0:db.Kh?!0:!1}LB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static iRk(ka,db){return!!ka&&!!db&&ka.start+ka.length===db.start&&ka.isDeleted===db.isDeleted&&ka.fontFamily===db.fontFamily&&ka.fontWeight===db.fontWeight&&ka.fontSize===db.fontSize&&ka.italic===db.italic&&ka.underline===db.underline&&ka.capitalization===db.capitalization&&ka.color===
db.color&&ka.highlightColor===db.highlightColor&&ka.styleName===db.styleName&&void 0===ka.link&&void 0===db.link&&ka.languageId===db.languageId&&!ka.isReference&&!db.isReference&&!ka.isFollowUp&&!db.isFollowUp&&void 0===ka.objectType&&void 0===db.objectType}B1l(ka){const db=new hf.GraphIterator;db.set(ka);db.zb(11);db.ld(11);return(ka=this.Ef.tw(db))?te.F5k(ka.listType):ie.e.NoList}hio(ka,db){var Gb=this.Ef.oca(ka);Gb&&(Gb.hasProperty(sa.a.listID)&&(db.listId=Gb.getValue(sa.a.listID).toString()),
Gb=this.nai(ka,Ac.a.font),ka=this.nai(ka,Ac.a.fontSize),Gb&&(db.bulletAndNumberFontFamily=Gb),ka&&(db.bulletAndNumberFontSize=ka))}isInsideTable(ka){const db=new hf.GraphIterator;db.set(ka);return db.zb(14)}klo(ka,db){db.spacingBeforeParagraph=this.Xfi(ka,sa.a.q5,sa.a.OY,sa.a.Pi);db.spacingAfterParagraph=this.Xfi(ka,sa.a.p5,sa.a.NY,sa.a.ta);db.lineSpacing=this.XFb(ka)}Xfi(ka,db,Gb,cc){if(Za.ParagraphReader.Wn(ka,db,!1))return 0;db=Za.ParagraphReader.Wn(ka,Gb,-1);if(0<=db)return db*Zc.a.GMb/100;ka=
Za.ParagraphReader.Wn(ka,cc,-1);return 0<=ka?ka/20:0}nai(ka,db){ka=this.sUl(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(db)}sUl(ka){var db;ka=null===(db=ka.qa)||void 0===db?void 0:db.last;return null!=ka&&ka.Oh?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}XFb(ka){const db=Za.ParagraphReader.Wn(ka,sa.a.ya,Zc.a.ya);ka=Za.ParagraphReader.Wn(ka,sa.a.xa,Zc.a.lineSpacing);switch(db){case 0:return ka/240;case 1:return ka/
20;default:return 0}}static LSo(ka,db,Gb){for(let cc=0;cc<db.length;cc++){const xc=db.J(cc),Vc=xc.$j,Wd=ka.Eb(Vc);Wd&&Wd.ja(sa.a.LG,!1)&&(Gb||(Gb=new Ca.a(new Nc.a)),xc.Qc?Gb.add(Vc):Gb.remove(Vc))}return Gb}static nIh(ka){return(ka=qc.a.qg(ka))&&ka.name?ka.name.toLowerCase():void 0}static iqf(ka){return ka?2===ka.unit?Math.floor(Lc.a.JBb(ka.value)/20):Math.floor(ka.value/20):0}static Ccm(ka){if(!ka)return ie.g.Initial;switch(ka.specialIndentType){case 1:return ie.g.FirstLine;case 2:return ie.g.Hanging;
default:return ie.g.Initial}}static xIh(ka){switch(ka){case 2:return ie.c.AllCaps;case 1:return ie.c.SmallCaps;default:return ie.c.NoCaps}}static zmf(ka){switch(ka){case 1:return ie.a.Left;case 3:return ie.a.Right;case 2:return ie.a.Center;case 6:return ie.a.Justified;case 0:return ie.a.None;default:return ie.a.Other}}static F5k(ka){switch(ka){case 15:return ie.e.Any;case 1:return ie.e.Bullet;case 42:return ie.e.Invalid;case 13:return ie.e.Lim;case 14:return ie.e.Nil;case 16:return ie.e.NoList;case 0:return ie.e.Numbered;
default:return ie.e.Invalid}}static isReference(ka){return ka.blob&&(7===ka.blob.qh||10===ka.blob.qh)||ka.Fh&&0<ka.Fh.length||ka.nf&&0<ka.nf.length||ka.Jb&&0<ka.Jb.length?!0:!1}static juf(ka,db,Gb){return null==db?null:db[Gb]&&!db[Gb].equals(ia.a.nil)&&ka.Lc?ka.Lc.Eb(db[Gb]):null}Drf(ka){if(null==ka)return null;if(ka.hasProperty(sa.a.Is)){var db=ka.getValue(sa.a.Is);if(te.C0i.has(db))return te.C0i.get(db)}if(ka.hasProperty(sa.a.d8b)&&null!=ka.getValue(sa.a.d8b))return ie.f.FootnoteEndnote;if(ka.hasProperty(sa.a.pageBreak)&&
ka.getValue(sa.a.pageBreak))return ie.f.PageBreak;if(ka.hasProperty(sa.a.DJb)&&ka.getValue(sa.a.DJb))return ie.f.Tab;db=!1;ka.hasProperty(Md.a.F4)?db=ka.getValue(Md.a.F4):ka.hasProperty(sa.a.fia)&&(db=ka.getValue(sa.a.fia));return db&&ka.hasProperty(sa.a.imageType)&&1==ka.getValue(sa.a.imageType)?ie.f.Image:null}static CLm(ka){return ka.hasProperty(sa.a.bac)&&0<=ka.getValue(sa.a.bac)?!0:!1}IBi(ka){return te.YCo.has(ka)}ELh(ka,db,Gb,cc){return null==ka||null==db?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),
null):cc===ie.b.Inline&&null==Gb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):cc===ie.b.Floating&&null!=Gb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>Gb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):te.CLm(ka)?null:this.IBi(db)?{referencedPath:["session",
"doc","main",ka.id.toString()],formattedRangeIndex:Gb,anchorMode:null!==cc&&void 0!==cc?cc:ie.b.Unspecified,anchoredObjectType:cc==ie.b.Floating?db:void 0}:null}yoh(ka,db,Gb,cc,xc){db=this.ELh(db,Gb,cc,xc);null!=db&&null!=ka&&ka.push(db)}KFn(ka){const db=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),db;let Gb=null;ka.hasProperty(sa.a.N7)&&(Gb=ka.getValue(sa.a.N7));if(null!=Gb)for(let cc=0;cc<Gb.length;++cc){const xc=te.juf(ka,
Gb,cc),Vc=this.Drf(xc);null!=Vc&&this.yoh(db,xc,Vc,null,ie.b.Floating)}return db}oHh(ka){if(null==ka||!ka.hasProperty(Ac.a.Ln))return!1;const db=ka.getValue(Ac.a.Ln);for(let cc=0;cc<db.length;cc++){var Gb=te.juf(ka,db,cc);Gb=this.Drf(Gb);if(this.IBi(Gb))return!0}return!1}}te.C0i=new Map([[5,ie.f.Image],[11,ie.f.TextBox],[7,ie.f.Chart],[6,ie.f.SmartArt],[10,ie.f.Drawing],[2,ie.f.EquationObject],[4,ie.f.Ink],[19,ie.f.PageBreak],[23,ie.f.FootnoteEndnote],[24,ie.f.FootnoteEndnote],[35,ie.f.FootnoteEndnoteReferenceMark],
[36,ie.f.FootnoteEndnoteReferenceMark],[0,ie.f.Other]]);te.YCo=new Set([ie.f.Image,ie.f.TextBox,ie.f.Chart,ie.f.SmartArt,ie.f.Drawing,ie.f.Ink]);Object(f.a)(te,"FormattingExtractor",null,[595]);var Se=c(1223);class tc extends Sys.EventArgs{constructor(ka){super();this.V$b=ka}}Object(f.a)(tc,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class dd extends Sys.EventArgs{constructor(ka){super();this.m9=ka}}Object(f.a)(dd,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Ed{constructor(ka,db,Gb){this.z0c=
ka;this.graphNode=db;this.fullPath=Gb}}Object(f.a)(Ed,"NodeEvent",null,[637]);class Qd{constructor(){this.zEe=this.kCe=!1;this.dwb=null;this.sa=new ha.a;this.Haa=new N.a(0);this.Nab=new Se.a(ua.a.jh());this.Pwb=new Se.a(ua.a.jh());this.$qd=[]}Xoh(ka){this.sa.addHandler("IsCollectingNodeEventsChangedKey",ka)}XWk(){this.Haa=new N.a(0);this.V$b=!1}get V$b(){return this.kCe}set V$b(ka){this.kCe!==ka&&(this.kCe=ka,this.sa.raiseEvent("HasNodeEventsChangedKey",new tc(ka),this))}get m9(){return this.zEe}set m9(ka){this.zEe!==
ka&&(this.zEe=ka,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new dd(ka),this))}kPb(ka,db){this.Nab.nb(ka)||this.Nab.Z(ka,db)}T8n(ka,db){this.Pwb.Z(ka,db)}NLl(ka){let db=null;this.Pwb.nb(ka)&&(db=this.Pwb.J(ka),this.Pwb.remove(ka));return db}bce(ka,db){if(ka)if(this.m9){var Gb=3!==db&&4!==db&&5!==db||!this.Nab.nb(String.format("{0}",ka.id))?Ub.a.yJ(ka):this.Nab.J(String.format("{0}",ka.id));if(({value:cc}=this.Haa.Fc(Gb)).returnValue)if(cc||3!==db)if(5===cc&&3===db){if(ka=Gb.split("\\").pop(),
this.Pwb.nb(ka)){var cc=this.Pwb.J(ka);cc===Gb?(this.yMf(Gb,db),this.Haa.add(Gb,db)):(this.Pwb.Z(ka,Gb),this.Nab.Z(ka,cc),this.XJi(Gb),this.Haa.remove(Gb),this.yMf(Gb,db),this.Haa.add(cc,5))}}else cc&&(4!==cc||0!==db&&3!==db&&5!==db)&&(this.yMf(Gb,db),this.Haa.add(Gb,db));else this.XJi(Gb),this.Haa.remove(Gb);else this.d6m(Gb,db),this.$qd.push(ka),this.Haa.add(Gb,db);this.V$b=0<this.Haa.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,
389,15,"node is null.")}d6m(ka,db){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,db)}yMf(ka,db){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,db)}XJi(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}Z2k(){let ka=null;var db=!1;let Gb=null;for(;this.$qd.length&&!db;){Gb=Array.dequeue(this.$qd);if(!Gb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.Nab.nb(String.format("{0}",Gb.id))?(ka=this.Nab.J(String.format("{0}",Gb.id)),this.Nab.remove(String.format("{0}",Gb.id)),this.$qd.push(Gb)):ka=Ub.a.yJ(Gb);db=this.Haa.nb(ka)}if(!db)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.XWk(),null;db=this.Haa.J(ka);this.Haa.remove(ka);this.V$b=0<this.Haa.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,db);return new Ed(db,Gb,ka)}jQn(ka){this.dwb=ka}$2k(){if(!this.dwb)return null;
for(var ka=0;ka<this.dwb.length;ka++){var db=this.dwb.J(ka);db=Ub.a.yJ(db.node);if(this.Haa.nb(db))return null}ka=this.dwb;this.dwb=null;return ka}oXk(){this.dwb=null}Hzo(){this.m9=!0}$Jm(ka){return this.Haa.nb(ka.id.toString())}}Object(f.a)(Qd,"NodeEventsCollection",null,[594]);var Ad=c(1487),Oe=c(1411),pf=c(288),Fh=c(111);class Ig extends Oe.a{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve){super();this.Amd=new Ad.a;this.yab=!1;this.Ttc=null;this.Pia=(Wf,lg)=>{(Wf=lg.node)&&this.J7a(Wf)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),Ub.a.Nqo(Wf,this.Kla.m9,this.iUb,this.Agk)&&(this.Kla.bce(Wf,0),this.aEj(Wf)));this.Kla.m9&&this.Qaa.knb(Wf)};this.iSi=(Wf,lg)=>{Wf=lg.node;this.Kla.kPb(String.format("{0}",Wf.id),Ub.a.yJ(Wf))};this.kMb=(Wf,lg)=>{(Wf=lg.node)&&this.J7a(Wf)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Kla.m9&&this.Kla.bce(Wf,3));this.Kla.m9&&this.Qaa.kVi(Wf,3)};this.LY=(Wf,lg)=>{Wf=lg.node;lg=lg.property;Wf&&this.rUj.has(lg)&&this.J7a(Wf)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.Kla.m9&&(this.Kla.bce(Wf,2),lg===sa.a.oj&&this.aEj(Wf)));this.Kla.m9&&lg===sa.a.Wc&&this.Qaa.kVi(Wf,2)};this.jSi=(Wf,lg)=>{(Wf=lg.node)&&Za.ParagraphReader.Wb(Wf)&&!this.ytc.has(Wf)&&!this.yze.has(Wf)&&(this.ytc.add(Wf),this.IY())};this.mVi=(Wf,lg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Wf=lg.node)&&this.Oe.Cin(Wf)};this.uSf=()=>{this.I9c()?this.kN():this.yab&&!this.Kla.m9&&this.Uza()};this.wC=db;this.Kla=Gb;this.Agk=Fh.b(cc.Pee);
this.iUb=ka.$("AugLoopOperationsAreEnabled");this.Oe=xc;this.Qaa=Vc;this.pC=Wd;this.Ib=re;this.Nn=od;this.QF=Be;this.ytc=new Set;this.yze=new Set;ve.ara(this,7);this.rUj=new Set([Ac.a.vo,Ac.a.bold,Ac.a.italic,Ac.a.underline,Ac.a.font,Ac.a.fontSize,Ac.a.fontColor,gd.a.capitalization,Ac.a.Ih,Ac.a.Ln,sa.a.q5,sa.a.OY,sa.a.Pi,sa.a.p5,sa.a.NY,sa.a.ta,sa.a.ya,sa.a.xa,sa.a.listID,sa.a.gN,sa.a.$d,sa.a.Zia,sa.a.uu,sa.a.oj])}get index(){return 7}get G1c(){return this.Ttc}set G1c(ka){this.Ttc=ka;this.Qaa.DWf=
ka?()=>{this.Ttc()}:null}init(){this.I9c()&&this.kN();this.Kla.Xoh(this.uSf)}kN(){this.wC?(this.yab=!0,this.wC.hu(this.Pia),this.wC.GQ(this.iSi),this.wC.Fx(this.kMb),this.wC.Mo(this.LY),this.wC.Fph(this.mVi),this.wC.Gvk(this.jSi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}Uza(){this.wC?(this.yab=!1,this.wC.iV(this.Pia),this.wC.Nda(this.iSi),this.wC.Pqa(this.kMb),this.wC.jV(this.LY),this.wC.$$i(this.mVi),this.wC.UZn(this.jSi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}hWd(ka){ka&&this.Amd.add(ka.id,ka.ja(sa.a.oj,0))}aEj(ka){this.Amd.nb(ka.id)?(this.Qaa.nYo(ea.a.Oie,ka,this.Amd.J(ka.id)),this.Amd.remove(ka.id)):(this.Qaa.iXk(ea.a.Oie),this.G1c&&this.G1c())}J7a(ka){const db=T.App.za.jb.qc;return!!db&&db.kv&&!!db.ed&&!!db.ed.Lc&&!!ka&&!!ka.Lc&&ka.Lc.id===db.ed.Lc.id}run(){if(0!==this.ytc.size){var ka=[];for(const db of this.ytc)ka.push(db),this.yze.add(db),100<=ka.length&&(this.EVh(ka),
ka=[]);0<ka.length&&this.EVh(ka);this.ytc.clear()}}EVh(ka){const db=new la.a(4,1,500,()=>{for(const Gb of ka)this.yze.delete(Gb),this.pRo(Gb)},158);this.Ib.Xb(db)}pRo(ka){var db=this.Nn.LPa(ka,0,cc=>this.rso(cc.intent));if(0<db.count)for(const cc of db){db=this.Qaa.k$l(cc.intent.id);var Gb=ka.Ona;const xc=Za.ParagraphReader.pR(ka);cc.end<cc.Ac||(Gb=pf.a.YJc(xc,Gb,cc.Ac,cc.end-cc.Ac,cc.Ac,cc.end-cc.Ac,ka),this.QF.k6f(ka.Lc,db,Gb))}}rso(ka){return!!ka&&this.pC.Rkb(ka)&&!!ka.content}I9c(){return!this.yab&&
this.Kla.m9}}Object(f.a)(Ig,"ParagraphNodeEventHandler",Oe.a,[585]);var Jh=c(1024),xg=c(397),bc=c(453),Bc=c(102);class ad extends bc.a{constructor(){super();this.H_=Object.assign(new Bc.a,{T_:ad.getTypeName(),B_:ad.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(f.a)(ad,"DeltaUpdateOperation",bc.a,[]);var zd=c(369);class Xd{constructor(){this.referencedPath=null}}Object(f.a)(Xd,"ItemReference",null,[]);
class Gd extends zd.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(f.a)(Gd,"ItemWithPath",zd.a,[]);var Ze=c(994);class Fe extends Ze.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new Bc.a,{T_:Fe.getTypeName(),B_:Fe.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(f.a)(Fe,"MoveOperation",Ze.a,[]);var bf=c(442);
class ag extends bf.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new Bc.a,{T_:ag.getTypeName(),B_:ag.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(ag,"SelectionSignal",bf.a,[]);class Xf extends ag{constructor(){super();this.content=null;this.H_=Object.assign(new Bc.a,{T_:Xf.getTypeName(),B_:Xf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(f.a)(Xf,"SelectionContentSignal",ag,[]);class vf{constructor(){this.range=this.tileReference=null}}Object(f.a)(vf,"TextTileRange",null,[]);var Bg=c(1675),ob=c(368),$b=c(36),Uc=c(17);class Pd{constructor(ka,db,Gb,cc,xc,Vc,Wd,re){this._augLoopRuntimeManager=this.Ckd=null;this.NRe=!1;this.dma=this.UHe=this.Evd=null;this.qQg=2E3;this.sDl=()=>{if(T.App.lostSession||xg.SessionStatusManager.instance&&xg.SessionStatusManager.instance.Fo)Wa.a.getAugLoopRuntimeManager().closeSession(),
a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Ib.Ze(this.Ckd);this.oi.ge(()=>{var od;const Be=fb.a.instance.k4;this.LB()&&this.g3n();for(this.uDc.reset();this.UXa.V$b&&!this.uDc.Amb();){let lg;lg=this.UXa.Z2k();if(!lg||!lg.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.uDc.update();continue}if(!this.vqo(lg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
lg.graphNode.id);this.uDc.update();continue}const Kh=lg.graphNode.id.toString();var ve=-1,Wf=!0;Be&&Uc.SelectionEditor.ef(Be)&&Kh==Be.node.id.toString()&&(ve=Be.cpBegin,Wf=!1);let Vg=null;if(this.zyb.contains(Kh))switch(lg.z0c){case 3:this.zyb.remove(Kh);Vg=3;break;default:Vg=lg.z0c}else switch(lg.z0c){case 0:case 1:this.zyb.add(Kh);Vg=0;break;case 2:this.zyb.add(Kh);Vg=0;break;case 3:this.zyb.remove(Kh);Vg=3;break;default:Vg=lg.z0c}if(null!=Vg){ve=this.fci(lg.graphNode,lg.fullPath,Vg,ve,Wf);if(4==
Vg||5==Vg){if(ve.prevParentPath.join()!==ve.parentPath.join()){Wf=Object.assign(new Da.a,{parentPath:ve.prevParentPath,items:ve.items});const Gk=Object.assign(new Na.a,{parentPath:ve.parentPath,items:ve.items,prevId:ve.prevId,nextId:ve.nextId});Kh!==ve.prevId&&Kh!==ve.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Vg,Kh,ve.prevId,ve.nextId,lg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,
{operation:Wf}));this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,{operation:Gk}));14===lg.graphNode.type&&this.xhj(lg.graphNode,ve.parentPath).forEach(wl=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,{operation:wl}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,{operation:ve}));if(this.jgd&&this.dma&&this.dma[0]==Kh)switch(Vg){case 3:this.dma=null;break;case 0:case 1:case 2:case 4:case 5:this.dma[1]=null===(od=this.Rwb.gGb(lg.graphNode))||
void 0===od?void 0:od.iPc(lg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",xa.a.getTypeNameFor(ve),Kh);switch(Vg){case 0:case 4:case 5:this.Oe.Csn(lg.graphNode);break;case 3:this.Oe.Dsn(lg.graphNode,ve.parentPath.join("\\"))}}this.uDc.update()}(od=this.UXa.$2k())&&this.Dbj(od)},"TV:FPEFO")};this.Fqa=(od,Be)=>{var ve;if(Be.pl&&Be.pl.length){if(this.jgd)if(od=Ub.a.s4l(Be.pl),!od)this.dma=null;else if(!this.dma||this.dma[0]!=
od.id.toString()){const Wf=this.UXa.$Jm(od)?null:null===(ve=this.Rwb.gGb(od))||void 0===ve?void 0:ve.iPc(od);this.dma=[od.id.toString(),Wf]}this.NRe&&this.UXa.jQn(Be.pl.lb)}};this.Ga=ka;this.UXa=db;this.Ib=Gb;this.uDc=cc;this.TUj=this.Ga.$("AugLoopOperationsAreEnabled");this.zyb=new Ca.a(ua.a.jh());this.Oe=xc;this.oi=Vc;this.Rwb=Wd;this.ib=re;this.jgd=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.Sw(this.Fqa);Ub.a.Uk().then(()=>{this._augLoopRuntimeManager=
Wa.a.getAugLoopRuntimeManager();y.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ga.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Bg.a,{handler:od=>{this.Oe.UAk(od)}}));this.TUj&&this.UXa.Hzo();this.zAo()}).catch(()=>{});this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.qQg=5E3)}g3n(){const ka=this.Oe.ftc.entries();
for(let db=0;db<this.Oe.ftc.size;db++){const Gb=ka.next();y.AFrameworkApplication.le("gi204158;ef1e2812");Date.now()-Gb.value[1].time>=this.qQg&&this.Oe.KUd(Gb.value[1].annotation,!0,Na.a.getTypeName(),!1)}}vqo(ka){return 3===ka.z0c||Ub.a.Dpj(ka.graphNode)}zAo(){!this.Ckd&&this.UXa.m9&&(this.Ckd=new la.a(4,2,this.Ga.lc("NodeEventsFiringInterval",500),this.sDl,131),this.Ib.Xb(this.Ckd))}xhj(ka,db){var Gb,cc=[];const xc=hf.GraphIterator.eb(ka),Vc=xc.Qp();for(var Wd=0;Wd<Vc;Wd++){let re=xc.lF(Wd);11===
re.type&&(re=$b.OutlineElementNavigator.Ce(xc));const od=re.id.toString(),Be=null===(Gb=this.Rwb.gGb(re))||void 0===Gb?void 0:Gb.qCb(re);cc.push(Object.assign(new zd.a,{body:Be,id:od,revId:Ub.a.quf(re)}));xc.ld(ka.type)}db.push(ka.id.toString());Gb=[];Gb.push(Object.assign(new Na.a,{parentPath:db.slice(),items:cc,prevId:null}));for(cc=0;cc<Vc;cc++)Wd=xc.lF(cc),11===Wd.type&&(Wd=$b.OutlineElementNavigator.Ce(xc)),0<xc.Qp()&&(Gb=Gb.concat(this.xhj(Wd,db))),xc.ld(ka.type);db.pop();return Gb}OPa(ka){return ka.split("\\").slice(0,
-1)}fci(ka,db,Gb,cc=-1,xc=!0){var Vc;let Wd=null,re=null;const od=ka.id.toString();var Be=null;3!==Gb&&(Be=Ub.a.ANk(ka));if(Be)for(let ve=0;ve<Be.length;ve++)if(Be[ve]===od){re=ve+1<Be.length?Be[ve+1]:null;Wd=ve?Be[ve-1]:null;break}od!==Wd&&od!==re||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Gb,od,Wd,re,ka.type);Be=null===(Vc=this.Rwb.gGb(ka))||void 0===Vc?void 0:Vc.qCb(ka,cc,xc);
cc=[Object.assign(new zd.a,{body:Be,id:od,revId:Ub.a.quf(ka)})];switch(Gb){case 0:case 1:return Object.assign(new Na.a,{parentPath:this.OPa(db),items:cc,prevId:Wd,nextId:re});case 4:return Object.assign(new Fe,{parentPath:this.OPa(Ub.a.yJ(ka)),prevParentPath:this.OPa(db),items:cc,prevId:Wd,nextId:re});case 5:return Gb=this.UXa.NLl(od),Object.assign(new Fe,{parentPath:this.OPa(null!==Gb&&void 0!==Gb?Gb:Ub.a.yJ(ka)),prevParentPath:this.OPa(db),items:cc,prevId:Wd,nextId:re});case 2:return Object.assign(new ra.a,
{parentPath:this.OPa(db),items:cc});case 3:return Object.assign(new Da.a,{parentPath:this.OPa(db),items:cc});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",Gb,od),Object.assign(new Ze.a,{parentPath:this.OPa(db),items:cc,prevId:Wd,nextId:re})}}vgm(ka){return this.dma&&this.dma[0]===ka?this.dma[1]:null}qco(ka){var db;if(!this.jgd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Ub.a.Dpj(ka))return!1;
const Gb=ka.id.toString();var cc=this.zyb.contains(Gb)?2:0;cc=this.fci(ka,Ub.a.yJ(ka),cc);this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,{operation:cc}));this.zyb.add(Gb);this.dma=[Gb,null===(db=this.Rwb.gGb(ka))||void 0===db?void 0:db.iPc(ka)];return!0}dbo(ka,db){var Gb;if(this.jgd){var cc=ka.id.toString(),xc=this.OPa(Ub.a.yJ(ka));db=[Object.assign(new Gd,{id:cc,revId:Ub.a.quf(ka),parentPath:xc,delta:db})];xc=Object.assign(new ad,{parentPath:xc,items:db});this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,
{operation:xc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",cc);this.dma=[cc,null===(Gb=this.Rwb.gGb(ka))||void 0===Gb?void 0:Gb.iPc(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}uFk(ka,db){if(ka.tileReference.referencedPath.length!==db.tileReference.referencedPath.length||ka.range.start!==db.range.start||ka.range.length!==db.range.length)return!1;for(let Gb=0;Gb<ka.tileReference.referencedPath.length;Gb++)if(ka.tileReference.referencedPath[Gb]!==
db.tileReference.referencedPath[Gb])return!1;return!0}pFk(ka,db){if(ka.selectedRanges.length!==db.selectedRanges.length||ka.content!==db.content)return!1;for(let Gb=0;Gb<ka.selectedRanges.length;Gb++)if(!this.uFk(ka.selectedRanges[Gb],db.selectedRanges[Gb]))return!1;return!0}Dbj(ka){var db;if(ka){var Gb=new ib.a,cc="";for(let Wd=0;Wd<ka.length;Wd++){var xc=ka.J(Wd),Vc=(null===(db=this.Rwb.gGb(xc.node))||void 0===db?void 0:db.qCb(xc.node)).content;cc+=Vc;Vc=xc.cpBegin<Vc.length?xc.cpBegin:-1;Vc=Object.assign(new oa.a,
{start:Vc,length:xc.cpEnd-xc.cpBegin});const re=xc.node.id.toString();xc=this.OPa(Ub.a.yJ(xc.node));xc.push(re);Gb.add(Object.assign(new vf,{range:Vc,tileReference:Object.assign(new Xd,{referencedPath:xc})}))}ka=Object.assign(new Xf,{selectedRanges:Gb.toArray(),content:cc});this.UHe&&this.pFk(ka,this.UHe)||(db=this.Evd?this.Evd:ia.a.create().toString(),Gb=[Object.assign(new zd.a,{body:ka,id:db})],this.Evd?db=Object.assign(new ra.a,{parentPath:["session","doc"],items:Gb}):(this.Evd=db,db=Object.assign(new Na.a,
{parentPath:["session","doc"],items:Gb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new ob.a,{operation:db})),this.UHe=ka)}}clo(ka){(this.NRe=ka)?this.nbj():this.UXa.oXk()}nbj(){this.Dbj(this.ib.hb.lb)}LB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(f.a)(Pd,"TileView",null,[587]);var ze=c(41),Me=c(52);class af{constructor(ka){Me.a.assign(af,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return Me.a.matchesTypesFor(ka,
[af.getTypeName()])}}af.H_={T_:af.getTypeName(),B_:af.getBaseTypes()};class Hg{constructor(ka){Me.a.assign(Hg,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return Me.a.matchesTypesFor(ka,[Hg.getTypeName()])}}Hg.H_={T_:Hg.getTypeName(),B_:Hg.getBaseTypes()};class wi{constructor(ka){Me.a.assign(wi,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return Me.a.matchesTypesFor(ka,
[wi.getTypeName()])}}wi.H_={T_:wi.getTypeName(),B_:wi.getBaseTypes()};class Wi{constructor(ka){Me.a.assign(Wi,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return Me.a.matchesTypesFor(ka,[Wi.getTypeName()])}}Wi.H_={T_:Wi.getTypeName(),B_:Wi.getBaseTypes()};class Mf{constructor(ka){Me.a.assign(Mf,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable",
"AugLoop_Table_Table"]}static typeGuard(ka){return Me.a.matchesTypesFor(ka,[Mf.getTypeName()])}}Mf.H_={T_:Mf.getTypeName(),B_:Mf.getBaseTypes()};var Zg;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(Zg||(Zg={}));var zf;(function(ka){ka[ka.none=0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.Vkp=512]="noHBand";ka[ka.alp=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=
288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.Ogl=1184]="defaultLook"})(zf||(zf={}));Object(f.b)("TableLookFlags",zf);class ii{qCb(ka){if(ka)switch(ka.type){case 14:return this.fdl(ka);case 15:return new af;case 16:return this.edl(ka)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}fdl(ka){var db=ka.mG||[];let Gb=0;for(let cc=0;cc<db.length;cc++)Gb+=db[cc];db=db.map((cc,xc)=>({columnId:xc.toString(),widthPercent:0!=Gb?100*cc/Gb:0}));return new Wi({columnDefs:db,
tableLook:ka.properties.ja(sa.a.tableLook,zf.Ogl),complexTable:ka.properties.ja(sa.a.complexTable,!1),floatingTable:ka.properties.ja(sa.a.Lwi,!1)})}edl(ka){return new Hg({rowspan:ka.properties.ja(sa.a.rowSpan,1),colspan:ka.properties.ja(sa.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ja(sa.a.mRb,0),size:ka.properties.ja(sa.a.qmc,4),style:ka.properties.ja(sa.a.zqb,"single")},leftBorder:{color:ka.properties.ja(sa.a.kRb,0),size:ka.properties.ja(sa.a.omc,4),style:ka.properties.ja(sa.a.xqb,
"single")},rightBorder:{color:ka.properties.ja(sa.a.lRb,0),size:ka.properties.ja(sa.a.pmc,4),style:ka.properties.ja(sa.a.yqb,"single")},bottomBorder:{color:ka.properties.ja(sa.a.jRb,0),size:ka.properties.ja(sa.a.nmc,4),style:ka.properties.ja(sa.a.wqb,"single")}},verticalAlignment:ka.properties.ja(sa.a.OIa,Zg.Top),ghostCell:ka.properties.ja(sa.a.ghostCell,!1),renderCell:ka.properties.ja(sa.a.renderCell,!1),skippedCell:ka.properties.ja(sa.a.skippedCell,!1),fillColor:ka.properties.ja(Ac.a.QK,0),verticalMerge:ka.properties.ja(ze.a.vMerge,
null)})}iPc(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(f.a)(ii,"TableElementNodeToTileConverter",null,[586]);class Af{constructor(ka,db,Gb){this.ro=db;this.Fza=Gb;this.sMd=!1;this.Ttc=null;this.eXi=(cc,xc)=>{this.Mya(xc.node,0)};this.aXi=(cc,xc)=>{cc=xc.node;this.Fza.kPb(cc.id.toString(),Ub.a.yJ(cc))};this.fXi=(cc,xc)=>{this.Mya(xc.node,3)};this.U7d=(cc,xc)=>{this.Mya(xc.node,2)};this.hXi=(cc,xc)=>{this.Mya(xc.node,0)};this.iXi=(cc,xc)=>{this.Mya(xc.node,3)};this.gXi=(cc,xc)=>
{cc=xc.node;this.Fza.kPb(cc.id.toString(),Ub.a.yJ(cc))};this.V7d=(cc,xc)=>{this.Mya(xc.node,2)};this.cXi=(cc,xc)=>{this.Mya(xc.node,0)};this.bXi=(cc,xc)=>{cc=xc.node;this.Fza.kPb(cc.id.toString(),Ub.a.yJ(cc))};this.dXi=(cc,xc)=>{this.Mya(xc.node,3)};this.S7d=(cc,xc)=>{var Vc;cc=xc.node;if(xc.property===sa.a.ghostCell){if(xc=cc.fg?cc:null===(Vc=cc.Vxa)||void 0===Vc?void 0:Vc.xM){Vc=hf.GraphIterator.eb(xc);var Wd=Vc.Qp();for(var re=0;re<Wd;re++){Vc.lF(re);var od=$b.OutlineElementNavigator.Ce(Vc);this.Fza.kPb(od.id.toString(),
String.format("{0}\\{1}",Ub.a.yJ(xc),od.id));this.Mya(od,4);Vc.ld(16)}}}else if(xc.property===Ac.a.$e){xc=hf.GraphIterator.eb(cc);Vc=xc.Qp();let Be=null;Wd=[];for(re=0;re<Vc;re++){xc.lF(re);od=$b.OutlineElementNavigator.Ce(xc);this.Fza.T8n(od.id.toString(),String.format("{0}\\{1}",Ub.a.yJ(cc),od.id));if(14!==od.type){if(Be=Ub.a.yJ(od))this.Fza.kPb(od.id.toString(),Be),this.Mya(od,5)}else Wd.push(od);xc.ld(16)}Be&&Wd.forEach(ve=>{this.Fza.kPb(ve.id.toString(),String.format("{0}\\{1}",Be.split("\\").slice(0,
-1).join("\\"),ve.id));this.Mya(ve,5)})}this.Mya(cc,2)};this.uSf=()=>{this.I9c()?this.kN():this.sMd&&!this.Fza.m9&&this.Uza()};this.iUb=ka.$("AugLoopOperationsAreEnabled")}get G1c(){return this.Ttc}init(){this.I9c()&&this.kN();this.Fza.Xoh(this.uSf)}kN(){const {owj:ka,zke:db,dwj:Gb}=this.X7h();if(ka&&db&&Gb){this.sMd=!0;var cc=this.aXi,xc=this.fXi,Vc=this.U7d;ka.hu(this.eXi);ka.GQ(cc);ka.Fx(xc);ka.Mo(Vc);cc=this.gXi;xc=this.iXi;Vc=this.V7d;db.hu(this.hXi);db.GQ(cc);db.Fx(xc);db.Mo(Vc);cc=this.bXi;
xc=this.dXi;Vc=this.S7d;Gb.hu(this.cXi);Gb.GQ(cc);Gb.Fx(xc);Gb.Mo(Vc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}Uza(){const {owj:ka,zke:db,dwj:Gb}=this.X7h();if(ka&&db&&Gb){this.sMd=!1;var cc=this.aXi,xc=this.fXi,Vc=this.U7d;ka.iV(this.eXi);ka.Nda(cc);ka.Pqa(xc);ka.jV(Vc);cc=this.gXi;xc=this.iXi;Vc=this.V7d;db.iV(this.hXi);db.Nda(cc);db.Pqa(xc);db.jV(Vc);cc=this.bXi;xc=this.dXi;Vc=this.S7d;Gb.iV(this.cXi);Gb.Nda(cc);Gb.Pqa(xc);Gb.jV(Vc)}else a.ULS.sendTraceTag(524149330,
389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}Mya(ka,db){ka&&this.J7a(ka)&&this.Fza.m9&&this.iUb&&this.Fza.bce(ka,db)}X7h(){return{owj:this.ro.Te(14),zke:this.ro.Te(15),dwj:this.ro.Te(16)}}J7a(ka){const db=T.App.za.jb.qc;return!!db&&db.kv&&!!db.ed&&!!db.ed.Lc&&!!ka&&!!ka.Lc&&ka.Lc.id===db.ed.Lc.id}I9c(){return!this.sMd&&!!this.Fza.m9}}Object(f.a)(Af,"TableNodeEventHandler",null,[585]);class jg{constructor(ka,db){this.PZi=ka;this.GEo=db}gGb(ka){return ka?14===ka.type||
15===ka.type||16===ka.type?this.GEo:12===ka.type?this.PZi:null:null}}Object(f.a)(jg,"NodeToTileConverterHolder",null,[584]);var Rf=c(370);class lj{get name(){return"Box4.AugmentationLoop"}wc(ka){this.W=ka;const db=this.W.resolve("Common.IAppSettingsManager"),Gb=db.$("AugLoopTaskUseTimeBasedYieldStrategy"),cc=new Qd,xc=Gb?new ba.a(db.lc("AugLoopTaskAllowedRunTimeBeforeYielding",10),G.a.We):new Y(db.lc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ia("Common.ICpuMeter",()=>P.a.instance).ha();this.W.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",
()=>new nb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.W.ia("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Ig(db,T.App.ni.zl.Te(12),cc,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.oc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),
this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();Ub.a.uhe()&&this.W.ia("Box4.AugmentationLoop.TableNodeEventHandler",()=>new Af(db,T.App.ni.zl,cc)).ha();this.W.ia("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new O).ha();this.W.ia("Box4.AugmentationLoop.IFormattingExtractor",()=>new te(this.W.resolve("Common.IAppSettingsManager"),this.W.Oa("Box4.IFeatureHelper"),
this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).ha();this.W.ia("Box4.AugmentationLoop.IAnnotationPolicies",()=>new ea.a(new V.a(()=>T.App.za.jb.Yc.vd),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.W.ia("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new vb(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),
new V.a(()=>T.App.za.jb.Yc.vd),ka.resolve("Box4.IFeatureHelper"))).ha();const Vc=this.W.resolve("IRoamingDictionary");this.W.ia("Box4.AugmentationLoop.IAnnotationStorage",()=>new Fb(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new V.a(()=>T.App.za.jb.Yc.vd),y.AFrameworkApplication.oc,this.W.Oa("Box4.IIntelligenceReader"),this.W.Oa("Box4.IIntelligenceEditor"),this.W.Oa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Oa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),
ka.resolve("Box4.IFeatureHelper"),Rf.a.instance,()=>{try{return Wa.a.getAugLoopRuntimeManager()}catch(Wd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Wd),null}},Vc)).ha();this.W.ia("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new jg(new Jh.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new ii)).ha();this.W.ia("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",
()=>new Pd(db,cc,y.AFrameworkApplication.oc,xc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ia("Box4.AugmentationLoop.IUtilsWrapper",()=>new ic).ha();this.W.ia("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new xb).ha()}init(){if(y.AFrameworkApplication.gG.BootFailed)a.ULS.sendTraceTag(512624089,
389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ka=new Cb(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.He,T.App.Y5,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),W.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),db=new Z;this.W.register(578,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().LZo(()=>
db);y.AFrameworkApplication.le("b8afb343;bjdjj400");y.AFrameworkApplication.le("72af9564;82jf1647");const Gb=Ub.a.B_m(this.W.resolve("Common.IDynamicScriptLoaderProvider").aA,this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),db);this.W.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Ja(Gb)).ha();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Ub.a.uhe()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();
this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){z.a.instance.Gc(new lj,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(lj,"Box4AugmentationLoopPackage",null,[1,2]);var Qh=c(608),ei=c(43),cl=c(12),ul=c(407),qi=c(1147);class Jg{constructor(ka,db,Gb,cc=null,xc=null,Vc=null){this.yM=new qi.a(db,cc,xc,Vc);this.Kb=
ka;this.Qc=Gb}get type(){return this.yM.type}get id(){return this.yM.id}get intent(){return this.yM.intent}yf(ka){return new Jg(ka,this.type,this.Qc,this.id,this.intent,this.yM.fya)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.yM,this.Qc)}}Object(f.a)(Jg,"IntentObject",null,[169]);var xi=c(476),Fj=c(149),km=c(248);class hg{constructor(){this.Iuc=new Fj.a}KAd(ka,db,Gb,cc,xc=null,Vc=null,Wd=null){ka=ka.a0(db,ka.qa.eMo(db));ka.Mj||(ka.Mj=new xi.a(ka));ka.Mj.add(new Jg(ka,Gb,cc,
xc,Vc,Wd));ka.U3a=!0}A9i(ka){return ka.Kb&&ka.Kb.Mj&&ka.Kb.Mj.Z5c(db=>db===ka,[ka.type])?!0:!1}B9i(ka,db){if(ka.type===db.type&&ka.Qc&&!db.Qc&&ka.Kb&&ka.Kb.Mj&&ka.Kb.Mj.contains(ka)&&db.Kb&&db.Kb.Mj&&db.Kb.Mj.contains(db)){var Gb=[ka.type];ka.Kb.Mj.Z5c(cc=>cc===ka,Gb);db.Kb.Mj.Z5c(cc=>cc===db,Gb)}}E_o(ka,db,Gb){if(!db)return!1;Gb=new ab.a([Gb]);for(let cc=0;cc<ka.length;cc++){const xc=ka.J(cc);if(!xc.Mj)continue;let Vc=!0;Gb.gVa(xc.Mj,void 0,Wd=>{Wd.id&&db.equals(Wd.id)&&(Vc=!1)});if(!Vc)return!1}return!0}QDn(ka,
db,Gb,cc){let xc=null,Vc=null;db=new ab.a([db]);const Wd=ka.qa;for(let re=0;re<Wd.length;re++){const od=Wd.J(re);if(!od.Mj)continue;let Be=!0;db.gVa(od.Mj,void 0,(ve,Wf)=>{if(Wf){var lg=Wf.Kb.cp<Gb,Kh=ve.Kb.cp>cc;lg&&ve.Kb.cp<=Gb||Wf.Kb.cp>=cc&&Kh||(lg&&Kh?Be=!1:lg?xc=ve:Kh?Vc=Wf:this.B9i(Wf,ve))}});if(!Be)return!1}if(xc){if(!this.A9i(xc))return!1;this.KAd(ka,Gb,xc.type,xc.Qc,xc.id,xc.intent,xc.yM.fya)}if(Vc){if(!this.A9i(Vc))return!1;this.KAd(ka,cc,Vc.type,Vc.Qc,Vc.id,Vc.intent,Vc.yM.fya)}return!0}Oeg(ka){let db;
return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:db}=this.Iuc.Fc(ka.type,db)).returnValue?db.Oeg(ka):!0}C8m(ka,db){if(this.Oeg(db)){var Gb=db.id,cc=db.type,xc=db.Ac,Vc=db.end;if(({cpEnd:Vc}=hg.XHj(ka,xc,Vc)).returnValue){if(ul.a(cc)){if(!this.E_o(ka.qa,Gb,cc))return}else if(!this.QDn(ka,cc,xc,Vc))return;this.KAd(ka,xc,cc,!0,Gb,db.intent,db.yM.fya);this.KAd(ka,Vc,cc,!1,Gb,db.intent,db.yM.fya)}}}W2c(ka,db){T.App.za.hhf(ka,()=>{const Gb=
new ei.GraphTransaction(2);try{Gb.Db(ka);const cc=ka.jZ();try{const xc=ka.Y_();try{db()}finally{xc&&xc.dispose()}}finally{cc&&cc.dispose()}}finally{Gb&&Gb.dispose()}})}IGa(ka,db){this.W2c(ka,()=>{this.C8m(ka,db)})}E8m(ka,db){if(db.count){var Gb=new Sa.a,cc=new km.a;for(var xc of db){var Vc=xc.value;ul.a(xc.key)||Vc.Sc((re,od)=>re.Ac!==od.Ac?re.Ac-od.Ac:re.end-od.end);if(hg.J_o(Vc))for(var Wd of Vc)Vc=Wd.end,({cpEnd:Vc}=hg.XHj(ka,Wd.Ac,Vc)).returnValue&&(Vc=Vc!==Wd.end?new yb.a(Wd.type,Wd.Ac,Vc,Wd.id,
Wd.intent,Wd.yM.fya):Wd,Gb.add(Vc.Ac),Gb.add(Vc.end),hg.prk(cc,Vc))}ka.QLd(Gb);ka=ka.qa;for(Gb=0;Gb<ka.length;Gb++){xc=ka.J(Gb);if(Wd=xc.Mj)for(const od of db.keys)Wd.v$i(od);let re;({value:re}=cc.Fc(xc.cp,re)).returnValue||(re=null);if(re){Wd||(Wd=xc.Mj=new xi.a(xc));for(const od of re)Wd.add(od.yf(xc))}xc.U3a=!0}}}CNf(ka,db){const Gb=new Fj.a;for(const cc of db){let xc;({value:xc}=Gb.Fc(cc.type,xc)).returnValue||(xc=new ib.a,Gb.Z(cc.type,xc));xc.add(cc)}this.W2c(ka,()=>{this.E8m(ka,Gb)})}yPo(ka,
db,Gb){ka=ka.qa;const cc=new ab.a([8]);db===Gb&&(Gb+=1);for(let xc=0;xc<ka.length;xc++){const Vc=ka.J(xc);Vc.Mj&&cc.gVa(Vc.Mj,void 0,(Wd,re)=>{re&&Math.max(re.Kb.cp,db)<Math.min(Wd.Kb.cp,Gb)&&this.B9i(re,Wd)})}}gng(ka,db,Gb){this.W2c(ka,()=>{this.yPo(ka,db,Gb)})}APo(ka,db){ka=ka.qa;for(let Gb=0;Gb<ka.length;Gb++){const cc=ka.J(Gb);cc.Mj&&cc.Mj.v$i(db)}}YUa(ka,db){this.W2c(ka,()=>{this.APo(ka,db)})}zPo(ka,db,Gb){let cc=!1;db=db.qa;Gb=[Gb];for(let xc=0;xc<db.length;xc++){const Vc=db.J(xc);Vc.Mj&&(cc=
Vc.Mj.Z5c(ka,Gb)||cc)}return cc}hcd(ka,db,Gb){let cc=!1;this.W2c(db,()=>{cc=this.zPo(ka,db,Gb)});return cc}uRd(ka,db,Gb,cc){return!ka||0>Gb||cc>ka.characterData.length||Gb>cc?new ib.a:this.LPa(ka,db,xc=>Math.max(xc.Ac,Gb)<=Math.min(xc.end,cc))}LPa(ka,db,Gb){return hg.v_l(ka,db,Gb)}static v_l(ka,db,Gb){const cc=new ib.a;ka=ka.qa;db=new ab.a([db]);if(!ka)return cc;for(let xc=0;xc<ka.length;xc++){const Vc=ka.J(xc);Vc.Mj&&db.gVa(Vc.Mj,void 0,(Wd,re)=>{re&&(Wd=new yb.a(re.type,re.Kb.cp,Wd.Kb.cp,re.id,
re.intent,re.yM.fya),Gb(Wd)&&cc.add(Wd))})}return cc}eQc(ka,db){const Gb=new ib.a;if(!hg.FUm(ka.contextId))return Gb;let cc;const xc=ka.node;ka.contextId!==cl.a.paragraph?(cc=ka.cpBegin,ka=ka.cpEnd):(cc=0,ka=xc.characterData.length);Gb.addRange(this.uRd(xc,db,cc,ka));return Gb}$Tn(ka){this.Iuc.nb(0)||this.Iuc.Z(0,ka)}static XHj(ka,db,Gb){ka=Za.ParagraphReader.textLength(ka);if(db>=ka)return{returnValue:!1,cpEnd:Gb};Gb>ka&&(Gb=ka);return{returnValue:!0,cpEnd:Gb}}static J_o(ka){if(!ka.count)return!0;
const db=new Qh.a,Gb=ka.J(0).type,cc=ul.a(Gb);let xc=-1;for(const Vc of ka){if(Vc.type!==Gb||(ul.c(Vc.type)?Vc.Ac>Vc.end:Vc.Ac>=Vc.end))return!1;if(cc){ka=Vc.id;if(!ka||ka.equals(ia.a.nil)||db.contains(ka))return!1;db.add(ka)}else if(-1===xc)xc=Vc.end;else if(xc>Vc.Ac)return!1}return!0}static prk(ka,db){let Gb;({value:Gb}=ka.Fc(db.Ac,Gb)).returnValue||(Gb=new ib.a,ka.Z(db.Ac,Gb));Gb.add(new Jg(null,db.type,!0,db.id,db.intent,db.yM.fya));({value:Gb}=ka.Fc(db.end,Gb)).returnValue||(Gb=new ib.a,ka.Z(db.end,
Gb));Gb.add(new Jg(null,db.type,!1,db.id,db.intent,db.yM.fya))}static FUm(ka){return ka===cl.a.Jd||ka===cl.a.Tc||ka===cl.a.paragraph}}Object(f.a)(hg,"IntentRangeEditor",null,[588]);class Wg{constructor(){this.W=null}get name(){return"Box4.Intent"}wc(ka){this.W=ka;this.W.ia("Box4.Intent.IntentRangeEditor",()=>new hg).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){z.a.instance.Gc(new Wg,0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}
Object(f.a)(Wg,"PackageManager",null,[1,2]);var ej=c(1037),tm=c(110),nl=c(1415);class Pg{constructor(ka){this.R6m=ka;this.N6m=[]}get handler(){return this.R6m}get Xna(){return this.N6m}}Object(f.a)(Pg,"RegisteredListener",null,[]);class fi{constructor(ka,db){this.type=0;this.payload=null;this.type=ka;this.payload=db}}Object(f.a)(fi,"OfficeSharedCommentsEvent",null,[860]);class Em{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(Em,"ViewContainerEvent",
null,[860]);var kg=c(582);class aj{constructor(ka){this.WMf=!1;this.Wpa=new ib.a;this.f3d=ka}wTn(ka){ka=new Pg(ka);this.Wpa.add(ka)}tCj(ka){for(let db=0;db<this.Wpa.count;++db)if(this.Wpa.J(db).handler===ka){this.Wpa.removeAt(db);break}}ETa(ka=!1){const db=()=>{if(y.AFrameworkApplication.Lk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let xc=0;xc<this.Wpa.count;++xc){const Vc=this.Wpa.J(xc);for(;0<Vc.Xna.length;){var Gb=Array.dequeue(Vc.Xna);
if(Object(tm.a)(Em,Gb)){var cc=Vc.handler;cc(Gb)}else Object(tm.a)(fi,Gb)&&(cc=Vc.handler,cc(Gb.type,Gb.payload))}}};ka?db():this.WMf||(this.WMf=!0,kg.a.E3(this.f3d,()=>{db();this.WMf=!1},nl.a.bFl))}}Object(f.a)(aj,"GenericEventHost",null,[]);class Ri{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=
this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(Ri,"BasicEventPayload",null,[889]);class Qk{constructor(ka){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(f.a)(Qk,"CommentContextDetails",null,[]);class dl{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}
Object(f.a)(dl,"ContextChangeWithSelectedThreadIndex",null,[889]);class dm{constructor(){this.tasks=this.comments=null}}Object(f.a)(dm,"LoadCommentsNoVirtualization",null,[889]);class xn extends aj{constructor(ka){super(ka);this.Gch=0}oko(){this.Gch=1656}gUn(ka,db,Gb,cc,xc,Vc){ka=new Pg(ka);Vc&&Array.enqueue(ka.Xna,this.S7k(Vc,this.Gch));Vc=db?db.length:0;Array.enqueue(ka.Xna,this.bKh(Vc,Gb,cc,0));Vc&&Array.enqueue(ka.Xna,this.dLh(db,xc));this.Wpa.add(ka);this.ETa()}eSb(ka){this.tCj(ka)}Yao(ka,db,
Gb,cc=0){this.aIb(this.bKh(ka,db,Gb,cc));this.ETa()}Zao(ka,db,Gb){this.aIb(this.r8k(ka,db,Gb));this.ETa()}xbo(ka,db){this.aIb(this.dLh(ka,db));this.ETa()}selectComment(ka){this.aIb(this.gMh(ka,6));this.ETa()}highlightComment(ka){this.aIb(this.gMh(ka,7));this.ETa()}vog(ka,db){this.aIb(this.Hal(ka,db));this.ETa()}s0f(ka,db){this.aIb(this.Hcl(ka,db));this.ETa()}S7k(ka,db=0){const Gb=new Ri;Gb.modelCapabilityFlags=ka;Gb.richTextCapabilityFlags=db;return new fi(12,Gb)}bKh(ka,db,Gb,cc){const xc=new Ri;
xc.numberOfComments=ka;xc.numberOfThreads=db;xc.contextDetails=Object.assign(new Qk(Gb),{nextPopulatedContextDetails:cc});xc.contextDrafts=null;xc.rehydrationDrafts=null;return new fi(0,xc)}r8k(ka,db,Gb){const cc=new Ri;cc.comments=ka;cc.numberOfThreads=db;cc.tasks=Gb;return new fi(2,cc)}dLh(ka,db){const Gb=new dm;Gb.comments=ka;Gb.tasks=db;return new fi(1,Gb)}gMh(ka,db){const Gb=new Ri;Gb.commentId="";ka&&(Gb.commentId=ka);return new fi(db,Gb)}Hal(ka,db){const Gb=new Ri;Gb.changes=[];Gb.contextDetails=
Object.assign(new Qk(db),{nextPopulatedContextDetails:ka});return new fi(10,Gb)}Hcl(ka,db){const Gb=new Ri;Gb.commentId=ka;Gb.smartReplies=db;return new fi(15,Gb)}aIb(ka){for(let db=0;db<this.Wpa.count;++db)Array.enqueue(this.Wpa.J(db).Xna,ka)}}Object(f.a)(xn,"OfficeSharedCommentsEventHost",aj,[876]);var ah=c(231),Tn=c(175),Jj=c(273);class Yi{constructor(){this.wRe=this.sJg=!1;this.NI=this.Fp=this.QYg=this.f4g=this.qzd=this.tZb=this.nhh=this.aOg=this.aA=this.vCc=null}initialize(ka,db,Gb,cc=null,xc=
null,Vc=null,Wd=null,re=null,od=null,Be=null){this.aA=ka;this.aOg=db;this.nhh=Gb;this.tZb=cc;this.qzd=xc;this.f4g=Vc;this.QYg=Wd;this.Fp=re;this.sJg=!0;this.NI=od;this.vCc=Be}pXd(ka=null,db=null){if(!this.sJg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Gb,cc)=>{cc(kg.a.MD(-2130915313))});if(this.wRe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.vCc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.vCc=appResourceLoader.loadChunk("sharedComments"):this.vCc=this.aA.loadScript("sharedComments"));return this.vCc.then(()=>{ka&&ka();this.wRe||(this.NI&&this.NI.execute(Gb=>{Gb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),db&&db(),sharedComments.instantiate(this.aOg,this.nhh,this.tZb,this.qzd,this.f4g,this.QYg,this.Fp));this.wRe=!0})}}Object(f.a)(Yi,
"CommentActivationManager",null,[921]);class Lm extends aj{constructor(ka){super(ka)}VVn(ka){this.wTn(ka)}vQo(ka){this.tCj(ka)}Emj(ka){ka=this.n8k(ka);for(let db=0;db<this.Wpa.count;++db)Array.enqueue(this.Wpa.J(db).Xna,ka);this.ETa(!0)}n8k(ka){const db=new Em;db.eventType=3;db.viewContainerVisibilityState=ka;return db}zFl(){const ka=this.Ndl();for(let db=0;db<this.Wpa.count;++db)Array.enqueue(this.Wpa.J(db).Xna,ka);this.ETa(!0)}Ndl(){const ka=new Em;ka.eventType=2;return ka}}Object(f.a)(Lm,"ViewContainerEventHost",
aj,[842]);var bn=c(54);class zh{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(zh,"CommentUIActionPayload",null,[]);var vg=c(304);class jl{constructor(ka,db){this.ga=ka;this.gsb=db;this.Vpc=new vg.a;for(let Gb of this.gsb)this.Vpc.Z(Gb.value.canvasActionId,Gb.key),ka=Gb.value,ka.delayActionsUntilRegistration||this.ra(ka)}ra(ka){ka.withFlags?this.ga.fb(ka.canvasActionId,ka.canvasContextId,Object(bn.a)(this,this.Plh,"actionHandler"),97):this.ga.ra(ka.canvasActionId,ka.canvasContextId,
Object(bn.a)(this,this.Plh,"actionHandler"))}bTa(ka,db){this.gsb.nb(ka)&&(this.gsb.J(ka).delayActionsUntilRegistration&&this.ra(this.gsb.J(ka)),this.gsb.J(ka).registeredCallback=db)}Plh(ka,db,Gb,cc,xc){if(this.Vpc.nb(ka)){var Vc=this.Vpc.J(ka);if(!this.gsb.nb(Vc))return 8;const Wd=this.gsb.J(Vc);if(Wd.preCallback){const re=Wd.preCallback(ka,db,Gb,cc,xc);if(2!==re)return re}if(!Wd.registeredCallback)return 1===Gb?8:2;Vc=Object.assign(new zh,{actionType:Vc});1===Gb&&(Vc.actionBehavior=1);Vc=Wd.registeredCallback(Vc);
return Wd.postCallback?Wd.postCallback(Vc,ka,db,Gb,cc,xc):Vc?32:8}return 2}}Object(f.a)(jl,"OfficeSharedCommentsActionHost",null,[878]);var Cl=c(1828),um=c(67),Qm=c(131),oj=c(1468),ph=c(13),cd=c(27),dg=c(546),vm=c(1152),Rm=c(133),ce=c(306),md=c(48),mg=c(21),Kg=c(1056),Jd=c(1048),tg=c(1581),xd=c(173),Oi=c(11),he=c(37),Ng=c(703),wk=c(472),Vj=c(15),Xg=c(2050);class jf{constructor(ka){this.nW=ka;this.whc=new N.a;this.$2a=new N.a;this.Yym();this.Fsm=[new Xg.a(he.a.pFh,he.a.X_k),new Xg.a(he.a.lGd,he.a.W_k),
new Xg.a(he.a.gFh,he.a.J_k),new Xg.a(he.a.dGd,he.a.I_k),new Xg.a(he.a.qFh,he.a.Z_k),new Xg.a(he.a.mGd,he.a.Y_k)]}gTa(ka){this.nW.gTa(ka);this.eXn(ka)}qFf(ka,db){return!!ka&&!!ka.objectId&&db.contains(ia.a.Ff(ka.objectId))}lRa(ka){ka=Object(Pb.a)(732,ka);return!!ka&&!!ka.objectId}eXn(ka){for(const db of this.Fsm)ka.classList.remove(db.className,db.MRc);ka.classList.remove(he.a.R_f,he.a.oGd,he.a.hFh,he.a.nGd,jf.Esg)}Yym(){const ka=new N.a,db=new N.a;ka.add(0,null);ka.add(1,he.a.lGd);ka.add(2,he.a.pFh);
ka.add(3,he.a.oGd);db.add(0,null);db.add(1,he.a.dGd);db.add(2,he.a.gFh);db.add(3,he.a.hFh);this.$2a.Z(1,ka);this.$2a.Z(2,db);this.$2a.Z(3,db);this.whc.add(0,null);this.whc.add(1,he.a.mGd);this.whc.add(2,he.a.qFh);this.whc.add(3,he.a.nGd)}}jf.Esg="CommentImportant";Object(f.a)(jf,"CommentHighlightUtils",null,[]);class sf{constructor(){this.tLd=0;this.ZBb=null}}Object(f.a)(sf,"CommentGuidsInElementInfo",null,[]);class Rh{constructor(){this.Wli=!1;this.ina=this.uMb=null;this.ISa=this.wHb=0}}Object(f.a)(Rh,
"HighlightInfoForElement",null,[]);class ij{constructor(){this.xpi=this.zpi=this.ypi=-1;this.sni=[];this.u4b=[];this.NTc=this.OTc=-1;this.Cui=!1}}Object(f.a)(ij,"HighlightInfoForElementsInPara",null,[]);class hn{constructor(){this.dng=this.hWf=null}}Object(f.a)(hn,"OnAnchorMouseOutData",null,[]);var pg=c(1509);class Rl{constructor(ka,db,Gb,cc,xc,Vc,Wd,re){this.Hve=ka;this.eaa=db;this.qk=Gb;this.I2=cc;this.ga=xc;this.Ib=Vc;this.$i=Wd;this.ZXa=this.Zi=null;this.Zjn=od=>{if(!this.Zi||this.I2.AZd)return!0;
if(od=od.Uo){if(this.Zi.Sz&&od[0].toString()===this.Zi.Sz.objectId)return!0;this.ZXa&&od[0].equals(this.ZXa.dng[0])?this.Ib.Ze(this.ZXa.hWf):(this.ZXa&&(this.Ib.Ze(this.ZXa.hWf),this.ga.Rb(ph.a.pGd,2,this.ZXa.dng)),this.Zi.Co.Dui(od[0])&&!this.$i.xm||this.ga.Rb(ph.a.h8e,2,od));this.ZXa=null}return!0};this.Yjn=od=>{if(this.I2.AZd)return!0;const Be=od.Uo;Be&&(od=new la.a(2,1,0,()=>{this.ga.Rb(ph.a.pGd,2,Be);this.ZXa=null}),this.Ib.Xb(od),this.ZXa=Object.assign(new hn,{hWf:od,dng:Be}));return!0};this.ISi=
od=>{const Be=new la.a(2,1,0,()=>{if(this.Zi&&!this.Zi.Co.Px){var ve=od.Uo;if(!ve)ve=T.App.za.Dp.currentScope,this.Zi.Sz&&(!ve||ve.name!==xd.AFrame.GM&&ve.name!==xd.AFrame.Qr)&&this.Zi.clearSelection();else if(!this.Zi.Sz||ve.toString()!==this.Zi.Sz.objectId)if(ve=this.Zi.Co.f0(ve.toString()))ve=Object.assign(new oj.a,{commentId:ve.id,iS:!1,s$:1}),this.ga.Rb(Vj.a.selectComment,2,ve)}});this.Ib.Xb(Be);return!1};re.execute(od=>{this.Zi=od})}yxh(ka,db,Gb,cc){const xc=new ij,Vc=[],Wd=this.eaa.lRa(db)?
db.objectId:null;for(let Be=0,ve=ka.length;Be<ve;Be++){var re=ka[Be],od=pg.g(re);const Wf=pg.d(re);re=new Qh.a;const lg=new Rh;if(od){const Kh=new wk.a(pg.c);od=this.fZh(od,Wd,Kh);0<od.length&&(this.bUo(od,Gb,re,lg,Wd,cc),Vc.push(Object.assign(new sf,{tLd:Be,ZBb:Kh})))}Wf&&(od=this.fZh(Wf,Wd),0<od.length&&(this.dUo(od,Gb,re,lg,xc,Wd,cc,Be),this.rSo(Vc,od,Be,lg)));0<Gb.count&&this.eUo(db,Gb,lg,cc);this.pSo(Vc,lg);xc.sni.push(lg)}return xc}Xsh(ka,db,Gb){let cc=!1;for(let xc=0,Vc=ka.length;xc<Vc;xc++){const Wd=
ka[xc],re=db.sni[xc],od=Ng.a(Wd);if(1!==od&&2!==od&&3!==od)continue;const Be=3===od||2===od&&-1!==Wd.className.indexOf(he.a.pQa);this.eaa.gTa(Wd);this.osk(Wd,re,Be,cc);this.ark(Wd,xc,od,re,db,Gb);this.brk(Wd,xc,db,re);cc=Be}}fZh(ka,db,Gb=null){const cc=[];for(let xc=0;xc<ka.length;xc++)this.Hve.boj(ka[xc],ka[xc].toString()===db)&&(cc.push(ka[xc]),Gb&&Gb.add(ka[xc]));return cc}bUo(ka,db,Gb,cc,xc,Vc){var Wd;let re=!1,od=!1;for(const ve of ka){db.add(ve);Gb.add(ve);var Be=ve.toString();Be===xc?(Be=Vc?
1:2,cc.ISa=Be,cc.wHb=Be):this.qFf(this.Zi.Sz,db)&&(Be===(null===(Wd=this.Zi.Sz)||void 0===Wd?void 0:Wd.objectId)&&(od=!0),re=!0)}0<ka.length&&!cc.ISa&&(cc.ISa=od?1:3,cc.wHb=re?1:3)}dUo(ka,db,Gb,cc,xc,Vc,Wd,re){var od,Be;const ve=new wk.a(pg.c);Wd=Wd?1:2;let Wf=!1;for(const lg of ka){const Kh=lg.toString();db.contains(lg)||(Kh===Vc?xc.xpi=re:(xc.ypi=re,cc.ISa=3,(null===(od=this.Zi.Sz)||void 0===od?void 0:od.objectId)===Kh&&(xc.zpi=re,cc.ISa=1)),ve.add(lg));Kh===(null===(Be=this.Zi.Sz)||void 0===Be?
void 0:Be.objectId)&&(Wf=!0);db.remove(lg);Gb.contains(lg)&&this.cUo(cc,lg,Kh,Vc,Wd);Kh===Vc&&(cc.ISa=Wd)}0<ka.length&&!cc.ISa&&(cc.ISa=Wf?1:3);0<ve.count&&xc.u4b.push(Object.assign(new sf,{tLd:re,ZBb:ve}))}rSo(ka,db,Gb,cc){0!==ka.length&&(db.forEach(xc=>{for(let Vc=ka.length-1;0<=Vc;Vc--){const Wd=ka[Vc];if(Wd.ZBb.contains(xc)){Wd.tLd===Gb&&(cc.ina?cc.ina.push(xc):cc.ina=[xc]);Wd.ZBb.remove(xc);break}}}),ka=ka.filter(xc=>0<xc.ZBb.count))}eUo(ka,db,Gb,cc){var xc,Vc;this.qFf(ka,db)?Gb.wHb=cc?1:2:Gb.wHb||
(Gb.wHb=null!=(null===(xc=this.Zi.Sz)||void 0===xc?void 0:xc.objectId)&&db.contains(ia.a.Ff(null===(Vc=this.Zi.Sz)||void 0===Vc?void 0:Vc.objectId))?1:3);Gb.uMb||(Gb.uMb=[]);for(const Wd of db)Gb.uMb.push(Wd)}pSo(ka,db){if(0<ka.length){db.ina||(db.ina=[]);for(const Gb of ka[ka.length-1].ZBb)db.ina.push(Gb)}}cUo(ka,db,Gb,cc,xc){ka.Wli=!0;ka.uMb||(ka.uMb=[]);ka.uMb.push(db);Gb===cc&&(ka.wHb=xc)}qFf(ka,db){return!!ka&&!!ka.objectId&&db.contains(ia.a.Ff(ka.objectId))}osk(ka,db,Gb,cc){!db.ISa||Gb||cc||
((Gb=this.eaa.whc.J(db.ISa))&&ka.classList.add(Gb),db.Wli&&ka.classList.add(he.a.R_f))}ark(ka,db,Gb,cc,xc,Vc){cc=this.eaa.$2a.J(Gb).J(cc.wHb);db<xc.xpi?cc=Vc?this.eaa.$2a.J(Gb).J(1):this.eaa.$2a.J(Gb).J(2):db<xc.ypi&&!cc&&(cc=db<xc.zpi?this.eaa.$2a.J(Gb).J(1):this.eaa.$2a.J(Gb).J(3));cc&&(db=xc.Cui,ka.classList.add(cc),db&&ka.classList.add(jf.Esg))}brk(ka,db,Gb,cc){cc.ina||(cc.ina=this.jQl(db,Gb)||cc.uMb);db=null;cc.ina&&0<cc.ina.length&&(this.qk.ob(Oi.a.W0,ka,this.Zjn,cc.ina),this.qk.ob(Oi.a.Wxa,
ka,this.Yjn,cc.ina),db=cc.ina[0]);this.qk.ob(Oi.a.click,ka,this.ISi,db);this.qk.ob(Oi.a.eK,ka,this.ISi,db)}jQl(ka,db){for(;0<db.u4b.length&&db.u4b[0].tLd===ka;)db.u4b.splice(0,1);if(0<db.u4b.length){ka=[];for(const Gb of db.u4b[0].ZBb)ka.push(Gb);return ka}return null}}Object(f.a)(Rl,"AllMarkupModeHighlightChangeHandler",null,[726]);var nh=c(1481);class vl extends nh.a{constructor(ka){super(100,25);this.Tpc=new N.a(0);this.ETj=6E4;this.YEl=()=>{const db=this.Tpc.keys;if(db.length){var Gb="";for(let cc=
0;cc<db.length;cc++)Gb+=db.J(cc)+":"+this.Tpc.J(db.J(cc))+";";this.Kqa(Gb);this.Tpc=new N.a(0)}};this.ssb=new ib.a;this.ssb.add(1);this.ssb.add(6);this.ssb.add(2);this.ssb.add(4);this.ssb.add(10);this.ssb.add(11);this.Mg=ka;ka.J4f&&window.setInterval(this.YEl,this.ETj)}MHa(ka){this.Mg.mOo&&this.Mg.J4f&&(this.ssb.contains(ka)?this.hOn(ka):this.Kqa(ka+""))}hOn(ka){this.Tpc.Z(ka,this.Tpc.Cz(ka,0)+1)}}Object(f.a)(vl,"CommentActionInTypingRecorder",nh.a,[737]);var Dl=c(1622),oe=c(241);class Yg{static tYn(ka){ka&&
ka.atmention&&delete ka.atmention.isCurrentUser;return ka}}Object(f.a)(Yg,"DeltaFormatHelpers",null,[]);class Vh{constructor(){this.optional=this.attributes=null}}Object(f.a)(Vh,"Operation",null,[]);class Tf extends Vh{constructor(){super();this.insert=null}}Object(f.a)(Tf,"DeltaOperation",Vh,[]);class Hf{constructor(){this.ops=null}}Object(f.a)(Hf,"Delta",null,[]);var sh=c(135),sj=c(186),Tk=c(148),El=c(59),$g=c(74),Ef=c(100),em=c(495),Di=c(1195),Zf=c(1792);class eb extends Zf.ACommentFormatTranslator{constructor(ka,
db){super(ka);this.ue=db}hlg(ka){const db=new Dl.a;for(let Gb=0;Gb<ka.length;Gb++){const cc=ka[Gb];cc.AIb=!0;this.bCk(db,cc);db.Jca("\n")}return[db.Z8b()]}sIo(ka,db){ka=Dl.a.xFb(ka[0]);ka=this.oEn(ka);const Gb=new ib.a;let cc=0,xc=null,Vc=null;for(;cc<ka.ops.length;){const Wd=ka.ops[cc];xc||(xc=Di.a.instance.createInstance(393230),xc.AIb=!0,xc.Dg(sa.a.Wc,oe.a.zF()),db(xc),xc.qa.clear(),xc.dra(""));"\n"===Wd.insert?(Vc=this.aLf(xc,Vc),this.Omo(xc),Gb.add(xc),xc=null):Vc=this.H0m(xc,Wd,Vc);cc++}return Gb.toArray()}Omo(ka){const db=
ka.kzh();for(let Gb=0;Gb<db;Gb++)ka.we.rq.Z(Gb,eb.qen),ka.we.kt.Z(Gb,eb.YRf)}aLf(ka,db){var Gb=ka.PLd();Gb.cp===ka.characterData.length?Gb.Oh=!0:(Gb=Object.assign(new sj.a(ka,ka.characterData.length),{Oh:!0}),ka.qa.add(Gb));Gb=ka.qa.last;if(db){db=!!db.kw;const cc=this.NGh(ka,Gb,!db,db,null);Gb.formatting=cc;db&&(ka=this.LGh(ka,Gb),Gb.xU=ka.Tj);Gb.Wm=!0;db=null}Gb.cp||Gb.formatting||(Gb.formatting=new Tk.a(Gb,ia.a.nil));return db}H0m(ka,db,Gb){const cc=ka.PLd(),xc=!!db.attributes&&!!db.attributes.link,
Vc=!!db.attributes&&!!db.attributes.atmention,Wd=this.NGh(ka,cc,xc,Vc,db);cc.formatting=Wd;Gb&&(Gb.kw&&(Gb=this.LGh(ka,cc),cc.xU=Gb.Tj),cc.Wm=!0,Gb=null);if(xc||Vc)this.e0m(cc,ka,db),Gb=cc.hyperlink;ka.dra(ka.characterData+db.insert);return Gb}LGh(ka,db){db=new Tk.a(db,ia.a.create());let Gb=this.xId();Gb.setValue(sa.a.AJb,!0);Gb=ka.Lc.fV(Gb);db.Tj=Gb.id;return db}NGh(ka,db,Gb,cc,xc){db=new Tk.a(db,ia.a.create());let Vc=Di.a.instance.createInstance(1179649);if(Gb||cc)Vc.setValue(Ac.a.OB,!0),Vc.setValue(Ac.a.J4,
!0),Gb&&this.seo(ka,Vc);this.Mg.TAb&&xc&&xc.attributes&&this.pko(xc.attributes,Vc);Vc=ka.Lc.fV(Vc);db.Tj=Vc.id;return db}seo(ka,db){(ka=this.ue.ZC(ka))&&(ka=ka.jj(El.StyleReader.Toc))&&db.setValue(gd.a.nw,ka.id)}pko(ka,db){this.NPb(ka.weight>=Dl.a.V3d,db,Ac.a.bold,!0);this.NPb(ka.italic,db,Ac.a.italic,!0);this.NPb(ka.underline,db,Ac.a.underline,!0);this.NPb(ka.underline,db,Ac.a.underlineType,ge.a.aSb);this.NPb(ka.strikethrough,db,Ac.a.strikethrough,!0);if($g.a.$Xc(ka.highlight)){var Gb=$g.a.tFa(ka.highlight);
this.NPb(!!ka.highlight,db,Ac.a.highlight,$g.a.y5(Gb))}$g.a.$Xc(ka.color)&&(Gb=$g.a.tFa(ka.color),this.NPb(!!ka.color,db,Ac.a.fontColor,$g.a.y5(Gb)))}NPb(ka,db,Gb,cc){ka&&db.setValue(Gb,cc)}e0m(ka,db,Gb){if(Gb.attributes&&Gb.attributes.atmention){var cc=Ef.a.PPa(Gb.attributes.atmention.email);Gb=Gb.optional&&Gb.optional.atmention&&Gb.optional.atmention.contentId?Gb.optional.atmention.contentId:eb.VIl(1===Gb.attributes.atmention.resolveState);cc=new em.a(ka,cc,!0,void 0,void 0,void 0,Gb);this.h7k(cc,
db.Lc);ka.hyperlink=cc}else db=Ef.a.PPa(Gb.attributes.link),cc=this.Z9k(ka.paragraph.qa.first),ka.hyperlink=new em.a(ka,db,!1,cc.Tj)}Z9k(ka){let db=this.XLh();db=ka.paragraph.Lc.fV(db);ka=new Tk.a(ka,ia.a.nil);ka.Tj=db.id;return ka}h7k(ka,db){var Gb=String.format(' HYPERLINK "{0}"',ka.url),cc=ka.kw;const xc=this.xId();xc.setValue(sa.a.Is,15);xc.setValue(sa.a.kw,cc);xc.setValue(sa.a.iRa,!0);xc.setValue(sa.a.HX,Gb);ka.wua(db.fV(xc).id);cc=this.xId();cc.setValue(sa.a.Is,47);cc.setValue(sa.a.HX,Gb);ka.wua(db.fV(cc).id);
Gb=this.xId();Gb.setValue(sa.a.Is,16);ka.wua(db.fV(Gb).id)}XLh(){const ka=Di.a.instance.createInstance(1179649);ka.setValue(Ac.a.OB,!0);ka.setValue(Ac.a.J4,!0);ka.setValue(Ac.a.isHidden,!0);return ka}xId(){const ka=this.XLh();ka.setValue(Ac.a.N$,!0);return ka}oEn(ka){const db=new ib.a;for(let Gb=0;Gb<ka.ops.length;Gb++){const cc=ka.ops[Gb];cc.optional=Yg.tYn(cc.optional);if(-1!==cc.insert.indexOf("\n")&&"\n"!==cc.insert){const xc=cc.insert.split("\n");for(let Vc=0;Vc<xc.length;Vc++)if(Gb!==ka.ops.length-
1||Vc!==xc.length-1||xc[Vc])db.add(Object.assign(new Tf,{insert:xc[Vc],attributes:cc.attributes,optional:cc.optional})),Vc!==xc.length-1&&db.add(Object.assign(new Tf,{insert:"\n"}))}else db.add(cc)}return Object.assign(new Hf,{ops:db.toArray()})}static VIl(ka){return Zf.ACommentFormatTranslator.eGk+sh.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}eb.qen=0;eb.YRf=0;Object(f.a)(eb,"CommentDeltaFormatTranslator",Zf.ACommentFormatTranslator,[]);var Kb=c(1682),fc=c(1584);
class Hc{get userPrincipalName(){return this.K.kb("UserPrincipalName")}constructor(ka,db,Gb){this.Gj=ka;this.K=db;this.VK=Gb}UD(ka){return this.Gj.UD(ka)}qHm(ka){ka=this.Gj.UD(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}AVc(ka){return this.Gj.AVc(ka)}isCurrentUserMentioned(ka){var db,Gb;ka=this.Gj.ZPl(ka);for(const cc of ka){if(!cc.text||0===cc.text.length)continue;ka=Dl.a.xFb(cc.text[0]);let xc=0;for(;ka.ops&&xc<ka.ops.length;){const Vc=
null===(Gb=null===(db=ka.ops[xc])||void 0===db?void 0:db.attributes)||void 0===Gb?void 0:Gb.atmention;if(Vc&&Vc.email===this.userPrincipalName)return!0;xc++}}return!1}o1c(){this.VK.i$("OnContentFilterUpdate")}}Object(f.a)(Hc,"CommentFilterActor",null,[736]);var Pc=c(101),ec=c(2045),Ld=c(894),De=c(600);class cf{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od){this.Wh=ka;this.Ib=db;this.oi=Gb;this.IVa=cc;this.$i=xc;this.u2=Vc;this.uh=Wd;this.MT=re;this.rN=od;this.zub=null;this.IUe=0;this.Rod=!1;this.ltd=0;this.pSb=
this.m$c=this.eNg=this.exc=this.Pzb=!1;this.updateViewportInfo=()=>{this.MT.pfg()&&this.uh.updateViewportInfo(this.Rod,this.RXf)};this.Rmb=()=>{this.uh.zma.rpa()&&(this.u5c(this.uh.zma.qc),this.uh.zma.Kic(this.Rmb))};this.RXf=()=>{this.U8a();this.MT.QXf()};this.$hg=()=>{!this.Pzb&&this.MT.Feg()&&(this.ltd=this.LWe.scrollTop,this.Pzb=!0,this.IVa.MHa(2))};this.g5f=(Be,ve)=>{this.Pzb&&(Be=this.LWe.scrollTop,Be-this.ltd?(this.exc||ve.voe||this.updatePosition(),this.exc||1!==ve.voe||this.U8a(),this.M_e(Be),
this.MT.MWf()):this.exc=this.Pzb=!1)};this.LWe=this.uh.Cea;this.bja=De.a.G8d;this.rt=this.uh.rt;this.uh.BGh()}get eZd(){return this.MT.BGf()}get bja(){return this.uh.bja}set bja(ka){this.uh.bja=ka}get Nth(){return"1"===this.rt.vF.style.opacity}onj(ka){this.m$c||(this.m$c=!0,this.uh.h1i(),this.zub=ka(this.rt.IFa,this.uh.j$i,()=>{this.updatePosition()}),this.uh.$Ii(this.zub),this.MT.initialize(this.zub,this),this.uh.initialize(this.zub,this.MT.Tmb),this.uh.I7i(),this.uh.inj(),this.uh.jnj(),this.uh.nnj(this.MT.$2e,
this.MT.E7d,this.MT.D7d),this.R5f())}m9c(){}phe(){return this.uh.goj()}setInitialActiveContainerId(ka,db,Gb=null){this.uh.setInitialActiveContainerId(ka,0,Gb)}updatePosition(){if(!this.pSb&&this.eZd&&this.Wh.P$b()){var ka=G.a.We()-this.IUe<De.a.GFj;ka||this.Rod||this.U8a(ka)}}e2e(){this.U8a()}GTa(ka,db,Gb){this.rN.ehb&&this.u2.i$("OnFloatingCommentsVisibilityChange",!0);this.uh.GTa(ka,db,Gb)}deleteContainer(ka,db,Gb=!1){this.uh.deleteContainer(ka,db,()=>{this.Wh.hSc()||this.uh.KVd();this.MT.QUf()},
Gb)}addContainer(ka,db,Gb){this.uh.addContainer(ka,db,Gb,this.uh.hl,this.MT.tQc,this.MT.zTf)}M_i(ka){this.pSb=!0;ka();this.pSb=!1}k6c(ka,db,Gb){this.uh.k6c(ka,db,Gb)}g4b(){this.uh.g4b()}bGj(){const ka="1"===this.rt.vF.style.opacity;switch(!0){case ka&&!this.Wh.hSc():this.uh.KVd();break;case !ka&&this.Wh.hSc():this.uh.GQb()}}vlg(ka=!0){this.MT.kfg&&this.uh.vyj(ka)}static s7h(ka,db=null){const Gb=new bb.a;for(const cc of ka)cc.Af||cc.Xq!==ec.a.beingCreated&&(!db||db(cc))&&cf.Rpk(Gb,cc.objectId,cc);
return Gb}static Rpk(ka,db,Gb){let cc;({value:cc}=ka.Fc(db,cc)).returnValue||(cc=[],ka.Z(db,cc));cc.push(Gb)}u5c(ka){ka&&(ka.Cma(()=>{this.updateViewportInfo()}),this.ltd=this.LWe.scrollTop,ka.Uph(this.$hg),ka.Vph(this.g5f))}R5f(){this.uh.hl?this.u5c(this.uh.hl):this.uh.zma?this.uh.zma.c2b(this.Rmb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}M_e(ka){this.rt.vF.style.top=ka-this.ltd+"px";this.exc=!1}U8a(ka=!1){ka=new la.a(0,1,0,()=>{this.gff()},
129,void 0,!ka);this.Ib.Xb(ka);this.Rod=!0;this.exc=this.Pzb;this.IVa.MHa(10)}fsf(ka){return this.uh.r0a({contentAnchorPositions:ka.contentAnchorPositions})}gff(){this.Rod=!1;if(this.rt.IFa&&this.zub&&this.Wh.P$b()){this.uh.eMd();var ka=0;this.oi.ge(()=>{ka=this.uh.qQd()},"FCM:UP:GET");var db=null,Gb=null;this.oi.ge(()=>{const cc=this.MT.T5h(ka,this.uh.hl);db=cc.K0k;Gb=this.fsf(cc)},"FCM:UP:GP");this.oi.ge(()=>{this.Pzb?(this.uh.MUh(Gb),this.Pzb=!1):this.zub.emitEvent(3,Gb);this.u2.Hbe()},"FCM:UP:RC");
this.zub.setFirstCommentRenderDone();"0"===this.rt.vF.style.opacity&&0<db.count&&!this.$i.xm&&this.$i.vIa&&this.oi.ge(()=>{this.uh.GQb()},"FCM:UP:SFC");!this.eNg&&0<db.count&&(kg.a.E3(this.Ib,this.uh.xJi,nl.a.wJi),this.eNg=!0);this.IUe=G.a.We();this.IVa.MHa(6)}else this.IUe=G.a.We()}}Object(f.a)(cf,"FloatingCommentManager",null,[716,717]);var nf=c(113),Wb=c(1482),Ug;(function(ka){ka[ka.ypp=0]="singleHint";ka[ka.Dkp=1]="multiHint";ka[ka.Onp=2]="resolvedHint";ka[ka.Ekp=3]="multiResolvedHint";ka[ka.entryPoint=
4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(Ug||(Ug={}));Object(f.b)("CommentIconType",Ug);var gi=c(125),rf=c(1114);const Uk={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Ug.unknown]:""},ee={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],
[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Ug.unknown]:[]},Rk=(ka,db)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(db){case 3:return rf.a.wFh;
case 2:return rf.a.xFh;case 1:return rf.a.yFh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(db){case 3:return rf.a.tFh;case 2:return rf.a.uFh;case 1:return rf.a.vFh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(db){case 3:return rf.a.zFh;case 2:return rf.a.AFh;
case 1:return rf.a.BFh}}},wh=(ka,db)=>{gi.a("renderIcon")&&appChrome.api.renderIcon(ka,db)};class yg{}yg.uni=16;yg.Rsm=1;yg.Qzf=20;yg.uKj=2;Object(f.a)(yg,"CommentIconConstants",null,[]);class So{constructor(){this.eGd=0;this.cGc=!1}}Object(f.a)(So,"CommentHintCensus",null,[]);class Sm{constructor(ka,db,Gb,cc,xc){this.eOg=ka;this.s1b=Gb;this.f_j=cc;this.Kba=xc;this.pNa=-1;this.Gve=new Set(db)}get y(){if(-1!==this.pNa)return this.pNa;const ka=Sys.UI.DomElement.getBounds(this.eOg),db=this.eOg.getClientRects();
return this.pNa=0<db.length&&db[0]?this.f_j?ka.y/this.s1b+yg.uKj:Math.floor(db[0].height)/(2*this.s1b)+ka.y/this.s1b-yg.uni/2:0}get kGd(){return Array.from(this.Gve)}Rtk(ka){this.Gve=new Set([...this.Gve,...ka])}}Object(f.a)(Sm,"HintInfo",null,[747]);class Aa extends Wb.a{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg,Kh){super();this.Mg=ka;this.gg=db;this.qk=Gb;this.uE=cc;this.ga=xc;this.Wh=Be;this.qsa=ve;this.IVa=Wf;this.$i=lg;this.EXj=Kh;this.khd=new Map;this.fvb=this.Byb=null;this.knc={Tqb:-1,
mSf:-1}}G7a(ka){let db=!1;T.App.KJj&&ka.mc.Vi?P.a.instance.ge(()=>{db=pg.m(ka,!0)},"CHA:SCIVE"):P.a.instance.ge(()=>{db=pg.l(ka.htmlElement,!0)},"CHA:SCI");return db}q0a(ka){const db=this.zoom,Gb=ka.d1,cc=ka.exa;let xc=0;for(let re=0;re<ka.B4.length;re++)if(0<ka.B4[re].width){xc=re;break}const Vc=ka.D_a(1,yg.Qzf,db,xc);this.IVa.MHa(1);let Wd=[];cc.forEach((re,od)=>{const Be=ka.B4[od].y/db;re=this.n$k(this.JYl(re,od),ve=>this.a$k(Gb,ve,ve.y-Be,Vc),()=>Aa.bbl(Gb));Wd=Wd.concat(re)});return Wd}n$k(ka,
db,Gb){Gb=Gb();const cc=[];for(const xc of ka){ka=db(xc);for(const Wd of xc.kGd)this.khd.set(Wd.toString(),ka);const Vc=this.Pbi(xc.kGd);this.wEj(Vc,ka);null==Gb.Kba&&(Gb.Kba=xc.Kba);Gb.appendChild(ka);cc.push(ka)}this.kac(this.fvb);this.Cjb(this.Byb);return[Gb]}lql(ka,db){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Aa.BYi);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(Aa.$_k)))?this.j$n(ka,db):!1}j$n(ka,db){let Gb=0,cc=ka.length-1,xc;
for(;cc>=Gb;){xc=Math.floor((cc-Gb)/2+Gb);const Vc=ka[xc];if(Vc.offsetTop>=db-2&&Vc.offsetTop<=db+2)return!0;Vc.offsetTop>db+2?cc=xc-1:Gb=xc+1}return!1}Pbi(ka){var db,Gb;let cc=0,xc=0;for(const Vc of ka)if(this.Wh.BFf(Vc)){if(this.Mg.contentFilterApiEnabled&&this.$i.xm&&(ka=this.Wh.f0(Vc.toString()),null===(Gb=(db=this.EXj).isContentInFilteredContent)||void 0===Gb||!Gb.call(db,ka.id)))continue;this.Wh.Dui(Vc)?xc+=1:cc+=1}db=new So;db.eGd=cc+xc;db.cGc=0===cc;return db}$nc(ka){if(ka=this.khd.get(ka.objectId)){var db=
pg.g(ka);db=this.Pbi(db);this.wEj(db,ka)}}wEj(ka,db){let Gb,cc;if(this.Mg.contentFilterApiEnabled&&0===ka.eGd)db.style.display="none";else if(1===ka.eGd?(Gb=ka.cGc?2:0,cc=ka.cGc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.eGd&&(Gb=ka.cGc?3:1,cc=ka.cGc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),db.style.display=
"block",ka=db.firstElementChild)this.Wgo(ka,Gb),ka.title=cc+". "+ka.title,wh(Uk[Gb],ka)}Wgo(ka,db){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;nf.a.Nl(ka,Aa.CFh,db)}JYl(ka,db){ka=this.b$k(ka,db);ka.sort((Gb,cc)=>Gb.y-cc.y);return this.jan(ka)}b$k(ka,db){const Gb=[],cc=this.Mg.Yq,xc=this.zoom;ka=pg.f(ka,!0);for(let Vc=0,Wd=ka.length;Vc<Wd;Vc++){const re=ka[Vc],od=pg.g(re);od&&Gb.push(new Sm(re,od,xc,cc,db))}return Gb}jan(ka){let db=null;const Gb=[];for(let cc=0;cc<
ka.length;cc++)db&&Math.abs(ka[cc].y-db.y)<yg.uni+yg.Rsm?db.Rtk(ka[cc].kGd):(db=ka[cc],Gb.push(db));return Gb}a$k(ka,db,Gb,cc){const xc=ka.Tg.ownerDocument,Vc=xc.createElement("div");Vc.className=Aa.rFh;Vc.style.top=Gb+"px";Vc.style.left=cc+"px";Vc.style.right="auto";Vc.style.zIndex="40";nf.a.Nl(Vc,he.a.DIc,db.kGd);db=xc.createElement("span");this.jog(db,Vc);wh(Uk[0],db);this.cC(db,ka);return Vc}jog(ka,db){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");db.appendChild(ka)}cC(ka,
db){this.gg.jE(Oi.a.click,ka,this.Cmn.bind(this),db);this.gg.ob(Oi.a.uB,ka,this.Fmn.bind(this));this.qk.ob(Oi.a.W0,ka,this.Hmn.bind(this));this.qk.ob(Oi.a.uL,ka,this.Gmn.bind(this));this.uE.ob(ka,this.Emn.bind(this))}static bbl(ka){ka=ka.Tg.ownerDocument.createElement("div");ka.className=Aa.BYi;return ka}Emn(){return!0}Fmn(){return!0}Cmn(ka){const db=pg.g(ka.Uw.parentNode);ka.eventName===Oi.a.eK&&(this.qsa.Z6e(),this.pDh());this.ga.Rb(ph.a.sFh,2,db);return!0}Hmn(ka){this.$Ea(this.fvb)!==ka.Uw&&(ka=
pg.g(ka.Uw.parentNode),this.ga.Rb(ph.a.h8e,2,ka));return!0}Gmn(){this.ga.processAction(ph.a.pGd,2);return!0}kac(ka){this.pDh();this.fvb=ka;this.ZCk()}ZCk(){this.$Ck(this.$Ea(this.fvb),this.$Ea(this.Byb))}Cjb(ka){this.JWk();this.Byb=ka;if(ka=this.$Ea(this.Byb)){const db=this.fRd(ka);this.Zfe(ka,db,1)}}$Ea(ka){if(!ka)return null;let db=null;if(ka=this.Wh.f0(ka))if(ka=ka.Af?this.Wh.UD(ka.Af):ka)db=ka.objectId;return db&&this.khd.has(db)?this.khd.get(db).firstChild:null}pDh(){this.LWk(this.$Ea(this.fvb),
this.$Ea(this.Byb))}LWk(ka,db){if(ka){const Gb=this.fRd(ka);this.Zfe(ka,Gb,ka===db?1:3);this.fvb=null}}$Ck(ka,db){ka&&(ka.title=0<this.knc.mSf&&1<this.knc.Tqb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.knc.mSf,this.knc.Tqb):CommonUIStrings.l_CommentHintTooltip,db!==ka&&(db=this.fRd(ka),this.Zfe(ka,db,2)))}JWk(){const ka=this.$Ea(this.fvb),db=this.$Ea(this.Byb);if(db){const Gb=this.fRd(db);this.Zfe(db,Gb,ka===db?2:3);this.Byb=null}}Zfe(ka,db,Gb){this.JLm()?
this.Ngo(ka,Gb):this.Mio(ka,db,Gb)}Ngo(ka,db){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===db||1===db?"Highlight":"ButtonText")}Mio(ka,db,Gb){db=ee[db];for(let xc=0;xc<db.length;xc++){var cc=db[xc];const Vc=Rk(cc,Gb);if(!this.lIm(Vc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Vc}.`);break}cc=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+cc);0<(null===
cc||void 0===cc?void 0:cc.length)&&(cc[0].style.fill=`var(${Vc})`)}}JLm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}fRd(ka){return nf.a.Eb(ka,Aa.CFh)}lIm(ka){var db;const Gb=document.getElementById(Rm.AppFrame.ELc);return!(null===(db=null===Gb||void 0===Gb?void 0:Gb.style)||void 0===db||!db.getPropertyValue(ka))}}Aa.rFh="clip16x16 HintContainer";Aa.$_k=".clip16x16.HintContainer";Aa.BYi="OutlineElementHintMargin";Aa.CFh="CommentIconType";Object(f.a)(Aa,
"CommentHintActor",Wb.a,[731]);var Ab=c(1023);class nc extends Ab.a{get kfg(){return this.n0()}get jff(){return this.p5o.Nfi()}constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be){super();this.yh=ka;this.Rr=db;this.Gj=Gb;this.taskManager=cc;this.gAd=xc;this.VK=Vc;this.uh=Wd;this.getSelectedText=re;this.p5o=od;this.focusManager=Be;this.c1c=()=>{};this.y6d=()=>{};this.wKg=!1;this.USk={[0]:()=>this.CPh(),[1]:()=>this.Alc.e2e(),[2]:()=>this.CPh()};this.QXf=()=>{this.gAd.MHa(11)};this.$2e=ve=>{if(this.Rr.TAb)for(const Wf of pg.t)ve.bindAction(Pc.KeyInputManager.IG(Wf),
Vj.a.K4e)};this.E7d=()=>{this.y6d()};this.D7d=(ve,Wf)=>{if(ve.name!==xd.AFrame.Qr&&Wf){var lg=this.Gj.qt?this.Gj.qt.id:"";this.yh.PLb||(this.yh.PLb=kg.a.E3(this.taskManager,()=>{this.c1c(lg)}))}};this.KWi=()=>{};this.Tmb=()=>{this.Ypj()};this.zTf=(ve,Wf)=>{0===Wf&&(this.VK.Hbe(),this.gAd.MHa(0))};this.QUf=()=>{this.gAd.MHa(5)};this.tQc=ve=>{let Wf=0;const lg=this.Gj.$O();for(let Kh=0;Kh<lg.length;Kh++){if(lg[Kh].Af||lg[Kh].done)continue;if((lg[Kh].Xq===ec.a.beingCreated?lg[Kh].yz.draftId:lg[Kh].id)===
ve.contentId)break;const Vg=this.Jx.getContentAnchorPosition(lg[Kh].id);!Vg||4<Math.abs(ve.anchorTop-Vg.anchorTop)||Wf++}return Wf};this.SRi=()=>{this.VK.Hbe()};this.MWf=()=>{this.gAd.MHa(2)};this.Ypj=()=>{if(!this.wKg&&this.uh.Cea){const ve=this.uh.Cea.getElementsByClassName(Aa.rFh);for(let Wf=0;Wf<ve.length;Wf++)ve[Wf].style.opacity="1";this.wKg=!0}}}initialize(ka,db){this.Jx=ka;this.Alc=db;this.v5c();this.Rr.ehb&&this.wUn()}lgo(ka,db){this.y6d=ka;this.c1c=db}e6h(ka,db){return{g_a:this.LQl(ka,db),
containerContentByType:{}}}T5h(ka,db){const Gb=cf.s7h(this.Gj.$O(),this.Gj.Yha),cc=[],xc=pg.e(!0);var Vc=this.Gj.$O();db=this.rGn(db,Vc,Gb);!db.c1f&&db.contentAnchorPosition&&(cc.push(db.contentAnchorPosition),db.contentAnchorPosition=null);for(Vc=0;Vc<xc.length;Vc++){const Wd=xc[Vc],re=pg.g(Wd);if(re)for(let od=0;od<re.length;od++){const Be=this.getContentAnchorPosition(ka,Gb,Wd,re[od]);Be&&(cc.push(Be),db.c1f&&db.contentAnchorPosition&&Be.contentId===db.c1f.id&&(cc.push(db.contentAnchorPosition),
db.contentAnchorPosition=null))}}db.contentAnchorPosition&&cc.splice(0,0,db.contentAnchorPosition);return{K0k:Gb,contentAnchorPositions:cc}}BGf(){var ka;return!(null===(ka=this.Jx)||void 0===ka||!ka.getAreContainersEnabled())}n0(){return this.Gj.P$b()}Feg(){return this.n0()}N9c(){return this.n0()}pfg(){return this.Jx&&this.uh.Cea&&this.n0()}QIo(){this.VK.i$("OnFloatingCommentsVisibilityChange",this.yh.vIa);if(this.yh.vIa)this.uh.GQb();else{const ka=this.Gj.mJ;ka.Sz&&ka.clearSelection();this.uh.KVd()}}zWi(ka){0!==
ka&&this.c1c(this.Gj.qt?this.Gj.qt.id:"")}getContentAnchorPosition(ka,db,Gb,cc){let xc=null;return({value:xc}=db.Fc(cc.toString(),xc)).returnValue?(db=xc[0])&&!db.Af?{...(new Ld.a),anchorTop:(De.a.yPc(Gb)-ka)/this.uh.Sba,anchorLeft:0,containerContentType:0,contentId:db.id}:null:null}rGn(ka,db,Gb){var cc,xc;const Vc={};"CREATE"===(null===(xc=null===(cc=this.Gj.Px)||void 0===cc?void 0:cc.yz)||void 0===xc?void 0:xc.sessionType)&&(cc=this.uh.Cea.querySelectorAll(pg.b),ka=this.uh.C3h((0<cc.length?cc[0]:
null)||this.getSelectedText(),this.Gj.Px.yz.draftId,0,ka),Vc.c1f=this.k7l(db,Gb),Vc.contentAnchorPosition=ka);return Vc}k7l(ka,db){var Gb=Array.indexOf(ka,this.Gj.Px);for(--Gb;-1<Gb;Gb--)if(db.nb(ka[Gb].objectId))return ka[Gb]}LQl(ka,db){return this.T5h(ka,db).contentAnchorPositions}v5c(){this.VK.k$("OnAfterTrackChangeMarkupViewChange",(ka,db)=>{if(db)this.USk[db.Jj]()})}wUn(){this.VK.k$("OnFloatingCommentsToggle",this.QIo.bind(this))}CPh(){const ka=pg.i();if(0!==ka.length){var db=cf.s7h(this.Gj.$O()),
Gb=this.Gj.mJ;for(let cc=0;cc<ka.length;cc++){const xc=pg.g(ka[cc]);for(let Vc=0;Vc<xc.length;Vc++){let Wd;({value:Wd}=db.Fc(xc[Vc].toString(),Wd)).returnValue&&(Wd.forEach(re=>{var od;re&&!re.Af&&(this.Alc.deleteContainer(re.id,0,!1),(null===(od=Gb.Sz)||void 0===od?void 0:od.id)===re.id&&Gb.clearSelection())}),this.focusManager.kg(xd.AFrame.Un))}}}}}Object(f.a)(nc,"CommentFloatingContainerActor",Ab.a,[735]);var Kc=c(1484),hd=c(2051),Rd=c(195);class kc extends Kc.a{constructor(ka,db,Gb,cc,xc,Vc,Wd,
re,od){super();this.a9j=ka;this.v$a=db;this.Hve=Gb;this.oi=xc;this.eaa=re;this.u2=od;this.Zi=null;this.Jj=1;cc.execute(Be=>{this.Zi=Be});this.V2=[];this.Vrc=new Rd.ScriptSharpLegacyMap;this.mSn(Vc,Wd);this.v5c()}get nj(){return this.a9j.value}get P_k(){return this.v$a}get Aca(){return!!this.Zi}get Djb(){return 0}get a3a(){return this.V2}get qXg(){return this.Vrc.nb(this.Jj)?this.Vrc.J(this.Jj):this.Vrc.J(0)}lRa(ka){return this.eaa.lRa(ka)}v2a(ka,db){if(ka=Object(Pb.a)(732,ka))for(const Gb of this.IGn(ka))db.add(Gb)}jHa(ka,
db){this.Aca&&this.oi.ge(()=>{this.kpn(ka,db)},"CHA:OPHC")}kpn(ka,db){if(this.Zi.Co.P$b()){var Gb=this.zr.VDa,cc=new Ca.a(new Nc.a),xc=db.FHa("*"),Vc=this.nQl(Gb),Wd=!!Gb&&!Gb.action||!!Vc&&Vc===this.Zi.Sz,re;this.oi.ge(()=>{this.Hve.i5l(ka.id,cc,null===Vc||void 0===Vc?void 0:Vc.objectId)},"OPHC:GOI");this.oi.ge(()=>{re=this.qXg.yxh(xc,Vc,cc,Wd);re.Cui=this.Aui(Gb)&&0===Gb.action},"OPHC:BHI");this.oi.ge(()=>{this.qXg.Xsh(xc,re,Wd)},"OPHC:AH")}}nQl(ka){let db=null;!this.Aui(ka)||0!==ka.action&&2!==
ka.action||(db=this.zr.VDa.GA);return db||this.Zi.Sz}IGn(ka){if(!ka)return[];ka=this.nj.Eb(ia.a.Ff(ka.objectId));return this.P_k.ySd(ka,null)}I8i(){return!1}EF(ka,db,Gb){this.Aca&&(ka=Object.assign(new hd.a,{action:ka,type:0,GA:db,SJ:Gb}),this.zr.EF(ka))}Z6e(){this.Aca&&(this.EF(3,this.Zi.rac,this.Zi.rac),this.Zi.rac=null)}mSn(ka,db){this.Vrc.add(1,ka);this.Vrc.add(0,db)}v5c(){this.u2.k$("OnBeforeTrackChangeMarkupViewChange",(ka,db)=>{db&&db.WRf!==this.Jj&&(this.Jj=db.WRf)})}Aui(ka){return ka&&0===
ka.type}}Object(f.a)(kc,"CommentHighlightActor",Kc.a,[734,577]);var ff=c(1041),bd=c(361),Sf=c(503),Te=c(1518);class bi{constructor(ka,db){this.w0k=ka;this.tTf=db}}Object(f.a)(bi,"CommentEndParaIdBeforeChangeInfo",null,[]);var Si=c(1623);class li{constructor(ka,db,Gb,cc,xc,Vc,Wd,re){this.rJf=ka;this.yh=db;this.Gj=Gb;this.VK=cc;this.ro=xc;this.Ck=Vc;this.T_k=Wd;this.Rr=re;this.Ysb=null;this.sGn=(od,Be)=>{(od=Be.commentNode)&&!pg.s(od)&&(Be=this.Gj.Nnf(od),ia.a.zq(Be.O$c,Be.nMc)||this.VDj(Be,od)||this.aCh(Be.zDa,
Be.gOa,od)||this.wog(od))};this.Pin=(od,Be)=>{Be.property===sa.a.awa&&(od=pg.h(Be.node,ia.a.nil),this.Ysb=new bi(Be.node.id,od))};this.akn=(od,Be)=>{od=Be.node;if(Be.property===sa.a.awa&&od){var ve=pg.k(od,ia.a.nil);Be=pg.h(od,ia.a.nil);var Wf=this.Ysb?this.vd.Eb(this.Ysb.tTf):null;!pg.s(od)&&ve&&!ve.equals(Be)&&this.Ysb&&od.id.equals(this.Ysb.w0k)&&!ve.equals(this.Ysb.tTf)&&Wf&&Wf.isConnected&&this.XYe(this.Ysb.tTf,od.id);Be&&this.yh.Zx.nb(Be)&&(ve=this.yh.Zx.J(Be),ve.U2a&&(a.ULS.shipAssertTag(572835481,
327,!!ve.bN,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),ve.bN&&ve.bN.contains(od.id)&&(ve.bN.remove(od.id),ve.bN.count||(ve.U2a=!1),this.yh.VU.nb(od.id)?this.yh.VU.J(od.id).remove(Be):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.x1c=(od,Be)=>{od=Be.node.id;this.yh.Zx.nb(od)&&this.yYn(od)};this.zin=(od,Be)=>{Be&&Be.node&&this.YVa.nb(Be.node)&&(od=this.YVa.J(Be.node).F8d,this.YVa.nb(od)||(od=this.YVa.J(Be.node),
this.aCh(od.Pbf?od.currentNode:od.F8d,od.Pbf?od.F8d:od.currentNode,od.commentNode)||this.wog(od.commentNode)),this.YVa.remove(Be.node))};this.dkn=(od,Be)=>{const ve=od.$j;if(!Be&&this.Lcb.nb(ve)){var Wf;(Wf=this.Lcb).Z(ve,Wf.J(ve)&(od.Qc?-2:-3));this.Lcb.J(ve)||(this.wog(this.vd.Eb(ve)),this.Lcb.remove(ve))}};this.YVa=new Sf.a(new ff.a);this.Lcb=new Se.a(pg.c);this.VK.k$("OnCommentNodeAdded",this.sGn);this.Rr.contentFilterApiEnabled?(this.VK.k$("OnCommentPaneOpen",this.dEm.bind(this)),this.VK.k$("OnCommentPaneClose",
this.cEm.bind(this)),this.VK.k$("OnContentFilterUpdate",this.o1c.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(od=>{this.VK.k$(od,this.aEm.bind(this))});this.Rr.ehb&&this.VK.k$("OnFloatingCommentsVisibilityChange",this.bEm.bind(this));ka=this.ro.Te(12);ka.Fx(this.x1c);ka.hu(this.zin);this.ro.Te(40).qFc(this.Pin);this.ro.Te(40).Mo(this.akn);bd.a.cTa(this.dkn)}get mx(){return this.rJf.value}get vd(){return this.mx.vd}i5l(ka,db,Gb){if(this.Kxn(ka))for(const cc of this.yh.Zx.J(ka).bN)!this.boj(cc,
Gb===cc.toString())||db.add(cc)}boj(ka,db){const Gb=this.vd.Eb(ka),cc=pg.s(Gb);if(!Gb||cc)return!1;ka=this.Gj.f0(ka.toString());return!ka||this.Rr.contentFilterApiEnabled&&this.yh.xm&&!this.T_k.isContentInFilteredContent(ka.id)||!this.yh.xm&&!this.Gj.Yha(ka)&&!db?!1:!0}Kxn(ka){return this.qxn(ka)}wog(ka){if(ka){var db=Te.a.ySd(ka,null),Gb=new Sa.a;for(let cc=1;cc<db.length-1;cc++)this.XYe(db[cc].id,ka.id),Gb.add(db[cc]);Ng.b(Gb)}}bEm(){const ka=new Sa.a;for(const db of this.Gj.$O())!db.Af&&db.Xq!==
ec.a.beingCreated&&this.Gj.Yha(db)&&this.Gj.wne(db,ka);Ng.b(ka)}qxn(ka){if(!this.yh.yY)return!1;let db=null;if(({value:db}=this.yh.Zx.Fc(ka,db)).returnValue)return db.U2a;let Gb=!1;this.Ck.ge(()=>{const cc=pg.e();for(let xc=0;xc<cc.length;xc++)Gb=this.JVo(cc[xc],ka,Gb);Gb||(this.yh.Zx.add(ka,new Si.a),this.yh.Zx.J(ka).U2a=!1)},"CHORA:PHOC");return Gb}JVo(ka,db,Gb){ka=pg.g(ka);if(!ka)return Gb;for(let cc=0;cc<ka.length;cc++){const xc=this.vd.Eb(ka[cc]);xc&&!pg.s(xc)&&(Gb=Gb||this.uTk(xc,db))}return Gb}uTk(ka,
db){var Gb=this.Gj.Nnf(ka);if(this.VDj(Gb,ka))return!1;var cc=Gb.O$c;const xc=Gb.nMc;Gb=Gb.zDa;if(cc!==ia.a.nil&&(cc.equals(xc)||cc.equals(db)))return!1;for(cc=Za.ParagraphReader.$f(Gb,!1);cc&&!cc.id.equals(xc);){if(cc.id.equals(db))return this.XYe(db,ka.id),!0;cc=Za.ParagraphReader.$f(cc,!1)}return!1}XYe(ka,db){this.yh.VU.nb(db)||this.yh.VU.add(db,new Ca.a(new Nc.a));this.yh.VU.J(db).add(ka);this.yh.Zx.nb(ka)?this.yh.Zx.J(ka).bN||(this.yh.Zx.J(ka).bN=new Ca.a(new Nc.a)):this.yh.Zx.add(ka,new Si.a(!0));
this.yh.Zx.J(ka).U2a=!0;this.yh.Zx.J(ka).bN.add(db)}yYn(ka){if(this.yh.Zx.J(ka).bN)for(const db of this.yh.Zx.J(ka).bN)this.yh.VU.nb(db)?this.yh.VU.J(db).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.yh.Zx.remove(ka)}aEm(){const ka=new Sa.a;for(const db of this.Gj.$O())db.Af||db.Xq===ec.a.beingCreated||this.Gj.Yha(db)||this.Gj.wne(db,ka);Ng.b(ka)}dEm(){this.DBf("OnCommentPaneOpen")}o1c(){this.DBf("OnContentFilterUpdate")}cEm(){this.DBf("OnCommentPaneClose")}DBf(ka){const db=
new Sa.a;for(const Gb of this.Gj.$O())Gb.Af||Gb.Xq===ec.a.beingCreated||this.Gj.mJ.Rzh(ka,Gb)||this.Gj.wne(Gb,db);Ng.b(db)}VDj(ka,db){let Gb=!1;if(!ka.qje||!ka.JLd){Gb=!0;if(!ka.zDa||!ka.gOa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.zDa,!ka.gOa),!0;ka.qje||this.YVa.nb(ka.zDa)||this.YVa.add(ka.zDa,{commentNode:db,currentNode:ka.zDa,F8d:ka.gOa,Pbf:!0});ka.JLd||this.YVa.nb(ka.gOa)||this.YVa.add(ka.gOa,{commentNode:db,currentNode:ka.gOa,F8d:ka.zDa,
Pbf:!1})}return Gb}aCh(ka,db,Gb){ka=Te.a.rwa(ka,Gb.id,!0);db=Te.a.rwa(db,Gb.id,!1);let cc;ka||({value:cc}=this.Lcb.Fc(Gb.id,cc),this.Lcb.Z(Gb.id,cc&1));db||({value:cc}=this.Lcb.Fc(Gb.id,cc),this.Lcb.Z(Gb.id,cc&2));return!ka||!db}}Object(f.a)(li,"CommentHighlightOnRestActor",null,[733]);var yi=c(544),lm=c(416),bh=c(633);class ol{constructor(ka,db){this.Ozb=ka;this.ila=db}getViewContainer(){return this.Ozb}registerForViewContainerEvents(ka){this.ila.VVn(ka)}unregisterForViewContainerEvents(ka){this.ila.vQo(ka)}}
Object(f.a)(ol,"ViewContainerProvider",null,[841]);class zi{constructor(ka,db,Gb,cc){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=db;this.uiCulture=Gb;this.dataCulture=cc}}Object(f.a)(zi,"LocalizationDetails",null,[]);var fk=c(1149),eh=c(1532),Ck=c(480);class vd{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg,Kh,Vg,Gk,wl,el,Ki,xj,Hk,Zh,Ho,Xh,Mm,Mn,wj,cn,oh,Gl,Zk){this.Wq=ka;this.Gj=db;this.x4b=Gb;this.O_=cc;this.Rr=xc;this.yh=Vc;
this.XNd=Wd;this.lac=re;this.Xp=od;this.nc=Be;this.dynamicScriptLoader=ve;this.D6n=Wf;this.focusManager=lg;this.p8e=Kh;this.l8e=Vg;this.Wlh=Gk;this.D0o=wl;this.A1=el;this.VK=Ki;this.m8n=xj;this.kyl=Hk;this.tRi=Zh;this.E0o=Ho;this.$Bb=Xh;this.MT=Mm;this.uh=Mn;this.rN=wj;this.B9e=cn;this.S5a=oh;this.qGd=Gl;this.Z3k=Zk;this.fnd=this.lYa=null;this.LYg=!1;this.yLe=[];this.Fch=this.MYg=!1;this.initialize=(ym,Lh)=>{this.Xxm(Lh)};this.Nfl=ym=>$g.a.sHd(ym);this.ekn=()=>{this.tqi()};this.IWl=(ym,Lh,qk)=>{ym=
{...(new fk.a),containerPanel:ym,paneOpenedCallback:Lh,paneClosedCallback:qk,ulsLogger:new yi.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.uh.Aof(),destroyAllContainersCallback:()=>{this.yh.xm||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Rr.YNd,synchronousContainerPositioningEnabled:!1,
trackChangeInSidetrackEnabled:this.Rr.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Rr.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Rr.contentNavigationApiEnabled,contentFilterApiEnabled:this.Rr.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.Rr.contentNavigationApiEnabled&&(ym.sidetrackContentNavigationApi=this.B9e,ym.featureGateApiSettings=this.MT.jff,ym.telemetryDetails=this.tRi,this.Rr.contentFilterApiEnabled&&
(ym.contentFilterAPI=this.Z3k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(ym)};this.Vln=ym=>{2!==this.Wq.mode&&3!==this.Wq.mode&&this.Gj.qt&&ym===this.Gj.qt.id&&this.Wq.clearSelection();T.App.za.updateCommandUI(!0)};this.KSi=(ym,Lh)=>{this.Ex("onCSCStart",window.performance.now());this.jeb&&!ym&&(this.cun(),this.Ex("openInFishbowl",!0));this.x4b.neb&&this.Rr.oDb&&this.nc.processAction(ph.a.SGa,2);Lh&&Lh();this.Ex("onCSCEnd",window.performance.now())};this.VK.k$("OnCommentInit",
this.initialize);this.VK.k$("OnCommentRenderedOnce",this.ekn);this.MT.lgo(()=>{},this.Vln);this.Rr.ehb&&Ck.a.oSc&&(this.yh.vIa=!1)}get NKa(){return this.Wq}get jeb(){return this.yh.jeb}Ex(ka,db){this.S5a.Ex(ej.a.comments,ka,db,!0)}Xxm(ka){if(this.yh.yY)ka&&ka.VGa&&ka.VGa();else if(this.LYg)(null===ka||void 0===ka?0:ka.VGa)&&this.yLe.push(ka.VGa);else{var db=this.Rr.Q$b;this.Ex("hasCommentOnBoot",db);db?this.$Bb.logKpiUsage(eh.a.w4b,0):lm.a.Nfc("canvas","floatingComments");this.LYg=!0;this.Ex("initInProgress",
!0);this.Gj.initialize(this.Wq);this.x4b.initialize(this.Wq,null);this.x4b.knj(this.Wq);this.lac.Sym(this.O_.Wko);this.Ex("InitAMSetup",window.performance.now());bh.a.Bp(this.kyl).continueWith(Gb=>{(this.lYa=Gb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.p8e.initialize(this.lYa);this.NKa.d8e.initialize(this.NKa,this.Gj,this.lYa,this.p8e);this.Wlh.initialize(this.dynamicScriptLoader,this.NKa.d8e,this.tRi,this.lYa,new ol(this.D0o,
this.E0o),this.Dai(),"",this.p8e.Nfi(),this.A1,T.App.ghe);this.Ex("AMInitialized",window.performance.now());this.Rr.contentNavigationApiEnabled?(T.App.DEb?T.App.DEb:this.uh.hGi()).then(()=>{this.Ex("FCMLoaded",window.performance.now());this.m9c();this.pXd(ka)}):this.pXd(ka)})}}nDn(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.Nfl)}pXd(ka){this.fnd=this.Wlh.pXd(void 0,this.nDn.bind(this));this.bUc(ka);this.yh.yY=!0;this.Rr.Ngg&&this.l8e.initialize()}bUc(ka){if(!this.yh.MHb){this.Ex("InitCSStart",
window.performance.now());var db=this.Xp.Vf("Task","InitiateCommentingSession");this.$Bb.logKpiUsage(eh.a.DFh,0);try{const Gb=this.Xp.Vf("Task","InitiateCommentingSession-UpdateModel");this.qGd.oym();Gb.stop();this.Ex("initAtBoot",window.performance.now());this.Rr.Yq&&this.Gj.P$b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",G.a.We()));Qm.a.get_instance().iI(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.yh.MHb=
!0;this.fnd.then(()=>{this.Ex("SCLoaded",window.performance.now());this.uh.Jym();this.Ex("FCMInitiated",window.performance.now());if(this.Rr.Yq){let xc=!1;if(this.jeb){var cc=this.O_.SPd(this.jeb);cc?(y.AFrameworkApplication.le("3ge3g205;cha3g788"),cc=this.O_.TPd(cc,0),cc)?this.Gj.Yha(cc)||(xc=!0,this.dun(cc)):(xc=!0,this.w5a()):xc=!0}cc=ka?ka.BTi:null;this.Rr.contentNavigationApiEnabled?this.KSi(xc,cc):this.Z_m(xc,cc)}ka&&ka.VGa&&ka.VGa();for(const xc of this.yLe)xc();this.MYg&&this.tqi();this.yLe=
[]})}catch(Gb){a.ULS.VA(539567713,327,10,Gb,`Comments Initialization Failed: ${Gb}`),this.$Bb.logKpiFailure(eh.a.DFh,"CommentsInitializationFailed",{isInternal:!0},{name:eh.a.v4b,isInternal:!0})}finally{db.stop(),this.Ex("InitCSEnd",window.performance.now())}this.nc.processAction(ph.a.fFh,2)}}dun(ka){this.nc.processAction(ph.a.AV,2);this.MT.Ypj();kg.a.E3(y.AFrameworkApplication.oc,()=>{this.O_.selectComment(ka,{...(new oj.a),iS:!0,s$:1});this.focusManager.kg(xd.AFrame.Qr);a.ULS.sendTraceTag(574734912,
327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.kX)},nl.a.T$n);this.$Bb.Sv(ph.a.g8e);y.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}w5a(){this.nc.processAction(ph.a.w5a,2)}Z_m(ka,db){(T.App.DEb?T.App.DEb:this.uh.hGi()).then(()=>{this.Ex("FCMLoaded",window.performance.now());this.m9c();this.KSi(ka,db)}).catch(Gb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+
Gb.toString())})}m9c(){if(this.rN.trackChangeInSidetrackEnabled)this.XNd.m9c(),this.Ex("STSet",window.performance.now());else this.XNd.onj(this.IWl)}tqi(){this.Fch||(this.yh.yY&&this.fnd?(this.fnd.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.m8n.execute(db=>{ka.registerSafelinksNavigator(db.Knc.bind(db))});this.D6n.execute(db=>{db.pSn(ka)})}),this.Fch=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),
this.MYg=!0))}Dai(){return new zi(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}cun(){this.O_.zgj(this.jeb,{...(new oj.a),dfg:!1,uVc:!0});this.$Bb.Sv(ph.a.g8e)}}Object(f.a)(vd,"CommentInitActor",null,[]);class Dd{constructor(ka,db,Gb,cc,xc,Vc){this.gg=ka;this.uE=db;this.ga=Gb;this.FXj=cc;this.qj=xc;this.Mg=Vc;this.boe=this.NWa=null}get zoom(){let ka=1;this.qj&&this.qj.instance&&(ka=this.qj.instance.ij);return 0<
ka?ka:1}Lzl(ka,db){if(!this.boe||!ka.exa||db>=ka.exa.length)return null;const Gb=this.zoom,cc=ka.d1,xc=ka.D_a(1,yg.Qzf,Gb,db);return this.h9k(ka.exa[db],cc,(this.boe.y-ka.B4[db].y)/Gb+yg.uKj,xc)}h9k(ka,db,Gb,cc){if(this.NWa)return(db=this.NWa.parentElement)&&db.removeChild(this.NWa),this.djj(ka,this.NWa,Gb,cc),this.NWa;const xc=db.Tg.ownerDocument,Vc=xc.createElement("div");Vc.className=Dd.Q_k;this.djj(ka,Vc,Gb,cc);ka=xc.createElement("span");this.jog(ka,Vc);wh(Uk[4],ka);this.DTn(ka,db);return this.NWa=
Vc}jog(ka,db){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");db.appendChild(ka)}DTn(ka,db){this.gg.jE(Oi.a.click,ka,this.Cln.bind(this),db);this.gg.ob(Oi.a.uB,ka,this.Eln.bind(this));this.uE.ob(ka,this.Dln.bind(this))}EVd(){if(this.NWa){const ka=this.NWa.parentElement;ka&&ka.removeChild(this.NWa)}}djj(ka,db,Gb,cc){this.Mg.P6n||this.FXj.lql(ka,Gb)?db.style.left=cc+yg.Qzf+"px":db.style.left=cc+"px";db.style.top=Gb+"px";db.style.right="auto";db.style.display="block";
db.style.position="absolute";db.style.overflow="hidden";db.style.cursor="default";db.style.zIndex="40"}Eln(){return!0}Cln(ka){this.ga.KC=30;this.ga.processAction(ph.a.SGa,2);ka=ka.Uw;wh(Uk[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}Dln(){return!0}}Dd.Q_k="clip16x16 EntryPointContainer";Object(f.a)(Dd,"CommentMarginEntryPointActor",null,[]);var Ge=c(419),me=c(76),Kj=c(224),Sl=c(33),xf=c(117);class Fl{constructor(ka,db,Gb,cc,xc,
Vc,Wd){this.rJf=ka;this.OYm=db;this.Co=Gb;this.yh=cc;this.Rr=xc;this.j8e=Vc;this.$Bb=Wd;this.m3i=new Set;this.AKb=new Set;this.b2c=new Kj.a;this.y4b=new Map;this.IFh=L.a.instance.Re("Box4.CommentParagraphMapping");this.aCb=new Set;this.yga=this.RPd()}get mx(){return this.rJf.value}get vd(){return this.mx.vd}get CDa(){return this.OYm.value}RPd(){const ka=new hf.GraphIterator;ka.set(this.mx);this.CDa.o5a(ka);return ka}oym(){this.yh.MHb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
Sl.Debug.G1a());this.Rr.contentNavigationApiEnabled||(this.Rr.Q$b&&this.mym(),this.Co.KUi())}hjn(){this.udj();this.aCb.forEach(ka=>{this.dug(ka)});this.aCb.clear();this.Co.KUi()}dug(ka){if(Ge.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);var db=this.y4b.get(ka).Plc,Gb=this.y4b.get(ka).h7b;db===ia.a.nil||Gb===ia.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${db} or end ${Gb} has invalid value`):(this.IFh.value.Y_a.set(ka,db),this.IFh.value.X_a.set(ka,
Gb),a.ULS.sendTraceTag(512235651,327,50,`Start ${db} and End ${Gb} mapping info for Comment ${ka} added on Comment Model load`))}}UAm(ka){const db=[];for(const Gb of ka)ka=Gb.$j.toString(),this.zDj(ka,Gb.paragraph.id,Gb.Qc),Gb.Qc&&(this.m3i.has(ka)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",Gb.$j):(this.m3i.add(ka),(ka=this.Tpk(Gb))&&db.push(ka)));return db}zDj(ka,db,Gb){Ge.a.isEnabled&&(this.y4b.has(ka)||this.y4b.set(ka,{Plc:ia.a.nil,h7b:ia.a.nil}),
Gb?this.y4b.get(ka).Plc=db:this.y4b.get(ka).h7b=db)}Tpk(ka){var db=this.vd.Eb(ka.$j);this.yga.wj(db);if(40!==this.yga.Ue||!db)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!db,!ka.$j),this.yga=39===this.yga.Ue?this.yga:this.RPd(),null;db=this.Co.dId(this.yga);let Gb;if(({index:Gb}=this.Co.kme(db)).returnValue)if(this.Co.tYe(db,Gb),this.AKb.add(db.objectId),pg.p(db)||this.aCb.add(db.objectId),
db.Af)this.lkf(db);else return{contentId:db.id,containerContentType:0,d$:{Bd:ka.Kb.cp,aN:ka.paragraph.Bl}};else this.b2c.add(db);return null}lkf(ka){if(ka.Af){var db=this.Co.UD(ka.Af);if(db&&db.Af){const Gb=this.Co.UD(db.Af);Gb&&(Gb.Af?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ka.Af=db.Af,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${db.objectId}`)))}}}mym(){const ka=new N.a(0),
db=me.a.ap(this.Co.JJa),Gb=new Set;this.Rr.Gvn&&!Ge.a.isEnabled&&this.ask(db,ka);const cc=this.RPd(),xc=new Set,Vc=new Set,Wd=new ei.GraphTransaction(2);try{if(Wd.Qt(cc),cc.Fs(1)){for(;db.moveNext();){if(!Za.ParagraphReader.kh(db.iterator))continue;const od=db.iterator.currentNode,Be=Za.ParagraphReader.mFb(od);Ge.a.isEnabled&&this.H8m(od,Be,ka);Gb.add(od.id.toString());this.J2i(Be,Vc,cc,xc)}this.udj();const re=this.oQl(Gb);0<re.length&&this.U5n(re,Gb,cc,Vc);this.aCb.forEach(od=>{this.dug(od)});this.aCb.clear()}}finally{Wd&&
Wd.dispose()}0==this.AKb.size&&this.Rr.Q$b&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");fc.a.$3m(xc,Vc,this.vd)}J2i(ka,db,Gb,cc){for(const xc of ka){ka=this.Rr.Yq?!xc.Qc:xc.Qc;const Vc=xc.$j.toString();this.zDj(Vc,xc.paragraph.id,xc.Qc);ka?db.has(Vc)||cc.add(Vc):db.has(Vc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",xc.$j):(db.add(Vc),this.Upk(xc,Gb))}}U5n(ka,db,Gb,cc){const xc=this.u6l(ka);fc.a.uUk(xc);
const Vc=new Set,Wd=new Set;xc.forEach(od=>{db.has(od.id.toString())||Wd.has(od.id.toString())||(Wd.add(od.id.toString()),od=Za.ParagraphReader.mFb(od),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${od.length} CommentRangeObjects`),this.J2i(od,cc,Gb,Vc))});const re=[];ka.forEach(od=>{this.AKb.has(od)||re.push(od)});0<re.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${re.length} Failed To Load on Retry: ${re.join(",")}`),this.$Bb.logKpiFailure(eh.a.w4b,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:eh.a.v4b,isInternal:!0}))}u6l(ka){const db=[];ka.forEach(Gb=>{if(Gb=this.j8e.R5h(Gb))Gb=pg.k(Gb),(Gb=this.vd.Eb(Gb))&&Gb.tj&&db.push(Gb)});return db}Upk(ka,db){const Gb=this.vd.Eb(ka.$j);db.wj(Gb);40===db.Ue&&Gb?(ka=this.Co.dId(db),({index:db}=this.Co.kme(ka)).returnValue?(this.Co.tYe(ka,db),this.AKb.add(ka.objectId),pg.p(ka)||this.aCb.add(ka.objectId),ka.Af&&this.lkf(ka)):this.b2c.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!Gb,!ka.$j),39===db.Ue||this.RPd())}oQl(ka){const db=[],Gb=this.j8e.iQl();if(this.AKb.size===Gb.length)return db;Gb.forEach(cc=>{!this.AKb.has(cc)&&fc.a.TUm(cc,ka,this.j8e,this.vd)&&db.push(cc)});return db}udj(){for(let ka=0;ka<this.b2c.length;ka++){const db=this.b2c.J(ka);let Gb;({index:Gb}=this.Co.kme(db)).returnValue?(this.Co.tYe(db,Gb),pg.p(db)||this.aCb.add(db.objectId),this.AKb.add(db.objectId),db.Af&&this.lkf(db)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
db.Qwa,db.Y0a,db.objectId,db.Af))}this.b2c.clear()}ask(ka,db){ka.wo(Gb=>{if(11===Gb.Ue){var cc=Gb.currentNode;const xc=cc.ja(xf.a.s8e,null),Vc=cc.ja(xf.a.q8e,null);Gb=!!xc&&0<xc.length;const Wd=!!Vc&&0<Vc.length;Gb&&xc.forEach(od=>{const Be=this.vd.Eb(od);Be&&!pg.s(Be)&&db.add(od,0)});Wd&&Vc.forEach(od=>{db.nb(od)&&db.remove(od)});(cc=cc.ja(Ac.a.XK,null))&&cc.forEach(od=>{const Be=this.vd.Eb(od);Za.ParagraphReader.Wb(Be)&&!this.yh.Zx.nb(od)&&this.yh.Zx.add(od,new Si.a)});const re=db.keys;for(let od=
0;od<re.length;od++){cc&&0<db.J(re.J(od))&&(this.yh.VU.nb(re.J(od))||this.yh.VU.add(re.J(od),new Ca.a(new Nc.a)),cc.forEach(ve=>{const Wf=this.vd.Eb(ve);Za.ParagraphReader.Wb(Wf)&&(this.yh.Zx.J(ve).bN||(this.yh.Zx.J(ve).bN=new Ca.a(new Nc.a)),this.yh.VU.J(re.J(od)).add(ve),this.yh.Zx.J(ve).U2a=!0,this.yh.Zx.J(ve).bN.add(re.J(od)))}));let Be;db.Z(Be=db.keys.J(od),db.J(Be)+1)}return Gb||Wd}return!0},null)}H8m(ka,db,Gb){ka&&(this.XQj(db,Gb),this.yh.Zx.nb(ka.id)||this.yh.Zx.add(ka.id,new Si.a),Gb.forEach((cc,
xc)=>{0<xc&&(this.yh.VU.nb(cc)||this.yh.VU.add(cc,new Ca.a(new Nc.a)),this.yh.Zx.J(ka.id).bN||(this.yh.Zx.J(ka.id).bN=new Ca.a(new Nc.a)),this.yh.VU.J(cc).add(ka.id),this.yh.Zx.J(ka.id).U2a=!0,this.yh.Zx.J(ka.id).bN.add(cc));Gb.Z(cc,xc+1);return!0}))}XQj(ka,db){ka.forEach(Gb=>{if(Gb.Qc){const cc=this.vd.Eb(Gb.$j);cc&&!pg.s(cc)&&db.Z(Gb.$j,0)}else db.nb(Gb.$j)&&db.remove(Gb.$j)})}}Object(f.a)(Fl,"CommentModelBootLoader",null,[730]);var Wh=c(1052);class we{constructor(ka){this.FFh=ka;this.Muc=null;
this.V5g=void 0;this.W5g=null;this.rzc=new Map;this.Uye=new Map}LVn(){Wh.a.cTa(this.oSo.bind(this))}oSo(ka,db){const Gb=ka.id.toString();var cc=ka.getValue(sa.a.cF).toString();db?(this.rzc.delete(Gb),this.Uye.delete(cc)):(this.rzc.set(Gb,ka),this.Uye.set(cc,ka));0===this.rzc.size&&this.Muc&&(ka=+new Date-+this.Muc,this.Muc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));db||this.V5g!==cc||(db=+new Date-
+this.W5g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${db}`),cc=new J.a,cc.durationMs=db,this.FFh.logKpiFailure(eh.a.gGd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:cc},{name:eh.a.lFh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:cc}));this.Muc||(this.Muc=new Date)}set Ibn(ka){this.V5g=ka;this.W5g=new Date;if(ka=this.gQl(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),
ka=new J.a,this.FFh.logKpiFailure(eh.a.gGd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:eh.a.lFh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}iQl(){return[...this.rzc.keys()]}gQl(ka){return this.Uye.get(ka)}R5h(ka){return this.rzc.get(ka)}}Object(f.a)(we,"CommentNodeTracker",null,[]);class bo{get contentType(){return 0}constructor(ka,db,Gb,cc,xc){this.J9f=ka;this.Co=db;this.O_=Gb;this.mJ=cc;this.yh=xc;this.J9f.g8i(this)}Dgj(ka,db,Gb){0===db?(db=this.Co.AVc(ka),
this.O_.selectComment(db?this.Co.Px:this.Co.UD(ka),Object.assign(new oj.a,{iS:Gb||db,s$:1}))):this.mJ.clearSelection()}Ioj(ka){if(this.yh.xm||this.Co.AVc(ka.contentId))return!0;const db=this.Co.UD(ka.contentId);if(db)return this.Co.Yha(db);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${ka.contentId}`);return!1}}Object(f.a)(bo,"CommentReviewSuggestionContentActor",null,[729]);class tf{get rvj(){return this.Lig}constructor(ka,db){this.qGd=ka;this.Rr=db;this.Lig=new Set([12])}initialize(){}pGi(ka){if(!Za.ParagraphReader.Wb(ka.node))return[];
ka=Za.ParagraphReader.mFb(ka.node);return this.qGd.UAm(ka)}pSi(){this.qGd.hjn()}Fli(){return this.Rr.Uwo?this.Rr.Q$b:!0}}Object(f.a)(tf,"CommentReviewSuggestionContentProvider",null,[728]);var Gj=c(307),th=c(70),Qg=c(127),Cg=c(251),ok=c(1583);class Je{constructor(){this.commentId=null;this.lXc=!1}}Object(f.a)(Je,"CommentToSelectOnPaneLoadData",null,[]);class Ob{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg,Kh,Vg){this.Wq=ka;this.Co=db;this.BDa=Gb;this.O_=cc;this.VK=xc;this.yh=Vc;this.XNd=Wd;
this.Rr=re;this.x4b=od;this.lKb=Be;this.nc=ve;this.sJf=Wf;this.focusManager=lg;this.Ck=Kh;this.t0k=Vg;this.I4c=(Gk,wl,el,Ki,xj)=>{if(1===el||!xj)return 32;xj[Gj.a.On]=Ck.a.oSc?this.yh.xm:this.yh.vIa;return 32};this.nc.ra(ph.a.BQb,th.a.frame,this.Wq.BQb.bind(this.Wq));this.nc.ra(ph.a.WKd,th.a.frame,this.WKd.bind(this));this.nc.ra(ph.a.e8e,th.a.frame,this.Xjn.bind(this));this.nc.ra(ph.a.C_k,th.a.frame,this.Wjn.bind(this));this.nc.ra(ph.a.sPi,th.a.frame,this.Con.bind(this));this.nc.ra(ph.a.NRh,th.a.frame,
this.jln.bind(this));this.nc.ra(ph.a.sFh,th.a.frame,this.Dmn.bind(this));this.nc.fb(ph.a.h8e,th.a.frame,this.ICk.bind(this),64);this.nc.fb(ph.a.pGd,th.a.frame,this.fXn.bind(this),64);this.nc.ra(Vj.a.selectComment,th.a.frame,this.O_.Q$n.bind(this.O_));this.Rr.uZm&&this.nc.ra(Vj.a.H1d,th.a.frame,this.H1d.bind(this));this.Smh(Vj.a.KKc,!1);this.Smh(Vj.a.$cf,!0);this.nc.fb(Vj.a.rGd,th.a.frame,this.rGd.bind(this),64);this.Rr.ehb&&(this.nc.ra(Vj.a.rlg,th.a.frame,this.Msn.bind(this)),this.nc.fb(Vj.a.I4c,
th.a.frame,this.I4c.bind(this),96));this.nc.ra(Vj.a.OIi,th.a.frame,Qg.ActionManager.Lf);this.Rr.TAb&&this.nc.ra(Vj.a.K4e,th.a.frame,this.gOk.bind(this));this.nc.ra(Vj.a.BPh,th.a.frame,(Gk,wl)=>Cg.a.eia(wl.ek)&&Cg.a.bcc()?8:32)}get Gj(){return this.Co}get mode(){return this.Wq.mode}get Sz(){return this.Wq.Sz}get yA(){return this.Rr.Yq}get nj(){return this.lKb.value}get mb(){return this.sJf.value}get mJ(){return this.Wq}WKd(ka,db,Gb,cc,xc){return xc?xc?(ka=this.O_.SPd(xc.NavigationId))&&this.O_.TPd(ka,
1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}Xjn(ka,db,Gb,cc,xc){xc&&this.VK.i$("OnCommentInit",{...(new ok.a),VGa:()=>{var Vc=this.O_.SPd(xc.NavigationId);if(Vc){var Wd=this.O_.TPd(Vc,1);Wd?this.x4b.isVisible?(this.N7c(Wd,1),this.focusManager.iD(xd.AFrame.Qr)):this.Gj.Yha(Wd)?(Vc=pg.r(Wd),this.O_.selectComment(Wd,{...(new oj.a),iS:!Vc,s$:1}),this.focusManager.iD(xd.AFrame.GM)):
(this.yh.xm||this.nc.processAction(ph.a.AV,2),kg.a.E3(y.AFrameworkApplication.oc,()=>{this.N7c(Wd,1)},nl.a.N7c)):this.nc.processAction(ph.a.w5a,2)}}});return 32}Wjn(ka,db,Gb,cc,xc){xc?(ka=this.Gj.fPc(xc))?this.mJ.$fc(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.mJ.$fc(null);return 32}Con(ka,db,Gb,cc,xc){if(xc){if(this.yh.MHb){for(ka=0;ka<xc.length;ka++)this.Gj.Zij(xc[ka]);this.Wq.nOb()}else this.Gj.Xtk(xc);this.h4m(xc)}return 32}jln(ka,
db,Gb,cc,xc){if(xc)if(this.yh.MHb){for(ka=0;ka<xc.length;ka++)this.Gj.Zij(xc[ka],!0);this.Wq.nOb()}else this.Gj.WWk();return 32}Dmn(ka,db,Gb,cc,xc){this.yA||this.yh.xm||this.nc.processAction(ph.a.AV,2);if(xc){ka=null;if(!this.Sz||2!==this.mode&&3!==this.mode){if(!xc)return 8;if(this.yA)ka=this.rBl(xc);else for(db=0;db<xc.length&&(ka=this.Gj.f0(xc[db].toString()),this.XNd.eZd&&(!ka||ka.done));db++);}else ka=this.Sz;this.N7c(ka,1);ka&&this.yh.yY&&this.focusManager.kg(this.yA&&!this.yh.xm?xd.AFrame.GM:
xd.AFrame.Qr)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}ICk(ka,db,Gb,cc,xc){var Vc;if(!xc)return 32;if(xc&&0<xc.length){db=ka=Gb=0;cc=!1;for(let Wd=0;Wd<xc.length;Wd++)xc[Wd].toString()===(null===(Vc=this.Sz)||void 0===Vc?void 0:Vc.objectId)?(cc=!0,ka++):this.Co.BFf(xc[Wd])&&(cc&&0===Gb&&(Gb=Wd,db=ka),ka++);(Vc=this.Co.f0(xc[Gb].toString()))?(this.BDa.knc.mSf=db+1,this.BDa.knc.Tqb=ka,this.mJ.$fc(Vc.id)):(xc=xc[Gb],this.nj.Eb(xc)?
a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${xc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",xc.toString()))}return 32}fXn(){this.mJ.$fc(null);return 32}Smh(ka,db){this.nc.ra(ka,th.a.frame,(Gb,cc,xc)=>this.Okn(xc,db))}Msn(ka,db,Gb){var cc;if(2===Gb){if(this.Co.Px)return 32;if(Ck.a.oSc||this.yh.xm)return this.nc.processAction(ph.a.AV,2),this.yh.vIa=this.yh.xm,32;if(!this.Co.hSc())return 32;
this.yh.vIa=!this.yh.vIa;this.VK.i$("OnFloatingCommentsToggle");null===(cc=T.App.za)||void 0===cc?void 0:cc.updateCommandUI(!0)}return 32}H1d(ka,db,Gb){2===Gb&&(ka=this.Gj.Zs.Pc(7),ka.Db(this.Gj.JJa),db=new Dl.a,db.Jca(`${String.fromCodePoint(128077)} \n`),this.Co.JCb(md.a.instance.hb.lb,void 0,db),this.t0k.EVd(),ka.dispose());return 32}Okn(ka,db=!1){if(2===ka)ka=this.Gj.Zs.Pc(15),ka.Db(this.Gj.JJa),this.Ck.ge(()=>{this.KKc(db)},"ECM:DAC"),ka.dispose();else if(1===ka&&!this.Gj.P$b())return 2;return 32}KKc(ka=
!1){this.Wq.mode=1;const db=this.Gj.$O();for(const Gb of db)Gb.Xq===ec.a.beingCreated||ka&&!Gb.done||Gb.Af||this.Wq.deleteComment(Gb);this.focusManager.kg(xd.AFrame.Un);0<(ka?this.Gj.$O().filter(Gb=>Gb.done):this.Gj.$O()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}rGd(ka,db,Gb){if(2===Gb)if(ka=this.focusManager.currentScope.name,ka!==
xd.AFrame.Qr&&ka!==xd.AFrame.GM){!this.yA||this.yh.xm?(this.yh.xm||this.nc.processAction(ph.a.AV,2),this.focusManager.kg(xd.AFrame.Qr)):this.focusManager.kg(xd.AFrame.GM);var cc=this.mb.hb.lb;if(!cc||!cc.Pa)return 2;ka=cc.Pa.cpBegin;db=cc.Pa.node;cc=!!this.Sz&&(Uc.SelectionEditor.Il(cc)||cc.VH)&&pg.q(this.Sz,db,this.nj,ka);ka=!!this.Sz&&(2===this.mode||3===this.mode);if(cc||ka)return this.mJ.Fgj(this.Sz.id,!0),32;cc=this.yA&&!this.yh.xm?this.Gj.S5h(!0,!0):null;this.mJ.Z$n(cc)}else this.Gj.qt&&(this.Wq.lac.ygj(this.Gj.qt,
!0),this.Wq.lac.Cjb(null===(cc=this.Gj.qt)||void 0===cc?void 0:cc.objectId)),this.focusManager.kg(xd.AFrame.Un);return 32}gOk(){return 4}h4m(ka){const db=new Set;for(let Gb=0;Gb<ka.length;Gb++){const cc=this.Gj.fPc(ka[Gb]);cc&&db.add(cc.Af?cc.Af:cc.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",db.size.toString())}N7c(ka,db){ka?this.x4b&&!this.yh.yY?this.yh.Jfb=Object.assign(new Je,{commentId:ka.id,lXc:!1}):this.O_.selectComment(ka,Object.assign(new oj.a,{iS:!!db,s$:db})):
a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}rBl(ka){let db=null,Gb=!1;for(let cc=0;cc<ka.length;cc++){const xc=ka[cc].toString();if(this.Gj.BFf(ka[cc])){db||(db=xc);if(Gb&&this.Gj.qt.objectId!==xc)return this.Gj.f0(xc);Gb=Gb||!!this.Gj.qt&&this.Gj.qt.objectId===xc}}return db?this.Gj.f0(db):null}}Object(f.a)(Ob,"CommentsActionManager",null,[]);var Ah=c(234),Mq=c(49),ti=c(178),Wj=c(1830),Hj=c(519),dp=c(31),Gp;(function(ka){ka[ka.Ddp=0]="commentDeeplink";ka[ka.catchUpActivity=
1]="catchUpActivity"})(Gp||(Gp={}));Object(f.b)("DeeplinkSource",Gp);class To{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg){this.ga=ka;this.Wh=db;this.Cv=Gb;this.Ive=cc;this.oQ=xc;this.Eeh=Vc;this.Vb=Wd;this.$i=re;this.Mg=od;this.jwb=Be;this.Kve=ve;this.mK=Wf;this.kSe=!1;this.Wko=Kh=>{if(this.Mg.Yq&&!this.$i.xm){const Vg=new la.a(0,1,0,()=>{this.Lij(Kh)},136,void 0,!0);y.AFrameworkApplication.oc.Xb(Vg)}else this.Lij(Kh)};lg.execute(Kh=>{this.EE=Kh})}get Co(){return this.Wh}get mb(){return this.jwb.value}NUh(ka){let db=
ka.Xq===ec.a.beingCreated?ka.yz.draftId:ka.id,Gb=null;ka.Af&&(db=ka.Af,Gb=()=>{this.Eeh.selectComment(ka.id)});this.oQ.setInitialActiveContainerId(db,0,Gb)}Q$n(ka,db,Gb,cc,xc){if(!xc.commentId)return 2;ka=this.Wh.UD(xc.commentId);if(!ka)return 2;this.bpb(ka,xc);return 32}Cgj(ka,db){var Gb,cc;if(ka){var xc=(null===(cc=null===(Gb=this.Wh.Px)||void 0===Gb?void 0:Gb.yz)||void 0===cc?void 0:cc.draftId)===ka?this.Wh.Px:this.Wh.UD(ka);this.selectComment(xc,db)}}selectComment(ka,db){ka&&this.bpb(ka,db)}zgj(ka,
db){var Gb=this.SPd(ka);Gb&&((Gb=this.TPd(Gb,0))?db.dfg?(this.$i.Jfb=Object.assign(new Je,{commentId:Gb.id,lXc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.bpb(Gb,Object.assign(new oj.a,{commentId:Gb.id,s$:1,iS:!0,uVc:!0})),this.Mg.Yq&&void 0!==ka&&null!==ka&&this.NUh(Gb),kg.a.E3(y.AFrameworkApplication.oc,()=>{this.Vb.kg(this.Mg.Yq&&!this.$i.xm?xd.AFrame.GM:xd.AFrame.Qr)},nl.a.ngo),Ah.a.instance.lf(Mq.a.tOh,(new Date).getTime()),ka=this.Mg.Yq?
"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.kX)):this.ga.processAction(ph.a.w5a,2))}SPd(ka){let db=null;var Gb=null;if(K.a.Lcc(ka))db=ka;else if(({Hu:Gb}=v.d(ka)).returnValue&&(ka=Gb))return Hj.a.comment in ka&&(db=ka[Hj.a.comment]),db;db||(Gb=Gb?Object.keys(Gb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",Gb?
Gb.join(","):"Not Json."));return db?db.toString():null}TPd(ka,db){const Gb=this.Wh.fPc(ka),cc=0===db;cc&&this.mK.logKpiUsage(eh.a.gGd,0);if(!Gb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,db);const xc=new dp.a;xc.name="DeepLinkSource";xc.string=Gp[db];this.mK.logActivity("CommentDeeplinkNotFound",{dataFields:[xc]});cc&&(db=new J.a,db.extendedProperties=new Map([["ErrorLevel","warning"]]),this.mK.logKpiFailure(eh.a.gGd,"CommentNotFound",
{isIntentional:!1,isInternal:!0,additionalValues:db}),this.Kve.Ibn=ka)}return Gb}Lij(ka){this.kSe=!0;this.mb.Bc(ka);this.kSe=!1}bpb(ka,db){if(ka){this.Mg.ehb&&!this.$i.vIa&&this.ga.processAction(Vj.a.rlg,2);this.$i.PLb&&(y.AFrameworkApplication.oc.Ze(this.$i.PLb),this.$i.PLb=null);var Gb=this.Wh.qt,cc=this.Co.csf(ka),xc=2===db.s$,Vc={};xc&&(Vc.TriggeredByFindReplace=!0);if(this.$i.xm)xc&&(Vc.PaneAlreadyOpen=!0),ti.UISurfaces.Mu().then(Wd=>{Wd.setSelectedTaskPane(Wj.a.sGd);return null});else if(ka.Xq!==
ec.a.beingCreated&&!this.Co.Yha(ka))this.$i.yY?this.ga.processAction(Vj.a.AV,2):this.$i.Jfb=Object.assign(new Je,{commentId:ka.id,lXc:db.uVc}),xc&&(Vc.OpeningPaneToSelect=!0);else if(this.Mg.Yq){const Wd=cc.Xq===ec.a.beingCreated;Wd?this.oQ.GTa(cc.yz.draftId,0,db.iS):this.oQ.GTa(cc.id,0,db.iS);!Wd&&xc&&(Vc.SelectingDHC=!0)}kg.a.E3(y.AFrameworkApplication.oc,()=>{this.$i.yY&&(db.iS&&this.Vb.kg(this.Mg.Yq&&!this.$i.xm?xd.AFrame.GM:xd.AFrame.Qr),db.uVc&&this.Co.Yha(ka)||!db.iS&&!db.s$||this.Eeh.selectComment(ka.id))},
nl.a.ccg);xc=this.Co.csf(Gb);this.Mg.gva&&this.EE&&xc&&xc.id!==cc.id&&this.EE.fireEvent(9,{comment:xc});this.Wh.selectComment(ka);this.Mg.gva&&this.EE&&ka.Xq===ec.a.normal&&!ka.Af&&this.EE.fireEvent(8,{comment:ka});this.Ive.highlightComment(ka,!0);this.Cv.EF(0,cc,Gb);T.App.za.updateCommandUI(!0);0<Object.keys(Vc).length&&this.mK.Sv(Vj.a.selectComment,{customData:Vc})}}}Object(f.a)(To,"CommentSelectionActor",null,[727]);class Vk extends bf.a{constructor(){super();this.comment=this.commentId=null;this.H_=
Object.assign(new Bc.a,{T_:Vk.getTypeName(),B_:Vk.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(Vk,"CommentSmartReplySignal",bf.a,[]);class hq extends Ra.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Bc.a,{T_:hq.getTypeName(),B_:hq.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(f.a)(hq,"SmartReply",Ra.a,[]);var fm=c(863);class Cq{constructor(ka){this.psa=ka}o5b(ka,db){return Object.assign(new fm.a,{parentPath:["Signal",Vk.getTypeName()],items:[Object.assign(new zd.a,{body:Object.assign(new Vk,{commentId:ka,comment:db})})]})}s0f(ka){const db=new ib.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const Gb of ka.ResultSets[0].Documents)db.add(Gb.Caption);0<db.count&&this.psa.s0f(ka.CommentId,
db.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return hq.getTypeName()}}Object(f.a)(Cq,"BaseCommentSmartReplyProvider",null,[952]);class wm extends Cq{constructor(ka,db,Gb,cc){super(ka);this.Oe=db;this.oA=Gb;this.XUj=cc}initialize(){this.oA.Uk().then(()=>{this.Oe.ob(this,Cq.prototype.getTypeName.call(this))})}invoke(ka,db){this.oA.Uk().then(()=>{this.XUj.getAugLoopRuntimeManager().submitOperation(Object.assign(new ob.a,{operation:this.o5b(ka,
db)}))})}GB(ka,db){ka&&xa.a.getTypeNameFor(ka.content)===this.getTypeName()&&db===Na.a.getTypeName()?this.s0f(ka.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(f.a)(wm,"CommentSmartReplyProvider",Cq,[292]);var Xk=c(38),mo=c(137),Dk=c(161),Ei=c(384);class tj{constructor(ka,db,Gb,cc,xc,Vc){this.Ga=ka;this.od=db;this.Bx=Gb;this.mIe=cc;this.Kve=xc;this.rN=Vc;this.ovb=!1;this.Kve.LVn();this.bOg=this.M4l();this.J4f&&(Xk.a.addHandler(window.self,Oi.a.Mqh,
()=>{this.ovb=!0}),Xk.a.addHandler(window.self,Oi.a.Nqh,()=>{this.ovb=!1}));0<this.bOg&&y.AFrameworkApplication.le("77dda873;fe8jd931")}get mx(){return this.Bx?this.Bx.value:null}get CDa(){return this.mIe.value}get mOo(){return this.ovb}get Q$b(){return 0<this.bOg}get Yq(){return this.rN.Yq}get $ml(){return!0}get hHk(){return Object(Ei.c)()?!1:this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get uRb(){return this.od.isFeatureEnabled(116)&&!Dk.App.BWc}get fbo(){return this.od.isFeatureEnabled(38)&&
this.Ga.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get D_k(){return this.Ga.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get J4f(){return this.Ga.$("RecordCommentActionsInTypingIsEnabled")}get XPi(){return this.Ga.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get oDb(){return this.Yq&&!this.Q$b&&!this.Ga.kb("BootActivityNavigationId")&&F.a.pu}get TAb(){return this.od.isFeatureEnabled(7)}get gGk(){return this.Ga.$("AtMentionUserFloodGateCampaignIsEnabled")}get V_k(){return this.Ga.$("CommentFriendlyTimestampsIsEnabled")}get Rml(){return this.Ga.kb("DisabledChangeGatesInSharedComments")}get YNd(){return this.rN.YNd}get KQb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",
!1)}get P6n(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightAlignedEntrypointIsEnabled",!1)}get Ngg(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get TY(){return this.Ga.kb("PresenceUserId")}get Mda(){return Dk.App.$oe&&!!mo.PageReader.instance&&mo.PageReader.instance.Bwa(T.App.za.jb.Yc).Mda}get fhb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get z_m(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",
!1)}get CFo(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get ehb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get M0k(){return this.Ga.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get B0k(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get uZm(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",
!1)}get contentNavigationApiEnabled(){return this.rN.contentNavigationApiEnabled}get Gvn(){return this.od.isFeatureEnabled(88)}get gva(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}get contentFilterApiEnabled(){return this.rN.contentFilterApiEnabled}get U_k(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get Uwo(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",
!1)}get xxl(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExpandToFullHyperlinkRange",!1)}M4l(){if(this.mx&&this.CDa){const ka=new hf.GraphIterator;ka.set(this.mx);this.CDa.o5a(ka);let db=0;39===ka.Ue&&(db=ka.Qp());return db}return-1}}Object(f.a)(tj,"CommentsSettings",null,[]);var qb=c(1620),Zb=c(1379);class ed{constructor(ka){this.eaa=ka}yxh(ka,db,Gb){const cc=new ij;db=this.eaa.lRa(db)?db.objectId:null;if(!db)return cc;db=ia.a.Ff(db);if(Gb.contains(db))return cc.OTc=0,cc.NTc=
ka.length,cc;for(let Vc=0,Wd=ka.length;Vc<Wd;Vc++){var xc=ka[Vc];Gb=pg.g(xc);xc=pg.d(xc);Gb&&Zb.a.hHh(Gb,db)&&(cc.OTc=Vc);if(xc&&Zb.a.hHh(xc,db)){cc.NTc=Vc;break}}return cc}Xsh(ka,db,Gb){const cc=-1===db.OTc&&-1===db.NTc,xc=-1<db.OTc?db.OTc:-1;db=-1<db.NTc?db.NTc:ka.length;const Vc=!cc&&xc===db;var Wd=!1;for(let re=0;re<ka.length;re++){const od=ka[re],Be=Ng.a(od);if(1!==Be&&2!==Be&&3!==Be)continue;this.eaa.gTa(od);if(cc||re<xc||re>db)continue;const ve=3===Be||2===Be&&-1!==od.className.indexOf(he.a.pQa),
Wf=Gb?1:2;this.KDk(re,xc,db,Wf,ve,Wd,od,Vc);if(re!==db||Vc)(Wd=this.eaa.$2a.J(Be).J(Wf))&&od.classList.add(Wd),Wd=ve}}KDk(ka,db,Gb,cc,xc,Vc,Wd,re){ka!==db&&ka!==Gb||xc||Vc||((ka=this.eaa.whc.J(cc))&&Wd.classList.add(ka),re&&Wd.classList.add(he.a.R_f))}}Object(f.a)(ed,"DefaultHighlightChangeHandler",null,[726]);var Od;(function(ka){ka[ka.success=0]="success";ka[ka.noSelection=1]="noSelection";ka[ka.invalidContent=2]="invalidContent"})(Od||(Od={}));Object(f.b)("AnchorCreationResult",Od);var $c=c(63),
yf=c(23),Cf=c(277),hh=c(236),Of=c(1208);class jj{}Object(f.a)(jj,"EditorAnchorInfo",null,[746]);class ch{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od){this.TYm=ka;this.sJf=db;this.Gj=Gb;this.fxa=cc;this.BDa=xc;this.lm=Vc;this.VK=Wd;this.Rr=re;this.Hlg=od;this.veh=null;this.fxa.dTa(this.BDa);this.Rr.contentFilterApiEnabled&&(this.VK.k$("OnCommentPaneOpen",this.mUo.bind(this)),this.VK.k$("OnCommentPaneClose",this.lUo.bind(this)),this.VK.k$("OnContentFilterUpdate",this.o1c.bind(this)))}get mb(){return this.sJf.value}get nj(){return this.TYm.value}initialize(){}Sym(ka){this.veh=
ka}dispose(){}Cjb(ka){this.BDa.Cjb(ka)}kac(ka){this.BDa.kac(ka)}highlightComment(ka){this.ygj(ka,!1);this.BDa.Cjb(ka.objectId)}$nc(ka){this.BDa.$nc(ka)}$Ea(ka){return this.BDa.$Ea(ka)}o1c(){this.Qqe("OnContentFilterUpdate")}mUo(){this.Qqe("OnCommentPaneOpen")}lUo(){this.Qqe("OnCommentPaneClose")}Qqe(ka){const db=[],Gb=new Set;for(const xc of this.Gj.$O())if(!xc.Af&&xc.Xq!==ec.a.beingCreated&&!this.Gj.mJ.Rzh(ka,xc)){var cc=this.G5l(xc);Gb.has(cc.id.toString())||(Gb.add(cc.id.toString()),(cc=cc.pe($c.InteractiveViewManager.instance.zd.$b))&&
db.push(cc))}db.forEach(xc=>{this.fxa.aoc(xc)})}G5l(ka){var db,Gb,cc;const xc=null===(db=this.nj)||void 0===db?void 0:db.Eb(ka.objectId);if(!xc)return null;ka=pg.k(xc);db=null===(Gb=this.nj)||void 0===Gb?void 0:Gb.Eb(ka);return null===(cc=this.Hlg.instance)||void 0===cc?void 0:cc.GGb(db)}ygj(ka,db){if(!ka.Xq){var Gb=this.nj.Eb(ia.a.Ff(ka.objectId)),cc=Te.a.jca(Gb,this.nj,!0);Gb=Te.a.jca(Gb,this.nj,!1);if(cc&&Gb){const xc=cc.Kb.paragraph;cc=cc.Kb.cp;if(this.aSm(xc,cc))T.App.za.updateCommandUI(!0);
else{cc=yf.SelectionFactory.ne(xc,cc);Gb=Wc.a.Oc(Gb.Kb.paragraph,Gb.Kb.cp);if(ch.Uf.n9(cc.Pa)||ch.Uf.n9(Gb))ka.UQa=!0,ka.m5a();ka=db?yf.SelectionFactory.Dy(cc,Gb):cc;this.veh(ka)}}}}IWk(){this.BDa.kac(null);this.BDa.Cjb(null)}f7k(){const ka=new jj;return{returnValue:Od.success,anchor:ka}}aSm(ka,db){if(ka&&Object(tm.a)(Of.MainView,this.lm.zd)){var Gb=ka.pe(this.lm.zd.$b);ka=document.getElementById(Rm.AppFrame.qVa);if(Gb&&ka){db=Cf.a.Tq(Gb,db);if(!db)return!1;db=db.y;Gb=Sys.UI.DomElement.getBounds(ka).y;
ka=ka.offsetHeight;if(db>=Gb&&db<=Gb+ka)return!0}}return!1}static get Uf(){return hh.a.instance}static getInstance(){return ch.Wl()}static Wl(){return ch._instance||(ch._instance=new ch(new V.a(()=>T.App.za.jb.Yc.vd),new V.a(()=>md.a.instance),L.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),L.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,L.a.instance.resolve("WordEditor.Comments.CommentHintActor"),$c.InteractiveViewManager.instance,L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
L.a.instance.resolve("WordEditor.Comments.CommentsSettings"),L.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")))}}ch._instance=null;Object(f.a)(ch,"EditorCommentHintManager",null,[724,725,10]);var Fi=c(2048),Bh=c(350),Sh=c(1158);class Jc extends Cl.a{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg,Kh,Vg,Gk,wl,el,Ki,xj,Hk,Zh,Ho,Xh,Mm,Mn){super(Wd);this.ei=db;this.jwb=re;this.d8e=Be;this.qsa=ve;this.Xrc=Wf;this.oQ=lg;this.Mg=Kh;this.Zp=Vg;this.VUb=Gk;this.$i=wl;this.u2=el;this.he=
xj;this.mK=Hk;this.MT=Ho;this.iGd=Xh;this.Hlg=Mn;this.Mmi=this.ngh=this.dXa=null;this.Rmb=()=>{this.Wra.rpa()&&(this.Z7i(this.Wra.qc),this.Wra.Kic(this.Rmb))};this.U_c=wj=>{2===wj.mode?this.sD=1:1===wj.mode&&(this.sD=0);this.Wh.Px&&0===this.sD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.Wh.Px.yz.sessionType):this.$i.yY&&(this.yA||this.v2.isVisible)&&this.nOb()};this.ain=()=>{this.$i.MHb?this.mode=0:this.sD=0};this.lHa=
(wj,cn)=>{var oh;wj=cn.pl.lb;if((this.yA||this.zda&&this.zda.isVisible)&&!this.VUb.kSe&&wj){cn=Uc.SelectionEditor.Il(wj);var Gl=wj.VH;null!==(oh=this.Mmi)&&void 0!==oh&&oh.Xba||(this.Co||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),oh=this.Co&&this.Co.tkb(this.ga,!1),1!==this.mode||cn&&!Gl||!oh?this.Xrc.EVd():this.fal(wj));2!==this.mode&&3!==this.mode&&this.Mg.D_k&&this.AMo(wj,cn,Gl)}};this.qUk=()=>{if(this.Gj&&this.Gj.Px&&!T.App.VBf){var wj=this.Gj.Px;wj.yz.sessionType!==
Fi.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${wj.Xq} present on app shutdown`),(wj=fc.a.lUl(wj))&&this.mK.logKpiFailure(wj,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:eh.a.v4b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.jin=()=>{if(this.$i.yY){var wj=()=>!0;this.yA&&!this.$i.xm&&(wj=cn=>this.Co.Yha(cn));wj=this.Co.snf(wj);this.nOb(wj)}};this.ga=Wd;this.sD=1===this.ga.mode?0:1;this.v2=xc;this.Wh=cc;this.vaa=Vc;this.Vb=od;this.LUn();Gb.C6a(this.qsa);
this.mb.Sw(this.lHa);ka.CWR(()=>ka.result.kC.yNa(this.ain));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.XZa(this.U_c);this.u2.k$("OnAfterTrackChangeMarkupViewChange",this.jin);y.AFrameworkApplication.lI&&y.AFrameworkApplication.lI(this.qUk);Mm.execute(wj=>{this.EE=wj});Zh.execute(wj=>{wj.G4k.execute(cn=>{this.Mmi=cn})})}LUn(){this.Wra&&(this.Wra.rpa()?this.Z7i(this.Wra.qc):this.Wra.c2b(this.Rmb))}Z7i(ka){ka.Cma(()=>{this.sAo()})}get Wra(){var ka;return null===(ka=Dk.App.hn)||void 0===ka?
void 0:ka.jb}get mb(){return this.jwb.value}get Gj(){return this.Wh}get Co(){return this.Wh}get yA(){return this.Mg.Yq}get EPi(){return!0}get rhj(){return!0}get rac(){return this.dXa}set rac(ka){this.dXa=ka}get mode(){return super.mode}set mode(ka){ka!==this.sD&&(super.mode=ka,this.m5a())}get Sz(){return this.model&&this.model.qt?this.model.qt.Af?this.model.UD(this.model.qt.Af):this.model.qt:null}get nj(){return this.ei.value}get Zpj(){return!1}get Mda(){return this.Mg.Mda}nOb(ka=null,db=null){const Gb=
this.Co,cc=!this.sD,xc=this.zda.R_k,Vc=Gb.jSd();xc.vog(Vc?5:1,cc);ka=this.Mg.KQb&&ka?ka:Gb.Pnf(this.Mg.KQb&&this.yA&&!this.$i.xm);xc.Zao(ka,Vc,Gb.aWa);this.Yng();db&&a.ULS.sendTraceTag(572281362,327,50,db)}p1c(ka,db,Gb=!1){this.$i.xm?this.oQ.bGj():db?this.oQ.deleteContainer(ka.Xq===ec.a.beingCreated?ka.yz.draftId:ka.id,0,Gb):this.RMn(ka)}RMn(ka){const {uHo:db}=this.Wh.OZl(ka),Gb=this.vaa.$Ea(ka.objectId);Gb&&this.oQ.addContainer(ka.id,Gb.parentElement,0,db)}Jgj(ka){const db=this.Sz;this.P7c();this.qsa.EF(0,
this.Wh.qt,db);this.yA&&this.Wh.qt&&!this.$i.xm&&this.oQ.GTa(this.Wh.qt.id,0,1===ka)}$$n(){const ka=this.Sz;this.Q7c();this.qsa.EF(0,this.Wh.qt,ka);this.yA&&this.Wh.qt&&!this.$i.xm&&this.oQ.GTa(this.Wh.qt.id,0,!1)}$nc(ka){this.vaa.$nc(ka)}Isl(ka,db){this.oQ.addContainer(ka,null,0,db)}Azn(ka){this.oQ.M_i(ka)}Ksl(ka,db){this.oQ.k6c(ka,db,0)}vTo(){this.oQ.e2e()}Bgj(ka){if(ka&&(2!==this.mode||ka.Xq===ec.a.beingCreated)){var db=this.Wh.qt;db!==ka&&(this.Wh.selectComment(ka),this.v2.isVisible?this.$i.yY?
(this.v2.selectComment(ka,1),this.ila.selectComment(ka.id)):this.$i.Jfb=Object.assign(new Je,{commentId:ka.id,lXc:!1}):this.yA&&!ka.done&&(this.Fgj(ka.id,!1),this.ila.selectComment(ka.id)),!this.v2.isVisible&&this.yA&&ka.done||(this.lac.Cjb(ka.objectId),this.qsa.EF(0,this.Sz,db)))}}bUc(){}Sgf(){this.$i.MHb=!1}kAb(ka){this.Mg.XPi&&this.Wh.qt&&this.clearSelection();super.kAb(ka);this.mK.logKpiUsage(eh.a.o8e,0);this.Yng();if(this.yA){const db=this.Wh.Hfm(ka.draftId);this.Isl(ka.draftId,db)}}addReply(ka,
db){this.mK.logKpiUsage(eh.a.uGd,0);super.addReply(ka,db)}hva(ka){this.yA&&null!=ka.yz&&this.Wh.e9i(ka.yz.draftId);super.hva(ka);this.vaa.Cjb(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",pg.a(ka));this.mK.logKpiUsage(eh.a.jFh,0);this.vUk(ka);fc.a.j0o(ka,this.nj,this.mK);this.mK.Sv(Vj.a.iFh,{succeeded:!0,customData:{actionType:ka.Af?Fi.a.reply:Fi.a.create}})}Lfb(ka){super.Lfb(ka);this.mK.Sv(Vj.a.iFh,{succeeded:!0,customData:{actionType:Fi.a.edit}})}vUk(ka){if(ka.Af){var db=
this.Wh.csf(ka);if(db.HFc&&db.IFc){var Gb=this.nj.Eb(ia.a.Ff(db.IFc));db=db.IFc===db.HFc?null:this.nj.Eb(ia.a.Ff(db.HFc));fc.a.Tsg(Gb,ka,!0);fc.a.Tsg(db,ka,!1)}}}LKc(ka){super.LKc(ka);this.Sz&&this.Sz.id===ka.id&&(super.clearSelection(),this.yA&&this.oQ.g4b());if(this.yA)if(pg.r(ka)){var db=[];let Gb=null;for(const cc of this.model.$O())cc!==ka&&(cc.Af===ka.Af&&db.push(cc),cc.id===ka.Af&&(Gb=cc));Gb&&Gb.id&&Gb.objectId&&!Gb.done&&this.Co.LG(Gb.objectId)&&!this.Co.A0i(Gb.objectId)&&!db.length&&this.p1c(Gb,
!0)}else db=ka.Xq===ec.a.beingCreated,ka.done||this.p1c(ka,!0),db&&this.Wh.e9i(ka.yz.draftId)}editComment(ka,db){1===this.mode&&ka&&(this.Wh.ULc(ka,db),Fi.a.edit===db.sessionType&&this.mK.logKpiUsage(eh.a.oFh,0),this.Mg.uRb&&3!==Fi.a.nqf(db.sessionType)&&this.VUb.selectComment(ka,Object.assign(new oj.a,{iS:!1,s$:0})))}Qee(ka){this.yA&&!this.$i.xm||super.Qee(ka)}deleteComment(ka){ka.Xq!==ec.a.beingCreated&&this.Co.PPh(ia.a.Ff(ka.objectId));this.dXa&&this.dXa.id===ka.id&&(this.Wh.qt&&this.dXa.id===
this.Wh.qt.id?this.dXa=null:this.qsa.Z6e());!this.Wh.qt||this.Wh.qt.id!==ka.id&&this.Wh.qt.Af!==ka.id?this.Wh.qt&&this.qsa.EF(0,this.Wh.qt,null):void 0===ka.Af||null===ka.Af?this.clearSelection():this.Wh.selectComment(this.Wh.UD(ka.Af));ka.UQa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",pg.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${pg.a(ka)} deleted by user action. DurableId: ${ka.Y0a}`)}HBb(ka,db){super.HBb(ka,db);this.yA&&
!this.$i.xm&&db&&(this.Wh.qt&&this.Wh.qt.id===ka.id&&this.clearSelection(),this.rac&&this.rac.id===ka.id&&this.qsa.Z6e())}Z$n(ka=null){(ka=this.Co.eQl(ka))?this.VUb.selectComment(ka,Object.assign(new oj.a,{iS:!0,s$:1})):this.Jgj(1)}fal(ka){var db,Gb=this.Wra.qc;if(Gb){var cc=ka.Pa.node,xc=null===(db=this.Hlg.instance)||void 0===db?void 0:db.GGb(cc);if(xc)for(const Vc of Gb.pPa(xc))if(Vc&&Vc instanceof Bh.a&&(db=Vc,Gb=Sh.a.ILh(db),this.Xrc.boe=this.Uzl(cc,ka),xc=this.sPk(Gb),null!==xc)){if(ka=this.Xrc.Lzl(Gb,
xc))Gb.exa[xc].appendChild(ka),db.Yy(ka);break}}}Uzl(ka,db){let Gb;for(const cc of ka.dH)if(cc&&cc){Gb=cc;break}ka=db.Pa.Ij;db=!(null===Gb||void 0===Gb||!Gb.Zn)&&0<Gb.Zn.length;return 0>ka||!db||null===Gb||void 0===Gb||!Gb.eop?null:Cf.a.E_(ka,Gb,!1,!1)}sPk(ka){var db;const Gb=null===(db=this.Xrc.boe)||void 0===db?void 0:db.y;for(const [cc,xc]of ka.B4.entries())if(ka=Gb-xc.y,-2<=ka&&ka<xc.height+2)return cc;return null}m5a(){T.App.pjb=2===this.mode||3===this.mode;1!==this.mode&&this.Xrc.EVd()}AMo(ka,
db,Gb){const cc=this.Vb.currentScope;let xc=null;if(db||Gb){db=ka.Pa.cpBegin;ka=ka.Pa.node;if(this.Sz&&pg.q(this.Sz,ka,this.nj,db))return;xc=this.x3l(ka,db)}xc?!this.yA||this.$i.xm?kg.a.E3(y.AFrameworkApplication.oc,()=>{this.Bgj(xc)},nl.a.S$n):this.Bgj(xc):!this.Wh.qt||cc&&cc.name===xd.AFrame.GM||this.clearSelection()}x3l(ka,db){let Gb=null;const cc=this.model.$O();for(let xc=cc.length-1;0<=xc;xc--){const Vc=cc[xc];if(Vc.objectId&&!(Vc.Af||this.yA&&!this.zda.isVisible&&Vc.done)&&pg.q(Vc,ka,this.nj,
db)){Gb=Vc;break}}return Gb}selectComment(ka,db=1){this.VUb.Cgj(ka,Object.assign(new oj.a,{iS:1===db,s$:db}))}Fgj(ka,db){const Gb=this.Wh.UD(ka);Gb?this.yA&&!pg.r(Gb)&&Gb.Xq!==ec.a.beingCreated&&this.oQ.GTa(ka,0,db):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.qt;this.Mg.gva&&this.EE&&ka&&this.EE.fireEvent(9,{comment:ka});super.clearSelection();this.qsa.EF(1,ka,ka);this.yA&&ka&&this.oQ.g4b()}CRm(){var ka;return 500>(null===(ka=this.ngh)||
void 0===ka?void 0:ka.li)}$fc(ka,db=1){if(!this.Mg.XPi||!this.Wh.Px){var Gb=this.Wh.UD(ka),cc=null;Gb||(cc=this.dXa);var xc=this.CRm(),Vc=!1;1===db&&this.ila&&(xc?Vc=!0:this.ila.highlightComment(ka));ka?Gb?xc?Vc=!0:this.vaa.kac(Gb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.vaa.kac(null);Gb?xc?Vc=!0:(this.dXa=Gb,this.qsa.EF(2,Gb,cc)):(this.dXa=null,this.qsa.EF(3,null,cc));Vc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}sAo(){this.he&&
(this.ngh=this.he.Vf("UserAction","StartScrollDetectionStopwatch"))}notify(ka,db){this.Zp.sendNotification(ka,db)}Yng(){this.iGd.onContentChanged()}Rzh(ka,db){var Gb,cc;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Owo(db);case "OnContentFilterUpdate":return!(null===(cc=(Gb=this.iGd).isContentInFilterUpdateDiff)||void 0===cc?0:cc.call(Gb,db.id));default:return!0}}Owo(ka){return this.Mg.U_k?!ka.done&&this.Co.Yha(ka)===this.iGd.isContentInFilteredContent(ka.id):this.Co.Yha(ka)===
this.iGd.isContentInFilteredContent(ka.id)}static getInstance(){return Jc.Wl()}static Wl(){Jc.Ng||(Jc.Ng=new Jc(T.App.Foa(),new V.a(()=>T.App.za.jb.Yc.vd),L.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,L.a.instance.resolve("Common.Comments.ICommentModel"),L.a.instance.resolve("Common.Comments.ICommentPane"),ch.getInstance(),y.AFrameworkApplication.va,new V.a(()=>md.a.instance),um.FocusManager.instance(),L.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),
L.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),L.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),L.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings"),L.a.instance.resolve("Common.Utils.IAriaNotifier"),L.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),L.a.instance.resolve("WordEditor.Comments.CommentsState"),L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
Dk.App.hn.jb.qc,T.App.za.Iq,L.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),L.a.instance.Ta("WordEditor.HeaderFooter.HeaderFooterControlOwner"),L.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),L.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),L.a.instance.Ta("WordEditor.Extension.RichApiEventManager"),L.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")),Jc.Ng.gQb=!0);return Jc.Ng}}Jc.Ng=null;Object(f.a)(Jc,
"EditorCommentManager",Cl.a,[721,722,723,10]);var fh=c(1768);class fj{constructor(ka,db,Gb,cc){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=db;this.confirmButton=Gb;this.cancelButton=cc}}Object(f.a)(fj,"ViewContainerModalDialogStrings",null,[]);c(1490);class If{constructor(ka,db){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=
ka;this.canvasContextId=db}}Object(f.a)(If,"CommentUIAction",null,[]);var ui=c(1064);class gk{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg,Kh,Vg,Gk,wl){this.ga=ka;this.gg=db;this.ee=Gb;this.Vb=cc;this.hp=xc;this.Lh=Vc;this.w3=Wd;this.psa=re;this.qzd=od;this.JWe=Be;this.Ib=ve;this.oQ=Wf;this.Mg=lg;this.$i=Kh;this.VUb=Vg;this.u2=Gk;this.fla=wl;this.Ive=this.Zi=null;this.zeh=this.BJg=!1;this.XAc=null;this.muo=(el,Ki,xj)=>2!==xj||this.$i.yY?1===xj?32:2:(this.u2.i$("OnCommentInit",Object.assign(new ok.a,
{VGa:()=>{this.ga.processAction(ph.a.AV,2)}})),32);this.Opi=(el,Ki,xj)=>1!==xj||this.$i.yY?2:8;this.Ook=(el,Ki,xj)=>{if(1===xj)return!this.tkb()||this.neb?8:this.$i.yY?2:32;if(!this.$i.yY)return this.neb=!0,this.u2.i$("OnCommentInit",Object.assign(new ok.a,{VGa:()=>{this.Yq||this.$i.xm||this.ga.processAction(ph.a.AV,2)}})),32;this.Yq||this.$i.xm||this.ga.processAction(ph.a.AV,2);(this.Yq||this.$i.xm)&&this.Vb.kg(this.$i.xm?xd.AFrame.Qr:xd.AFrame.GM);return 2};this.Vhl=(el,Ki,xj)=>1===xj&&xg.SessionStatusManager.instance.Uj?
8:2;this.zml=(el,Ki,xj,Hk)=>1!==Hk||(this.Yq||this.isVisible)&&this.Zi.model.qt?el||this.Zi.model.qt?32:8:8;this.zjb=(el,Ki,xj,Hk,Zh)=>{if(1===xj||!this.$i.xm)return 32;if(!this.Yq&&2===xj&&(2===this.Zi.mode||3===this.Zi.mode))return Zh=new fj(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.qzd.invokeModalConfirmationDialog(()=>{this.mkn(el,Ki,xj,Hk)},()=>{this.rjn()},Zh),32;this.GVd();
if(this.Yq)return 32;Zh&&this.LUh();return 32};this.XNb=(el,Ki,xj,Hk,Zh)=>{if(1===xj)return 32;Zh[Gj.a.On]=this.isVisible;return 32};this.Vpc=this.$6k()}get isVisible(){return this.$i.xm}get neb(){return this.BJg}set neb(ka){this.BJg=ka}get ooo(){return"SharedCommentsTaskPaneProps"}get v2c(){return null}get tPi(){return null}get eF(){return this.hp}get zda(){return null}get R_k(){return this.psa}get Yq(){try{return this.Mg.Yq}catch(ka){return!1}}Dai(){return new zi(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}$6k(){const ka=new Fj.a,db=new If(ph.a.SGa,th.a.frame);db.preCallback=this.Ook;const Gb=new If(Vj.a.gSf,th.a.frame),cc=new If(Vj.a.f1f,th.a.frame),xc=new If(Vj.a.deleteComment,th.a.frame);xc.preCallback=this.Vhl;xc.postCallback=this.zml;this.Yq&&(Gb.preCallback=this.Opi,cc.preCallback=this.Opi);const Vc=new If(ph.a.AV,th.a.frame);Vc.preCallback=this.muo;ka.Z(6,Vc);ka.Z(0,db);ka.Z(1,Gb);ka.Z(2,cc);ka.Z(3,xc);return ka}knj(ka){this.zeh||
(this.dkk=this.cTd(),this.w3.tOa(),this.yno(),this.uno(ka),this.zeh=!0)}uno(ka){this.Zi=ka;this.Ive=ka.lac;this.Zi.TWh=this.psa}initialize(ka){this.knj(ka);this.Tb()}qAf(){this.XAc&&this.Vb.kg(xd.AFrame.Qr);this.neb&&!this.Yq?(this.ga.processAction(ph.a.SGa,2),this.neb=!1):this.$i.Jfb&&kg.a.E3(y.AFrameworkApplication.oc,()=>{const ka=this.$i.Jfb.commentId,db=this.$i.Jfb.lXc;this.ga.Rb(Vj.a.selectComment,2,Object.assign(new oj.a,{commentId:ka,s$:1,iS:!0,uVc:db}));db&&(kg.a.E3(y.AFrameworkApplication.oc,
()=>{this.Vb.kg(xd.AFrame.Qr)},nl.a.ccg),Ah.a.instance.lf(Mq.a.tOh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.kX);this.$i.Jfb=null},nl.a.R$n)}dispose(){}K5(){}selectComment(){this.isVisible||this.Yq||this.Iqj();this.Lh.updateCommandUI(!0)}Tb(){this.ga.ra(ph.a.zjb,th.a.frame,this.zjb);this.ga.fb(ph.a.XNb,th.a.frame,this.XNb,96)}m5a(){-1!==this.Zi.mode&&(this.Zi.mode||this.LUh())}LUh(){const ka=
this.Zi,db=ka.Co,Gb=db.jSd(),cc=db.Pnf(this.Mg.KQb&&this.Mg.Yq&&!this.$i.xm);this.psa.Yao(cc.length,Gb,!ka.mode,Gb?5:1);this.psa.xbo(cc,db.aWa)}yno(){const ka=this.Vb.ae(xd.AFrame.Qr);ka.parent=xd.AFrame.xp;ka.$H=!0;ka.R6c=!0;ka.hVa=!0;ka.UZa((db,Gb)=>{De.a.Qzh(Gb.name)&&(this.$i.PLb=kg.a.E3(this.Ib,()=>{Gb.name!==xd.AFrame.GM&&2!==this.Zi.mode&&3!==this.Zi.mode&&(this.Zi.clearSelection(),this.Lh.updateCommandUI(!0));this.$i.PLb=null},nl.a.bkn))});this.hp.wT(xd.AFrame.Qr);if(this.Mg.TAb)for(const db of pg.t)ka.bindAction(Pc.KeyInputManager.IG(db),
Vj.a.K4e)}ago(){this.XAc&&this.JWe.zFl()}MBh(){this.A1j&&this.ago()}mkn(ka,db,Gb,cc){const xc=this.Zi,Vc=xc.Co.Px;Vc&&Vc.yz?xc.d8e.endCommentSession(Vc.yz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.zjb(ka,db,Gb,cc,!0);kg.a.E3(this.Ib,()=>{this.Lh.updateCommandUI(!0)},nl.a.O6n)}rjn(){this.XAc&&this.Vb.kg(xd.AFrame.Qr);this.Lh.updateCommandUI(!0)}LHa(ka){ka.kr(this.Vb.LW);ka.kr(this.Vb.MW)}BQb(ka,db,Gb){if(1===Gb)return 32;this.Iqj();return 32}Iqj(){this.isVisible||
(this.Mg.ehb&&(this.$i.vIa=!0),this.$i.yY?(this.ynl(),this.$i.xm=!0,this.u2.Hbe(),this.Vb.PEc(xd.AFrame.Qr),this.Yq&&this.Mg.KQb&&this.Zi.nOb(this.Zi.model.snf(()=>!0)),this.A1j=!0,ti.UISurfaces.Mu().then(ka=>{ka.showTaskPane(Wj.a.sGd,this.dkk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Zi.$fc(null),this.Lh.updateCommandUI(!0),this.LHa(this.Vb.ae(xd.AFrame.Qr)),this.u2.i$("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):
this.u2.i$("OnCommentInit",Object.assign(new ok.a,{VGa:()=>{this.$i.xm||this.ga.processAction(ph.a.AV,2)}})))}ynl(){this.ga.Rb(Vj.a.d4,2,null);this.ga.Rb(Vj.a.ZT,2,null)}tkb(){return this.fla.tkb(this.ga,!1)}kAb(){}show(){this.isVisible||this.ga.processAction(ph.a.AV,2)}editComment(){return 2}GVd(){this.Zi.paneClosing();this.$i.xm=!1;if(this.Yq&&this.Mg.KQb){const db=this.Zi.model;this.Zi.nOb(db.snf(Gb=>db.Yha(Gb)))}var ka=um.FocusManager.instance();ka.currentScope&&ka.currentScope.name===xd.AFrame.Qr&&
ka.kg(this.Yq&&(2===this.Zi.mode||3===this.Zi.mode||this.Zi.Gj.qt)?xd.AFrame.GM:ka.XT);this.hp.$w(xd.AFrame.Qr);this.Vb.yKc(xd.AFrame.Qr);ti.UISurfaces.Mu().then(db=>{db.hideTaskPane(Wj.a.sGd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Yq&&(ka=this.Zi.model.qt)&&this.xSo(ka);this.u2.i$("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}xSo(ka){ka.done?this.Zi.clearSelection():this.VUb.NUh(ka)}usn(ka=null){this.JWe.Emj(3);
this.qAf();if(ka){this.MBh();Xk.a.F5f(ka,[Oi.a.contextMenu]);const db=this.Vb.ae(xd.AFrame.Qr);this.gg.L1b(xd.AFrame.Qr,ka,db.hVa)}}bqn(ka){this.hp.QI(xd.AFrame.Qr);1!==ka&&kg.a.E3(y.AFrameworkApplication.oc,()=>{this.Vb.iD(xd.AFrame.Qr)},nl.a.ccg)}onTaskPaneClose(){this.$i.yY&&this.JWe.Emj(1)}cTd(){const ka={type:this.ooo,Lgp:this.MBh};return Object.assign(new ui.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:db=>{this.XAc=db;this.usn(db);
this.oQ.vlg(!0)},onClose:()=>{this.XAc=null;this.ga.Rb(ph.a.zjb,2,!0);this.Lh.updateCommandUI(!0);this.onTaskPaneClose();const db=this.Zi.Co;this.$i.vIa&&db.hSc()&&this.oQ.vlg(!1)},onShow:db=>{this.bqn(db)}})}AV(){return 32}}Object(f.a)(gk,"OfficeSharedCommentPane",null,[10,714,715]);var le=c(1680),xe=c(177);class ci{constructor(ka,db){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=db}openView(){this.ga.processAction(ph.a.BQb,2)}closeView(){this.ga.Rb(ph.a.zjb,2,!0)}invokeModalConfirmationDialog(ka,
db,Gb){const cc=new xe.StandardDialog;Gb&&Gb.title&&Gb.body&&Gb.confirmButton&&Gb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),Gb=new fj("","","",""));cc.Cd=1;cc.xe(1,Gb.confirmButton);cc.xe(0,Gb.cancelButton);cc.pv(Gb.title,Gb.body,1,xc=>{1===xc?ka():db()})}}Object(f.a)(ci,"ViewContainerAPI",null,[712,713]);class Ch{constructor(ka,db,Gb){this.QJo=ka;this.yh=db;this.aJa=Gb;this.hd=new ha.a;this.QJo.execute(cc=>{this.aJa.qce("OnBeforeTrackChangeMarkupViewChange",
(xc,Vc)=>{Vc&&Vc.WRf!==cc.Jj&&this.hd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Vc)});this.aJa.qce("OnAfterTrackChangeMarkupViewChangeEventKey",(xc,Vc)=>{Vc&&Vc.Jj===cc.Jj&&(qb.a.Jj=cc.Jj,this.hd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Vc))})})}k$(ka,db){this.hd.addHandler(ka,db)}i$(ka,db){this.hd.raiseEvent(ka,db)}Hbe(){this.yh.i4f||(this.yh.i4f=!0,this.hd.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(Ch,"WordCommentEventsActor",null,[]);var Re=c(1827);class Oh{constructor(){this.insertIndex=
0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(Oh,"InitCommentSessionResult",null,[]);class kf extends Oh{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(f.a)(kf,"BeginDraftingHostResult",Oh,[]);var Xe=c(2095),xh=c(2049),no=c(1050);class kl{constructor(ka,db,Gb,cc,xc,Vc,Wd,re,od,Be,ve,Wf,lg,Kh,Vg){this.taskManager=ka;this.psa=db;this.XSj=Gb;this.$Ko=cc;this.l8e=xc;this.Rr=Vc;this.yt=Wd;this.focusManager=re;
this.A1=od;this.nc=Be;this.Ck=ve;this.O_=Wf;this.yh=lg;this.u0k=Kh;this.s0k=Vg;this.tZb=this.m7=this.Jm=null;this.MXj="WordWebCommitNewCommentActivity";this.NXj="WordWebCommitTaskActivity";this.JXj="WordWebCommentReactionActivity";this.gOg=null}get fla(){return this.m7}ZDn(ka){var db;const Gb=this.fla.Px,cc=this.m7.$O();if(cc&&Gb){const xc=no.a.yhb(null!==(db=Gb.authorId)&&void 0!==db?db:"");db=new Re.a(Gb.authorId,Gb.W2b,Gb.author,null!==xc&&void 0!==xc?xc:"",!0);ka.author=db;ka.insertIndex=Array.indexOf(cc,
Gb);ka.authorName=Gb.author;ka.authorIdentity="";return null}return kg.a.MD(-2130915320)}initialize(ka,db,Gb,cc){this.Jm=ka;this.m7=db;this.tZb=Gb;this.gOg=cc}beginDraftingAsync(ka){if(!ka)return new Promise((cc,xc)=>{xc(kg.a.MD(-2130915327))});const db=new kf,Gb=Fi.a.nqf(ka.sessionType);return void 0===Gb||null===Gb?new Promise((cc,xc)=>{xc(kg.a.MD(-2130915317))}):new Promise((cc,xc)=>{kg.a.E3(this.taskManager,()=>{if(1!==this.Jm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.Jm.mode),xc(kg.a.MD(-2130915325));else{this.jBh();try{switch(Gb){case 0:if(!this.Jm.zda.tkb()){xc(kg.a.MD(-2130915326));return}this.u0k.EVd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.Jm.kAb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){xc(kg.a.MD(-2130915324));return}if(this.Rr.Ngg){const re=this.m7.UD(ka.threadId);if(re){const od=this.m7.N5h(re,!1),Be=Xe.a.nFb(re,od,re.authorId===this.Rr.TY);Be&&this.l8e.invoke(ka.threadId,Be)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.Jm.mode)}this.Jm.addReply(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){xc(kg.a.MD(-2130915324));return}var Vc=this.m7.UD(ka.threadId);if(!Vc){xc(kg.a.MD(-2130915323));return}this.Jm.editComment(Vc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){xc(kg.a.MD(-2130915324));return}const Wd=this.m7.UD(ka.commentId);if(!Wd){xc(kg.a.MD(-2130915323));return}this.Jm.editComment(Wd,ka)}}catch(Wd){xc(Wd);this.ocj();
a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Wd} on Session ${Gb}`);return}(Vc=this.ZDn(db))?xc(Vc):cc(db);this.ocj()}},nl.a.beginDraftingAsync)})}commit(ka,db,Gb){const cc=this.fla.Px;if(!cc)throw kg.a.MD(-2130915320);var xc=cc.yz;if(!xc)throw kg.a.MD(-2130915320);const Vc=Fi.a.nqf(xc.sessionType);if(void 0===Vc||null===Vc)throw kg.a.MD(-2130915317);if(ka!==xc.draftId)throw kg.a.MD(-2130915327);let Wd=!1,re=!1;xc=!1;switch(Vc){case 3:if(!Gb)throw kg.a.MD(-2130915327);break;case 0:this.Ck.ge(()=>
{if(!this.Jm.zda.tkb())throw kg.a.MD(-2130915326);cc.text=[db];this.Jm.yA&&!this.yh.xm?this.Jm.Azn(()=>{this.Jm.hva(cc);this.Jm.Ksl(ka,cc.id)}):this.Jm.hva(cc);re=Gb&&null!=Gb.Task;Wd=this.Jm.yA;kg.a.E3(this.taskManager,()=>{this.bpb(cc.id)},nl.a.bpb)},"WESCA:C:C");break;case 1:this.Ck.ge(()=>{cc.text=[db];this.Jm.hva(cc);re=Gb&&null!=Gb.Task;Wd=this.Jm.yA},"WESCA:C:R");break;case 2:this.Ck.ge(()=>{cc.text=[db];this.Jm.Lfb(cc);this.N2i(Vj.a.W1m)},"WESCA:C:E");break;default:throw kg.a.MD(-2130915322);
}Gb&&(Gb.Resolve&&(this.ajj(cc,Gb.Resolve.isResolved),Gb.Resolve.isResolved&&!this.yh.xm&&this.Jm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),Gb.Task&&this.Jm.U0k(cc,Gb.Task),Gb.Reaction&&(xc=this.Rr.B0k,Gb.Reaction.isActive?this.Jm.xAd(cc,Gb.Reaction.reactionType):this.Jm.Cce(cc,Gb.Reaction.reactionType)));this.Rr.M0k&&re&&this.A1.execute(od=>od.logActivity(this.NXj,"CommentsTasksFpsIsEnabled"));Wd&&this.A1.execute(od=>{od.logActivity(this.MXj,"CommentsFpsIsEnabled")});xc&&this.A1.execute(od=>
{od.logActivity(this.JXj,"CommentReactionsFpsIsEnabled")});return cc.id}endCommentSession(ka){const db=this.fla.Px;if(db){if(db.yz&&db.yz.draftId!==ka)throw kg.a.MD(-2130915327);if(db.Xq===ec.a.beingCreated)this.Jm.deleteComment(db),!this.Jm.yA||db.Af||this.yh.xm||this.focusManager.kg(xd.AFrame.Un);else{if(3!==this.Jm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}db.Xq=ec.a.normal;db.DTa=xh.a.succeeded;db.yz=null;this.Jm.G5e()}}this.yt&&
this.yt.updateCommandUI(!0);this.fla.jSd()||this.psa.vog(1,!this.Jm.mode)}deleteComment(ka){(ka=this.m7.UD(ka))?(this.Jm.deleteComment(ka),this.Jm.yA&&!this.yh.xm?ka.Af||this.focusManager.kg(xd.AFrame.Un):this.focusManager.iD(xd.AFrame.Qr),this.$Ko.$eg(ka)&&this.N2i(Vj.a.OIi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.bpb(ka,0)}highlightComment(ka){this.Jm.$fc(ka,0)}setThreadResolvedState(ka,db){(ka=this.m7.UD(ka))&&this.ajj(ka,db)}ajj(ka,
db){if(ka.Af&&""!==ka.Af)throw kg.a.MD(-2130915321);this.Jm.HBb(ka,db);db&&!this.yh.xm&&this.focusManager.kg(xd.AFrame.Un)}presentLinkToComment(ka){var db=this.m7.UD(ka);db?(db=this.fla.tQd(db))?(ka={["nav"]:btoa(`{"${Hj.a.comment}":${db}}`),["mode"]:"copy"},this.s0k.Sv(Vj.a.presentLinkToComment),this.nc.Rb(ph.a.K8,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",
ka)}selectFirstThreadInNextCommentContext(){this.Jm.Jgj(0)}selectLastThreadInPreviousCommentContext(){this.Jm.$$n()}registerForCommentEvents(ka){const db=this.fla.Pnf(this.Rr.KQb&&this.Rr.Yq&&!this.yh.xm),Gb=this.fla.aWa,cc=this.fla.jSd(),xc=!this.Jm.mode;this.psa.oko();this.gOg.N2l().then(Vc=>{this.psa.gUn(ka,db,cc,xc,Gb,Vc);this.psa.vog(cc?5:1,xc);this.yt&&this.yt.updateCommandUI(!0)})}unregisterForCommentEvents(ka){this.psa.eSb(ka)}registerForAction(ka,db){this.XSj.bTa(ka,db)}unregisterForAction(){}checkAtMentionCapability(){return this.tZb?
this.tZb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}jBh(){const ka=this.Jm.yA&&!this.yh.xm?xd.AFrame.GM:xd.AFrame.Qr;if(ka===xd.AFrame.Qr){if(!this.yh.xm)return;ti.UISurfaces.Mu().then(db=>{db.setSelectedTaskPane(Wj.a.sGd);return null})}this.focusManager.iD(ka)}bpb(ka,db=
1){this.jBh();this.O_.Cgj(ka,Object.assign(new oj.a,{s$:db,iS:1===db}))}ocj(){this.Jm.zda.neb&&(this.Jm.zda.neb=!1)}N2i(ka){this.nc.processAction(ka,2)}}Object(f.a)(kl,"WordEditorSharedCommentAPI",null,[710,711]);class gh{constructor(ka,db,Gb,cc,xc,Vc,Wd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=db;this.commentBody=Gb;this.author=cc;this.date=xc;this.commentFlags=Vc;this.usersByReactionType=
Wd}}Object(f.a)(gh,"OfficeSharedCommentModel",null,[]);c(1663);class gm{constructor(ka,db){this.Ga=ka;this.lKb=db;this.mmh="AD";this.Wrc=new N.a;this.uWe=new N.a;this.JGk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.dOg=new Qh.a}get userPrincipalName(){return this.Ga.kb("UserPrincipalName")}get i6a(){return this.Ga.kb("PresenceProvider")}get TY(){return this.Ga.kb("PresenceUserId")}get nj(){return this.lKb.value}jQi(ka){const db=this.JGk.exec(ka);return db?db[1]:ka}Mfi(ka,db=!1){let Gb=0;ka.done&&(Gb=ka.Af&&
""!==ka.Af?Gb|4:Gb|8);ka.yHh&&(Gb|=2);db&&(Gb|=1);this.$eg(ka)&&(Gb|=16);ka.dFf&&(Gb|=32);this.Gqm(ka)||(Gb|=128);return Gb}Gqm(ka){return ka?(ka=this.nj.Eb(ka.objectId))?ka.hasProperty(sa.a.RQ):!1:!1}$eg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.iMf(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.TY||null===this.TY||""===this.TY)return this.iMf(ka.id,ka.objectId,"PresenceUserId null or empty"),!1;if(this.TY==ka.authorId&&
ka.W2b==this.i6a)return!1;const db=this.RMd(ka.authorId),Gb=this.RMd(this.TY);if(this.i6a===this.mmh&&db&&Gb&&db[0]!=this.userPrincipalName&&db[1]!=Gb[1])return!0;this.iMf(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.TY||null===this.TY||""===this.TY)return!1;if(this.TY==ka.authorId&&ka.W2b==this.i6a)return!0;ka=this.RMd(ka.authorId);const db=this.RMd(this.TY);return this.i6a===this.mmh&&ka&&db?ka[0]==this.userPrincipalName||
ka[1]==db[1]:!1}RMd(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}iMf(ka,db,Gb){ka&&!this.dOg.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${db}; reason: ${Gb}`),this.dOg.add(ka))}M1h(ka,db){var Gb;if(!ka)return null;const cc=ka.O_d;let xc=!1;1===db&&(xc=!0);db=ka.author?this.jQi(ka.author):"";const Vc=no.a.yhb(null!==(Gb=ka.authorId)&&void 0!==Gb?Gb:"");Gb=new Re.a(ka.authorId?ka.authorId:"",ka.W2b,
db,null!==Vc&&void 0!==Vc?Vc:"",this.isCurrentUser(ka));return new gh(ka.id?ka.id:"",ka.Af?ka.Af:"",ka.text&&ka.text.length?ka.text[0]:null,Gb,ka.date||cc?ka.date:new Date,this.Mfi(ka,xc),this.Ofi(ka.usersByReactionType))}THl(ka,db,Gb){const cc=[],xc=new N.a;if(!ka)return cc;for(const Vc of ka)Vc.Xq!==ec.a.beingCreated&&Gb(Vc)&&(Vc.id&&this.Wrc.nb(Vc.id)?(ka=this.Wrc.J(Vc.id),ka=this.yal(Vc,ka,db),cc.push(ka),xc.Z(Vc.id,ka)):Vc.id?(ka=this.M1h(Vc,db),cc.push(ka),xc.Z(Vc.id,ka)):a.ULS.sendTraceTag(50667679,
327,10,"CommentId should not be null"));this.Wrc=xc;return cc}hOl(ka,db,Gb){const cc=[];for(const xc of ka)xc.Xq!==ec.a.beingCreated&&Gb(xc)&&(xc.id&&this.Wrc.nb(xc.id)?cc.push(this.Wrc.J(xc.id)):xc.id&&cc.push(this.M1h(xc,db)));return cc}yal(ka,db,Gb){var cc=ka.O_d,xc=1===Gb;Gb=ka.Af?ka.Af:"";const Vc=ka.text&&ka.text.length?ka.text[0]:null,Wd=ka.author?this.jQi(ka.author):"",re=ka.authorId?ka.authorId:"",od=ka.W2b?ka.W2b:"",Be=no.a.yhb(re);cc=ka.date||cc?ka.date:new Date;xc=this.Mfi(ka,xc);const ve=
this.isCurrentUser(ka),Wf=this.Ofi(ka.usersByReactionType);return db.parentId===Gb&&db.commentBody===Vc&&db.author.DisplayName===Wd&&db.author.UserId===re&&db.author.Provider===od&&db.author.IsCurrentUser===ve&&db.date===cc&&db.commentFlags===xc&&this.lFk(db.usersByReactionType,Wf)?db:(db=new Re.a(re,od,Wd,null!==Be&&void 0!==Be?Be:"",ve),new gh(ka.id,Gb,Vc,db,cc,xc,Wf))}lFk(ka,db){if(!ka&&!db)return!0;if(!db||!ka)return!1;var Gb=Object.keys(ka);if(Gb.length!==Object.keys(db).length)return!1;for(const cc of Gb){if(!(cc in
db))return!1;Gb=ka[cc];const xc=db[cc];if(Gb.length!==xc.length)return!1;for(let Vc=0;Vc<Gb.length;Vc++)if(!this.$Ek(Gb[Vc],xc[Vc]))return!1}return!0}$Ek(ka,db){return ka||db?ka&&db&&ka.UserId===db.UserId&&ka.Provider===db.Provider&&ka.Email===db.Email&&ka.DisplayName===db.DisplayName&&ka.IsCurrentUser===db.IsCurrentUser?!0:!1:!0}Ofi(ka){if(!ka)return null;const db={},Gb=this.Ga.kb("PresenceUserId");for(const xc of Object.keys(ka)){const Vc=[];var cc=ka[xc];for(const Wd of cc){cc=Wd.UserId===Gb;let re;
this.uWe.nb(Wd.UserId)?(re=this.uWe.J(Wd.UserId),re.IsCurrentUser=cc):(re=new Re.a(Wd.UserId,Wd.Provider,Wd.DisplayName,Wd.Email,cc),this.uWe.add(Wd.UserId,re));Vc.push(re)}db[xc]=Vc}return db}}Object(f.a)(gm,"WordEditorSharedCommentModelTranslator",null,[634]);class ug{constructor(){this.Fp=null;this.cgd=this.cah=this.FKg=this.mhh=this.gkh=this.K6g=this.dch=!1}Nfi(){this.Fp||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Klj());
return this.Fp}N2l(){return new Promise((ka,db)=>{this.cgd?ka(this.dbi()):this.Aij().then(()=>{ka(this.dbi())}).catch(Gb=>{db(Gb)})})}dbi(){this.cgd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.FKg&&(ka|=2);this.dch&&(ka|=8);this.gkh&&(ka|=16);this.K6g&&(ka|=4);this.mhh&&(ka|=64);this.cah&&(ka|=128);return ka}}Object(f.a)(ug,"OfficeSharedCommentsAppCapabilities",null,
[877]);class sc extends ug{constructor(ka){super();this.lYa=null;this.Mg=ka;this.Alo();this.Klj()}Alo(){this.mhh=this.Mg.uRb;this.gkh=!1;this.cah=this.K6g=this.dch=!0}initialize(ka){this.lYa=ka;this.Aij()}Klj(){this.Fp={};this.Fp.LivePersonaPicker="true";this.Fp.PersonaColor="true";this.Fp.DiscreteHostedComments=this.Mg.$ml.toString();this.Fp.NewCommentButton="true";this.Fp.DisabledChangeGates=this.Mg.Rml;this.Fp.CommentsFluentUI="true";this.Fp.CommentTasks=this.Mg.uRb.toString();this.Fp.CommentTasksFromReply=
this.Fp.CommentTasks;this.Fp.CommentFriendlyTimestamps=this.Mg.V_k.toString();this.Fp.AtMentionFloodgateSurvey=this.Mg.gGk.toString();this.Fp.HyperlinksInComments="true";this.Fp.LogDraftCommentIdPair="true";this.Fp.RichTextFormattingInWeb=this.Mg.TAb.toString();this.Fp.RichContentEditIntegration="true";this.Fp.HyperlinksWithDisplayText="true";this.Fp.SmartReplies=this.Mg.Ngg.toString();this.Fp.LinkToComment="true";this.Fp.TaskPaneWithNewInfrastructure="true";this.Fp.CommentReactions="true";this.Fp.WebThemeIntegration=
"true";this.Fp.NewSelectionInteractions="true";this.Fp.HighlightsAndFontColorInWebComments="true";this.Fp.TruncationUIWithReadMoreText="true";this.Fp.CtrlEnterTip="true";this.Fp.AtMentionHintMessage="true";this.Fp.LivePersonaCardForWeb=this.Mg.z_m.toString();this.Fp.TaskHistoryRecordIDs=this.Mg.CFo.toString();this.Fp.ContentNavigation=this.Mg.contentNavigationApiEnabled.toString()}Aij(){return new Promise((ka,db)=>{this.lYa?this.lYa.atMentionsEnabledAsync().then(Gb=>{this.FKg=Gb;this.cgd=!0;ka(this.cgd)}):
(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),db(kg.a.MD(-2130915320)))})}}Object(f.a)(sc,"WordSharedCommentsAppCapabilities",ug,[633]);class oo{constructor(){this._initialized=!1;this.L0k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:eh.a.Yif,vetoPillar:7};this.JFo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:le.a.Yif,vetoPillar:7}}get S5a(){return null!=
this.GDg?this.GDg:this.GDg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}s_(ka){this.S5a.s_(ej.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}wc(ka){this.W=ka;this.s_("CPConfigStart");ka.ia("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Kg.a(m.Health.instance,new Jd.a,this.L0k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();ka.ia("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new Kg.a(m.Health.instance,new Jd.a,this.JFo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();
ka.ia("WordEditor.Comments.CommentNodeTracker",()=>new we(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();ka.ia("WordEditor.Comments.CommentsSettings",()=>new tj(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new V.a(()=>T.App.za.jb.Yc),new V.a(()=>tg.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();
ka.ia("WordEditor.Comments.CommentsState",()=>new qb.a).ha();ka.ia("WordEditor.Comments.WordCommentEventsActor",()=>new Ch(ka.Ta("Box4.TrackChange.ITrackChangeManager"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();ka.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new gm(y.AFrameworkApplication.K,new V.a(()=>T.App.za.jb.Yc.vd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();ka.ia("WordEditor.Comments.CommentDeltaFormatTranslator",
()=>new eb(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();ka.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new xn(y.AFrameworkApplication.oc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();ka.ia("WordEditor.Comments.CommentActionInTypingRecorder",()=>new vl(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();
ka.ia("WordEditor.Comments.EditorCommentModel",fh.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();ka.ia("WordEditor.Comments.ICommentModelBootLoader",()=>new Fl(new V.a(()=>T.App.za.jb.Yc),new V.a(()=>tg.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ia("WordEditor.Comments.ICommentFilterActor",()=>new Hc(ka.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).ha();ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ia("WordEditor.Comments.CommentHighlightOnRestActor",()=>new li(new V.a(()=>T.App.za.jb.Yc),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),
ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").zl,P.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();ka.ia("WordEditor.Comments.CommentHighlightUtils",()=>new jf(ka.resolve("Box4.Highlight.IHighlightManager"))).ha();ka.ia("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new ed(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();
ka.ia("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new Rl(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ua.M1,y.AFrameworkApplication.ua.VIa,y.AFrameworkApplication.va,y.AFrameworkApplication.oc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Ta("WordEditor.Comments.IEditorCommentManager"))).ha();ka.ia("WordEditor.Comments.CommentHighlightActor",()=>new kc(new V.a(()=>T.App.za.jb.Yc.vd),
ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.Ta("WordEditor.Comments.IEditorCommentManager"),P.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();ka.ia("WordEditor.Comments.CommentHintActor",
()=>new Aa(ka.resolve("WordEditor.Comments.CommentsSettings"),ah.a.instance,Tn.a.instance,Jj.a.instance,y.AFrameworkApplication.va,cd.TableCellReader.mNm,mg.moveToLastRenderedCellOfTheRow,new dg.a,ka.Ta("Box4.ContentControlConfigSettings"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();
ka.ia("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Dd(ah.a.instance,Jj.a.instance,y.AFrameworkApplication.va,ka.resolve("WordEditor.Comments.ICommentHintActor"),ka.Ta("Common.IZoomManager"),ka.resolve("WordEditor.Comments.CommentsSettings"))).ha();ka.ia("WordEditor.Comments.ViewContainerAPI",()=>new ci(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();ka.ia("Common.Comments.CommentActivationManager",()=>new Yi).as("Common.Comments.ICommentActivationManager").ha();
ka.ia("Common.Comments.ViewContainerEventHost",()=>new Lm(y.AFrameworkApplication.oc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();ka.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new wm(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();
ka.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new sc(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();this.s_("CPConfigEnd")}init(){this.s_("CPInitStart");this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{try{this.sn(),this.s_("CPInitEnd")}catch(ka){throw a.ULS.VA(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.S5a.Ex(ej.a.comments,
"CPInitException",ka,!0),ka;}})}sn(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.s_("onAfterGFNLoadedStart");this.W.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new gk(y.AFrameworkApplication.va,y.AFrameworkApplication.ua.lD,y.AFrameworkApplication.ua.mD,y.AFrameworkApplication.ua.Dp,y.AFrameworkApplication.ua.ux,T.App.za,vm.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
y.AFrameworkApplication.oc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.W.ia("Common.Comments.OfficeSharedCommentsActionHost",()=>new jl(y.AFrameworkApplication.va,
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").Vpc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.W.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new kl(y.AFrameworkApplication.oc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),ka,T.App.za,
y.AFrameworkApplication.ua.Dp,this.W.Ta("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,P.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();Cl.a.factory=Jc.getInstance;this.W.ia("WordEditor.Comments.EditorCommentManager",
Jc.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.W.ia("WordEditor.Comments.CommentFloatingContainerActor",()=>new nc(this.W.resolve("WordEditor.Comments.CommentsState"),ka,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.oc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${Rm.AppFrame.qVa} .${ce.a.$5b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ua.Dp)).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const db=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),Gb=db.trackChangeInSidetrackEnabled;Gb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").M7i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ia("WordEditor.Comments.FloatingCommentManager",
()=>new cf(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.oc,P.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),db)).ha();this.W.ia("WordEditor.Comments.IFloatingCommentManager",()=>Gb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):
this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();this.W.ia("WordEditor.Comments.CommentSelectionActor",()=>new To(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),ch.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),y.AFrameworkApplication.ua.Dp,this.W.resolve("WordEditor.Comments.CommentsState"),
ka,new V.a(()=>md.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Ta("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.W.ia("WordEditor.Comments.CommentInitActor",()=>new vd(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),
this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ch.getInstance(),T.App.za.Iq,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").aA,this.W.Ta("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ua.Dp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Ta("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Ta("Common.App.SafeLinks.ISafeLinksManager"),this.W.Ta("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),
this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),db,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.W.ia("WordEditor.Comments.CommentsActionManager",()=>new Ob(this.W.resolve("WordEditor.Comments.EditorCommentManager"),
this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new V.a(()=>T.App.za.jb.Yc.vd),y.AFrameworkApplication.va,new V.a(()=>md.a.instance),um.FocusManager.instance(),
P.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").ha();this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ia("WordEditor.Comments.CommentContentProvider",()=>new tf(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.W.ia("WordEditor.Comments.CommentContentActor",()=>new bo(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).ha(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const cc=ka.Yq,xc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");xc&&cc&&
(this.W.resolve("WordEditor.Comments.CommentsState").jeb=oo.s4h(),ka.oDb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").i$("OnCommentInit"));fc.a.k4m();ka.Q$b&&T.App.za.jb.GVh();Cl.a.instance&&(ka.oDb||Qm.a.get_instance().lk(4,()=>{this.ckn(cc)},11).continueWith(()=>{this.lym()}),this._initialized=!0);this.lSn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}lym(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").i$("OnCommentInit")}ckn(ka){ka||
this.dkm()}dkm(){const ka=oo.s4h();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.kX),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").i$("OnCommentInit",Object.assign(new ok.a,{VGa:()=>{Cl.a.instance.zda.isVisible||y.AFrameworkApplication.va.processAction(ph.a.AV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").zgj(ka,Object.assign(new oj.a,{dfg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Sv(ph.a.g8e))}lSn(ka,
db,Gb){ka&&ka.execute(cc=>{cc.t5(new Kb.a(db,Gb))})}dispose(){this._initialized&&(Cl.a.instance&&Cl.a.instance.dispose(),this._initialized=!1)}static s4h(){return y.AFrameworkApplication.K.kb("BootActivityNavigationId")}}Object(f.a)(oo,"PackageManager",null,[1,2]);const Un=ka=>{const db=L.a.instance.Ta("Box4.IPackageBootPerfLogger"),Gb=window.performance.now();db.execute(cc=>{cc.Ex(ej.a.comments,"CPMain",Gb,!0)});z.a.instance.Gc(new oo,0,ka)};var jk=c(1974);class Go{isComment(ka){return Te.a.isComment(ka)}wYd(ka){return Te.a.wYd(ka)}wCf(ka){return Te.a.wCf(ka)}EUf(ka,
db){Te.a.EUf(ka,db)}IUf(ka,db){Te.a.IUf(ka,db)}maf(ka){return Te.a.maf(ka)}o5a(ka){return tg.a.instance.o5a(ka)}deleteComment(ka,db){Te.a.deleteComment(ka,db)}KJd(ka,db){Te.a.KJd(ka,db)}Bob(ka){Te.a.Bob(ka)}jca(ka,db,Gb){return Te.a.jca(ka,db,Gb)}rwa(ka,db,Gb){return Te.a.rwa(ka,db,Gb)}o$b(ka,db){return Te.a.o$b(ka,db)}ePc(ka,db,Gb,cc=null){return Te.a.ePc(ka,db,Gb,cc)}J1b(ka,db,Gb,cc){Te.a.J1b(ka,db,Gb,cc)}wAd(ka,db,Gb,cc){return Te.a.wAd(ka,db,Gb,cc)}get zIb(){return Te.a.zIb}set zIb(ka){Te.a.zIb=
ka}jMb(ka,db){Te.a.jMb(ka,db)}I5c(ka){Te.a.I5c(ka)}u6f(ka){Te.a.u6f(ka)}ySd(ka,db){return Te.a.ySd(ka,db)}FUf(ka,db){Te.a.FUf(ka,db)}HUf(ka,db){Te.a.HUf(ka,db)}c6d(ka,db,Gb,cc,xc,Vc){Te.a.c6d(ka,db,Gb,cc,xc,Vc)}nhf(ka,db){Te.a.nhf(ka,db)}D3c(ka,db,Gb,cc){return Te.a.D3c(ka,db,Gb,cc)}I3c(ka,db,Gb,cc){return Te.a.I3c(ka,db,Gb,cc)}}Object(f.a)(Go,"CommentEditorProxy",null,[632]);class Xl{constructor(){this.W=null}get nRb(){return null!=this.gGg?this.gGg:this.gGg=(()=>this.W.Ta("WordEditor.ITableEditor"))()}get S5a(){return null!=
this.HDg?this.HDg:this.HDg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}s_(ka){this.S5a.s_(ej.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}wc(ka){this.W=ka;this.s_("CIPConfigStart");ka.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new Go).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.s_("CIPConfigEnd")}init(){this.s_("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn();this.s_("CIPInitEnd")})}sn(){this.Wsm()}dispose(){}Wsm(){bd.a.cTa(Te.a.IUf);
jk.a.f_e(Te.a.FUf);jk.a.jBd(Te.a.HUf);jk.a.Nvk(Te.a.$jn);this.nRb.execute(db=>{db.g_e(Te.a.jMb)});const ka=T.App.ni.zl;ka.Te(39).Mo(Te.a.EUf);jk.a.Uuk(Te.a.ejn);jk.a.Luk(Te.a.kin);Ge.a.isEnabled&&ka.Te(12).Fx(Te.a.aPj)}}Object(f.a)(Xl,"PackageManager",null,[1,2]);const Wp=ka=>{const db=L.a.instance.Ta("Box4.IPackageBootPerfLogger"),Gb=window.performance.now();db.execute(cc=>{cc.Ex(ej.a.comments,"CIPMain",Gb,!0)});z.a.instance.Gc(new Xl,0,ka)};var Id=c(2092),tr=c(174),xk=c(1679);class Ek{constructor(ka,
db,Gb,cc,xc,Vc,Wd){this.dNa=ka;this.hba=db;this.A7=Gb;this.Zc=cc;this.N2j=xc;this.IKe=Vc;this.uwb=Wd;xk.a.Mvk((re,od)=>{this.Itk(od.graphNode,od.E_k)});xk.a.swk((re,od)=>{this.r6k(od.graphNode,od.CYk)})}yRd(){var ka=this.N2j();const db=this.Zc.yk();db.set(ka);if(this.hba.$No(db))return db;db.set(ka);tr.PageNavigator.instance.EP(db);ka=this.A7.hdl(db.currentNode);db.wj(ka);return db}PTd(ka){const db=this.yRd();let Gb=null;this.hba.yOd(db,cc=>{this.A7.khi(cc)===ka&&(Gb=cc);return!Gb});return Gb}ghi(ka){const db=
this.yRd();let Gb=null;this.hba.yOd(db,cc=>{this.A7.t$b(cc)===ka&&(Gb=cc);return!Gb});return Gb}rJi(ka,db,Gb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,db,Gb)}lhi(){const ka=this.yRd(),db=[];this.hba.yOd(ka,Gb=>{db.push(this.A7.khi(Gb));return!0});return db}igb(ka,db){if(!db.length)return this.uwb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const Gb=this.yRd(),cc=
sh.a.create().toString(),xc=new Kj.a;for(let Vc of db)xc.add(Vc),this.rJi(Vc.type,cc,Vc.completion);db=this.dNa.cbg(xc);this.A7.igb(Gb.currentNode,cc,ka,db);this.IKe();return cc}Ze(ka){(ka=this.PTd(ka))?(this.A7.Ze(ka),this.IKe()):this.uwb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}t$b(ka){ka=this.PTd(ka);return ka?this.A7.t$b(ka):(this.uwb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}hhi(ka){return this.A7.t$b(ka)}jhi(ka){ka=
this.PTd(ka);if(!ka)return this.uwb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.A7.htf(ka);return this.dNa.i6b(ka).toArray()}kCk(ka,db){if(!db.length)return this.uwb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const Gb=this.PTd(ka);if(!Gb)return this.uwb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const cc=this.A7.htf(Gb),xc=this.dNa.i6b(cc);
for(let Vc of db)xc.add(Vc),this.rJi(Vc.type,ka,Vc.completion);ka=this.dNa.cbg(xc);ka!==cc&&(this.A7.alo(Gb,ka),this.IKe());return!0}Itk(ka,db){if(db=this.ghi(db)){const Gb=this.Zc.yk();Gb.set(ka);this.A7.Xb(db.clone(),this.A7.Bvl(db,Gb))}}C6i(ka,db,Gb){if(db.nb(ka))return db.J(ka);const cc=sh.a.create().toString();db.add(ka,cc);Gb&&this.uwb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return cc}r6k(ka,db){const Gb=new km.a;var cc=
this.Zc.yk();cc.set(ka);cc.Ub(38)&&this.hba.yOd(cc,xc=>{const Vc=this.A7.t$b(xc);void 0!==Vc&&null!==Vc&&Gb.add(Vc,xc);return!0});for(let xc of db)if(ka=null,({value:ka}=Gb.Fc(xc.key,ka)).returnValue)if(xc.value===xc.key)ka=this.ghi(xc.key),this.A7.Olo(ka,parseInt(xc.key));else{ka=this.A7.htf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.dNa.i6b(ka);cc=new bb.a;for(let Vc=0;Vc<ka.length;Vc++){if(ka.J(Vc).commentId){const Wd=
Number.parseInvariant(ka.J(Vc).commentId);db.nb(Wd)?ka.J(Vc).commentId=db.J(Wd).toString():ka.J(Vc).commentId=null}ka.J(Vc).recordId=this.C6i(ka.J(Vc).recordId,cc,!1);-1===ka.J(Vc).type&&(ka.J(Vc).undoId=this.C6i(ka.J(Vc).undoId,cc,!0))}this.igb(xc.value,ka.toArray())}}static Ur(){return new Ek(L.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),L.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new dg.a,()=>T.App.za.jb.Yc,()=>
{L.a.instance.Ta("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(f.a)(Ek,"TaskActor",null,[709]);var kk=c(1126);class co{create(){return new kk.a}}Object(f.a)(co,"TaskContentNodeFactory",null,[349]);var sd=c(1072);class vc{create(){return new sd.a}}Object(f.a)(vc,"TaskNodeFactory",null,[349]);class rp{constructor(ka,db,Gb,cc,xc,Vc){this.hba=ka;this.Kc=db;this.Zc=Gb;this.Zjk=cc;this.bkk=xc;this.kUb=Vc}Mbl(ka,db,Gb){const cc=this.bkk.create(1074135162);cc.setValue(sa.a.taskId,
ka);cc.setValue(sa.a.rRb,db);cc.setValue(sa.a.Iza,Gb);return cc}v$b(ka){const db=this.Kc.Pc(4);db.Db(ka);this.kUb();return db}khi(ka){return this.hba.FJb(ka)?ka.getValue(sa.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}t$b(ka){return this.hba.FJb(ka)?ka.hasProperty(sa.a.rRb)?ka.getValue(sa.a.rRb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}htf(ka){return this.hba.FJb(ka)?ka.getValue(sa.a.Iza):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}hdl(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const db=this.v$b(ka);try{const Gb=this.Zjk.create(1074135161),cc=this.Zc.yk();cc.set(ka);cc.C3(Gb,38,rp.yFo);return Gb}finally{db&&db.dispose()}}igb(ka,db,Gb,cc){if(!this.hba.dHf(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const xc=this.v$b(ka);try{const Vc=this.Mbl(db,Gb,cc),Wd=this.Zc.yk();Wd.set(ka);Wd.C3(Vc,1,new ia.a(sh.a.wva(Gb.toString()),1));return Vc}finally{xc&&
xc.dispose()}}Ze(ka){if(this.hba.FJb(ka))if(ka.anchor&&ka.anchor.Pp){var db=ka.anchor.Pp.hs.node;if(this.hba.dHf(db)){var Gb=this.v$b(db);try{const cc=this.Zc.yk();cc.set(db);cc.wj(ka.anchor.node);cc.vg()}finally{Gb&&Gb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}alo(ka,db){if(this.hba.FJb(ka)){var Gb=
this.v$b(ka);try{ka.setValue(sa.a.Iza,db)}finally{Gb&&Gb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Olo(ka,db){if(this.hba.FJb(ka)){var Gb=this.v$b(ka);try{const cc=ka.hasProperty(sa.a.rRb)?ka.getValue(sa.a.rRb):null;void 0===cc||null===cc||cc===db?ka.Dg(sa.a.rRb,db):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{Gb&&Gb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}Bvl(ka,db){if(!db.Fs(38)){const Gb=this.Zc.yk();
Gb.set(ka);Gb.zb(71);Gb.ld(71);ka=mb.b(Gb.currentNode,ka.Ui().Lc,!0);db.xf(ka,38)}return db.Ub(38)}Xb(ka,db){if(this.hba.dHf(db)){var Gb=this.v$b(db);try{const cc=this.Zc.yk();cc.set(db);cc.xf(ka,1)}finally{Gb&&Gb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Ur(){return new rp(L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new Rf.a,new dg.a,new co,new vc,()=>{Dk.App.hn.jb.Yc.mF.V7(10)})}}rp.yFo=new ia.a(sh.a.Ff("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(f.a)(rp,"TaskEditor",null,[708]);class Bo{constructor(ka,db){this.Bx=ka;this.pxb=db}FJb(ka){return!!ka&&72===ka.type}GTm(ka){return!!ka&&71===ka.Ue}dHf(ka){return!!ka&&71===ka.type}$No(ka){ka.set(this.Bx.value);this.pxb.EP(ka);return!!ka.Ub(38)}yOd(ka,db){if(ka&&db)if(this.GTm(ka))for(var Gb=!0,cc=ka.Ub(1);Gb&&cc;)this.FJb(cc)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",cc.type),Gb=db(cc),cc=ka.Jf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.Ue);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Ur(){return new Bo(new V.a(()=>T.App.za.jb.Yc),tr.PageNavigator.instance)}}Object(f.a)(Bo,"TaskNavigator",null,[635]);class Uo{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}dispose(){}wc(ka){this.W=ka;ka.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new Id.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();
ka.ia("WordEditor.Tasks.TaskNavigator",()=>Bo.Ur()).as("WordEditor.Tasks.ITaskNavigator").ha();ka.ia("WordEditor.Tasks.TaskEditor",()=>rp.Ur()).as("WordEditor.Tasks.ITaskEditor").ha();ka.ia("WordEditor.Tasks.TaskActor",()=>Ek.Ur()).as("WordEditor.Tasks.ITaskActor").ha()}sn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(116)}}Object(f.a)(Uo,"TasksPackage",null,[1,2]);var Yl=c(79),Fm=c(1676),Kn=c(400),pj=c(94);class Hp{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=
this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(Hp,"TaskPaneGroupAppProps",null,[]);var po=c(183);class Tl{static Z0k(ka,db){um.FocusManager.iK()&&(Tn.a.instance.MCa(ka,db,!1),po.a.instance.MCa(ka,db,!1),y.AFrameworkApplication.ua.ux.wT(ka))}}Object(f.a)(Tl,"ReactTaskPaneManagerUtils",null,[]);var Fk=c(140),Yk=c(332);class Hh{constructor(){this.type=null}}Object(f.a)(Hh,
"SampleTaskPaneProps",null,[]);var qo=c(1677);class xm{constructor(){this.entry=null;this.show=!1}}Object(f.a)(xm,"AnimationBatchEntry",null,[]);var gg=c(294),jn=c(1142),ro=c(126);class Le{constructor(){this.O9g=[];this.P9g=[];this.rma={};this.sKa=this.rKa=null;this.Ixd=!1;this.YZ=null;this.Pud=this.Mpd=0;this.nqc=[];this.WFe=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Lb.$kb;this.Mw=!1}initialize(){this.Ixd=!1;(this.Mw=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Lb.qL)&&
this.$af()}bbf(ka,db,Gb,cc){db=this.RTd(db);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.$af();const xc=document.createElement("div");xc.id=db;xc.className=Le.m1o;xc.style.width="0";this.WFe||(this.Bqk(Gb,db,xc),this.rma[db]=ka.bbf(db,Gb,cc,xc));return xc}$af(){this.Ixd||this.Pno()}Bqk(ka,db,Gb){let cc=null,xc=null;0===ka?(cc=this.rKa,xc=this.O9g):1===ka&&(cc=this.sKa,xc=this.P9g);if(cc){ka=!1;for(let Vc=0;Vc<xc.length;Vc++)if(!ka)xc[Vc]===db&&(ka=!0);else if(xc[Vc]in this.rma){this.HCm(cc,
Gb,this.rma[xc[Vc]]);return}cc.appendChild(Gb)}}HCm(ka,db,Gb){ka.insertBefore(db,Gb.element)}lol(ka){ka=this.RTd(ka);if(ka in this.rma){const db=this.rma[ka];db.element.parentNode.removeChild(db.element);delete this.rma[ka]}}qrj(ka){ka=this.RTd(ka);ka in this.rma&&(ka=this.rma[ka])&&!ka.isVisible&&(this.yqj(ka,!0),this.sqh(ka.position,!0,this.izh(ka,!0)),1===ka.position&&1<H.a.count(this.rma)&&this.Y5m())}rsm(ka){ka=this.RTd(ka);ka in this.rma&&(ka=this.rma[ka])&&ka.isVisible&&(this.yqj(ka,!1),this.sqh(ka.position,
!1,this.izh(ka,!1)))}x5b(ka){if(this.YZ)return this.YZ;const db=document.createElement("div");document.body.appendChild(db);db&&(this.YZ=new Fm.a(db,ka));return this.YZ}yqj(ka,db){ka.element&&(ka.isVisible=db,this.nqc.push(Object.assign(new xm,{entry:ka,show:db})));0===ka.position?this.Mpd+=db?1:-1:this.Pud+=db?1:-1;1===this.nqc.length&&window.setTimeout(Object(bn.a)(this,this.mAo,"startPaneAnimation"),0);this.Mw&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.Mpd||1===ka.position&&!this.Pud?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}mAo(){this.gVi();var ka=Va.where(Va.asEnumerable(this.nqc),xc=>0===xc.entry.position),db=Va.where(ka,xc=>!xc.show);if(Va.any(db)&&Va.Ct(db)!==Va.Ct(ka)){for(var Gb of db)Gb.entry.element.style.width="0";ka=Va.where(ka,xc=>xc.show)}db=Va.where(Va.asEnumerable(this.nqc),
xc=>1===xc.entry.position);Gb=Va.where(db,xc=>!xc.show);if(Va.any(Gb)&&Va.Ct(Gb)!==Va.Ct(db)){for(var cc of Gb)cc.entry.element.style.width="0";db=Va.where(db,xc=>xc.show)}for(let xc of Va.concat(ka,db))ka=xc.entry,ro.WacAirSpace.pV(ka.element,gg.a.Sfg),cc=new jn.a(ka.element),xc.show?cc.r0e(0,ka.width):cc.r0e(ka.width,0),ro.WacAirSpace.animate(cc,null,null);this.nqc.length=0}gVi(){}izh(ka,db){let Gb=ka.width;ka=0===ka.position?this.Mpd:this.Pud;if(db&&1===ka||!db&&!ka)Gb+=1;return Gb}Pno(){this.Ixd||
(this.rKa||(this.rKa=document.createElement("div"),this.rKa.id=Le.k1o,this.rKa.className=Le.IIj,Sys.UI.DomElement.addCssClass(this.rKa,"alignLeft"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Lb.s9&&Sys.UI.DomElement.addCssClass(this.rKa,"FlexBoxLayout"),this.WFe&&Sys.UI.DomElement.addCssClass(this.rKa,Le.FIj),this.toh(0,this.rKa)),this.sKa||(this.sKa=document.createElement("div"),this.sKa.id=Le.l1o,this.sKa.className=Le.IIj,Sys.UI.DomElement.addCssClass(this.sKa,"alignRight"),y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Lb.s9&&Sys.UI.DomElement.addCssClass(this.sKa,"FlexBoxLayout"),this.WFe&&Sys.UI.DomElement.addCssClass(this.sKa,Le.FIj),this.toh(1,this.sKa)),this.lXi(this.rKa,this.sKa),this.Ixd=!0)}lXi(){}PCa(ka,db){Array.add(1===ka?this.P9g:this.O9g,db)}RTd(ka){return ka+"-Entry"}Y5m(){let ka=0;for(const db of H.a.eP(this.rma)){const Gb=Object(Pb.a)(939,this.rma[db]);Gb&&Gb.isVisible&&1===Gb.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}Le.k1o="WACTaskPaneContainerLeft";Le.l1o="WACTaskPaneContainerRight";Le.IIj="WACTaskPaneContainer";Le.m1o="WACTaskPaneEntry";Le.FIj="WACReactTaskPaneContainer";Object(f.a)(Le,"BaseTaskPaneManager",null,[940]);var Th=c(492),ig=c(292);class Kk extends Le{constructor(ka,db){super();this.dzc=this.czc=this.NWe=this.MWe=0;this.$0h=()=>{$c.InteractiveViewManager.instance.forEach(Gb=>{Gb.COd()})};this.ga=ka;this.BZg=db}toh(ka,db){const Gb=
T.App.za.pD;Gb.parentNode&&(ka?1===ka&&(this.Mw?((ka=Object(ig.a)("FarPane"))&&ka.appendChild(db),db.classList.add("regionComposer"),T.App.za.VI.registerBoundingWindowRectsChanged("farPane",(cc,xc)=>{"DP"===xc||3===xc?db.classList.add("DL"):db.classList.remove("DL")})):Gb.parentNode.insertBefore(db,Gb.nextSibling)):this.Mw?((ka=Object(ig.a)("NearPane"))&&ka.appendChild(db),db.classList.add("regionComposer")):Gb.parentNode.insertBefore(db,Gb))}sqh(ka,db,Gb){this.Mw||(db=db?Gb:-Gb,ka?this.dzc+=db:this.czc+=
db)}gVi(){if(!this.Mw){var ka=T.App.za.pD;ro.WacAirSpace.pV(ka,gg.a.Sfg);if(this.MWe!==this.czc){const db=new Th.a(ka);db.FAk(this.MWe,this.czc,this.BZg);ro.WacAirSpace.animate(db,null,this.$0h);this.MWe=this.czc}this.NWe!==this.dzc&&(ka=new Th.a(ka),ka.GAk(this.NWe,this.dzc,this.BZg),ro.WacAirSpace.animate(ka,null,this.$0h),this.NWe=this.dzc)}}}Object(f.a)(Kk,"TaskPaneManager",Le,[]);var Lk=c(249);class Ln extends Kk{get vwi(){null==this.gre&&(this.gre=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.gre}constructor(ka,db){super(ka,db);this.LW=Pc.KeyInputManager.ic(Yl.a.Fw,0);this.MW=Pc.KeyInputManager.ic(Yl.a.Fw,4);this.BPe=this.Pyc=null;this.L3g="AccCheckerTaskPane";this.sa=new ha.a;this.isPaneOpen=!1;this.gre=this.Wze=null;this.PCa(0,"SampleTaskPane");this.PCa(0,Lk.a.Hhb);this.PCa(1,Lk.a.bGk);this.PCa(1,"CustomTaskPane");this.PCa(1,Lk.a.nBf);this.PCa(1,xd.AFrame.Qr);this.PCa(1,xd.AFrame.jmh);this.PCa(1,xd.AFrame.emh);this.PCa(1,Lk.a.IOd);this.PCa(1,Lk.a.VKc);this.PCa(1,
Lk.a.JMc);this.o7j=(this.kKg=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Lb)&&y.AFrameworkApplication.ua.Lb.XFf;this.u6j=Dk.App.OJb;this.A6j=this.kKg&&y.AFrameworkApplication.ua.Lb.$Wc;this.initialize();ka.fb(Vj.a.kgg,cl.a.application,Ln.kgg,96)}get Fde(){if(!T.App.za||!T.App.za.pD)return null;this.BPe||(this.BPe=new Fm.a(T.App.za.pD,um.FocusManager.instance()));return this.BPe}Tb(){}lXi(ka,db){const Gb=Kn.a.instance,cc=um.FocusManager.instance(),xc=pj.EventHandlerManager.instance,
Vc=this;ti.UISurfaces.Mu().then(Wd=>{Vc.Pyc=Vc.x5b(cc);let re;Wd.renderTaskPaneGroups(ka,db,(re=new Hp,re.middleContainer=T.App.za.pD,re.onTabStripFocus=()=>{cc.iD(Lk.a.lmc)},re.onOpen=(od,Be)=>{Vc.YFf(od)&&Tl.Z0k(od,Be);xc.CYe(Be,"focus",Vc.gfi(od,cc),!0);var ve=Vc.dyi(od),Wf=Wd.selectors.getTabbedTaskPaneCount(ve?1:2);ve=ve?Lk.a.nke:Lk.a.lmc;1===Wf&&(Gb.J7(ve),this.isPaneOpen=!0,this.Z4i({isPaneOpen:this.isPaneOpen,tRb:Be}));Be=Vc.zpf(od);if(Wf=cc.ae(Be))Wf.TIc=ve,Vc.qso(od)&&(Wf.kr(Vc.LW),Wf.kr(Vc.MW)),
Gb.Owi(Be)&&Gb.$w(Be);this.vwi&&this.NMd&&this.NMd.dismissFloatie(!0)},re.onClose=(od,Be)=>{Vc.YFf(od);const ve=Vc.dyi(od),Wf=ve?Lk.a.nke:Lk.a.lmc;Wd.selectors.getTabbedTaskPaneCount(ve?1:2)||(Gb.$w(Wf),this.isPaneOpen=!1,this.Z4i({isPaneOpen:this.isPaneOpen,tRb:Be}));xc.x6f(Be,"focus",Vc.gfi(od,cc),!0);this.vwi&&this.NMd&&this.NMd.dismissFloatie(!0)},re.setFocusCallback=(od,Be)=>{Vc.YFf(od)&&Be&&(od=cc.ae(Vc.zpf(od)),od.pXk(),od.cga(Be))},re.onOverflowMenuOpen=()=>{if(Vc.Pyc)Vc.Pyc.onMenuOpen()},
re.onOverflowMenuClose=()=>{if(Vc.Pyc)Vc.Pyc.onMenuClose()},re.onShow=(od,Be)=>{2===Be&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{cc.kg(od)},0)})},re.onHide=(od,Be,ve)=>{ve&&1!==Be&&cc.kg(cc.XT)},re.onResizeStart=()=>{if(T.App.za&&(T.App.za.pD.className=Rm.AppFrame.gqg,Vc.Fde))Vc.Fde.onMenuOpen()},re.onResizeEnd=()=>{if(T.App.za&&(Fk.a.uAi()||(T.App.za.pD.className+=" "+T.App.za.xAh),Vc.Fde))Vc.Fde.onMenuClose()},re));this.Sja(Lk.a.lmc,cc,db,Vc);this.Sja(Lk.a.nke,cc,ka,Vc);return null})}Sja(ka,
db,Gb,cc){const xc=db.ae(ka);xc.parent=xd.AFrame.xp;xc.$H=!0;Tn.a.instance.MCa(ka,Gb,!1);po.a.instance.MCa(ka,Gb,!1);ka=new Yk.DOMFocusListing(()=>Gb);ka.Mm(3);ka.Mm(2);ka.Mm(4);ka.Mm(1);db.Vma(()=>Gb,xc,ka).xP=!0;xc.kr(cc.LW);xc.kr(cc.MW)}zpf(ka){return ka===this.L3g?Lk.a.plh:ka}gfi(ka,db){return()=>{db.iD(this.zpf(ka))}}qso(ka){return ka===this.L3g?!1:!0}tKm(ka){return ka===Lk.a.Hhb}YFf(ka){return this.tKm(ka)||ka===Lk.a.plh||0<=ka.indexOf("AppForOfficePanel")||ka===Lk.a.IOd||ka===Lk.a.nBf&&this.o7j||
ka===Lk.a.VKc&&this.u6j||ka===Lk.a.JMc&&this.A6j||ka===qo.a.LEb?!0:!1}dyi(ka){return ka===Lk.a.Hhb||"SampleTaskPane"===ka}static dfm(){return new Ln(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static kgg(ka,db,Gb,cc,xc){if(1===Gb)return 32;ti.UISurfaces.Mu().then(Vc=>{Vc.showTaskPane(xc,Object.assign(new ui.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Hh,{type:"SampleTaskPaneProps"})}));return null});return 32}a_a(ka){this.sa.addHandler("onPaneToggle",
ka)}c6c(ka){this.sa.removeHandler("onPaneToggle",ka)}Z4i(ka){this.sa.raiseEvent("onPaneToggle",ka)}get NMd(){this.Wze||(this.Wze=L.a.instance.Oa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.Wze}}Object(f.a)(Ln,"TaskPaneManager",Kk,[356]);class zg{constructor(){this.sT=null}get name(){return"WordEditor.TaskPaneManager"}wc(){}init(){this.sT=Ln.dfm();this.sT.Tb();T.App.za.n8a=this.sT}dispose(){}}Object(f.a)(zg,"PackageManager",null,[1,2]);c.d(I,"a",function(){return l})},1974:function(D,
I,c){D=c(0);var l=c(170),f=c(731),a=c(353),k=c(22),x=c(2),y=c(80),m=c(42),r=c(41),z=c(6),v=c(16),G=c(7),F=c(75),H=c(441),L=c(88),J=c(471),M=c(5),P=c(596),N=c(197),K=c(222),O=c(18),V=c(1108),W=c(36),T=c(83),Y=c(40),ba=c(777),Z=c(27),ea=c(77),ha=c(21),la=c(53);class ia{constructor(Sa,Eb,Jb,vb){this.WJd=this.UJd=null;this.y$c=Sa;this.vke=Eb;this.Hsj=Jb;this.Isj=vb}}Object(D.a)(ia,"TableSimplificationInformation",null,[]);var sa=c(78),Oa=c(26),Ra=c(445),Na=c(259),Da=c(929),ra=c(1582),xa=c(282),fa=c(3),
oa=c(9),ta=c(137),Ka=c(17),va=c(260),La=c(32),za=c(254),Ca=c(8),ua=c(638),ib=c(568),bb=c(339);class mb extends Sys.EventArgs{constructor(Sa){super();this.Qo=Sa}}Object(D.a)(mb,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var yb=c(1781);class ab extends yb.a{constructor(Sa,Eb,Jb,vb){super(Sa,Eb,{});this.ITa=[];for(Sa=0;Sa<Jb.length;Sa++)this.ITa.push(...Jb.J(Sa).toArray());this.JDa=0;this.Fy=vb;this.Qo={}}}Object(D.a)(ab,"BasicInternalCopyArguments",yb.a,[]);class Ga extends Sys.EventArgs{constructor(Sa,
Eb){super();this.Qo=Eb;this.ITa=[];for(Eb=0;Eb<Sa.length;Eb++)this.ITa.push(...Sa.J(Eb).toArray())}}Object(D.a)(Ga,"BeforeCopyArguments",Sys.EventArgs,[]);class Za extends Sys.EventArgs{constructor(Sa){super();this.Qo=Sa}}Object(D.a)(Za,"BeforePasteArguments",Sys.EventArgs,[]);class Ub extends Sys.EventArgs{constructor(Sa,Eb,Jb,vb){super();this.paragraph=Sa;this.cpBegin=Eb;this.cpEnd=Jb;this.Qo=vb}}Object(D.a)(Ub,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var Xb=c(1825),zb=c(1826);class Ib{constructor(Sa,
Eb,Jb,vb,ac,dc,Cc,Ec,rc){this.smc=Sa;this.source=Eb;this.target=Jb;this.zYf=vb;this.rowIndex=ac;this.Bo=dc;this.N_a=Cc;this.u_i=Ec;this.ie=rc}}Object(D.a)(Ib,"CoreInternalTablePasteArguments",null,[]);class $a extends Sys.EventArgs{constructor(Sa,Eb,Jb,vb,ac){super();this.operation=Sa;this.kYi=Eb;this.original=Jb;this.clone=vb;this.Qo=ac}}Object(D.a)($a,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Hb=c(93);c.d(I,"a",function(){return Ya});class Ya{constructor(Sa,Eb,Jb,vb,ac,dc,Cc,Ec,rc,hb,
fb,Nb,Fb,nb,pb){this.XW=this.wt=null;this.BKe=!1;this.jBa=null;this.NWk=(Xa,Pb)=>{l.a.mark(5566);Pb=Pb.target;if(Pb.Qd())return Pb.vg(),!0;Xa.gi(this.RMc);return!0};this.RMc=(Xa,Pb)=>{Pb=new Xb.a(Pb,null);const Va=new f.a(Xa,this.tJc,Pb);Va.Ml("ExecuteCoreCopyToInternalClipboard");this.OFn(Pb);Va.run();Xa.gi(this.MLo);return!0};this.tJc=(Xa,Pb)=>{if(!Pb.source.Qd())return Pb.xi&&(Pb.xi.ZEd=null),G.ULS.shipAssertTag(6305560,307,!1),this.og.logKpiFailure({kpiName:bb.a.yEd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Xa.gi(this.YIh);return!0};this.YIh=(Xa,Pb)=>{const Va=Pb.insertAfter,tb=Pb.source,cb=Pb.target,Mb=tb.currentNode;var mc=this.NXi;if(!Mb.jia)return Xa.gi(this.sJc),!0;Pb.xi.lQb&&(Pb.lQb=!0);if(!this.tUk(Pb))return Pb.vka.RFa.c++,Xa.gi(this.sJc),!0;if(!Pb.lQb&&(Mb.w7b()&&Pb.vka.RFa.c++,Mb.w7b()||mc&&!Mb.Vkb(this.sv)))return Xa.gi(this.sJc),!0;if(!Pb.lQb&&mc&&!Mb.Qz)return tb.Gz()&&(Pb.Rne=!0,Pb=new f.a(Xa,this.tJc,new Xb.a(Pb,Va)),Pb.Ml("RecursiveCoreCopyToInternalClipboard"),Pb.run()),Xa.gi(this.sJc),
!0;mc=cb.currentNode.Ui().vd;mc=P.b(Mb,mc,!0);mc.wkb=!0;this.Pra.cce(Pb.vka.UGb,mc);cb.QH(mc,Va,18===tb.parentNode.type?1:tb.role);cb.wj(mc);Pb.insertAfter=mc;Ca.ParagraphReader.Wb(mc)&&(this.aGn(Xa,this.tJc,Mb,mc,Pb),this.$Fn(Xa,Mb,mc));this.uWh(Mb,mc);tb.Gz()&&(G.ULS.shipAssertTag(6305562,307,!Pb.Rne),Pb=new f.a(Xa,this.tJc,new Xb.a(Pb,null)),Pb.Ml("RecursiveCoreCopyToInternalClipboard"),Pb.run());Xa.gi((Cb,Ja)=>this.t6k(Cb,Ja));return!0};this.sJc=(Xa,Pb)=>{Pb.Rne&&(Pb.insertAfter=Pb.ZEd,Pb.Rne=
!1);if(!Pb.source.Gt()){Pb.xi&&(Pb.xi.ZEd=Pb.insertAfter);const Va=Pb.source;11!==Va.Ue||Va.F9b(-1)||this.EGn(Xa,Va.currentNode,Pb.target.currentNode,Pb);return!1}Xa.gi(this.YIh);return!0};this.MLo=(Xa,Pb)=>{if(Pb.JDa>=Pb.ITa.length)return Ya.sa.raiseEvent("AfterTrimCompleteOnCopy",new mb(Pb.Qo)),Xa.gi(this.s6k),!0;Xa=Pb.ITa[Pb.JDa];var Va=Xa.node,tb=Xa.cpBegin;let cb=Xa.cpEnd;if(!Ka.SelectionEditor.lv(Xa))if(!Pb.JDa&&Ka.SelectionEditor.Fk(Xa))cb=tb=Ca.ParagraphReader.textLength(Va);else if(Ca.ParagraphReader.nm(Xa))tb=
0,cb=Ca.ParagraphReader.textLength(Va);else if(Ka.SelectionEditor.Nca(Xa)){G.ULS.shipAssertTag(6305568,307,!Pb.JDa);var Mb=M.GraphIterator.eb(Va);tb=Mb.zb(12);G.ULS.shipAssertTag(6305569,307,tb);Va=Mb.origin;cb=tb=Ca.ParagraphReader.textLength(Va)}else{if(T.OutlineReader.l_d(Xa))for(Xa=N.a.ap(Xa.node);Xa.moveNext();)Mb=Xa.currentNode,Ca.ParagraphReader.Wb(Mb)&&Pb.ITa.push(Oa.a.createTextRange(Mb,0,Ca.ParagraphReader.textLength(Mb)));Pb.JDa++;return!0}Mb=Pb.rZf[Va.id.toString()];G.ULS.shipAssertTag(6305570,
307,!!Mb);if(!Mb)return G.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Pb.JDa,["SelectedContextsLength"]:Pb.ITa.length,["SelectedNodeType"]:Va.type,["ContextId"]:Xa.contextId}),Pb.JDa++,!0;Va=sa.e(Mb);let mc,Cb=!1;for(mc=Va.length-1;0<=mc;mc--)if(!Va[mc].lDa)if(4===Va[mc].qh)Va[mc].Kb.blob=null,Va[mc].Kb.blob=new Ra.a(Va[mc].Kb),Pb.vka.RFa.e++;else{Va[mc].Kb.blob=null;if(-1!==Va[mc].oe){var Ja=Va[mc].Kb.formatting,Wa=void 0,xb=void 0;Ja&&-1===Ja.oe?(xb=Va[mc].oe+
1,Wa=Va[mc].Y4-1,Ja.oe=Va[mc].oe):(Wa=Va[mc].Y4,xb=Va[mc].oe);for(Ja=0;Ja<Wa;Ja++)Mb.we.removeAt(xb,16);0<Wa&&(Cb=!0)}Wa="";xa.f(Va[mc])?(Wa=" ",Pb.vka.RFa.f++):xa.g(Va[mc])&&(xb=xa.b(Va[mc]))&&(Wa=xa.a(xb),Pb.vka.RFa.g++);xb=Va[mc].Kb.cp;xb>=tb&&xb<cb&&(Ya.ig.Ge(Oa.a.createTextRange(Mb,xb,xb+1),Wa,void 0,void 0,void 0,void 0,!0),cb=cb-1+Wa.length,Pb.vka.RFa.i++)}Cb&&Mb.Zl();this.IYn(Mb);Ya.sa.raiseEvent("BeforeTrimOnCopy",new Ub(Mb,tb,cb,Pb.Qo));Va=Ca.ParagraphReader.textLength(Mb);cb<Va&&Ya.ig.Ge(Oa.a.createTextRange(Mb,
cb,Va),"",void 0,void 0,void 0,void 0,!0);0<tb&&Ya.ig.Ge(Oa.a.createTextRange(Mb,0,tb),"",void 0,void 0,void 0,void 0,!0);this.tlm(Mb,Pb.vka.RFa);Ca.ParagraphReader.textLength(Mb)||Pb.JDa!==Pb.ITa.length-1||!Ka.SelectionEditor.lv(Xa)||Mb.Gs||(Xa=M.GraphIterator.eb(Mb),Xa.zb(25)&&(W.OutlineElementNavigator.Wd(Xa),this.mh.R0a(Xa),Pb.JDa&&(this.wt.lb.bwa=!0)));Pb.JDa!=Pb.ITa.length-1||this.bwa||Mb.zg(r.a.r5,r.a.Ada,r.a.sqa,r.a.xya,r.a.W9);this.Pra.j5c(Pb.vka.o9d,Pb.vka.NBb,Pb.vka.Seb,Mb);Pb.JDa++;return!0};
this.s6k=(Xa,Pb)=>{this.hka.PSb(null);Pb.Fy.dispose();l.a.mark(5567);this.lfn();this.XW=Pb.vka;this.IIi("Copy");this.eHm&&G.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.qzn=(Xa,Pb)=>{if(Pb.smc){if(Pb.smc.inProgress)return!0;Z.TableCellReader.isTableCell(Pb.source)||Pb.source.ld(16);if(this.Lcn(Pb))return!1}else La.TableReader.isTable(Pb.target)||Pb.target.ld(14),La.TableReader.isTable(Pb.source)||Pb.source.ld(14),ha.moveToCell(Pb.target,Pb.rowIndex,Pb.Bo),ha.moveToCell(Pb.source,
0,0);if(Z.TableCellReader.fg(Pb.source)||Z.TableCellReader.fg(Pb.target))return!0;this.dzn(Pb,Xa);return!0};this.vJc=(Xa,Pb)=>{if(!Pb.source.Qd())return Xa.gi(this.Rnb),!0;Xa.gi(this.$Ih);return!0};this.$Ih=(Xa,Pb)=>{const Va=Pb.source,tb=Pb.target,cb=Va.currentNode;if(!cb.jia||!cb.PNa||this.Yro(Va,tb))return Xa.gi(this.j$e),!0;if(L.a.instance.J(1)&&Y.OutlineElementReader.Bh(Va)){if(!W.OutlineElementNavigator.Ce(Va).PNa)return W.OutlineElementNavigator.Wd(Va),Xa.gi(this.j$e),!0;W.OutlineElementNavigator.Wd(Va)}G.ULS.shipAssertTag(6305608,
307,!cb.w7b());var Mb=tb.currentNode.Ui().vd;Mb=P.b(cb,Mb,!0);Mb.ZGa();Mb.LWc=!0;this.V1n(Va,tb);tb.QH(Mb,Pb.insertAfter,Va.role);tb.wj(Mb);Pb.insertAfter=Mb;oa.App.xd.So&&oa.App.xd.Yp.$F(Mb);this.uWh(cb,Mb);Pb=new f.a(Xa,this.vJc,new zb.a(Va,tb,null,Pb.zYf,Pb.Qo));Pb.Ml("RecursiveCorePasteOperation");Pb.run();Xa.gi(this.w6k);return!0};this.w6k=(Xa,Pb)=>{const Va=Pb.target,tb=Va.currentNode,cb=Pb.source,Mb=cb.currentNode;let mc=-1;Pb.Qo[Ya.ozf]&&(mc=Pb.Qo[Ya.ozf]);Ca.ParagraphReader.Wb(tb)&&(this.QGn(Xa,
this.vJc,Mb,tb,Pb),this.MGn(Xa,Mb,tb));tb.Y0();Pb.Qo[V.a.xsi]?22===tb.type&&(Z.TableCellReader.F0(cb)||tb.setValue(z.a.listID,Number.MAX_VALUE)):this.zK.e1n(tb);if(Ca.ParagraphReader.Wb(tb)&&(Pb=sa.i(tb,5),0<Pb.length)){for(const Cb of Pb)!Cb.properties.hasProperty(z.a.WMb)&&Cb.properties.hasProperty(z.a.R9d)&&(Pb=Cb.properties.getValue(z.a.R9d),Cb.properties.setValue(z.a.WMb,Pb)),O.ImageReader.Ebc()?O.ImageReader.HJb(Cb.properties)&&this.Rj.N$f(Cb.properties,mc):O.ImageReader.Jy(Cb.properties)||
this.Rj.N$f(Cb.properties,mc);tb.Ui().contentReplicator.forceOutbound(null,null,null)}this.tWh(Va);this.EXo(Mb,tb);La.TableReader.HR(tb)&&G.ULS.sendTraceTag(524919814,3022,50,"TablePasted");Z.TableCellReader.Epa(Va)&&ra.a.Dfj(tb);Va.rc();Xa.gi(this.j$e);return!0};this.j$e=(Xa,Pb)=>{if(!Pb.source.Gt())return Xa.gi(this.Rnb),!0;Xa.gi(this.$Ih);return!0};this.Rnb=()=>{l.a.mark(5565);return!1};this.SYb=dc;this.Zo=Cc;this.Rj=Sa;this.STe=Eb;this.BK=Jb;this.mh=vb;this.zK=ac;this.Ga=Ec;this.Kc=hb;this.kzd=
rc.create(2097162);this.z5f(this.kzd);this.Rye=rc.create(2097162);this.z5f(this.Rye);this.PWe=rc.create(2097162);this.z5f(this.PWe);this.Uxd=this.kzd;this.EZ=fb;this.t3=Nb;this.Ud=Fb;this.og=a.a.getInstance(bb.a.I_a);this.tCc=nb;this.Qgk=nb.substr(0,3);this.W6=pb}get il(){return null!=this.fEg?this.fEg:this.fEg=k.a.instance.resolve("Box4.IParagraphEditor")}get Zb(){return null!=this.Wxg?this.Wxg:this.Wxg=k.a.instance.Oa("Box4.IFeatureHelper")}get sv(){return this.wt?this.wt.sv:0}get gCb(){return this.wt.lb.gCb}get bwa(){return this.wt.lb.bwa}get hka(){return this.Uxd}get oxj(){return this.PWe}get o9e(){return this.wt.HJ&&
!this.BKe}Lmj(){this.BKe=!0}get NXi(){return!this.wt.HJ}get Pra(){return ua.a.instance}z5f(Sa){var Eb=new Da.a(-1);this.SYb.zl.vNa(Eb);const Jb=new M.GraphIterator;Jb.set(Eb);x.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");Eb=3;this.Ga&&this.Ga.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(Eb=0);Eb=this.Kc.Pc(Eb);Eb.Qt(Jb);Jb.xf(Sa,80);Eb.dispose()}KHd(Sa,Eb=null){Sa=Sa.mb;this.wt=Sa.hb.clone();this.BKe=!1;Sa=
M.GraphIterator.eb(Sa.O1);const Jb=M.GraphIterator.eb(this.hka),vb=this.Kc.Pc(3,fa.a.yDm);vb.Qt(Jb);Sa.Ub(82);do Sa.currentNode.PSb(null);while(Sa.Ni(82));Sa=new f.a(Eb,this.NWk,new ab(Sa,Jb,this.wt,vb));Sa.Ml("InternalCopy");Sa.Hh=!Eb||Eb.Hh;Sa.run()}t6k(Sa,Eb){var Jb=Eb.source;const vb=Eb.target;var ac=vb.currentNode,dc=Jb.currentNode;Ca.ParagraphReader.kh(vb)&&(Eb.rZf[dc.id.toString()]=ac);if(Ca.ParagraphReader.Wb(ac)){if(0<Ca.ParagraphReader.Jgi(dc))if(0<this.Zo.DG(dc).Ut)dc.setValue(z.a.BSa,
0);else{const Cc=this.Zo.t4(dc).Ut;this.il.mq.Zda(ac,Cc)}if(!this.zYd&&this.W6.v_i){Jb.rc();if(!La.TableReader.hx(vb)&&Jb.lGa&&!this.bwa)for(const Cc of this.W6.tZf)ac.removeProperty(Cc);Jb.wj(dc)}}if(Ca.ParagraphReader.Wb(ac)){for(dc=0;dc<ac.we.length;dc++)ac.we.rq.Z(dc,za.CharacterPropertiesEditor.$M),ac.we.kt.Z(dc,za.CharacterPropertiesEditor.WR);G.ULS.shipAssertTag(6305565,307,!!oa.App.xd);(this.Ud.tg||L.a.instance.J(1)&&oa.App.Gv.QRb)&&ac.setValue(z.a.XQa,!0);ac.zg(z.a.qEb,z.a.yZi,z.a.lZf);L.a.instance.J(1)&&
Ca.ParagraphReader.Wb(ac)&&ac.zg(z.a.Dxa)}this.NXi&&(this.tWh(vb),La.TableReader.isTable(vb)&&(ac=this.wt.HO(),ac.moveNext(),(ac=Z.TableCellReader.SEa(Jb,ac.current.node))||(ac=new ba.a(0,0)),Jb=new ia(ac,vb,La.TableReader.uha(Jb),La.TableReader.Qsf(Jb)),this.STe.value.f4n(Jb)));Y.OutlineElementReader.Bh(vb)&&!vb.Fs(2)&&(this.mh.fJ(vb),vb.rc());vb.rc();Eb.xi&&(Eb.xi.ZEd=Eb.insertAfter);Sa.gi(this.sJc);return!0}tUk(Sa){const Eb=Sa.source;if(Y.OutlineElementReader.Bh(Eb)&&Eb.rjb(12)){const Jb=Eb.Qd();
if(Ca.ParagraphReader.Wb(Jb)&&Jb.ja(z.a.zN,null))return Eb.rc(),Sa.lQb=!1;Eb.rc()}else if(Ca.ParagraphReader.Wb(Eb.Cn)&&Eb.Cn.ja(z.a.zN,null))return!1;return!0}$Fn(Sa,Eb,Jb){Eb=sa.e(Eb);Jb=sa.e(Jb);for(let vb=0;vb<Eb.length;vb++)Eb[vb].hUf(Jb[vb],Sa,this.tJc)}IYn(Sa){if(Sa=Sa.qa){var Eb=new F.a;for(let Jb=0;Jb<Sa.length;Jb++){const vb=Sa.J(Jb);vb.zj&&Eb.add(vb)}for(const Jb of Eb)Jb.zj=null}}get eHm(){return!M.GraphIterator.eb(this.hka).Qd()}hHj(){this.Uxd=this.PWe}gHj(){this.Uxd=this.kzd}cZo(){this.Uxd=
this.Rye}get vUm(){return this.hka===this.kzd}get sJm(){return this.hka===this.Rye}qDh(){const Sa=M.GraphIterator.eb(this.hka);for(;Sa.Qd();)Sa.vg()}IIi(Sa){const Eb=this.XW.RFa.b;Sa+="-"+Eb;this.XW.RFa.b=Sa;this.XW.UGb.b=Sa;this.XW.o9d.b=Sa;this.XW.NBb.b=Sa;this.XW.Seb.b=Sa;this.Pra.z3m(this.XW.RFa);this.Pra.TLf(this.XW.UGb);this.Pra.zJi(this.XW.o9d);this.Pra.FLf(this.XW.NBb);this.Pra.CLf(this.XW.Seb);this.XW.RFa.b=Eb;this.XW.UGb.b=Eb;this.XW.o9d.b=Eb;this.XW.NBb.b=Eb;this.XW.Seb.b=Eb}r_i(Sa,Eb,
Jb,vb,ac=null,dc=null){this.IIi("Paste");Eb=M.GraphIterator.eb(Eb);const Cc=M.GraphIterator.eb(this.hka);var Ec=null;ac&&(Ec=new J.a(T.OutlineReader.Fgl,T.OutlineReader.qhl),Ec=ac.equals(new J.a(-1,-1))?new J.a(0,0):ac.Oje(Ec));if(this.rsi())if(Cc.Qd(),O.ImageReader.Jt(Cc.currentNode))ac=Cc.currentNode,Cc.rc(),Cc.QH(this.mh.hgb(),null,1),Cc.Qd(),Cc.QH(ac,null,2),Cc.rc(),Cc.wj(ac),Cc.vg(),this.Lmj();else if(K.isFloatingEmbeddedFileNode(Cc.currentNode)){ac=Cc.currentNode;Cc.rc();Cc.QH(this.mh.hgb(),
null,1);Cc.Qd();var rc=this.mh.fJ(Cc);rc=Oa.a.Oc(rc,0);Ya.ig.Ge(rc,"<<"+K.getEmbeddedFileName(ac)+">>",void 0,void 0,void 0,void 0,!0);Cc.rc();Cc.rc();Cc.wj(ac);Cc.vg();this.Lmj()}this.EZ&&this.EZ.CFf(Jb)||!this.qCi(Cc,Eb)?(l.a.mark(5564),Cc.currentNode.PSb(null),Sa={},Sa[Ya.ozf]=vb,Hb.ListItemReader.jg(Jb)&&(Sa[V.a.xsi]=!0),Jb=new zb.a(Cc,Eb,Jb,Ec,Sa),vb=new f.a(dc,this.vJc,Jb),vb.Ml("ExecuteCorePasteFromInternalClipboard"),vb.Hh=!dc||dc.Hh,this.PFn(Jb),vb.run()):(Cc.currentNode.PSb(null),G.ULS.sendTraceTag(7869376,
307,50,"Begin internal paste table in table"),this.J1n(dc,Cc,Eb,Ec,Sa),G.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}NBi(Sa){if(Sa&&Sa.isValid){const Eb=M.GraphIterator.eb(this.hka);return this.qCi(Eb,Sa)}return!1}qCi(Sa,Eb){if(Z.TableCellReader.Epa(Eb)&&1===Sa.Qp()){Sa.Ub(1);if(Y.OutlineElementReader.Bh(Sa)){W.OutlineElementNavigator.Ce(Sa);if(La.TableReader.isTable(Sa))return La.TableReader.MB(Sa.currentNode)&&G.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),
Eb.zb(14)&&!La.TableReader.MB(ha.getContainingTable(Eb))?G.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."):G.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),!0;W.OutlineElementNavigator.Wd(Sa)}Sa.rc()}return!1}J1n(Sa,Eb,Jb,vb,ac){let dc,Cc;let Ec;Object(m.a)("ReplaceTableCellsFromClipboardTable",!0);Jb.zb(14);dc=la.a.Es(Jb);Cc=ea.a(Jb);Jb.ld(14);var rc=La.TableReader.eg(Jb.currentNode);Ec=La.TableReader.eh(Jb.currentNode);const hb=La.TableReader.eg(Eb.currentNode),
fb=La.TableReader.eh(Eb.currentNode);G.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",rc,Ec,hb,fb,dc,Cc);if(va.TableBorderSelectionCache.yRc())this.Nlo(),rc=Math.min(this.Fke+1,rc),Ec=Math.min(this.Sjg+1,Ec),this.Sjg-this.vFo==Ec-1&&(this.ywj==this.Fke?Cc=0:this.Fke-this.ywj==rc-1&&(Jb.Qd(),dc=la.a.Es(Jb),Cc=ea.a(Jb)));else{this.jBa=ib.a.D9b;const Nb=dc+hb-rc;0<Nb&&(ha.moveToLastRow(Jb),G.ULS.sendTraceTag(8716374,
307,50,"Begin insert rows: "+Nb),this.STe.value.insertRows(Jb,!1,Nb,this.jBa),G.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Jb.ld(14));const Fb=Cc+fb-Ec;if(0<Fb){G.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Fb);try{this.STe.value.insertColumns(Jb,Ec,!1,Fb,this.jBa)}catch(nb){throw G.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",nb.toString()),nb;}G.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<Nb||0<Fb)&&Object(m.a)("InsertRowsAndColumnsForInternalCCP",
!0)}rc=this.QOl(rc,Ec,hb,fb,dc,Cc);G.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Sa=new f.a(Sa,this.qzn,new Ib(null,Eb,Jb,vb,dc,Cc,rc,null,ac));Sa.Ml("ExecuteCorePasteTableInTable");Sa.Hh=!1;Sa.run()}lfn(){if(this.zYd){for(var Sa=M.GraphIterator.eb(this.hka),Eb=Sa.currentNode;14!==Sa.Ue;)if(Eb=Sa.Qd(),!Eb){G.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.oQi(Eb)}}pfn(Sa){this.zYd&&this.oQi(Sa)}mIo(Sa){const Eb=
M.GraphIterator.eb(Sa);this.BK.akb(Eb,null,!0);Sa.fg=!1;Sa.rowSpan=1;Sa.colSpan=1}oQi(Sa){if(Sa&&14===Sa.type){G.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Eb={},Jb=La.TableReader.eg(Sa),vb=La.TableReader.eh(Sa),ac=M.GraphIterator.eb(Sa);ha.forEachCellInTable(ac,(dc,Cc,Ec)=>{const rc={};dc=dc.currentNode;if(16===dc.type)if(dc.fg)Ya.mGh(Cc,Ec)in Eb||(this.mIo(dc),rc.IsGhostCell="->false");else{Ya.vRn(Sa,dc,Cc,Ec,Jb,(fb,Nb,Fb)=>{rc.rowSpan=String.format("{0}:{1}->{2}",
fb,Nb,Fb)});Ya.uRn(Sa,dc,Ec,Cc,vb,(fb,Nb,Fb)=>{rc.colSpan=String.format("{0}:{1}->{2}",fb,Nb,Fb)});const hb=String.format("{0},{1}-{2},{3}",Cc,Ec,Cc+dc.rowSpan,Ec+dc.colSpan);for(let fb=0;fb<dc.rowSpan;fb++)for(let Nb=0;Nb<dc.colSpan;Nb++)if(fb||Nb)Eb[Ya.mGh(Cc+fb,Ec+Nb)]=hb}if(0<H.a(rc).length){if(void 0===rc.IsGhostCell||null===rc.IsGhostCell){if(void 0===rc.rowSpan||null===rc.rowSpan)rc.rowSpan=dc.rowSpan;if(void 0===rc.colSpan||null===rc.colSpan)rc.colSpan=dc.colSpan}G.ULS.sendTraceTag(39175904,
307,50,"NormalizeTable: [{0},{1}]: {2}.",Cc,Ec,rc)}return!0});Ya.frl(Eb)}}tlm(Sa,Eb){if(Sa&&Ca.ParagraphReader.Wb(Sa)){var Jb=0,vb=M.GraphIterator.eb(Sa);for(vb.Ub(6);!vb.Wr;){var ac=vb.currentNode;vb.Ni(6);O.ImageReader.Jt(ac)?O.ImageReader.eGf(ac)?M.GraphIterator.eb(ac).rjb(59)?G.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.il.aIh(ac,Oa.a.Oc(Sa,Jb),!0),Eb.d++,Jb++):(ac=M.GraphIterator.eb(ac),ac.zb(12),ac.vg(),Eb.h++):G.ULS.shipAssertTag(6305571,
307,!1)}}}get zYd(){return!!this.Ga&&this.Ga.$("ComplexTableCellPasteWithFormattingIsEnabled")}QOl(Sa,Eb,Jb,vb,ac,dc){const Cc=[];let Ec,rc,hb,fb;va.TableBorderSelectionCache.yRc()?(Ec=Math.min(Sa,ac+Jb),rc=Math.min(Eb,dc+vb),fb=ac):(fb=0,Ec=Math.max(ac+Jb,Sa));for(;fb<Ec;fb++)for(va.TableBorderSelectionCache.yRc()?hb=dc:(hb=0,rc=dc+vb,fb<ac?hb=Eb:fb>=ac&&fb<Math.min(ac+Jb,Sa)?hb=dc:fb>=ac+Jb&&fb<Sa?hb=Eb:rc=Math.max(dc+vb,Eb));hb<rc;hb++)Cc.push(Array(2)),Cc[Cc.length-1][0]=fb,Cc[Cc.length-1][1]=
hb;return Cc}V1n(Sa,Eb){if(this.zYd)if(!Eb||!Sa)G.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Sa,["table"]:Eb});else if(16===Eb.currentNode.type&&16===Sa.parentNode.type){Eb=Eb.currentNode;Sa=Sa.parentNode;var Jb={};Eb.fg!==Sa.fg&&(Eb.fg=Sa.fg,Jb.IsGhostCell=Eb.fg);Eb.Q4!==Sa.Q4&&(Eb.Q4=Sa.Q4,Jb.IsSkippedCell=Eb.Q4);Eb.Qpb!==Sa.Qpb&&(Eb.Qpb=Sa.Qpb,Jb.ShouldRenderCell=Eb.Qpb);Eb.colSpan!==Sa.colSpan&&(Jb.ColSpan=String.format("{0}<={1}.",Eb.colSpan,Sa.colSpan),
Eb.colSpan=Sa.colSpan);Eb.rowSpan!==Sa.rowSpan&&(Jb.RowSpan=String.format("{0}<={1}.",Eb.rowSpan,Sa.rowSpan),Eb.rowSpan=Sa.rowSpan);H.a(Jb)}}Yro(Sa,Eb){let Jb=!1;Y.OutlineElementReader.Bh(Sa)&&(Jb=Y.OutlineElementReader.UQ(Sa)&&this.FTm(Eb));return Jb}FTm(Sa){if(Sa)return Sa=Sa.Ue,36===Sa||38===Sa||16===Sa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}MGn(Sa,Eb,Jb){Eb=sa.e(Eb);const vb=sa.e(Jb);for(let ac=Eb.length-1;0<=ac;ac--){if(!Eb[ac].clc(Jb)){const dc=
Oa.a.createTextRange(Jb,Eb[ac].Kb.cp,Eb[ac].Kb.cp+1);Ya.ig.Ge(dc,"",void 0,void 0,void 0,void 0,!0)}Eb[ac].b1c(vb[ac],Sa,this.vJc,this.sJm)}}EXo(Sa,Eb){if(L.a.instance.J(1)&&La.TableReader.HR(Sa)){let Jb=0;const vb=La.TableReader.eg(Sa);for(const ac of La.TableReader.Mx(Sa,0,vb-1))ac.Uu&&Jb++;Sa=this.Kc.Pc(4);Sa.Db(Eb);Eb.properties.setValue(v.a.Gza,vb-Jb);Sa.dispose()}}i5d(){return!M.GraphIterator.eb(this.hka).Qd()}rsi(){return this.o9e?1===M.GraphIterator.eb(this.hka).Qp():!1}C6h(Sa){try{return this.BRl(Sa)}catch(Eb){return G.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Eb.message),0}}BRl(Sa){let Eb=0;if(Sa&&(Eb=this.ARl(Sa),!Eb&&Sa.childNodes))for(let Jb=0;Jb<Sa.childNodes.length&&!(Eb=this.C6h(Sa.childNodes[Jb]));Jb++);return Eb}ARl(Sa){if(1===Sa.nodeType&&Sa.getAttribute){Sa=(Sa.getAttribute("class")||"").split(" ");for(const Eb of Sa)if(Eb.startsWith(this.Qgk))return Eb.startsWith(this.tCc)?this.sv&&Eb===this.tCc+this.sv?3:2:1}return 0}aGn(Sa,Eb,Jb,vb,ac){ac.Qo||(ac.Qo={});Ya.sa.raiseEvent("OnParagraphCopy",
new $a(Sa,Eb,Jb,vb,ac.Qo))}EGn(Sa,Eb,Jb,vb){vb.Qo||(vb.Qo={});Ya.sa.raiseEvent("OnCopyComplete",new $a(Sa,null,Eb,Jb,vb.Qo))}PFn(Sa){Sa.Qo||(Sa.Qo={});Ya.sa.raiseEvent("BeforePaste",new Za(Sa.Qo))}OFn(Sa){Sa.Qo||(Sa.Qo={});Ya.sa.raiseEvent("BeforeCopy",new Ga(this.wt,Sa.Qo))}QGn(Sa,Eb,Jb,vb,ac){Ya.sa.raiseEvent("OnParagraphPaste",new $a(Sa,Eb,Jb,vb,ac.Qo))}tWh(Sa){Z.TableCellReader.isTableCell(Sa)&&(Sa.Ub(1)||this.BK.P7(Sa,!0),Sa.rc())}uWh(Sa,Eb){this.t3.Hxa(Eb)&&(Eb.width=Sa.width)}static f_e(Sa){Ya.sa.addHandler("OnParagraphCopy",
Sa)}static jBd(Sa){Ya.sa.addHandler("OnParagraphPaste",Sa)}static j_n(Sa){Ya.sa.removeHandler("OnParagraphPaste",Sa)}static Nvk(Sa){Ya.sa.addHandler("OnCopyComplete",Sa)}static Tuk(Sa){Ya.sa.addHandler("BeforePaste",Sa)}static BZn(Sa){Ya.sa.removeHandler("BeforePaste",Sa)}static Ruk(Sa){Ya.sa.addHandler("BeforeCopy",Sa)}static Uuk(Sa){Ya.sa.addHandler("BeforeTrimOnCopy",Sa)}static Luk(Sa){Ya.sa.addHandler("AfterTrimCompleteOnCopy",Sa)}static get ig(){return null!=Ya.vvg?Ya.vvg:Ya.vvg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get aH(){return Na.a.instance}static get wi(){return ta.PageReader.instance}static frl(Sa){const Eb=
{};for(const Jb of H.a(Sa)){const vb=Sa[Jb];Eb[vb]=vb in Eb?String.format("{0}|{1}",Eb[vb],Jb):Jb}1<=H.a(Eb).length&&G.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Eb)}static uRn(Sa,Eb,Jb,vb,ac,dc){Eb.colSpan>ac-Jb&&(dc&&dc("A",Eb.colSpan,ac-Jb),Eb.colSpan=ac-Jb);Sa=Ya.jwo(Sa,Eb,vb,Jb);Eb.colSpan!==Sa&&(dc&&dc("B",Eb.colSpan,Sa),Eb.colSpan=Sa)}static vRn(Sa,Eb,Jb,vb,ac,dc){Eb.rowSpan>ac-Jb&&(dc&&dc("A",Eb.rowSpan,ac-Jb),Eb.rowSpan=ac-Jb);Sa=Ya.kwo(Sa,Eb,Jb,vb);Eb.rowSpan!==
Sa&&(dc&&dc("B",Eb.rowSpan,Sa),Eb.rowSpan=Sa)}static jwo(Sa,Eb,Jb,vb){return Ya.Crj(Sa,Eb.colSpan,(ac,dc)=>{ha.moveToCell(ac,Jb,vb+dc)})}static kwo(Sa,Eb,Jb,vb){return Ya.Crj(Sa,Eb.rowSpan,(ac,dc)=>{ha.moveToCell(ac,Jb+dc,vb)})}static Crj(Sa,Eb,Jb){if(14!==Sa.type)throw Error.argument("tableNode is not a Table.");if(!Jb)throw Error.argumentNull("MoveToCellAction");for(let ac=1;ac<Eb;ac++){var vb=M.GraphIterator.eb(Sa);Jb(vb,ac);vb=vb.currentNode;if(!vb||16!==vb.type||!vb.fg)return ac}return Eb}static mGh(Sa,
Eb){return Sa+","+Eb}dzn(Sa,Eb){for(;Sa.target.Qd();)Sa.target.vg();Sa.smc=new f.a(Eb,Sa.u_i?Sa.u_i:this.vJc,new zb.a(Sa.source,Sa.target,null,Sa.zYf));Sa.smc.Ml("ExecuteCorePasteCellContentInCell");Sa.smc.Hh=!1;Sa.smc.run()}Lcn(Sa){let Eb=!1;if(va.TableBorderSelectionCache.yRc()){const Jb=ea.a(Sa.target),vb=la.a.Es(Sa.target);let ac=this.Fke;isNullOrUndefined(Sa.N_a[Sa.N_a.length-1])||(ac=Math.min(ac,Sa.N_a[Sa.N_a.length-1][0]));let dc=this.Sjg;isNullOrUndefined(Sa.N_a[Sa.N_a.length-1])||(dc=Math.min(dc,
Sa.N_a[Sa.N_a.length-1][1]));Z.TableCellReader.TQa(Sa.target)||Z.TableCellReader.TQa(Sa.source)||vb==ac&&Jb==dc?Eb=!0:(Z.TableCellReader.isTableCell(Sa.target)||Sa.target.ld(16),Z.TableCellReader.Tca(Sa.source)?(Z.TableCellReader.TQa(Sa.target)||(ha.moveToNextRow(Sa.target),ha.moveToColumnByIndex(Sa.target,Sa.Bo),G.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),ha.moveToNextOrPreviousCell(Sa.source,!1,!1)):Z.TableCellReader.Tca(Sa.target)||Jb==dc?(ha.moveToNextRow(Sa.source),
ha.moveToColumnByIndex(Sa.source,0),G.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),ha.moveToNextRow(Sa.target),ha.moveToColumnByIndex(Sa.target,Sa.Bo),G.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(ha.moveToNextOrPreviousCell(Sa.target,!1,!1),ha.moveToNextOrPreviousCell(Sa.source,!1,!1)))}else Z.TableCellReader.TQa(Sa.source)?Eb=!0:(Z.TableCellReader.isTableCell(Sa.target)||Sa.target.ld(16),Z.TableCellReader.Tca(Sa.source)?(ha.moveToNextRow(Sa.target),
ha.moveToColumnByIndex(Sa.target,Sa.Bo),G.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):ha.moveToNextOrPreviousCell(Sa.target,!1,!1),ha.moveToNextOrPreviousCell(Sa.source,!1,!1));Eb&&(this.EZ&&this.EZ.OGn(Sa.target,Sa.N_a),La.TableReader.isTable(Sa.target)||Sa.target.ld(14),this.pfn(Sa.target.currentNode),G.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return Eb}Nlo(){this.Fke=va.TableBorderSelectionCache.q$.bottomMostRowSelected;this.Sjg=
va.TableBorderSelectionCache.q$.rightMostColumnSelected;this.vFo=va.TableBorderSelectionCache.q$.leftMostColumnSelected;this.ywj=va.TableBorderSelectionCache.q$.topMostRowSelected}}Ya.sa=new y.a;Ya.ozf="PasteConstrainingWidth";Object(D.a)(Ya,"InternalClipboard",null,[])},1984:function(D,I,c){D=c(0);var l=c(2),f=c(127),a=c(60),k=c(241),x=c(22),y=c(19),m=c(86),r=c(190),z=c(16),v=c(46),G=c(6),F=c(7),H=c(69),L=c(42),J=c(31),M=c(304),P=c(88),N=c(12),K=c(5),O=c(103),V=c(18),W=c(36),T=c(250),Y=c(40),ba=
c(252),Z=c(21),ea=c(78),ha=c(148),la=c(884),ia=c(3),sa=c(81),Oa=c(61),Ra=c(9),Na=c(96),Da=c(43),ra=c(478),xa=c(443),fa=c(213),oa=c(17),ta=c(23),Ka=c(48),va=c(32),La=c(236),za=c(8),Ca=c(1566),ua=c(1588),ib=c(295),bb=c(170),mb=c(67),yb=c(508),ab=c(57);class Ga extends ib.a{constructor($a,Hb,Ya,Sa,Eb,Jb,vb,ac){super();this.Mdh=this.hw=null;this.init($a);this.Ml("FormattingViewOperation");this.Ujb(l.AFrameworkApplication.va,Hb,Sa,Eb,Jb);this._context=Ya;this.D9a=0;this.Qs=!0;this.l1j=vb;this.Zm=ac}get aca(){return this.Zm.instance}run(){const $a=
this._context.view;var Hb=null;$a.qe&&(Hb=$a.mb);if(Hb){var Ya=Hb.hb.lb,Sa=!ua.a.Ibc(this.actionId);!Ya||Ga.Uf.vGf(Ya,Sa)?(Ga.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.ZE}),this.Qs=!1):this.aca&&this.aca.Zbc(Ya)?(Ga.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.o1a}),this.Qs=!1):Ga.Xg.hAa(za.ParagraphReader.AU,Hb.ng)&&(Ga.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.yO}),this.Qs=!1)}else Ga.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.rda}),this.Qs=!1;1!==this.behavior&&this.Qs||(this.Qs&&(Ya=Hb.hb.lb,1===Hb.hb.length&&1===Ya.length&&oa.SelectionEditor.nl(Ya.Pa)&&
ea.b(Ya.Pa)&&(Ga.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.WIc}),this.Qs=!1)),(Ya=this.Qs)&&this.actionId===ia.a.E5&&((Ya=Array.from(Hb.hb.lb).some(O.FormattingReader.i9e))||Ga.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.wff})),this.qr=Ya?32:8,this.D9a=3);this.D9a||(bb.a.mark(5730),this.Mdh=yb.SelectionReferenceFactory.instance.NCb(),Ya=Hb.hb.lb.Pa,this.hw=new Da.GraphTransaction(15),this.hw.Db(Ya.node),this.hw.Qj=this.actionId,this.D9a=1);if(1===this.D9a){this.GC||this.t8c(this._context.ek);if(1===this.n6a())return;this.D9a=
2}if(2===this.D9a){if(this.actionId===ia.a.E5)if(Hb=Hb.ng,Hb.gx)for(Ya=0;Ya<Hb.length;Ya++)Sa=Hb.getContext(Ya),this.ABj(Sa);else this.ABj(Hb);ab.a.v9e&&this.aMo(this.actionId,this.Ad);this.Mdh.Rqa(this.actionId===ia.a.cZ||this.actionId===ia.a.Vua);(Hb=Object(H.a)(26,this.Ad))&&!Hb.cUa||mb.FocusManager.instance().kg($a.pJ);this.hw.dispose();this.hw=null;Ra.App.za.updateCommandUI();bb.a.mark(5731);this.D9a=3;this.qr=32}3===this.D9a&&(this.l1j.process(this.actionId,this._context,this.behavior,this.response),
this.hra())}aMo($a,Hb){const Ya={};Ya.FormattingActionId=$a;Ya.FormattingActionData=Hb;8===this.ga.Rb(ia.a.nCd,2,Ya)&&F.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",$a,Hb)}ABj($a){(oa.SelectionEditor.lv($a)||oa.SelectionEditor.Fk($a))&&Ra.App.xN.iea($a.node)}static get Uf(){return La.a.instance}static get Xg(){return fa.ContextSetEditor.instance}static get Hc(){return r.a.instance}}Object(D.a)(Ga,"FormattingViewOperation",ib.a,
[]);var Za=c(1046),Ub=c(950),Xb=c(74);c.d(I,"a",function(){return Ib});const zb=new Set([ia.a.m0,ia.a.z1,ia.a.JC,ia.a.pDa,ia.a.qDa,ia.a.K_a,ia.a.Sua,ia.a.L_a]);class Ib{constructor($a,Hb,Ya=null,Sa,Eb,Jb,vb,ac,dc,Cc,Ec,rc,hb){this.kpiName="ChangeCaseCommandUsage";this.I8="wwaengidc";this.zlb=new Map;this.H4g=new Set;this.VEb=()=>new la.a(2);this.Q3i=(fb,Nb,Fb,nb,pb)=>{nb=!0;Nb.contextId!==N.a.view&&(nb=!1);if(1===Fb&&!nb)return 8;if(fb===ia.a.h4c)fb=pb.formatting,pb=pb.Pgg;else{if(!Nb.view||!Nb.view.qe)return 2;
Nb=Nb.view;if(!Nb.mb||!Nb.mb.hb.lb)return 8;fb=pb;pb=Nb.mb.hb}this.K1k(pb,fb);return 32};this.T0e=(fb,Nb,Fb,nb,pb,Xa)=>new Ga(fb,Nb,Fb,nb,pb,Xa,this.S1j,Ib.fx());this.kCd=(fb,Nb,Fb,nb,pb)=>{var Xa,Pb,Va;let tb=!0,cb=Nb;const Mb=!ua.a.Ibc(fb);Nb.contextId!==N.a.Jd&&Nb.contextId!==N.a.Tc?tb=!1:(Ib.Uf.n9(cb,!1,Mb)&&(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.ZE}),tb=!1),Ib.fx()&&Ib.fx().instance&&Ib.fx().instance.EU(cb)&&(tb=!1),tb&&oa.SelectionEditor.nl(Nb)&&ea.b(cb)&&(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.WIc}),
tb=!1),za.ParagraphReader.AU(Nb)&&(Ib.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.yO}),tb=!1));if(1===Fb||!tb)return tb?32:8;if(Nb.contextId===N.a.Tc)return 2;(Nb=null===(Xa=this.Io)||void 0===Xa?void 0:Xa.KSd(cb))&&(cb=Nb);this.oso(fb)&&(Xa=oa.SelectionEditor.URb(cb),oa.SelectionEditor.ef(Xa)||(cb=Xa));Xa="boolean"===typeof pb&&pb;Nb=!1;(null===(Pb=this.raa)||void 0===Pb?0:Pb.annotateRange)&&(null===(Va=this.raa)||void 0===Va?0:Va.Ucc(cb.node))&&(Nb=this.w_(cb,fb,pb,Xa));Nb&&fb!==ia.a.E5||Ib.Cra.w_(cb,mc=>{this.qkc(mc,
fb,pb,cb.cpEnd)},Xa);cb.node.Dr&&(Pb=[Object.assign(new J.a,{name:"Source",string:"CharacterFormatting"})],L.a("TOCFormatting",!0,void 0,Pb));this.SGm(fb)&&this.GEd(cb,fb);nb&&Ca.a.Gqb&&(nb.As|=Ca.a.rib(cb.node));return 32};this.bbd=(fb,Nb,Fb)=>1!==Fb&&2===Fb?(this.zlb.set("Source","Shortcut"),fb=Nb.node.characterData.substr(Nb.cpBegin,Nb.cpEnd-Nb.cpBegin),Ib.PGf(fb,0,fb.length)?this.GEd(Nb,ia.a.pDa):Ib.USm(fb,fb.length)?this.GEd(Nb,ia.a.Sua):this.GEd(Nb,ia.a.qDa)):32;this.yfb=(fb,Nb,Fb)=>{let nb=
!0;fb=!ua.a.Ibc(fb);Nb.contextId!==N.a.Jd&&Nb.contextId!==N.a.Tc?nb=!1:(Ib.Uf.n9(Nb,!1,fb)&&(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.ZE}),nb=!1),nb&&oa.SelectionEditor.nl(Nb)&&ea.b(Nb)&&(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.WIc}),nb=!1),nb&&za.ParagraphReader.AU(Nb)&&(Ib.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.yO}),nb=!1));if(1===Fb||!nb)return nb?32:8;Nb=Nb.node;this.Ts.i4b(Nb,!1);Nb.Dr&&(Nb=[Object.assign(new J.a,{name:"Source",string:"ClearFormatting"})],L.a("TOCFormatting",!0,void 0,Nb));return 32};this.WHc=(fb,
Nb,Fb,nb,pb)=>{fb={};fb[Za.a.GJa]=6168;fb[Za.a.FJa]=6169;const Xa=Nb.view;var Pb=null;Xa.Vi&&(Pb=Xa);var Va=!0;let tb=32;Pb&&(Pb=Pb.mb.hb.lb)&&(Ib.Uf.vGf(Pb)?(Ib.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.ZE}),tb=8,Va=!1):1===Fb&&(tb=32,Va=!1));Va&&(Va=new Da.GraphTransaction(1===Fb?3:15),Va.Db(Xa.root),tb=Za.a.xqa(ia.a.yfb,Nb,Fb,nb,pb,fb,12),Va.dispose());return tb};this.a1e=(fb,Nb,Fb,nb,pb)=>{var Xa,Pb=!0,Va=32;const tb=!ua.a.Ibc(fb);Nb.contextId!==N.a.Tc?Pb=!1:Ib.Uf.n9(Nb,!1,tb)&&(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.ZE}),
Pb=!1);if(1===Fb||!Pb)return Pb?32:8;Fb=Nb.node;fb===ia.a.JC&&(Ib.Jn.XHc(Fb),this.Ts.IDh(Fb),Pb=this.nz.ZC(Fb).jj(this.nz.wordStyleIdNormal),this.Yu.YJ(Pb,Fb,!0));Fb=Ib.xj.ftf(Nb);!Fb&&(Pb=null===(Xa=this.Io)||void 0===Xa?void 0:Xa.KSd(Nb))&&(Nb=Pb,Fb=ta.SelectionFactory.Tn(Nb));if(Fb)Va=Ka.a.ICb(Fb),Va=l.AFrameworkApplication.va.Kf(Va,fb,2,!1,nb,pb);else{nb=Object(H.a)(26,pb);Xa=O.FormattingReader.Vr(Nb);if(!Xa)return 16;Xa=Xa.cache;switch(fb){case ia.a.font:Ib.$_h();if(nb&&nb.Ad){const {fontName:cb,
uea:Mb,bold:mc,italic:Cb}=Ib.Bpf(nb.Ad);Ib.xj.Tfe(cb);Ib.xj.udg(Mb);Object(ra.a)()&&(fb=1==mc,pb=1==Cb,fb||pb)&&(Ib.xj.EL(fb),Ib.xj.Wy(pb))}break;case ia.a.Xv:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Ib.xj.Xv(pb);break;case ia.a.gra:Ib.xj.Xv(pb);this.l1.VZa(pb)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ia.a.wga:Ib.xj.wga();break;case ia.a.cZ:F.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");
Ib.xj.oza(pb);break;case ia.a.v$:Ib.xj.oza(pb);this.l1.VZa(pb)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ia.a.Vua:Ib.xj.mFd();break;case ia.a.WA:Ib.$_h();Ib.xj.WA(nb.Ad);break;case ia.a.m0:fb=Ib.xj.FG(z.a.fontSize,Xa.fontSize);Ib.xj.WA(this.Be.m0(fb));break;case ia.a.z1:fb=Ib.xj.FG(z.a.fontSize,Xa.fontSize);Ib.xj.WA(this.Be.z1(fb));break;case ia.a.bold:fb=Ib.xj.FG(z.a.bold,Xa.isBold);Ib.xj.EL(!fb);break;case ia.a.Wy:fb=Ib.xj.FG(z.a.italic,
Xa.isItalic);Ib.xj.Wy(!fb);break;case ia.a.underline:fb=Ib.xj.FG(z.a.underline,Xa.isUnderline);Ib.xj.H5(!fb);break;case ia.a.Qja:Ib.xj.Qja(pb);break;case ia.a.superscript:fb=Ib.xj.FG(z.a.superscript,Xa.isSuperscript);Ib.xj.jra(!fb);break;case ia.a.subscript:fb=Ib.xj.FG(z.a.subscript,Xa.isSubscript);Ib.xj.pIa(!fb);break;case ia.a.strikethrough:fb=Ib.xj.FG(z.a.strikethrough,Xa.isStrikethrough);Ib.xj.Oja(!fb);break;case ia.a.Et:fb=Ib.xj.FG(v.a.Et,Xa.isDoubleStrikethrough);Ib.xj.Nfe(!fb);break;case ia.a.JC:Ib.xj.Q6a();
break;case ia.a.E5:pb.hasProperty(z.a.rL)&&Ib.xj.E5(pb.getValue(z.a.rL));pb.hasProperty(G.a.noProof)&&(fb=pb.getValue(G.a.noProof),Ib.xj.Lio(fb));break;default:this.H4g.has(fb)||(this.H4g.add(fb),(pb=f.ActionManager.mba(fb))&&pb.length||(pb="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${pb} (${fb})`))}}Ra.App.za.updateCommandUI();return Va};this.DT=(fb,Nb,Fb,nb,pb)=>{nb=Ib.Hc.Ap(ia.a.Dfo);var Xa=!0;Nb.contextId!==N.a.Uc&&
(Xa=!1);if(1===Fb||!Xa)return Xa?32:8;Fb=Nb.node;Xa=K.GraphIterator.eb(Nb.node);Xa.rd();Xa=Xa.Nha(4);if((Xa=!!Xa&&Ib.Fd.Uca(Xa))&&!Ra.App.uec)return 8;var Pb=!za.ParagraphReader.textLength(Fb);nb.properties.Z("Action",fb.toString());nb.properties.Z("ListContext",Xa.toString());nb.properties.Z("IsEmptyParagraph",Pb.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",fb,Xa,Pb);Xa=Fb.qa.last;this.QYn(Fb,fb);var Va=!!Xa.formatting;const tb=Fb.getValue(G.a.$va);
Pb=this.Ld.i1a(Fb);Va=!Va&&tb&&tb.equals(a.a.nil)?new ha.a(Xa,a.a.nil):Pb.yf(Pb.Kb);this.qkc(Pb,fb,pb,Xa.cp);P.a.instance.J(1)&&Ib.Bj.FPb(Fb,Xa,Nb.cpBegin,Nb.cpEnd,Va,Pb,Ib.Pd.tg);nb.end();return 32};this.Ima=(fb,Nb,Fb)=>{fb=!0;const nb=K.GraphIterator.eb(Nb.node);nb.rd();Nb.contextId===N.a.Uc&&nb.Nha(4)||(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.XJf}),fb=!1);return Ib.Fd.Uca(nb.currentNode)?1!==Fb&&fb?32:fb?32:8:8};this.Hqa=(fb,Nb,Fb,nb,pb)=>{fb=!0;Nb.contextId!==N.a.paragraph&&(fb=!1);if(1===Fb&&!fb)return 8;
Fb=Nb.node;-1!==pb.Ih?pb.Ih!==za.ParagraphReader.Kx(Fb)&&(pb.Ih=0):pb.Ih=za.ParagraphReader.Kx(Fb);fb=this.Zo.Hib(Fb);pb.It?(!pb.iqm&&this.lqm(pb.It,fb)&&2===pb.It.specialIndentType&&(pb.It.specialIndentType=0),pb.It.OHb===fb.OHb&&k.a.pxa(pb.It.KB,fb.KB)||(pb.It.KB=Number.MAX_VALUE),pb.It.PHb===fb.PHb&&k.a.pxa(pb.It.Voa,fb.Voa)||(pb.It.Voa=Number.MAX_VALUE)):pb.It=fb;Nb=Ib.Xg.Luh(Nb.ek);void 0!==Nb&&null!==Nb&&(Nb=Nb.node,void 0!==Nb&&null!==Nb&&(Nb=T.WordSectionNavigator.instance.OJ(Nb),void 0!==
Nb&&null!==Nb&&(Nb=Ib.Qf.Ft(Nb)-(Ib.Qf.xJ(Nb)+Ib.Qf.jL(Nb)+Ra.App.lAa),fb.MTc=Nb-fb.KB,fb.LTc=Nb-fb.Voa,pb.It.LTc=Math.min(pb.It.LTc,fb.LTc),pb.It.MTc=Math.min(pb.It.MTc,fb.MTc))));Nb=this.qW.hFa(Fb);pb.spacing?(pb.spacing.beforeSpacing=Ib.Aqh(Nb.beforeSpacing,pb.spacing.beforeSpacing),pb.spacing.afterSpacing=Ib.Aqh(Nb.afterSpacing,pb.spacing.afterSpacing),pb.spacing.lineSpacing.unit===Nb.lineSpacing.unit&&k.a.pxa(pb.spacing.lineSpacing.value,Nb.lineSpacing.value)||(pb.spacing.lineSpacing.unit=0,
pb.spacing.lineSpacing.value=0)):pb.spacing=Nb;Nb=new K.GraphIterator;Nb.set(Fb);Nb.zb(11);if(Fb=Nb.ld(11))pb.isRtl=Y.OutlineElementReader.In(Fb);Fb=Ib.Fd.tw(Nb);Nb=16;void 0!==Fb&&null!==Fb&&(Nb=Fb.listType);pb.listType=Ib.iSl(pb.listType,Nb);pb.Sx=16===pb.listType?null:Fb;return 32};this.uJn=(fb,Nb,Fb,nb,pb)=>{pb.isRtl=Y.OutlineElementReader.In(W.OutlineElementNavigator.Hl(Nb.node));return 32};this.zth=(fb,Nb,Fb)=>{if(fb===ia.a.aQb)fb=!0;else if(fb===ia.a.$Pb)fb=!1;else return 2;fb&&this.JJi(Nb);
if(1===Fb)return 32;this.mh.RPb(W.OutlineElementNavigator.Hl(Nb.node),fb);return 32};this.kJn=(fb,Nb,Fb,nb,pb)=>{fb=Nb.node;pb.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Hl(fb));pb.Ih=V.ImageReader.Kx(fb);return 32};this.uKn=(fb,Nb,Fb,nb,pb)=>{fb=Nb.node;pb.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Hl(fb));pb.Ih=va.TableReader.Kx(fb);-1!==pb.Ih&&pb.Ih||(pb.Ih=pb.isRtl?3:1);return 32};this.k1e=(fb,Nb,Fb,nb,pb)=>{let Xa;if(!({xy:Xa}=ua.a.Eeg(Fb,Nb)).returnValue)return Xa;
const Pb=Nb.node;switch(fb){case ia.a.$Pb:this.mh.Lkc(Pb,!1);break;case ia.a.aQb:this.JJi(Nb);this.mh.Lkc(Pb,!0);break;case ia.a.E5:Xa=l.AFrameworkApplication.va.Kf(Nb.ek,fb,Fb,!0,nb,pb),32===Xa&&za.ParagraphReader.nm(Nb)&&Ib.Q3c&&Ib.Q3c.iea(Pb)}return 32};this.FWk=(fb,Nb,Fb,nb,pb)=>{const Xa={};Xa[Za.a.GJa]=6168;Xa[Za.a.FJa]=6169;var Pb=Nb.view;const Va=new Da.GraphTransaction(1===Fb?3:15);Va.Db(Pb.root);let tb=Za.a.xqa(fb,Nb,Fb,nb,pb,Xa,0),cb=null;Pb.Vi&&(cb=Pb);Pb=!0;let Mb=null;cb&&(Mb=cb.mb.hb.lb)&&
(fb=!ua.a.Ibc(fb),Ib.Uf.vGf(Mb,fb)?(Ib.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.ZE}),tb=8,Pb=!1):1===Fb&&(tb=32,Pb=!1),Ib.Xg.hAa(za.ParagraphReader.AU,cb.mb.ng)&&(Ib.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.yO}),tb=8,Pb=!1));Pb&&this.ZSm(Mb)&&(tb=Za.a.xqa(ia.a.yfb,Nb,Fb,nb,pb,Xa,12));Va.dispose();return tb};this.EWk=(fb,Nb,Fb)=>{fb=!0;Nb.contextId!==N.a.paragraph&&Nb.contextId!==N.a.Tc?fb=!1:Ib.Uf.m4a(Nb)&&(Ib.Hc.Yb(sa.a.rn,{["Reason"]:Oa.a.ZE}),fb=!1);if(1===Fb||!fb)return fb?32:8;Nb=Nb.node;Fb=new Da.GraphTransaction(15);
Fb.Db(Nb);Ib.Jn.XHc(Nb);this.Ts.i4b(Nb,!0);this.Yu.f7e(Nb);Fb.dispose();return 2};this.Jlm=(fb,Nb,Fb)=>{fb=!0;Nb.contextId!==N.a.view&&(fb=!1);if(1===Fb&&!fb)return 8;if(!Nb.view||!Nb.view.qe)return 2;Nb=Nb.view;if(!Nb.mb||!Nb.mb.hb.lb)return 8;if(Ib.Xg.hAa(za.ParagraphReader.AU,Nb.mb.ng))return Ib.Hc.Yb(sa.a.Ye,{["Reason"]:Oa.a.yO}),8;Nb=Nb.mb.hb;for(const nb of Nb)for(const pb of nb)if(pb&&pb.contextId!==N.a.Jd&&pb.contextId!==N.a.Tc&&pb.contextId!==N.a.paragraph&&pb.contextId!==N.a.Uc)return 2;
return 32};this.u6a=(fb,Nb,Fb,nb,pb)=>{fb=!0;Nb.contextId!==N.a.paragraph&&(fb=!1);if(1===Fb&&!fb)return 8;pb.It||(Nb=Nb.node,Fb=this.Zo.Hib(Nb),pb.It=Fb,Nb=W.OutlineElementNavigator.Hl(Nb),pb.isRtl=Nb?Y.OutlineElementReader.In(Nb):!1);return 32};this.vKn=(fb,Nb,Fb,nb,pb)=>{Nb=Nb.node;fb=W.OutlineElementNavigator.Hl(Nb);pb.It||(Nb=this.P6l(Nb),Nb=this.Zo.Hib(Nb),pb.It=Nb,pb.isRtl=Y.OutlineElementReader.isRtl(fb));return 32};this.S1j=$a;this.raa=Hb;this.U6=Ya;this.Io=Sa;this.Be=Eb;this.Ld=Jb;this.Ts=
vb;this.qW=ac;this.Yu=Cc;this.nz=dc;this.mh=Ec;this.Zo=hb}get l1(){return null!=this.IEg?this.IEg:this.IEg=x.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get mOd(){return!!this.U6&&this.U6.enabled}Tb(){const $a=l.AFrameworkApplication.va,Hb=this.uJn;(Ib.Zb?Ib.Zb.NB(43):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?($a.ra(ia.a.font,N.a.Uc,this.DT),$a.ra(ia.a.WA,N.a.Uc,this.DT),$a.ra(ia.a.m0,N.a.Uc,this.DT),$a.ra(ia.a.z1,N.a.Uc,this.DT),$a.ra(ia.a.Xv,
N.a.Uc,this.DT),$a.ra(ia.a.gra,N.a.Uc,this.DT),$a.ra(ia.a.wga,N.a.Uc,this.DT),$a.ra(ia.a.cZ,N.a.Uc,this.DT),$a.ra(ia.a.v$,N.a.Uc,this.DT),$a.ra(ia.a.Vua,N.a.Uc,this.DT),$a.ra(ia.a.bold,N.a.Uc,this.DT),$a.ra(ia.a.Wy,N.a.Uc,this.DT),$a.ra(ia.a.underline,N.a.Uc,this.DT),$a.ra(ia.a.Qja,N.a.Uc,this.DT),$a.ra(ia.a.superscript,N.a.Uc,this.DT),$a.ra(ia.a.subscript,N.a.Uc,this.DT),$a.ra(ia.a.strikethrough,N.a.Uc,this.DT),$a.ra(ia.a.Et,N.a.Uc,this.DT),$a.ra(ia.a.E5,N.a.Uc,this.DT),$a.ra(ia.a.JC,N.a.Uc,this.DT)):
Ra.App.uec&&($a.ra(ia.a.font,N.a.Uc,this.Ima),$a.ra(ia.a.WA,N.a.Uc,this.Ima),$a.ra(ia.a.Xv,N.a.Uc,this.Ima),$a.ra(ia.a.gra,N.a.Uc,this.Ima),$a.ra(ia.a.wga,N.a.Uc,this.Ima),$a.ra(ia.a.bold,N.a.Uc,this.Ima),$a.ra(ia.a.Wy,N.a.Uc,this.Ima),$a.ra(ia.a.superscript,N.a.Uc,this.Ima),$a.ra(ia.a.subscript,N.a.Uc,this.Ima),$a.ra(ia.a.strikethrough,N.a.Uc,this.Ima),$a.ra(ia.a.Et,N.a.Uc,this.Ima),$a.ra(ia.a.m0,N.a.Uc,this.Ima),$a.ra(ia.a.z1,N.a.Uc,this.Ima));const Ya=Ra.App.JUa.HJc(Sa=>xa.OutlineElementGeneralizer.nha(Sa.hb,
!0));$a.fb(ia.a.f6e,N.a.view,this.Jlm,100);$a.fb(ia.a.bbd,N.a.Jd,this.bbd,1028);$a.ra(ia.a.r6a,N.a.view,this.Q3i);$a.ra(ia.a.h4c,N.a.view,this.Q3i);$a.ra(ia.a.Hqa,N.a.view,Ya);$a.ra(ia.a.Hqa,N.a.paragraph,this.Hqa);$a.ra(ia.a.Hqa,N.a.image,this.kJn);$a.ra(ia.a.Hqa,N.a.unsupportedObject,Hb);$a.ra(ia.a.Hqa,N.a.table,this.uKn);$a.ra(ia.a.u6a,N.a.view,Ya);$a.ra(ia.a.u6a,N.a.paragraph,this.u6a);$a.ra(ia.a.u6a,N.a.table,this.vKn);$a.Xc(ia.a.r6a,99);$a.Xc(ia.a.h4c,1127);$a.Xc(ia.a.Hqa,97);$a.Xc(ia.a.u6a,
97);this.qM($a,ia.a.font);this.qM($a,ia.a.WA);this.qM($a,ia.a.m0);this.qM($a,ia.a.z1);$a.leb(ia.a.x0h,N.a.view,this.T0e);$a.Xc(ia.a.x0h,1092);this.qM($a,ia.a.Xv);this.qM($a,ia.a.gra);this.qM($a,ia.a.wga);this.qM($a,ia.a.cZ);this.qM($a,ia.a.v$);this.qM($a,ia.a.K_a);this.qM($a,ia.a.pDa);this.qM($a,ia.a.qDa);this.qM($a,ia.a.Sua);this.qM($a,ia.a.L_a);this.qM($a,ia.a.Vua);this.qM($a,ia.a.bold);$a.xPb(ia.a.bold,this.VEb);this.qM($a,ia.a.Wy);$a.xPb(ia.a.Wy,this.VEb);this.qM($a,ia.a.underline);$a.xPb(ia.a.underline,
this.VEb);this.qM($a,ia.a.Qja);this.qM($a,ia.a.superscript);$a.xPb(ia.a.superscript,this.VEb);this.qM($a,ia.a.subscript);$a.xPb(ia.a.subscript,this.VEb);this.qM($a,ia.a.strikethrough);$a.xPb(ia.a.strikethrough,this.VEb);this.qM($a,ia.a.Et);$a.xPb(ia.a.Et,this.VEb);$a.fb(ia.a.BQa,N.a.Jd,this.kCd,96);$a.leb(ia.a.E5,N.a.view,this.T0e);$a.ra(ia.a.E5,N.a.paragraph,this.k1e);$a.ra(ia.a.E5,N.a.Jd,this.kCd);$a.ra(ia.a.E5,N.a.Tc,this.a1e);$a.ra(ia.a.JC,N.a.view,this.FWk);$a.ra(ia.a.JC,N.a.paragraph,this.EWk);
$a.ra(ia.a.JC,N.a.Jd,this.kCd);$a.ra(ia.a.JC,N.a.Tc,this.a1e);$a.Xc(ia.a.JC,1036);$a.ra(ia.a.yfb,N.a.Jd,this.yfb);$a.ra(ia.a.yfb,N.a.Tc,this.yfb);$a.ra(ia.a.WHc,N.a.view,this.WHc);$a.ra(ia.a.$Pb,N.a.view,ua.a.jw);$a.ra(ia.a.$Pb,N.a.paragraph,this.k1e);$a.ra(ia.a.$Pb,N.a.unsupportedObject,this.zth);$a.Xc(ia.a.$Pb,1028);$a.ra(ia.a.aQb,N.a.view,ua.a.jw);$a.ra(ia.a.aQb,N.a.paragraph,this.k1e);$a.ra(ia.a.aQb,N.a.unsupportedObject,this.zth);$a.Xc(ia.a.aQb,1028)}qM($a,Hb){$a.leb(Hb,N.a.view,this.T0e);$a.ra(Hb,
N.a.Jd,this.kCd);$a.ra(Hb,N.a.Tc,this.a1e);$a.Xc(Hb,1036)}K1k($a,Hb){for(const ac of $a)for(const dc of ac){$a=null;if(dc.contextId===N.a.Jd){if(ea.b(dc))continue;$a=[];var Ya=dc.node.qa;if(Ya){var Sa=Ya.length-1;const Cc=dc.cpBegin,Ec=dc.cpEnd;let rc=!1;const hb=dc.node.characterData;if(hb&&""!==hb){var Eb=hb.substr(Cc,Ec-Cc);Eb&&""!==Eb&&y.a.q9e(Eb,0,Eb.length)&&(rc=!0)}Eb=!1;for(let fb=0;fb<Sa;fb++){var Jb=Ya.J(fb).cp,vb=Ya.J(fb+1).cp;if(Ya.J(fb).formatting&&Math.max(Jb,Cc)<Math.min(vb,Ec)){if(hb&&
""!==hb&&(Jb=Jb<Cc?Cc:Jb,vb=hb.substr(Jb,(vb<Ec?vb:Ec)-Jb),!rc&&y.a.q9e(vb,0,vb.length)))continue;Eb=!0;$a.push(Ya.J(fb).formatting)}else if(Eb)break}Ya.J(Sa).formatting&&dc.cpEnd>Ya.J(Sa).cp&&$a.push(Ya.J(Sa).formatting)}}else if(dc.contextId===N.a.paragraph&&!za.ParagraphReader.AU(dc)){if($a=[],Ya=dc.node.qa)for(Sa=0;Sa<Ya.length;Sa++)Ya.J(Sa).formatting&&$a.push(Ya.J(Sa).formatting)}else if(dc.contextId===N.a.Uc)$a=[O.FormattingReader.Vr(dc)];else if(dc.contextId===N.a.Tc){this.TIn(dc,Hb);return}if($a&&
0<$a.length)for(const Cc of $a)if(O.FormattingReader.Ing(Hb,Cc.cache,dc))return}}TIn($a,Hb){if($a=O.FormattingReader.Vr($a)){$a=$a.cache;var Ya=Ib.xj.FG(z.a.bold,$a.isBold);Hb.bold=Ya?1:0;Ya=Ib.xj.FG(z.a.italic,$a.isItalic);Hb.italic=Ya?1:0;Ya=Ib.xj.FG(z.a.underline,$a.isUnderline);Hb.underline=Ya?1:0;Hb.underlineType=Ib.xj.FG(z.a.underlineType,$a.underlineType);Ya=Ib.xj.FG(z.a.superscript,$a.isSuperscript);Hb.superscript=Ya?1:0;Ya=Ib.xj.FG(z.a.subscript,$a.isSubscript);Hb.subscript=Ya?1:0;Ya=Ib.xj.FG(z.a.strikethrough,
$a.isStrikethrough);Hb.strikethrough=Ya?1:0;Ya=Ib.xj.FG(v.a.Et,$a.isDoubleStrikethrough);Hb.Et=Ya?1:0;Ya=Ib.xj.FG(z.a.font,$a.zG);Hb.fontName=Na.a.a2a(Ya);Hb.uea=$a.Ee;Hb.fontSize=Ib.xj.FG(z.a.fontSize,$a.fontSize);Hb.fontColor=Ib.xj.FG(z.a.fontColor,$a.fontColor);Hb.highlight=Ib.xj.FG(z.a.highlight,$a.highlight)}}oso($a){return $a===ia.a.underline||$a===ia.a.Qja||$a===ia.a.strikethrough||$a===ia.a.Et||$a===ia.a.cZ}static Bpf($a){return"string"===typeof $a?{fontName:$a,uea:-1,bold:2,italic:2}:$a}w_($a,
Hb,Ya,Sa){var Eb;const Jb=$a.cpBegin,vb=$a.cpEnd,ac=$a.node;var dc=O.FormattingReader.Vr($a);let Cc=Jb;const Ec=null===(Eb=l.AFrameworkApplication.K)||void 0===Eb?void 0:Eb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);Eb=Ib.Pd.tg;if(Ec&&(Eb||ac.Gs))return!1;if(zb.has(Hb))for(const rc of ac.qa)if(!(rc.cp<=Jb)){if(rc.cp>=vb)break;rc.formatting&&rc.formatting.cache.fontSize!=dc.cache.fontSize&&(dc=this.Gpf($a.node,dc,Hb,Ya,Ec?null:Sa),this.raa.annotateRange($a.node,
Ec?ac.qa.V0a(Cc):Cc,Ec?ac.qa.V0a(rc.cp):rc.cp,dc),Cc=rc.cp,dc=rc.formatting)}Hb=this.Gpf($a.node,dc,Hb,Ya,Ec?null:Sa);this.raa.annotateRange($a.node,Ec?ac.qa.V0a(Cc):Cc,Ec?ac.qa.V0a(vb):vb,Hb);return!0}Gpf($a,Hb,Ya,Sa,Eb){const Jb={},vb=Object(H.a)(26,Sa),ac=Hb.cache;switch(Ya){case ia.a.bold:2===Sa.value&&(Sa.value=ac.isBold?0:1);Jb[z.a.bold.id]=1===Sa.value;break;case ia.a.Wy:2===Sa.value&&(Sa.value=ac.isItalic?0:1);Jb[z.a.italic.id]=1===Sa.value;break;case ia.a.underline:2===Sa.value&&(Sa.value=
ac.isUnderline?0:1);Jb[z.a.underline.id]=1===Sa.value;break;case ia.a.Qja:Jb[z.a.underlineType.id]=Sa.number;break;case ia.a.superscript:2===Sa.value&&(Sa.value=ac.isSuperscript?0:1);Jb[z.a.superscript.id]=1===Sa.value;1===Sa.value&&(Jb[z.a.subscript.id]=!1);break;case ia.a.subscript:2===Sa.value&&(Sa.value=ac.isSubscript?0:1);Jb[z.a.subscript.id]=1===Sa.value;1===Sa.value&&(Jb[z.a.superscript.id]=!1);break;case ia.a.strikethrough:6!==l.AFrameworkApplication.va.KC?F.ULS.sendTraceTag(529090079,340,
50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Sa.value&&(Sa.value=ac.isStrikethrough?0:1);Jb[z.a.strikethrough.id]=1===Sa.value;break;case ia.a.Et:2===Sa.value&&(Sa.value=ac.isDoubleStrikethrough?0:1);Jb[v.a.Et.id]=1===Sa.value;break;case ia.a.font:if(vb&&vb.Ad){const {fontName:Cc,uea:Ec,bold:rc,italic:hb}=Ib.Bpf(vb.Ad);Sa=Cc.substr(0,Ib.eMi);this.mOd&&(Jb[G.a.GT.id]=Sa,Jb[G.a.NC.id]=Sa,Jb[G.a.P_.id]=Sa,Jb[G.a.o0.id]=
Sa,Jb[G.a.Ie.id]=Ec,Jb[G.a.Ve.id]=Ec,Jb[G.a.Fe.id]=Ec,Jb[G.a.Je.id]=Ec);Jb[z.a.font.id]=Sa;Jb[G.a.Ee.id]=Ec;if(Object(ra.a)()){Sa=1==rc;var dc=1==hb;if(Sa||dc)Jb[z.a.bold.id]=Sa,Jb[z.a.italic.id]=dc}}break;case ia.a.Xv:Sa=Ub.a.instance.cva($a,Sa);Jb[z.a.fontColor.id]=Sa;break;case ia.a.gra:dc=Ub.a.instance.cva($a,Sa);Jb[z.a.fontColor.id]=dc;this.l1.VZa(Sa)||F.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ia.a.wga:Jb[z.a.fontColor.id]=Xb.a.auto;
break;case ia.a.cZ:Jb[z.a.highlight.id]=parseInt(Sa,16);break;case ia.a.v$:Jb[z.a.highlight.id]=parseInt(Sa,16);this.l1.VZa(Sa)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ia.a.Vua:Jb[z.a.highlight.id]=Xb.a.auto;break;case ia.a.WA:Jb[z.a.fontSize.id]=this.Be.I4b(vb.Ad);break;case ia.a.m0:Jb[z.a.fontSize.id]=this.IZl(ac.fontSize);break;case ia.a.z1:Jb[z.a.fontSize.id]=this.WSl(ac.fontSize);break;case ia.a.BQa:if(Sa=null===(dc=Ib.dA)||
void 0===dc?void 0:dc.BQa)for(const Cc of Sa.Jl())Jb[Cc.id]=Sa.rf(Cc);break;case ia.a.JC:if(Sa=Hb.En)for(const Cc of Sa.Jl())Jb[Cc.id]=null;Jb[G.a.QBb.id]=!0;break;case ia.a.pDa:case ia.a.qDa:case ia.a.K_a:case ia.a.Sua:case ia.a.L_a:ac.$Pa&&2===ac.capitalization&&(Jb[v.a.capitalization.id]=0)}null!=Eb&&(Jb[l.AFrameworkApplication.Ilf]=Eb);return Jb}IZl($a){$a=this.Be.m0($a);return this.Be.I4b($a)}WSl($a){$a=this.Be.z1($a);return this.Be.I4b($a)}qkc($a,Hb,Ya,Sa){var Eb=$a.cache;const Jb=Object(H.a)(26,
Ya);switch(Hb){case ia.a.bold:2===Ya.value&&(Ya.value=Eb.isBold?0:1);this.Be.EL($a,1===Ya.value);break;case ia.a.Wy:2===Ya.value&&(Ya.value=Eb.isItalic?0:1);this.Be.Wy($a,1===Ya.value);break;case ia.a.underline:2===Ya.value&&(Ya.value=Eb.isUnderline?0:1);this.Be.H5($a,1===Ya.value);break;case ia.a.Qja:this.Be.Qja($a,Ya);break;case ia.a.superscript:2===Ya.value&&(Ya.value=Eb.isSuperscript?0:1);this.Be.jra($a,1===Ya.value);break;case ia.a.subscript:2===Ya.value&&(Ya.value=Eb.isSubscript?0:1);this.Be.pIa($a,
1===Ya.value);break;case ia.a.strikethrough:6!==l.AFrameworkApplication.va.KC?F.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Ya.value&&(Ya.value=Eb.isStrikethrough?0:1);this.Be.Oja($a,1===Ya.value);break;case ia.a.Et:2===Ya.value&&(Ya.value=Eb.isDoubleStrikethrough?0:1);this.Be.Nfe($a,1===Ya.value);break;case ia.a.font:if(Jb&&Jb.Ad){const {fontName:vb,uea:ac,bold:dc,italic:Cc}=Ib.Bpf(Jb.Ad);
this.Be.Kja($a,vb.substr(0,Ib.eMi));this.Be.udg($a,ac);Object(ra.a)()&&(Ya=1==dc,Sa=1==Cc,Ya||Sa)&&(this.Be.EL($a,Ya),this.Be.Wy($a,Sa))}break;case ia.a.Xv:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.Be.Xv($a,Ya,null);break;case ia.a.gra:this.Be.Xv($a,Ya,null);this.l1.VZa(Ya)||F.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ia.a.wga:this.Be.wga($a);break;case ia.a.cZ:F.ULS.sendTraceTag(594899726,
340,50,"Font background color is selected from Standard colors.");this.Be.oza($a,Ya);break;case ia.a.v$:this.Be.oza($a,Ya);this.l1.VZa(Ya)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ia.a.Vua:this.Be.mFd($a);break;case ia.a.WA:this.Be.WA($a,Jb.Ad);break;case ia.a.m0:this.Be.qki($a);break;case ia.a.z1:this.Be.Arj($a);break;case ia.a.E5:Eb=Ya.ja(G.a.noProof,!1);this.Be.xcg($a,Ya.getValue(z.a.rL),Sa,Eb);break;case ia.a.BQa:this.Be.Vfe($a);
break;case ia.a.JC:this.Be.vga($a);break;case ia.a.pDa:case ia.a.qDa:case ia.a.K_a:case ia.a.Sua:case ia.a.L_a:Eb.$Pa&&2===Eb.capitalization&&this.Be.sWk($a)}}QYn($a,Hb){ia.a.JC===Hb&&W.OutlineElementNavigator.Hl($a).properties.removeProperty(z.a.c1)}lqm($a,Hb){return this.Rth($a,Hb)||this.Rth(Hb,$a)}Rth($a,Hb){return(1===$a.specialIndentType||!$a.specialIndentType)&&2===Hb.specialIndentType}P6l($a){$a=K.GraphIterator.eb($a);$a.zb(11);Z.moveToCell($a,0,0);$a.Qd();$a.$X();return $a.currentNode}ZSm($a){return!$a||
oa.SelectionEditor.Il($a)||1===$a.length&&oa.SelectionEditor.nl($a.Pa)&&!oa.SelectionEditor.Bkb($a.Pa)?!1:!0}JJi($a){Ib.Zch.nb($a.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",$a.contextId),Ib.Zch.Z($a.contextId,!0))}SGm($a){return $a===ia.a.K_a||$a===ia.a.pDa||$a===ia.a.qDa||$a===ia.a.Sua||$a===ia.a.L_a}GEd($a,Hb){const Ya=$a.node,Sa=Ya.characterData.substr($a.cpBegin,$a.cpEnd-$a.cpBegin);this.zlb.set("Command",Hb.toString());m.Health.instance.recordKpiUsage(this.kpiName,1,this.I8,
this.zlb);Hb=Ib.DGo(Sa,Hb);Ya.dra(Ya.characterData.substr(0,$a.cpBegin)+Hb+Ya.characterData.substr($a.cpEnd));return 32}static get xj(){return Ib.dA||(Ib.dA=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static fx(){return Ib.Zm||(Ib.Zm=x.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Xg(){return fa.ContextSetEditor.instance}static get Uf(){return La.a.instance}static get Hc(){return r.a.instance}static get Zb(){return null!=Ib.Txg?Ib.Txg:Ib.Txg=x.a.instance.Oa("Box4.IFeatureHelper")}static get Q3c(){return Ra.App.xN}static get Pd(){return null!=
Ib.sHg?Ib.sHg:Ib.sHg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Bj(){return null!=Ib.UGg?Ib.UGg:Ib.UGg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Cra(){return null!=Ib.xGg?Ib.xGg:Ib.xGg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Fd(){return null!=Ib.SCg?Ib.SCg:Ib.SCg=x.a.instance.resolve("Box4.List.IListReader")}static get Jn(){return null!=Ib.ECg?Ib.ECg:Ib.ECg=x.a.instance.resolve("Box4.List.IListEditor")}static get Qf(){return ba.a.instance}static iSl($a,
Hb){return 42===$a?Hb:$a!==Hb||16===$a?16:$a}static Aqh($a,Hb){$a.Yui||(Hb.Yui?Hb=$a:Hb.unit===$a.unit&&k.a.pxa(Hb.value,$a.value)||(Hb.value=-1));return Hb}static DGo($a,Hb){switch(Hb){case ia.a.pDa:return $a.toLowerCase();case ia.a.qDa:return 6!==l.AFrameworkApplication.va.KC?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),$a.toUpperCase();case ia.a.K_a:case ia.a.Sua:return Ib.hTk($a,Hb===
ia.a.Sua);case ia.a.L_a:return Ib.UIo($a);default:return $a}}static UIo($a){let Hb="";for(let Ya=0;Ya<$a.length;Ya++)Hb=$a.charAt(Ya)===$a.charAt(Ya).toUpperCase()?Hb+$a.charAt(Ya).toLowerCase():Hb+$a.charAt(Ya).toUpperCase();return Hb}static hTk($a,Hb){let Ya,Sa,Eb=!0,Jb=$a.length,vb=0,ac=Ib.PGf($a,vb,Jb);for(;0<Jb;){Sa=Ya=!1;var dc=Jb;let Ec;var Cc=void 0;for(Cc=0;0<dc&&Ib.DVk($a.charAt(vb+Cc));Cc++,dc--)Sa=Ib.V_d($a.charAt(vb+Cc));for(Ec=Cc;0<dc&&!(Ya=Ib.V_d($a.charAt(vb+Cc)))&&" "!==$a.charAt(vb+
Cc)&&"/"!==$a.charAt(vb+Cc);Cc++,dc--);dc=Cc-Ec;if(0>=dc)break;vb+=Ec;Cc=$a.substr(vb,dc);Cc=Cc===Cc.toUpperCase();if(ac||!Cc)$a=Eb||Sa||Hb?$a.substr(0,vb)+$a.charAt(vb).toUpperCase()+$a.substr(vb+1,dc-1).toLowerCase()+$a.substr(vb+dc):$a.substr(0,vb)+$a.substr(vb,dc).toLowerCase()+$a.substr(vb+dc);Jb-=dc+Ec;vb+=dc;if(Eb=Ya)vb++,Jb--,ac=Ib.PGf($a,vb,Jb)}return $a}static PGf($a,Hb,Ya){for(;0<Ya&&!Ib.V_d($a.charAt(Hb));){if($a.charAt(Hb)!==$a.charAt(Hb).toUpperCase())return!1;Hb++;Ya--}return!0}static USm($a,
Hb){for(var Ya=0;0<Hb&&!Ib.V_d($a.charAt(Ya));){if($a.charAt(Ya)!==$a.charAt(Ya).toLowerCase())return!1;Ya++;Hb--}return!0}static V_d($a){return"."===$a||"!"===$a||"?"===$a?!0:!1}static DVk($a){return-1==="0123456789".indexOf($a)&&$a.toUpperCase()===$a.toLowerCase()}static $_h(){const $a=x.a.instance.Ta("Common.ISystemInitiatedFeedback");$a&&$a.execute(Hb=>{Hb.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}Ib.Zch=new M.a;Ib.dA=null;Ib.Zm=null;Ib.eMi=31;Object(D.a)(Ib,"TextFormattingActor",
null,[])},2044:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.chrome=0]="chrome";f[f.edge=1]="edge";f[f.firefox=2]="firefox";f[f.IE=3]="IE";f[f.safari=4]="safari";f[f.others=5]="others";f[f.unknown=6]="unknown";f[f.electron=7]="electron";f[f.chromiumEdge=8]="chromiumEdge";f[f.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(D.b)("BrowserCode",l)},2046:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=
0}}Object(D.a)(l,"AtMentionAttributes",null,[])},2053:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(f){f[f.initial=0]="initial";f[f.startSearch=1]="startSearch";f[f.searching=2]="searching";f[f.searchComplete=3]="searchComplete";f[f.replaceAllInProgress=4]="replaceAllInProgress";f[f.replaceAllComplete=5]="replaceAllComplete";f[f.tooManyResults=6]="tooManyResults";f[f.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(D.b)("FindReplaceViewType",l)},2055:function(D,I,c){c.d(I,
"a",function(){return l});var l;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(l||(l={}))},2073:function(D,I,c){function l(b,h){h=Object.assign(new ha.a,{name:"LinkType",string:h});f(Ob.a.sBm,b,[h])}function f(b,h,u,B=!0){h&&h.UILocation&&Object(Fe.d)(b,B,Fe.e,0,h.UILocation,0,u)}function a(b,h){const u=Ga.a.instance;return new wA(b,h,u.Re("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,
u.Re("WordEditor.Bookmark.FullBookmarkManager").value,u.resolve("Box4.IHyperlinkStrategy"),u.resolve("Box4.IHyperlinkEditor"),u.resolve("Box4.ICharacterPropertiesEditor"),u.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,u.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,nr.a.instance,u.Oa("Box4.IInternalLinkManager"))}function k(b,h){var u;return b===Us.none?"none":null===(u=AA[b])||void 0===u?void 0:u[h]}function x(){const b=Ga.a.instance.Oa("WordEditor.Gc2Inline.IWordEditHostFactory");
void 0===b&&r.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Ga.a.instance.Oa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&r.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}c.r(I);var m=c(0),r=c(7),z=c(54),v=c(2),G=c(34),F=c(19),H=c(165),L=c(87);class J{constructor(b){this.$kg=0;this.yHb=this.Shc=this.pUa=null;this.jS=v.AFrameworkApplication.ua.Iq;
this.hY=b;this.hY.Fv(L.a.njj);this.hY.bC(L.a.njj,Object(z.a)(this,this.gqn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.yHb)return r.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.yHb;this.pUa=this.jS.Vf("ComponentAttach","getCustomAuthConfig");return this.yHb=new Promise((b,h)=>{const u={};let B=!1,Q=!1,ca=0;this.$kg=window.setInterval(()=>{4>ca?(ca++,this.hY.sendMessage(L.a.getCustomAuthConfig,u)):(window.clearInterval(this.$kg),B=!0,r.ULS.sendTraceTag(588087303,
344,10,G.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.Shc=(qa,Qa)=>{window.clearInterval(this.$kg);B||Q||(Q=!0,qa?(r.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(qa)):(r.ULS.sendTraceTag(589050654,369,10,G.c({["error"]:Qa.toString()})),h(Qa)))};this.hY.sendMessage(L.a.getCustomAuthConfig,u)})}gqn(b){try{const h=G.a(b.Values[H.a.uOk]);let u=v.AFrameworkApplication.K.kb("Application")||"";u=F.a.Zg(u);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
u+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+u+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+u+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+u+"%3Facctsw%3D1";this.pUa&&(this.pUa.stop(),this.pUa=null);this.Shc(h,"")}catch(h){r.ULS.sendTraceTag(589050655,344,10,G.c({["error"]:h.message,["stack"]:h.stack})),this.Shc(null,h.message)}}}Object(m.a)(J,"AccountSwitchingManager",
null,[143]);var M=c(181);class P{get name(){return"Common.App.AccountSwitching"}wc(b){b.register(J,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().Sd(()=>new J(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){M.a.instance.Gc(new P)}}Object(m.a)(P,"AccountSwitchingPackage",null,[1,2]);var N;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";
b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(N||(N={}));Object(m.b)("ErrorCodes",
N);c(1819);class K{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(m.a)(K,"OutstandingRequest",null,[]);class O{}O.Sen="AADSTS50058";O.invalidResourceUrl="AADSTS50001";O.Len="AADSTS65001";O.yfn="AADSTS70011";O.userAborted="13002";O.xCn="Popup Window is null";O.wCn="Popup Window closed";O.adalTimeout="Token renewal operation failed due to timeout";O.cJo="tokenRevoked";Object(m.a)(O,"WopiHostErrorType",null,[]);var V=c(466),W=
c(60),T=c(1818);class Y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(m.a)(Y,"WopiIdentityInfo",null,[806]);class ba{constructor(b,h,u){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=u}}Object(m.a)(ba,"WopiIdentityToken",null,[805]);var Z=c(20),ea=c(188),ha=c(31),la=c(172);class ia{constructor(b){this._initialized=!1;this.Sgc={};this.Eje={};this.jS=v.AFrameworkApplication.ua.Iq;
this.Hyf=b}lhb(b){this._initialized||(b.Fv(L.a.Jhc),b.bC(L.a.Jhc,Object(z.a)(this,this.fqn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,u=null){this.jda(b,h);return new Promise((B,Q)=>{if(this.YBf(h))if(h in this.Sgc)Q("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{r.ULS.sendTraceTag(37856032,344,10,G.c({["error"]:"Request timeout.",["callerId"]:h}));Q("timeout")},12E4);this.smf(b,h,u,(qa,Qa)=>{window.clearTimeout(ca);qa?B(qa):(r.ULS.sendTraceTag(37856033,369,
15,G.c({["error"]:N[Qa]})),Q(Qa))})}else r.ULS.sendTraceTag(37856034,344,10,G.c({["error"]:"Caller is not allowed."})),Q("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,u)=>{this.YBf(b)?this.U8l((B,Q)=>{B?h(B):(r.ULS.sendTraceTag(37856064,369,10,G.c({["error"]:Q.toString()})),u(Q))}):(r.ULS.sendTraceTag(37856065,344,10,G.c({["error"]:"Caller is not allowed."})),u("notAllowed"))})}getAuthContext(b){return new Promise((h,u)=>{const B=this.getAuthContextSync(b);B?h(B):u("notAllowed")})}getAuthContextSync(b){if(this.YBf(b)){const h=
new T.a;h.upn=v.AFrameworkApplication.K.kb("UserPrincipalName");h.userId=v.AFrameworkApplication.K.kb("LoggableUserId");h.authority=v.AFrameworkApplication.K.kb("HostAuthAuthority");h.tenantId=v.AFrameworkApplication.K.kb("TenantId");h.isAnonymous=v.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.stm(b);b=v.AFrameworkApplication.K.kb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}r.ULS.sendTraceTag(40751647,344,10,G.c({["error"]:"Caller is not allowed."}));
return null}stm(b){const h=V.OAuthManagerSettings.USc;return Z.a.jRa?h&&V.OAuthManagerSettings.Jwj?Array.contains(V.OAuthManagerSettings.Jwj,b.toLowerCase()):!1:h}smf(b,h,u,B){var Q=[];Array.add(Q,Object.assign(new ha.a,{name:"CallerId",string:h}));Array.add(Q,Object.assign(new ha.a,{name:H.a.vhg,string:b.correlationId}));ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Q}));Q=W.a.create().toString();const ca="getAccessToken_"+
Q,qa=this.jS.Vf("ComponentAttach",ca);this.Eje[ca]=qa;const Qa={};Qa[H.a.whg]=Q;Qa[H.a.szo]=b.resource;Qa[H.a.tzo]=b.scope;Qa[H.a.otj]=v.AFrameworkApplication.K.kb("HostAuthType");Qa[H.a.wzo]=v.AFrameworkApplication.K.kb("UserPrincipalName");Qa[H.a.uzo]=b.silentLogin;Qa[H.a.pzo]=b.options;Qa[H.a.vhg]=b.correlationId;Qa[H.a.qzo]=h;u&&(Qa[H.a.addinName]=u.AddinName,Qa[H.a.ozo]=u.AddinTrustId);this.Hyf.execute(rb=>{this.lhb(rb);rb.sendMessage(L.a.getAuthToken,Qa)});this.Sgc[Q]=new K(b,B)}U8l(b){const h=
v.AFrameworkApplication.K.kb("UserName"),u=v.AFrameworkApplication.K.kb("UserPrincipalName"),B=v.AFrameworkApplication.K.kb("LoggableUserIdSpace"),Q=new Y;Q.email=u;Q.displayName=h;switch(B){case "OrgIdPuid":Q.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Q.authority="MicrosoftAccount";break;default:Q.authority=B}b(Q,null)}fqn(b){let h=null;try{let B=b.Values[H.a.whg];const Q=b.Values[H.a.nzo],ca=b.Values[H.a.otj],qa=b.Values[H.a.vzo];let Qa=null,rb=null;const Lb=this.Sgc[B];
if("undefined"!==typeof Lb&&Lb){var u=[];Array.add(u,Object.assign(new ha.a,{name:H.a.vhg,string:Lb.requestParameters.correlationId}));ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:u}));h=Lb.requestCallback;delete this.Sgc[B];"undefined"!==typeof Q&&Q&&Q.length?rb=new ba(Q,ca,qa):Qa=N[this.Z7m(b)];u="getAccessToken_"+B;u in this.Eje&&(this.Eje[u].stop(),delete this.Eje[u]);h(rb,Qa)}else r.ULS.sendTraceTag(37856066,
344,10,G.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:B}))}catch(B){b=b.Values[H.a.whg],b in this.Sgc&&delete this.Sgc[b],this.g2d(),r.ULS.sendTraceTag(37856067,344,10,G.c({["error"]:B.message,["stack"]:B.stack})),h&&h(null,"generalException")}}YBf(b){var h=v.AFrameworkApplication.Tjm();b=b.toLowerCase();for(const u of h)if(b===u.toLowerCase())return!0;h=V.OAuthManagerSettings.B0e;for(let u in h)if(b===h[u].toLowerCase())return!0;return!1}Z7m(b){b=b.Values[H.a.rzo];
this.g2d();r.ULS.sendTraceTag(39068821,344,15,G.c({["error"]:b}));return b?-1<b.indexOf(O.Sen)?9:-1<b.indexOf(O.xCn)||-1<b.indexOf(O.wCn)?12:-1<b.indexOf(O.invalidResourceUrl)?10:-1<b.indexOf(O.userAborted)?8:-1<b.indexOf(O.yfn)||-1<b.indexOf(O.Len)||b===O.cJo?11:-1<b.indexOf(O.adalTimeout)?6:0:13}jda(b,h){b=this.pRn(b.resource);r.ULS.sendTraceTag(39921882,344,50,G.c({["callerId"]:h,["resource"]:b}))}g2d(){r.ULS.sendTraceTag(39068822,344,50,G.c({["userAgent"]:window.navigator.userAgent}))}pRn(b){return(b?
b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(m.a)(ia,"WopiIdentityManager",null,[780]);class sa{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}wc(b){this.W=b;b.register(ia,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().Sd(()=>new ia(b.Ta("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Hn(Object(z.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){r.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){M.a.instance.Gc(new sa)}}Object(m.a)(sa,"WopiIdentityPackage",null,[1,2]);var Oa=c(503),Ra=c(355),Na=c(69),Da;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Da||(Da={}));Object(m.b)("ApplicationFeatureHelperRequestType",Da);class ra{constructor(){this.message=null;this.httpStatusCode=
0}}Object(m.a)(ra,"HttpRequstToPromiseRejectData",null,[]);var xa=c(86),fa=c(45),oa=c(199),ta=c(760);class Ka{constructor(b,h){this.Ga=b;this.Wf=h}OJc(b,h,u,B=null,Q=null,ca=null,qa=null,Qa=null){const rb=Da[u],Lb=rb+"RequestFailure";xa.Health.instance.recordKpiUsage(Lb,0,"jpittsdirects",null);return new Promise((Yb,gc)=>{r.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",rb);const Fc=null!=qa?qa:this.Ga.lc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),Sc=null!=Qa?Qa:this.Ga.lc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Wf.oAb(b,1,null,this.Spf(u,B),ca,1,ld=>{r.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",rb);try{if(void 0===ld||null===ld||void 0===ld.data||null===ld.data||void 0===ld.data.se||null===ld.data.se){xa.Health.instance.recordKpiFailure(Lb,"Invalid RequestSucceededEventArgs",!1,!0,null);let Ie=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
rb);gc(this.kFa(Ie,ld))}else if(ld.data.Qe!==oa.a.$y){xa.Health.instance.recordKpiFailure(Lb,"HttpStatusCode_"+ld.data.Qe.toString(),!1,!0,null);let Ie=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",ld.data.Qe,rb);gc(this.kFa(Ie,ld))}else{void 0!==Q&&null!==Q&&void 0!==ld.data.Aj&&null!==ld.data.Aj&&Q(ld.data.Aj);var Hd=h(ld.data.se);if(Hd)r.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",rb),Yb(Hd);else{xa.Health.instance.recordKpiFailure(Lb,"Parse Failure",!1,!0,null);let Ie=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",rb);gc(this.kFa(Ie,ld))}}}catch(Ie){xa.Health.instance.recordKpiFailure(Lb,"Unexpected Failure",!1,!0,null),Hd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Ie,rb),gc(this.kFa(Hd,ld))}},ld=>{if(ld.data){xa.Health.instance.recordKpiFailure(Lb,"HttpStatusCode_"+ld.data.Qe.toString(),!1,!0,null);var Hd=ta.a.h$b(ld.data.se||"No Data");Hd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",ld.data.Qe,Hd,rb)}else xa.Health.instance.recordKpiFailure(Lb,"Invalid RequestFailedEventArgs",!1,!0,null),Hd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
rb);gc(this.kFa(Hd,ld))},void 0,void 0,Fc,Sc)})}kFa(b,h){const u=new ra;u.message=b;u.httpStatusCode=h&&h.data?h.data.Qe:-1;return u}Spf(b,h){const u={};u["x-UserDataSignature"]=this.Ga.kb("UserDataSignature");u["x-LicensingIsEnabled"]=this.Ga.$("LicensingIsEnabled").toString();u["x-CacheIsEnabled"]=this.Ga.$("LicensingRedisIsEnabled").toString();u["x-OcpsIsEnabled"]=this.Ga.$("OcpsIsEnabled").toString();u["x-LicensingAADIdIsEnabled"]=this.Ga.$("LicensingAadIdIsEnabled").toString();0===b&&(u["x-LicenseCheckOnTenantEnabled"]=
"true",u["x-SupportUserConsentDependentFeatures"]="true",u["x-AFHUserConsentGroupValue"]="0",u["x-UseShellServiceForUserConsentGroup"]="true",u["x-SMBUserLicensingEnabled"]="true",u["x-AFHPIPLComplianceEnabled"]=fa.a.iP(window.location.href,"wd_afhpipl")||"false",u["x-ConsumerLicensingSNICertIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString());if(h)for(let B of h.keys)u[B]=h.J(B);return u}}Object(m.a)(Ka,"HttpRequestToPromiseUtility",
null,[]);var va;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(va||(va={}));Object(m.b)("AlternateAuthSupportApp",va);class La{constructor(){this.Token=null;this.ExpirationTime=0}}Object(m.a)(La,"WacAlternateAuthToken",null,[]);class za{constructor(b,h){this.aJo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=b;this.Gfd=new Oa.a(Ra.a.jh());this.Pvc=new Ka(b,h);void 0!==V.OAuthManagerSettings.BMf&&null!==
V.OAuthManagerSettings.BMf&&void 0!==V.OAuthManagerSettings.N2d&&null!==V.OAuthManagerSettings.N2d&&0<V.OAuthManagerSettings.N2d&&(b=new La,b.Token=V.OAuthManagerSettings.BMf,b.ExpirationTime=V.OAuthManagerSettings.N2d,this.Gfd.Z("loki",b))}DLl(){let b=null;this.Gfd.nb(va[0])&&(b=this.Gfd.J(va[0]));return void 0===b||null===b||this.$Tm(b)?this.Ozl():Promise.resolve(b.Token)}$Tm(b){return b.ExpirationTime-Date.now()<this.aJo}Ozl(){const b=new Oa.a(Ra.a.jh());b.Z("X-AlternateAuthApp",va[0]);return this.Pvc.OJc(this.yib("/afhs/AlternateAuthHelperHandler.ashx"),
Object(z.a)(this,this.cyn,"parseAlternateAuthTokenResponse"),2,b).then(h=>{r.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",va[0]);this.Gfd.Z(va[0],h);return h.Token},h=>{h=Object(Na.a)(ra,h);r.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}cyn(b){let h=null;({Hu:h}=G.d(b));r.ULS.sendTraceTag(545821457,3004,
h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}yib(b){return String.format("{0}{1}?{2}",this.Ga.kb("WebServiceBase"),b,v.AFrameworkApplication.km)}}Object(m.a)(za,"AlternateAuthHelper",null,[757]);var Ca=c(609);class ua{constructor(b,h,u){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=u}}Object(m.a)(ua,"FeatureStateChangeArgs",null,[]);var ib=c(150),bb=c(203),mb=c(85),yb=c(135),ab;(function(b){b[b.Enabled=
0]="Enabled";b[b.Disabled=1]="Disabled"})(ab||(ab={}));Object(m.b)("FeatureState",ab);var Ga=c(22),Za=c(13),Ub=c(115);class Xb{constructor(b,h,u=null,B=null,Q=null){this.Chb=this.Yla=this.Xbh=this.Qbb=this.Rwd=null;this.Pvc=new Ka(b,h);this.Ga=b;this.e9j=b.lc("LicensingMaxRetryAttempts",0);this.ood=b.$("IsO365ConsumerHost");this.EFe=b.$("IsO365CommercialHost");this.$Ee=b.$("PremiumUpsellIsEnabled");this.EXb=!1;this.eIe=0;this.INg=u;this.Qjh=B;this.ga=Q;this.Pbb=b.$("LicensingIsEnabled");this.Vwb=
b.$("OcpsIsEnabled")&&this.EFe;this.vWe=b.$("ShowPrivacyDialog")&&!!B;this.tXb=b.$("IsAnonymousUser");this.ZMd=new Promise(ca=>{ca(!1)});this.brb=new Promise(ca=>{ca(!0)});this.Bhb=new Oa.a(Ra.a.jh());this.lzd=!0;this.O3g=this.F0l();this.l4a()&&!this.tXb?(void 0!==v.AFrameworkApplication.ua&&null!==v.AFrameworkApplication.ua&&(this.Rwd=v.AFrameworkApplication.ua.Iq,void 0!==this.Rwd&&null!==this.Rwd&&(this.Qbb=this.Rwd.ORa("WebServiceCall","ApplicationFeatureHelperService"))),this.Chb=this.Amg()):
this.Chb=new Promise(ca=>{ca({})});this.Chb.catch(ca=>{ca=Object(Na.a)(ra,ca);r.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ca?ca.httpStatusCode.toString():"Unknown")});this.lzd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.EXb=ca;return null})}F0l(){const b=this.Ga.ow("AllLicensedFeatures")?this.Ga.BB("AllLicensedFeatures"):[],h=new Ca.a;for(let u=0;u<b.length;u++)h.add(b[u]);return h}l4a(){return this.EFe||this.ood}Amg(b=0,h=!1){r.ULS.sendTraceTag(51185368,
3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const u=ib.a.oG();u&&(u.set("retryAttempt",b.toString()),u.set("forceRefresh",h.toString()),u.set("isO365ConsumerHost",this.ood.toString()),u.set("isO365CommercialHost",this.EFe.toString()),u.set("isFreemiumUpsellSettingEnabled",this.$Ee.toString()));xa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",u);xa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",
u);void 0!==this.Qbb&&null!==this.Qbb&&this.Qbb.start();let B=null;h&&(B=new Oa.a(Ra.a.jh()),B.Z("x-LicensingForceRefresh","true"));this.Xbh=new Date;return(this.Pbb?this.Pvc.OJc(this.yib("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.gyn,"parseApplicationFeatureHelperResponse"),0,B,Object(z.a)(this,this.MFn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Q=>{const ca=Object.assign(new Ub.a,{durationMs:this.juj()});ca.extendedProperties=u;
ca.extendedProperties&&Q&&(ca.extendedProperties.set("featureCount",mb.a.count(Q).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Q).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Q).toString()),"FreemiumUpsell"in Q&&ca.extendedProperties.set("isFreemiumUpsellEnabled",Q.FreemiumUpsell.toString()),this.Yla&&ca.extendedProperties.set("fromCache",(this.Yla<this.Xbh).toString()));xa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
ca);return Q},Q=>{const ca=Object.assign(new Ub.a,{durationMs:this.juj()}),qa=Object(Na.a)(ra,Q);if(!qa)return r.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Qa,rb)=>{rb(Q)});ca.extendedProperties=u;ca.extendedProperties&&ca.extendedProperties.set("status",qa.httpStatusCode.toString());
xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===qa.httpStatusCode&&++b<=this.e9j?this.Amg(b):new Promise((Qa,rb)=>{rb(qa)})})}gyn(b){(b=G.b(b))?(r.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),r.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):r.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}yib(b){var h=
String.format("{0}{1}",this.Ga.kb("WebServiceBase"),b);this.Ga.ow("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ga.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=Xb.URd(this.Ga))&&0<b.length&&(this.lzd&&(b+="ucbf"),h=new bb.QueryStringBuilder(h),h.ye("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.Vwb&&!this.vWe&&!this.Pbb)return this.brb;r.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var u=this.Vwb?this.INg.O8("ControllerConnectedServicesEnabled"):this.brb;const ca=this.vWe?this.Qjh.getSettings().then(qa=>2!==qa.cJ,()=>h):this.brb;return u.then(qa=>qa?ca:this.ZMd)}if("FreemiumUpsell"===b&&(!this.$Ee||!this.ood||this.tXb))return this.ZMd;u=null;u=this.Vwb?this.INg.isFeatureEnabled(b):this.brb;let B=null;B=this.Pbb?this.kKm(b,h):this.brb;let Q=null;Q=this.vWe?this.Qjh.isFeatureEnabled(b):this.brb;return u.then(ca=>ca?Q.then(qa=>qa?B:this.ZMd):this.ZMd).then(ca=>
{this.UIi(b,ca,!0);return ca},()=>{this.UIi(b,h,!1);return h})}UIi(b,h,u){r.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,u)}getFeatureTier(b,h){if(!this.Pbb)return new Promise(u=>{u(2)});r.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Chb.then(u=>this.YTd(b,u,h),()=>h)}isFreemiumUpsellEnabled(){if(this.$Ee&&this.ood&&!this.tXb){if(this.EXb&&2!==this.eIe||!this.EXb&&1!==this.eIe)r.ULS.sendTraceTag(509728161,
3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.EXb.toString()),this.eIe=this.EXb?2:1;return this.EXb}return!1}launchUpsellExperience(b,h=null){r.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var u=ib.a.oG();u&&(u.set("experienceId",b),h&&u.set("campaignId",h));xa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",u);
if(u=Ga.a.instance.Oa("Common.IInProductMessagingUIManager")){const B=Object(z.a)(this,this.omm,"handleDimeTaskComplete");u.LEi(b,B,h)}else r.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Rb(Za.a.QOd,2,{["experience"]:b})}Rya(b,h){if(!this.Pbb)return null;if(!b||!h)return r.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const u=yb.a.create().toString();this.Bhb.nb(b)||this.Bhb.Z(b,new Oa.a(Ra.a.jh()));this.Bhb.J(b).add(u,h);r.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",u,b));return u}Fic(b,h){this.Pbb&&(b&&this.Bhb.nb(b)?h&&yb.a.isValid(h)?this.Bhb.J(b).nb(h)?(r.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
h,b)),this.Bhb.J(b).remove(h)):r.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):r.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):r.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
b)))}YTd(b,h,u){return this.lzd?b in h?h[b].LicenseTier:u:b in h?this.Syn(h[b],u):u}Syn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}omm(){r.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Chb.then(b=>{this.j7i(b)}).catch(()=>{this.j7i({})})}j7i(b){r.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.Amg(0,!0);h.then(u=>
{this.Chb=h;mb.a.count(u)>mb.a.count(b)?xa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let B of this.Bhb.keys)if(B in u){const Q=this.YTd(B,u,0);B in b?this.YTd(B,b,0)!==Q&&this.MSf(B,!0,Q):this.MSf(B,!0,Q)}else B in b&&this.MSf(B,!1,this.YTd(B,b,0))}).catch(u=>{xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);r.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(u))})}MSf(b,h,u){r.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,u);h=new ua(b,h,u);u=this.Bhb.J(b);for(let B of u)try{B.value(h)}catch(Q){r.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,B.key,Q.message))}}jKm(b,h){if(this.Pbb){const u=
this.O3g.contains(b);let B=!0,Q="",ca=!1;return this.Chb.then(qa=>{b in qa?(qa=qa[b],Q=ab[qa.FeatureState],B=1!==qa.FeatureState):B=!u;this.hJi(b,u,Q,ca,h,B);return B},()=>{ca=!0;u&&(B=h);this.hJi(b,u,Q,ca,h,B);return B})}return this.brb}hJi(b,h,u,B,Q,ca){r.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,B,u,Q,ca)}kKm(b,h){if(this.lzd)return this.jKm(b,h);if(this.Pbb){if(this.O3g.contains(b))return this.Chb.then(u=>
b in u,()=>h);r.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.brb}MFn(b){try{b&&"Date"in b&&(this.Yla=new Date(b.Date),r.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Yla.toString()))}catch(h){r.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",h)}}juj(){if(void 0!==this.Qbb&&
null!==this.Qbb){const b=this.Qbb.li;this.Qbb.stop();return b}return null}static URd(b){try{if(Z.a.cke){const h=b.kb("UserDataSignature").split(".");if(1<h.length){const u=window.self.atob(h[1]),B=JSON.parse(u).LocalStorageKey;if(void 0!==B&&null!==B&&0<B.length)return B}}}catch(h){r.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(m.a)(Xb,"ApplicationFeatureHelper",null,[758]);var zb=c(75);class Ib{constructor(b,h){this.PolicySettings=null;
this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(m.a)(Ib,"CloudPolicySettingsCacheData",null,[]);var $a=c(1383),Hb=c(632),Ya=c(291);class Sa{static Grj(){return v.AFrameworkApplication.K.$("SideCarIsEnabled")?Sa.Kee&&Sa.zVc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Sa.Kee=Ya.a.create(v.AFrameworkApplication.K.kb("SideCarUrl"));Hb.a.FX(Sa.Kee);Sa.Kee.t_((u,B)=>{(Sa.zVc=B.succeeded)?b(B.succeeded):h(B.succeeded)})}):
new Promise(b=>{b(!1)})}}Sa.zVc=!1;Sa.Kee=null;Object(m.a)(Sa,"SideCarLoader",null,[]);class Eb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(m.a)(Eb,"CloudPolicySettingsData",null,[]);class Jb{constructor(b,h){this.Nue=0;this.JFd=null;this.Pvc=new Ka(b,h);this.Ga=b;h=b.kb("HostAuthType");this.Vwb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.y7g=G.b(b.kb("OcpsDefaultSettings")||"{}");this.fyc=
this.URd();h=this.Ga.ow("ServicesControlsMicrosoftControllerServicesList")?this.Ga.BB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Thd=new Ca.a;for(let u=0;u<h.length;u++)this.Thd.add(h[u]);this.Vwb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.JFd=this.bNo():this.JFd=this.zmg(this.Vwb,this.yib("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.lyn,"parseCloudPolicySettingsResponse"));this.JFd.then(()=>null).catch(u=>{u=Object(Na.a)(ra,u);r.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",u?u.httpStatusCode.toString():"Unknown")})}O8(b,h=!0){if(!this.Vwb){const ca=this;return new Promise(qa=>{qa(ca.xQc(b))})}let u=this,B=this;const Q=this.JFd.then(ca=>{try{let qa=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(qa=ca.PolicySettings.unknown);if(qa){if(b in qa&&void 0!==qa[b]&&null!==qa[b])return new Promise(rb=>{rb("0"!==qa[b])});const Qa=b.toLowerCase();if(Qa in qa&&void 0!==qa[Qa]&&null!==qa[Qa])return new Promise(rb=>
{rb("0"!==qa[Qa])});r.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(rb=>{rb(u.xQc(b))})}return new Promise(Qa=>{Qa(u.xQc(b))})}catch(qa){return r.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",qa.message),u.handleError(qa.toString(),h,u.xQc(b))}},ca=>B.handleError(ca,h,B.xQc(b)));Q.then(ca=>{r.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ca);
return null});return Q}isFeatureEnabled(b,h=!0){if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.mKm(b,h);let u=new Promise(Q=>{Q(!0)}),B="";this.Thd.contains(b)&&(B="ControllerConnectedServicesEnabled",u=this.O8(B,h));u.then(Q=>{r.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,Q,B);return null});return u}mKm(b,h=!0){let u=new Promise(Q=>
{Q(!0)}),B="";"mso_sendASmile"===b?B="Enabled":"Survey"===b||"FloodgateSurvey"===b?B="SurveyEnabled":this.Thd.contains(b)&&(B="ControllerConnectedServicesEnabled");""!==B&&(u=this.O8(B,h));u.then(Q=>{r.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,Q,B);return null});return u}handleError(b,h,u){return h?new Promise(B=>{B(u)}):new Promise((B,Q)=>{Q(b)})}zmg(b,h,u){if(!b)return Promise.resolve(new Eb);let B=!1,Q=
null;xa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.u$e("GetCloudPolicySettings");return(new Promise((qa,Qa)=>{if(void 0!==this.fyc&&null!==this.fyc&&0<this.fyc.length){const rb=this.FMo();if(void 0!==rb&&null!==rb){B=!0;qa(rb);return}}this.Pvc.OJc(h,u,1,null,Object(z.a)(this,this.YFn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ga.lc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.lc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(rb=>{r.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.ONo(rb);qa(rb);return rb},rb=>{Qa(rb);return null})})).then(qa=>{({YA:ca,returnValue:Q}=this.Bje(ca));var Qa=ib.a.oG();Qa&&Qa.set("FromCache",B.toString());Qa=Object.assign(new Ub.a,{durationMs:Q,extendedProperties:Qa});xa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Qa);return qa})}bNo(){return Sa.Grj().then(()=>{r.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}yib(b){return String.format("{0}{1}",this.Ga.kb("WebServiceBase"),b)}lyn(b){let h=null;({Hu:h}=G.d(b));b=!!h;r.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}YFn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.Nue=h)}}catch(h){r.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
h)}}xQc(b){return b in this.y7g?"0"!==this.y7g[b]:!0}FMo(){try{const b=$a.a.instance.getItem(this.fyc);if(void 0===b||null===b)return r.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;r.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return r.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return r.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return r.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const u=new Eb;u.PolicySettings=h.PolicySettings;u.ControllerConnectedServicesFeatureNames=new zb.a;this.Ga.ow("ServicesControlsMicrosoftControllerServicesList")&&
this.Ga.BB("ServicesControlsMicrosoftControllerServicesList");for(let B of this.Thd)u.ControllerConnectedServicesFeatureNames.add(B);r.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return u}catch(b){return r.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}ONo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)r.ULS.sendTraceTag(51662944,3004,15,
"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Nue)r.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Ib(b,this.Nue),u=JSON.stringify(h);r.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",u);$a.a.instance.setItem(this.fyc,u);r.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){r.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}URd(){const b=Xb.URd(this.Ga);return b&&0<b.length?"OCPS"+b:null}u$e(b){const h=Ga.a.instance.Oa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==h&&null!==h?h.Vf("WebServiceCall",b):null}Bje(b){if(void 0!==b&&null!==b){const h=b.li;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,YA:b}}}Object(m.a)(Jb,"CloudPolicySettingsHelper",null,[755]);class vb{constructor(){this.BTh=this.nHj=this.cJ=
0;this.CTh=this.oHj=this.oCb="";this.DSe=this.jVa=2}clone(){const b=new vb;b.cJ=this.cJ;b.nHj=this.nHj;b.BTh=this.BTh;b.oCb=this.oCb;b.oHj=this.oHj;b.CTh=this.CTh;b.jVa=this.jVa;b.DSe=this.src;return b}get src(){return this.DSe}serialize(b=null){const h={};if(!b||b.contains(vb.GLb))h[vb.GLb]=this.cJ;if(!b||b.contains(vb.P0c))h[vb.P0c]=this.oCb;if(!b||b.contains(vb.Q0c))h[vb.Q0c]=this.jVa;return JSON.stringify(h)}static create(b,h=null){const u=new vb;u.DSe=b;void 0!==h&&null!==h&&(vb.GLb in h&&(u.cJ=
h[vb.GLb]),vb.P0c in h&&(u.oCb=h[vb.P0c]),vb.Q0c in h&&(u.jVa=h[vb.Q0c]));return u}static deserialize(b,h){try{const u=JSON.parse(b);if(void 0!==u&&null!==u)return vb.create(h,u);r.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(u){throw r.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",u.toString()),u;}}}vb.GLb="CCS";vb.P0c="CCSTime";vb.Q0c="OfficePrivacyRoamedNoticeShown";
Object(m.a)(vb,"UserPrivacySettings",null,[]);var ac=c(153);class dc{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=b;this.Wf=h;this.uRe=this.Sf=null}yib(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ga.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(v.AFrameworkApplication.km);return h.toString()}executeRequest(b,h,u,
B=null){return this.Wf.W1b(b,h,B,null,u,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,u)=>{try{if(void 0===this.Sf||null===this.Sf||void 0===b||null===b)r.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),u("Can't determine setting changes to save");else{var B=this.Sf.cJ!==b.cJ;if(2===this.Sf.src&&B)this.d9n(b),h(!0);else{var Q=this.Vco(b);if(void 0===Q||null===Q||!Q.length)r.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),
u("No changes to save");else if(1===this.Sf.src)h(this.vBj(Q));else if(0===this.Sf.src){r.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Q);const ca=this.executeRequest(this.yib("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Q);ca.continueWith(()=>{if(ca.Eo||ca.Ei)r.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var qa=ca.result;void 0!==qa.args&&null!==qa.args&&void 0!==qa.args.data&&
null!==qa.args.data&&qa.args.data.Qe===oa.a.$y?(r.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(r.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ca){r.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),h(!1)}})}Vco(b){if(void 0===this.Sf||null===this.Sf||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");
const h=new zb.a;0===b.src?(this.Sf.cJ!==b.cJ&&(h.add(vb.GLb),h.add(vb.P0c)),this.Sf.jVa!==b.jVa&&h.add(vb.Q0c)):1===b.src&&this.Sf.cJ!==b.cJ&&h.add(vb.GLb);return h.count?b.serialize(h):(r.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.uRe){const b=this;this.uRe=new Promise(h=>{try{b.Sf?h(b.Sf.clone()):b.WMo().then(u=>{b.Sf=u;h(b.Sf.clone());return null},()=>{b.UMo().then(u=>{b.Sf=u;h(b.Sf.clone());return null},()=>{b.VMo().then(u=>
{b.Sf=u;h(b.Sf.clone());return null},()=>{r.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Sf=new vb;h(b.Sf.clone());return null});return null});return null})}catch(u){r.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",u.toString()),b.Sf=new vb,h(b.Sf.clone())}})}return this.uRe}WMo(){return new Promise((b,h)=>{try{const B=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ga.$("PrivacyDialogShouldCheckRoaming")||
B){var u=this.executeRequest(this.yib("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");u.continueWith(()=>{try{if(u.Eo||u.Ei)r.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Q=u.result;if(Q&&Q.args&&Q.args.data)if(Q.args.data.Qe!==oa.a.$y)r.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Q.args.data.Qe);else{if(Q.args.data.se){b(dc.parse(Q.args.data.se,0));r.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Q.args.data.se);return}r.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else r.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Q){r.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
Q.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else r.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(B){r.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",B.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}UMo(){return new Promise((b,h)=>{try{const u=ac.a.get("WacUPToggleState");let B=null;void 0!==u&&null!==
u&&0<u.length&&(B=decodeURIComponent(u));if(void 0!==B&&null!==B&&0<B.length){const Q=dc.parse(B,1);r.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Q.toString());b(Q)}else{const Q=vb.create(1),ca=new zb.a;ca.add(vb.GLb);const qa=Q.serialize(ca);this.vBj(qa)?(r.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",qa),b(Q)):(r.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",
qa),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(u){r.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",u.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}VMo(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let u=vb.create(2);h?(u.cJ=2,v.AFrameworkApplication.tRh(),r.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",
u.toString())):(u.cJ=1,r.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",u.toString()));b(u)}catch(u){r.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",u.toString()),h=vb.create(2),h.cJ=1,b(h)}})}d9n(b){r.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.cJ?v.AFrameworkApplication.tRh():v.AFrameworkApplication.btl();r.ULS.sendTraceTag(51258454,
3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}vBj(b){try{r.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ga.kb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");r.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return ac.a.Imj("WacUPToggleState",b,ac.a.SRa,h)}catch(h){return r.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",
h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const u=this.Ga.ow("ServicesControlsMicrosoftControllerServicesList")?this.Ga.BB("ServicesControlsMicrosoftControllerServicesList"):[],B=new Ca.a;for(let Q=0;Q<u.length;Q++)B.add(u[Q]);return B.contains(b)?2!==h.cJ:!0},()=>{r.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return r.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
b,h),vb.deserialize(b,h)}catch(u){throw r.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",u.toString()),u;}}}Object(m.a)(dc,"UserPrivacySettingsHelper",null,[756]);class Cc{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}wc(b){this.W=b;this.W.register(755,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().Sd(()=>new Jb(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(756,
"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().Sd(()=>new dc(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(757,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().Sd(()=>new za(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(758,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().Sd(()=>new Xb(v.AFrameworkApplication.K,v.AFrameworkApplication.He,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),
this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),v.AFrameworkApplication.va))}init(){v.AFrameworkApplication.K.Hn(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");v.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{r.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,
v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{r.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.oGo()})}dispose(){}oGo(){try{v.AFrameworkApplication.K.$("SideCarIsEnabled")&&Sa.Grj().then(b=>
{r.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){M.a.instance.Gc(new Cc)}}Object(m.a)(Cc,"ApplicationFeatureHelperPackage",null,[1,2]);var Ec=c(169);class rc{ZRd(b,h){let u;const B=[];for(;u=h.exec(b);){const Q=u.index;B.push(new Ec.a(Q,Q+u[0].length))}return B}isEndPuncSpecialCase(b){const h=this.ZRd(b,rc.eyo);for(const u of h)if(u.end===b.length)return!0;return!1}WMc(b){for(const h of rc.Cxl){const u=
this.ZRd(b,h);if(0<u.length&&!u[0].Ac)return u[0].end-1}return 0}findBeginBoundary(b,h,u){var B=b.substring(u,h);b=this.ZRd(B,rc.yVh);for(h=b.length-1;0<=h;h--){const Q=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(Q))return B=B.substring(b[h].Ac,B.length),u+b[h].end+this.WMc(B)}return u}findEndBoundary(b,h,u){var B=b.substring(h,u);b=this.ZRd(B,rc.yVh);for(u=0;u<b.length;u++){const Q=B.substring(0,b[u].end);if(!this.isEndPuncSpecialCase(Q))return B=B.substring(b[u].Ac,B.length),h+b[u].end+
this.WMc(B)}return-1}}rc.wif="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";rc.xif="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
rc.yif="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";rc.Cxl=[new RegExp(rc.wif,"ig"),new RegExp(rc.xif,"ig"),new RegExp(rc.yif,"ig")];rc.Xgg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";rc.$gg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";rc.Zgg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
rc.Ygg=rc.$gg+"|"+rc.Zgg;rc.ahg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";rc.bhg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";rc.chg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
rc.dhg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";rc.abg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
rc.Ygg+"|"+rc.ahg+"|"+rc.bhg+")";rc.$ag="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
rc.chg+")";rc.rSf=rc.Xgg+"|"+rc.dhg;rc.Wgg=rc.rSf+"|"+rc.abg+"|"+rc.$ag;rc.yVh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");rc.eyo=new RegExp(rc.Wgg,"g");Object(m.a)(rc,"ProofingSentenceSeparatorScriptSharp",null,[752]);class hb{wed(b,h){const u=[];let B;for(;null!=(B=h.exec(b));){const Q=B.index;u.push({Ac:Q,end:Q+B[0].length})}return u}isEndPuncSpecialCase(b){return this.wed(b,hb.fQj).some(h=>
h.end==b.length)}WMc(b){for(const h of hb.aNj){const u=this.wed(b,h);if(0<u.length&&0==u[0].Ac)return u[0].end-1}return 0}findBeginBoundary(b,h,u){var B=b.substring(u,h);b=this.wed(B,hb.nsg);for(h=b.length-1;0<=h;h--){const Q=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(Q))return B=B.substring(b[h].Ac,B.length),u+b[h].end+this.WMc(B)}return u}findEndBoundary(b,h,u){var B=b.substring(h,u);b=this.wed(B,hb.nsg);for(u=0;u<b.length;u++){const Q=B.substring(0,b[u].end);if(!this.isEndPuncSpecialCase(Q))return B=
B.substring(b[u].Ac,B.length),h+b[u].end+this.WMc(B)}return-1}}hb.JLj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";hb.aQj="[\u2639\u263a\u263b]";hb.etg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";hb.MMj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
hb.cPj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";hb.ktg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
hb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
hb.dtg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";hb.gOj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";hb.fOj="[\uff21-\uff3a\uff41-\uff5a]";hb.dOj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
hb.cOj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";hb.eOj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";hb.Mpe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";hb.msg="[\u3002\uff61]";hb.Red="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";hb.hNj="[\u00bb\u2019\u201d\u203a\"']";hb.gqe=hb.JLj+"|"+hb.aQj;hb.hOj="[\u2028\u2029\n\r]";hb.bOj="("+hb.Red+"|"+hb.etg+"|"+hb.ktg+"|"+hb.dtg+
")";hb.aOj="("+hb.Red+"|"+hb.etg+"|"+hb.ktg+"|"+hb.Symbol+"|"+hb.dtg+"|"+hb.MMj+"|"+hb.cPj+")";hb.wif="("+hb.Mpe+"("+hb.gqe+"|"+hb.hNj+"|"+hb.Red+")*"+hb.hOj+")";hb.xif="("+hb.Mpe+"("+hb.gqe+")*("+hb.Red+")+)";hb.yif="("+hb.msg+"("+hb.gqe+")*)";hb.aNj=[new RegExp(hb.wif,"ig"),new RegExp(hb.xif,"ig"),new RegExp(hb.yif,"ig")];hb.Xgg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";hb.$gg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
hb.Zgg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";hb.Ygg=hb.$gg+"|"+hb.Zgg;hb.ahg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";hb.bhg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
hb.chg="(("+hb.gOj+"|"+hb.dOj+"|"+hb.eOj+")[.])+|(("+hb.cOj+")[.\ufe52\uff0e])+";hb.dhg="("+hb.fOj+")[.\ufe52\uff0e]";hb.abg=hb.bOj+"("+hb.Ygg+"|"+hb.ahg+"|"+hb.bhg+")";hb.$ag=hb.aOj+"("+hb.chg+")";hb.rSf=hb.Xgg+"|"+hb.dhg;hb.Wgg=hb.rSf+"|"+hb.abg+"|"+hb.$ag;hb.nsg=new RegExp(hb.Mpe+"|"+hb.msg,"ig");hb.fQj=new RegExp(hb.Wgg,"g");Object(m.a)(hb,"ProofingSentenceSeparator",null,[752]);class fb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}wc(b){this.W=b;v.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new hb).ha():b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new rc).ha()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){M.a.instance.Gc(new fb)}}Object(m.a)(fb,"Box4GrammarCheckPackage",null,[1,2]);var Nb=c(101),Fb=c(9),nb=c(63),pb=c(1833);class Xa{constructor(){this.W=null}get name(){return"Box4.AtMentions"}wc(b){this.W=b;this.W.ia("Box4.AtMentions.IAtMentionsListener",()=>new pb.a(this.W.resolve("Box4.IEditingDomManager"),
this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),nb.InteractiveViewManager.instance)).ha()}init(){v.AFrameworkApplication.K.Hn(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Peb(Fb.App.za.jb,Nb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){M.a.instance.Gc(new Xa)}}Object(m.a)(Xa,"Box4AtMentionsPackage",null,[1,2]);class Pb{get name(){return"Box4.Workers"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new Pb)}}
Object(m.a)(Pb,"Box4WorkersPackage",null,[1,2]);var Va=c(304),tb=c(82);class cb{constructor(){this.SJa=new tb.a}B5(b,h){this.SJa.Z(b,h)}ymf(b){({value:b}=this.SJa.Fc(b));return b}}Object(m.a)(cb,"AggregationMethodsForActivityName",null,[]);var Mb=c(253);class mc{constructor(){this.vtd=new Va.a;this.SJa=new Va.a}B5(b,h,u){this.SJa.nb(b)&&this.SJa.J(b)||this.SJa.Z(b,new cb);this.SJa.J(b).B5(h,u)}ymf(b,h){return this.SJa.nb(b)&&this.SJa.J(b)?this.SJa.J(b).ymf(h):null}PQc(b){this.vtd.nb(b)&&this.vtd.J(b)||
this.vtd.Z(b,new Mb.a);return this.vtd.J(b)}jOh(b,h){this.PQc(b).add(h)}}Object(m.a)(mc,"ActivityAggregationInfo",null,[776]);var Cb=c(110),Ja=c(1002),Wa=c(1027);class xb extends Ja.a{constructor(b,h){super(b);this.SVe=(this.fTj=h)?h.CWl():Wa.a.kmf()}get KCa(){return this.fTj}get activityName(){return this.KCa.name}get startTime(){return this.KCa.startTime}get endTime(){return this.KCa.endTime}end(){}cancel(){}blf(){}ITo(){this.n8b.Z("AM",this.KCa.mode.toString());this.n8b.Z("C",this.KCa.count.toString());
this.n8b.Z("DA",this.KCa.UTh.toFixed(2));this.n8b.Z("DV",this.KCa.irl.toFixed(2))}ssf(b){return this.KCa.ssf(b)}Zsf(){return this.KCa.Zsf()}a2b(){for(let b of this.KCa.LCa)b.a2b()}}Object(m.a)(xb,"AggregatedActivity",Ja.a,[]);class ic{constructor(b,h){this.ise=0;this.qAa=b;this.JVa=h}ozk(b,h){this.ise=h;for(h=0;h<b.count;h++){const u=b.J(h);this.pzk(u)}}pzk(b){const h=Object(Na.a)(xb,b);if(h)if(1===this.ise)this.nzk(h);else if(2===this.ise){this.qzk(h);for(let u of this.JVa.PQc(this.qAa)){const B=
h.KCa.LCa.J(0);B.properties.nb(u)&&b.properties.Z(u,B.properties.J(u))}}}nzk(b){for(let h of this.JVa.PQc(this.qAa))this.Kej(b,h)}qzk(b){for(let h of b.Zsf())this.Kej(b,h)}Kej(b,h){const u=this.JVa.ymf(this.qAa,h);if(u){const B=b.ssf(h);b.properties.Z(h,u(B))}}}Object(m.a)(ic,"PropertyAggregationHelper",null,[]);var qc=c(1089);class Lc{constructor(b,h,u,B,Q){this.UTb=b;this.JVa=h;this.mOg=Q;this.Rre=B;this.A8j=u}get cmh(){return this.A8j.value}FIc(b){if(Object(Cb.a)(qc.a,b))b.FIc();else if(Object(Cb.a)(xb,
b)&&this.Rre.Zzh(b.activityName.toString())){b=Object(Na.a)(xb,b);b.ITo();b=b.xLi();var h=[];Array.add(h,b);b=G.c(h);r.ULS.sendTraceTag(6907266,213,50,b)}}SCa(b,h){const u=(new Date).getTime();var B=this.mOg.list.J(b);const Q=({szk:B}=this.MKl(B)).returnValue;this.mOg.list.Z(b,new zb.a);h&&(B=this.B6k(B,u,this.UTb.Vji));0<B.count&&(new ic(b,this.JVa)).ozk(B,Q)}B6k(b,h,u){const B=new zb.a;for(let Q=0;Q<b.count;Q++){const ca=b.J(Q);ca.startTime>h-u?ca.a2b():B.add(ca)}return B}MKl(b){const h=this.cmh.Mxj(b);
b=this.cmh.LHo(b);const u=this.tzk(h,b);return{returnValue:u,szk:1===u?h:b}}tzk(b,h){return b.count*this.UTb.TNi<h.count?1:2}get enabled(){return this.UTb.enabled}a2b(){}}Object(m.a)(Lc,"ActivityAggregationManager",null,[775]);class Ac{constructor(b){this.enabled=!1;this.iMi=500;this.yNi=2;this.TNi=5;this.Vji=3E4;this.eNc(b.appSettings)}eNc(b){this.enabled=Boolean.parse(b[Ac.Ogf]||"false");this.iMi=parseInt(b[Ac.H9m]||"500");this.yNi=parseInt(b[Ac.nbn]||"2");this.TNi=parseInt(b[Ac.Mbn]||"5");this.Vji=
parseInt(b[Ac.lkm]||"30000")}}Ac.Ogf="ActivityAggregationEnabled";Ac.H9m="ActivityAggregationMaxInterval";Ac.nbn="ActivityAggregationMinChain";Ac.Mbn="ActivityAggregationModeFactor";Ac.lkm="ActivityAggregationGraceWindow";Object(m.a)(Ac,"ActivityAggregationParams",null,[]);class gd{constructor(b,h){this.JVa=b;this.yJg=h}Mxj(b,h=1){if(!b||!b.count)return b;const u=new zb.a;var B=null;for(let Q=0;Q<b.count;Q++){const ca=b.J(Q);if(!ca)continue;const qa=ca.activityName;B?B.wVm(ca)?B.add(ca):(B=B.process(),
u.addRange(B),B=this.yJg(qa,h),B.add(ca)):(B=this.yJg(qa,h),B.add(ca))}B&&(b=B.process(),u.addRange(b));return u}LHo(b){if(!b||!b.count)return b;const h={};var u=null;for(let Q=0;Q<b.count;Q++){const ca=b.J(Q);if(ca){if(!u){u=new zb.a;var B=this.JVa.PQc(ca.activityName);for(let qa of B)u.add(qa)}B=this.u9l(ca,u);null!==B&&(B in h&&h[B]||(h[B]=new zb.a),h[B].add(ca))}}b=new zb.a;for(const Q of mb.a.eP(h))u=this.Mxj(h[Q],2),b.addRange(u);return b}u9l(b,h){let u="";for(let B of h)u+=B,u=b.properties.nb(B)&&
void 0!==b.properties.J(B)&&null!==b.properties.J(B)?u+b.properties.J(B):u+"null";return u}}Object(m.a)(gd,"ActivityAggregationSchemes",null,[774]);class Md{constructor(b,h,u,B,Q){this.ps=this.fi=0;this.UTb=u;this.bqc=B;this.JVa=Q;this.name=b;this.iz=h;this.LCa=new zb.a}get mode(){return this.iz}get count(){return this.LCa.count}get startTime(){return this.fi}get endTime(){return this.ps}get UTh(){if(!this.count)return 0;let b=0;for(let h of this.LCa)b+=h.endTime-h.startTime;return b/this.count}get irl(){if(!this.count)return 0;
let b=0;const h=this.UTh;for(let u of this.LCa){const B=u.endTime-u.startTime;b+=(B-h)*(B-h)}return b/this.count}add(b){this.count?this.ps=b.endTime>this.endTime?b.endTime:this.endTime:(this.fi=b.startTime,this.ps=b.endTime);this.LCa.add(b)}wVm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.UTb.iMi}process(){if(this.count>=this.UTb.yNi){const b=new zb.a,h=this.bqc(this);b.add(h);return b}return this.LCa}ssf(b){const h=new zb.a;for(let u of this.LCa)if(u.properties.nb(b)){const B=u.properties.J(b);
h.add(B)}else h.add(null);return h}Zsf(){const b=this.JVa.PQc(this.name),h=new Mb.a;for(let u of this.pLl())b.contains(u)||h.add(u);return h}pLl(){const b=new Mb.a;if(!this.LCa)return b;for(let h of this.LCa)for(let u of h.properties.keys)b.add(u);return b}CWl(){return this.LCa.J(0).uniqueID}}Object(m.a)(Md,"ActivityCollection",null,[773]);class ie{constructor(){this.$sb=new Va.a}get list(){return this.$sb}add(b){const h=b.activityName;if(this.$sb.nb(h)&&this.$sb.J(h)){const u=this.LZl(this.$sb.J(h),
b);this.$sb.J(h).insert(u,b)}else this.$sb.Z(h,new zb.a),this.$sb.J(h).add(b)}LZl(b,h){for(let u=b.count-1;0<=u;u--)if(h.startTime>b.J(u).startTime)return u+1;return 0}}Object(m.a)(ie,"CompletedActivitiesHelper",null,[772]);class hf{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){v.AFrameworkApplication.lI(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}wc(b){this.W=b;const h=B=>new xb(()=>b.Oa("Common.App.Activities.IActivityAggregationManager"),
B),u=(B,Q)=>new Md(B,Q,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Lc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().Sd(()=>new Lc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Re("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Ac,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().Sd(()=>new Ac(v.AFrameworkApplication.K));b.register(mc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().Sd(()=>new mc);b.register(gd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().Sd(()=>new gd(b.resolve("Common.IActivityAggregationInfo"),
u));b.register(ie,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().Sd(()=>new ie)}static main(){M.a.instance.Gc(new hf)}}Object(m.a)(hf,"ActivityAggregatorPackage",null,[1,2]);var Ue=c(532),Kd=c(11),Wc=c(1394);class Zc{constructor(b){this.rah=0;this.Kue=null;this.Fek=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get feg(){return this.Fek.value}Tb(){this.isInitialized?this.yic():this.sUn(Object(z.a)(this,this.yic,"registerActionsInternal"))}yic(){r.ULS.sendTraceTag(50595938,
333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.Djn,"onChatContainerReady"))}).catch(b=>{r.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.rTk,"chatCountChanged"))}).catch(b=>{r.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>
{b.onKeyDown(Object(z.a)(this,this.Gjn,"onChatKeyPress"))}).catch(b=>{r.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){r.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}rTk(b){r.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.feg.Cjn();else if(1===b&&!this.rah){const h=document.getElementById(this.Kue?this.Kue:Wc.a.KBb);h?this.feg.Hjn(h,Object(z.a)(this,this.CKo,"transferFocusToChat")):r.ULS.sendTraceTag(50595971,
333,10,"Chat parent is null")}this.rah=b}Djn(b){this.Kue=b}Gjn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.BKo(b.shiftKey)}sUn(b){Ue.a.instance.ob(Kd.a.CDo,window.self,()=>{b();return!0})}CKo(){r.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{r.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){r.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",
b)}}BKo(b){r.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.feg.Ejn(b)}}Object(m.a)(Zc,"ChatManager",null,[768]);var Nc=c(80);class ge{constructor(){this.sa=new Nc.a;this.$kk=!1}Qwk(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}Awk(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get sJo(){return this.$kk}d5i(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(m.a)(ge,"HeaderEventSource",null,[]);var $d=c(173),te=c(332),
Se=c(79);class tc{constructor(b,h,u,B,Q){this.yyd=null;this.Vb=b;this.hp=h;this.qk=u;this.clk=B;this.ga=Q}K7i(b,h,u,B=null){const Q=this.Vb.ae(h);Q.parent=u;Q.$H=!0;B&&Q.K7(B);this.qk.MCa(h,b,!1);this.clk.MCa(h,b,!1);h=new te.DOMFocusListing(()=>b);h.Mm(2);h.Mm(1);h.Mm(8);h.Mm(5);h.Mm(3);h.Mm(6);this.Vb.Vma(()=>b,Q,h).xP=!0;h=Nb.KeyInputManager.ic(Se.a.Fw,0);u=Nb.KeyInputManager.ic(Se.a.Fw,4);Q.kr(h);Q.kr(u)}onFlexPaneOpen(b){this.K7i(b,Wc.a.gfc,Wc.a.fQa);this.Vb.kg(Wc.a.gfc);this.hp.J7(Wc.a.gfc)}onFlexPaneClose(){this.hp.$w(Wc.a.gfc);
this.Vb.kg(Wc.a.fQa)}Hjn(b,h){this.yyd||(this.yyd=h,this.K7i(b,Wc.a.KBb,$d.AFrame.tM,Object(z.a)(this,this.Fjn,"onChatFocus")));this.Vb.kg(Wc.a.KBb);this.hp.J7(Wc.a.KBb)}Fjn(){this.yyd&&this.yyd()}Cjn(){this.hp.$w(Wc.a.KBb);this.Vb.DOd($d.AFrame.Un)}Ejn(b){this.ga.processAction(b?Za.a.Pif:Za.a.Ope,2)}}Object(m.a)(tc,"ReactSharedHeaderFocusManager",null,[767]);var dd=c(127),Ed=c(1061),Qd=c(39),Ad=c(70);class Oe{constructor(b){this.ga=b}Tb(){this.ga.ra(Za.a.QOd,Ad.a.frame,Object(z.a)(this,this.ePi,
"navigateToUpsellPage"));this.ga.ra(Za.a.K1h,Ad.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.ra(Za.a.o2n,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.wbj,Ad.a.frame,dd.ActionManager.Lf)}ePi(b,h,u,B,Q){if(1===u)return 32;b=8;2===u&&(u=this.Knf(Q,"experience","gopremiumribbon"),Q=fa.a.U8("2116536"),Q=fa.a.Rn(Q,"ocid",Ed.b(v.AFrameworkApplication.ua.Lb.Nk,v.AFrameworkApplication.ua.Lb.Jia,u)),Qd.a.om(Q,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(Za.a.wbj,
2),r.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,u,B,Q){if(1===u)return 32;var ca=8;2===u&&(r.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=Ga.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.Knf(Q,"experience","gopremium"),Q=this.Knf(Q,"dimeCampaignId",null),ca.launchUpsellExperience(b,Q),ca=32):(r.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.ePi(b,
h,u,B,Q)));return ca}Knf(b,h,u){b&&b[h]&&(u=Object(Na.a)(String,b[h]));return u}}Object(m.a)(Oe,"UpsellActor",null,[766]);class pf{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ga.a.instance.resolve("Common.App.Header.IUpsellActor").Tb();Ga.a.instance.resolve("Common.App.Header.IChatManager").Tb()}dispose(){}wc(b){this.W=b;this.W.register(ge,"Common.App.Header.HeaderEventSource").ha();this.W.register(Oe,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().Sd(()=>
new Oe(v.AFrameworkApplication.va));this.W.register(tc,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().Sd(()=>new tc(v.AFrameworkApplication.ua.Dp,v.AFrameworkApplication.ua.ux,v.AFrameworkApplication.ua.M1,v.AFrameworkApplication.ua.$ke,v.AFrameworkApplication.va));this.W.register(Zc,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().Sd(()=>new Zc(this.W.Re("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){M.a.instance.Gc(new pf)}}
Object(m.a)(pf,"CommonAppHeaderPackage",null,[1,2]);var Fh=c(756);class Ig{static R3h(b,h){switch(b){case 3:return Ig.hjm(h);case 2:return Ig.T5l(h);case 1:return Ig.jVl(h)}return""}static hjm(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static T5l(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static jVl(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,u){if(Z.a.ri||Z.a.TH)window.setTimeout(()=>{Ig.a7i(u,Ig.mUd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Ig.Vrh(u),b,0,!1)}static XXk(b,h,u,B){h&&
B&&B();Ig.openInClient(b,h,u)}static mUd(){return Z.a.ri?1:Z.a.TH?2:Z.a.B4a?3:Z.a.Wk?4:0}static Rim(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static Sim(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get QEf(){return"zh-CN"===window.navigator.language}static a7i(b,h){1===h?(r.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=Ig.R3h(b,h),8<Z.a.b3a?Qd.a.om(b,void 0,void 0,"RedirectToAppStore"):Qd.a.KEb(b)):document.hidden||(Ig.QEf?(b=v.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(r.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Qd.a.KEb(b)):r.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(r.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Ig.R3h(b,
h),null,null)))}static Vrh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Nhe(){return(Z.a.B4a||Z.a.Wk)&&Z.a.Cr}static get Qro(){return Z.a.ri||Z.a.TH}static k4h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static myi(b){return(b=Ig.E_l(b))&&""!==b?Boolean.parse(b):!1}static Adg(b){Ig.yho(b)}static E_l(b){try{return localStorage.getItem(b)}catch(h){return r.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static yho(b){try{localStorage.setItem(b,"true")}catch(h){r.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}Ig.GCh="ChromeExtensionBarDismiss";Object(m.a)(Ig,"WildFireUtilities",null,[]);var Jh=c(365);class xg{constructor(){this.Ase=new Jh.a;this.yse=new Jh.a;this.xse=new Jh.a;this.hLk(this.Ase);this.gLk(this.yse);this.fLk(this.xse);this.aDe=new Jh.a;
this.$Ce=new Jh.a;this.ZCe=new Jh.a;this.JNk(this.aDe);this.INk(this.$Ce);this.HNk(this.ZCe);this.bve=new Jh.a;this.rLk(this.bve);this.iAb(this.bve);this.iAb(this.xse);this.iAb(this.yse);this.iAb(this.Ase);this.iAb(this.$Ce);this.iAb(this.aDe);this.iAb(this.ZCe)}zTd(b,h){switch(b){case 1:return this.Yjm(h);case 2:return this.PLl(h)}return Ig.Nhe?this.bve:null}hLk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}gLk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}fLk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}JNk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}rLk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}INk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}HNk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}iAb(b){b.add("Corporation","Microsoft Corporation")}Yjm(b){switch(b){case 3:return this.aDe;case 2:return this.$Ce;case 1:return this.ZCe}return null}PLl(b){switch(b){case 3:return this.Ase;case 2:return this.yse;case 1:return this.xse}return null}static get instance(){xg._instance||
(xg._instance=new xg);return xg._instance}}xg._instance=null;Object(m.a)(xg,"WildFireStringFactory",null,[]);class bc{constructor(b,h,u,B,Q=null,ca=null){this.RLe=null;this._id=b;this.sNe=h;this.c3j=Q;this.Hwc=B;this.VBc=ca;this.T9a=null;this.kEc=u;this.bDc=xg.instance.zTd(h,b)}Q7k(){this.T9a=new Fh.a(this.title,this.message,null);this.T9a.addButton(this.$Nk,Object(z.a)(this,this.kjn,"onButtonOneClick"),"");this.kEc&&this.T9a.koh(this.fOk,Object(z.a)(this,this.pjn,"onButtonTwoClick"));this.T9a.xga=
Object(z.a)(this,this.cnl,"dismissBar");this.T9a.image=3;this.T9a.id=16;this.T9a.closeable=!0}get title(){return this.bDc.J("Headline")}get message(){return this.bDc.J("CallToAction")}get $Nk(){return this.kEc?this.bDc.J("InstallButton"):this.bDc.J("UseAppButton")}get fOk(){return this.kEc?this.bDc.J("OpenAppButton"):""}kjn(){this.kEc?this.XCm():this.aZo()}pjn(){this.kEc&&this.Xtn()}get fyh(){return this.T9a}get pHa(){this.RLe||(this.RLe=this.c3j());return this.RLe}XCm(){r.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.Hwc&&this.VBc&&this.VBc();Ig.a7i(this._id,this.sNe)}Xtn(){this.pHa&&(r.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Hwc&&this.VBc&&this.VBc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Ig.Vrh(this._id),this.pHa,0,!1))}aZo(){Ig.Nhe?this.WNk():(r.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Ig.Adg("BizBarClicked"),1!==this.sNe&&2!==this.sNe||Ig.XXk(this.pHa,this.Hwc,this._id,this.VBc))}WNk(){this.Hwc?
r.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):r.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Qd.a.KEb(v.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}dnl(){this.Hwc?r.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):r.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Ig.Adg(Ig.GCh)}cnl(){Ig.Nhe?this.dnl():(Ig.Adg(Ig.k4h(this._id)),r.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static fbf(){const b=v.AFrameworkApplication.ua.Lb;
new bc(b.Nk,Ig.mUd(),8<Z.a.b3a,1===b.Jia,()=>b.g8,b.x$f());r.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(m.a)(bc,"WildFireBusinessBar",null,[]);class Bc{get name(){return"Common.App.WildFire"}qYe(b){const h=v.AFrameworkApplication.ua.Lb;let u=!1;b&&(b.Q7k(),b.fyh&&(u=h.Bma(b.fyh,!0)));return u}V7k(){var b=v.AFrameworkApplication.ua.Lb;b=new bc(b.Nk,Ig.mUd(),!1,1===b.Jia);this.qYe(b)&&r.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}fbf(b,h,u,B,Q,ca){b=new bc(b,
u,B,h,Q,ca);this.qYe(b)&&r.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Xdl(){const b=v.AFrameworkApplication.ua.Lb;var h=v.AFrameworkApplication.K;const u=b.Nk,B=1===b.Jia;if(h.$(Ig.Rim(u))){var Q=Ig.mUd(),ca=8<Z.a.b3a;if(2!==u||2!==Q||!B){h=h.$(Ig.Sim(u));var qa=b.x$f(),Qa=()=>b.g8;h&&!Ig.myi(Ig.k4h(u))&&this.fbf(u,B,Q,ca,Qa,qa)}}}init(){var b=v.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;Ig.Nhe&&b&&!Ig.myi(Ig.GCh)?this.V7k():
(document.body&&Ig.Qro&&this.Xdl(),v.AFrameworkApplication.va.ra(Za.a.eJf,Ad.a.frame,Object(z.a)(this,this.eJf,"launchWildFireBusinessBar")))}eJf(b,h,u,B,Q){if(1===u)return 32;if(!Q)return 8;this.fbf(Q.app,Q.mode,Q.platform,Q.useTwoButton,null,null);return 32}dispose(){}wc(){}static main(){M.a.instance.Gc(new Bc)}}Object(m.a)(Bc,"PackageManager",null,[1,2]);class ad{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(ad,"BrowserInfo",null,[]);class zd{constructor(){this.Version=
this.Name=null}}Object(m.a)(zd,"PluginInfo",null,[]);class Xd{static ida(){if(v.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=Xd.kIl();try{const h=JSON.stringify(b);r.ULS.sendTraceTag(6903563,102,50,h)}catch(h){r.ULS.sendTraceTag(6903564,102,15,h.message)}}else r.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static d8l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let u=0;u<b.length;u++){const B=b[u].name,Q=b[u].version;
Array.add(h,Object.assign(new zd,{Name:B,Version:Q}))}return h}static kIl(){const b=new ad,h=new Sys.StringBuilder;Xd.OH(u=>{b.DocElemClientHeight=u},()=>document.documentElement.clientHeight,h);Xd.OH(u=>{b.DocElemClientWidth=u},()=>document.documentElement.clientWidth,h);Xd.OH(u=>{b.DocElemOffsetHeight=u},()=>document.documentElement.offsetHeight,h);Xd.OH(u=>{b.DocElemOffsetWidth=u},()=>document.documentElement.offsetWidth,h);Xd.OH(u=>{b.ScreenAvailHeight=u},()=>window.screen.availHeight,h);Xd.OH(u=>
{b.ScreenAvailWidth=u},()=>window.screen.availWidth,h);Xd.OH(u=>{b.ScreenWidth=u},()=>window.screen.width,h);Xd.OH(u=>{b.ScreenHeight=u},()=>window.screen.height,h);Xd.OH(u=>{b.ScreenLogicalXdpi=u},()=>window.screen.logicalXDPI,h);Xd.OH(u=>{b.ScreenLogicalYdpi=u},()=>window.screen.logicalYDPI,h);Xd.OH(u=>{b.ScreenDeviceXdpi=u},()=>window.screen.deviceXDPI,h);Xd.OH(u=>{b.ScreenDeviceYdpi=u},()=>window.screen.deviceYDPI,h);Xd.OH(u=>{b.WinInnerHeight=u},()=>window.self.innerHeight,h);Xd.OH(u=>{b.WinInnerWidth=
u},()=>window.self.innerWidth,h);Xd.OH(u=>{b.WinOuterHeight=u},()=>window.self.outerHeight,h);Xd.OH(u=>{b.WinOuterWidth=u},()=>window.self.outerWidth,h);Xd.OH(u=>{b.WinOrientation=u},()=>window.self.orientation,h);Xd.OH(u=>{b.WinDevicePixelRatio=u},()=>window.self.devicePixelRatio,h);Xd.OH(u=>{b.SupportsTouch=u},()=>Z.a.kad,h);Xd.OH(u=>{b.NavAppName=u},()=>window.navigator.appName,h);Xd.OH(u=>{b.NavAppVersion=u},()=>window.navigator.appVersion,h);Xd.OH(u=>{b.NavLanguage=u},()=>window.navigator.browserLanguage||
window.navigator.language,h);Xd.OH(u=>{b.NavUserAgent=u},()=>window.navigator.userAgent,h);Xd.OH(u=>{b.NavPlatform=u},()=>window.navigator.platform,h);Xd.OH(u=>{b.NavPlugins=u},Xd.d8l,h);Xd.OH(u=>{b.CalculatedDevicePixelRatio=u},()=>Xd.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static OH(b,h,u){try{const B=h();b(B)}catch(B){u.isEmpty()||u.append(" | "),u.append(B.message||
"null")}}}Object(m.a)(Xd,"BrowserInfoLogger",null,[]);class Gd{get name(){return"Common.App.BrowserInfoLogger"}wc(){}init(){Xd.ida()}dispose(){}static main(){M.a.instance.Gc(new Gd)}}Object(m.a)(Gd,"BrowserInfoLoggerPackage",null,[1,2]);class Ze{constructor(){this.sa=new Nc.a}reb(b){this.sa.addHandler("OnEditHappenedEvent",b)}a6c(b){this.sa.removeHandler("OnEditHappenedEvent",b)}tLn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Ze,"EditNotificationEventSource",null,[]);var Fe=c(42),bf=
c(92);class ag{constructor(b,h,u,B,Q,ca,qa=0){this.Zye=!1;this.Yye=this.Twb=null;this.Ljh=!1;this.Ib=h;this.grd=b;this.ebb=u;this.Yea=B;this.Jjh=Q;this.K_j=ca;this.Bjd=0;this.Hld=!1;try{0<qa&&(this.Bjd=qa,3E5>this.Bjd&&(this.Bjd=3E5),this.Ib&&!this.Yye&&(this.Yye=new bf.a(3,2,this.Bjd,Object(z.a)(this,this.i2n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Ib.Xb(this.Yye)))}catch(Qa){r.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Qa)}}get Apg(){return this.Ljh}editHappened(){this.Apg?this.Hld=!0:(this.Ljh=!0,xa.Health.instance.addQosPillar("Save"),xa.Health.instance.addQosPillar("ContentCreation"),Fe.c(Za.a.editDocument));this.Zye=!0;this.Jjh&&this.Jjh.fmh();this.Yea&&this.Yea.tLn();v.AFrameworkApplication.Kg&&v.AFrameworkApplication.Kg.n8m();this.K_j&&!this.Twb&&(this.d8c(null),this.Twb=new bf.a(3,2,this.grd,Object(z.a)(this,this.d8c,"sendPostMessageIfNecessary"),113),this.Ib.Xb(this.Twb))}d8c(){this.Zye&&(this.ebb.CWR(()=>
this.ebb.result.sendMessage(L.a.editNotification,null)),r.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Zye=!1)}i2n(){try{this.Hld&&(Fe.c(Za.a.editDocument),this.Hld=!1)}catch(b){this.Hld=!1,r.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(m.a)(ag,"EditNotificationManager",null,[771]);class Xf{constructor(b,h,u,B,Q){this.aCe=this.Twb=null;this.WWb=this.Mre=!1;this.Ib=h;this.grd=
b;this.ebb=u;this.qk=B;this.jLe=Q;this.R7i(null)}R7i(){const b=document.getElementById(v.AFrameworkApplication.I2b);!this.WWb&&this.qk&&b&&(this.qk.ob(Kd.a.W0,b,Object(z.a)(this,this.QOf,"mouseActivityHandler"),null),this.WWb=!0);this.jLe(()=>{this.dispose()})}QOf(){this.WWb&&(this.qk.sc(Kd.a.W0,document.getElementById(v.AFrameworkApplication.I2b),Object(z.a)(this,this.QOf,"mouseActivityHandler")),this.WWb=!1);this.fmh();return!1}fmh(){this.Mre=!0;this.aCe||(this.aCe=new bf.a(3,2,this.grd,Object(z.a)(this,
this.R7i,"registerHandlerTask"),112),this.Ib.Xb(this.aCe));this.Twb||(this.d8c(null),this.Twb=new bf.a(3,2,this.grd,Object(z.a)(this,this.d8c,"sendPostMessageIfNecessary"),111),this.Ib.Xb(this.Twb))}d8c(){this.Mre&&(this.ebb.CWR(()=>this.ebb.result.sendMessage(L.a.yZo,null)),r.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Mre=!1)}dispose(){this.WWb&&(this.qk.sc(Kd.a.W0,document.getElementById(v.AFrameworkApplication.I2b),Object(z.a)(this,
this.QOf,"mouseActivityHandler")),this.WWb=!1)}}Object(m.a)(Xf,"UserActivityHostNotificationManager",null,[770,10]);var vf=c(175),Bg=c(107),ob=c(633);class $b{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Hn(Object(z.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){$b.Frl&&0<$b.bgf&&(this.W.register(Ze,"Common.App.HostNotification.EditNotificationEventSource").ha(),this.W.register(Xf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().Sd(()=>
new Xf(6E4,Bg.a.instance,ob.a.Bp(this.W.Ta("Postmessage.IHostPostmessenger")),vf.a.instance,v.AFrameworkApplication.lI)),this.W.register(ag,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().Sd(()=>new ag($b.bgf,Bg.a.instance,ob.a.Bp(this.W.Ta("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Oa("Common.Interface.IUserActivityHostNotificationManager"),$b.Grl,$b.zrl)),this.W.resolve("Common.Interface.IEditNotificationManager"),
r.ULS.shipAssertTag(38086291,209,0<$b.bgf,"EditNotification Interval is less than or equal to 0."))}wc(b){this.W=b}dispose(){}static get bgf(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get zrl(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get Frl(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get Grl(){return!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){M.a.instance.Gc(new $b)}}Object(m.a)($b,"CommonHostNotificationPackage",null,[1,2]);class Uc{constructor(b,h,u){this.Pyb=null;this.Ib=b;this.ga=h;this.yUg=u.create()}vob(){this.Pyb?r.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(r.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.Pyb=new bf.a(2,1,3E4,Object(z.a)(this,this.$he,"showFloatPane"),
67),this.Ib.Xb(this.Pyb))}$he(){this.Pyb=null;r.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.yUg.display()}bTa(){this.ga.ra(Za.a.$he,Ad.a.frame,Object(z.a)(this,this.$to,"showFloatPaneHandler"))}$to(b,h,u,B,Q){return b!==Za.a.$he?2:1===u?32:2===u&&Q?(r.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Q),Q?this.vob():(this.Pyb?(r.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Ib.Ze(this.Pyb)):(r.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.yUg.remove(null)),this.Pyb=null),32):8}}Object(m.a)(Uc,"FloatPaneActor",null,[686]);var Pd=c(97),ze=c(90),Me=c(38),af=c(28);class Hg{constructor(b,h,u,B,Q){this.BIe=this.Dvc=this.fud=this.FYa=this.Afa=this.XVa=this.Ste=this.Naa=this.gAc=this.ayc=this.byc=this.GAe=null;this.Ib=h;this.Ga=b;this.gg=u;this.W=Q;this.uAa=B}dKh(){this.Naa=document.createElement("div");this.Naa.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.Naa.style.width=this.Afa.width+"px";(this.BIe=this.O4l(this.uAa))?(this.FYa=document.createElement("a"),this.FYa.setAttribute(af.a.oh,af.a.rz),this.gg.ob(Kd.a.click,this.FYa,Object(z.a)(this,this.OVi,"onRedirectClick")),this.FYa.href=this.BIe,this.FYa.target="_blank",this.FYa.appendChild(this.Afa),this.Naa.appendChild(this.FYa)):this.Naa.appendChild(this.Afa);this.XVa=document.createElement("a");this.XVa.setAttribute(af.a.oh,af.a.L3);this.XVa.className="StandardButton WACFloatPaneCloseButton";
this.XVa.title=CommonUIStrings.l_Close;this.XVa.tabIndex=-1;this.Ste=ze.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Ste.setAttribute(af.a.oh,af.a.rz);this.XVa.appendChild(this.Ste);this.gg.ob(Kd.a.click,this.XVa,Object(z.a)(this,this.onClose,"onClose"));this.Naa.appendChild(this.XVa);this.gAc.appendChild(this.Naa)}wZl(b){const h=this.Ga.$("O365PromotionHasStarted");switch(b){case 2:return Pd.a.Iba(String.format("adppt{0}.png",
h?"sale":""));case 1:return Pd.a.Iba(String.format("adxls{0}.png",h?"sale":""));case 3:return Pd.a.Iba(String.format("addoc{0}.png",h?"sale":""))}return null}O4l(b){const h=this.Ga.kb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.Dvc=null;this.Naa&&!this.fud&&(b?r.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):r.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.Naa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Naa.style.height="0px",this.fud=new bf.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Ib.Xb(this.fud))}remove(){this.Naa&&this.gAc&&(this.FYa&&this.gg.sc(Kd.a.click,this.FYa,Object(z.a)(this,this.OVi,"onRedirectClick")),this.gg.sc(Kd.a.click,this.XVa,Object(z.a)(this,this.onClose,"onClose")),this.gAc.removeChild(this.Naa),this.Naa=null);this.fud=null}display(){if(this.GAe=
this.W.Oa("Common.IFloatPaneContainer"))if(this.gAc=this.GAe.container){var b=this.wZl(this.uAa);b?(r.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Afa=document.createElement("img"),this.Afa.className="WACFloatPaneImage",this.byc=Object(z.a)(this,this.Vnn,"onLoadImageFinish"),Me.a.addHandler(this.Afa,Kd.a.load,this.byc),this.ayc=Object(z.a)(this,this.Unn,"onLoadImageError"),Me.a.addHandler(this.Afa,Kd.a.error,this.ayc),this.Afa.src=b):r.ULS.sendTraceTag(23674907,
207,15,"The target image is empty, can't show the float pane.")}else r.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else r.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Vnn(){const b=this.Ga.lc("O365AdPaneShowingDuration",60);this.dKh();this.Naa.style.display="block";this.Naa.style.height=this.Afa.height+"px";this.Dvc=new bf.a(2,1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Ib.Xb(this.Dvc);
this.x9i()}Unn(){r.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.x9i();this.Afa=null}x9i(){this.byc&&this.Afa&&Me.a.removeHandler(this.Afa,Kd.a.load,this.byc);this.byc=null;this.ayc&&this.Afa&&Me.a.removeHandler(this.Afa,Kd.a.error,this.ayc);this.ayc=null}OVi(){r.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Dvc&&this.Ib.Ze(this.Dvc);this.hide();return!0}dispose(){this.hide()}}
Object(m.a)(Hg,"FloatPane",null,[696]);class wi{constructor(b,h,u,B,Q){this.Ib=h;this.Ga=b;this.gg=u;this.W=Q;this.uAa=B}create(){return new Hg(this.Ga,this.Ib,this.gg,this.uAa,this.W)}}Object(m.a)(wi,"FloatPaneFactory",null,[685]);var Wi=c(231);class Mf{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get Jwi(){return v.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&v.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.Jwi&&(r.ULS.sendTraceTag(23674944,
207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").vob(),r.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").bTa())}wc(b){this.W=b;this.Jwi&&(this.W.register(wi,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Sd(()=>new wi(v.AFrameworkApplication.K,v.AFrameworkApplication.oc,Wi.a.instance,v.AFrameworkApplication.ua.Lb.Nk,this.W)).ha(),
this.W.register(Uc,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Sd(()=>new Uc(v.AFrameworkApplication.oc,v.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){M.a.instance.Gc(new Mf)}}Object(m.a)(Mf,"FloatPanePackage",null,[1,2]);var Zg=c(1662);class zf{}Object(m.a)(zf,"LokiTokenResult",null,[]);class ii{constructor(b){this.ord=b}Yqf(){const b=this.P1l();return b?ii.l4a?new Promise((h,u)=>{this.ord.continueWith(()=>
{this.ord.Eo||this.ord.Ei?u(Error.create("Error downloading auth library")):this.ord.result.EV("Loki",b).then(B=>{B=v.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.S1l():B.IsSuccess&&B.Token?Object.assign(new zf,{isSuccess:!0,token:B.Token,errorMessage:null}):Object.assign(new zf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(B)});h(B);return B})})}):Promise.resolve(Object.assign(new zf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new zf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Zg.a.Z3h())}))}S1l(){const b=v.AFrameworkApplication.K.kb("LokiUserDataSignature")||"";return Object.assign(new zf,{isSuccess:!0,token:b,errorMessage:null})}P1l(){let b=null;const h=Zg.a.sPd();2===h?b=v.AFrameworkApplication.K.kb("LokiAADAppId"):1===h&&(b=v.AFrameworkApplication.K.kb("LokiMSAAppId"));return b}static get l4a(){return v.AFrameworkApplication.K.$("IsO365CommercialHost")||
v.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(m.a)(ii,"LokiTokenManager",null,[662]);class Af{get name(){return"Common.App.LivePersonaUtils"}init(){Ga.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}wc(b){b.register(ii,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().Sd(()=>new ii(ob.a.Bp(b.Ta("Common.App.OAuth.IOAuthManager"))))}static main(){M.a.instance.Gc(new Af)}}Object(m.a)(Af,"LivePersonaUtilsPackage",null,[1,2]);class jg{constructor(b){this.sse=
b}Ovi(b){if(!this.sse)return!0;b=fa.a.Ypf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.sse.length;h++)if(b.endsWith(this.sse[h]))return!0;return!1}}Object(m.a)(jg,"DomainAllowListManager",null,[]);class Rf{constructor(b,h){this.ecf=null;this.SUe=b;this.url=h}get hpg(){return fa.a.wja(this.url)}get ks(){return this.SUe}llg(){const b={},h=this.ks;b.a=this.hpg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.ecf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(m.a)(Rf,"PerformanceTimingEntry",null,[]);const lj=(b,h)=>{const u={};let B=null;switch(b){case 0:B="ResourceTiming";b=h.a;null!=b&&(u.Url=b);b=h.b;null!=b&&(u.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(u.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(u.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(u.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(u.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(u.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(u.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(u.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(u.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(u.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(u.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(u.ResponseEnd=b);b=h.n;
null!=b&&(u.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(u.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(u.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(u.TransferSize=h);break;case 1:B="PerformanceTiming",b=h.a,null!=b&&(u.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(u.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(u.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(u.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(u.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(u.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(u.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(u.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(u.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(u.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(u.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(u.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(u.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(u.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(u.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(u.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(u.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(u.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(u.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(u.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(u.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(u.LoadEventEnd=b),h=h.w,null!=h&&(u.CustomText=h)}u.Table=B;return Sys.Serialization.JavaScriptSerializer.serialize(u)};var Qh=c(49),ei=c(234),cl=c(167);class ul{constructor(b,h=null,u=null){this.Rf=b;this.gpg=this;this.i2j=h||(()=>window.location.href);this.Gye=new jg(u)}run(){if(ul.bfb(window.performance))try{const Q=this.i2j();if(ul.llk.exec(Q)&&this.Gye.Ovi(Q)){var b=new Rf(window.performance.timing,Q);cl.a.instance.sOn(b.ks.fetchStart);cl.a.instance.tOn(b.ks.navigationStart);
cl.a.instance.GY(Qh.a.yHl,"connectStart","requestStart");cl.a.instance.GY(Qh.a.GHl,"requestStart","responseStart");cl.a.instance.GY(Qh.a.JHl,"responseStart","responseEnd");this.gpg.U4a(1,b.llg());this.Rf.lf(Qh.a.Whb,b.ks.fetchStart);this.Rf.lf(Qh.a.DHl,b.ks.domainLookupStart);this.Rf.lf(Qh.a.CHl,b.ks.domainLookupEnd);this.Rf.lf(Qh.a.AHl,b.ks.connectStart);this.Rf.lf(Qh.a.LHl,b.ks.secureConnectionStart);this.Rf.lf(Qh.a.zHl,b.ks.connectEnd);this.Rf.lf(Qh.a.HHl,b.ks.requestStart);this.Rf.lf(Qh.a.Blf,
b.ks.responseStart);this.Rf.lf(Qh.a.EHl,b.ks.responseEnd-b.ks.responseStart);this.Rf.lf(Qh.a.IHl,b.ks.responseStart-b.ks.requestStart);var h=0,u=0,B=0;({transferSize:h,Qgf:u,Bcf:B}=this.tNo(Q)).returnValue&&(this.Rf.lf(Qh.a.NHl,h),this.Rf.lf(Qh.a.BHl,B),this.Rf.lf(Qh.a.FHl,u));this.Rf.lf(Qh.a.iOc,b.ks.navigationStart)}}catch(Q){r.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Q)}}tNo(b){let h,u,B;B=u=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,Qgf:u,Bcf:B};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,Qgf:u,Bcf:B};b=b[0];var Q=b.transferSize;void 0!==h&&null!==h&&(h=Q);Q=b.decodedBodySize;void 0!==Q&&null!==Q&&(B=Q);b=b.encodedBodySize;void 0!==b&&null!==b&&(u=b);return{returnValue:!0,transferSize:h,Qgf:u,Bcf:B}}U4a(b,h){r.ULS.sendTraceTag(4551815,306,50,lj(b,h))}static get instance(){return ul._instance||
(ul._instance=new ul(ei.a.instance,null,v.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.K.BB("ResourceLoggerDomainAllowList"):null))}static bfb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}ul._instance=null;ul.llk=RegExp("^https?://.*","i");Object(m.a)(ul,"PerformanceTimingLogger",null,[663]);class qi{constructor(b,h){this.ecf=null;this.SUe=b;this.behavior=h;this.url=this.ks.name}get hpg(){return 2===this.behavior?this.url:
fa.a.wja(this.url)}get ks(){return this.SUe}llg(){const b={},h=this.ks;b.a=this.hpg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(qi.Wib(h,"decodedBodySize"));b.p=this.round(qi.Wib(h,"encodedBodySize"));b.q=this.round(qi.Wib(h,"transferSize"));b.n=this.ecf;return b}round(b){return Math.round(1E3*b)/1E3}static Wib(b,h){return b[h]}}Object(m.a)(qi,"ResourceTimingEntry",null,[698]);class Jg{constructor(b,h=null,u=100){this.nKg=b;this.Owd=h;this.Q9a={};this.wWj=u}YLo(b){var h=b.name.toLowerCase();const u=fa.a.oGb(h);this.Tcj(u,h)&&(u in this.Q9a?r.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
u):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.oCi(b),h.encodedsize=qi.Wib(b,"encodedBodySize"),h.decodedsize=qi.Wib(b,"decodedBodySize"),this.Q9a[u]=h))}ZLo(b){var h=b.name.toLowerCase();const u=fa.a.oGb(h);this.Z4n(u,h)&&(u in this.Q9a?r.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",u):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.oCi(b),h.encodedsize=qi.Wib(b,"encodedBodySize"),
h.decodedsize=qi.Wib(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.Q9a[u]=h))}Tcj(b,h){if(this.nKg)return Array.contains(this.nKg,b);if(this.Owd)for(b=fa.a.OX(h),h=0;h<this.Owd.length;h++)if(this.Owd[h]&&b.endsWith(this.Owd[h]))return!0;return!1}Z4n(b,h){return this.Tcj(b,h)?b.endsWith(".js")||b.endsWith(".css"):
!1}oCi(b){try{const h=qi.Wib(b,"transferSize");if(void 0!==h&&null!==h)return!h;r.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.wWj}catch(h){r.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}SQn(){if(mb.a.Xe(this.Q9a))r.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var b=v.AFrameworkApplication.flightId?v.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new Ub.a,{extendedProperties:ib.a.oG()});h.extendedProperties.set("Flights",G.c(b));this.nJi(h,this.Q9a,xa.Health.instance)}}xmf(b){let h=0,u=0,B=0,Q=0;const ca=this.Q9a;for(let Qa in ca){var qa=ca[Qa];Qa.endsWith(".js")&&(qa=Object(Na.a)(Object,qa),qa.responseend<b&&(h+=1,u+=qa.decodedsize,Q+=qa.encodedsize,B+=qa.iscached?0:qa.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=u;b.transferredBytes=
B;b.encodedBytes=Q;return b}nJi(b,h,u){if(h){var B=0,Q=0,ca=0,qa=0,Qa=0,rb=0,Lb=0,Yb=0,gc=0,Fc=0,Sc=0;for(let Hd in h){var ld=h[Hd];try{const Ie=Object(Na.a)(Object,ld);if(!Ie)continue;const fe=Ie.iscached?Boolean.parse(Ie.iscached.toString()):!1,de=Ie.fetchstart?this.parseFloat(Ie.fetchstart.toString()):0,ne=(Ie.responseend?this.parseFloat(Ie.responseend.toString()):0)-de,ye=Ie.encodedsize?this.parseFloat(Ie.encodedsize.toString()):0,Vf=Ie.decodedsize?this.parseFloat(Ie.decodedsize.toString()):0;
B+=ne;qa+=ye;Lb+=Vf;Fc++;fe?(ca+=ne,rb+=ye,gc+=Vf,Sc++):(Q+=ne,Qa+=ye,Yb+=Vf)}catch(Ie){r.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Ie.message)}}b.extendedProperties.set("StaticResources",G.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",B.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Q.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
qa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Qa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",rb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Lb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Yb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",gc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Fc.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Sc.toString());u.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);u.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(m.a)(Jg,"AppStaticResourceManager",null,[]);class xi extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(m.a)(xi,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Fj{constructor(b,
h,u=null,B=null,Q=100,ca=!1){this.IGe=!1;this.Ao=null;this.xsc=0;this.sa=new Nc.a;this.zsb=null;this.VZ=!1;this.Whh=0;this.Ib=b;this.dQg=0;this.gpg=this;this.Gye=new jg(u);this.GK=h;B&&(this.zsb=new Jg(null,B,Q));this.DTj=ca}get kxh(){try{return!(void 0===this.GK||null===this.GK)&&!(void 0===this.GK.getEntriesByType||null===this.GK.getEntriesByType)}catch(b){return r.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get qgl(){return this.dQg}get isActive(){return this.VZ}get blg(){return this.Whh}Uoh(b){this.sa.addHandler(Fj.Nhf,
b)}F$i(b){this.sa.removeHandler(Fj.Nhf,b)}wc(b,h){const u=this.blg!==b;this.Whh=b;this.isActive&&this.Ib&&u&&(this.Ze(),this.Xb());this.dQg=h}activate(){!this.isActive&&this.kxh&&(this.Xb(),this.VZ=!0)}deactivate(b){this.isActive&&(this.Ze(),b&&this.flush(),this.VZ=!1)}flush(){if(this.isActive&&this.kxh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.xsc&&r.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.xsc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.xsc=0);const u=[];for(let B=this.xsc;B<b.length;B++)this.Gye.Ovi(b[B].name)&&(this.zsb&&(this.DTj?this.zsb.ZLo(b[B]):this.zsb.YLo(b[B])),u.push(new qi(b[B],this.qgl)));h||(this.xsc=b.length);this.sa.raiseEvent(Fj.Nhf,new xi(u));for(b=0;b<u.length;b++)0!==u[b].behavior&&2!==u[b].behavior||this.gpg.U4a(0,u[b].llg());0<u.length&&
r.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",u.length)}catch(h){r.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}U4a(b,h){r.ULS.sendTraceTag(4310804,306,50,lj(b,h))}nOn(){this.zsb.SQn()}xmf(b){return this.zsb.xmf(b)}Xb(){this.Ib&&0<this.blg&&(this.Ao=new bf.a(3,2,1E3*this.blg,()=>{this.flush()},5),this.Ib.Xb(this.Ao),this.IGe=!0)}Ze(){this.IGe&&(this.Ib.Ze(this.Ao),this.Ao=null,this.IGe=
!1)}}Fj.Nhf="EntriesAvailable";Object(m.a)(Fj,"ResourceTimingLogger",null,[641,663]);class km{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");ul.instance.run()}dispose(){}wc(b){this.W=b;let h=null;if(v.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=v.AFrameworkApplication.K.BB("ResourceLoggerDomainAllowList")}catch(ca){r.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const u=
[];u.push(fa.a.OX(Pd.a.Q5).toLowerCase());u.push(fa.a.OX(Pd.a.q9c).toLowerCase());const B=v.AFrameworkApplication.K.lc("AppStaticResourceMonitorCacheThresholdInMs",100),Q=v.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(641,"Common.NetworkTiming.IResourceTimingLogger").ha().Sd(()=>new Fj(v.AFrameworkApplication.oc,window.performance,h,u,B,Q))}static main(){M.a.instance.Gc(new km)}}Object(m.a)(km,"ResourceTimingPackage",null,[1,2]);var hg=c(247);class Wg{constructor(){this.Jre=
{}}wok(b){this.Jre[b.id.toString()]=b}Tfn(b){const h=this.Jre;for(let u in h)h[u].notify(b,!1);this.Jre={}}dJn(b,h){h&&this.wok(h);return this.aWi(b,h)}Cgf(b){this.Tfn(b)}KUh(b,h){b.notify(h,!0)}}Object(m.a)(Wg,"AEventEmitter",null,[539]);var ej;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(ej||(ej={}));Object(m.b)("EventResultState",ej);class tm{constructor(){this._state=0}get state(){return this._state}set state(b){r.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:ej[this._state],["NewState"]:ej[b]},"ResultType",this.Kei());this._state=b}}Object(m.a)(tm,"AEventResult",null,[521]);class nl extends tm{constructor(){super();this.iTe=this.AAc=null;this.state=0;this.mEe=this.eZg=!1}get Eda(){return this.AAc}get b8a(){return this.iTe}get dDm(){return this.eZg}Kei(){return"GetMoreInfo Result"}}Object(m.a)(nl,"GetMoreInfoResult",tm,[697,521]);var Pg=c(1385),fi=c(1562),Em=c(1062);class kg{constructor(b,h,u,B,Q,
ca,qa,Qa){this.ga=b;this.Wf=h;this.Lh=u;this.uAa=B;this.Ib=Q;this.vD=ca;this.C3j=qa;this.kxd=Qa}nSn(){this.Dfc.ra(Za.a.Lgc,Ad.a.frame,Object(z.a)(this,this.Lgc,"openUrlInNewTab"));this.Dfc.ra(Za.a.dYf,Ad.a.frame,Object(z.a)(this,this.dYf,"openDocumentUrl"));v.AFrameworkApplication.Uga?this.qJi():this.Dfc.fb(Za.a.NKd,Ad.a.frame,Object(z.a)(this,this.NKd,"documentLoaded"),96)}Lgc(b,h,u,B,Q){Q&&Q.MenuItemId&&(r.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:Q.SourceControlId,["AppType"]:Em.a[this.qda]}),
Qd.a.om(Q.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}dYf(b,h,u,B,Q){if(Q&&Q.MenuItemId){const ca=v.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),qa=v.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");r.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ca,qa);if(ca&&qa){r.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Q.SourceControlId,["AppType"]:Em.a[this.qda]});
b=Q.MenuItemId.toString();const Qa={};Qa[H.a.vic]="1";Qa[H.a.documentUrl]=b;Qa[H.a.reason]=fi.a.open;r.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");v.AFrameworkApplication.kP().execute(rb=>{rb.sendMessage(L.a.BDb,Qa)})}else this.Lgc(b,h,u,B,Q)}return 32}NKd(){this.qJi();return 32}ERa(b,h,u=""){if(h&&h.RH){const B=Pg.a[h.status];h=h.RH.getTime();const Q=this.jq()-h;r.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:B,
["ElapsedMs"]:Q,["StartTime"]:h,["Notes"]:u})}else r.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}qJi(){var b=v.AFrameworkApplication.K.$("QPGVCI"),h=fa.a.iP(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var u=fa.a.iP(document.URL,"wdPreviousSession",b);b=fa.a.iP(document.URL,"wdPreviousCorrelation",b);var B=v.AFrameworkApplication.K.$("NAOPLP");if(v.AFrameworkApplication.Uga){var Q=v.AFrameworkApplication.Uga.getTime();
!h||h>Q?r.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:Q,["SessionId"]:u,["Correlation"]:b}):r.ULS.sendTraceTag(5849683,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:Q-h,["ClickTimestamp"]:h,["SessionId"]:u,["Correlation"]:b})}else r.ULS.sendTraceTag(5849681,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:u,["Correlation"]:b})}}get Dfc(){return this.ga.value}get q0c(){return this.Wf.value}get rPi(){return this.Lh.value}get qda(){return this.uAa.value}get T4d(){return this.Ib.value}get jq(){return this.vD}get aSa(){return this.C3j.value}get e8a(){return this.kxd.value}static get instance(){return kg._instance||(kg._instance=kg.Ur())}static Ur(){return new kg(new hg.a(()=>v.AFrameworkApplication.va),new hg.a(()=>v.AFrameworkApplication.He),new hg.a(()=>v.AFrameworkApplication.ua),
new hg.a(()=>v.AFrameworkApplication.ua.Lb.Nk),new hg.a(()=>v.AFrameworkApplication.oc),()=>(new Date).getTime(),new hg.a(()=>v.AFrameworkApplication.ua.Lb.aSa),new hg.a(()=>v.AFrameworkApplication.e8a))}}kg._instance=null;Object(m.a)(kg,"NewAndOpenCommonHelpers",null,[519]);class aj{constructor(b,h,u){this.Jvd=this.Ao=null;this.LPe=0;this.Sgk=b;this.Ib=h;this.FQg=u}$yk(){this.LPe=this.hjc+1}W8f(b){this.Ao&&(this.Ib.Ze(this.Ao),this.Ao=null);b&&(this.LPe=0)}jAo(b){const h=this.WHo;0<=h?(this.$yk(),
this.W8f(!1),this.Ao=new bf.a(4,1,h,b,107),this.Ib.Xb(this.Ao)):(this.W8f(!0),r.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.FQg}))}get hjc(){return this.LPe}get WHo(){return this.hjc>=this.eij.length?-1:this.eij[this.hjc]}get eij(){if(!this.Jvd){const b=(this.Sgk.value||"0").split(",");this.Jvd=[];for(let h=0;h<b.length;h++){const u=parseInt(b[h]);isNaN(u)?r.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.FQg,["Entry"]:b[h]}):
Array.add(this.Jvd,u)}}return this.Jvd}}Object(m.a)(aj,"RetryHelper",null,[]);class Ri extends Wg{constructor(b,h){super();this.IBa=b;this.BBc=new aj(h,this.X_c.T4d,"GetMoreInfo");this.Jp=new nl}t7m(){this.qNf("Document opened")}dal(b){return()=>{this.qNf(b,!0)}}aWi(b,h=null){r.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.Jp.state?(h&&this.KUh(h,this.Jp),r.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.qNf(b);return this.Jp}qNf(b,h=!1){this.BBc.W8f(!h);1===this.Jp.state?r.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.BBc.hjc}):(r.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.BBc.hjc}),this.Jp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.X_c.aSa,v.AFrameworkApplication.km),this.X_c.q0c.oAb(h,1,null,null,[Ri.B$g,Ri.ogh],5,this.R9k(),this.Q9k(b)))}R9k(){return b=>
{var h=!1;let u=!1;var B=!1,Q;v.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.se?({Hu:Q}=G.d(b.data.se)).returnValue?Q?(B=!0,this.Jp.iTe=Q.StorageServiceDisplayName,this.Jp.AAc=Ri.cDi(Q.PersonalFileStorageUrl)?Q.PersonalFileStorageUrl:"",""===this.Jp.Eda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")&&(this.Jp.AAc=fa.a.wja(v.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.Jp.Eda&&""!==this.Jp.b8a):r.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
r.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):r.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));B||((Q=b.data.Aj)?(this.Jp.iTe=(Q[Ri.ogh]||"").toString(),h=(Q[Ri.B$g]||"").toString(),this.Jp.AAc=Ri.cDi(h)?h:"",""===this.Jp.Eda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")?(this.Jp.AAc=fa.a.wja(v.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.Jp.Eda&&""!==this.Jp.b8a):h=""===h&&""!==this.Jp.b8a):(r.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),u=!0));B=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.BBc.hjc,u,h,B);this.X_c.ERa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,B);this.uij(3,h,u)}}Q9k(b){return h=>{this.X_c.ERa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.uij(2);this.BBc.jAo(this.dal(b))}}uij(b,h=!1,u=!1){this.Jp.state=b;this.Jp.eZg=h;this.Jp.mEe=u;this.Cgf(this.Jp)}get X_c(){return this.IBa.value}static get instance(){return Ri._instance||(Ri._instance=Ri.Ur())}static Ur(){return new Ri(new hg.a(()=>kg.instance),new hg.a(()=>v.AFrameworkApplication.c3l))}static cDi(b){if(!b)return r.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.Zg(b).startsWith("https://"))return!0;r.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}Ri.B$g="PersonalFileStorageUrl";Ri.ogh="StorageServiceDisplayName";Ri._instance=null;Object(m.a)(Ri,"GetMoreInfoActor",Wg,[]);class Qk{constructor(b,h,u,B,Q){this.S4j=6E4;this.hpi="inactive";this.Xlh="active";this.VZ=!0;this.Ib=b;this.H2j=h;this.vD=u;this.hyd=B;this.sa=new Nc.a;Q&&this.Zzo();this.o2g=this.cai()}xmh(b){this.sa.addHandler(this.Xlh,b)}Urk(b){this.sa.addHandler(this.hpi,b)}Zzo(){const b=new bf.a(5,2,this.S4j,Object(z.a)(this,this.Lvm,
"inactiveLoop"),108);this.Mvm.Xb(b)}Lvm(){const b=this.cai(),h=this.jq()-b;h>this.mle&&this.VZ&&(r.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.VZ=!1,this.sa.raiseEvent(this.hpi));b-this.o2g>this.mle&&(this.VZ=!0,this.sa.raiseEvent(this.Xlh));this.o2g=b}get Mvm(){return this.Ib.value}get cai(){return this.H2j}get jq(){return this.vD}get mle(){return this.hyd.value}static get instance(){return Qk._instance||(Qk._instance=Qk.Ur())}static Ur(){return new Qk(new hg.a(()=>
Bg.a.instance),()=>v.AFrameworkApplication.SIf.getTime(),()=>(new Date).getTime(),new hg.a(()=>v.AFrameworkApplication.mle),!0)}}Qk._instance=null;Object(m.a)(Qk,"InactivityManager",null,[]);var dl=c(1683);class dm extends tm{constructor(){super();this.C$j=this.r6g=this.q6g=null;this.state=this.Xhh=0;this.mEe=!1}get oPf(){return this.q6g}get IOi(){return this.r6g}get bIo(){return this.Xhh}Kei(){return"MruActor Result"}}Object(m.a)(dm,"MruResult",tm,[520,521]);class xn{constructor(b,h,u){this.task=
null;this.RHb=b;this.maxRetries=h;this.taskManager=u;this.retryCount=this.HUc=0;this.ZNe=this.vYc=null}RPm(b,h){return b===oa.a.g8b||20===h||18===h||3===h}iRm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get J$d(){return this.ZNe}reset(){this.HUc=this.retryCount=0;this.ZNe=this.vYc=null;this.task&&(this.taskManager.Ze(this.task),this.task=null)}kAm(b,h,u,B){this.ZNe=String.format("{0}_{1}",u,B);if(this.retryCount>=
this.maxRetries)return r.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.RPm(u,B))return r.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.iRm(B)&&1<=this.HUc)return this.vYc=u,!1;h=Math.max(h,this.RHb*Math.pow(2,this.HUc));if(26===B)h=Math.max(h,3E4);else if(27===B||28===B)h=Math.max(h,6E4);9===B||412===u&&(null==this.vYc||412!==this.vYc)?h=500:this.HUc+=1;this.vYc=u;this.retryCount+=1;this.task&&this.taskManager.Ze(this.task);r.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new bf.a(2,1,h,b,107);this.taskManager.Xb(this.task);return!0}}Object(m.a)(xn,"RetryManager",null,[]);var ah=c(125);class Tn{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(Tn,"WriteOptions",null,[]);var Jj=c(753);class Yi extends Wg{constructor(b,h,u,B,Q,ca,qa){super();this.IBa=b;this.t9j=h;this.Qcb=new xn(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.cN.T4d);this.eeb=new xn(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.cN.T4d);this.Iek=u;this.Xkh=B;this.qnk={};this.Ela=new dm;this.e2j=Q;this.Nqd="";this.$L=ca;this.ESg=qa;this.Ytd="";this.Mek=v.AFrameworkApplication.K.lc("WordRecentLinksCount",
25)}get mpe(){return this.qnk}YVn(){this.cN.Dfc.ra(Za.a.paj,Ad.a.frame,Object(z.a)(this,this.T_n,"renameMruEntry"))}T_n(){return this.rrg("Rename")}L7m(){this.zLi("File Opened")}M7m(){this.zLi("IntervalUpdate")}zLi(b){r.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.rrg(b)}zha(b){(b=F.a.zha(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}N3h(){switch(this.cN.qda){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}Uhm(b){var h=this.e2j();if(!h)return null;const u=new Tn;u.documentUrl=this.ESg.value?encodeURI(h):h;u.mruItemId=this.Nqd;u.app=this.N3h();if(h=this.$L())u.folderName=h.breadcrumbFolderName,h=h.uz,u.documentName=F.a.tJ(h),u.documentExt=this.zha(h);b&&(u.documentName?u.documentName.length?255<=u.documentName.length?b.set("DocumentNameLength","Long"):2084<=u.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(u)}rrg(b,h=!1){if(4===this.cN.qda&&!v.AFrameworkApplication.KKd)return 2;var u=ib.a.oG();u&&(u.set("Trigger",b),u.set("IsRetry",h?"true":"false"),u.set("MruIdSent",this.Nqd?"true":"false"),u.set("URLEncoded",this.ESg.value?"true":"false"));xa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",u);b=this.Uhm(u);if(!b)return h=!v.AFrameworkApplication.$Sb,u&&(u.set("WebEditingIsEnabled",v.AFrameworkApplication.$Sb?"true":"false"),u.set("ProtectedFile",v.AFrameworkApplication.UY?
"true":"false")),xa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new Ub.a,{extendedProperties:u})),2;this.eeb&&!h&&this.eeb.reset();u=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.cN.aSa,this.tLf);this.Xkh?this.mpe["X-FileId"]=v.AFrameworkApplication.km:u+=String.format("&{0}",v.AFrameworkApplication.km);v.AFrameworkApplication.sessionStartInfoSettings&&(this.mpe["X-Office-AudienceGroup"]=Object(Na.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.mpe["X-Timeout"]=15E3;return this.cN.q0c.sj(u,2,b,this.mpe,!0,5,Object(z.a)(this,this.S5o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.cel,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}S5o(b){this.Tki(b.data)}Tki(b){const h=ib.a.oG();this.eeb&&(h&&this.eeb.J$d&&(h.set("LastError",this.eeb.J$d),h.set("NumRetries",this.eeb.retryCount.toString())),this.eeb.reset());const u=dl.c(b.se);u&&u.diagnostics_data&&(this.Nqd=u.diagnostics_data.mru_id);
b=+b.PT-+b.RH;h&&h.set("RequestDuration",b.toString());xa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Ub.a,{extendedProperties:h}))}cel(b){if(b.data.Qe===oa.a.hKc)this.Tki(b.data);else{var h=b.data.Qe===oa.a.jja,u=ib.a.oG();this.cli(this.eeb,b,this.Idl(),u);u&&(u.set("StatusCode",b.data.Qe.toString()),h||this.BYe(b.data,u));xa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Qe),h,!1,Object.assign(new Ub.a,{extendedProperties:u}))}}Idl(){return()=>
{this.rrg("Retry",!0)}}l3l(){this.f_c("Polling")}k3l(){this.f_c("Retry",!0)}w7m(){this.f_c("Open")}v7m(){this.f_c("Activity")}u7m(){this.f_c("ActivityRecentLinks",!1,!0)}f_c(b,h=!1,u=!1){r.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const B=ib.a.oG();B&&(B.set("Trigger",b),B.set("IsRetry",h?"true":"false"),u&&B.set("RecentLinks","true"));xa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",B);this.Qcb&&!h&&this.Qcb.reset();u?this.HKh(Object(z.a)(this,this.m3l,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(z.a)(this,this.h3l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.HKh(Object(z.a)(this,this.n3l,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.j3l,"getMruFromServerFailureCallback"))}BYe(b,h){b&&b.Aj&&(b=b.Aj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}$2m(b,h){b&&(h&&h.set("RequestDuration",(+b.PT-+b.RH).toString()),xa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Ub.a,{extendedProperties:h})))}n3l(b){this.hbi(b)}hbi(b,h=!1){var u="";let B=null,
Q=null,ca=null;const qa=dl.c(b.data.se);qa&&(B=qa.places?qa.places.items:[],Q=qa.documents?qa.documents.items:[],(ca=dl.a(qa,h))&&(u=G.c(ca)));v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&ah.c()&&(h?this.Ytd=u:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(u,!0)));u=ib.a.oG();this.Qcb&&(u&&this.Qcb.J$d&&(u.set("LastError",this.Qcb.J$d),u.set("NumRetries",this.Qcb.retryCount.toString())),this.Qcb.reset());h&&u&&u.set("RecentLinks","true");ca||B||Q?(h?this.cN.ERa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.cN.ERa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.tne(3,ca,B,Q),this.$2m(b.data,u)):(h?this.cN.ERa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.cN.ERa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),u&&this.BYe(b.data,u),xa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Ub.a,{extendedProperties:u})),this.tne(3,null,null,null,!0));this.Cgf(this.Ela)}m3l(b){this.hbi(b,
!0)}cli(b,h,u,B){let Q=0,ca=0;const qa=dl.c(h.data.se);qa&&(null!=qa.response_code&&(Q=qa.response_code,B&&B.set("MruResponseCode",Q.toString()),9===Q&&(this.Nqd="")),qa.error_data&&null!=qa.error_data.retry_after_ms&&(ca=qa.error_data.retry_after_ms,B&&B.set("ExpectedRetryAfter",ca.toString())));b&&(h=b.kAm(u,ca,h.data.Qe,Q),B&&(B.set("CurrentRetryCount",b.retryCount.toString()),B.set("RetryScheduled",h?"true":"false")))}j3l(b){this.gbi(b)}gbi(b,h=!1){const u=b.data.Qe===oa.a.jja,B=ib.a.oG();B&&
(B.set("StatusCode",b.data.Qe.toString()),h&&B.set("RecentLinks","true"),u||this.BYe(b.data,B));h?this.cN.ERa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.cN.ERa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.tne(2);this.cli(this.Qcb,b,Object(z.a)(this,this.k3l,"getMruFromServerRetryTask"),B);xa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Qe),u,!1,Object.assign(new Ub.a,{extendedProperties:B}));this.Cgf(this.Ela);
v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&ah.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.Ytd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}h3l(b){this.gbi(b,!0)}tne(b,h=null,u=null,B=null,Q=!1){if(3!==this.Ela.state||3===b)this.Ela.q6g=h,this.Ela.r6g=u,this.Ela.C$j=B,this.Ela.state=b,this.Ela.mEe=Q,this.Ela.Xhh=this.cN.jq()}aWi(b,h){r.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Ela.state});
h&&3===this.Ela.state&&this.KUh(h,this.Ela);return this.Ela}HKh(b,h,u=!1){this.tne(1);let B;const Q={};B=u?String.format(this.cN.aSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Mek,"OfficeSuite",this.tLf,"ClassicMru"):String.format(this.cN.aSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.N3h(),this.tLf);this.Iek.value||(B+="&entity=docs");v.AFrameworkApplication.sessionStartInfoSettings&&(Q["X-Office-AudienceGroup"]=Object(Na.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");u&&(Q["X-Office-Application"]="147");this.Xkh?Q["X-FileId"]=v.AFrameworkApplication.km:B+=String.format("&{0}",v.AFrameworkApplication.km);this.cN.q0c.sj(B,1,null,Q,!0,5,b,h,null)}get cN(){return this.IBa.value}get tLf(){return this.t9j.value}static get instance(){return Yi._instance||(Yi._instance=Yi.Ur())}static Ur(){return new Yi(new hg.a(()=>kg.instance),new hg.a(()=>Jj.a.qg(v.AFrameworkApplication.lcid).name),new hg.a(()=>v.AFrameworkApplication.ua.Lb.pF),v.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>v.AFrameworkApplication.ua.Lb.g8,()=>v.AFrameworkApplication.Cs,new hg.a(()=>v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}Yi._instance=null;Object(m.a)(Yi,"MruActor",Wg,[]);class Lm{constructor(){this.dEc=this.$ah=this.W=null;this.Mh=!1}get name(){return"Common.App.NewAndOpen.Core"}wc(b){this.W=b;b.register(519,"Common.INewAndOpenCommonHelpers").ha().Sd(()=>kg.instance);b.register(539,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().Sd(()=>Ri.instance);b.register(539,"Common.IEventEmitter<Common.IMruResult>").ha().Sd(()=>
Yi.instance)}init(){v.AFrameworkApplication.K.Hn(()=>{this.k3a()})}k3a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;kg.instance.nSn();v.AFrameworkApplication.TGa&&(b=!0);v.AFrameworkApplication.t4f&&(Yi.instance.w7m(),0<v.AFrameworkApplication.JOi&&this.lnh(),this.Hno(),b=!0);v.AFrameworkApplication.e8a&&b&&Ri.instance.t7m();v.AFrameworkApplication.zVo&&(b=Yi.instance,
b.YVn(),b.L7m(),Bg.a.instance.Xb(this.AVo))}Hno(){Qk.instance.xmh(Object(z.a)(Yi.instance,Yi.instance.v7m,"makeGetMruRequestActivityTrigger"));Qk.instance.xmh(Object(z.a)(this,this.lnh,"addGetMruFromServerTask"));Qk.instance.Urk(Object(z.a)(this,this.Iil,"deleteGetMruFromServerTask"))}Iil(){Bg.a.instance.Ze(this.KOi)}lnh(){Bg.a.instance.Xb(this.KOi)}get KOi(){return this.$ah||(this.$ah=new bf.a(5,2,v.AFrameworkApplication.JOi,Object(z.a)(Yi.instance,Yi.instance.l3l,"getMruFromServerTask"),109))}get AVo(){return this.dEc||
(this.dEc=new bf.a(2,2,6E4*v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(Yi.instance,Yi.instance.M7m,"makeUpdateMruTask"),197))}dispose(){this.Mh||(this.Mh=!0,this.dEc&&(Bg.a.instance.Ze(this.dEc),this.dEc=null))}}Object(m.a)(Lm,"CorePackageManager",null,[1,2,10]);var bn=c(1558),zh=c(146);class vg{static stl(b){return vg.Vxh("New",b)}static ttl(b){return vg.Vxh("Open",b)}static Bxh(b,h){return vg.A_a("LoadingMenuSection",vg.P0m,
b,vg.UGc("lblLoading",h))}static VGc(b,h,u=null,B=null){return vg.A_a("MessageMenuSection",vg.HOi,h,vg.UGc("lblMessage",b,u,B))}static yMk(b){return vg.Bxh(b,CommonUIStrings.l_VoicedLoadingText)}static zMk(b,h){return vg.VGc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Eda,h.b8a)}static xMk(b,h){return vg.VGc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.b8a,"\n\n"),b.labelText)}static Fxh(b){return vg.VGc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static vMk(b,
h,u){return vg.A_a("menuNewBlank",vg.orm,u?b.labelText:null,vg.RGc(b.Hmi,b.Imi,b.Jmi,null,b.c3a,b.lTc,h,"blank"))}static rNk(){return vg.UGc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Txh(){return vg.UGc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static sNk(b,h){return vg.A_a("menuNewTemplates",b,null,h)}static tMk(b,h){return vg.A_a("menuNewMoreTemplates",vg.K0h,null,vg.RGc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,b,h))}static lLk(b,h,u){let B="";u&&h&&(B=vg.A_a("BrowseMoreMenuSection",vg.K0h,null,vg.RGc("btnBrowseMore",h,h,null,null,null,b||"1959943459",u)));return B}static UGc(b,h,u=null,B=null){let Q=B;h&&0<h.length&&(Q=vg.APi.Unb(h).trimEnd(),Q=0<=Q.indexOf("{0}")?String.format(Q,B):String.format("{0} {1}",Q,B));u=u&&B?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.vf(u),F.a.vf(B),F.a.vf(Q)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
F.a.vf(b||""),vg.APi.Unb(F.a.vf(h||"")),u)}static RGc(b,h,u,B,Q,ca,qa,Qa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',F.a.vf(b||""),F.a.vf(h||""),F.a.vf(u||""),B||"32by32",F.a.vf(Q||""),F.a.vf(ca||""),qa,F.a.vf(Qa||""))}static Vxh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
b,h)}static A_a(b,h,u,B){u=u?String.format('Title="{0}"',F.a.vf(u)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',F.a.vf(b||""),F.a.vf(h||""),u,B)}}vg.HOi="MenuMru";vg.P0m="MenuLoading";vg.orm="MenuHeader";vg.K0h="MenuFooter";vg.APi=zh.a.LC("\n","&#10;");Object(m.a)(vg,"NewAndOpenXmlUtilities",null,[]);
class jl{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(m.a)(jl,"HostInformation",null,[]);var Cl=c(192);class um{constructor(b,h,u,B,Q,ca){this.q0b=this.uv=this.Bgd=null;this.pwd=this.aSe=!1;this.D5g=0;this.HRe=this.$Fe=!1;this.IBa=b;this.Euc=h;this.ZWa=new hg.a(()=>new bn.a(u.value,Object(z.a)(this,this.bGb,"getMoreInfoEventReceived")));this.A$j=B;this.gcb=Q;this.Xhk=ca;this.BCc=this.Jhe;this.Ood=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("GateTemplateRenderingByGetMoreInfoResponse");
2===this.VR.qda&&(this.HRe=!0);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.$zl()}get O7(){switch(this.VR.qda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}$zl(){Bg.a.instance.Xb(new bf.a(5,1,0,()=>{this.getTemplateListJson()}))}Tb(){const b=this.VR.Dfc;b.ra(Za.a.newDocument,Ad.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));
b.ra(Za.a.l$d,Ad.a.frame,Object(z.a)(this,this.l$d,"populateNewMenu"))}newDocument(b,h,u,B,Q){if(1===u)return 32;if(2===u&&Q){if(v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&Q.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.va.processAction(Za.a.CDn,2);if(Q.MenuItemId&&Q.SourceControlId)return"NewDocumentHome"===Q.SourceControlId&&Fe.a("NewDocumentFromHomeTab"),this.VJc(Q.MenuItemId,Q.SourceControlId)}return 8}VJc(b,
h){var u=this.Y4d.pLh;if(null===u)return 8;var B=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.qlb&&B){r.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Q={};Q[H.a.template]=b;Q[H.a.O7]=this.O7;Q[H.a.lcid]=v.AFrameworkApplication.lcid.toString();Q[H.a.reason]=fi.a.yaf;Q[H.a.uiCulture]=v.AFrameworkApplication.uiCulture;Q[H.a.dataCulture]=v.AFrameworkApplication.dataCulture;
v.AFrameworkApplication.kP().execute(ca=>{ca.sendMessage(L.a.VJc,Q)})}else B=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",u,F.a.Dj(this.TGa),F.a.Dj(b),F.a.Dj(this.O7),F.a.Dj(v.AFrameworkApplication.lcid.toString()),F.a.Dj(B.toString()),F.a.Dj(h),F.a.Dj(v.AFrameworkApplication.canary),v.AFrameworkApplication.km),(u=v.AFrameworkApplication.K.kb("ScenarioId"))&&""!==u&&(h+="&wdscenarioid="+F.a.Dj(u)),
h+="&"+v.AFrameworkApplication.tTd(),v.AFrameworkApplication.VQa&&(h+="&"+v.AFrameworkApplication.WRd()),(u=this.uv?this.uv.Eda:null)?h+="&DestinationUrl="+F.a.Dj(u):3===this.VR.qda&&r.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Qd.a.om(h,"_blank",void 0,"CreateNewDocument");2!==this.VR.qda&&3!==this.VR.qda||r.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Em.a[this.VR.qda],["Template"]:b});
v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.VR.qda&&("blank"===b?Fe.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new ha.a,{name:"TemplateId",string:b})],Fe.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}u5m(b){let h=Number.MAX_VALUE,u=Number.MIN_VALUE;const B=window.performance;if(B&&"undefined"!==typeof B.getEntriesByName){for(let ca=0;ca<b.length;ca++){var Q=B.getEntriesByName(b[ca]);Q&&
0<Q.length&&(Q=Q[0],h=Math.min(parseInt(String(Q.fetchStart)),h),u=Math.max(parseInt(String(Q.responseEnd)),u))}u>h&&r.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:u-h,["MinFetchStart"]:h,["MaxResponseEnd"]:u})}}l$d(b,h,u,B,Q){if(1===u)return this.HRe&&(v.AFrameworkApplication.Spa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.HRe=!1),32;2!==u||this.$Fe||(this.D5g=(new Date).getTime(),r.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Jhe,["CachedNewMenuXmlExists"]:!!this.Bgd,["ShouldCallGetMoreInfo"]:this.VR.e8a}));v.AFrameworkApplication.le("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.le("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.jCn(Q)}jCn(b){b&&(this.Bgd?b.PopulationXML=this.Bgd:(this.VR.e8a&&!this.uv&&this.men.jP("Opened New menu",!0),b.PopulationXML=this.GJl(this.getTemplateListJson())));
return 32}sAi(){return!this.VR.e8a||!!this.uv&&3===this.uv.state&&!!this.uv.b8a&&!!this.uv.Eda}$Ff(){return v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&!this.Ood?!0:this.sAi()}getTemplateListJson(){if(!this.Jhe&&!this.Ood&&!this.$Ff())return null;if(this.BCc&&!this.pwd){var b="9";v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=v.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in
h&&(b=h.NumberOfTemplatesInBackstage);let u=this.O7;"TemplateCollectionId"in h&&(u=h.TemplateCollectionId);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(u="WordConsumerWAC",b="23");b=String.format(this.VR.aSa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.Dj(v.AFrameworkApplication.lcid.toString()),F.a.Dj(u),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+v.AFrameworkApplication.tTd();v.AFrameworkApplication.VQa&&(b+="&"+v.AFrameworkApplication.WRd());this.VR.q0c.sj(b,1,null,null,!1,2,B=>{this.VR.ERa("CreateNewActor.GetTemplateListJson",B.data);this.nGo(B.data.se)},B=>{this.VR.ERa("CreateNewActor.GetTemplateListJson",B.data);this.mGo()},null,void 0,void 0,void 0,void 0,"5");this.BCc=!1}return this.q0b}nGo(b){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.q0b=this.YAl(b):this.q0b=b;this.BCc=!1;this.p5c();if(this.Ood){if(!this.uv)return;if(this.uv&&!this.$Ff()){r.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing");this.Kef();return}}this.RRh()}RRh(){if(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&ah.c()){const b=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=v.AFrameworkApplication.qlb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.q0b,
!0,b&&h));3===this.VR.qda&&r.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}mGo(){this.pwd=this.BCc=!0;this.p5c();this.Kef();xa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Kef(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&ah.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.VR.qda&&r.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}YAl(b){b=
JSON.parse(b);const h=new zb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const u=Cl.a.Iqg(b,B=>h.contains(B.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(u));return JSON.stringify(b)}ouf(b){var h=0;for(var u=0;u<b.length;u++)if("ST"===b[u].ImageType){h=u;break}const B=b.length?b[h]:null;b=B?B.Url||"":"";var Q;let ca=u=h=!1;if(B&&(Q=B.AspectRatio))Q=parseFloat(Q),1>Q?h=!0:1.5<Q?u=!0:1===Q&&(ca=!0);else switch(r.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",
{["Url"]:b}),this.VR.qda){case 3:h=!0;break;case 2:u=!0;break;case 5:ca=!0}return{returnValue:b,ovm:h?"95by123":u?"123by69":ca?"100by100":"123by95"}}GJl(b){b=({ohe:h}=this.wMk(b,this.Y4d,this.Y4d.YGc||"1056925771")).returnValue;if(h){this.Bgd=b;var h=(new Date).getTime()-this.D5g;r.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}bGb(b,h){r.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.uv||3!==
b.state?2===b.state&&(r.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.aSe=!0,this.p5c()):(this.uv=b,h||this.p5c(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&ah.c()&&ah.d("setFileMenuHostInformation")&&(b=Object.assign(new jl,{hostUrl:this.uv.Eda,hostName:this.uv.b8a,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),r.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),
appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.Ood&&this.q0b&&this.q0b.length&&(this.$Ff()?this.RRh():this.Kef(),r.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}wMk(b,h,u){let B;B=!1;const Q=this.sAi();let ca="";this.VR.e8a&&(this.aSe?(ca=vg.Fxh(h),this.aSe=!1,r.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.uv?Q?ca=vg.zMk(h,this.uv):this.uv.dDm?(B=!0,this.BCc=!1,ca=vg.xMk(h,
this.uv),r.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(B=!0,ca=vg.Fxh(h),r.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.uv.Eda,["StorageServiceDisplayNameIsSet"]:!!this.uv.b8a})):(ca=vg.yMk(h.labelText),r.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Q&&(ca+=vg.vMk(h,u,!ca)+({ohe:B}=this.qNk(b,u)).returnValue);
return{returnValue:vg.stl(ca),ohe:B}}qNk(b,h){let u;u=!1;if(!this.Jhe)return u=!0,r.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",ohe:u};let B="",Q="",ca="MenuTemplate";if(this.pwd)B=vg.Txh(),this.pwd=!1,r.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const qa=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);B=this.pNk(qa,h);r.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");
v.AFrameworkApplication.BPi&&"OneDrive"===this.TGa&&(Q=vg.tMk(this.nen,v.AFrameworkApplication.BPi))}catch(qa){r.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),B=vg.Txh()}u=!0}else ca="MenuLoading",B=vg.rNk(),r.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:vg.sNk(ca,B)+Q,ohe:u}}pNk(b,h){let u="";const B=[];for(let ca=0;ca<b.length;ca++){var Q=b[ca];let qa="";if(Q){const Qa=Q.Title,
rb=Q.AssetId;Q=Q.Thumbnails;rb&&Qa&&Q&&({ovm:Q,returnValue:qa}=this.ouf(Q),u+=vg.RGc("jbtnNewTemplate"+ca,Qa,null,Q,null,qa,h,rb))}B[ca]=qa}b=new bf.a(4,1,5E3,()=>{this.u5m(B)},106);this.VR.T4d.Xb(b);return u}p5c(){this.$Fe=!0;this.VR.rPi.vJa(this.Y4d.XNc);this.$Fe=!1}get VR(){return this.IBa.value}get Y4d(){return this.Euc.value}get men(){return this.ZWa.value}get nen(){return this.A$j.value}get TGa(){return this.gcb.value}get Jhe(){return this.Xhk.value}}Object(m.a)(um,"CreateNewActor",null,[]);
class Qm{constructor(){this._initialized=!1;this.lTe={}}XC(b){this.rWh();return this.get(b)}contains(b){this.rWh();return b.toString()in this.lTe}rWh(){this._initialized||(this.xtk(),this._initialized=!0)}oeb(b,h){this.lTe[b.toString()]=h}get(b){return this.lTe[b.toString()]}}Object(m.a)(Qm,"AIntlHelper",null,[]);class oj extends Qm{constructor(){super()}xtk(){this.oeb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.oeb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.oeb(2,CommonUIStrings.l_Open);
this.oeb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.oeb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.oeb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return oj._instance||(oj._instance=new oj)}static Hun(b){return oj.instance.XC(b)}}oj._instance=null;Object(m.a)(oj,"MruActorIntlHelper",Qm,[]);var ph;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(ph||(ph={}));Object(m.b)("DisplayState",ph);class cd{constructor(b,h,
u,B,Q,ca,qa,Qa){this.eue=null;this.XWe=!0;this.Agd="";this.Vkk=0;this.oYb=null;this.DHe=3;this.Ga=Qa;this.IBa=b;this.Vta=h;this.X0j=u;this.aWj=B;this.$Vj=Q;this.ZWa=new hg.a(()=>new bn.a(ca.value,null));this.K2j=new hg.a(()=>new bn.a(qa.value,Object(z.a)(this,this.edn,"mruEventResultReceived")));this.Ga.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.$("UiHostSupportsDocRebootFeatures")}edn(b,h){this.oYb=b;h||this.n7i()}bVn(){this.cN.Dfc.fb(Za.a.q0f,Ad.a.frame,Object(z.a)(this,this.q0f,"populateMruMenu"),
96)}q0f(b,h,u,B,Q){return 1!==u&&Q?this.hCn(Q):32}hCn(b){this.dul();this.cul();b.PopulationXML=vg.ttl(this.Agd+this.eue);return 32}dul(){var b=3;let h=!1;if(this.Agd&&this.Vkk===this.oYb.bIo)r.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.DHe;else{r.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var u=this.cN.jq();this.oYb=this.ddn.jP("File Open opened",
!0);this.Agd&&2!==this.DHe&&3!==this.oYb.state?h=!0:(b=this.Nbm(this.oYb),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.dRa&&ah.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.Agd=({den:b}=this.IJl(this.oYb)).returnValue);u=this.cN.jq()-u;r.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:u})}2!==b&&(u={["DisplayState"]:ph[b]},1!==b&&(u.IsStale=h),r.ULS.sendTraceTag(5849630,202,
50,"MRU section display state {0}",u));this.DHe=b}Nbm(b){let h;try{h=G.c(b.oPf)}catch(u){h=null,r.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",u)}return h}cul(){this.XWe?(r.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.eue=({w1o:this.XWe}=this.q7m()).returnValue):r.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");r.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",
{["WaitingOnLinkInfo"]:this.XWe,["NotDisplayingLink"]:!this.eue})}IJl(b){let h;1===b.state||0===b.state?(r.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=vg.Bxh(this.G2a(2),this.G2a(5))):3===b.state&&b.oPf?(h=this.uMk(b.oPf),b=0):(r.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=vg.VGc(this.G2a(1),this.G2a(2)),b=1);return{returnValue:h,den:b}}uMk(b){let h;const u=this.I_c.YGc||"2155708348";if(b.length){h=vg.UGc("lblRecentDocuments",
this.G2a(3));let B=0;for(let Q=0;Q<b.length;Q++){const ca=b[Q];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(h+=vg.RGc("MruButton"+Q,ca.FileName.toString(),ca.Path.toString(),null,this.I_c.c3a,this.I_c.lTc,u,ca.DocumentUrl.toString()),ca.IsPinned&&B++)}h=vg.A_a("RecentDocumentsMenuSection",vg.HOi,this.G2a(2),h);r.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:B})}else h=vg.VGc(this.G2a(0),this.G2a(2)),r.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}q7m(){let b;b=!0;let h=this.DKk;var u=this.CKk;if(h&&u||!this.cN.e8a)b=!1;else{const B=this.bSd.jP("File Open",!1);3===B.state&&(h=B.Eda,u=B.b8a,b=!1)}u=u?String.format(this.G2a(4),u):null;return{returnValue:vg.lLk(this.I_c.YGc,u,h),w1o:b}}n7i(){this.cN.rPi.vJa(this.I_c.XNc)}get cN(){return this.IBa.value}get G2a(){return this.Vta.value}get I_c(){return this.X0j.value}get DKk(){return this.aWj.value}get CKk(){return this.$Vj.value}get bSd(){return this.ZWa.value}get ddn(){return this.K2j.value}}
Object(m.a)(cd,"MruRenderer",null,[]);var dg=c(1563);class vm{constructor(b,h,u,B,Q,ca,qa){this.uv=null;this.wdh=!1;this.Psa=this.p2=0;this.Q$j=b;this.PYb=h;this.Uqd=u;this.Euc=B;this.gcb=Q;this.IBa=ca;this.ZWa=new hg.a(()=>new bn.a(qa.value,Object(z.a)(this,this.bGb,"getMoreInfoEventReceived")))}VJc(){!this.uv&&this.ORf.e8a?this.bSd.jP("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}bGb(b){if(!this.uv&&3===b.state)this.uv=b;else if(2===b.state){this.wdh?r.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.bSd.jP("NewDocumentFromStream",!0),this.wdh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.p2=(new Date).getTime();var b=this.oAl.pLh;if(null===b)this.PYb(null);else{var h=this.Uqd.menuItemId,u=this.Uqd.DIa,B=this.Uqd.NBo,Q=this.Uqd.wAl;this.Psa="streamBase64"===B?Q.length/1024:0;r.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.O7,this.Psa);var ca=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,F.a.Dj(this.TGa),F.a.Dj(h),F.a.Dj(this.O7),F.a.Dj(v.AFrameworkApplication.lcid.toString()),F.a.Dj(ca.toString()),F.a.Dj(u),F.a.Dj(v.AFrameworkApplication.canary),v.AFrameworkApplication.km,F.a.Dj(B));b+="&"+v.AFrameworkApplication.tTd();v.AFrameworkApplication.VQa&&(b+="&"+v.AFrameworkApplication.WRd());(h=this.uv?this.uv.Eda:null)&&(b+="&DestinationUrl="+F.a.Dj(h));this.ORf.q0c.sj(b,2,Q,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.gen,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.fen,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}gen(b){if(b&&b.data&&b.data.se)if(({Hu:h}=G.d(b.data.se)).returnValue)if(b=h,b.StatusCode!==oa.a.$y&&b.StatusCode!==oa.a.hKc)r.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.O7,this.Psa,b.StatusCode),this.PYb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.p2;r.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.O7,this.Psa,h);this.Q$j(b.NewDocumentUrl)}else r.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.O7,this.Psa),this.PYb(null);else r.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.O7,this.Psa,{["ResponseData"]:dg.a.Ibd(b.data.se)}),this.PYb(null);else r.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.O7,this.Psa),this.PYb(null)}fen(b){b&&b.data&&r.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.O7,this.Psa,b.data.status);this.PYb(null)}get O7(){switch(this.ORf.qda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get oAl(){return this.Euc.value}get TGa(){return this.gcb.value}get ORf(){return this.IBa.value}get bSd(){return this.ZWa.value}}
Object(m.a)(vm,"NewDocumentFromStreamOperation",null,[]);class Rm{constructor(b,h,u,B){this.Euc=b;this.gcb=h;this.IBa=u;this.J2j=B}create(b,h,u){return new vm(b,h,u,this.Euc,this.gcb,this.IBa,this.J2j)}}Object(m.a)(Rm,"NewDocumentFromStreamOperationFactory",null,[684]);var ce=c(129);class md{get name(){return"Common.App.NewAndOpen.UX"}wc(b){b.register(Rm,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().Sd(()=>
new Rm(new hg.a(()=>v.AFrameworkApplication.ua.Lb.opf()),new hg.a(()=>v.AFrameworkApplication.TGa),new hg.a(()=>b.Oa("Common.INewAndOpenCommonHelpers")),new hg.a(()=>b.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.K.Hn(()=>{this.k3a()})}k3a(){const b=ob.a.Bp(Ga.a.instance.Ta("Common.INewAndOpenCommonHelpers")),h=ob.a.Bp(Ga.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.TGa&&ce.Task.WAA.call(null,b,h).continueWith(()=>
{const u=new um(new hg.a(()=>b.result),new hg.a(()=>v.AFrameworkApplication.ua.Lb.opf()),new hg.a(()=>h.result),new hg.a(()=>v.AFrameworkApplication.ua.Lb.ppf().YGc||"1959943459"),new hg.a(()=>v.AFrameworkApplication.TGa),new hg.a(()=>v.AFrameworkApplication.oOm));u.Tb();u.p5c()});if(v.AFrameworkApplication.t4f){const u=ob.a.Bp(Ga.a.instance.Ta("Common.IEventEmitter<Common.IMruResult>"));ce.Task.WAA.call(null,b,h,u).continueWith(()=>{const B=new cd(new hg.a(()=>b.result),new hg.a(()=>oj.Hun),new hg.a(()=>
v.AFrameworkApplication.ua.Lb.ppf()),new hg.a(()=>v.AFrameworkApplication.Gun),new hg.a(()=>v.AFrameworkApplication.Fun),new hg.a(()=>h.result),new hg.a(()=>u.result),v.AFrameworkApplication.K);B.bVn();B.n7i()})}}dispose(){}}Object(m.a)(md,"UXPackageManager",null,[1,2,10]);var mg=c(177);class Kg extends mg.StandardDialog{constructor(){super();this.Cd=0;this.xe(1,CommonUIStrings.l_DialogClose)}NO(b){this.rx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}Sef(b){this.rx(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(m.a)(Kg,"ErrorDialog",mg.StandardDialog,[659]);var Jd=c(462);class tg{I3h(){r.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Jd.a;b.Ag("api.onedrive.com");return b.task}}Object(m.a)(tg,"OneDriveConsumerEndpointHelper",null,[636]);var xd=c(50);class Oi{constructor(b,h,u,B){this.axb=this.bHa=null;this.tRe=this.vRe=!1;this.$Yb=null;this.Ga=b;this.aUb=h;this.lwb=u;this.mH=B}get Brh(){return this.aUb}get K(){return this.Ga}I9b(){this.$Yb||
(this.$Yb=this.Kgc?Ya.a.create(this.Kgc,null,null,null,!1):null);return this.$Yb}setup(b){this.axb=b;this.vRe||this.tRe?this.vRe&&this.axb&&this.axb(!0):(b=this.I9b())?(this.tRe=!0,b.R4a.continueWith(h=>{this.Non(h)}),Hb.a.FX(b)):(r.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.axb(!1))}SVf(b){r.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}Non(b){this.tRe=
!1;if(b.Ei)this.SVf(b),this.axb(!1);else try{this.vRe=!0,r.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.eAf(),r.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.axb(!0)}catch(h){r.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.axb(!1)}}Q$c(b){this.bHa=b;this.lwb?r.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(r.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.QTf,"onApiReady")))}QTf(b){b?this.r1d():this.zp()}zp(){this.mH().NO(xd.a.Ntn)}onSuccess(b){r.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.bHa&&this.bHa(!0,b)}dispose(){this.$Yb&&this.$Yb.dispose()}}Object(m.a)(Oi,"AOneDriveFilePickerApiManager",null,[687,10]);class he extends Oi{constructor(b,h,u,B,Q,ca){super(h,u,B,ca);this.Km=null;this.Qta=b;this.eik=Q}get Kgc(){return this.K.kb("OneDriveApiUrl")}start(b,h){this.Km=
b;this.Q$c(h)}eAf(){WL.init(1===this.Brh||2===this.Brh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Q$c(b){this.bHa=b;!this.lwb&&this.Qta.XUc?(r.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.QTf,"onApiReady"))):(r.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.eik())}r1d(){try{r.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Km).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){r.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.zp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){r.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}r.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else r.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.bHa&&this.bHa(!1,b);this.zp()}}Object(m.a)(he,"OneDriveFilePickerApiManagerV5",Oi,[]);class Ng extends Oi{constructor(b,h,u,B,Q){super(b,h,u,B);this.emd=this.M8g=null;this.g0j=Q;this.options={};this.options.clientId=this.K.kb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.wle,"toggleHostDivVisibility")}get Kgc(){return this.K.kb("OneDriveApiV72Url")}start(b,h){this.emd=h;const u=
this.g0j.I3h();u.continueWith(()=>{r.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.M8g=u.result;this.Q$c((B,Q)=>{this.wle();b(B,Q)})},3);u.continueWith(()=>{r.ULS.sendTraceTag(24134242,352,15,u.exception.message);this.wle()},5)}eAf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.M8g;this.options.advanced.iframeParentDiv=this.emd}r1d(){try{r.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.wle(),OneDrive.open(this.options)}catch(b){r.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.zp()}}onFailure(b){this.bHa&&this.bHa(!1,b);this.zp()}wle(){this.emd.style.visibility="hidden"===this.emd.style.visibility?"":"hidden"}}Object(m.a)(Ng,"OneDriveFilePickerApiManagerV7",Oi,[]);class wk extends Oi{constructor(b,
h,u,B){super(b,h,u,B);this.qUj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.kb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Kgc(){return this.K.kb("OneDriveApiV72Url")}start(b,h,u,B){this.options.advanced.iframeParentDiv=u;this.options.advanced.endpointHint=B;this.options.cancel=h;this.qUj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.Q$c(b)}Q$c(b){this.bHa=b;this.lwb?r.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(r.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.QTf,"onApiReady")))}eAf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}r1d(){try{r.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){r.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.zp()}}SVf(b){r.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Hb.a.RYn(this.Kgc);this.$Yb=null}zp(){this.mH().Sef(xd.a.y8n)}onFailure(b){this.bHa&&this.bHa(!1,b)}}Object(m.a)(wk,"OneDriveFilePickerApiManagerV72",
Oi,[]);class Vj{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(m.a)(Vj,"IExtraData",null,[]);class Xg extends wk{constructor(b,h,u,B){super(b,h,u,B);this.options.advanced.filter=b.kb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.Prh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.kb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Vj(v.AFrameworkApplication.userSessionId))}get Kgc(){return this.K.kb("OneDriveApiV72Url")}r1d(){try{r.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){r.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.zp()}}}Object(m.a)(Xg,"OneDriveFilePickerApiOpenManagerV72",wk,[]);class jf{constructor(b){this.fq=null;this.Wf=b;this.JPe=3}I3h(){this.fq=new Jd.a;r.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.Jag();return this.fq.task}Jag(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.WCb);this.Wf.oAb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.d3l,"getMoreInfoSucceeded"),Object(z.a)(this,this.b3l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}b3l(b){if(b.data.Qe===oa.a.jja&&"X-NewKey"in b.data.Aj){r.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.Aj["X-NewKey"];this.Jag(h)}else 0<this.JPe?(r.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.JPe),this.JPe--,this.Jag()):(r.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.fq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}d3l(b){"PersonalFileStorageUrl"in b.data.Aj&&""!==b.data.Aj.PersonalFileStorageUrl?(r.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.fq.Ag(b.data.Aj.PersonalFileStorageUrl)):(r.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.fq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(m.a)(jf,"OneDriveForBusinessEndpointHelper",null,[636]);var sf=c(755);class Rh{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}wc(b){this.W=b;this.W.register(he,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().Sd(()=>new he(sf.a.instance,v.AFrameworkApplication.K,
v.AFrameworkApplication.D8,v.AFrameworkApplication.Ppa,v.AFrameworkApplication.ngg,()=>new Kg));v.AFrameworkApplication.vJb?this.W.register(636,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Sd(()=>new tg):this.W.register(636,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Sd(()=>new jf(v.AFrameworkApplication.He));this.W.register(Ng,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Sd(()=>new Ng(v.AFrameworkApplication.K,v.AFrameworkApplication.D8,
v.AFrameworkApplication.Ppa,()=>new Kg,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(wk,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().Sd(()=>new wk(v.AFrameworkApplication.K,v.AFrameworkApplication.D8,v.AFrameworkApplication.Ppa,()=>new Kg));this.W.register(Xg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Sd(()=>new Xg(v.AFrameworkApplication.K,v.AFrameworkApplication.D8,v.AFrameworkApplication.Ppa,
()=>new Kg))}static main(){M.a.instance.Gc(new Rh)}}Object(m.a)(Rh,"PackageManager",null,[1,2]);class ij{constructor(b,h,u,B,Q,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=u;this.PolicyCookieTTL=B;this.WasServiceDown=Q;this.AffinitizedUrl=ca}}Object(m.a)(ij,"SafeLinksData",null,[]);class hn{constructor(b,h){this.Gke=b;this.YA=h}}Object(m.a)(hn,
"SafeLinksGetUrlReputationRequestData",null,[]);class pg{constructor(b,h,u,B){this.Ga=b;this.Wf=h;this.d3j=u;pg.he=B}Knc(b,h,u){try{var B=null;pg.he&&(B=pg.he.Vf("WebServiceCall","SafeLinksGetUrlReputation"));const Q=new hn(h,B);B={};B.AffinitizedUrl=b;B.TargetUrl=h;B.PolicyCookie=u;const ca=G.c(B);this.Wf.sj(this.d3j,2,ca,null,!1,2,Object(z.a)(this,this.tmn,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.smn,"onGetUrlReputationFailureCallback"),Q,void 0,void 0,3E3,3E3,"36");return!0}catch(Q){r.ULS.sendTraceTag(588788033,
378,10,Q.message)}return!1}tmn(b){let h="OnGetUrlReputationSuccessCallback: ",u=10;const B=b.data.state;try{const Q=G.b(b.data.se).reputationResults[0],ca=Q.navigateUrl.length,qa=B.Gke.length,Qa=Q.navigateUrl===B.Gke;Q.navigateUrl&&0<Q.navigateUrl.length&&(B.Gke=Q.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Qe,Q.verdict,qa.toString(),ca.toString(),Qa.toString());u=50}catch(Q){h+=String.format("Exception {0}",
Q.message)}this.Lki(B,h,u)}smn(b){let h="OnGetUrlReputationFailureCallback: ";const u=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Qe)}catch(B){h+=String.format("Exception {0}",B.message)}this.Lki(u,h,10)}Lki(b,h,u){b.YA&&(b.YA.stop(),b.YA=null);r.ULS.sendTraceTag(588788034,378,u,h);Qd.a.om(b.Gke,void 0,"noopener,noreferrer","SafeLinksNav")}}pg.he=null;Object(m.a)(pg,"SafeLinksNavigationHelper",null,[]);var Rl;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=
1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Rl||(Rl={}));Object(m.b)("SafeLinksNavigationState",Rl);class nh{constructor(b,h,u,B=!1,Q=null,ca=null){this.Rub=this.Qub=0;this.RVc=this.wld=!1;this.Acb=null;this.YXb=!0;this.Lvd=null;r.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ga=b;this.Wf=h;this.Iea=u;nh.he=ca;this.Xmk=B?this.Ga.kb("SafeLinksHandlerWebServiceBase"):
this.Ga.kb("WebServiceBase");this.rmk=this.Ga.kb("SafeLinksHashedUserId");this.G5o=this.Ga.kb("SafeLinksWorkloadIdHeaderValue");this.gqd=this.Ga.lc("SafeLinksMaxGetPolicyBootRetries",2);this.hqd=this.Ga.lc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Rnd=this.xRm();this.Qnd=this.wRm();nh.Pjh=this.Ga.kb("UserPrincipalName")||"";nh.wDc=this.Ga.kb("TenantId")||"";r.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Rnd,this.Qnd);if(this.Rnd&&
this.Qnd){h=(b=this.mib())?b.IsSafeLinksEnabled.toLowerCase():"";u=this.GFf();r.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,u);var qa=!b||"unknown"===h||b.WasServiceDown||u,Qa=ib.a.oG();Qa&&(Qa.set("shouldGetSafeLinksDataFromServer",qa.toString()),Qa.set("isSafeLinksEnabledCacheValue",h.toString()));Q?(this.YXb=!1,Q.execute(rb=>{rb.isFeatureEnabled("MsoUrlreputation",!0).then(Lb=>{this.YXb=Lb;Qa.set("isUserLicensedForSafeLinks",this.YXb.toString());
xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Qa);this.YXb&&qa&&this.nTd(!0);return null})})):(xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Qa),qa&&this.nTd(!0))}}get appName(){return this.Iea}get Goe(){return this.Xmk}get userId(){return this.rmk}get tii(){try{if(""===nh.IBe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=v.AFrameworkApplication.buildVersion;b.OS=this.Ga.kb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);
nh.IBe=window.self.btoa(h)}}catch(b){r.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return nh.IBe}get f8l(){const b=this.Goe?this.Goe+"/":"",h=new bb.QueryStringBuilder("SafeLinksHandler.ashx");h.ye("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.ye("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ye("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.ye("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.km)}get uhm(){const b=this.Goe?this.Goe+"/":"",h=new bb.QueryStringBuilder("SafeLinksHandler.ashx");h.ye("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.ye("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ye("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.ye("s2saat","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.ye("s2se03","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.ye("sladpar",this.tii);h.ye("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.km)}get Kdn(){nh.uQe||(nh.uQe=new pg(this.Ga,this.Wf,this.uhm,nh.he));return nh.uQe}Knc(b){if(!b)return r.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.RLm(b);r.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.Rnd,this.Qnd,this.YXb);if(!(h&&this.Rnd&&this.Qnd&&this.YXb))return!1;h=0;const u=({state:h}=this.pso()).returnValue;r.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Rl[h]);const B=ib.a.oG();B&&B.set("SafeLinksNavigationState",Rl[h]);xa.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",B);if(!u)return 2!==h&&3!==h||xa.Health.instance.recordKpiFailure("SafeLinksNavigations",Rl[h],!1,!0,null),!1;r.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.Nso())return this.GFf()?!1:this.Kdn.Knc(this.LKl(),b,this.sdi());if(!this.GFf())return this.hBj(b),!0;this.Acb=b;r.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.RVc=!1;this.nTd();return!0}RLm(b){b=b.toLowerCase();const h=this.Ga.BB("SafeLinksUnsupportedProtocols");if(h)for(let u=0;u<h.length;u++)if(b.startsWith(h[u]))return!1;return!0}nTd(b=!1){var h=ib.a.oG();h&&h.set("isOnBootRequest",b.toString());
xa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);xa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.u$e("SafeLinksGetPolicy");this.Wf.sj(this.f8l,1,null,null,!0,2,Object(z.a)(this,this.Fam,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.Eam,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.RVc=b;this.wld=!0;b?this.Qub++:this.Rub++}Fam(b){let h=oa.a.wfn,
u="";try{this.wld=this.RVc=!1;var B=b.data.state;const Fc=({YA:B}=this.Bje(B)).returnValue,Sc=Object.assign(new Ub.a,{durationMs:Fc});xa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Sc);r.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Qe,b.data.se.length,Fc);if(b.data.Qe!==oa.a.$y)u="Unexpected httpStatus: "+b.data.Qe.toString();else{B=null;try{B=G.b(b.data.se)}catch(ld){u="Exception:"+
ld.toString()+" deserializing response";return}if(B){var Q=B.IsSafeLinksEnabled;if(void 0===Q||null===Q||0>=Q.length)u="Invalid isSafeLinksEnabledString";else{r.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Q);var ca=nh.LZf(Q);if(void 0===B.WebAffinitizedUrl||null===B.WebAffinitizedUrl||0>=B.WebAffinitizedUrl.length)u="Invalid WebAffinitizedUrl";else if(void 0===B.PolicyCookie||null===B.PolicyCookie||0>=B.PolicyCookie.length)u="Invalid PolicyCookie";else if(void 0===B.PolicyCookieTTL||
null===B.PolicyCookieTTL)u="Invalid PolicyCookieTTL";else{var qa=B.WebAffinitizedUrl,Qa=B.PolicyCookie,rb=B.AffinitizedUrl,Lb=new Date;Lb.setMinutes(Lb.getMinutes()+(5<B.PolicyCookieTTL?B.PolicyCookieTTL-5:0));var Yb=Lb.getTime(),gc=new ij(Q,qa,Qa,Yb,!1,rb);this.Kij(gc);h=b.data.Qe;this.Acb&&(ca?(this.hBj(this.Acb),this.Rub=this.Qub=0):(r.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",
!0,!0,null),Qd.a.KEb(this.Acb)),this.Acb=null)}}}else u="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Fc){u="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Fc.toString()}finally{h!==oa.a.$y&&this.Kki(h,u)}}Eam(b){this.wld=!1;let h=500,u="";try{let B=b.data.state;const Q=({YA:B}=this.Bje(B)).returnValue,ca=Object.assign(new Ub.a,{durationMs:Q});h=b.data.Qe;xa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),
!1,!0,ca);u="Request Failed, Status="+Pg.a[b.data.status]+" Duration: "+Q}catch(B){u="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+B.toString()}finally{this.Kki(h,u)}}Kki(b,h=""){try{if(r.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.Qub<this.gqd&&this.Rub<this.hqd)this.nTd(this.RVc);else{this.RVc=!1;r.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.Qub,this.Rub,b,h);h=null;const u=ib.a.oG();u&&(u.set("HttpStatus",b.toString()),h=Object.assign(new Ub.a,{extendedProperties:u}));xa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const B=new ij("false","","",0,!0,"");this.Kij(B);this.Acb&&(r.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Qd.a.KEb(this.Acb),this.Acb=null)}}catch(u){r.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",u.toString())}}hBj(b){const h=this.sdi(),u=this.Iim(),B={};B.Url=b;B.SafeLinksCookie=h;B.CorrelationId=yb.a.create().toString();B.WorkloadId=this.G5o;B.UserAgentInfo=Z.a.jG+"|"+this.appName;this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(B.User=nh.Pjh,B.TenantId=nh.wDc,B.AdditionalProperties=this.tii);r.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",B.CorrelationId);Qd.a.D0f(Qd.a.Ura(4),u,B)}xRm(){const b=this.Ga.kb("IsSafeLinksEnabledForUser");return b?nh.LZf(b):!1}wRm(){const b=this.Ga.BB("SafeLinksDisabledBrowsers");if(Z.a.E4){if(this.Ga.ow("SafeLinksForTeamsIsEnabled")&&this.Ga.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,Z.a.jG))return!1;return"officecomhwa"===(this.Ga.kb(v.AFrameworkApplication.nka)||"").toLowerCase()?
!1:!0}Nso(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Z.a.tWc?!0:Z.a.E4}pso(){let b;b=0;const h=this.mib(),u=h?h.IsSafeLinksEnabled:"";if(""!==u)return h.WasServiceDown?(r.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===u.toLowerCase()?(r.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:nh.LZf(u),state:b};if(this.wld)return b=3,r.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.Qub>=this.gqd||this.Rub>=this.hqd)return b=2,r.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.Qub,this.gqd,this.Rub,this.hqd),{returnValue:!1,state:b};r.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.gqd+this.hqd-(this.Qub+this.Rub));return{returnValue:!0,state:b}}sdi(){const b=this.mib();return b?b.PolicyCookie:""}Iim(){const b=this.mib();return b?b.WebAffinitizedUrl:""}LKl(){const b=this.mib();return b?b.AffinitizedUrl:""}lVl(){const b=new Date;try{const h=this.mib();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){r.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}GFf(){const b=this.lVl();return!!b&&b.getTime()<Date.now()}mib(){if(!this.Lvd){const b=
$a.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Lvd=JSON.parse(b)}return this.Lvd}Kij(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Lvd=b;b.WasServiceDown||this.V5o(b)}V5o(b){b=JSON.stringify(b);$a.a.instance.setItem(this.userId,b)}u$e(b){return void 0!==nh.he&&null!==nh.he?nh.he.Vf("WebServiceCall",
b):null}Bje(b){if(void 0!==b&&null!==b){const h=b.li;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,YA:b}}static LZf(b){return"false"!==b.toLowerCase()?!0:!1}}nh.he=null;nh.uQe=null;nh.wDc="";nh.Pjh="";nh.IBe="";Object(m.a)(nh,"SafeLinksManager",null,[658]);const vl=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},Dl=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class oe{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}wc(b){this.W=b}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Hn(Object(z.a)(this,this.Wx,"onFullAppSettingsReady"))}dispose(){}Wx(){v.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(nh,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().Sd(()=>new nh(v.AFrameworkApplication.K,v.AFrameworkApplication.He,String.format("{0}-{1}",
vl(v.AFrameworkApplication.ua.Lb.Nk),Dl(v.AFrameworkApplication.ua.Lb.Jia)),!1,this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.ua.Iq)),this.W.Oa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){M.a.instance.Gc(new oe)}}Object(m.a)(oe,"SafeLinksPackage",null,[1,2]);var Yg=c(211);class Vh{constructor(b){this.sa=new Nc.a;this.Lh=b}seb(b){this.sa.addHandler(Vh.mza,b)}b6c(b){this.sa.removeHandler(Vh.mza,b)}ZZa(b){this.sa.addHandler(Vh.PUa,b)}zOb(b){this.sa.removeHandler(Vh.PUa,
b)}l_e(b){this.sa.addHandler(Vh.inc,b)}Ifg(){this.sa.raiseEvent(Vh.mza)}Nxf(){return Yg.a.instance.fRa(v.AFrameworkApplication.wy)}}Vh.mza="SE";Vh.k8c="SEP";Vh.PUa="SER";Vh.inc="TRP";Object(m.a)(Vh,"NullSessionExpirationManager",null,[626,627]);class Tf{constructor(){this.uCc=this.mdb=!1;const b=v.AFrameworkApplication.wy;0>=b||(this.wy=b,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.wy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.kX}),
Yg.a.instance.aqh(Object(z.a)(this,this.Bgc,"onSessionExpiredDetected")),Yg.a.instance.$ph(Object(z.a)(this,this.K1c,"onSessionExpiringDetected")))}Bgc(){Yg.a.instance.jaj(Object(z.a)(this,this.Bgc,"onSessionExpiredDetected"));r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.exf()}K1c(){Yg.a.instance.H_n(Object(z.a)(this,this.K1c,"onSessionExpiringDetected"));this.uCc||this.mdb||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.uCc=!0,
this.pgg())}exf(){this.mdb||(v.AFrameworkApplication.lN(xd.a.j8c),this.mdb=!0,this.vie())}}Object(m.a)(Tf,"ASessionExpirationManager",null,[]);var Hf=c(168),sh=c(275);class sj{constructor(b,h,u,B){this.Kkg="";this.ifd=b;this.keh=u;this.geh=B;this.y_g=h;b=(new Date(this.ifd)).format(v.AFrameworkApplication.aoj);this.Kkg=this.y_g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}hkc(b){1===b?this.keh&&this.keh(this.y_g):0===b&&v.AFrameworkApplication.va.Rb(Za.a.close,
2,sh.g)}dispose(){this.geh&&this.geh()}}sj.id="SessionExpirationDialog";Object(m.a)(sj,"SessionExpirationDialogSharedProperties",null,[]);class Tk{}Tk.Yg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(m.a)(Tk,"SessionExpirationDialogHtml",null,[]);class El extends Hf.a{constructor(b,h,u,B){super(h);const Q={};this.cZa=new sj(b,h,u,B);this.ug=sj.id;v.AFrameworkApplication.Vzh?(this.Cd=1,
this.xe(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Ht=!1);h||1===v.AFrameworkApplication.ua.mode?this.xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Yg=Tk.Yg;Q.WACSessionExpirationText=this.cZa.Kkg;this.Qh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.hkc,"sessionExpirationDialogHandler"),Q);this.C5(this.mj("WACSessionExpirationText"))}hkc(b){this.cZa.hkc(b)}hyf(){this.hide()}dispose(){super.dispose();
this.cZa&&this.cZa.dispose()}}Object(m.a)(El,"LegacySessionExpirationDialog",Hf.a,[702]);class $g extends mg.StandardDialog{constructor(b,h,u,B){super(h);this.cZa=new sj(b,h,u,B);this.ug=sj.id;v.AFrameworkApplication.Vzh?(this.Cd=1,this.xe(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Ht=!1);h||1===v.AFrameworkApplication.ua.mode?this.xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.pv(CommonUIStrings.l_DefaultDialogTitle,
this.cZa.Kkg,0,Object(z.a)(this,this.hkc,"sessionExpirationDialogHandler"))}hkc(b){this.cZa.hkc(b)}hyf(){this.hide()}dispose(){super.dispose();this.cZa&&this.cZa.dispose()}}Object(m.a)($g,"SessionExpirationDialog",mg.StandardDialog,[702]);const Ef=(b,h,u,B)=>v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pF&&v.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new $g(b,h,u,B):new El(b,h,u,B);var em=c(201);class Di extends Tf{constructor(b){super();this.nwd=this.O_b=
!0;this.f_=null;this.sa=new Nc.a;this.Lh=b}seb(b){this.sa.addHandler(Di.mza,b)}b6c(b){this.sa.removeHandler(Di.mza,b)}ZZa(b){this.sa.addHandler(Di.PUa,b)}zOb(b){this.sa.removeHandler(Di.PUa,b)}l_e(b){this.sa.addHandler(Di.inc,b)}Nxf(){return Yg.a.instance.fRa(v.AFrameworkApplication.wy)}Ifg(b){this.O_b=b}pgg(){if(!this.f_&&!em.a.BM){if(this.nwd){const b=Object(z.a)(this,this.w6b,"disposeCallback");this.f_=Ef(this.wy,!1,Object(z.a)(this,this.ikc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(Di.k8c)}}vie(){this.f_&&
(this.f_.ypa&&this.f_.hyf(),this.f_=null);if(this.O_b){const b=Object(z.a)(this,this.w6b,"disposeCallback");this.f_=Ef(this.wy,!0,Object(z.a)(this,this.ikc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(Di.mza)}w6b(){this.f_=null}ikc(b){(b||this.Lh.cDd())&&this.Lh.refreshDocument(null)}}Di.mza="SE";Di.k8c="SEP";Di.PUa="SER";Di.inc="TRP";Object(m.a)(Di,"SessionExpirationManager",Tf,[626,627]);class Zf{}Zf.Dnk="Aborting";Zf.pAd="ActivityDuration";Zf.error="Error";Zf.Whf="Errors";Zf.failed="Failed";
Zf.xEb="FirstActivity";Zf.initialized="Initialized";Zf.kickedOut="KickedOut";Zf.sXm="LastActivity";Zf.vdj="RetryOverride";Zf.vde="RequestGroups";Zf.Job="Requests";Zf.Hde="Responses";Zf.ofe="SessionDuration";Zf.status="Status";Zf.success="Success";Zf.GCo="Successful";Zf.tokens="Tokens";Zf.a0f="PollingDuration";Object(m.a)(Zf,"SessionExpirationStrings",null,[]);class eb{constructor(b){this.qC={};this.Gka={};this.mYa={};this.gJi=15;this.t1g=!1;this.Ugk=new Date;this.epd=new Date;this.Ib=b;this.iO=new bf.a(2,
2,6E4*this.gJi,Object(z.a)(this,this.qKj,"writeMeasures"),135,"SL",!1);this.Ib.Xb(this.iO);this.izm()}qKj(){r.ULS.sendTraceTag(41964821,217,50,r.ULS.lYc({["Aggregate"]:this.Gka,["Current"]:this.qC}))}izm(){this.Gka[Zf.vde]=0;this.Gka[Zf.Job]=0;this.Gka[Zf.Hde]=0;this.Gka[Zf.status]=Zf.initialized;this.Gka[Zf.xEb]=new Date;this.Gka[Zf.ofe]=0;this.Gka[Zf.pAd]=0;this.Gka[Zf.ofe]=0;this.qC[Zf.ofe]=0;this.Gka[Zf.pAd]=0;this.qC[Zf.pAd]=0}get xBn(){this.mYa[Zf.a0f]=+new Date-+this.mYa[Zf.xEb];return this.mYa}Lzf(b,
h){var u=b[h];u=u?u:0;u++;b[h]=u;this.ycg(b)}ycg(b){const h=new Date;b[Zf.pAd]=+h-+this.epd;this.epd=h;b[Zf.ofe]=+this.epd-+this.Ugk;b[Zf.sXm]=this.epd}x$(b,h){this.qC[b]=h;this.ycg(this.qC)}Pbg(b,h){this.qC[b]=h;this.ycg(this.qC)}Oac(b){this.Lzf(this.qC,b);this.Lzf(this.Gka,b);this.Lzf(this.mYa,b)}flush(){this.t1g||(this.Gka[Zf.status]=this.qC[Zf.status],this.qKj(this.iO),this.Ib.o1(this.iO,6E4*this.gJi))}G3n(){const b=this.qC[Zf.status];b&&(this.Gka[Zf.status]=b);this.qC={}}X3n(){this.mYa={};this.mYa[Zf.a0f]=
0;this.mYa[Zf.xEb]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.t1g=!0;this.Ib.Ze(this.iO)}}Object(m.a)(eb,"SessionLogger",null,[622]);class Kb{constructor(b,h){this.nyd=b;this.dBa=h}get tokens(){return this.nyd}get errors(){return this.dBa}}Object(m.a)(Kb,"TokenRefreshArgs",null,[654]);var fc=c(397);class Hc extends Sys.EventArgs{constructor(b,h,u,B,Q,ca,qa){super();this.mYa=b;this.oBn=h;this.vde=B;this.failed=Q;this.Job=ca;this.Hde=
qa}}Object(m.a)(Hc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Pc=c(35);class ec{constructor(b,h=null,u=null){this.uCc=this.mdb=!1;this.nwd=this.O_b=!0;this.sa=new Nc.a;this.wCc=this.wxc=this.$td=!1;this.Gxb=null;this.M$g=10;this.vod=!1;this.$Ue=b;this.JGe=v.AFrameworkApplication.yVm;this.Ib=Bg.a.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:v.AFrameworkApplication.wy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.kX});
this.te=h||new eb(Bg.a.instance);this.kma=u;Yg.a.instance.aqh(Object(z.a)(this,this.xnk,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Yg.a.instance.$ph(Object(z.a)(this,this.EXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));fc.SessionStatusManager.instance.i_e(Object(z.a)(this,this.EXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));fc.SessionStatusManager.instance.fxk(Object(z.a)(this,this.qDn,"preemptiveTokenRefresh"));this.N2g=new Date;v.AFrameworkApplication.xVm&&
(Yg.a.instance.M5e=Object(z.a)(this,this.qRn,"refreshAccessTokenWhenSessionExpired"));b=!1;v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.M$g=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=v.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));
b?fc.SessionStatusManager.instance.i_e(Object(z.a)(this,this.ynk,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):fc.SessionStatusManager.instance.i_e(Object(z.a)(this,this.EXe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}seb(b){this.sa.addHandler(ec.mza,b)}b6c(b){this.sa.removeHandler(ec.mza,b)}ZZa(b){this.sa.addHandler(ec.PUa,b)}zOb(b){this.sa.removeHandler(ec.PUa,b)}l_e(b){this.sa.addHandler(ec.inc,b)}Nxf(){return Yg.a.instance.fRa(v.AFrameworkApplication.wy)}qRn(){this.aSc(!1);
return!Yg.a.instance.fRa(v.AFrameworkApplication.wy)}xnk(b,h){Yg.a.instance.$_d?this.Bgc(b,h):this.JGe?(this.wxc=!1,this.aSc(!1)):(this.mdb||r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.Bgc(b,h))}ynk(b,h){Yg.a.instance.Z_d?this.K1c(b,h):(Pc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.wxc=!1,this.aSc(!0))}EXe(b,h){Yg.a.instance.Z_d?this.K1c(b,h):this.aSc(!0)}aSc(b){if(!this.$td&&!this.wxc)if(this.kma&&
this.kma.Fo)this.wCc=!0,this.te.x$(Zf.status,Zf.kickedOut),this.te.flush(),this.te.stop();else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.wCc),this.wCc)this.vie();else{this.te.flush();this.te.G3n();this.te.Oac(Zf.vde);this.$td=!0;this.vod||(this.te.X3n(),this.vod=!0,this.r7k());const h=this.$Ue.KRn(b);h.continueWith(()=>{if(this.$Ue.vHn(h))this.te.Oac(Zf.GCo),this.te.x$(Zf.status,Zf.success),this.nwd=!1,this.JGe&&(this.O_b=!1),this.wxc=!1,this.N2g=
new Date,this.pBo(),this.sa.raiseEvent(ec.PUa,new Kb(h.result.tokens,null));else{const u=h.result.errors;this.te.Oac(Zf.failed);this.te.x$(Zf.status,Zf.failed);b||(this.wCc=this.$Ue.NWc(u));this.wCc&&(this.te.x$(Zf.Dnk,JSON.stringify(u)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.wxc=!0;this.sa.raiseEvent(ec.PUa,new Kb(null,u))}this.te.flush();this.$td=!1})}}Bgc(){this.JGe||Yg.a.instance.jaj(Object(z.a)(this,this.Bgc,"onSessionExpiredDetected"));r.ULS.sendTraceTag(39408094,
217,50,"SessionExpiredDetected");this.exf(Yg.a.instance.$_d)}K1c(){this.uCc||this.mdb||(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.uCc=!0,this.pgg(Yg.a.instance.Z_d))}exf(b){if(!this.mdb){var h=b?xd.a.cdo:xd.a.j8c;const u=Object.assign(new Ub.a,{extendedProperties:new Map});u.extendedProperties.set("ErrorCode",String.format("{0}",h));v.AFrameworkApplication.lN(h,void 0,["SessionExpired"],u);b||(b=new Date,h=new Date(v.AFrameworkApplication.kX),r.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,u),2592E5>+b-+h&&xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,u));this.mdb=!0;this.vie()}}pBo(){this.vod&&(this.Ib.Ze(this.Gxb),this.vod=!1)}r7k(){this.Gxb=new bf.a(2,2,1E3*this.M$g,Object(z.a)(this,this.$Io,"tokenRefreshPolling"),
135);this.Ib.Xb(this.Gxb)}$Io(){const b=this.te.xBn;r.ULS.sendTraceTag(555255521,217,50,"{0}",G.c(b));this.sa.raiseEvent(ec.inc,new Hc(b,b[Zf.a0f],b[Zf.xEb],b[Zf.vde],b[Zf.failed],b[Zf.Job],b[Zf.Hde]))}qDn(){3E5<+new Date-+this.N2g?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.aSc(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}ec.mza="SE";ec.k8c="SEP";ec.PUa="SER";ec.inc="TRP";Object(m.a)(ec,
"ASessionExpirationManagerWithRefresh",null,[]);class Ld extends ec{constructor(b,h,u=null,B=null){super(h,u,B);this.f_=null;this.Lh=b}Ifg(b){this.O_b=b}pgg(b){if(!this.f_&&!em.a.BM){if(b){var h=Object(z.a)(this,this.w6b,"disposeCallback");this.f_=Ef(v.AFrameworkApplication.Wob,!1,Object(z.a)(this,this.ikc,"sessionExpirationHandler"),h)}else if(this.nwd){if(this.$td)return;h=Object(z.a)(this,this.w6b,"disposeCallback");this.f_=Ef(v.AFrameworkApplication.wy,!1,Object(z.a)(this,this.ikc,"sessionExpirationHandler"),
h)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",ec.k8c,b);this.sa.raiseEvent(ec.k8c)}}vie(){this.f_&&(this.f_.ypa&&this.f_.hyf(),this.f_=null);if(this.O_b){this.te.stop();if(this.kma&&this.kma.Fo)return;const b=Object(z.a)(this,this.w6b,"disposeCallback");this.f_=Ef(v.AFrameworkApplication.wy,!0,Object(z.a)(this,this.ikc,"sessionExpirationHandler"),b)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",ec.mza);this.sa.raiseEvent(ec.mza)}w6b(){this.f_=null}ikc(b){(b||
this.Lh.cDd())&&this.Lh.refreshDocument(null)}}Object(m.a)(Ld,"SessionExpirationManagerWithRefresh",ec,[626,627]);class De{constructor(b,h,u=null,B=null){this.xjh=!1;this._instance=null;this._frame=b;this.Jm=h;this.te=u||new eb(Bg.a.instance);this.kma=B}create(){this.xjh=v.AFrameworkApplication.pRa;if(!this.xjh)return new Di(this._frame);v.AFrameworkApplication.$n("WOPITokenRefreshIsEnabled");r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(v.AFrameworkApplication.h2o){case 1:r.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this._instance=new Vh(this._frame);break;case 2:r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Ld(this._frame,this.Jm,this.te,this.kma);break;default:r.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Di(this._frame)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());
return this._instance}}Object(m.a)(De,"SessionExpirationManagerFactory",null,[625]);class cf{}Object(m.a)(cf,"Error",null,[]);class nf{}Object(m.a)(nf,"NamedResult",null,[]);class Wb extends nf{}Object(m.a)(Wb,"ErrorInfo",nf,[]);var Ug=c(1084);class gi{constructor(b,h,u,B=null,Q=!1,ca=null,qa=!1,Qa=!1){this.bCa=0;this.eNa=this.Ao=null;this.nyd=new zb.a;this.dBa=new zb.a;this.fq=null;this.dxc=!1;this.IDc=this.JDc=null;this.Ib=b;this.R$g=h;this.R$g.execute(rb=>{rb.bC(L.a.Jyf,Object(z.a)(this,this.Imn,
"onHostResponseReceived"))});this.j3=u;this.dih=new Ug.a("WebServiceCall","TokenRefresh");this.te=B||new eb(b);this.Ngk=Q;this.kf=ca?ca:fc.SessionStatusManager.instance;this.BSg=qa;this.Rjd=Qa}Imn(b){if(b.MessageId!==L.a.Jyf)Pc.b(39408099,306,15,"Unexpected message.");else{var h=new zb.a,u=new zb.a;this.te.Oac(Zf.Hde);var B=b.Values[H.a.kij];if(!B||0>=B.length)Pc.b(40122317,306,15,"Found no tokens in the dictionary"),B=b.Values;Pc.b(40122318,306,100,"The Tokens array contains {0} tokens",B.length);
this.te.x$("Correlation",b.CorrelationId);var Q="";for(let Qa=0;Qa<B.length;Qa++){this.te.Pbg(Zf.tokens,B.length);var ca=B[Qa],qa=ca;if(!qa||!qa.Name)continue;this.te.Oac(qa.Name);const rb=ca;if(rb&&rb.Value)Pc.b(39408128,306,100,"Received token with name: {0}",rb.Name),h.add(rb),this.nyd.add(rb),this.Rjd||this.te.x$(Zf.status,Zf.success),this.BSg&&this.kf&&this.kf.o4n();else if(ca=this.Qam(ca),Pc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",qa.Name,
JSON.stringify(ca),this.eNa),u.add(ca),this.Rjd||(this.dBa.add(ca),Q=JSON.stringify(ca),this.te.x$(Zf.error,JSON.stringify(ca)),this.te.x$(Zf.status,Zf.failed)),this.BSg)for(const Lb of ca.Errors)qa=this.$Ul(Lb),this.kf&&this.kf.euk(qa)}this.Rjd?(0<u.count?this.IDc?this.IDc(new Kb(h,u)):Pc.b(512267295,306,15,"Received errors but the promise has completed"):this.JDc?this.JDc(new Kb(h,u)):Pc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Pc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,u.count,b.CorrelationId,this.eNa)):(0<u.count&&""!==Q?(B=Object.assign(new Ub.a,{extendedProperties:new Map}),B.extendedProperties.set("Errors",Q),B.extendedProperties.set("RetryCount",this.bCa.toString()),B.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),B.extendedProperties.set("IsTokenExpiring",this.dxc.toString()),xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,B)):xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),
Pc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,u.count,b.CorrelationId,this.eNa),0<u.count&&!this.NWc(u)?(b=this.j3.Lei(u),b!==this.j3.ijc&&(this.te.Pbg(Zf.vdj,b),this.Ib.o1(this.Ao,b))):(this.te.flush(),this.Ao&&(Pc.b(39408131,306,100,"Deleting task {0} from task manager",this.Ao.name),this.Ib.Ze(this.Ao)),this.fq&&!this.fq.task.isCompleted?this.fq.Ag(new Kb(h,u)):Pc.b(512267293,306,15,"Received results but the task has completed")))}}Qam(b){if(!b)return null;
const h=Object.assign(new Wb,{Name:b.Name,Errors:[]});for(const u of b.Errors)b=new cf,b.Id=u.Id,b.Details=ta.a.h$b(u.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.gcj()}gcj(){v.AFrameworkApplication.le("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.bCa>=this.j3.E3d?(Pc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.eNa),this.j9k(this.fq)):(xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.thj())}thj(){const b=
{};b[H.a.kij]=this.j3.tokens;const h=yb.a.create().toString();Pc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.j3.tokens),this.bCa+1,h,this.eNa);this.R$g.execute(u=>{u.sendMessage(L.a.G0e,b,h)});this.bCa++;this.te.Oac(Zf.Job)}j9k(b){const h=new zb.a;for(let u=0;u<this.j3.tokens.length;u++){const B=Object.assign(new Wb,{Name:this.j3.tokens[u],Errors:[Object.assign(new cf,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(B);this.dBa.add(B)}this.Ib.Ze(this.Ao);this.te.x$(Zf.Whf,JSON.stringify(this.dBa));this.te.x$(Zf.status,Zf.failed);b&&!b.task.isCompleted&&b.Ag(new Kb(new zb.a,this.dBa))}KRn(b){this.dih.start();this.dxc=b;this.eNa=yb.a.create().toString();Pc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.eNa,this.dxc);this.bCa=0;this.dBa.clear();this.nyd.clear();this.fq=new Jd.a;this.Rjd?this.hcj(this.j3.E3d).then(h=>{this.fq&&!this.fq.task.isCompleted&&this.fq.Ag(h);this.IDc=
this.JDc=null;this.te.x$(Zf.Whf,JSON.stringify(this.dBa));this.te.x$(Zf.status,Zf.success);this.te.flush()}).catch(h=>{this.fq&&!this.fq.task.isCompleted&&this.fq.Ag(Object(Na.a)(654,h));this.IDc=this.JDc=null;this.te.x$(Zf.Whf,JSON.stringify(this.dBa));this.te.x$(Zf.status,Zf.failed);this.te.flush()}):(this.Ao=new bf.a(this.j3.priority,2,this.j3.ijc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,L.a.G0e,!0),this.Ngk&&this.gcj(),this.Ib.Xb(this.Ao));return this.fq.task}hcj(b){const h=
this,u=new Promise((Qa,rb)=>{h.JDc=Qa;h.IDc=rb;xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.thj()}),B=this,Q=new Promise((Qa,rb)=>{window.setTimeout(()=>{rb(B.xKh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},B.j3.ijc)});let ca=b;const qa=this;return new Promise((Qa,rb)=>{ca--;Promise.race([u,Q]).then(Lb=>{xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Qa(Lb)}).catch(Lb=>{var Yb=qa.j3.ijc;if(Object(Cb.a)(654,Lb)&&
(Lb=Object(Na.a)(654,Lb),0<Lb.errors.count)){qa.x2m(Lb.errors);qa.Ymh(Lb.errors);if(qa.NWc(Lb.errors)){rb(Lb);return}const gc=qa.j3.Lei(Lb.errors);gc!==qa.j3.ijc?(qa.te.Pbg(Zf.vdj,gc),Yb=gc):qa.WTm(Lb.errors)&&(Yb=0)}ca?window.setTimeout(()=>{qa.hcj(ca).then(Qa).catch(rb)},Yb):(Yb=qa.xKh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),qa.Ymh(Yb.errors),rb(Yb),Pc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
qa.eNa))})})}Ymh(b){for(let h of b)this.dBa.add(h)}WTm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}xKh(b,h){const u=new zb.a;for(let B=0;B<this.j3.tokens.length;B++){const Q=this.k9k(this.j3.tokens[B],b,h);u.add(Q)}return new Kb(new zb.a,u)}k9k(b,h,u){return Object.assign(new Wb,{Name:b,Errors:[Object.assign(new cf,{Id:h,Details:u})]})}x2m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new Ub.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.bCa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.dxc.toString());xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.te.x$(Zf.error,b);this.te.x$(Zf.status,Zf.failed)}}vHn(b){this.dih.stop();const h=this.Npm(b.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.eNa,this.dxc,this.bCa,this.dBa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.uHn(b.result.tokens)}NWc(b){return this.j3.NWc(b)}uHn(b){for(let h=0;h<b.count;h++){const u=b.J(h);if(u.Name===H.a.accessToken){const B=(new Date).getTime();u.Expiry>v.AFrameworkApplication.wy?
(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:u.Expiry,["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.kX},"PreviousAccessTokenTtl",v.AFrameworkApplication.wy),v.AFrameworkApplication.accessToken=u.Value,v.AFrameworkApplication.wy=Math.floor(u.Expiry),v.AFrameworkApplication.Mqg=B,v.AFrameworkApplication.rua=Math.floor(u.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:u.Expiry,
["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.kX},"PreviousAccessTokenTtl",v.AFrameworkApplication.wy)}}return!0}Npm(b){let h=!1;for(let u=0;u<b.count;u++){h=!0;const B=b.J(u);r.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",B.Name,JSON.stringify(B.Errors),this.eNa)}return h}$Ul(b){let h=xd.a.j8c;b=parseInt(b.Id);if(isNaN(b))h=xd.a.rJj;else{switch(b){case 401:h=xd.a.Nqg;break;case 403:h=xd.a.pJj;break;case 500:h=xd.a.qJj;break;case 503:h=xd.a.tJj}h===
xd.a.j8c&&(h=500<b?xd.a.sJj:xd.a.oJj)}return h}}Object(m.a)(gi,"TokenRefreshManager",null,[624]);class rf{constructor(){this.ijc=v.AFrameworkApplication.k2o;this.E3d=v.AFrameworkApplication.i2o;this.tokens=v.AFrameworkApplication.Vjm();this.priority=v.AFrameworkApplication.l2o;this.nch=this.kko();this.jXe=v.AFrameworkApplication.Ujm()}NWc(b){b=JSON.stringify(b);if(this.jXe&&0<this.jXe.length)for(const h of this.jXe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}Lei(b){try{if(b)for(let h of b)if(h.Errors)for(const u of h.Errors)if(u.Id in
this.nch)return Number.parseInvariant(this.nch[u.Id].toString())}catch(h){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.ijc}kko(){const b={};try{if(!v.AFrameworkApplication.tUd()||0>=v.AFrameworkApplication.tUd().length||""===v.AFrameworkApplication.tUd()[0])return b;for(const h of v.AFrameworkApplication.tUd())0<h.length&&(b[h]=v.AFrameworkApplication.j2o)}catch(h){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(m.a)(rf,"TokenRefreshPolicy",null,[623]);class Uk{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){v.AFrameworkApplication.K.Hn(()=>{this.k3a()})}k3a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}wc(b){this.W=b;b.register(622,"Common.App.SessionExpiration.ISessionLogger").ha().Sd(()=>new eb(Bg.a.instance));
b.register(623,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().Sd(()=>new rf);b.register(624,"Common.App.SessionExpiration.ITokenRefreshManager").ha().Sd(()=>new gi(Bg.a.instance,v.AFrameworkApplication.kP(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),v.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa("Common.ISessionStatus"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),v.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(625,"Common.ISessionExpirationManagerFactory").ha().Sd(()=>new De(v.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Oa("Common.ISessionStatus")));b.register(626,"Common.ISessionExpirationManagerWithDialog").ha().Sd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(627,"Common.ISessionExpirationManager").ha().Sd(()=>
b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){M.a.instance.Gc(new Uk)}}Object(m.a)(Uk,"SessionExpirationPackage",null,[1,2]);var ee=c(758),Rk=c(399),wh=c(336),yg=c(207);class So extends yg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(So,"PersonaButtonProps",yg.a,[]);class Sm{s5b(b,h){if(b&&!(1>b.length)&&h){var u=Object.assign(new wh.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.z9k(b,u.ControlList);
h.push(u)}}z9k(b,h){const u=Object.assign(new ee.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Rk.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,u);h=Object.assign(new wh.a,{Title:"",ControlList:[]});Array.add(u.Menu.MenuSectionList,h);this.vbl(b,h.ControlList)}vbl(b,h){for(let u=0;u<b.length;u++){const B=Object.assign(new So,{ExternalId:String.format("CoauthorPersona_{0}",u),
Command:"336231556",DisplayName:b[u].userName,LabelText:b[u].userName,ImageBackColor:b[u].color,PersonaId:b[u].email,IsAnonymous:b[u].isAnonymous});Array.add(h,B)}}}Object(m.a)(Sm,"PresenceContextMenuSectionBuilder",null,[653]);var Aa=c(99);class Ab{constructor(b,h,u,B){this.CAa=this.tt=this.Ao=this.Yh=this.$Ja=null;this.swd=b;this.bik=B;this.swd.XUc&&(this.Ao=new bf.a(3,2,5E3,Object(z.a)(this,this.HGk,"authenticationCheckTask"),2),v.AFrameworkApplication.oc.Xb(this.Ao),this.Tb(h,u));this.swd.Ouk(()=>
{this.LLb()});this.swd.Poh(()=>{this.MLb()})}get NK(){return this.tt||(this.tt=Ga.a.instance.Oa("CommonUI.IBusinessBar"))}get gyh(){return this.CAa||(this.CAa=Ga.a.instance.Oa("CommonUI.IBusinessBarEntryFactory"))}Tb(b,h){const u=v.AFrameworkApplication.va;u.fb(Za.a.avh,Ad.a.frame,b,96);u.fb(Za.a.bvh,Ad.a.frame,h,96);u.ra(Za.a.qAh,Ad.a.frame,dd.ActionManager.cR);u.ra(Za.a.rAh,Ad.a.frame,dd.ActionManager.cR);u.ra(Za.a.cJf,Ad.a.frame,dd.ActionManager.cR)}LLb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
v.AFrameworkApplication.va.processAction(Za.a.avh,2)}MLb(){this.YFo();v.AFrameworkApplication.va.processAction(Za.a.bvh,2)}HGk(){this.swd.authenticationCheck()}YFo(){this.Yh&&(this.Yh.hide(),this.Yh.dispose(),this.Yh=null);this.$Ja&&this.NK&&(v.AFrameworkApplication.Lk||this.NK.removeEntry(this.$Ja),this.$Ja.dispose(),this.$Ja=null)}showDialog(b){Aa.a.gC(this.Yh);this.Yh=new mg.StandardDialog;this.bik||(this.Yh.Ht=!1,this.Yh.Cd=0);this.Yh.xe(1,CommonUIStrings.l_SignIn);this.Yh.uV(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.Vba,"dialogHandler"))}Vba(b){1===b?(sf.a.P9d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),v.AFrameworkApplication.va.processAction(Za.a.cJf,2)):(this.bto(),v.AFrameworkApplication.va.processAction(Za.a.rAh,2))}bto(){this.NK&&this.gyh&&(this.$Ja=this.gyh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.$Ja.closeable=!0,this.$Ja.addButton(CommonUIStrings.l_SignIn,Ab.gfb,""),this.$Ja.xga=
Object(z.a)(this,this.RNk,"businessBarEntryCloseHandler"),this.NK.qA(this.$Ja,!1))}RNk(){this.Iml();v.AFrameworkApplication.va.processAction(Za.a.qAh,2)}Iml(){this.Ao&&(v.AFrameworkApplication.oc.Ze(this.Ao),this.Ao=null)}dispose(){this.Ao=this.Yh=this.$Ja=null}static gfb(){sf.a.P9d();v.AFrameworkApplication.va.processAction(Za.a.cJf,2)}}Object(m.a)(Ab,"SignOutResponseUI",null,[10]);class nc{get name(){return"Common.App.UI"}wc(b){b.register(Sm,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){Aa.a.gC(nc.Qta);
nc.Qta=null}static main(){M.a.instance.Gc(new nc)}static xxm(b,h,u){nc.Oso()&&(nc.Qta=new Ab(sf.a.instance,b,h,u))}static Oso(){return v.AFrameworkApplication.P4d&&!v.AFrameworkApplication.aia}}nc.Qta=null;Object(m.a)(nc,"CommonAppUIPackage",null,[1,2]);class Kc{get name(){return"Common.App.DialogWithLinkToResource"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new Kc)}}Object(m.a)(Kc,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var hd=c(67);class Rd{constructor(b){this.vy=b;this.jy=
Array.indexOf(this.vy,this.kha)}dispose(){this.vy=null}get Z3(){return this.vy[this.jy]}Zy(b){this.s8c(b,!1);return!0}j8b(b){this.s8c(b,!0)}s8c(b,h){b&&(this.Z3!==b||h)&&(b.tabIndex=0,hd.FocusManager.fK(b));Array.contains(this.vy,b)&&(this.jy=Array.indexOf(this.vy,b))}get h2i(){let b=this.jy;do if(b)if(0<b&&b<this.vy.length)b--;else break;else b=this.vy.length-1;while(!te.DOMFocusListing.a1a(this.vy[b])&&b!==this.jy);return this.vy[b]}get IPi(){let b=this.jy;do if(b===this.vy.length-1)b=0;else if(0<=
b&&b<this.vy.length-1)b++;else break;while(!te.DOMFocusListing.a1a(this.vy[b])&&b!==this.jy);return this.vy[b]}get kha(){let b=0;for(;!te.DOMFocusListing.a1a(this.vy[b])&&b<this.vy.length;)b++;return te.DOMFocusListing.a1a(this.vy[b])?this.vy[b]:null}get dec(){let b=this.vy.length-1;for(;!te.DOMFocusListing.a1a(this.vy[b])&&0<b;)b--;return te.DOMFocusListing.a1a(this.vy[b])?this.vy[b]:null}}Object(m.a)(Rd,"DialogFocusListing",null,[172]);var kc=c(56);class ff extends mg.StandardDialog{constructor(b,
h,u,B=null){super();this.Bfa=this.Nw=this.Cab=null;this.vy=[];this.Hsd=h;this.qk=b;this.U3j=u;this.Gvd=B;this.jm=new Ug.a("LoadResource","LoadPrintablePdf")}oEa(){this.Cd=5;this.width=40;const b=document.createElement("span");b.id=this.mj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Bfa=document.createElement("iframe");this.Bfa.name="pdfObjectFrame";this.Bfa.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Bfa.onload=Object(z.a)(this,this.jFn,"printablePdfLoaded");if(this.Gvd&&0<this.Gvd.count){var u=fa.a.$rf(this.Hsd,this.Gvd);const B=fa.a.Q6f(this.Hsd,this.Gvd);this.Nw=document.createElement("form");this.Nw.id="printPreviewPostForm";this.Nw.method="POST";this.Nw.target=this.Bfa.name;this.Nw.action=B;for(let Q of u)u=document.createElement("input"),u.type="hidden",u.name=Q.key,u.value=Q.value,this.Nw.appendChild(u)}else this.Bfa.setAttribute("src",this.Hsd);
Sys.UI.DomElement.addCssClass(this.Bfa,em.a.v7g);this.U3j?(Sys.UI.DomElement.addCssClass(this.Bfa,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,af.a.ir(this.Bfa,af.a.sA,af.a.pp)):(Sys.UI.DomElement.addCssClass(this.Bfa,"DirectPrintPdfObject"),this.vy.push(this.Bfa));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Bfa);this.Nw&&b.appendChild(this.Nw);b.appendChild(document.createElement("br"));b.appendChild(this.I2k(this.Nw?
"#":this.Hsd));this.jm.start();this.pmb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.C5(this.mj("DirectPrintHeaderContent"));this.Nw&&this.Nw.submit();this.A9k();r.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}I2k(b){const h=document.createElement("span");var u=document.createElement("span");u.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(u);v.AFrameworkApplication.K&&(2===v.AFrameworkApplication.ua.Lb.Nk&&v.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===v.AFrameworkApplication.ua.Lb.Nk&&v.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===v.AFrameworkApplication.ua.Lb.Nk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.ua.Lb.Nk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,r.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Cab=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(u=
document.createElement("a"),u.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,u.href=b,u.target="_blank",u.id="PrintPDFLink",u.className="AllowBrowserClick",this.Cab=u,h.appendChild(document.createElement("br")),h.appendChild(u),this.Nw&&Me.a.addHandler(u,"click",Object(z.a)(this,this.isn,"onSubmit")),this.qk.ob(Kd.a.click,this.Cab,Object(z.a)(this,this.GTh,"downloadPDFLinkClicked"),null));this.vy.push(this.Cab);return h}isn(b){this.Nw&&(this.Nw.target="_blank",this.Nw.submit());b.preventDefault()}A9k(){if(0<
this.vy.length){const b=new Rd(this.vy),h=hd.FocusManager.instance().Ys();h&&(this.Cab.focus(),h.ak=b,h.xP=!0)}}GTh(){r.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}HZc(){r.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}jFn(){r.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.jm&&this.jm.stop()}dispose(){this.Cab&&(this.qk.sc(Kd.a.click,this.Cab,Object(z.a)(this,this.GTh,"downloadPDFLinkClicked")),
this.Cab=null);kc.a.ox(this.Bfa);this.Bfa=null;super.dispose()}}Object(m.a)(ff,"DirectPrintDialog",mg.StandardDialog,[695]);class bd{constructor(b){this.qk=b}LTl(b,h,u=null){return new ff(this.qk,b,h,u)}}Object(m.a)(bd,"DirectPrintDialogFactory",null,[680]);class Sf{constructor(b,h){this._url=b;this.Xbk=h}rSh(){this.Xbk?Qd.a.downloadFile(this._url):Qd.a.om(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(m.a)(Sf,"OpenUrlInTabDialogDownloadBehavior",null,
[703,10]);class Te extends mg.StandardDialog{constructor(b,h=!0,u=!1,B=null,Q=null,ca=!1,qa=null){super();this.LWb=this.KWb=this.Nw=this.d3=null;var Qa=this.glg?this.glg:CommonUIStrings.l_DefaultDialogTitle;Te.gac=ca;this.AWj=qa;this.Lye=B||new Sf(b,!0);const rb=[],Lb=[];Te.NL&&(this.xBd&&this.xBd.forEach(gc=>{Array.add(rb,gc)}),this.qqh&&this.qqh.forEach(gc=>{Array.add(Lb,gc)}));h?u?this.LYd?(this.Cd=12,this.xe(1,this.buttonText),this.xe(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.xe(3,
CommonUIStrings.l_DialogClose)):this.KYd?(this.Cd=12,this.xe(1,this.buttonText),this.xe(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.xe(3,CommonUIStrings.l_DialogClose)):this.WYd?(this.Cd=12,this.xe(1,this.buttonText),this.xe(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.xe(3,CommonUIStrings.l_DialogClose)):(this.Cd=4,this.xe(1,this.buttonText),this.xe(2,CommonUIStrings.l_DialogClose)):(this.Cd=6,this.xe(0,CommonUIStrings.l_DialogClose)):this.Cd=5;ca=document.createElement("span");
this.iKc&&(ca.className=this.iKc);B=document.createElement("a");B.innerText=this.sec;B.href=b;B.target="_blank";B.id=this.lZc;B.className=$d.AFrame.h0e;if(qa=!Z.a.E4&&!!Q&&0<Q.count){const gc=fa.a.$rf(b,Q);Q=fa.a.Q6f(b,Q);B.href="#";B.target="_self";this.Nw=document.createElement("form");this.Nw.id="printPreviewPostForm1";this.Nw.method="post";this.Nw.target="_blank";this.Nw.action=Q;for(var Yb of gc)Q=document.createElement("input"),Q.type="hidden",Q.name=Yb.key,Q.value=Yb.value,this.Nw.appendChild(Q)}else this.Nw=
null;this.Nw||Te.gac?Te.gac||Array.add(Lb,{["type"]:"AppLinkProps",["id"]:this.lZc,["text"]:this.sec,["onExecute"]:()=>{this.G5i()}}):Array.add(Lb,{["type"]:"AppLinkProps",["id"]:this.lZc,["text"]:this.sec,["handler"]:{["href"]:qa?"#":b,["target"]:qa?"_self":"_blank"}});this.l5a&&Array.add(rb,this.l5a);u?(b=document.createElement("span"),b.innerText=this.l5a.replace("{0}",""),ca.appendChild(b)):this.nNi?(b=document.createElement("span"),b.id=this.mj("message"),Yb=document.createElement("span"),Q=
document.createElement("span"),qa=this.l5a.split("{0}"),Yb.innerText=qa[0],Q.innerText=qa[1],b.appendChild(Yb),b.appendChild(B),b.appendChild(Q),ca.appendChild(b)):(b=document.createElement("span"),b.innerText=this.l5a,ca.appendChild(b),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(B),Te.gac||Array.add(rb,"{0}"));this.Nw&&ca.appendChild(this.Nw);Te.NL&&(this.Klb&&(this.SYc?this.anh(this.Klb,this.SYc):(Array.add(rb,"{0}"),Array.add(Lb,{["type"]:"AppLinkProps",
["id"]:"LearnMoreLinkId",["text"]:this.Klb,["onExecute"]:()=>{}}))),this.XEc(rb,Lb));this.pmb(Qa,null,this.Uyf,null,Object(z.a)(this,this.Vba,"dialogHandler"),Te.NL?null:ca);this.C5(this.mj("message"));!Te.NL&&this.SYc&&this.Klb&&(Qa=document.createElement("div"),Qa.className="WACDialogLearnMoreLinkContainer",this.d3=document.createElement("a"),this.d3.innerText=this.Klb,this.d3.href=this.SYc,this.d3.target="_blank",this.d3.id=this.mj("LearnMoreLinkId"),this.d3.className=$d.AFrame.h0e,Qa.appendChild(this.d3),
h?this.Jc.insertBefore(Qa,this.Jc.lastChild):this.Jc.appendChild(Qa),this.C5(String.format("{0} {1}",this.mj("message"),this.mj("LearnMoreLinkId"))));this.Ntc=B;u?this.u1(this.gH):this.u1(this.Ntc);this.q2d();v.AFrameworkApplication.ua.M1.ob(Kd.a.click,this.Ntc,Object(z.a)(this,this.FTh,"downloadLinkClicked"),null);this.d3&&v.AFrameworkApplication.ua.M1.ob(Kd.a.click,this.d3,Object(z.a)(this,this.kFi,"learnMoreLinkClicked"),null);this.eW=!1}get Uyf(){return null}get glg(){return null}get l5a(){return null}get l5e(){return this.AWj}get SYc(){return null}get Klb(){return null}get nNi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get iKc(){return null}get xBd(){return null}get qqh(){return null}get LYd(){return!1}get KYd(){return!1}get WYd(){return!1}QIh(){this.K8({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}ysl(){this.K8({SourceControlId:"Share"},{ControlId:"Share"})}K8(b,h){const u=v.AFrameworkApplication.va;u.KC=8;u.Rb(Za.a.K8,2,b,h)}Pma(){this.Nw&&(this.KWb||(this.KWb=Object(z.a)(this,this.Ihn,"onActionButtonClicked"),this.Nq.ob(Kd.a.click,this.gH,this.KWb)),this.LWb||(this.LWb=Object(z.a)(this,this.Jhn,"onActionButtonKeyUp"),this.ee.ob(Kd.a.sh,this.gH,this.LWb)));super.Pma()}Ihn(b){this.jXh(b);return!0}Jhn(b){return this.oYc(b,Object(z.a)(this,this.jXh,"executeDismissActionButtonFromArgs"))}jXh(b){this.Nw&&
this.Nw.submit();this.bEb(b.uf)}HZc(){}FTh(){this.ILf();this.Nw?this.Nw.submit():this.Lye.rSh();return!0}kFi(){return!1}dispose(){this.Lye.dispose();this.Ntc&&(v.AFrameworkApplication.ua.M1.sc(Kd.a.click,this.Ntc,Object(z.a)(this,this.FTh,"downloadLinkClicked")),this.Ntc=null);this.d3&&(v.AFrameworkApplication.ua.M1.sc(Kd.a.click,this.d3,Object(z.a)(this,this.kFi,"learnMoreLinkClicked")),this.d3=null);this.Nq&&this.KWb&&(this.Nq.sc(Kd.a.click,this.gH,this.KWb),this.KWb=null);this.ee&&this.LWb&&(this.ee.sc(Kd.a.sh,
this.gH,this.LWb),this.LWb=null);super.dispose()}G5i(){this.Nw&&(document.body.appendChild(this.Nw),this.Nw.submit(),document.body.removeChild(this.Nw))}Vba(b){1===b?(this.HZc(),this.Nw?Te.NL&&this.G5i():this.Lye.rSh()):2===b&&(this.KYd||this.LYd?this.QIh():this.WYd&&this.ysl());this.dispose()}static get NL(){return v.AFrameworkApplication.ua.Lb.pF&&v.AFrameworkApplication.ua.Lb.oAi}static get gac(){return Te.iXg}static set gac(b){Te.iXg=b}}Te.iXg=!1;Object(m.a)(Te,"ADialogWithLinkToResource",mg.StandardDialog,
[]);class bi extends Te{constructor(b,h,u=null,B=!0,Q=!1,ca=null){super(b,!0,!(bi.trb&&B),new Sf(b,h),u,Q,ca);bi.trb=bi.trb&&B;if(bi.trb){h=document.createElement("iframe");B=null;Q=this.PQh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(u&&0<u.count){ca=fa.a.$rf(b,u);b=fa.a.Q6f(b,u);B=document.createElement("form");B.id="printPreviewPostForm";B.method="POST";B.target=h.name;B.action=b;for(let qa of ca)b=document.createElement("input"),b.type="hidden",b.name=qa.key,b.value=qa.value,B.appendChild(b)}else h.src=
b;Q.appendChild(h);B&&(Q.appendChild(B),B.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");af.a.ir(h,af.a.sA,af.a.pp)}}get Uyf(){return"Print_32x32x32"}get glg(){return bi.trb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get l5a(){return bi.trb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get xBd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Te.gac){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.ua.Lb.QNh&&
(h=v.AFrameworkApplication.ua.Lb.QNh);Array.add(b,h)}return bi.trb?b:null}get sec(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get lZc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get iKc(){return v.AFrameworkApplication.L0a?"UIFontDialogTextLarge":null}q2d(){r.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}ILf(){v.AFrameworkApplication.Ql.h3a(9540);r.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}HZc(){r.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")}static get trb(){return!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pF&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Z.a.E4||Z.a.Kt||Z.a.lj||Z.a.Xca)&&!v.AFrameworkApplication.SXc&&v.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set trb(b){}}Object(m.a)(bi,"PrintDialogWithLinkToPdf",Te,[]);class Si{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");
this.nQm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.PMm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.XQb=(b.DirectPrintSupportedMimeTypes||"").split(Si.lef);this.oqb=(b.DirectPrintSupportedPlugins||"").split(Si.lef);this.Avm=(b.DirectPrintImmersivePreviewPlugins||"").split(Si.lef);this.Wvi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.YGm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.IVk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||
"76");this.yOf=14;this.ANi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.yOf=parseInt(h[0]),this.ANi=parseInt(h[1])):r.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else r.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Si.lef=",";Object(m.a)(Si,"DirectPrintBrsSettings",null,[]);class li{constructor(b,h){this.Mig=
b;this.oqb=h}}Object(m.a)(li,"DirectPrintProbeResults",null,[]);class yi{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.jzd=null;this.a_j=b;this.Zyc=h;this.oKe=u;this.z6j=B;this.F7j=Q;this.QAc=new hg.a(Object(z.a)(this,this.Z8l,"getProbeResults"));this.qtc=ca;this.M3g=rb;this.rT=qa;this.bxc=Qa;this.$7j=Lb}get bR(){return this.a_j}start(){}GFn(){this.bR.nQm&&this.D4m()}qKn(){const b=Array(this.bR.XQb.length);if(void 0!==this.Zyc&&null!==this.Zyc)for(let h=0;h<this.bR.XQb.length;h++)b[h]=this.bR.XQb[h]in
this.Zyc&&this.z6j(this.Zyc[this.bR.XQb[h]]);return b}rKn(){const b=Array(this.bR.oqb.length),h=!(void 0===this.oKe||null===this.oKe);for(let u=0;u<this.bR.oqb.length;u++){const B=this.bR.oqb[u];b[u]=h&&B in this.oKe?!0:this.F7j(B)}return b}Rdm(){const b=this.qKn(),h=Array(b.length);for(let u=0;u<b.length;u++)h[u]=b[u]?this.Eyl(this.Zyc[this.bR.XQb[u]]):null;return h}Eyl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}D4m(){r.ULS.sendTraceTag(4535643,
328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.QAc.value.Mig,this.QAc.value.oqb)}Z8l(){var b=this.Rdm();const h=this.rKn(),u={},B={};for(let Q=0;Q<this.bR.XQb.length;Q++)u[this.bR.XQb[Q]]=b[Q];for(b=0;b<this.bR.oqb.length;b++)B[this.bR.oqb[b]]=h[b];return new li(u,B)}Gso(){return this.$7j||!this.bR.isEnabled||v.AFrameworkApplication.SXc?!1:this.UCo()}Mso(){if(null!=this.jzd)return this.jzd;const b=yi.Vvi(this.bR);return this.jzd=this.bR.Wvi&&b||this.XGm()}XGm(){return Z.a.Cr&&this.bR.YGm&&Z.a.HVk>=
this.bR.IVk?!0:!1}UCo(){if(!this.bxc(this.bR))return!1;var b=mb.a.LGb(this.QAc.value.Mig);for(const h of b)if(void 0!==h&&null!==h)return!0;b=mb.a.LGb(this.QAc.value.oqb);for(const h of b)if(h)return!0;return!1}Xpm(){const b=mb.a.LGb(this.QAc.value.Mig);for(const h of b)if(Cl.a.contains(this.bR.Avm,h))return!0;return!1}cvo(b,h=null){v.AFrameworkApplication.ua&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.M3g(b,h):this.Gso()?this.Onl(b,this.Xpm()&&!0,h):this.M3g(b,
h)}Onl(b,h,u=null){const B=this.rT.Vf("UserAction","OpenDirectPrintDialog");this.qtc.LTl(b,h,u).oEa();B.stop()}static $Sm(b){try{return new ActiveXObject(b),!0}catch(h){r.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static RJm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new Si(v.AFrameworkApplication.K.appSettings);let u=null;try{u=window.navigator.mimeTypes}catch(Lb){r.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(Lb){r.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Q=yi.RJm,ca=yi.$Sm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const qa=v.AFrameworkApplication.ua.Iq,Qa=yi.aTm,rb=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pF&&!v.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new yi(h,u,B,Q,ca,b,qa,Qa,(Lb,Yb)=>new bi(Lb,!1,
Yb,!0,rb),v.AFrameworkApplication.aia)}static aTm(b){return Z.a.Cr||Z.a.Kt&&b.PMm||b.Wvi&&yi.Vvi(b)?!0:!1}static Vvi(b){var h=Z.a.O6b;if(h){var u=h.split(".");if(2===u.length)return h=parseInt(u[0]),u=parseInt(u[1]),h>b.yOf||h===b.yOf&&u>=b.ANi}return!1}}Object(m.a)(yi,"DirectPrintManager",null,[651]);class lm{constructor(){this.Ntb=this.W=null}get name(){return"Common.App.DirectPrint"}wc(b){this.W=b;b.register(bd,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().Sd(()=>new bd(v.AFrameworkApplication.ua.M1));
b.register(651,"Common.App.DirectPrint.IDirectPrintManager").ha().Sd(()=>yi.create(this.W))}init(){this.Ntb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Ntb.start()}dispose(){}}Object(m.a)(lm,"PackageManager",null,[1,2]);class bh{constructor(b,h=3E4){this.xlg=9E5;this.zlg=1E4;this.DKi=this.Sec=null;this.RMf=0;this.tgb=Date.now;this.Vfm=b;this.v8a=h;this.lPd()}Qhi(b=!0){const h=this.tgb();if(h<this.RMf+this.xlg)return h>this.RMf+this.zlg&&this.lPd(),this.DKi;b&&this.lPd();return null}getToken(b=
!0){return(b=this.Qhi(b))?Promise.resolve(b):this.lPd()}lPd(){return this.Sec=this.Sec||new Promise(b=>{this.Vfm().then(h=>{this.Sec=null;""!==h&&h&&(this.DKi=h,this.RMf=this.tgb(),b(h));b(null)}).catch(()=>{this.Sec=null;b(null)});window.setTimeout(()=>{this.Sec=null;b(null)},this.v8a)})}}Object(m.a)(bh,"OAuthCacheManager",null,[]);var ol=c(112),zi=c(290);class fk{constructor(){this.F9=null;this.JSg={};this.gnc=new Oa.a(Ra.a.jh())}getToken(b,h){if(this.gnc.nb(h))return this.gnc.J(h).getToken();const u=
new bh(()=>this.Rhi(b,h));this.gnc.Z(h,u);return u.getToken()}Ufm(b,h){if(this.gnc.nb(h))return this.gnc.J(h).Qhi();const u=new bh(()=>this.Rhi(b,h));this.gnc.Z(h,u);return null}Rhi(b,h){if(!this.F9)try{this.F9=Ga.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(u){r.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+u)}return this.F9?new Promise(u=>{const B=Date.now();this.F9.EV(b,h).then(Q=>{const ca=Q.Token;!Q.IsSuccess||this.ZTm(ca)?(this.Vjc("GetTokenInternalImplicitJS",
!1,Date.now()-B,b,Q.ErrorCode,Q.ErrorMessage,h),u(null)):(this.Vjc("GetTokenInternalImplicitJS",!0,Date.now()-B,b,Q.ErrorCode,Q.ErrorMessage,h),u(ca))}).catch(Q=>{Q=Q?G.c(Q):"";this.Vjc("GetTokenInternalImplicitJS",!1,Date.now()-B,b,"Caught Exception",Q,h);u(null)})}):new Promise(u=>{this.Vjc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");u(null)})}Vjc(b,h,u,B,Q="",ca="",qa=""){var Qa="Search"===B;const rb=[];b=ol.a.S8(Qa?"Event":"EventName",b,2);B=ol.a.S8("AppName",
B,2);Array.add(rb,b);Array.add(rb,B);Qa&&(B=ol.a.S8("LatencyType","FetchToken",2),Array.add(rb,B));Q&&""!==Q&&(Q=ol.a.S8("ErrorCode",Q,2),Array.add(rb,Q));ca&&""!==ca&&(ca=ol.a.S8("ErrorMessage",ca,2),Array.add(rb,ca));qa&&""!==qa&&(ca=!(qa in this.JSg),this.JSg[qa]=ca,ca=ol.a.S8("WarmUpCall",ca.toString(),1),Array.add(rb,ca),qa=ol.a.S8("Service",this.Rbm(qa),2),Array.add(rb,qa));Qa=Qa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new zi.a,{name:Qa,
samplingPolicy:2,dataFields:rb,succeeded:h,durationMs:u});ea.a.sendActivityEvent(h)}Rbm(b){return b===v.AFrameworkApplication.CMf?"Loki":b===v.AFrameworkApplication.Eig?"Substrate":v.AFrameworkApplication.K&&b===v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}ZTm(b){return!b||!b.length}}Object(m.a)(fk,"SearchOAuthManager",null,[619]);class eh{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}wc(b){this.W=b;this.W.register(619,"Common.App.SearchCommon.ISearchOAuthManager").ha().Sd(()=>
new fk)}init(){}dispose(){}static main(){M.a.instance.Gc(new eh)}}Object(m.a)(eh,"SearchOAuthPackage",null,[1,2]);var Ck=c(224),vd=c(5),Dd=c(18),Ge=c(17),me=c(8);class Kj{constructor(b,h,u){this.fLe=this.gyb=this.cLe=this.fyb=this.THe=null;this.tmm=B=>{try{this.smm(B)}catch(Q){B=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",Q.message,Q.stack),r.ULS.sendTraceTag(5285580,334,10,B)}};this.Zp=b;this.O_j=h;this.ib=u;this.init()}init(){this.O_j.ob(this.tmm);
this.fyb=new Jh.a;this.cLe=new Jh.a;this.gyb=new Jh.a;this.fLe=new Ck.a}t5(b){this.fyb.add(b.key,b)}Bic(b){this.gyb.add(b.key,b)}smm(b){let h;const u=this.ib.hb.lb;({Tbf:h}=Kj.ZMo(u)).returnValue&&(b=Kj.mRl(b,this.THe,h),this.ZFn(b,h,u),this.THe=h)}ZFn(b,h,u){b=this.PKl(b,h,u);let B;({notification:B}=Kj.PMo(b)).returnValue&&this.Zp.sendNotification(B,!1)}PKl(b,h,u){const B=new Jh.a;B.Z(1,new Ck.a);B.Z(0,new Ck.a);b.forEach(Q=>{3===Q?(Kj.Ueg(h.node)||this.n3n(h,u),this.L6l(B,h)):Q||this.KRl(B,h);return!0});
return B}n3n(b,h){this.fyb.forEach((u,B)=>{B.reset(b,h);return!0})}KRl(b,h){let u=new Jh.a;Kj.Ueg(h.node)||(u=this.IRl(h.cpBegin));this.JRl(b,this.cLe,u,Kj.dhj(this.THe,h));this.cLe=u}IRl(b){const h=new Jh.a;this.fyb.forEach((u,B)=>{u=null;({aG:u}=B.gJa(b)).returnValue&&h.Z(B.key,u);return!0});return h}JRl(b,h,u,B){const Q=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ca,qa)=>{const Qa=this.fyb.J(ca).Xw||qa.title;let rb;({value:rb}=u.Fc(ca)).returnValue?B&&rb.contentObject!==qa.contentObject&&
(Qa&&b.J(1).add(Qa),ca=this.fyb.J(ca).Xw,ca=String.format(Q,rb.title,ca),rb.description&&(ca+=", "+rb.description),b.J(0).add(ca)):Qa&&b.J(1).add(Qa);return!0});u.forEach((ca,qa)=>{h.nb(ca)||(ca=this.fyb.J(ca).Xw,ca=String.format(Q,qa.title,ca),qa.description&&(ca+=", "+qa.description),b.J(0).add(ca));return!0})}L6l(b,h){h=this.jdm(h.node);h=this.sZk(h);this.kdm(b,this.fLe,h);this.fLe=h}jdm(b){const h=new vd.GraphIterator;h.set(b);if(!h.zb(1))return null;const u=new Ck.a;for(;1!==h.Ue;)this.gyb.forEach((B,
Q)=>{let ca;({nna:ca}=Q.Hnc(h)).returnValue&&u.add(ca);return!0}),h.rc();u.reverse();return u}sZk(b){b=b.toArray();let h=0;for(;h<b.length-1;){var u=b[h];if(u.TG===b[h+1].TG&&(this.gyb.J(u.TG),({vZk:u}={returnValue:!1,vZk:null}).returnValue)){b.splice(h,2,u);continue}h++}return new Ck.a(b)}kdm(b,h,u){var B;for(B=0;B<Math.min(u.length,h.length)&&u.J(B).contentId.equals(h.J(B).contentId);B++){var Q=this.gyb.J(u.J(B).TG).sFb(u.J(B),h.J(B));Q&&(u.J(B).description&&(Q+=", "+u.J(B).description),b.J(0).add(Q))}for(Q=
B;Q<u.length;Q++){let ca=this.gyb.J(u.J(Q).TG).sFb(u.J(Q),null);ca&&(u.J(Q).description&&(ca+=", "+u.J(Q).description),b.J(0).add(ca))}for(u=B;u<h.length;u++)(B=this.gyb.J(h.J(u).TG).Xw)&&b.J(1).add(B)}static mRl(b,h,u){const B=new Ck.a;(b=b||Kj.Fao(h,u))?(B.add(3),B.add(0)):Kj.dhj(h,u)&&B.add(0);return B}static Fao(b,h){return!b||!b.node.id.equals(h.node.id)}static dhj(b,h){return!b||!b.equals(h)}static ZMo(b){let h=null;if(!b||!(Ge.SelectionEditor.Il(b)||(b=Ge.SelectionEditor.Fj(b,!0,!1),Ge.SelectionEditor.Il(b)||
b.Pa&&Kj.Ueg(b.Pa.node))))return{returnValue:!1,Tbf:h};h=b.Pa;return{returnValue:!!h,Tbf:h}}static PMo(b){const h=new Ck.a;b.J(1).forEach(u=>{u=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,u);h.add(u);return!0});b.J(0).forEach(u=>{u=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,u);h.add(u);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static Ueg(b){return Dd.ImageReader.Jt(b)||me.ParagraphReader.jva(b)}}Object(m.a)(Kj,
"AccessibilityContextManager",null,[618]);class Sl{constructor(b,h){this.$0g=!1;this.aCc=null;this.Dvd=this.$yd=!1;this.fSg=null;this.DBd=(u,B)=>{(B.DN||B.$qa)&&this.bgn(B.DN,B.$qa)};this.Ib=b;this.NN=h}get Nqm(){return!!this.aCc}ob(b){this.$0g||(this.NN.gph(this.DBd),this.$0g=!0);this.fSg=b}bgn(b,h){this.Nqm&&this.Ib.Ze(this.aCc);this.$yd=this.$yd||b;this.Dvd=this.Dvd||h;this.aCc=new bf.a(5,1,Sl.Bwl,()=>{this.fSg(this.$yd,this.Dvd);this.reset()},126);this.Ib.Xb(this.aCc)}reset(){this.aCc=null;this.Dvd=
this.$yd=!1}}Sl.Bwl=100;Object(m.a)(Sl,"EditingViewOnAfterValidateEventsConsolidator",null,[617]);var xf=c(48);class Fl{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Fb.App.huh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}wc(b){this.W=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new Sl(v.AFrameworkApplication.oc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();
b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new Kj(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),xf.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){M.a.instance.Gc(new Fl)}}Object(m.a)(Fl,"Box4AccessibilityPackage",null,[1,2]);var Wh=c(190),we=c(1068),bo=c(1652),tf=c(898),Gj=c(170),th=c(1538),Qg=c(43),Cg=c(23),ok=c(100),Je=c(26),Ob=c(3);class Ah extends th.a{get kxa(){return null!=
this.BBg?this.BBg:this.BBg=Ga.a.instance.Oa("Box4.IInternalLinkManager")}get k1i(){return null!=this.CEg?this.CEg:this.CEg=Ga.a.instance.Oa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get bD(){return!0}get commandId(){return Ob.a.QGk}Jna(b){Gj.a.mark(7012);const h=new Qg.GraphTransaction(15);h.Db(b);var u=this.NG,B=this.T0,Q=me.ParagraphReader.text(b),ca=Q.substring(u,B);const qa=({s0c:Qa}=F.a.iig(ca)).returnValue;ca!==qa&&(u+=Qa,B=u+qa.length);ca=Je.a.createTextRange(b,u,B);var Qa=Q.substring(u,
B);Ah.IMm(Q,u,B)&&(this.Ld.Ge(Je.a.createTextRange(b,u-1,B+1),Qa,!0,!1),--u,--B,ca=Je.a.createTextRange(b,u,B),u=Cg.SelectionFactory.ne(b,B),xf.a.instance.Bc(u));u=ok.a.PPa(Qa);Ah.Sp.qG(ca,u,!1);Q=Qa="";B=!1;this.kxa&&({d6f:Qa,SEb:Q}=this.kxa.rmg(u)).returnValue&&(u=Qa,B=!0,Qa=ok.a.EA(ca,!1),Ah.Sp.fS(Qa[0].paragraph,Qa[0].hyperlink),""!==Q&&(this.Ld.Ge(ca,Q,!0,!1),ca=Je.a.createTextRange(b,this.NG,this.NG+Q.length),b=Cg.SelectionFactory.ne(b,this.NG+this.NG+Q.length),xf.a.instance.Bc(b)),Ah.Sp.qG(ca,
u,!1));h.dispose();!B&&this.k1i&&this.k1i.OCn(ca,u);Gj.a.mark(7013)}set bD(b){super.bD=b}static get Sp(){return null!=Ah.Czg?Ah.Czg:Ah.Czg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static IMm(b,h,u){u=u!==b.length&&('"'===b.charAt(u)||"\u201d"===b.charAt(u));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&u}}Object(m.a)(Ah,"HyperlinkAction",th.a,[]);class Mq{constructor(b){this.Ld=b}e$k(b,h,u){return new Ah(null,b,h,u,this.Ld)}}Object(m.a)(Mq,"HyperlinkActionFactory",null,[614]);
var ti=c(236);class Wj{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}wc(b){this.W=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new bo.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),ti.a.instance,v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>
new we.a(b.resolve("Box4.IRoamingServiceRequestManager"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new tf.a(b.resolve("Box4.IAutoCorrectRules"),xf.a.instance,Wh.a.instance,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();
b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Mq(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.W.resolve("Box4.IAutoCorrectRules").N_m();const b=v.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").xMl()}dispose(){}static main(){M.a.instance.Gc(new Wj)}}Object(m.a)(Wj,"Box4AutoCorrectPackage",null,[1,2]);class Hj{get name(){return"Box4.Clipboard"}init(){}dispose(){}wc(){}static main(){M.a.instance.Gc(new Hj)}}
Object(m.a)(Hj,"Box4ClipboardPackage",null,[1,2]);class dp{get name(){return"Box4.ImageEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new dp)}}Object(m.a)(dp,"Box4ImageEditorsPackage",null,[1,2]);var Gp=c(620),To=c(880),Vk=c(716),hq=c(832),fm=c(1155);class Cq{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,u,B,Q){const ca=new Cq;ca.DocumentId=Q;ca.UserId=u;ca.WACSessionId=B;ca.Revision=b;ca.ChangeStateList=fm.a.$hj(h);return ca}}Object(m.a)(Cq,"LocalUnsavedChange",
null,[]);class wm{constructor(){this.b2d=null}rne(b){return new Promise((h,u)=>{this.fKh().then(B=>{const Q=B.transaction(wm.CZc,"readwrite");Q.objectStore(wm.CZc).put(b);Q.oncomplete=()=>h();Q.onerror=()=>u(Q.error.message)}).catch(u)})}qFd(b,h,u){return new Promise((B,Q)=>{this.fKh().then(ca=>{const qa=ca.transaction(wm.CZc,"readwrite");qa.objectStore(wm.CZc).delete([b,h,u]);qa.oncomplete=()=>B();qa.onerror=()=>Q(qa.error.message)}).catch(Q)})}static isSupported(){return"indexedDB"in window}fKh(){return new Promise((b,
h)=>{if(wm.isSupported())if(this.b2d)b(this.b2d);else{var u=window.indexedDB.open(wm.U0m,wm.V0m);u.onsuccess=()=>{this.b2d=u.result;b(u.result)};u.onerror=()=>{h(u.error.message)};u.onupgradeneeded=()=>{const B=u.result,Q=B.createObjectStore(wm.CZc,{keyPath:["DocumentId","UserId","WACSessionId"]});Q.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});Q.createIndex("UserId",["UserId"],{unique:!1});this.b2d=B;b(B)}}else h("This browser does not support IndexedDB.")})}}wm.U0m="LocalUnsavedChangeDatabase";
wm.V0m=1;wm.CZc="LocalUnsavedChange";Object(m.a)(wm,"LocalUnsavedChangeStore",null,[]);class Xk{constructor(b,h,u,B,Q,ca){this.uIi=b;this.Vde=h;this.Wbi=u;this.dRd=B;this.gTk=Q;this.cza=ca}initialize(){const b=To.a.Msf(this.Wbi());this.WId=this.lKc=b;this.cza.Ewk(this.fWi.bind(this));this.cza.Fwk(this.gWi.bind(this))}dispose(){this.cza.m_n(this.fWi.bind(this));this.cza.n_n(this.gWi.bind(this))}fWi(b,h){this.SUo(h.BTa)}gWi(b,h){this.yRo(h.BTa)}yRo(b){b.equals(this.lKc)||(this.lKc=b,b.equals(this.WId)?
this.qFd():this.rne())}SUo(b){b.equals(this.WId)||(this.WId=b,b.equals(this.lKc)?this.qFd():this.rne())}X$k(){const b=new hq.a(this.WId,this.lKc,this.Wbi(),this.dRd().vr,this.dRd().xob,this.dRd().contextId,this.lKc.id,this.Vde,Vk.FolderReader.IIb(this.dRd()),!1);return Cq.construct(b,this.gTk.rPc(),Xk.userId,Xk.sessionId,Xk.documentId)}rne(){const b=this.X$k();this.uIi.rne(b).then(()=>{r.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>
{r.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}qFd(){this.uIi.qFd(Xk.documentId,Xk.userId,Xk.sessionId).then(()=>{r.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{r.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return wm.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Xk.Nwg?Xk.Nwg:
Xk.Nwg=v.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Xk.SHg?Xk.SHg:Xk.SHg=v.AFrameworkApplication.K.kb("LoggableUserId")}static get sessionId(){return null!=Xk.gFg?Xk.gFg:Xk.gFg=v.AFrameworkApplication.K.kb("SessionId")}}Object(m.a)(Xk,"LocalUnsavedChangeManager",null,[613]);class mo{get name(){return"Box4.LocalUnsavedChange"}init(){this.Fvi()&&Xk.isSupported()&&(this.sLf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.sLf.initialize())}dispose(){this.sLf&&
this.sLf.dispose()}wc(b){this.container=b;if(this.Fvi()){b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new wm).ha();var h=(u,B,Q)=>new Gp.a(u,B,Q);b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new Xk(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Fb.App.za.jb.Yc.vd,()=>Fb.App.za.jb.Yc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){M.a.instance.Gc(new mo)}Fvi(){return v.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}
Object(m.a)(mo,"LocalUnsavedChangePackage",null,[1,2]);class Dk{get name(){return"Box4.NotebookLevelEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new Dk)}}Object(m.a)(Dk,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Ei=c(1549);class tj{get name(){return"Box4.Search"}wc(b){b.ia("Box4.Search.FindManagerHelper",()=>Ei.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(m.a)(tj,"PackageManager",null,[1,2]);class qb{get name(){return"Box4.TableEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new qb)}}
Object(m.a)(qb,"Box4TableEditorsPackage",null,[1,2]);class Zb{get name(){return"Box4.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new Zb)}}Object(m.a)(Zb,"Box4TextLevelEditorsPackage",null,[1,2]);var ed=c(113),Od=c(354),$c=c(155),yf=c(616),Cf=c(1564);class hh{constructor(b,h,u){this.ew=this.SKa=this.aNa=null;this.rE=this.dxe=this.iKa=0;this.zla=this.bod=this.VWa=this.UWa=!1;this.Jmd=this.lYg=this.oYg=0;this.sBa=b;this.ga=h;this.fn=u}tP(b){return!Fb.App.za.jb.isEditingAllowed||
fc.SessionStatusManager.instance.Uj?!1:""!==this.SPc(b.uf)}wL(b){if(!this.tP(b))return!1;this.jho(b);this.rE=this.sBa.X8b();this.eko(b);this.fko();({lcc:this.bod,Gdc:this.zla}=this.olj(this.dxe));this.gko();this.aNa=b.hI;this.ew=new Sys.UI.Point(0,0);[this.oYg,this.lYg]=this.sBa.getDimensions();r.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}TU(b){this.SKa=b.hI;this.KOk();this.Jmd=Cf.b(this.ew.x,this.ew.y,this.oYg,this.lYg,this.bod,this.zla,this.Jmd,v.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));
this.sBa.Eog(this.Jmd,this.bod,this.zla);return!0}eE(){this.setSize();r.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}JY(){this.sBa.V8f();r.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}jho(b){this.sBa=ed.a.Eb(b.uf,yf.a)}fko(){this.dxe=(Math.floor((this.rE+22)/45)%8+this.iKa)%8}olj(b){let h,u;if(this.rE&&90!==this.rE&&180!==this.rE&&270!==this.rE&&360!==this.rE||this.MMm(b))return{lcc:!0,Gdc:!0};h=u=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:u=!0}return{lcc:u,
Gdc:h}}gko(){this.VWa=this.UWa=!1;switch(this.dxe){case 0:this.VWa=this.UWa=!0;break;case 1:case 2:this.VWa=!0;break;case 7:case 6:this.UWa=!0}}MMm(b){return!(b%2)}SPc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const u=b[h].toString();if(u.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==u)return u}return""}eko(b){switch(this.SPc(b.uf)){case "WACImageResizeHandleNW":this.iKa=
0;break;case "WACImageResizeHandleN":this.iKa=1;break;case "WACImageResizeHandleNE":this.iKa=2;break;case "WACImageResizeHandleE":this.iKa=3;break;case "WACImageResizeHandleSE":this.iKa=4;break;case "WACImageResizeHandleS":this.iKa=5;break;case "WACImageResizeHandleSW":this.iKa=6;break;case "WACImageResizeHandleW":this.iKa=7}}KOk(){var b=1;this.fn.instance&&(b=this.fn.instance.ij);const h=(this.SKa.x-this.aNa.x)/b;b=(this.SKa.y-this.aNa.y)/b;this.ew.x=this.UWa?-h:h;this.ew.y=this.VWa?-b:b}setSize(){const b=
new Od.DictionaryPropertySet;b.setValue($c.a.DTc,100*this.Jmd);b.setValue($c.a.Poi,!0);if(90===this.rE||270===this.rE){let h,u;({lcc:h,Gdc:u}=this.olj(this.iKa));b.setValue($c.a.qzf,h);b.setValue($c.a.rzf,u)}else b.setValue($c.a.qzf,this.bod),b.setValue($c.a.rzf,this.zla);this.ga.Rb(Ob.a.Dac,2,b)}}Object(m.a)(hh,"ImageResizeDragAdapter",null,[219]);var Of=c(124),jj=c(885);class ch{constructor(b,h,u,B){this.DDe=this.SKa=this.aNa=this.Yud=null;this.Wrd=this.Gzd=0;this.Gb=null;this.ga=b;this.ib=h;this.fn=
u;this.b4g=this.eCa=0;this.kd=B}tP(b){return Fb.App.za.jb.isEditingAllowed&&!fc.SessionStatusManager.instance.Uj&&b&&this.qRm(b.uf)?(this.Yud=this.ib.ng)?!0:!1:!1}VNd(){}Osf(){return null}wL(b){if(!this.tP(b))return!1;this.sBa=ed.a.Eb(b.uf,yf.a);if(!this.sBa)return!1;this.vvd=this.sBa.r$;if(!this.vvd)return!1;this.Yud=this.ib.ng;this.Gb=Dd.ImageReader.nn(this.Yud);if(!this.Gb)return!1;this.aNa=this.wPa(b);this.DDe=Sys.UI.DomElement.getBounds(this.vvd);this.Gzd=0<Dd.ImageReader.kRd(this.Gb)?Dd.ImageReader.kRd(this.Gb):
0;this.Wrd=Dd.ImageReader.gqf(this.Gb);return!0}TU(b){this.SKa=this.wPa(b);this.TOk();if(this.sBa)return this.sBa.Dne(this.eCa,this.b4g),!0;r.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}eE(){this.Gzd=this.eCa=Cf.c(this.eCa);this.G5()}JY(){this.sBa.Dne(this.Wrd,0)}qRm(b){return b.classList.contains(jj.c)||b.classList.contains(jj.b)||b.classList.contains(jj.a)||!!b.parentElement&&b.parentElement.classList.contains(jj.a)}wPa(b){return this.kd.zd.M1a(b)}TOk(){var b=
1;this.fn&&this.fn.instance&&(b=this.fn.instance.ij);var h=new Sys.UI.Point(this.DDe.x+this.vvd.clientWidth/2*b,this.DDe.y+this.vvd.clientHeight/2*b);b=Cf.a(this.aNa,h);h=Cf.a(this.SKa,h);this.eCa=Math.round(Of.a.WKn(h-b));0<this.Gzd&&(this.eCa+=this.Gzd-this.Wrd);this.b4g=this.eCa;this.eCa+=this.Wrd}G5(){const b=new Od.DictionaryPropertySet;b.setValue($c.a.ATc,0);b.setValue($c.a.DJ,this.eCa);this.ga.Rb(Ob.a.c9,2,b)}}Object(m.a)(ch,"ImageRotateDragAdapterSimplified",null,[608,219]);class Fi{constructor(){this.W=
null}get name(){return"Box4.Images"}wc(b){this.W=b;this.W.ia("Box4.Images.ImageResizeDragAdapter",()=>new hh(null,v.AFrameworkApplication.va,Ga.a.instance.Ta("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.W.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new ch(v.AFrameworkApplication.va,xf.a.instance,Ga.a.instance.Ta("Common.IZoomManager"),nb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");
this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){M.a.instance.Gc(new Fi)}}Object(m.a)(Fi,"Box4ImagesPackage",null,[1,2]);var Bh=c(312),Sh=c(117),Jc=c(6),fh=c(687),fj=c(457),If=c(575),ui=c(255),gk=c(261),le=c(1782),xe=c(1836),ci=c(1207);class Ch extends xe.a{constructor(b,h,u){super(b,h,u);this.Xsd=this.Sdb=null}get jS(){return v.AFrameworkApplication.ua.Iq}DQd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}ioe(b){return Ch.gAa(b,this.xii())}xii(){return Ch.zWe}gAa(b,h=null){b=this.ioe(b);return 0!==b?(h&&h.EAd(),2===b&&(h=this.DQd(b),this.zp(this.U7h(b),h)),!1):!0}ePa(b,h){r.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.MXf=h;Gj.a.mark(5576);this.Xsd=this.jS.Vf("LoadResource","PictureUploadTime");this.jXd()?this.nde(b):this.O1c()}zp(b,h){const u=new mg.StandardDialog;u.Cd=0;u.rx(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}O1c(){r.ULS.sendTraceTag(36783361,
322,50,"PictureUploader.OnUploadComplete");super.O1c();this.Xsd&&(this.Xsd.stop(),this.Xsd=null)}P7a(){this.Sdb=(new ci.a).create();this.Sdb.message=CommonUIStrings.l_ImageUploadWait;this.Sdb.Cd=5;this.Sdb.Ht=!1;this.Sdb.GL(null,null,null)}m4b(){this.Sdb&&(this.Sdb.close(),this.Sdb=null)}static brm(b,h){b=F.a.Zg(b);for(let u=0;u<h.length;++u)if(b.endsWith(h[u]))return!0;return!1}static gAa(b,h=null){h||(h=Ch.zWe);return b?Ch.brm(b,h)?0:2:1}}Ch.zWe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(m.a)(Ch,"PictureUploader",xe.a,[]);var Re=c(353),Oh;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";b[b.pictureTooLarge=3]="pictureTooLarge"})(Oh||(Oh={}));Object(m.b)("PictureValidationResult",Oh);var kf=c(55),Xe=c(16),xh=c(46);class no{constructor(){this.fU=null}}Object(m.a)(no,"ImageData",null,[]);var kl=c(51),gh=c(1783),gm=c(1624),ug=c(1657);class sc extends Hf.a{constructor(b,h=!0){super(!1,!1,sc.NL);
this.MZb=null;this.STg=!1;this.vy=[];this.Ks=null;this.Udb=b;this.ahk=h;this.taa=this.Ygh=!1;this.EZa=null;this.mAe=!1;this.Yg=this.zll;this.ug="InsertFileDialog";this.xe(1,this.Xzd);sc.NL?(this.MZb={["id"]:this.ug,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.ltn,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.fmn,"onFrameReady")},this.Qh(this.titleText,
Object(z.a)(this,this.ZWd,"insertDialogHandler"),this.MZb),this.eW=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.ZWd,"insertDialogHandler")),h&&this.tmo(),(b=this.wPd(1))&&this.vy.push(b),(b=this.wPd(0))&&this.vy.push(b),this.YEj(),this.eW=!1)}get RGj(){return this.Udb}validate(){this.Ks.fU||r.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Ks.fU.value?!0:(sc.rx(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}fmn(b){this.ahk&&(this.Ks=this.smj(b,this.Udb))}ltn(){this.Ks&&
this.Ks.fU&&(this.STg||(this.Ks.uUn(Object(z.a)(this,this.aVf,"onFileChosen")),this.STg=!0),this.Ks.TYh())}aVf(b){this.MZb.uploadStatusLabel=b;this.g6(this.titleText,Object(z.a)(this,this.ZWd,"insertDialogHandler"),this.MZb)}ZWd(b){1===b&&this.isEnabled()?sc.NL&&this.Ks.fU&&!this.Ks.fU.value?(this.MZb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.g6(this.titleText,Object(z.a)(this,this.ZWd,"insertDialogHandler"),this.MZb)):(this.IVd(),this.Udb.ePa(this.Ks,Object(z.a)(this,this.dispose,
"dispose"))):0===b&&this.hide()}tmo(){this.mAe=!1;this.Ks=this.smj(document.getElementById("uploadFrameContainer"),this.Udb);v.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.EZa=Object(z.a)(this,this.NXf,"onUploadFrameLoad"),Me.a.addHandler(this.Ks.iFrame,"load",this.EZa));this.Ks.fU||r.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.R2i()}NXf(){this.R2i()}R2i(){if(this.Ks&&!this.mAe){var b=this.Ks.fU;b&&(Me.a.addHandler(b,Kd.a.$h,Object(z.a)(this,
this.onKeyDown,"onKeyDown")),b=[b],this.vy=b.concat.apply(b,this.vy),this.YEj(),this.mAe=!0)}}dispose(){if(this.Ks&&!sc.NL){const b=this.Ks.fU;b&&Me.a.removeHandler(b,Kd.a.$h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));this.EZa&&Me.a.removeHandler(this.Ks.iFrame,"load",this.EZa)}this.Ks=null;super.dispose()}YEj(){if(0<this.vy.length){const b=new Rd(this.vy),h=hd.FocusManager.instance().Ys();h&&(this.vy[0].focus(),h.ak=b,h.xP=!0)}}onKeyDown(b){4!==hd.FocusManager.instance().V2i(b)&&b.preventDefault()}static get NL(){return v.AFrameworkApplication.ua.Lb.pF&&
v.AFrameworkApplication.ua.Lb.qAi}static rx(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(m.a)(sc,"InsertFileDialog",Hf.a,[]);class oo{static get Yg(){return Hf.a.Bz(oo.Sm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}oo.Sm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(oo,"InsertImageDialogHtml",null,[]);class Un extends sc{constructor(b,h=!0){super(b,h)}get Xzd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get zll(){return oo.Yg}validate(){this.Ks.fU||r.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Na.a)(Ch,this.RGj);const h=b.ioe(this.Ks.fU.value);return 0!==h?(b=b.DQd(h),sc.rx(b),!1):!0}}Object(m.a)(Un,"InsertImageDialog",sc,[]);class jk extends Un{constructor(b){super(b)}smj(b,
h){const u=v.AFrameworkApplication.ua.Lb.pF&&v.AFrameworkApplication.ua.Lb.qAi;return new ug.a(b,Object(z.a)(h,h.Hgc,"onUploadFrameInitialized"),Object(z.a)(h,h.Zza,"uploadResponseReceived"),v.AFrameworkApplication.K,!u)}isEnabled(){return jk.nP.uga(this.RGj.context)}static get nP(){return null!=jk.Nzg?jk.Nzg:jk.Nzg=Ga.a.instance.resolve("Box4.Images.IImageEditor")}}Object(m.a)(jk,"Box4InsertImageDialog",Un,[]);class Go{S4k(b){return new Promise((h,u)=>{this.T4k(b).then(B=>{h(B)},B=>{u(B)})})}cIh(b){return new Promise((h,
u)=>{const B=new FileReader;B.addEventListener("load",()=>{h(B.result)},!1);B.addEventListener("error",()=>{u("FileReader exception ("+B.error.name+")")});B.readAsDataURL(b)})}T4k(b){return new Promise((h,u)=>{this.cIh(b).then(B=>{this.S9e(B,"image/jpeg").then(Q=>{h(Q)},Q=>{u(Q)})},B=>{u(B)})})}S9e(b,h){return new Promise((u,B)=>{const Q=new Image;Q.addEventListener("load",()=>{const ca=document.createElement("canvas"),qa=ca.getContext("2d");ca.width=Q.width;ca.height=Q.height;qa.drawImage(Q,0,0);
u(ca.toDataURL(h))});Q.addEventListener("error",()=>{B("Image failed to load")});Q.src=b})}}Object(m.a)(Go,"ImageFormatConverter",null,[]);var Xl=c(394);const Wp=["ImageInsertFailed"];class Id extends Ch{constructor(b,h,u,B,Q,ca,qa=!0){super(b,h,u);this.pBa=this.Sl=this.fH=this.Bf=null;this.fNd="wwpicturesfc";this.kpiName="ImageFileExtension";this.rxc="LocalDeviceUpload";this.pia=new Map;this.ZYh=0;this.Tdb=null;this.kAe="";this.Psa=0;this.Zp=null;this.hwc="";this.e5g=50;this.uVg=this.tuc=this.OCc=
this.nzc=!1;this.S9j=19922944;this.q7g=0;this.oAe=[];this.RTg=[];this.r7g=0;this.HWf=Qa=>{r.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Qa){var rb={},Lb=this.fH?this.fH.properties.Nc.toString():this.Bf.Nc.toString();rb[fj.a.nodeId]=this.fH?this.fH.id.toString():this.Bf.id.toString();rb[fj.a.classId]=Lb;this.Vg.hasProperty(Jc.a.imageType)&&(rb[fh.a.imageType]=this.Vg.getValue(Jc.a.imageType));this.Vg.hasProperty(Jc.a.yU)&&(rb[fh.a.yU]=this.Vg.getValue(Jc.a.yU));
this.Vg.hasProperty(Sh.a.Wga)&&(rb[fh.a.Wga]=this.Vg.getValue(Sh.a.Wga));this.Vg.hasProperty(Jc.a.amb)&&(rb[fh.a.amb]=this.Vg.getValue(Jc.a.amb));gm.d(Qa,this.Bf,this.Sl,rb)&&(this.dad(Qa),Id.Sfc++)}else r.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.Pln=Qa=>{if(!this.RAf){var rb=this.m8h(this.Ks);rb&&(this.kAe=rb.name,this.Psa=rb.size);if(!this.gAa(Qa,this.Ks)||!this.Qpg(rb,this.Ks)){rb=Object.assign(new Ub.a,{extendedProperties:new Map});rb.extendedProperties.set("type",
this.gAa(Qa,this.Ks)?"Image too large":"FileType invalid");this.x2d(rb);this.r2d();return}}this.ePa(this.Ks,null)};this.Vg=B;this.Lm=Q;this.ga=ca;this.og=Re.a.getInstance(Xl.a);this.c4g=u.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.v5g=u.lc("ImageUploadMaxByteSize",Number.MAX_VALUE);qa&&this.showDialog();Fb.App.Smc.addHandler(this)}get Txi(){return this.K.$("JfifImageInsertIsEnabled")}get vP(){return this.rxc}get fileExtension(){return this.kAe}get fileSize(){return this.Psa}get QGj(){return this.Tdb}get Tw(){return this.Zp||
(this.Zp=Ga.a.instance.resolve("Common.Utils.IAriaNotifier"))}get RAf(){return this.vP===this.rxc}showDialog(){gm.a(this.K)?(this.m6b=!1,this.Ks=new ug.a(document.body,Object(z.a)(this,this.Hgc,"onUploadFrameInitialized"),Object(z.a)(this,this.Zza,"uploadResponseReceived"),this.K,!1,void 0,!0)):gm.b()||this.rLb&&Z.a.YH?(this.m6b=!1,this.Ks=new ug.a(document.body,Object(z.a)(this,this.Hgc,"onUploadFrameInitialized"),Object(z.a)(this,this.Zza,"uploadResponseReceived"),this.K,!1)):(this.m6b=!0,this.Ks=
(new jk(this)).Ks)}U7h(b){switch(b){case Oh.noPictureSpecified:return kl.a.noPictureSpecified;case Oh.invalidExtension:return kl.a.kCm;case Oh.pictureTooLarge:return kl.a.kLf}return xd.a.unknown}nde(b){this.RAf||(this.Bf.Ui()?(r.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),gh.a.instance.epg(this.Bf.Ui()),this.Bf.Ui().contentReplicator.forceOutbound(this.HWf,Object(z.a)(this,this.vNb,"processFailure"),b)):this.vNb(b,157))}aQm(){return gm.c(this.Bf)}dad(b){b.dad();this.Tdb=
b.Tdb}Zza(b){this.ZYh=+new Date-+this.QGj;this.r2d();r.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");gm.e(this,b,this.Bf)}wYo(){r.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.O1c();Id.Sfc--;this.ga.processAction(Za.a.W8a,2);this.Bf?gh.a.instance.koc(this.Bf.Ui(),0):r.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Tw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}vNb(b,h){var u;if(this.X5n(b))r.ULS.sendTraceTag(16798870,
352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new Ub.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(u=v.AFrameworkApplication.K)||void 0===u?0:u.$("ShouldLogPicturesExtendedHealthKpis"))?this.og.logKpiFailure({kpiName:Xl.c.CFa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Xl.c.Bac,errorNameOverride:null,
isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):xa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Wp,!1,!0,!1,!1,b);u=this.Vhf(h);r.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Bf.uJ();var B=new Qg.GraphTransaction(15,Ob.a.yR);B.Db(this.Bf);Id.nP.QTa(this.Vg,u);Id.nP.R6f(this.Bf,this.fH);Dd.ImageReader.ikj(this.Vg);B.dispose();this.Jqj(u);this.Lm.k4b(b,!1);
this.O1c();Id.Sfc--;gh.a.instance.koc(this.Bf.Ui(),h)}}Jqj(b){const h=new mg.StandardDialog;h.Cd=0;h.rx(kl.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}Vhf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}HNj(){if(this.hwc&&0<this.hwc.length){const b=new Od.DictionaryPropertySet;b.setValue($c.a.IP,this.hwc);b.setValue($c.a.F4,!0);this.ga.Rb(Ob.a.F_,2,b)}this.Qto()}Qto(){let b="";this.uVg?
b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.nzc&&this.tuc&&this.OCc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.nzc&&this.tuc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.nzc&&this.OCc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.OCc&&this.tuc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.OCc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.tuc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.nzc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.Jqj(b),this.nOj())}Utk(b){this.hwc+=String.format('<img src="{0}"></img>',b);this.r7g++}t3m(){this.OCc=!0;r.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Ub.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.x2d(b)}r3m(){this.tuc=!0;r.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");
const b=Object.assign(new Ub.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.x2d(b)}XIi(b){this.uVg=!0;r.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}Izo(b){const h=new Go;if(this.ioe(b.name)===Oh.validPicture)return h.cIh(b);if(Ch.gAa(b.name,ug.a.AWe)===Oh.validPicture)return h.S4k(b)}b5k(b){return new Promise(h=>{const u=this.Izo(b);void 0===u&&(this.XIi("Failed starting conversion work"),h());u.then(B=>
{B.length>this.S9j?this.t3m():this.Utk(B);h()},B=>{this.XIi(B);h()})})}JUm(b){return this.ioe(b.name)===Oh.validPicture||Ch.gAa(b.name,ug.a.AWe)===Oh.validPicture}yBm(){const b=[];if(this.Ks.fU.files){this.q7g=this.Ks.fU.files.length;this.Ks.fU.files.length>this.e5g&&(this.nzc=!0);this.P7a();for(let h=0;h<this.Ks.fU.files.length&&this.e5g;h++){const u=this.Ks.fU.files[h];this.oAe.push(u.name);this.RTg.push(u.size);u&&(this.JUm(u)?b.push(this.b5k(u)):this.r3m())}}Promise.all(b).then(()=>{this.m4b();
this.HNj()});return!0}mCm(){this.Sl=yb.a.create();this.Vg||(this.Vg=new Od.DictionaryPropertySet);this.c4g&&this.pBa&&this.Vg.setValue(Sh.a.sIi,this.pBa);var b=480;let h=320;const u=this.context.view.rh.editingElement.clientWidth;0<u&&u<b&&(h=Math.floor(1*u/b*h),b=u,this.Vg.setValue(Sh.a.Wga,u));this.Vg.setValue(Xe.a.sia,kf.a.Kl(b,0));this.Vg.setValue(Xe.a.ria,kf.a.Kl(h,1));this.Vg.setValue(xh.a.s0,1);this.Vg.setValue($c.a.F4,!0);this.Vg.setValue(Jc.a.amb,Box4Intl.Box4Strings.l_Picture);b=Id.nP.vSh(this.context,
this.Vg,this.Sl);if(!b)return!1;this.Bf=b.node;this.Vg=(this.fH=b.blob)?this.fH.properties:this.Bf.properties;Fb.App.xd.So&&Fb.App.xd.Yp.$F(this.Bf);return!0}jXd(){return this.RAf?this.yBm():this.mCm()}nOj(){var b;this.pia.set("FileExtensions",this.wQl());this.pia.set("FileSizeInBytes",this.RTg.toString());this.pia.set("Source",this.vP);this.pia.set("NumberOfImagesAttemptedToInsert",this.q7g.toString());this.pia.set("NumberOfImagesPasted",this.r7g.toString());(null===(b=v.AFrameworkApplication.K)||
void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.pia.set("ErrorLevel","warning"),b=Object.assign(new Ub.a,{extendedProperties:this.pia}),this.og.logKpiFailure({kpiName:Xl.c.CFa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):xa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.fNd,this.pia)}wQl(){let b="";for(let h=0;h<this.oAe.length;++h)b=b+this.l8h(this.oAe[h])+",";return b}ePa(b,h){this.c4g&&(this.pBa=new no,this.pBa.fU=b.fU);super.ePa(b,
h)}Hgc(b){this.Ks=b;if(!this.m6b){if(this.Vne){if(gm.a(this.K)||this.rLb&&Z.a.YH){b.BKd(this.Pln);return}const h=b.BKd(null),u=this.m8h(b);u&&(this.kAe=u.name,this.Psa=u.size);if(!this.gAa(h,b)||!this.Qpg(u,b)){b=Object.assign(new Ub.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.gAa(h,this.Ks)?"Image too large":"FileType invalid");this.x2d(b);this.r2d();return}}this.ePa(b,null)}}yVd(){return!!Id.Sfc}r2d(){var b;this.pia.set("FileExtension",this.l8h(this.fileExtension));this.pia.set("Source",
this.vP);this.pia.set("FileSizeInBytes",this.fileSize.toString());this.pia.set("RequestTimeInMs",this.ZYh.toString());(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.og.logKpiUsage({kpiName:Xl.c.CFa,kpiType:0,optionalProperties:{extendedProperties:this.pia}}):xa.Health.instance.recordKpiUsage(this.kpiName,0,this.fNd,this.pia)}l8h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}xii(){return this.Txi?ug.a.Tjh:Ch.zWe}m8h(b){return(b=
b.fU)?b.files[0]:null}Qpg(b,h){return b&&b.size>this.v5g?(h&&h.EAd(),b=this.DQd(Oh.pictureTooLarge),this.zp(this.U7h(Oh.pictureTooLarge),b),!1):!0}DQd(b){switch(b){case Oh.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Oh.invalidExtension:return this.Txi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Oh.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.v5g/1E6));
default:return""}}x2d(b){var h;(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Xl.c.Bac,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.og.logKpiFailure({kpiName:Xl.c.CFa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):xa.Health.instance.recordQosError("PictureFromLocalInvalid",
Wp,!0,!0,!1,!1,b)}static get nP(){return null!=Id.Mzg?Id.Mzg:Id.Mzg=Ga.a.instance.resolve("Box4.Images.IImageEditor")}}Id.Sfc=0;Object(m.a)(Id,"Box4PictureUploader",Ch,[689,533]);var tr=c(839),xk=c(132);class Ek{constructor(){this.Mr=this.Lp=this.Lxb=this.Mhh=this.agd=this.fXj=null;this.CPe=0;this.Gsa=this.PKe=this.$xb=null;this.COg=0;this.Yse=this.Gfa=this.mHe=null;this.JZg=!1;this.dse=this.$re=this.ese=null}get assetId(){return this.agd}get thumbnailUrl(){return this.Mhh}get ZEn(){return this.Lxb}get displayName(){return this.Gsa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Lp,this.Mr)}get lyk(){if(this.$re&&this.dse&&this.ese){const b=document.createElement("a");b.setAttribute("href",this.ese);b.setAttribute("target","_blank");b.innerText=this.dse;return b}return null}get pqh(){return this.$re}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.COg)}get MMn(){const b=document.createElement("span");var h=0;if(this.$xb&&0<this.$xb.length){var u=this.$xb.indexOf("."),B=0>u?this.$xb:this.$xb.substring(0,u);for(B=Number.parseInvariant(B);h<
B&&5>h;h++)b.appendChild(ze.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",xk.a.sg("box42.png"),"","",!0,""));0<u&&(u=Number.parseInvariant(this.$xb.substr(u+1)),3>u?b.appendChild(ze.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",xk.a.sg("box42.png"),"","",!0,"")):8>u?b.appendChild(ze.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",xk.a.sg("box42.png"),"","",!0,"")):b.appendChild(ze.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",xk.a.sg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(ze.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",xk.a.sg("box42.png"),"","",!0,""));this.PKe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.PKe),b.appendChild(h));return b}get D4n(){return 0<this.CPe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.CPe):""}get DGk(){if(this.JZg){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.Yse&&this.Gfa)return Ek.N$k(this.Yse,this.Gfa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.mHe){const h=this.mHe.split(",");b=Array(h.length);for(let u=0;u<h.length;u++)b[u]=h[u].trim()}else b=[];return b}static XHl(b){const h=new Ek;for(let u=0;u<b.childNodes.length;u++){const B=b.childNodes[u];if(1===B.nodeType)try{const Q=B.firstChild.nodeValue;switch(B.nodeName){case "src":h.fXj=Q;break;case "assetid":h.agd=
Q;break;case "thumb":"64x64"===B.attributes.getNamedItem("size").nodeValue?h.Mhh=Ek.gAj(Q):"192x192"===B.attributes.getNamedItem("size").nodeValue&&(h.Lxb=Ek.gAj(Q));break;case "imagedim":if(Q){const qa=Q.indexOf("x");0<qa&&qa<Q.length&&(h.Lp=Q.substr(0,qa),h.Mr=Q.substr(qa+1))}break;case "resolution":h.CPe=Number.parseInvariant(Q);break;case "rating":h.$xb=Q;break;case "numofratings":h.PKe=Q;break;case "displayname":h.Gsa=Q;break;case "contentlength":h.COg=Number.parseInvariant(Q)/1024;break;case "subject":h.mHe=
Q;break;case "provider":h.Gfa=Q;break;case "attributionlink":h.Yse=Q;break;case "iscsc":h.JZg=1===Number.parseInvariant(Q);break;case "additional":const ca=B.firstChild;if(B.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let qa=0;qa<B.childNodes.length;qa++){const Qa=B.childNodes[qa];switch(Qa.nodeName){case "caption":h.$re=Qa.text;break;case "value":h.ese=Qa.text;break;case "string":h.dse=Qa.text}}}}catch(Q){}}return h}static N$k(b,h){const u=document.createElement("a");
u.setAttribute("href",b);u.setAttribute("target","_blank");u.innerText=h;return u}static gAj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(m.a)(Ek,"ClipArtSearchResult",null,[]);class kk{static get Yg(){return Hf.a.Bz(kk.Sm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}kk.Sm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(m.a)(kk,"InsertClipartDialogHtml",null,[]);class co extends Hf.a{constructor(b){super();this.nBa=this.jvb=0;this.gah=null;this.SNe=!1;this.zZb=this.uYa=this.$N=null;this.vWi=h=>{const u=this.PW.value;u&&0<u.trim().length&&(this.search(this.PW.value),this.bra(1,!1));h.preventDefault();h.stopPropagation()};this.trn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.vWi(h),h.preventDefault(),h.stopPropagation())};this.wWi=h=>{100<=this.PW.value.length&&(h.preventDefault(),h.stopPropagation())};
this.Qpn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.e2i(h);this.bcg(h)};this.onScroll=()=>{if(this.Nr&&this.Nr.children&&!(2>this.Nr.children.length)){var h=this.Nr.children[0].children[0],u=this.Nr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Nr.scrollTop,B=h.clientHeight+2,Q=parseInt(String(this.Nr.scrollTop/B));h=parseInt(String(u/B));var ca=parseInt(String(this.Nr.clientWidth/B));h<u/B&&h<parseInt(String(this.$N.length/ca))&&h++;for(u=Q;u<h;u++)for(B=
0;B<ca;B++){var qa=u*ca+B;Q=this.$N[qa];(qa=document.getElementById("clip"+qa))&&!qa.childNodes.length&&(Q=this.KMh(Q),qa.appendChild(Q))}}};this.Bsn=h=>{h.target.setAttribute("src",xk.a.sg("phthumb.64x64x32.png"))};this.Rpn=h=>{h.target.setAttribute("src",xk.a.sg("phpreview.96x96x32.png"))};this.WTi=h=>{Qd.a.om(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.Pmn=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.WTi(h)};this.pUi=h=>{const u=h.target.innerText;this.PW&&(this.PW.value=u);this.search(u);h.stopPropagation();h.preventDefault();this.bra(1,!1)};this.Dnn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.pUi(h)};this.yWi=h=>{this.$N&&(this.t$n(this.$N[this.jvb]),h.stopPropagation(),h.preventDefault(),this.PW.value="",this.bra(1,!1))};this.urn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.yWi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let u=0;switch(h.keyCode){case Sys.UI.Key.up:u=-5;break;case Sys.UI.Key.down:u=5;break;case Sys.UI.Key.left:u=-1;break;case Sys.UI.Key.right:u=1}this.nBa=this.nBa+u<this.Nr.children.length-1?0>this.nBa+u?0:this.nBa+u:this.Nr.children.length-1;this.bcg(this.nBa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Nr.children.length&&this.Mgj(h)):h.keyCode===Sys.UI.Key.tab&&
(this.nBa=h.shiftKey?Math.max(0,this.nBa-1):Math.min(this.nBa+1,this.Nr.children.length-1))};this.onError=()=>{this.Nr&&(this.Nr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.i3i=h=>{if(this.Nr)if(h.data.yja){var u=h.data.yja.lastChild.childNodes;this.$N||(this.$N=[]);for(h=0;h<u.length&&100>this.$N.length;h++){var B=u[h];1===B.nodeType&&"image"===B.nodeName&&(B=Ek.XHl(B),this.$N.push(B))}this.bSh();this.$N.length||(this.Nr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.se){h=
F.a.Ouj(h.data.se);try{u=parseInt(h)}catch(Q){u=14}this.Nr.innerText=26===u?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.bSh=()=>{if(this.$N){kc.a.K_(this.Nr);this.uYa&&(this.uYa.dispose(),this.uYa=null);this.Nr.focus();this.Nr.classList.remove("ClipartSearchInProgress");for(let u=0;u<this.$N.length;u++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+u;const B=document.createElement("span");B.id="clip"+u;B.classList.add("ClipartImageContainer");
h.appendChild(B);this.Nr.appendChild(h);u<parseInt(String(this.Nr.clientHeight/B.clientHeight))*parseInt(String(this.Nr.clientWidth/B.clientWidth))&&(h=this.KMh(this.$N[u]),B.appendChild(h))}this.SNe&&(this.Mgj(this.jvb),this.bcg(this.jvb))}};this.PAm=h=>{1===h&&this.$N&&co.nP.uga(this.ANg.context)&&(h=this.$N[this.jvb])&&this.ANg.zza(h)};this.ANg=b;this.Yg=kk.Yg;this.ug="InsertClipartDialog";this.xe(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.PAm);this.Nr=document.getElementById("clipartsearchresults");this.qvd=this.onKeyDown;Me.a.addHandler(this.Nr,"keydown",this.qvd);this.pvd=this.onScroll;Me.a.addHandler(this.Nr,"scroll",this.pvd);this.PW=document.getElementById("textInput");this.Qxd=this.trn;Me.a.addHandler(this.PW,"keydown",this.Qxd);this.Rxd=this.wWi;Me.a.addHandler(this.PW,"keypress",this.Rxd);this.Sxd=this.wWi;Me.a.addHandler(this.PW,"paste",this.Sxd);this.Tqc=document.getElementById("btnSearch");this.Tqc.setAttribute("src",
xk.a.sg("search.16x16x32.png"));this.ovd=this.vWi;Me.a.addHandler(this.Tqc,"click",this.ovd);this.OVb=document.getElementById("clipartpreviewimage");this.pye=document.getElementById("clipartattributedisplayname");this.kab=document.getElementById("clipartseesimilar");this.oye=document.getElementById("clipartdimensions");this.Dtc=document.getElementById("clipartadditionalvalue");this.qye=document.getElementById("clipartratingvalue");this.AWa=document.getElementById("clipartattributionvalue");this.BWa=
document.getElementById("clipartkeywords");this.mye=document.getElementById("clipartadditionalname");this.rye=document.getElementById("clipartratingname");this.nye=document.getElementById("clipartattributionname");this.UNe=this.Qpn;this.GUe=this.Bsn;this.omd=this.WTi;this.pmd=this.Pmn;this.kHe=this.pUi;this.lHe=this.Dnn;this.svd=this.yWi;this.tvd=this.urn;this.PW.focus();this.bra(1,!1)}dispose(){this.Nr&&this.YCh();this.Nr&&this.qvd&&(Me.a.removeHandler(this.Nr,"keydown",this.qvd),this.qvd=null);
this.Nr&&this.pvd&&(Me.a.removeHandler(this.Nr,"scroll",this.pvd),this.pvd=null);this.Nr=null;this.PW&&this.Qxd&&(Me.a.removeHandler(this.PW,"keydown",this.Qxd),this.Qxd=null);this.PW&&this.Rxd&&(Me.a.removeHandler(this.PW,"keypress",this.Rxd),this.Rxd=null);this.PW&&this.Sxd&&(Me.a.removeHandler(this.PW,"paste",this.Sxd),this.Sxd=null);this.PW=null;this.Tqc&&this.ovd&&(Me.a.removeHandler(this.Tqc,"click",this.ovd),this.Tqc=this.ovd=null);this.nye=this.rye=this.mye=this.BWa=this.AWa=this.qye=this.Dtc=
this.oye=this.kab=this.pye=this.OVb=this.tvd=this.svd=this.lHe=this.kHe=this.pmd=this.omd=this.zZb=this.GUe=this.UNe=null;this.uYa&&(this.uYa.dispose(),this.uYa=null);super.dispose()}IL(){super.IL();document.getElementById(this.mj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.vPb(b,!1,this.i3i)}vPb(b,h,u){this.nBa=this.jvb=0;this.YCh();if(this.$N&&b===this.gah&&this.SNe===h)window.setTimeout(this.bSh,500);else{this.$N&&(Array.clear(this.$N),this.$N=null);this.gah=b;this.SNe=
h;var B=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');B.append("<query>");B.append(F.a.vf(b));B.append("</query>");B.append("<mediatype>Illustration</mediatype>");B.append("<mediatype>Photo</mediatype>");B.append("<filetype>jpg</filetype>");B.append("<filetype>jpeg</filetype>");B.append("<filetype>gif</filetype>");B.append("<filetype>bmp</filetype>");B.append("<filetype>tif</filetype>");B.append("<filetype>tiff</filetype>");B.append("<filetype>png</filetype>");B.append("</search>");
b=v.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let Q=b.length;4>Q;Q++)b="0"+b;v.AFrameworkApplication.He.sj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Fb.App.webServiceBase,b,fh.a.two,h.toString()),2,B.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,u,this.onError,null)}}t$n(b){this.vPb(b.assetId,!0,this.i3i);this.$N||(this.$N=[],this.$N.push(b))}KMh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);Me.a.addHandler(h,"click",this.UNe);Me.a.addHandler(h,"error",this.GUe);return h}qjl(b){1===b.childNodes.length&&(b=b.childNodes[0],Me.a.removeHandler(b,"click",this.UNe),Me.a.removeHandler(b,"error",this.GUe))}e2i(b){const h=this.$N[b];var u=h.ZEn;this.WCh();this.zZb=this.Rpn;var B=document.createElement("img");B.setAttribute("src",u);if(h.displayName)u=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{u=new Sys.StringBuilder;for(let Q=0;Q<h.keywords.length&&5>Q;Q++)Q&&u.append(", "),u.append(h.keywords[Q]);u=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,u.toString())}B.setAttribute("title",u);B.setAttribute("alt",u);Me.a.addHandler(B,"error",this.zZb);this.OVb.appendChild(B);B=document.getElementById("clip"+this.jvb);B.classList.remove("ClipartSelectedImage");B=document.getElementById("clip"+
b);B.classList.add("ClipartSelectedImage");this.jvb=b;h.displayName&&(this.pye.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Me.a.addHandler(b,"click",this.svd);Me.a.addHandler(b,"keydown",this.tvd);this.kab.appendChild(b);this.oye.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.D4n,h.fileSize);(b=h.lyk)&&h.pqh?(this.Dtc.parentNode.style.display="block",this.mye.innerText=h.pqh,this.Dtc.appendChild(b)):
this.Dtc.parentNode.style.display="none";this.qye.appendChild(h.MMn);kc.a.K_(this.AWa);if(b=h.DGk)this.AWa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Me.a.addHandler(b,"click",this.omd),Me.a.addHandler(b,"keydown",this.pmd));this.BWa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)B=h.keywords[b],u=document.createElement("a"),u.innerText=B,u.setAttribute("href",'""'),Me.a.addHandler(u,"click",this.kHe),Me.a.addHandler(u,"keydown",this.lHe),this.BWa.appendChild(u),
b<h.keywords.length-1&&(B=document.createElement("span"),B.innerText=", ",this.BWa.appendChild(B));this.rye.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.nye.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.bra(1,!0)}WCh(){this.OVb&&1===this.OVb.childNodes.length&&(this.zZb&&(Me.a.removeHandler(this.OVb.childNodes[0],"error",this.zZb),this.zZb=null),kc.a.K_(this.OVb));this.AWa&&0<this.AWa.childNodes.length&&"a"===this.AWa.childNodes[0].nodeName.toLowerCase()&&(this.omd&&Me.a.removeHandler(this.AWa.childNodes[0],
"click",this.omd),this.pmd&&Me.a.removeHandler(this.AWa.childNodes[0],"keydown",this.pmd));this.kab&&0<this.kab.children.length&&"a"===this.kab.children[0].nodeName.toLowerCase()&&(this.svd&&Me.a.removeHandler(this.kab.children[0],"click",this.svd),this.tvd&&Me.a.removeHandler(this.kab.children[0],"keydown",this.tvd),kc.a.K_(this.kab));if(this.BWa){for(let b=0;b<this.BWa.childNodes.length;b++){const h=this.BWa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Me.a.removeHandler(h,"click",this.kHe),Me.a.removeHandler(h,
"keydown",this.lHe))}kc.a.K_(this.BWa)}this.pye.innerText="";this.oye.innerText="";kc.a.K_(this.Dtc);kc.a.K_(this.qye);kc.a.K_(this.AWa);this.BWa.innerText="";this.mye.innerText="";this.rye.innerText="";this.nye.innerText=""}Mgj(b){if(!(this.Nr.children.length<=b||0>b)){var h=this.Nr.children[b],u=this.Nr.children[0];u=u.clientHeight-u.children[0].clientHeight+2;this.Nr.scrollTop+this.Nr.clientHeight<h.offsetTop+h.clientHeight?this.Nr.scrollTop=h.offsetTop-3*h.clientHeight-u:this.Nr.scrollTop>h.offsetTop&&
(this.Nr.scrollTop=h.offsetTop-u/2);this.e2i(b)}}validate(){return!0}YCh(){if(hd.FocusManager.iK()){var b=hd.FocusManager.instance().getRegion(this.dL);b&&b.ak.Zy(this.PW)}else this.PW.focus();for(b=0;b<this.Nr.childNodes.length;b++){const h=this.Nr.childNodes[b];1===h.childNodes.length&&this.qjl(h.childNodes[0])}kc.a.K_(this.Nr);this.WCh();this.bra(1,!1);this.uYa=new tr.a(Box4Intl.Box4Strings.l_ClipartSearching);this.uYa.pBi=!1;this.Nr.appendChild(this.uYa.element);this.Nr.classList.add("ClipartSearchInProgress")}bcg(b){this.nBa=
b;b=this.Nr.children[this.nBa];hd.FocusManager.iK()?hd.FocusManager.instance().getRegion(this.dL).ak.Zy(b):b.focus()}static get nP(){return co.Rj=co.Rj||Ga.a.instance.resolve("Box4.Images.IImageEditor")}}co.Rj=null;Object(m.a)(co,"InsertClipartDialog",Hf.a,[]);class sd extends Id{constructor(b,h,u,B,Q,ca){super(b,h,u,B,Q,ca,!1);this.ypn=qa=>{if(this.aQm()){var Qa=this.Bf.Ui(),rb=Qa.contentReplicator.Lt.toString(),Lb=new Sys.Net.WebRequest;Lb.set_url("ClipArtUpload.ashx");Lb=new Sys.StringBuilder(Lb.getResolvedUrl());
this.cX(Lb,fh.a.assetId,qa.assetId,!0);this.cX(Lb,fj.a.lcid,v.AFrameworkApplication.lcid.toString());this.cX(Lb,fj.a.nodeId,this.fH?this.fH.id.toString():this.Bf.id.toString());this.cX(Lb,fj.a.cellId,Qa.Am.toString());this.cX(Lb,fj.a.fileId,Qa.vr);this.cX(Lb,fj.a.Nua,rb);this.cX(Lb,fj.a.yX,this.Sl.toString());qa=this.Bf.ja(Sh.a.MJ,gk.a.Nt);this.cX(Lb,fj.a.MJ,qa.toString());this.cX(Lb,fj.a.Grb,"1");Qa.KH&&this.cX(Lb,fj.a.KH,Qa.KH);this.cX(Lb,fj.a.classId,this.fH?this.fH.properties.Nc.toString():this.Bf.Nc.toString());
this.Vg.hasProperty(Jc.a.imageType)&&this.cX(Lb,fh.a.imageType,this.Vg.getValue(Jc.a.imageType).toString());ui.a.instance.cuk(Lb);v.AFrameworkApplication.He.sj(Lb.toString(),2,"",{},!1,2,this.xYo,this.PGj,null);Id.Sfc++}};this.xYo=qa=>{if(({group:Qa}=If.a.S1(qa.data.se)).returnValue){var Qa=Qa.Responses[0];Qa.Hob=qa.data.RH;Qa.Sr=qa.data.Aj?qa.data.Aj[Bh.a.VQ]:"";this.Zza(Qa)}else this.PGj(null)};this.PGj=()=>{const qa=new le.a;qa.StatusCode=14;this.Zza(qa)};new co(this)}zza(b){this.jXd()&&this.Bf.Ui().contentReplicator.forceOutbound(this.ypn,
null,b)}cX(b,h,u,B){b.append(B?"?":"&");b.append(F.a.Dj(h));b.append("=");b.append(F.a.Dj(u))}Vhf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.Vhf(b)}}Zza(b){super.Zza(b);Id.Sfc--}}Object(m.a)(sd,"ClipartUploader",Id,[]);var vc=c(12);class rp{constructor(b,h,u){this.QAm=(B,Q,ca,qa,Qa)=>{if(!this.Rj||!this.Rj.value)return r.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;B=this.Rj.value.uga(Q);
return 2===ca&&B?(new sd(Q,Bg.a.instance,v.AFrameworkApplication.K,Qa,this.Lm,this.ga),32):1===ca?B&&Fb.App.PDh?32:8:2};this.Rj=b;this.Lm=h;this.ga=u}Tb(){this.ga.fb(Ob.a.Wqi,vc.a.view,this.QAm,260)}}Object(m.a)(rp,"ClipArtActor",null,[]);class Bo{constructor(){this.W=null}get name(){return"Box4.ClipArt"}wc(b){this.W=b;b.ia("Box4.ClipArt.ClipArtActor",()=>new rp(b.Re("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va)).ha()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Tb();
const b=Fb.App.za;b&&b.updateCommandUI()}dispose(){}}Object(m.a)(Bo,"ClipartPackage",null,[1,2]);class Uo{constructor(b){this.RYa=this.CYa=this.WYa=this.VYa=null;this.IWg=this.mRg=this.JWg=this.G2g=this.Xh=this.Eaa=!1;this.rPe=this.l3g=null;this.W2g=0;this.Ga=this.g3g=null;this.Yea=b;this.JN=3;this.xXb=!0}initialize(b,h,u){this.VYa=this.Xsf(b,h);this.WYa=CommonUIStrings.l_SavingStatus;this.CYa=CommonUIStrings.l_ReadOnlyStatus;this.RYa=CommonUIStrings.l_ReviewModeStatus;this.Yea&&this.Yea.execute(B=>
{B.reb(Object(z.a)(this,this.Icd,"updateToSavingStatus"))});this.Xh=!0;this.Ga=u;this.mRg=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}rrb(b,h){this.Eaa=b;this.JN=h;this.dVa(this.xXb)}dVa(b){!this.xXb&&b&&(this.g3g=new Date);this.xXb=b;this.IWg=!1;b=null;3===this.JN&&(b=this.xXb?this.VYa:this.WYa);this.Fnl(b)}Xsf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}Icd(){this.dVa(!1)}M2l(){switch(this.JN){case 1:return this.CYa;case 2:return this.RYa;default:return null}}L2l(){if(3!==this.JN)switch(this.JN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.IWg?"FailedToSave":this.xXb?"Saved":"Saving"}gJm(b){return this.G2g===this.Eaa&&this.W2g===this.JN&&this.l3g===b}Gef(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.Eaa,b,this.M2l(),this.g3g,this.xXb,this.mRg?h.getHeaderSaveStatusIconProps(this.L2l()):
null);this.JWg=!0;return null});this.rPe=null}Fnl(b){this.Xh&&ah.c()&&!this.gJm(b)&&(!this.JWg&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Gef(b):Qd.a.wde()?(this.rPe&&r.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.rPe=window.requestIdleCallback(()=>{this.Gef(b)})):window.requestAnimationFrame(()=>{this.Gef(b)}),this.G2g=this.Eaa,this.l3g=b,this.W2g=this.JN)}}Object(m.a)(Uo,"ReactSaveStatusUIHandler",
null,[669]);class Yl{constructor(b,h){this.hY=null;this.VYa=CommonUIStrings.l_SavedStatus;this.WYa=CommonUIStrings.l_SavingStatus;this.CYa=CommonUIStrings.l_ReadOnlyStatus;this.RYa=CommonUIStrings.l_ReviewModeStatus;this.dbb=h;this.Yea=b;this.JN=3;this.fdb=!0}cC(){this.Yea&&this.Yea.execute(b=>{b.reb(Object(z.a)(this,this.Icd,"updateToSavingStatus"))});this.dbb.execute(b=>{this.hY=b})}rrb(b,h){this.JN=h;3===h?this.dVa(this.fdb):2===h?this.Omg(this.RYa):this.Omg(this.CYa)}Icd(){this.dVa(!1)}dVa(b){this.fdb=
b;this.Omg(this.fdb?this.VYa:this.WYa)}Omg(b){this.hY&&this.hY.sendMessage(L.a.rOo,this.T2k(b))}T2k(b){const h={};h.StatusText=b;return h}}Object(m.a)(Yl,"SaveStatusPostMessageHandler",null,[669]);var Fm=c(218),Kn=c(140);class pj{constructor(b,h,u,B){this.RYa=this.CYa=this.WYa=this.VYa=null;this.Bwb=0;this.e_=this.AQe=this.ysb=this.Kse=this.TUe=null;this.lg=b;this.Yab=h;this.Yea=u;this.hm=B;this.H_g=!0;this.Eaa=!1;this.JN=3;this.fdb=!0}initialize(b,h){if(!this.lg)return!1;this.VYa=this.Xsf(b,h);this.WYa=
CommonUIStrings.l_SavingStatus;this.CYa=CommonUIStrings.l_ReadOnlyStatus;this.RYa=CommonUIStrings.l_ReviewModeStatus;this.cC();return!0}Xsf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}cC(){this.Yab&&this.Yab.execute(b=>{b.Qwk(Object(z.a)(this,this.rMh,"createStatusAndModeElements"));b.Awk(Object(z.a)(this,this.quo,"showHideSaveStatusElement"));b.sJo&&this.rMh(null,
null)});this.Yea&&this.Yea.execute(b=>{b.reb(Object(z.a)(this,this.Icd,"updateToSavingStatus"))})}f6(){this.e_&&this.lg&&this.lg.Tza(this.e_)}quo(b,h){this.rrb("true"===h,this.JN)}rrb(b,h){this.Eaa=b;this.JN=h;this.Kse&&(this.Kse.style.display=this.Eaa||3===this.JN||!this.TUe?"none":"");this.ysb&&(this.ysb.style.display=this.Eaa||3===this.JN?"none":"",this.ysb.innerText=1===this.JN?this.CYa:this.RYa,this.ysb.title=1===this.JN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.AQe&&(this.AQe.style.display=this.Eaa||1===this.JN||!this.TUe&&!this.ysb?"none":"");this.e_&&(this.e_.style.display=this.Eaa||1===this.JN?"none":"",this.dVa(this.fdb),this.e_.title=CommonUIStrings.l_SaveStatusTooltip)}rMh(b,h){b=document.getElementById(Fm.CuiHelper.prm);h&&h.a2o||!b||""===this.VYa||""===this.WYa||""===this.CYa||""===this.RYa||(this.TUe=document.getElementById(Fm.CuiHelper.f4e),this.Kse=Fm.CuiHelper.$Hd(b,"BreadcrumbAppModeDash","-"),this.ysb=Fm.CuiHelper.$Hd(b,"BreadcrumbAppModeStatus",
1===this.JN?this.CYa:this.RYa),this.dEj(this.ysb),this.AQe=Fm.CuiHelper.$Hd(b,"BreadcrumbSaveStatusDash","-"),this.e_=Fm.CuiHelper.$Hd(b,"BreadcrumbSaveStatus",this.VYa),this.dEj(this.e_),this.rrb(this.Eaa,this.JN))}Icd(){this.dVa(!1)}dVa(b){this.fdb=b;this.OWo(this.fdb?this.VYa:this.WYa)}OWo(b){!this.e_||3!==this.JN&&2!==this.JN||(this.H_g&&!this.fdb?(this.Bwb=this.e_.offsetWidth<this.Bwb?this.Bwb:this.e_.offsetWidth,this.kRo(this.WYa),this.H_g=!1):this.e_.innerText=b)}dEj(b){b.style.direction=this.hm?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.hm?"right":"left";b.style.display=this.Eaa?"none":"";b.setAttribute("Unselectable","on")}kRo(b){this.e_&&(this.e_.style.width="",this.e_.innerText=b,this.Bwb=this.e_.offsetWidth<this.Bwb?this.Bwb:this.e_.offsetWidth,b=Kn.a.zB(this.e_),this.e_.style.width=this.Bwb-kc.a.hN(b.paddingLeft)-kc.a.hN(b.paddingRight)+1+"px")}}Object(m.a)(pj,"SaveStatusUIHandler",null,[669]);var Hp=c(94);class po{constructor(){this.BQe=this.EOe=this.RMa=this.W=null}get name(){return"Common.App.SaveStatus"}wc(b){this.W=
b;v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.fY?this.W.register(Yl,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Sd(()=>new Yl(this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"),this.W.Ta("Postmessage.IHostPostmessenger"))):v.AFrameworkApplication.ua.Lb.UGf||(v.AFrameworkApplication.ua.Lb.IJ?this.W.register(Uo,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Sd(()=>
new Uo(this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(pj,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Sd(()=>new pj(Hp.EventHandlerManager.instance,this.W.Ta("Common.App.Header.HeaderEventSource"),this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"),v.AFrameworkApplication.isRtl)))}init(){v.AFrameworkApplication.K.Hn(Object(z.a)(this,this.Wx,"onFullAppSettingsReady"))}Wx(){const b=v.AFrameworkApplication.K,
h=!!v.AFrameworkApplication.ua.Lb&&4===v.AFrameworkApplication.ua.Lb.Nk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.fY?(this.BQe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.BQe.cC():v.AFrameworkApplication.ua.Lb.UGf||v.AFrameworkApplication.hideHeader||
(v.AFrameworkApplication.ua.Lb.IJ?(this.EOe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.EOe.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus"),v.AFrameworkApplication.K):(this.RMa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.RMa.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus")))}dispose(){this.RMa&&this.RMa.f6()}}Object(m.a)(po,"PackageManager",null,[1,2]);var Tl=c(1660);class Fk{get name(){return"Common.App.EventsCachePackage"}wc(){}init(){Tl.a.instance.init()}dispose(){}static main(){M.a.instance.Gc(new Fk)}}
Object(m.a)(Fk,"EventsCachePackage",null,[1,2]);var Yk=c(131),Hh=c(163),qo=c(89),xm=c(625),gg=c(307),jn=c(446),ro=c(286),Le=c(25),Th=c(243),ig=c(24);class Kk{constructor(b){this.PZg=!1;this.nfd=this.sm=null;this.Ire=!1;this.vE=b}get control(){return this.vE}get Rd(){return this.control.Rd}get root(){return this.control.root}get eI(){return this.control.eI}get NZa(){return this.control.NZa}get tk(){return this.control.tk}get $E(){return this.control.$E}YI(){}initialize(){}ax(b,h,u){this.control.Dol(b,
h,u)}Bm(){Le.c(this.control.Gh.Command)||this.vu(this.control.Gh.Command,null,null)}vu(b,h,u){let B=0;this.root&&(B=this.root.Bqa(b,h,u));this.control.enabled=0<(B&1);return B}Y8a(){let b=this.control.visible;this.root.wUa&&(b=this.Rd[Th.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Bfc=!0));return b}oog(){const b=ig.a.Rra(this.Rd[Th.a.labelText],this.control.Gh.LabelText);this.ige(b)}ige(b){this.control.labelText!==b&&(this.$E.forEach(h=>{h.ige(b)}),this.control.labelText=
b,this.root.q5a=!0)}tSb(){const b=ig.a.Rra(this.Rd[Th.a.alt],this.control.Gh.Alt);this.Mkc(b)}Mkc(b){this.control.tooltip!==b&&(this.$E.forEach(h=>{h.Mkc(b)}),this.control.tooltip=b)}ska(){const b=ig.a.Rra(this.Rd[xm.a.Image16by16Class],this.control.Gh.Image16by16Class),h=ig.a.Rra(this.Rd[xm.a.Image32by32Class],this.control.Gh.Image32by32Class);var u=ig.a.Rra(this.Rd[xm.a.Image48by48Class],this.control.Gh.Image48by48Class);u=Le.b(u)?h:u;this.VFc(this.$E.small,b);this.VFc(this.$E.medium,b);this.VFc(this.$E.large,
h);this.VFc(this.$E.rxo,b);this.VFc(this.$E.bec,u)}VFc(b,h){!b||Le.c(b.dR)||Le.c(h)||b.dR.className===h||(b.dR.className=h)}ZSo(b){if(!Le.b(b)&&this.root.Qig){for(const h of this.control.G8e){const u=h.aU===b;u&&(this.control.ZXe=h);this.control.visible&&(h.$A=u)}this.control.visible&&(this.root.q5a=!0)}}Eyk(){if(this.$E.bec&&this.$E.bec.TO&&this.$E.bec.Zgb){const b=this.$E.bec.TO,h=ig.a.Rra(this.Rd[gg.a.Description],this.control.Gh.Description);Le.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-
b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.tk;Object(Cb.a)(jn.a,b)?this.eI.lrb(b):this.root.nCb=this.control;return!1}onBlur(){const b=this.tk;this.control.xJb()&&ig.a.Bw(b.Mc,"cui-ctl-menu-hovered-without-focus");this.root.nCb=null;return!1}GP(b){if(this.control.xJb()){var h=this.eI.tra;const u=h===this.root.cLb-1;h=u?null:this.root.dD[h+1];this.A7e(!1);u||this.control===h||ig.a.Bw(h.iKb,ro.MenuLauncher.G_c);this.control.enabled&&this.control.Lu?u?this.control.bZ():(ig.a.Xf(this.tk.Mc,
"cui-ctl-menu-hovered-without-focus"),h.Xga=this.control.Lu):u?this.eI.setFocus(b.hg):(h.Xga=this.eI.Mc,this.eI.Qqa())}return!1}PJ(){this.control.xJb()&&ig.a.Bw(this.tk.Mc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!Le.c(b.Hb)&&!Le.c(b.Hb.rawEvent)){const u=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;u===Sys.UI.Key.enter&&(h=!0);if(Object(Cb.a)(jn.a,this.tk)){const B=this.eI;if(!Le.c(B)){const Q=B.tra,ca=0===this.root.J1,qa=!Le.c(this.control.Yxn);if(u!==Sys.UI.Key.tab&&u!==
Sys.UI.Key.left&&u!==Sys.UI.Key.right&&u!==Sys.UI.Key.up&&u!==Sys.UI.Key.down&&u!==Sys.UI.Key.esc)return h;Qd.a.c7e();u!==Sys.UI.Key.tab||b?u===Sys.UI.Key.tab&&b?(B.bL(1),h=!0):u===Sys.UI.Key.left&&ca||u===Sys.UI.Key.right&&!ca?(qa?B.bL(2):0<Q&&this.root.V_a(Q,!0,!1),h=!0):u===Sys.UI.Key.right&&ca||u===Sys.UI.Key.left&&!ca?(qa&&B.bL(4),h=!0):u===Sys.UI.Key.up?(B.bL(5),h=!0):u===Sys.UI.Key.down?(B.bL(6),h=!0):u===Sys.UI.Key.esc&&(this.root.V_a(Q,!0,!1),h=!0):(B.bL(0),h=!0)}}}return h}Qy(b){let h=!1;
if(!Le.c(b.Hb)&&!Le.c(b.Hb.rawEvent)){const u=b.Hb.keyCode;Nb.KeyInputManager.Xli(b)||u!==Sys.UI.Key.enter&&u!==Sys.UI.Key.space||(h=this.Owf(b),h||(this.ax(b.uf,1,b.Hb),h=!0))}return h}eD(b){this.v8e();if(this.NZa){let h=!0;2===b.hg&&(h=b.mda===Sys.UI.MouseButton.leftButton);h&&this.tk&&this.iAd(this.tk.Mc)}(b.Hb.type.toLowerCase()!==Kd.a.YP||this.NZa)&&b.Hb.preventDefault();return!1}get xCf(){return this.PZg}$sl(){this.PZg=!0}v8e(){this.xCf&&this.control.root.Kfb()}mya(b){Object(Cb.a)(jn.a,this.tk)&&
!this.NZa&&2===b.hg&&b.mda===Sys.UI.MouseButton.leftButton?(this.ax(b.uf,b.hg,b.Hb),b=!0):b=this.control.Gva(b);return b}onClick(b){let h=!1;Object(Cb.a)(jn.a,this.tk)&&!this.NZa&&3===b.hg&&(this.ax(b.uf,b.hg,b.Hb),h=!0);return Z.a.ri?!1:h}vnb(b){return this.L5d(b)}nHa(b){this.Gva(b);return!1}L5d(b){return Le.c(this.sm)?!1:(this.pbg(Qd.a.y_d(this.$lh,b.clientPoint)),!0)}kgc(b){let h=!1;this.Gva(b)&&(h=!0);3!==b.hg&&(b=!0,!this.root&&Kk.USf&&(r.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),
b&&this.root.S3(),h=!0);return h}ngc(b){return this.Gva(b)}lgc(b){return this.L5d(b)}mgc(b){return this.Gva(b)}igc(b){return 3===b.hg?(this.root.S3(),!0):!1}jgc(){return!1}get $lh(){!Le.c(this.sm)&&Le.c(this.nfd)&&(this.nfd=Qd.a.getElementBounds(this.sm));return this.nfd}pbg(b){this.Ire!==b&&(this.Ire=b,this.$Xe(this.Ire))}$Xe(b){Le.c(this.sm)||ig.a.b6(this.sm,qo.Control.lAd,b)}iAd(b){this.control.enabled&&(this.sm=b,this.root.TEc=this.control,this.pbg(!0),this.root.pga(this.control,!1))}Gva(b){if(!Le.c(this.sm)){this.pbg(!1);
let h=!!this.root;if(Kk.USf){const u=dd.ActionManager.mba(parseInt(this.control.Gh.Command))||"";r.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,u)}h&&this.root.Yba(this.control,!1);Le.c(b)||Qd.a.y_d(this.$lh,b.clientPoint)&&this.ax(this.sm,b.hg,b.Hb);h=!!this.root;Kk.USf&&r.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.TEc=null);this.nfd=this.sm=null;return!0}return!1}bL(b){return Object(Cb.a)(jn.a,this.tk)&&2!==b&&4!==b&&!Qd.a.pbc(this.control.Lu)?
this.bZ():!1}bZ(){try{if(this.control.visible){const b=this.control.Lu;if(!Le.c(b))return b.focus(),!0}}catch(b){}return!1}A7e(b){const h=this.eI;Le.c(h)||this.root.V_a(h.tra+1,b)}iqa(){}Owf(){return!1}YX(b){let h=null;b&&b.rawEvent&&(h={},h[Kk.triggerTime]=b.rawEvent.timeStamp);return h}static get USf(){null==Kk.KKe&&(Kk.KKe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Kk.KKe}}Kk.triggerTime="TriggerTime";Kk.KKe=null;Object(m.a)(Kk,
"ControlBehavior",null,[678]);var Lk=c(183);class Ln extends Kk{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Gh}YI(b){const h=b.Tm;b=b.aU;Le.c(h)||(Ue.a.instance.ob(Kd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),Ue.a.instance.ob(Kd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),Hh.a.instance.ob(Kd.a.pointerOver,h,Object(z.a)(this,this.GP,"onPointerOver")),Hh.a.instance.ob(Kd.a.pointerOut,h,Object(z.a)(this,this.PJ,"onPointerOut")),Nb.KeyInputManager.instance.jE(Kd.a.$h,
h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),Nb.KeyInputManager.instance.jE(Kd.a.qu,h,Object(z.a)(this,this.PG,"onKeyPress"),b),Nb.KeyInputManager.instance.jE(Kd.a.sh,h,Object(z.a)(this,this.Qy,"onKeyUp"),b),Hh.a.instance.ob(Kd.a.pointerDown,h,Object(z.a)(this,this.eD,"onPointerDown")),Hh.a.instance.ob(Kd.a.iN,h,Object(z.a)(this,this.mya,"onPointerUp")),Wi.a.instance.ob(Kd.a.click,h,Object(z.a)(this,this.onClick,"onClick")),Lk.a.instance.ob(Kd.a.XP,h,Object(z.a)(this,this.vnb,"onTouchMove")),
Lk.a.instance.ob(Kd.a.eK,h,Object(z.a)(this,this.nHa,"onTouchEnd")))}ax(b,h,u){this.control.enabled&&(b=null,this.tk&&this.tk.qWc()&&this.eI&&(b=this.root.dD[this.eI.tra])&&!this.xCf&&(b.HTa(this.button),b=null),this.executeCommand(this.control.Gh.Command,h,!0,u),b&&b.HTa(this.button))}executeCommand(b,h,u,B){if(!Le.c(b)){const Q=this.Rd;Q.CommandValueId=this.button.kFb();Q.MenuItemId=this.button.Gh.MenuItemId;Q.SourceControlId=this.control.id;this.root.executeCommand(b,Q,this.tk,h,u,null,this.YX(B))}}Bm(){Le.c(this.control.Gh.Command)||
0<(this.vu(this.properties.Command,this.properties.QueryCommand,this.Rd)&2)&&this.Y8a()&&this.aVa()}aVa(){this.oog();this.tSb();this.ska()}onFocus(b){super.onFocus(b);this.Hhg();return!1}onBlur(b){super.onBlur(b);this.Vgf();return!1}onKeyDown(b){let h=super.onKeyDown(b);Le.c(b.Hb)||this.zeg(b.Uo,b.Hb.keyCode)&&(h=!1);return h}PG(b){let h=!1;Le.c(b.Hb)||Le.c(b.Hb.rawEvent)||(this.zeg(b.Uo,b.Hb.rawEvent.keyCode)?(this.ax(b.uf,b.hg,b.Hb),h=!0):b.Hb.preventDefault());return h}zeg(b,h){if(Z.a.Kt&&h===
Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Qy(b){let h=!1;Le.c(b.Hb)||this.zeg(b.Uo,b.Hb.keyCode)||(h=super.Qy(b));return h}Hhg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}Vgf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(m.a)(Ln,"ButtonBehavior",Kk,[]);var zg=c(993);class ka{}ka.Color="Color";ka.IndexColorSelected="ColorSelected";Object(m.a)(ka,
"ColorPickerCommandProperties",null,[]);class db extends Kk{constructor(b){super(b);this.jCc=this.Bv=-1}get WBb(){return this.control}get dOa(){return this.WBb.RZk.dOa}get properties(){return this.WBb.Gh}ax(b,h,u){if(this.control.enabled){const B=this.Rd;B.Color=db.eSd(b)[zg.ColorPicker.XFd];b=null;ig.a.Yr(this.properties.Stateful)&&this.tk&&this.tk.qWc()&&this.eI&&(b=this.root.dD[this.eI.tra]);this.root.executeCommand(this.properties.Command,B,this.tk,h,!0,null,this.YX(u));b&&b.HTa(this.WBb)}}Bm(){var b=
this.Rd;b.SourceControlId=this.properties.Id;if(0<(this.vu(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,ka.IndexColorSelected in this.Rd&&(b=this.Rd[ka.IndexColorSelected]),b!==this.jCc)){const h=this.dOa;0<=b&&b<h.length&&this.sDj(h[b],!0);0<=this.jCc&&this.jCc<h.length&&this.sDj(h[this.jCc],!1);this.jCc=b}}sDj(b,h){h?ig.a.Xf(b,"cui-colorpicker-selected"):ig.a.Bw(b,"cui-colorpicker-selected")}YI(b){for(let h=0;h<b.FXe.length;++h){const u=b.FXe[h];Ue.a.instance.ob(Kd.a.focus,
u,Object(z.a)(this,this.nUf,"onCellFocus"));Ue.a.instance.ob(Kd.a.blur,u,Object(z.a)(this,this.yjn,"onCellBlur"));Nb.KeyInputManager.instance.ob(Kd.a.$h,u,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.sh,u,Object(z.a)(this,this.Qy,"onKeyUp"));Wi.a.instance.ob(Kd.a.click,u,Object(z.a)(this,this.zjn,"onCellClick"));Hh.a.instance.ob(Kd.a.iN,u,Object(z.a)(this,this.pUf,"onCellPointerUp"));Hh.a.instance.ob(Kd.a.pointerOver,u,Object(z.a)(this,this.oUf,"onCellPointerOver"));
Hh.a.instance.ob(Kd.a.pointerDown,u,Object(z.a)(this,this.Ajn,"onCellPointerDown"))}}nUf(b){b=db.eSd(b.uf);this.eI.lrb(this.tk);this.cne(b,!0);return!0}yjn(b){this.cne(db.eSd(b.uf),!1);return!0}cne(b,h){h?(this.Bv=parseInt(b.getAttribute("arrayPosition")),ig.a.Xf(b,"cui-colorpicker-hoveredOver"),this.Hhg(b)):(this.Bv=-1,this.Vgf(b),ig.a.Bw(b,"cui-colorpicker-hoveredOver"))}zjn(b){3===b.hg&&this.ax(b.uf,b.hg,b.Hb);return!0}pUf(b){3!==b.hg&&this.ax(b.uf,b.hg,b.Hb);return!0}oUf(b){this.A7e(!1);b=parseInt(db.eSd(b.uf).getAttribute("arrayPosition"));
this.y8c(b);return!0}Ajn(){return!1}Hhg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!Le.b(h)){const u=this.Rd;u.Color=b[zg.ColorPicker.XFd];this.root.executeCommand(h,u,this.tk,0,!1)}}}Vgf(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!Le.b(h)){const u=this.Rd;u.Color=b[zg.ColorPicker.XFd];this.root.executeCommand(h,u,this.tk,0,!1)}}}bL(b){b=qo.Control.Jkf(this.Bv,this.WBb.width,this.dOa.length,b);if(b!==this.Bv&&this.y8c(b))return!0;this.cne(this.dOa[this.Bv],
!1);return!1}bZ(){return this.y8c(0)}y8c(b){return this.dOa&&this.dOa.length>b&&(b=this.dOa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}iqa(){-1!==this.Bv&&this.cne(this.dOa[this.Bv],!1)}static eSd(b){return db.v3l(b)}static v3l(b){var h=["td"];const u=h.length;if(!b)return null;for(var B=0;B<u;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;for(b=b.parentNode;b;){for(B=0;B<u;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;b=b.parentNode}return null}}Object(m.a)(db,"ColorPickerBehavior",
Kk,[]);var Gb=c(337),cc=c(294),xc=c(1684),Vc=c(695),Wd=c(372),re=c(1133);class od{constructor(b,h){this.ukk=b;this.zZg=h}Rfe(b,h,u,B){if(Le.c(b)||Le.c(h))return null;const Q=new re.a;const ca=B.x;var qa=B.y;const Qa=B.width;var rb=B.height;let Lb;od.n6b(h,"flyoutWidth");B=od.n6b(h,"flyoutRealHeight");const Yb=od.n6b(h,"viewportWidth");var gc=od.n6b(h,"viewportHeight"),Fc=od.n6b(h,"viewableLeft");const Sc=od.n6b(h,"viewableTop"),ld=this.ukk;let Hd=!1,Ie=!1;const fe=1===u,de=4===u,ne=this.zZg;b.style.maxHeight=
"none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Lb=this.FMi(b);Q.wIj=gc;Q.hqg=Yb;if(fe)ld?h=ca+Qa:(h=ca-Lb,Q.Ilb=!0),rb=qa;else{var ye="";Qa>Lb&&(Lb=Qa,ye=(Lb-2*Wd.Menu.L3d).toString());ld?h=ca:(h=ca+Qa-Lb,Q.Ilb=!0);rb=qa+rb;""!==ye&&(b.style.minWidth=ye+"px")}ne&&(rb+=Sc,h+=Fc);b.style.top=rb+"px";b.style.left=h+"px";let Vf=!1;ye=!1;Lb<=Yb?h+Lb>Fc+Yb?(fe&&ld&&ca-Lb>Fc||de&&ca-Lb>Fc?(h=ca-Lb,ne&&(h+=Fc),ye=Q.Ilb=!0):(h=Fc+Yb-Lb,Hd=!0),Vf=!0):h<Fc&&(fe&&!ld&&ca+Qa+Lb<Fc+Yb?
(h=ca+Qa,ne&&(h+=Fc),Q.Ilb=!1,ye=!0):(h=Fc,Ie=!0,Q.Ilb=!0),Vf=!0):ld?(h=Fc,Vf=!0,Q.Ilb=!0):(h=Fc+Yb-Lb,Vf=!0,Q.Ilb=!1);Vf&&(b.style.left=h+"px");Q.Z7b=rb;rb+B<=Sc+gc&&3!==u||(Q.gJf=!0,{ien:u,jFl:qa,IKm:gc,FRm:Fc}=this.ikf(u,rb,B,qa,Sc,gc),rb!==u&&(b.style.top=u+"px",Q.Z7b=u),-1<qa&&(b.style.maxHeight=qa+"px"),gc&&(b.style.bottom="0px",b.style.height="auto"),Fc&&this.s7m(b,ld,fe,ye,Ie,Hd,Yb,ca,Qa));Q.YNc=h;Q.Fkf=Lb;Q.Bkf=B;return Q}ikf(b,h,u,B,Q,ca){let qa,Qa,rb;qa=-1;rb=Qa=!1;const Lb=h,Yb=Q+ca-h;
h=B-u;const gc=this.zZg;let Fc=!1;0>h&&(h=Q);gc||(B-=Q);u<=B&&1!==b||(4===b||1===b?u<ca?(h=ca-u,Qa=!0):(h=Q,Fc=rb=Qa=!0):(B<Yb&&3!==b?(h=Lb,Qa=!0):qa=B,rb=!0));gc&&(Qa=!1,Fc?qa=ca:h+=Q);return{ien:h,jFl:qa,IKm:Qa,FRm:rb}}s7m(b,h,u,B,Q,ca,qa,Qa,rb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ca||B)b.style.left="",b.style.right=(ca?0:qa-Qa)+"px"}else Q||B||(b.style.left="",b.style.right=(u?qa-Qa:qa-Qa-rb)+"px")}JTl(b){const h={};if(Le.c(b))return h;h.viewportWidth=kc.a.NGb();h.viewportHeight=
kc.a.ZX();Le.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);Le.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;Le.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);Le.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,
h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*Wd.Menu.L3d:b.scrollHeight;const u=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.FMi(b);b.style.overflowY=u;return h}FMi(b){return b.offsetWidth}static n6b(b,h){return Le.c(b)?0:b[h]}}Object(m.a)(od,"MenuPositioner",null,[]);var Be=c(510),ve=c(607),Wf=c(1135),lg=c(1134),Kh=c(1131),Vg=c(1132),Gk=c(1137),wl=c(385),el=c(991);class Ki extends Kk{constructor(b){super(b);this.GJe=
0;this.A2g=null;this.cNe=-1;this.Ejd=null;this.$_f=this.rWg=!1;this.l$j=new od(0===this.root.J1,ig.a.Yr(this.root.properties.DivSyndicated))}get WMi(){return this.l$j}get Ru(){return this.control}get properties(){return this.control.Gh}get menu(){return this.Ru.menu}set menu(b){this.Ru.menu=b}get tL(){return this.Ru.tL}set tL(b){this.Ru.tL=b}get ovh(){Le.c(this.Ejd)&&(this.Ejd=Ki.$9k());return this.Ejd}get ipj(){let b=!this.root.Bzf;Object(Cb.a)(326,this.root)&&1===this.root.cLb&&(b=!0);return b}ax(b,
h){Object(Cb.a)(326,this.root)&&this.root.ohf();this.Ru.J0(h)}J0(b){if(this.Ru.enabled&&!this.tL){var h=Wh.a.instance.Ap(Za.a.J0);h.properties.add("Id",this.Ru.Gh.Id);h.properties.add("InputMethod",Gb.a[b]);h.end();Gj.a.mark(10326);Qd.a.I3d(this.Ru.Gh.Id,"MenuOpen");this.Ru.Lu&&(this.Ru.Xga=Qd.a.dib(this.Ru.Lu.ownerDocument));this.GJe=b;this.S0i(b);this.hfe();this.Ru.P8a(this.Ru.Lu,!0)}}hfe(){Le.c(this.properties.PopulateAsyncTriggerCommand)||this.rWg||(this.Ufn(),this.rWg=!0)}Ufn(){const b={};b[xc.a.Callback]=
Object(z.a)(this,this.l7i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.tk,0,!1)}l7i(){this.Ru.aTa()}aTa(){this.tL&&this.S0i(this.GJe,!0)}S0i(b,h=!1){var u=!0;if(ig.a.Yr(this.properties.PopulateDynamically)){u=!1;const B=this.a3c(b);B!==this.A2g&&(u=this.p0f(B,h));u=u||!this.tL}u&&(h=v.AFrameworkApplication.ua.Iq,u=null,h&&(u=h.Vf("LoadResource","Menu Initialization")),this.HFa(b),u&&u.stop(),this.X6d())}HFa(b){if(!Le.c(this.menu)){if(this.Ru.Z5a){var h=
this.Ru.tk;if(h&&h.keytip){var u=h.keytip.key.toLocaleLowerCase();this.menu.rjo(String.format("{0} {1}",this.Ru.Z5a,h.keytip.tgf),this.Ru.ESa&&""!==this.Ru.ESa?String.format("{0}-{1}",this.Ru.ESa,u):u)}}this.menu.Una();ig.a.Xf(this.menu.Mc,this.Ru.F_e);ig.a.b6(this.menu.Mc,"cui-touch",3===b||this.root.Lle);if(this.menu.hasItems()){this.menu.YI();h=this.tk;h.RVh();h.iTc=!0;h.xf(this.menu);h.iTc=!1;this.menu.O0i();u=Object(Cb.a)(el.a,this.root);var B=null,Q=!1;u&&(B=this.root,Q=B.H7a,B.H7a=!1);var ca=
this.menu.Mc;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";Z.a.Kt&&!Z.a.Lkb&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.Iyk();this.DCn(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.Sok();ig.a.Xf(this.Ru.iKb,ro.MenuLauncher.G_c);var qa=this.root.cLb;this.Zpo&&this.root.pga(this.control,!0);ca.style.zIndex=String(v.AFrameworkApplication.ua.sua);this.root.zrk(this.Ru);this.menu.tra=qa;ca.style.visibility=
"visible";qa=this.j5h();if(Object(Cb.a)(Vg.a,this.menu)){ca.style.position="fixed";const Qa=this.root.dD[0];Qa&&Qa.menu&&Qa.menu.Mc?100!==Qd.a.zQc(this.root.dD[0].menu.Mc)&&cc.a.Zfg(ca,qa,Object(z.a)(this,this.Q_e,"afterShowMenu")):cc.a.Zfg(ca,qa,Object(z.a)(this,this.Q_e,"afterShowMenu"))}else cc.a.Zfg(ca,qa,Object(z.a)(this,this.Q_e,"afterShowMenu"));this.tL=!0;this.menu.fJf=!0;!Z.a.ri&&this.Ru.kbo&&this.menu.setFocus(b);u&&(B.H7a=Q);u=this.properties.CommandMenuOpen;Le.b(u)||this.root.executeCommand(u,
null,h,b,!1)}}Gj.a.mark(10327)}X6d(){}Sok(){this.cNe=ig.a.DBb(this.cNe);this.cNe=window.setTimeout(Object(z.a)(this,this.Tok,"addAndPositionBackFrameInternal"),50)}Tok(){this.menu&&this.menu.Mc&&(document.body.appendChild(this.ovh),this.zCn())}zCn(){const b=this.ovh;var h=this.menu.Mc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let u=h.offsetWidth;h=h.offsetHeight;Z.a.Lkb&&(u-=4,
h-=4);b.style.width=u.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get Zpo(){return this.root.cLb?!1:!0}Q_e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Mc===b.element&&Object(Cb.a)(Kh.a,this.menu)&&cc.a.AAk(this.j5h()))}j5h(){const b=this.menu.children,h=[];if(Object(Cb.a)(Kh.a,this.menu))for(let u=0;u<b.count;u++){const B=b.J(u);Array.add(h,B.separator);for(let Q=0;Q<B.children.count;Q++){const ca=B.children.J(Q);Array.add(h,
ca.Mc)}}return h}Iyk(){var b=this.menu.children;for(let u=0;u<b.count;u++){const B=b.J(u).children;for(let Q=0;Q<B.count;Q++){var h=B.J(Q);if(Object(Cb.a)(jn.a,h)){const ca=h;if("Menu32"===ca.aU||"Menu48"===ca.aU)h=h.control,h.behavior&&(Object(Cb.a)(ve.a,h)||Object(Cb.a)(lg.a,h))&&h.behavior.Eyk()}}}0<b.count&&(b=b.J(0),Le.c(b.separator)||(b.separator.style.display="none"),Le.c(b.ple)||ig.a.Xf(b.ple,"cui-menusection-titleAtTop"))}DCn(b){if(!Le.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom=
"";b.style.right="";b.style.width="";b.style.minWidth="";var h=Vc.a.create();try{const u=this.WMi.JTl(b),B=this.iQc();let Q=this.root.Rfe(b,u,this.Ru.M3d,B);Q||(Q=this.WMi.Rfe(b,u,this.Ru.M3d,B));this.root.XMi=Q}finally{h&&h.dispose()}}}iQc(){const b=Qd.a.getElementBounds(this.Ru.iKb);var h=this.eI;Le.c(h)||Le.c(h.Mc)||(h=Qd.a.getElementBounds(h.Mc),b.x=h.x+Wd.Menu.L3d,b.width=h.width-2*Wd.Menu.L3d);Object(Cb.a)(wl.a,this.Ru.v1d)&&(b.height=0);return b}ava(){if(this.Ru.tL){r.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Ru.Gh.Id});this.menu.iqa();this.L9i();this.tL=!1;this.menu.fJf=!1;this.root.Yba(this.control,!0);this.ipj?v.AFrameworkApplication.ua.Q6c(this.Ru.Xga,this.GJe):this.l5n();this.Ru.Xga=null;var b=this.Ru.iKb;ig.a.Bw(b,ro.MenuLauncher.G_c);this.Ru.P8a(this.Ru.Lu,!1);ig.a.Bw(b,"cui-ctl-menu-hovered-without-focus");this.menu.Qqa();Le.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.tk,0,!1);this.K9i()}}l5n(){const b=
this.Ru.Xga;if(b)try{b.focus()}catch(h){}}K9i(){kc.a.ox(this.menu.Mc);kc.a.ox(this.Ejd);ig.a.Tza(this.menu.Mc)}a3c(b){if(this.$_f&&ig.a.Yr(this.properties.PopulateOnlyOnce)||Le.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Ru.Lnf();return 0<(this.root.Bqa(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}p0f(b,h=!1){if(this.$_f&&ig.a.Yr(this.properties.PopulateOnlyOnce))return!0;let u=null;this.A2g=
b;Le.c(b)||(u=this.ial(b));Le.c(u)||(this.$_f=!0);if(h){this.root.UWk(this.Ru);if(Le.c(u)||!u.hasItems())return this.ava(),!1;this.L9i();this.K9i()}this.uio(u);return!0}nTi(){}ial(b){b=Be.Builder.CIh(b);if(!Le.c(b)){const h=new Gk.a;h.XDh=!0;h.parentId=this.control.id;let u;u=Object(Cb.a)(Wf.a,this.control);return this.root.uO.z_a(b,h,u)}return null}uio(b){Le.c(b)||(Le.c(this.menu)||this.menu.dispose(),this.menu=b,this.nTi())}L9i(){const b=this.menu.parent;b?(b.iTc=!0,b.removeChild(this.menu.id),
b.iTc=!1):r.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;Le.c(b.Hb)||Le.c(b.Hb.rawEvent)||Object(Cb.a)(jn.a,this.tk)||!b.Hb.rawEvent.altKey||b.Hb.keyCode!==Sys.UI.Key.down||(this.ax(b.uf,1,b.Hb),h=!0);h||(h=super.onKeyDown(b));return h}eD(b){this.v8e();2===b.hg&&b.mda!==Sys.UI.MouseButton.leftButton||this.ax(b.uf,b.hg,b.Hb);b.Hb.preventDefault();return!1}Owf(b){if(!this.eI||!this.eI.inKeytipMode||!this.Ru.AUi)return!1;this.Ru.AUi(this.tk,
b);return!0}static $9k(){const b=ig.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(m.a)(Ki,"MenuLauncherBehavior",Kk,[704,678]);var xj=c(925);class Hk extends Ki{constructor(b){super(b)}get nt(){return this.PLc.properties}get PLc(){return this.control}get IOa(){return this.PLc.IOa}YI(){Hh.a.instance.ob(Kd.a.pointerDown,this.IOa.Tm,Object(z.a)(this,this.eD,"onPointerDown"));Nb.KeyInputManager.instance.ob(Kd.a.$h,this.IOa.Tm,
Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.sh,this.IOa.Tm,Object(z.a)(this,this.Qy,"onKeyUp"))}Bm(){const b=this.Rd[xj.a.SelectedItemId];if(0<(this.vu(this.nt.Command,this.nt.QueryCommand,this.Rd)&2)){const h=this.Rd[xj.a.SelectedItemId];Le.c(h)||b===h||this.PLc.O7c(h)||(this.Rd[xj.a.SelectedItemId]=null)}}}Object(m.a)(Hk,"DropDownBehavior",Ki,[]);var Zh=c(524),Ho=c(706);class Xh extends Hk{constructor(b){super(b);this.KWa=null;this.pKe=this.xvb=this.GBa=!1;
this.sAc=null;this.qAc=-1}get T3(){return this.control}get QQ(){return this.T3.QQ}get DH(){return this.T3.DH}get lZd(){return this.Rd[Zh.a.IsFreeForm]}set lZd(b){this.Rd[Zh.a.IsFreeForm]=b}YI(b){Hh.a.instance.ob(Kd.a.pointerDown,b.Tm,Object(z.a)(this,this.eD,"onPointerDown"));const h=b.ur;Ue.a.instance.ob(Kd.a.focus,h,Object(z.a)(this,this.fnb,"onInputFocus"));Ue.a.instance.ob(Kd.a.blur,h,Object(z.a)(this,this.iya,"onInputBlur"));Nb.KeyInputManager.instance.ob(Kd.a.$h,h,Object(z.a)(this,this.gnn,
"onInputKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.qu,h,Object(z.a)(this,this.hnn,"onInputKeyPress"));vf.a.instance.ob(Kd.a.oda,h,Object(z.a)(this,this.FVf,"onInputMouseUp"));Hh.a.instance.ob(Kd.a.pointerDown,h,Object(z.a)(this,this.jnn,"onInputPointerDown"));Hh.a.instance.ob(Kd.a.pointerDown,b.vUh,Object(z.a)(this,this.dWf,"onMenuButtonPointerDown"))}Bm(){0<(this.vu(this.DH.Command,this.DH.QueryCommand,this.Rd)&2)&&(this.xvb||this.DGj(),this.BTo())}nTi(){this.T3.menuItems=null;var b;var h=b=
null;if(!Le.c(this.menu)){this.ufe();for(let B of this.menu.children)for(let Q of B.children)if(Object(Cb.a)(jn.a,Q)){var u=Q;u=u.control;Object(Cb.a)(690,u)&&(b=u,b=b.Gh.MenuItemId);Object(Cb.a)(675,u)&&(h=u,h=h.E2a());Le.c(b)||Le.c(h)||(this.T3.menuItems[h]=b,b=h=null)}}}jnn(b){Object(Cb.a)(326,this.root)&&2===b.hg&&(this.KWa=Qd.a.dib(this.control.Lu.ownerDocument),this.control.Lu.focus());return!1}eD(b){this.v8e();let h=!1;3===b.hg&&(h=super.eD(b),this.ufe());h&&b.Hb.preventDefault();return!1}dWf(b){let h=
!1;if(2!==b.hg||b.mda===Sys.UI.MouseButton.leftButton)this.ax(b.uf,b.hg,b.Hb),this.ufe(),h=!0;h&&b.Hb.preventDefault();return!1}gnn(b){let h=!1;if(!Le.c(b.Hb)&&!Le.c(b.Hb.rawEvent)){const u=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;ig.a.Yr(this.DH.AutoComplete);if(u===Sys.UI.Key.enter)this.OT(),this.h9f(),Object(Cb.a)(Ho.Ribbon,this.root)&&this.root.Z_(),h=!0;else if(u===Sys.UI.Key.tab){if(this.OT(),this.h9f(),Object(Cb.a)(Ho.Ribbon,this.root)&&(h=this.root.fpe(this.tk.Mc,!b)),Object(Cb.a)(326,this.root))return!0}else u===
Sys.UI.Key.backspace||u===Sys.UI.Key.del?this.control.enabled?(this.J5e(),this.sAc=null):h=!0:u===Sys.UI.Key.esc?(this.l9f(),this.h9f(),Object(Cb.a)(Ho.Ribbon,this.root)&&this.root.Z_(),h=!0):u===Sys.UI.Key.down&&(this.J0(1),this.ufe(),h=!0)}return h}hnn(b){if(!this.control.enabled)return!0;!Le.c(b.Hb)&&b.Hb.charCode&&this.Bhl();return!1}FVf(){return this.GBa?!1:this.GBa=!0}Iwl(){this.qAc=-1;const b=this.QQ.ur,h=b.value,u=this.mWl(h);if(u){b.value=u.key;if(b.setSelectionRange)b.setSelectionRange(h.length,
b.value.length);else if(b.createTextRange){const B=b.createTextRange();B.moveStart("character",h.length);B.moveEnd("character",b.value.length);B.select()}this.sAc=u.value}else this.sAc=null}mWl(b){const h=this.T3.menuItems;for(let u in h){const B={key:u,value:h[u]};if(B.key.toLowerCase().startsWith(b.toLowerCase()))return B}return null}Bhl(){ig.a.Yr(this.DH.AutoComplete)&&-1===this.qAc&&(this.pKe&&(this.a3c(0),this.pKe=!1),this.qAc=window.setTimeout(Object(z.a)(this,this.Iwl,"executeAutoComplete"),
this.T3.LGk))}J5e(){ig.a.Yr(this.DH.AutoComplete)&&(this.qAc=ig.a.DBb(this.qAc))}fnb(b){if(this.tL)return this.menu.setFocus(0),!0;Object(Cb.a)(326,this.root)&&(hd.FocusManager.instance().iD("ribbon"),this.root.uSc=!1);this.onFocus(b);this.xvb=!0;ig.a.Xf(this.QQ.Tm,"cui-cb-focus");ig.a.Yr(this.DH.PopulateDynamically)&&(this.pKe=!0);Qd.a.K7c(this.QQ.ur);Le.c(this.menu)||this.menu.Cm();return this.GBa=!1}iya(){this.xvb=!1;this.OT();ig.a.Bw(this.QQ.Tm,"cui-cb-focus");return!1}h9f(){Object(Cb.a)(326,
this.root)&&(void 0!==this.KWa&&null!==this.KWa&&v.AFrameworkApplication.ua.Q6c(this.KWa,2),this.KWa=null)}OT(){if(this.control.enabled){this.J5e();var b=this.QQ.ur;if(void 0===this.Rd[Zh.a.Value]||null===this.Rd[Zh.a.Value]||b.value!==this.Rd[Zh.a.Value].toString())if(this.T3.O7c(this.sAc))this.lZd=!1,this.Rd[Zh.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.T3.T7c.kFb(),["MenuItemId"]:this.T3.T7c.Gh.MenuItemId},this.root.executeCommand(this.DH.Command,b,this.tk,0,!1);else{if(!ig.a.Yr(this.DH.AutoComplete)){var h=
this.T3.menuItems[b.value];if(!Le.b(h)&&this.T3.O7c(h)){this.lZd=!1;this.Rd[Zh.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.T3.T7c.kFb(),["MenuItemId"]:h};this.root.executeCommand(this.DH.Command,b,this.tk,0,!1);return}}h=!Le.b(b.value)&&""!==F.a.Uya(b.value);this.T3.crh&&h?(this.lZd=!0,this.Rd[Zh.a.Value]=b.value,this.root.executeCommand(this.DH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.tk,0,!1)):this.l9f()}}else this.l9f()}l9f(){this.J5e();this.sAc=null;this.DGj()}DGj(){const b=
this.Rd[Zh.a.Value]||"";b!==this.QQ.ur.value&&(this.QQ.ur.value=b);this.T3.O7c(this.T3.menuItems[b])}BTo(){const b=this.Rd[Zh.a.FontStyle]||"normal";b!==this.QQ.ur.style.fontStyle&&(this.QQ.ur.style.fontStyle=b)}ufe(){this.control.Lu&&this.menu&&this.control.Lu.setAttribute(af.a.juh,this.menu.id)}}Object(m.a)(Xh,"ComboBoxBehavior",Hk,[]);class Mm extends Ki{constructor(b){super(b)}get kHd(){return this.control}iQc(){let b=0;this.menu&&this.menu.Mc&&2===this.menu.horizontalAlignment&&(b=this.menu.Mc.clientWidth);
return new Sys.UI.Bounds(this.kHd.x-b,this.kHd.y,this.kHd.iJf,this.kHd.hJf)}}Object(m.a)(Mm,"ContextMenuLauncherBehavior",Ki,[]);class Mn extends Ki{constructor(b){super(b)}get hKd(){return this.control}iQc(){return new Sys.UI.Bounds(this.hKd.x,this.hKd.y,this.hKd.iJf,this.hKd.hJf)}}Object(m.a)(Mn,"DialogMenuLauncherBehavior",Ki,[]);var wj=c(606);class cn extends Ki{constructor(b){super(b);this.sKe=!1;this.Thk=!ig.a.bia(this.nt.ShouldRefreshWhenDropped)}get IEa(){return this.control}get nt(){return this.control.Gh}YI(b){b=
b.Tm;Le.c(b)||(Ue.a.instance.ob(Kd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),Ue.a.instance.ob(Kd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),Hh.a.instance.ob(Kd.a.pointerOver,b,Object(z.a)(this,this.GP,"onPointerOver")),Nb.KeyInputManager.instance.ob(Kd.a.$h,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),Nb.KeyInputManager.instance.ob(Kd.a.sh,b,Object(z.a)(this,this.Qy,"onKeyUp")),Hh.a.instance.ob(Kd.a.pointerDown,b,Object(z.a)(this,this.eD,"onPointerDown")))}Bm(){Le.c(this.control.Gh.Command)||
(this.IEa.tL&&!this.Thk?this.sKe=!0:(0<(this.vu(this.nt.Command,this.nt.QueryCommand,this.Rd)&2)&&this.Y8a()&&this.aVa(),ig.a.Yr(this.nt.RefreshableMenu)&&this.tL&&this.menu.rBn()))}aVa(){this.yTo();this.ska();this.nUo();this.IEa.kzf=this.Rd[wj.a.ImageIsVisible]}yTo(){const b=ig.a.Rra(this.Rd[wj.a.LabelText],this.nt.LabelText),h=this.Rd[wj.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.nt.LabelTextUserGeneratedPlaceholderReplacements!==h)this.$E.medium&&this.zTo(this.$E.medium.TO,
b,h),this.root.q5a=!0,this.control.labelText=b,this.nt.LabelTextUserGeneratedPlaceholderReplacements=h}zTo(b,h,u){const B=b.lastChild;ig.a.ijj(b,h+" ",u);h=Le.c(B);r.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":B.nodeType.toString());h||b.appendChild(B)}nUo(){const b=this.Rd[wj.a.ImageBackColor];this.$E.forEach(h=>{cn.GCk(h.dR,b)})}J0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(v.AFrameworkApplication.Spa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),
v.AFrameworkApplication.va.processAction(Za.a.lKd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||v.AFrameworkApplication.va.processAction(Za.a.lKd,2);Object(Cb.a)(jn.a,this.tk)&&(this.tL||this.A7e(!0),this.control.enabled&&this.bZ());super.J0(b)}ava(){super.ava();this.sKe&&(this.sKe=!1,this.Bm())}GP(b){return this.control.xJb()?(this.IEa.tL?(this.root.lAh(),ig.a.Xf(this.IEa.iKb,ro.MenuLauncher.G_c),this.IEa.Xga=
this.control.Lu):(super.GP(b),this.ax(b.uf,b.hg,b.Hb)),!1):super.GP(b)}onKeyDown(b){let h=!1;if(!Le.c(b.Hb)&&!Le.c(b.Hb.rawEvent)){if(Object(Cb.a)(jn.a,this.tk)){const u=b.Hb.rawEvent,B=b.Hb.keyCode,Q=0===this.root.J1;u.shiftKey||u.ctrlKey||!(B===Sys.UI.Key.right&&Q||B===Sys.UI.Key.left&&!Q)||(h=this.Owf(b),h||(this.ax(b.uf,1,b.Hb),h=!0))}h||(h=super.onKeyDown(b))}return h}static GCk(b,h){Le.c(b)||Le.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(m.a)(cn,"FlyoutAnchorBehavior",
Ki,[]);var oh=c(953);class Gl extends Kk{constructor(b){super(b)}get s8b(){return this.control}get properties(){return this.s8b.properties}get Aga(){return this.s8b.Aga}YI(b){b=b.MDb;Ue.a.instance.ob(Kd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ue.a.instance.ob(Kd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Hh.a.instance.ob(Kd.a.pointerOver,b,Object(z.a)(this,this.GP,"onPointerOver"));Hh.a.instance.ob(Kd.a.pointerOut,b,Object(z.a)(this,this.PJ,"onPointerOut"));Nb.KeyInputManager.instance.ob(Kd.a.$h,
b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.sh,b,Object(z.a)(this,this.Qy,"onKeyUp"));Hh.a.instance.ob(Kd.a.pointerDown,b,Object(z.a)(this,this.eD,"onPointerDown"));Hh.a.instance.ob(Kd.a.iN,b,Object(z.a)(this,this.mya,"onPointerUp"));Lk.a.instance.ob(Kd.a.XP,b,Object(z.a)(this,this.vnb,"onTouchMove"));Lk.a.instance.ob(Kd.a.eK,b,Object(z.a)(this,this.nHa,"onTouchEnd"))}Bm(){const b=this.Rd[oh.a.On],h=this.Rd[oh.a.IsRtl];this.iGj();if(0<(this.vu(this.properties.Command,
this.properties.QueryCommand,this.Rd)&2)){var u=!Le.c(this.Rd[oh.a.InnerHTML])||!Le.c(this.properties.InnerHTML),B=!Le.c(this.properties.Image);u||B||(this.control.enabled=!1);B=this.Aga.MDb;if(!Le.c(B)){if(u){u=ig.a.Rra(this.Rd[oh.a.InnerHTML],this.properties.InnerHTML);if(null===B.innerHTML||null===u||F.a.Zg(B.innerHTML)!==F.a.Zg(u))B.innerHTML=u;""===u&&(this.control.enabled=!1)}u=B.title;const Q=ig.a.Rra(this.Rd[oh.a.Alt],this.properties.Alt);Q===u||this.control.Keg||(B.title=Q)}B=this.Rd[oh.a.IsRtl];
b===this.Rd[oh.a.On]&&h===B||this.control.pMb()}}iGj(){const b=this.Rd;b[oh.a.CommandValueId]=this.control.kFb();b.MenuItemId=this.control.Gh.MenuItemId;b.SourceControlId=this.properties.Id}ax(b,h,u){if((b=this.tk)&&this.control.enabled){const B=this.root;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.qWc()&&this.eI){const Q=B.dD[this.eI.tra];Q?Q.HTa(this.s8b):r.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.iGj();
this.Rd[oh.a.On]||(this.Rd[oh.a.On]=!0,this.control.pMb());"Menu"===b.aU&&ig.a.Bw(this.Aga.Tm,"cui-gallerybutton-focused");B.executeCommand(this.properties.Command,this.Rd,b,h,!0,null,this.YX(u))}}onFocus(b){super.onFocus(b);ig.a.Xf(this.Aga.Tm,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);ig.a.Bw(this.Aga.Tm,"cui-gallerybutton-focused");return!1}}Object(m.a)(Gl,"GalleryButtonBehavior",Kk,[]);var Zk=c(1138),ym=c(1397),Lh=c(644);class qk extends Kk{constructor(b){super(b);this.YXa=
-1}get bbc(){return this.control}get properties(){return this.bbc.Gh}get xIc(){return this.bbc.xIc}get Fyf(){var b=null;if(this.tk&&(b=this.tk.parent,!Object(Cb.a)(Lh.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get VHb(){return this.bbc.mXd.VHb}get d2c(){return this.bbc.mXd.d2c}ax(b,h,u){if(this.control.enabled){b=this.kqf(this.J8b(b));const B=this.IPd(b);this.xIc[ym.a.Rows]=this.kTd(b)+1;this.xIc[ym.a.Columns]=B+1;this.root.executeCommand(this.properties.Command,
this.xIc,this.tk,h,!0,null,this.YX(u))}}YI(b){var h=b.Tm;const u=b.ZAh;b=b.cells;Hh.a.instance.ob(Kd.a.pointerOut,h,Object(z.a)(this,this.Ckn,"onControlPointerOut"));Lk.a.instance.ob(Kd.a.XP,h,Object(z.a)(this,this.Ekn,"onControlTouchMove"));Lk.a.instance.ob(Kd.a.eK,h,Object(z.a)(this,this.Dkn,"onControlTouchEnd"));for(h=0;h<b.length;++h)this.iGk(u[h],b[h])}iGk(b,h){Ue.a.instance.ob(Kd.a.focus,b,Object(z.a)(this,this.nUf,"onCellFocus"));Hh.a.instance.ob(Kd.a.pointerOver,h,Object(z.a)(this,this.oUf,
"onCellPointerOver"));Hh.a.instance.ob(Kd.a.iN,h,Object(z.a)(this,this.pUf,"onCellPointerUp"));Nb.KeyInputManager.instance.ob(Kd.a.$h,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.sh,h,Object(z.a)(this,this.Qy,"onKeyUp"));Lk.a.instance.ob(Kd.a.YP,h,Object(z.a)(this,this.Bjn,"onCellTouchStart"))}kqf(b){return parseInt(b.id.substr(this.bbc.id.length+1))}Nki(b){this.Mki(this.kqf(b))}kTd(b){return Math.floor(b/Zk.a.H0c)}IPd(b){return b%Zk.a.H0c}Mki(b){if(b!==this.YXa){var h=
this.IPd(b),u=this.kTd(b),B=-1;let Q=-1;-1!==this.YXa&&(B=this.kTd(this.YXa),Q=this.IPd(this.YXa));for(;B!==u||Q!==h;)B<u?this.ulj(++B,Q,!0):B>u?(this.ulj(B,Q,!1),B--):Q<h?this.Wij(++Q,B,!0):Q>h&&(this.Wij(Q,B,!1),Q--);this.Fyf?this.Fyf.kmj(this.U4h(u+1,h+1)):(u=(h=this.control.G8e)&&0<h.length?h[0]:null,B=this.tk,r.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{["CtrlComps"]:!!h,["FirstComp"]:!!u,["FirstCompPar"]:!!u&&!!u.parent,["DispComp"]:!!B,["DispCompPar"]:!!B&&!!B.parent}));
this.YXa=b}}ulj(b,h,u){for(let B=0;B<=h;B++)this.Oij(b,B,u)}Wij(b,h,u){for(let B=0;B<=h;B++)this.Oij(B,b,u)}Oij(b,h,u){h=b*Zk.a.H0c+h;b=this.VHb[h];h=this.d2c[h];u?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}pUf(b){this.ax(b.uf,b.hg,b.Hb);return!0}J8b(b){for(;b.hasChildNodes();)b=b.childNodes[0];return Le.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}lmj(b){const h=this.kqf(b);
b.childNodes[0].childNodes[0].title=this.U4h(this.kTd(h)+1,this.IPd(h)+1)}U4h(b,h){let u=this.properties.Alt;Le.c(u)&&(u=this.properties.MenuSectionTitle);return u=String.format(u,h.toString(),b.toString())}Wic(){if(this.tk){for(var b=0;b<Zk.a.Pfc;b++)this.VHb[b].className="cui-it-inactiveCell",this.d2c[b].className="cui-it-inactiveCellOuter";this.YXa=-1;b=this.properties.MenuSectionInitialTitle;Le.c(b)&&(b="");this.Fyf.kmj(b)}}oUf(b){this.control.enabled&&(b=this.J8b(b.uf),this.y8c(b),this.Zef(b));
return!1}Zef(b){this.lmj(b);this.Nki(b)}nUf(b){if(!this.control.enabled)return!1;b=this.J8b(b.uf);this.lmj(b);this.Nki(b);return!1}Ckn(b){Qd.a.FFf(this.bbc.mXd.Tm,b.clientPoint)||this.Wic();return!1}Bjn(b){if(!this.control.enabled)return!1;b=this.J8b(b.uf);this.Zef(b);return!0}Ekn(b){if(!this.control.enabled)return!1;b=Qd.a.xQd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=this.J8b(b))?this.Zef(b):this.Wic();return!0}Dkn(b){if(!this.control.enabled)return!1;var h=Qd.a.xQd(b.clientPoint);
if(!h||"table"===h.tagName.toLowerCase())return this.Wic(),!0;(h=this.J8b(h))?this.ax(h,3,b.Hb):this.Wic();return!0}bL(b){b=qo.Control.Jkf(this.YXa,Zk.a.H0c,Zk.a.Pfc,b);if(b!==this.YXa)return this.VHb[b].firstChild.focus(),this.Mki(b),!0;this.Wic();this.YXa=-1;return!1}bZ(){const b=this.VHb[0];if(Le.c(b))return!1;b.firstChild.focus();return!0}y8c(b){if(Le.c(b))return!1;b.firstChild.firstChild.focus();return!0}iqa(){this.Wic()}}Object(m.a)(qk,"InsertTableBehavior",Kk,[]);class Io extends Ki{constructor(b){super(b)}Bm(){this.control.enabled=
!!this.menu}ax(b,h,u){v.AFrameworkApplication.va.Rb(Za.a.yRa,2,h,this.YX(u))}}Object(m.a)(Io,"JewelMenuLauncherBehavior",Ki,[]);var Dq=c(1076);class Wk extends Kk{constructor(b){super(b)}get properties(){return this.control.Gh}Bm(){0<(this.vu(this.properties.Command,this.properties.QueryCommand,this.Rd)&2)&&this.Y8a()&&this.aVa()}aVa(){this.KXo();this.ska();this.tSb()}KXo(){const b=this.control.labelText;let h=this.Rd[Dq.a.Value];Le.c(h)&&(h=this.properties.LabelText,Le.c(h)&&(h=""));h!==b&&this.ige(h)}YI(b){b=
b.Tm;Le.c(b)||(Hh.a.instance.ob(Kd.a.pointerDown,b,Object(z.a)(this,this.eD,"onPointerDown")),Hh.a.instance.ob(Kd.a.pointerOver,b,Object(z.a)(this,this.GP,"onPointerOver")),Hh.a.instance.ob(Kd.a.pointerOut,b,Object(z.a)(this,this.PJ,"onPointerOut")))}}Object(m.a)(Wk,"LabelBehavior",Kk,[]);var ur=c(877),vr=c(212),Co=c(301);class yt extends Ki{constructor(b){super(b);this.EDe=this.sve=!1;this.hXb=this.MTb=null;if(this.LXb=v.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.MTb=this.wu.Bja.LightImage16by16Class,
this.hXb=this.wu.Bja.DarkImage16by16Class}get wu(){return this.control}j5d(b,h,u,B){h&&(this.wu.Xga=u,v.AFrameworkApplication.ua.r7a());if(Object(Cb.a)(vr.a,b)&&B){u=new ur.a;u.CommandLocation=this.root.p$;u.InvocationMethod=0;const Q={};(b=b.control)&&b.Gh&&(Q.CommandId=b.Gh.Command,Q.ControlId=b.Gh.Id,Q.CloseAllMenus=h,b.eI&&b.eI.parent&&b.eI.parent.id&&(Q.ParentControlId=b.eI.parent.id.split("-")[0]),this.root.CF&&this.root.CF.XOa(B,Q,u))}}ava(){this.wu.Xga||(this.wu.Xga=this.wu.Hy);!this.wu.kcn&&
this.LXb&&(ig.a.Bw(this.wu.Hy,"cui-sb-focus"),ig.a.Bw(this.wu.R1,"cui-sb-focus"),ig.a.Bw(this.wu.jza,this.MTb),ig.a.Xf(this.wu.jza,this.hXb));this.sve=!0;super.ava();this.sve=!1;this.a4f()}get ipj(){return!this.wu.LSa}X6d(){this.wu.X6d()}Jbe(){this.EDe||this.sve||(this.EDe=!0,this.wu.raiseEvent(Co.a.y3a,null))}a4f(){this.tL||this.wu.DAf||(this.EDe=!1,this.wu.raiseEvent(Co.a.mIb,null))}DVf(b){ig.a.Bw(this.wu.Hy,"cui-sb-focus");ig.a.Bw(this.wu.R1,"cui-sb-focus");this.LXb&&!this.wu.tL&&(ig.a.Bw(this.wu.jza,
this.MTb),ig.a.Xf(this.wu.jza,this.hXb));this.wu.raiseEvent(Co.a.blur,b);this.a4f();this.wu.Xga=this.wu.Hy;return!1}EVf(b){ig.a.Xf(this.wu.Hy,"cui-sb-focus");ig.a.Xf(this.wu.R1,"cui-sb-focus");this.LXb&&(ig.a.Bw(this.wu.jza,this.hXb),ig.a.Xf(this.wu.jza,this.MTb));this.wu.raiseEvent(Co.a.focus,b);this.Jbe();return!1}fXf(){this.LXb&&(ig.a.Xf(this.wu.R1,"cui-sb-hover"),ig.a.Xf(this.wu.Hy,"cui-sb-hover"),ig.a.Bw(this.wu.jza,this.hXb),ig.a.Xf(this.wu.jza,this.MTb));return!1}eXf(){this.LXb&&(ig.a.Bw(this.wu.R1,
"cui-sb-hover"),ig.a.Bw(this.wu.Hy,"cui-sb-hover"),this.wu.tL||this.wu.DAf||(ig.a.Bw(this.wu.jza,this.MTb),ig.a.Xf(this.wu.jza,this.hXb)));return!1}}Object(m.a)(yt,"SearchBoxBehavior",Ki,[700,678]);class dn{}dn.Value="value";dn.MinValue="MinValue";dn.MaxValue="MaxValue";dn.Text="Text";Object(m.a)(dn,"SliderCommandProperties",null,[]);class en extends Kk{constructor(b){super(b)}get Mgg(){return this.control}get M5(){return this.Mgg.M5}get properties(){return this.control.Gh}initialize(){}ax(){}YI(b){b=
b.ur;Ue.a.instance.ob(Kd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ue.a.instance.ob(Kd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Ue.a.instance.ob(Kd.a.yHc,b,Object(z.a)(this,this.tda,"onChange"));Ue.a.instance.ob(Kd.a.input,b,Object(z.a)(this,this.tda,"onChange"))}onFocus(b){this.M5.Tm&&Sys.UI.DomElement.addCssClass(this.M5.Tm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.M5.Tm&&Sys.UI.DomElement.removeCssClass(this.M5.Tm,"cui-sldr-onfocus");return super.onBlur(b)}tda(){this.W0k(this.M5.ur.value);
return!0}W0k(b){this.Rd[dn.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Rd,this.tk,0,!1)}Bm(){const b=this.Rd[dn.Value],h=this.Rd[dn.MaxValue],u=this.Rd[dn.Text];var B=this.vu(this.properties.Command,this.properties.QueryCommand,this.Rd);this.M5&&this.M5.ur&&(this.M5.ur.disabled=!this.control.enabled);if(0<(B&2)){B=this.Rd[dn.Value];const Q=this.Rd[dn.MaxValue],ca=this.Rd[dn.Text];(Q!==h||B!==b||u!==ca)&&this.M5&&this.M5.ur&&(this.M5.ur.setAttribute(af.a.GCd,String.format("{0}",
Q)),this.M5.ur.setAttribute("max",String.format("{0}",Q)),this.M5.ur.value=B,this.M5.TO.innerText=this.Rd[dn.Text])}}}Object(m.a)(en,"SliderBehavior",Kk,[]);var gj=c(1391);class Nr extends Kk{constructor(b){super(b);this.nrd=0;this.Qdb=null;this.Kod=!1;this.Vjh=null;this.BSe=!1;this.oud=this.Jsd=-1;this.GBa=!1}get spinner(){return this.control}get VG(){return this.spinner.VG}get properties(){return this.control.Gh}initialize(){const b=this.spinner.Lpg;this.Vjh=this.rPo(b);this.nrd=b[0].min;this.Qdb=
b[0];this.Kod=!1}ax(){}YI(b){const h=b.ur,u=b.Z6b;b=b.aMc;Ue.a.instance.ob(Kd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Ue.a.instance.ob(Kd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));Nb.KeyInputManager.instance.ob(Kd.a.$h,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.qu,h,Object(z.a)(this,this.PG,"onKeyPress"));Nb.KeyInputManager.instance.ob(Kd.a.sh,h,Object(z.a)(this,this.Qy,"onKeyUp"));Ue.a.instance.ob(Kd.a.yHc,h,Object(z.a)(this,this.tda,"onChange"));
vf.a.instance.ob(Kd.a.oda,h,Object(z.a)(this,this.FVf,"onInputMouseUp"));Hh.a.instance.ob(Kd.a.pointerDown,u,Object(z.a)(this,this.aSi,"onArrowPointerDown"));Hh.a.instance.ob(Kd.a.pointerDown,b,Object(z.a)(this,this.aSi,"onArrowPointerDown"));Hh.a.instance.ob(Kd.a.iN,u,Object(z.a)(this,this.bSi,"onArrowPointerUp"));Hh.a.instance.ob(Kd.a.iN,b,Object(z.a)(this,this.bSi,"onArrowPointerUp"));Lk.a.instance.ob(Kd.a.XP,u,Object(z.a)(this,this.dSi,"onArrowTouchMove"));Lk.a.instance.ob(Kd.a.XP,b,Object(z.a)(this,
this.dSi,"onArrowTouchMove"));Lk.a.instance.ob(Kd.a.eK,u,Object(z.a)(this,this.cSi,"onArrowTouchEnd"));Lk.a.instance.ob(Kd.a.eK,b,Object(z.a)(this,this.cSi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);ig.a.Xf(this.VG.Tm,"cui-spn-focus");this.control.enabled&&Qd.a.K7c(this.VG.ur);return this.GBa=!1}onBlur(b){super.onBlur(b);ig.a.Bw(this.VG.Tm,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!Le.c(b.Hb)&&!Le.c(b.Hb.rawEvent)){const u=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;if(u===Sys.UI.Key.up||
u===Sys.UI.Key.down)this.root.TCf(this.control)||this.Stj(u===Sys.UI.Key.up,b.hg),h=!0;else if(u===Sys.UI.Key.enter)this.OT(),Object(Cb.a)(Ho.Ribbon,this.root)&&this.root.Z_(),h=!0;else if(u===Sys.UI.Key.tab)this.OT(),Object(Cb.a)(Ho.Ribbon,this.root)&&(h=this.root.fpe(this.tk.Mc,!B));else if(u===Sys.UI.Key.esc)this.Yic(),Object(Cb.a)(Ho.Ribbon,this.root)&&this.root.Z_(),h=!0;else if(u===Sys.UI.Key.backspace||u===Sys.UI.Key.del)h=!this.control.enabled}return h}PG(){return!this.control.enabled}Qy(){this.Zfl();
return!1}tda(){this.OT();return!1}FVf(){return this.GBa?!1:this.GBa=!0}aSi(b){var h=!1;let u=!0;2===b.hg&&(u=b.mda===Sys.UI.MouseButton.leftButton);u&&(h=b.uf,this.Stj(h===this.VG.Z6b||h===this.VG.GUh||h===this.VG.FUh,b.hg),h=!0);return h}bSi(b){return this.Gva(b)}dSi(b){return this.L5d(b)}cSi(b){return this.Gva(b)}Rvm(b){if(this.control.enabled){var h=!1;if(!this.Kod){var u=this.HZl(b);u=b?u+this.Qdb.step:u-this.Qdb.step;u=Math.min(u,this.Qdb.max);u=Math.max(u,this.Qdb.min);u!==this.nrd&&(this.u8e(u,
this.Qdb),this.root.executeCommand(this.properties.Command,this.Rd,this.tk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,u=this.Rd,u.Increment=b,Le.c(h)||this.root.executeCommand(h,u,this.tk,0,!1))}}HZl(b){const h=Math.pow(10,v.AFrameworkApplication.numberFormat.r5d),u=Math.round(this.Qdb.step*h);let B=Math.round(this.nrd*h)/u;B=b?Math.floor(B):Math.ceil(B);return B*u/h}Stj(b,h){if(this.control.enabled){this.OT();const u=b?this.VG.Z6b:this.VG.aMc;switch(h){case 2:case 3:this.BSe=b;this.iAd(u);break;
case 1:this.BSe=b,this.vok(u)}}}xuj(){this.mAh();this.VRk()}qPh(){-1===this.Jsd&&(this.Jsd=window.setTimeout(Object(z.a)(this,this.j1n,"repeatSpin"),500))}mAh(){this.Jsd=ig.a.DBb(this.Jsd)}j1n(){this.mAh();-1===this.oud&&(this.fje(),this.oud=window.setInterval(Object(z.a)(this,this.fje,"spin"),50))}VRk(){this.oud=ig.a.RRk(this.oud)}fje(){this.Rvm(this.BSe)}vok(b){this.root.pga(this.control,!1);ig.a.Xf(b,qo.Control.lAd);this.fje();this.qPh()}Zfl(){this.root.Yba(this.control,!1);this.xuj();ig.a.Bw(this.VG.Z6b,
qo.Control.lAd);ig.a.Bw(this.VG.aMc,qo.Control.lAd)}xkc(b){this.VG.ur.value!==b&&(this.VG.ur.value=b)}Yic(){this.xkc(this.Rd[gj.a.Text])}ljj(b){this.xkc(b);this.Rd[gj.a.Text]=b;this.Kod=!0}Weo(b,h,u){this.xkc(u);this.Rd[gj.a.Text]=u;this.Rd[gj.a.Number]=b;this.Rd[gj.a.UnitType]=h.type;this.nrd=b;this.Qdb=h;this.VG.ur.setAttribute(af.a.Z1e,u);this.VG.ur.setAttribute(af.a.quh,String.format("{0}",h.min));this.VG.ur.setAttribute(af.a.GCd,String.format("{0}",h.max));this.Kod=!1}PFh(b){var h;if(({vfn:h}=
this.FSm(b)).returnValue)this.ljj(h);else{({number:b,L8a:h}=F.a.e_i(b,this.Vjh,v.AFrameworkApplication.numberFormat));let u=this.Pme(h);0===h&&Le.c(u)&&(u=this.Pme(this.Rd[gj.a.UnitType]));this.u8e(b,u)}}u8e(b,h){b=this.zSf(b,h);if(isNaN(b)||Le.c(h))this.Yic();else{const u=v.AFrameworkApplication.numberFormat;let B;B=F.a.MEa(b,h.type,u);B=B.replace(6===h.type?u.s5d:u.j_f,"");this.Weo(b,h,B)}}FSm(b){let h,u=!1;h="";b=b.trim();const B=this.spinner.KHj;if(!Le.c(B))for(let Q=0;Q<B.length;Q++)if(B[Q].toLowerCase()===
b.toLowerCase()){h=B[Q];u=!0;break}return{returnValue:u,vfn:h}}zSf(b,h){return isNaN(b)||Le.c(h)?Number.NaN:h.zSf(b)}Pme(b){let h=null;const u=this.spinner.Lpg;for(let B=0;B<u.length;B++)if(u[B].type===b){h=u[B];break}return h}rPo(b){const h=b.length,u=Array(h);for(let B=0;B<h;B++)u[B]=b[B].type;return u}OT(){if(this.control.enabled){const b=this.Rd[gj.a.Text],h=this.VG.ur.value;h!==b&&(this.PFh(h),this.Rd[gj.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Rd,this.tk,0,!1))}else this.Yic()}Bm(){var b=
this.Rd[gj.a.Text],h=this.Rd[gj.a.Number];const u=this.Rd[gj.a.UnitType],B=this.Rd[gj.a.MaxValue];if(0<(this.vu(this.properties.Command,this.properties.QueryCommand,this.Rd)&2)){const Q=this.Rd[gj.a.Text],ca=this.Rd[gj.a.Number],qa=this.Rd[gj.a.UnitType],Qa=this.Rd[gj.a.MaxValue];Qa!==B&&(this.Pme(qa).max=Qa,this.VG.ur.setAttribute(af.a.GCd,String.format("{0}",Qa)));Q!==b?""===Q?this.ljj(Q):this.PFh(Q):isNaN(ca)||ca===h&&qa===u||this.u8e(ca,this.Pme(qa));b=this.VG.Tm.title;h=ig.a.Rra(this.Rd[gj.a.Alt],
this.properties.Alt);h!==b&&(this.VG.ur.title=h,this.VG.Z6b.title=h,this.VG.aMc.title=h)}}$Xe(b){super.$Xe(b);b?(this.fje(),this.qPh()):this.xuj()}}Object(m.a)(Nr,"SpinnerBehavior",Kk,[699,678]);var Or=c(405),ji=c(891);class Mk extends Ki{constructor(b){super(b);this.IYb=!0;this.Nsb=!1}get P5(){return this.control}get nt(){return this.P5.properties}YI(b){const h=b.Tm,u=b.Ygb;b=b.cMc;Ue.a.instance.ob(Kd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Ue.a.instance.ob(Kd.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));Nb.KeyInputManager.instance.ob(Kd.a.$h,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.sh,h,Object(z.a)(this,this.Qy,"onKeyUp"));Z.a.pu&&16>this.uUl()&&(Hh.a.instance.ob(Kd.a.pointerDown,h,Object(z.a)(this,this.SWi,"onSplitbuttonPointerDownPointerUp")),Hh.a.instance.ob(Kd.a.iN,h,Object(z.a)(this,this.SWi,"onSplitbuttonPointerDownPointerUp")));Hh.a.instance.ob(Kd.a.pointerOver,u,Object(z.a)(this,this.mjn,"onButtonPointerOver"));Hh.a.instance.ob(Kd.a.pointerOut,
u,Object(z.a)(this,this.ljn,"onButtonPointerOut"));Hh.a.instance.ob(Kd.a.pointerDown,u,Object(z.a)(this,this.rSi,"onButtonPointerDown"));Hh.a.instance.ob(Kd.a.iN,u,Object(z.a)(this,this.sSi,"onButtonPointerUp"));Lk.a.instance.ob(Kd.a.XP,u,Object(z.a)(this,this.ojn,"onButtonTouchMove"));Lk.a.instance.ob(Kd.a.eK,u,Object(z.a)(this,this.njn,"onButtonTouchEnd"));Hh.a.instance.ob(Kd.a.pointerDown,b,Object(z.a)(this,this.dWf,"onMenuButtonPointerDown"));Hh.a.instance.ob(Kd.a.pointerOver,b,Object(z.a)(this,
this.hon,"onMenuButtonPointerOver"));Hh.a.instance.ob(Kd.a.pointerOut,b,Object(z.a)(this,this.gon,"onMenuButtonPointerOut"))}ax(b,h,u){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.Nsb&&(this.P5.on=!this.P5.on,b=this.Rd,b.CommandValueId=this.control.kFb(),this.root.executeCommand(this.nt.Command,b,this.tk,h,!0,null,this.YX(u))):this.IYb&&super.ax(b,h,u)}Qy(b){const h=b.Hb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Rd,b.CommandValueId=this.control.kFb(),this.root.executeCommand(this.nt.Command,
b,this.tk,1,!0),!0):super.Qy(b)}Bm(){const b=this.root.Bqa(this.nt.Command,this.nt.QueryCommand,this.Rd),h=0<(b&1);let u=!0;u=Le.c(this.nt.CommandMenuOpen)?h:0<(this.root.Bqa(this.nt.CommandMenuOpen,null,null)&1);if(u!==this.IYb||h!==this.Nsb||(u||h)!==this.control.enabled)this.control.enabled=u||h,h!==this.Nsb&&this.yln(h),u!==this.IYb&&this.zln(u),this.IYb=u,this.Nsb=h;if(0<(b&2)){this.ska();const B=ig.a.Rra(this.Rd[ji.a.LabelText],this.nt.LabelText);this.Rd[ji.a.ApplyLabelTextToControlOnly]?this.P5.e8b(Q=>
{Q.Tm.title=B;Q.Ygb.removeAttribute("title");Q.cMc.removeAttribute("title")}):this.P5.e8b(Q=>{Q.Ygb.title=B});this.Rd[ji.a.EnsureControlRoleIsButton]&&this.P5.e8b(Q=>{af.a.ir(Q.Tm,af.a.oh,af.a.L3)});Le.c(this.Rd[ji.a.Visible])||this.Y8a()&&this.aVa()}this.P5.setState(this.P5.on&&h)}aVa(){this.oog();this.tSb();this.ska()}zln(b){this.P5.e8b(h=>{ig.a.npb(h.cMc,b)});this.L5c();this.IYb=b}yln(b){this.P5.e8b(h=>{ig.a.npb(h.Ygb,b)});this.L5c();this.Nsb=b}L5c(){const b=this.P5.wib();Le.c(b)||(ig.a.Bw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),ig.a.Bw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),ig.a.Bw(b.childNodes[1],"cui-ctl-split-hovered-primary"),ig.a.Bw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}SWi(b){if(0!==Or.a(b.Hb))return!1;let h=!1;b.eventName===Kd.a.pointerDown?h=this.rSi(b):b.eventName===Kd.a.iN&&(h=this.sSi(b));return h}rSi(b){let h=!1;const u=b.hg;switch(u){case 3:this.Jso()?this.ax(this.tk.Mc,u,b.Hb):this.iAd(this.P5.eSh);h=!0;break;case 2:b.mda===Sys.UI.MouseButton.leftButton&&
(this.iAd(this.P5.eSh),h=!0)}h&&b.Hb.preventDefault();return!1}Jso(){const b=this.tk.aU;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}sSi(b){return this.Gva(b)}ojn(b){return this.L5d(b)}njn(b){return this.Gva(b)}onFocus(b){super.onFocus(b);this.syf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.L5c();return!1}mjn(){this.control.enabled&&this.Nsb&&this.syf(!0,this.P5.on);return!1}ljn(){this.control.enabled&&this.Nsb&&this.L5c();return!1}dWf(b){let h=!1;if(2!==b.hg||b.mda===Sys.UI.MouseButton.leftButton)this.ax(b.uf,
b.hg,b.Hb),h=!0;h&&b.Hb.preventDefault();return!1}hon(){this.control.enabled&&this.IYb&&this.syf(this.P5.on,!0);return!1}gon(){this.L5c();return!1}syf(b,h){const u=this.control.wib();Le.c(u)||(ig.a.Xf(u.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),ig.a.Xf(u.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}uUl(){var b=Z.a.O6b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(m.a)(Mk,"SplitButtonBehavior",Ki,[]);
var cj=c(1396);class mm extends Kk{constructor(b){super(b);this.xvb=this.GBa=!1;this.u0j=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get sea(){return this.textBox.sea}get Yjg(){return this.textBox.Gh}YI(b){b=b.ur;Ue.a.instance.ob(Kd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ue.a.instance.ob(Kd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Nb.KeyInputManager.instance.ob(Kd.a.$h,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.qu,b,Object(z.a)(this,this.PG,"onKeyPress"));Nb.KeyInputManager.instance.ob(Kd.a.sh,b,Object(z.a)(this,this.Qy,"onKeyUp"));Ue.a.instance.ob(Kd.a.yHc,b,Object(z.a)(this,this.tda,"onChange"));vf.a.instance.ob(Kd.a.oda,b,Object(z.a)(this,this.qSa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.xvb=!0;ig.a.Xf(this.sea.Tm,"cui-tb-focus");this.control.enabled&&Qd.a.K7c(this.sea.ur);return this.GBa=!1}onBlur(b){this.xvb=!1;super.onBlur(b);ig.a.Bw(this.sea.Tm,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!Le.c(b.Hb)&&!Le.c(b.Hb.rawEvent)){const u=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;u===Sys.UI.Key.tab?(this.OT(),Object(Cb.a)(Ho.Ribbon,this.root)&&(h=this.root.fpe(this.tk.Mc,!B))):u===Sys.UI.Key.enter?this.u0j&&(this.OT(),Object(Cb.a)(Ho.Ribbon,this.root)&&this.root.Z_(),h=!0):u===Sys.UI.Key.esc?(this.Yic(),Object(Cb.a)(Ho.Ribbon,this.root)&&this.root.Z_(),h=!0):u===Sys.UI.Key.backspace||u===Sys.UI.Key.del?h=!this.control.enabled:b.dva&&
(Me.a.jAh(b.Hb),h=!1)}return h}PG(){return!this.control.enabled}Qy(){return!1}tda(){this.OT();return!1}qSa(){return this.sea.isEditable?this.GBa?!1:this.GBa=!0:(Qd.a.K7c(this.sea.ur),!0)}xkc(b){this.sea.ur.value!==b&&(this.sea.ur.value=b)}Yic(){this.xkc(this.Rd[cj.a.Text])}OT(){if(this.control.enabled&&this.sea.isEditable){const b=this.sea.ur.value;b!==this.Rd[cj.a.Text]&&(this.Rd[cj.a.Text]=b,this.root.executeCommand(this.Yjg.Command,this.Rd,this.tk,0,!1))}else this.Yic()}Bm(){const b=this.Rd[cj.a.Text];
if(0<(this.vu(this.Yjg.Command,this.Yjg.QueryCommand,this.Rd)&2)&&!this.xvb){const h=this.Rd[cj.a.Text];h!==b&&this.xkc(h)}}}Object(m.a)(mm,"TextBoxBehavior",Kk,[677,678]);var pl=c(386);class Ai extends Kk{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Gh}ax(b,h,u){this.control.enabled&&(ig.a.bia(this.properties.TogglesWhenExecuted)||this.toggle(),this.Rd.CommandValueId=this.toggleButton.kFb(),this.Rd.MenuItemId=this.toggleButton.Gh.MenuItemId,
this.Rd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Rd,this.tk,h,!ig.a.bia(this.properties.CloseMenuWhenExecuted),B=>{ig.a.Yr(this.properties.UpdateHtmlPostToggle)&&(32===B?this.yyj():this.wyj())},this.YX(u)))}wyj(){this.Rd[gg.a.On]=!this.Rd[gg.a.On]}yyj(){this.toggleButton.setState(this.Rd[gg.a.On]);(this.toggleButton.aAa&&this.toggleButton.Yne||ig.a.Yr(this.properties.UpdateHtmlPostToggle))&&this.aVa()}toggle(){this.wyj();ig.a.Yr(this.properties.UpdateHtmlPostToggle)||
this.yyj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!Le.c(b.Hb)&&this.eI){const u=b.Hb.keyCode;u!==Sys.UI.Key.enter&&u!==Sys.UI.Key.space||b.Hb.preventDefault()}return h}Bm(){Le.c(this.properties.MenuItemId)||(this.Rd.MenuItemId=this.properties.MenuItemId);0<(this.vu(this.properties.Command,this.properties.QueryCommand,this.Rd)&2)&&this.Y8a()&&this.aVa()}aVa(){this.toggleButton.setState(this.Rd[gg.a.On]);this.ZSo(ig.a.Rra(this.Rd[gg.a.DisplayMode],""));this.oog();this.ska();this.MUo();gg.a.Alt in
this.Rd&&this.tSb()}MUo(){const b=this.$E.bec;if(b&&b.Zgb){var h=ig.a.Rra(this.Rd[gg.a.Description],this.properties.Description);h!==b.Zgb.innerText&&(b.Zgb.innerText=h,b.TO&&!Object(Cb.a)(pl.Jewel,this.root)&&(h=!Le.b(h),ig.a.b6(b.TO,"UIFontBold",h),ig.a.b6(b.TO,"cui-ctl-mediumlabel-nodescription",!h)))}}YI(b){b=b.Tm;Ue.a.instance.ob(Kd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ue.a.instance.ob(Kd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Hh.a.instance.ob(Kd.a.pointerOver,b,Object(z.a)(this,
this.GP,"onPointerOver"));Hh.a.instance.ob(Kd.a.pointerOut,b,Object(z.a)(this,this.PJ,"onPointerOut"));Nb.KeyInputManager.instance.ob(Kd.a.$h,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Nb.KeyInputManager.instance.ob(Kd.a.sh,b,Object(z.a)(this,this.Qy,"onKeyUp"));Hh.a.instance.ob(Kd.a.pointerDown,b,Object(z.a)(this,this.eD,"onPointerDown"));Hh.a.instance.ob(Kd.a.iN,b,Object(z.a)(this,this.mya,"onPointerUp"));Wi.a.instance.ob(Kd.a.click,b,Object(z.a)(this,this.onClick,"onClick"));Lk.a.instance.ob(Kd.a.XP,
b,Object(z.a)(this,this.vnb,"onTouchMove"));Lk.a.instance.ob(Kd.a.eK,b,Object(z.a)(this,this.nHa,"onTouchEnd"))}}Object(m.a)(Ai,"ToggleButtonBehavior",Kk,[]);class zm{constructor(b){this.LXj=b;this.cAe={["Button"]:h=>new Ln(h),["FileMenuButton"]:h=>new Ln(h),["ColorPicker"]:h=>new db(h),["ComboBox"]:h=>new Xh(h),["ContextMenuControl"]:h=>new Mm(h),["ContextMenuLauncher"]:h=>new Mm(h),["DialogMenuLauncher"]:h=>new Mn(h),["DropDown"]:h=>new Hk(h),["FlyoutAnchor"]:h=>new cn(h),["GalleryButton"]:h=>new Gl(h),
["StatefulColorFlyoutAnchor"]:h=>new cn(h),["JewelMenuLauncher"]:h=>new Io(h),["Label"]:h=>new Wk(h),["Placeholder"]:h=>new Kk(h),["SearchBox"]:h=>new yt(h),["Separator"]:h=>new Kk(h),["SplitButton"]:h=>new Mk(h),["StatefulColorSplitButton"]:h=>new Mk(h),["StatefulImageSplitButton"]:h=>new Mk(h),["TextBox"]:h=>new mm(h),["ToggleButton"]:h=>new Ai(h)}}cVh(){this.cAe[qo.Control.Gri]=b=>new qk(b)}Mgf(){this.cAe[qo.Control.Ssj]=b=>new Nr(b)}MMl(b){const h=this.cAe[b.controlType];(b=h?h(b):null)&&this.LXj&&
b.$sl();return b}static get instance(){return zm._instance||(zm._instance=new zm(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}zm._instance=null;Object(m.a)(zm,"ControlBehaviorFactory",null,[644]);var Tm=c(992),Ip=c(147);class fl extends ro.MenuLauncher{constructor(b,h,u,B){super(b,h,u,B);this.C3g=null;this.pNa=this.BEc=0;this.CF=null;this.Sxc=this.Rxc=0;this.hh("Menu");this.enabled=!0}get x(){return this.BEc}get y(){return this.pNa}get hJf(){return this.Rxc}get iJf(){return this.Sxc}get controlType(){return"DialogMenuLauncher"}t7a(){}P8a(){}Lnf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.nt.DialogMoveCommand;b.DialogCloseCommand=this.nt.DialogCloseCommand;return b}aYm(b,h){this.BEc=b.x;this.pNa=b.y;this.Rxc=b.height;this.Sxc=b.width;this.J0(h)}XQ(b){this.C3g=ig.a.createElement("span");return new Ip.a(b,this.C3g)}get nt(){return this.Gh}iva(b,h,u){return new fl(b,this.id,h,u)}}Object(m.a)(fl,"DialogMenuLauncher",ro.MenuLauncher,[]);var rk=c(824);class Ul extends Tm.a{constructor(b,h){super(b,h);this.M9a=null}get cYe(){return this.M9a}get OQh(){return this.properties}get p$(){return 20}Cm(){super.Cm();
Le.c(this.Mc)&&this.QC();this.Mc=ig.a.jTa(this.Mc);this.gX(this.Mc);this.dirty=!1}VO(b){if(!Object(Cb.a)(rk.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}N$e(b,h,u,B){u=new Wd.Menu(this,h,u,B,null);b||(b={});b.CommandMenuOpen=this.OQh.CommandMenuOpen;b.CommandMenuClose=this.OQh.CommandMenuClose;b=new fl(this,h,b,u);this.SCb[h]=b;h=new rk.a(this,"dock"+h);h.xf(b.YQ("Menu"));this.xf(h);this.refresh()}Hfg(b,h,u,B){const Q=this.SCb[b];if(Le.c(Q))throw Error.create('The dialog menu "'+
b+'" does not exist');Q.aYm(new Sys.UI.Bounds(h,u,0,0),B);this.M9a=Q.menu}B7e(b){b=this.SCb[b];Le.c(b)||(b.ava(),this.M9a=null)}Y6d(){this.M9a=null}dispose(){const b=this.SCb;for(let h in b)b[h].dispose();super.dispose()}}Object(m.a)(Ul,"DialogMenuRoot",Tm.a,[]);class yj{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(m.a)(yj,"RootProperties",null,[]);class Xj extends yj{constructor(){super()}}Object(m.a)(Xj,"StandaloneRootProperties",yj,[]);class nm extends Xj{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(m.a)(nm,"DialogMenuRootProperties",Xj,[]);class fn{constructor(){const b=new nm;b.ImageSideArrow=v.AFrameworkApplication.$s;b.ImageSideArrowClass=ze.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Gd=new Ul("DialogMenuRootId",b);this.Gd.CF=this;this.Gd.refresh();v.AFrameworkApplication.va.fb(Za.a.h0f,Ad.a.frame,Object(z.a)(this,this.h0f,"populateDialogMenu"),96)}get N1(){return this.Gd}XOa(b,h,u,B,Q=null){b=parseInt(b);B=v.AFrameworkApplication.va;
u&&(B.KC=u.CommandLocation,B.y0=u.InvocationMethod);h=B.Rb(b,2,h,Q);this.Gd.refresh();return 32===h}nGa(b){return b?32===v.AFrameworkApplication.va.processAction(parseInt(b),1):!0}vu(){this.N1.root.Bm()}N$e(b,h,u){const B={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};B.DialogMoveCommand=h;B.DialogCloseCommand=u;this.N1.N$e(B,b,"","")}Hfg(b,h,u,B){this.N1.Hfg(b,h,u,B)}B7e(b){this.N1.B7e(b)}h0f(b,h,u,B,Q){if(1===u)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',Q.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',Q.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");Q.PopulationXML=b.toString();return 32}dispose(){this.Gd&&
(this.Gd.dispose(),this.Gd=null)}}Object(m.a)(fn,"DialogMenuRootUser",null,[279,10,609]);class ep{constructor(b,h,u){this.utb=this.Kwd=this.Uyc=this.ul=null;this.KDe=this.Zvd=!1;this.$uc=b;this.ee=h;this.us=u;this.KXb=v.AFrameworkApplication.isRtl}get Czf(){return this.KDe}Qvl(b){b?(this.ul=b,this.KDe=!0,this.Zvd=!1,this.ee.capture(Object(z.a)(this,this.IWm,"keyEventHandler"),null),this.us.ob(Kd.a.pointerDown,this.$uc,Object(z.a)(this,this.zhc,"pointerDownHandler")),this.Uyc||this.sal(),this.ul.appendChild(this.Uyc),
this.vym()):r.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}tif(){this.KDe=!1;this.Kwd=this.utb=null;this.sYn();this.f6f();this.ul=null}f6f(){this.ee.releaseCapture();this.us.sc(Kd.a.pointerDown,this.$uc,Object(z.a)(this,this.zhc,"pointerDownHandler"))}vym(){if(this.ul.style.left.endsWith("px")&&this.ul.style.right.endsWith("px"))this.utb=new Sys.UI.Point(Kn.a.PY(this.KXb?this.ul.style.right:this.ul.style.left),Kn.a.PY(this.ul.style.top));else{const b=this.KXb?this.$uc.offsetWidth-
(this.ul.offsetLeft+this.ul.offsetWidth+Kn.a.PY(this.ul.style.marginRight)):this.ul.offsetLeft-Kn.a.PY(this.ul.style.marginLeft),h=this.ul.offsetTop-Kn.a.PY(this.ul.style.marginTop);this.Rlj(b,h);this.utb=new Sys.UI.Point(b,h)}this.Kwd=this.utb}sal(){this.Uyc=ze.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}sYn(){this.Uyc.parentNode===this.ul&&this.ul.removeChild(this.Uyc)}IWm(b){if(!this.Czf)return!1;b.Hb.preventDefault();if(b.eventName===Kd.a.$h){const h=b.Hb.ctrlKey?
1:10;let u;switch(b.Hb.keyCode){case Se.a.m6:this.ufc(0,-1*h);break;case Se.a.yea:this.ufc(0,1*h);break;case Se.a.uoc:u=this.KXb?1:-1;this.ufc(u*h,0);break;case Se.a.zrb:u=this.KXb?-1:1;this.ufc(u*h,0);break;case Se.a.yJa:this.iOi(this.Kwd.x,this.Kwd.y);this.Zvd=!0;break;case Se.a.Ls:this.Zvd=!0}}b.eventName===Kd.a.sh&&this.Zvd&&this.tif();return!0}zhc(b){if(!this.Czf)return!1;b.Hb.preventDefault();this.tif();return!0}ufc(b,h){this.iOi(this.utb.x+b,this.utb.y+h)}iOi(b,h){b=this.Jyk(b,h);this.Rlj(b.x,
b.y);this.utb=b}Rlj(b,h){this.KXb?this.ul.style.right=b+"px":this.ul.style.left=b+"px";this.ul.style.top=h+"px"}Jyk(b,h){const u=this.KXb?Kn.a.PY(this.ul.style.marginRight):Kn.a.PY(this.ul.style.marginLeft),B=Kn.a.PY(this.ul.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-u,b),this.$uc.offsetWidth-this.ul.offsetWidth-u),Math.min(Math.max(-B,h),this.$uc.offsetHeight-this.ul.offsetHeight-B))}}Object(m.a)(ep,"KeyMoveAdapter",null,[610]);var Hl=c(1127),Nq=c(567);class $h{get name(){return"CUI.Behavior"}wc(b){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(609,"Common.UI.IDialogMenuRootUser").ha().Sd(()=>new fn),b.register(610,"Common.IKeyMoveAdapter").ha().Sd(()=>new ep(v.AFrameworkApplication.ua.koa(),Nb.KeyInputManager.instance,Hh.a.instance)));b.register(Nq.a,"CommandUI.RootManager").as("Common.IRootManager").ha().Sd(()=>Nq.a.instance)}init(){Hl.a.N9e=zm.instance;const b=Nq.a.instance.nej;for(let h=0;h<b.length;++h){const u=Object(Na.a)(611,b[h]);u&&u.ROa()}Yk.a.get_instance().iI(6)}dispose(){}static main(){M.a.instance.Gc(new $h,
5)}}Object(m.a)($h,"CuiBehaviorPackage",null,[1,2]);class so{constructor(b){const h=new Xj;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=ze.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=ze.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=ze.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=ze.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=
ze.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=ze.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=ze.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.xdb=Tm.a.Ncl(h);this.xdb.refresh()}get eea(){return this.xdb}dispose(){this.xdb.dispose()}}Object(m.a)(so,"StandaloneRootController",null,[850,10]);var Vn=c(1152),zj=c(162);class Vo{constructor(b){this.qBc=b}create(b,h){const u=new Sys.StringBuilder;this.bKc(u,
b,h);this.jaf(u,b);return u.toString()}HCb(b,h){const u=[];this.Vaf(u,b,h);this.kaf(u,b);return u}bKc(b,h,u){switch(h.errorType){case 0:b.append(this.qBc.build());break;case 1:case 2:b.append(this.v4e(h,u))}}Vaf(b,h,u){switch(h.errorType){case 0:b.push(this.qBc.Lxh());break;case 1:case 2:b.push(this.BLk(h,u))}}jaf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(zj.a("btnIgrnoreSpellingError",(2===h.errorType?Ob.a.pJa:Ob.a.Ywa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,
null));b.append("</Controls></MenuSection>")}kaf(b,h){const u=Object.assign(new wh.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";u.ControlList.push(Object.assign(new yg.a,{ExternalId:h}));b.push(u)}v4e(b,h){b=this.nJl(b.suggestions,h);return 0<b.length?zj.g("msUnknownWord",zj.d(null,b),"Menu16"):zj.g("msUnknownWord",zj.d(null,[zj.a("btnNoSuggestions",Ob.a.pJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}nJl(b,h){const u=[];if(b){const B=Math.min(h.length,
b.length);for(let Q=0;Q<B;++Q)b[Q]&&u.push(zj.a("btnCorrectWord"+Q,h[Q].toString(),b[Q]))}return u}BLk(b,h){const u=Object.assign(new wh.a,{Id:"Suggestions",ControlList:[]});this.mJl(b.suggestions,h,u.ControlList);0>=u.ControlList.length&&(b=Object.assign(new yg.a,{ExternalId:"NoSuggestions"}),u.ControlList.push(b));return u}mJl(b,h,u){if(b){const B=Math.min(h.length,b.length);for(let Q=0;Q<B;++Q){if(!b[Q])continue;const ca=Object.assign(new yg.a,{ExternalId:"btnCorrectWord"+Q,Command:h[Q].toString(),
LabelText:b[Q]});u.push(ca)}}}}Object(m.a)(Vo,"DefaultProofingContextMenuCreator",null,[]);var Il=c(711);class Xp{constructor(b,h){this.eQg=b;this.iSg=h;this.mma=[Ob.a.Dqb,Ob.a.Eqb,Ob.a.Fqb,Ob.a.pRb,Ob.a.qRb]}create(b,h){return h?Object(Cb.a)(Il.a,h)?this.iSg.create(b,h,this.mma):this.eQg.create(h,this.mma):""}s5b(b,h){return h?Object(Cb.a)(Il.a,h)?this.iSg.HCb(b,h,this.mma):this.eQg.HCb(h,this.mma):null}}Object(m.a)(Xp,"ProofingContextMenuSectionFactory",null,[630]);class wr{build(){const b=[zj.a("btnDeleteRepeatedWord",
Ob.a.gEa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return zj.g("msRepeatedWord",zj.d(null,b),"Menu16")}Lxh(){const b=Object.assign(new wh.a,{ControlList:[]}),h=Object.assign(new yg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(m.a)(wr,"ProofingRepeatedWordSectionBuilder",null,[629]);class xl{static get Yg(){return Hf.a.Bz(xl.Sm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,
Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}xl.Sm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(m.a)(xl,"AutoCorrectOptionsDialogHTML",null,[]);class cs{static get Yg(){return Hf.a.Bz(cs.Sm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}cs.Sm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(m.a)(cs,"AutoCorrectOptionsDialogHTML2",null,[]);class sp extends Hf.a{constructor(b,h){super();this.Qdo=(u,B)=>{1!==u?r.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):B.ReplaceTextAsYouType!==this.SV.nTa||B.CapitalizeFirstLetterOfSentences!==this.SV.lEd||B.ReplaceOrdianalsWithSuperscript!==this.SV.ide||B.ReplaceHyphensWithDash!==this.SV.l6c||B.ReplaceFractionsWithFractionCharacter!==this.SV.hde||this.Ifa&&B.ReplaceQuoteWithSmartQuote!==
this.SV.i8f?(u={},u.ReplaceTextAsYouType=B.ReplaceTextAsYouType,u.CapitalizeFirstLetterOfSentences=B.CapitalizeFirstLetterOfSentences,u.ReplaceOrdianalsWithSuperscript=B.ReplaceOrdianalsWithSuperscript,u.ReplaceHyphensWithDash=B.ReplaceHyphensWithDash,u.ReplaceFractionsWithFractionCharacter=B.ReplaceFractionsWithFractionCharacter,this.Ifa&&(u.ReplaceQuoteWithSmartQuote=B.ReplaceQuoteWithSmartQuote),this.SV.D8n(u),r.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:B.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:B.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:B.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:B.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:B.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Ifa,["ReplaceQuoteWithSmartQuote"]:this.Ifa&&B.ReplaceQuoteWithSmartQuote}),Fb.App.za.updateCommandUI(!0)):r.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.SV=b;this.Ifa=h;this.ug="AutoCorrectOptionsDialog"}Yfg(){r.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Yg=this.Ifa?cs.Yg:xl.Yg;const b={};b.ReplaceTextAsYouType=this.SV.nTa;b.CapitalizeFirstLetterOfSentences=this.SV.lEd;b.ReplaceOrdianalsWithSuperscript=this.SV.ide;b.ReplaceHyphensWithDash=this.SV.l6c;b.ReplaceFractionsWithFractionCharacter=this.SV.hde;this.Ifa&&(b.ReplaceQuoteWithSmartQuote=
this.SV.i8f);this.Qh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.Qdo,b)}}Object(m.a)(sp,"AutoCorrectOptionsDialog",Hf.a,[628]);class jq{static get Yg(){return Hf.a.Bz(jq.Sm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}jq.Sm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(jq,"AltTextDialogWithDescriptionHtml",null,[]);class Oq{static get Yg(){return Hf.a.Bz(Oq.Sm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Oq.Sm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Oq,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Jo extends Hf.a{constructor(b=!1,h=!1){super(!1,!1,b);this.lni=!1;h?(this.lni=!0,this.Yg=Oq.Yg):this.Yg=jq.Yg;this.ug=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}t$e(b){this.Qh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.mAk,"altTextDialogHandler"),this.Kof(b));b=document.getElementById(Jo.l0e)||document.getElementById(Jo.PBd);b.focus();b.select()}Kof(b){const h={};this.lni?h[Jo.tsm]=!0:h[Jo.l0e]=
this.Hmf(b);h[Jo.PBd]=this.sTl(b)||"";return h}Kva(b){return b.uf.id===Jo.PBd?!1:super.Kva(b)}}Jo.l0e="titleText";Jo.PBd="descriptionText";Jo.tsm="hideTitleField";Object(m.a)(Jo,"BaseAltTextDialogWithDescription",Hf.a,[]);var Zi=c(32);class yn extends Jo{constructor(b,h,u,B,Q){super();this.Gk=h;this.Om=u;this.Zs=B;this.Pd=Q;this.Bqb=this.RT=null;this.t$e(b)}sTl(b){this.RT=b.node;this.Bqb=Zi.TableReader.Ugi(b);return Zi.TableReader.Ptf(this.Bqb)}Hmf(b){this.RT=b.node;this.Bqb=Zi.TableReader.Ugi(b);
return Zi.TableReader.Qtf(this.Bqb)}mAk(b,h){if(1===b){b=Zi.TableReader.Qtf(this.Bqb);const u=Zi.TableReader.Ptf(this.Bqb),B=h[Jo.l0e];h=h[Jo.PBd];this.hide();const Q=this.Zs.Pc(15);try{Q.Db(this.RT),this.Gk.pdg(this.Bqb,B),this.Gk.Wlj(this.Bqb,h)}finally{Q&&Q.dispose()}B===b&&h===u||this.Pd.Us(16)}this.Om.So&&this.Om.Yp.$F(this.RT)}}Object(m.a)(yn,"TableAltTextDialog",Jo,[]);class to{constructor(b,h,u){this.nA=b;this.Kc=h;this.Ud=u}create(b){return new yn(b,this.nA,Fb.App.xd,this.Kc,this.Ud)}}Object(m.a)(to,
"TableAltTextDialogFactory",null,[]);const zn=()=>{Fb.App.erh=!0;return 32},uo=(b,h,u,B,Q)=>{if(1===u)return 32;if(!({point:b,Qx:h}=tp(Q)).returnValue)return 16;Fb.App.za.jlc(b,h);return 32},Ik=(b,h,u,B,Q)=>{if(1===u)return 32;if(!({point:b,Qx:h}=tp(Q)).returnValue)return 16;Fb.App.za.Tja(b,h);return 32},tp=b=>{let h=null,u=0;if(!b)return{returnValue:!1,point:h,Qx:u};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Qx:u};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));u=parseInt(b[2]);
return{returnValue:!0,point:h,Qx:u}};var Os=c(1837);class Nn extends Sys.EventArgs{constructor(b,h,u,B,Q,ca=0,qa=0,Qa=null){super();this.controlId=b;this.commandId=B;this.time=Q;this.commandSurface=ca;this.Qx=qa;this.contentType=Qa}}Object(m.a)(Nn,"CommandClickEventArgs",Sys.EventArgs,[]);class ds{constructor(b,h){this.Xsa=b.vof();this.tsc=b;this.G9a=h}XOa(b,h,u,B=null,Q=null){u&&(this.G9a.KC=u.CommandLocation,this.G9a.y0=u.InvocationMethod,this.G9a.fOa=u.CommandTabName);b=parseInt(b);let ca=this.tsc.Y7h(b,
h,u);ca.uRf&&(ca=this.tsc.Y7h(ca.oM,h,u));if(void 0!==ca.Z0a&&null!==ca.Z0a)return ca.Z0a;if(ca.kHb)Q=32;else{var qa=null;this.Xsa&&this.Xsa.E0f&&(qa=this.Xsa.E0f(ca,Q));ca.kia||ca.YWc?ca.AEa?Q=16:(Q=this.G9a.Rb(ca.oM,ca.Xcc?2:1,ca.Ad,Q),2===Q&&(Q=32)):ca.AEa?Q=this.G9a.Eqa(null,ca.oM,ca.Ad,Qa=>{B&&B(Qa.response)},Q):(Q=this.G9a.Rb(ca.oM,2,ca.Ad,Q),B&&B(Q));this.Xsa&&this.Xsa.x0f&&this.Xsa.x0f(ca,Q,qa);if(h&&u&&-1!==u.InvocationMethod&&u.InvocationMethod){u=h.LegacyId;if(void 0===u||null===u)u="";
qa=h.ParentMenuId;void 0!==qa&&null!==qa||!h.MenuId||(qa=h.MenuId);let Qa=h.SqmControlId;void 0!==Qa&&null!==Qa||!h.SourceControlId||(Qa=h.SourceControlId);(void 0!==Qa&&null!==Qa||void 0!==qa&&null!==qa)&&Os.a.jLn(new Nn(Qa,u,qa,dd.ActionManager.mba(b),Date.now()))}}ca.kia&&32===Q&&this.Xsa&&this.Xsa.YCa&&this.Xsa.YCa(ca,h);ca.YWc&&32===Q&&this.Xsa&&this.Xsa.j_a&&this.Xsa.j_a(ca,h);return 32===Q||1===Q}nGa(b,h=null){if(v.AFrameworkApplication.Lk||Bg.a.instance.Qv)return!1;null!=h&&null!=h.UILocation&&
(this.G9a.KC=h.UILocation);const u=parseInt(b);if(!b||u===dd.ActionManager.Egf)return!0;b=this.tsc.O7h(u,h);b.uRf&&(b=this.tsc.O7h(b.oM,h));if(void 0!==b.Z0a&&null!==b.Z0a)return b.Z0a;u===Za.a.Q1b&&h&&(b.Ad=h);return 32===this.G9a.Rb(b.oM,1,b.Ad)}clearCache(){this.tsc.clearCache()}}Object(m.a)(ds,"GeneralCuiUser",null,[278,279]);var Eq=c(195),lk=c(98),Yj=c(59),Jp=c(1067);class es{get qE(){return null!=this.bIg?this.bIg:this.bIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,h,
u,B){this.xRg="DocumentProofingFailed";this.wUe=b;this.shh=h;this.hgd=u;this.HI=B}$am(){const b=this.HI.f9l(this.wUe);return{returnValue:this.HI.eFa(this.wUe),RHn:b}}LUo(b,h){const u=lk.a.xr();if(u){var B=new Eq.ScriptSharpLegacyMap;B.add(Xe.a.rL,b);B.add(Jc.a.noProof,h);b=new Qg.GraphTransaction(15);b.Db(u);this.qE.ZRa(Yj.StyleReader.wordStyleIdNormal,B,u)?Jp.a.Mzj():(r.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Jp.a.recordQosError(this.xRg,[Jp.a.UAc],"Style could not be modified"));
b.dispose()}else r.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Jp.a.recordQosError(this.xRg,[Jp.a.UAc],"PageContentNode not found")}rfo(b,h){this.LUo(b,h)}Hko(b,h){if(this.shh){var u=new Od.DictionaryPropertySet;this.hgd.execute(B=>{B.wMc(b)});u.setValue(Xe.a.rL,b);u.setValue(Jc.a.noProof,h);h=new Qg.GraphTransaction(15);h.set(Fb.App.ni.zl);this.shh.E5(u);h.dispose()}}ef(){return Ge.SelectionEditor.ef(this.wUe)}}Object(m.a)(es,"LanguageEditor",null,[621]);var fp=c(608),Hn=c(248),
An=c(104);class Pq{constructor(b=!1,h=0){this.languages=Pq.Vfi(Jj.a.hSl());this.Hpd=new Hn.a;this.VSa=[];this.OZb=new fp.a;this.b6i=b;this.gbh=0>=h?7:h;this.fbh=this.MOe=0;this.BWg=!1;b&&(this.Ezm(),v.AFrameworkApplication.lI(()=>{this.K4m()}))}Ezm(){for(var b of this.languages)this.Hpd.Z(b.LCID,b);b=[];try{const B=ac.a.get("RecentlyUsedLcids");if(B&&""!==B){const Q=decodeURIComponent(B).split(",").slice(0,this.gbh);for(const ca of Q){let qa;({value:qa}=this.Hpd.Fc(parseInt(ca),qa)).returnValue&&
b.push(qa)}}}catch(B){r.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",B.message),Array.clear(b)}if(b.length)for(var h of b){var u=h.LCID;this.OZb.contains(u)||(this.VSa.push(h),this.OZb.add(u))}else h=v.AFrameworkApplication.lcid,({value:u}=this.Hpd.Fc(h,u)).returnValue&&(this.VSa.push(u),this.OZb.add(h));this.pfj()}pfj(){const b=An.toArray(An.select(An.asEnumerable(this.VSa),h=>h.LCID)).join(",");ac.a.aUa("RecentlyUsedLcids",
b,180)}X_l(b){let h,u=-1,B=null;var Q=Pq.Vfi(this.VSa);this.b6i&&0<Q.length&&(B=An.toArray(An.Si(An.asEnumerable(Q),(Qa,rb)=>{b===Qa.LCID&&-1===u&&(u=rb);return{["key"]:rb,["text"]:Qa.displayName,["value"]:Qa.LCID.toString()}})));let ca=0;B&&(ca=B.length);Q=ca;const qa=An.toArray(An.Si(An.asEnumerable(this.languages),(Qa,rb)=>{b===Qa.LCID&&-1===u&&(u=ca+rb);return{["key"]:ca+rb,["text"]:Qa.displayName,["value"]:Qa.LCID.toString()}}));h=u;return 0<ca?{returnValue:B.concat.apply(B,qa),selectedIndex:h,
htj:Q}:{returnValue:qa,selectedIndex:h,htj:Q}}Bho(b,h){if(this.b6i&&({value:u}=this.Hpd.Fc(b,u)).returnValue){h=b!==h;if(this.OZb.contains(b))b=Array.indexOf(this.VSa,u),0<=b&&(Array.removeAt(this.VSa,b),this.VSa.push(u)),h&&this.MOe++;else{this.OZb.add(b);this.VSa.push(u);if(this.VSa.length>this.gbh){var u=this.VSa.shift();this.OZb.remove(u.LCID)}h&&this.fbh++}this.pfj()}}K4m(){const b=this.MOe+this.fbh;!this.BWg&&0<b&&(r.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.MOe/b),this.BWg=!0)}static Vfi(b){b=Array.clone(b);b.sort((h,u)=>h.displayName.localeCompare(u.displayName));return b}}Object(m.a)(Pq,"LanguageListHelper",null,[620]);var Yp=c(193);class Kp extends Yp.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(Kp,"NumberButtonProps",Yp.a,[]);var On=c(213);class hi{static get N5(){return null!=hi.xFg?hi.xFg:hi.xFg=Ga.a.instance.Oa("Box4.ISpacingCommands")}static get Xg(){return On.ContextSetEditor.instance}static get xGa(){return null!=
hi.tCg?hi.tCg:hi.tCg=Ga.a.instance.Oa("Box4.ILineSpacingHelper")}static get Yoj(){return!!hi.N5}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.Fhc,vc.a.view,hi.Fhc);b.Xc(Ob.a.Fhc,1124);b.ra(Ob.a.Fhc,vc.a.paragraph,hi.TUo)}static Fhc(b,h,u,B,Q){if(1===u||!hi.Yoj)return hi.Yoj?32:8;if(!hi.Cyi){var ca=[];ca.push(Object.assign(new Kp,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new Kp,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new Kp,
{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new Kp,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));ca.push(Object.assign(new Kp,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ca.push(Object.assign(new Kp,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));Q.MenuItems=zj.e(ca);hi.Cyi=!0}r.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.mb;ca=null;h&&h.hb.lb&&(ca=h.hb.lb);h=hi.Xg.i2h(ca.Pa);v.AFrameworkApplication.va.Kf(h,b,u,!0,B,Q);return 32}static TUo(b,
h){let u=b=!0;h=hi.xGa.hFa(h.node);var B=h.beforeSpacing;let Q=!1;1===B.unit&&(Q=!0);if(Q||0<B.value)b=!1;h=h.afterSpacing;B=!1;1===h.unit&&(B=!0);if(B||0<h.value)u=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(hi.stk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(hi.dZn,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(hi.rtk,!u));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(hi.cZn,u));return 32}}hi.stk="AddSpaceBeforeParagraph";
hi.rtk="AddSpaceAfterParagraph";hi.dZn="RemoveSpaceBeforeParagraph";hi.cZn="RemoveSpaceAfterParagraph";hi.Cyi=!1;Object(m.a)(hi,"LineSpacingRibbonMenu",null,[]);var mk=c(178),ps=c(1689),xr=c(1386),Zj=c(133);const Ko=(b,h,u)=>{if(1===u)return 32;b=Fb.App.za.notificationBar.sva("Automation test",!1);b.image=3;Fb.App.za.notificationBar.qA(b);return 32},Qq=(b,h,u,B,Q)=>{let ca;if(!({fHj:ca}=Wn(Q)).returnValue)return 16;mk.UISurfaces.IM().then(qa=>{let Qa=null;var rb=Object.assign(new ps.a,{label:"OK",
onExecute:()=>{Qa&&qa.removeNotification(Qa)}});rb=Object.assign(new xr.a,{target:"#"+Zj.AppFrame.W9f,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:rb,useTeachingStyles:ca});rb=qa.callout(rb);Qa=qa.addNotification(rb);return null},qa=>{r.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",qa);return null});return 32},Wn=b=>{let h=!1;if(!b)return{returnValue:!1,fHj:h};h=Boolean.parse(b);return{returnValue:!0,fHj:h}};var gr=c(1471);let gl,kn,
yl,Lo,Lp;class up{constructor(){this.u7=new zb.a;this.Z0g=!1}VZa(b){const h=this.u7.indexOf(b);let u=!0;if(-1!==h){u=!1;if(!h)return u;this.u7.removeAt(h)}this.u7.insert(0,b);r.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.u7.count&&(r.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.u7.J(10)),this.u7.removeAt(10));this.tWo();return u}Ene(b){let h="#";for(let B=0;B<this.u7.count;B++){var u="#"+this.u7.J(B).substring(4,
6)+this.u7.J(B).substring(2,4)+this.u7.J(B).substring(0,2);u=Object.assign(new gr.a,{Color:this.u7.J(B),Alt:u,DisplayColor:u});if(u.DisplayColor.toLowerCase()===b.toLowerCase()){h=u.Color;break}}for(const B of up.cbh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(B,h))}tWo(){r.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let u=0;u<this.u7.count;u++){var h="#"+this.u7.J(u).substring(4,6)+this.u7.J(u).substring(2,
4)+this.u7.J(u).substring(0,2);h=Object.assign(new gr.a,{Color:this.u7.J(u),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const u of up.cbh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(u,b));this.Z0g||this.qVo();this.Z0g=!0}qVo(){for(const b of Object.keys(up.E5g)){r.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=up.E5g[b],u=[];for(const B of h)u.push(appChrome.api.menuSection([B],B in
up.IJe?up.IJe[B].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,u,up.IJe[b].toString()))}}}up.E5g={["FontColor"]:(Lp=new zb.a,Lp.add("AutomaticFontColor"),Lp.add("ThemeFontColorPickerMCU"),Lp.add("ThemeFontColorPicker"),Lp.add("StandardFontColorPicker"),Lp.add("RecentFontColorPicker"),Lp.add("MoreFontColors"),Lp),["CellShading"]:(Lo=new zb.a,Lo.add("ThemeShadingColorPickerMCU"),Lo.add("ThemeShadingColorPicker"),Lo.add("StandardShadingColorPicker"),Lo.add("RecentCellShadingColorPicker"),
Lo.add("ClearShadingColor"),Lo.add("MoreCellShadingColors"),Lo),["PictureBorders"]:(yl=new zb.a,yl.add("ThemePictureBorderColorPickerMCU"),yl.add("ThemePictureBorderColorPicker"),yl.add("StandardPictureBorderColorPicker"),yl.add("RecentPictureBorderColorPicker"),yl.add("MorePictureBorderColors"),yl.add("NoPictureBorder"),yl.add("PictureBorderWeightOptions"),yl.add("PictureBorderStyleOptions"),yl),["PageColor"]:(kn=new zb.a,kn.add("ThemePageColorPickerMCU"),kn.add("ThemePageColorPicker"),kn.add("StandardPageColorPicker"),
kn.add("RecentPageColorPicker"),kn.add("NoPageColor"),kn.add("MorePageColors"),kn)};up.IJe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["PageColor"]:Box4Intl.Box4Strings.L_PageColor};up.cbh=(gl=new zb.a,gl.add("RecentFontColorPicker"),gl.add("RecentCellShadingColorPicker"),gl.add("RecentPictureBorderColorPicker"),
gl.add("RecentPageColorPicker"),gl);Object(m.a)(up,"RecentColorsSectionHandler",null,[]);var Gm=c(1413),ql=c(1064);class ln{constructor(b){this.Nck=b}f5(){}d5(b){this.Nck.Qfn(b)}}Object(m.a)(ln,"DataBuddyActionListener",null,[27]);class eo{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(m.a)(eo,"DataBuddyTaskPaneProps",null,[]);class om{constructor(b){this.isVisible=!1;this.rZ=new zb.a;this.Dre=null;this.w3=b;this.kB=new Gm.a;this.Vb=
hd.FocusManager.instance()}initialize(){this.Dre=new ln(this);this.w3.tOa();this.kB.AL(this.Ask());this.kB.AL(this.Cpk())}toggle(){this.isVisible?this.hide():this.show()}Qfn(b){if(2===b.behavior){const h=dd.ActionManager.mba(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.rZ.add(h+": "+om.eKl(b.response)),this.Hm())}}hide(){mk.UISurfaces.Mu().then(b=>{b.hideTaskPane(om.iC,2);return null})}show(){mk.UISurfaces.Mu().then(b=>{b.showTaskPane(om.iC,this.vA());return null});this.isVisible&&
mk.UISurfaces.Mu().then(b=>{b.setSelectedTaskPane(om.iC);return null})}Ask(){return b=>{b.actions=this.rZ.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}Cpk(){return b=>{b.onClearClick=()=>{this.rZ.clear();this.Hm()}}}Tb(){v.AFrameworkApplication.va.WY(this.Dre)}M8a(){v.AFrameworkApplication.va.eSb(this.Dre)}vA(){const b=new eo;this.kB.vpb(b);return Object.assign(new ql.a,{title:"Data Buddy",hideHeader:!1,width:om.width,location:2,contentProps:b,onOpen:()=>{this.u$();
this.Tb();this.isVisible=!0;v.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.$da();this.M8a();this.isVisible=!1;this.Hm();v.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0})}Hm(){mk.UISurfaces.Mu().then(b=>{b.updateTaskPane(om.iC,this.vA());return null})}u$(){this.Vb.kg(om.iC)}$da(){this.w4a()&&this.Vb.kg(this.Vb.XT)}w4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===om.iC}static eKl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";
case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}om.iC="DataBuddyTaskPane";om.width=300;Object(m.a)(om,"Box4DataBuddyTaskPane",null,[605]);class Bn{constructor(b){this.Lh=b}sJa(b){this.Lh&&this.Lh.cH(b)}pcd(){this.Lh&&this.Lh.Dcd(void 0)}}Object(m.a)(Bn,"RibbonButtonUpdater",null,[604]);var $k=c(370);class mn{constructor(){this.GSe=this.W=null}get name(){return"Box4.UI"}wc(b){this.W=b;b.ia("Box4.IGeneralCuiUser",
()=>new ds(b.resolve("Box4.UI.CuiActionBridge"),v.AFrameworkApplication.va)).ha();b.ia("Box4.UI.TableAltTextDialogFactory",()=>new to(b.resolve("Box4.ITableEditor"),new $k.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.UI.ILanguageEditor",()=>new es(xf.a.instance.ng,b.Oa("Box4.ITextFormattingCommands"),b.Ta("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ia("CommandUI.StandaloneRootController",()=>new so(v.AFrameworkApplication.$s)).as("Common.IStandaloneRootController").ha();
b.ia("Box4.UI.IAutoCorrectOptionsDialog",()=>new sp(b.resolve("Box4.IAutoCorrectOptionsInfo"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new Pq(v.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();b.register(wr,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();b.ia("Box4.UI.DefaultProofingContextMenuCreator",()=>new Vo(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();
b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new Xp(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ia("Box4.RibbonButtonUpdater",()=>new Bn(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ia("Box4.UI.RecentColorsSectionHandler",()=>new up).ha();b.ia("Common.IDataBuddyTaskPane",()=>new om(Vn.a.instance)).ha()}init(){var b=Fb.App.za;const h=
b.Lb;nc.xxm(Object(z.a)(h,h.LLb,"onAuthenticationLost"),Object(z.a)(h,h.MLb,"onAuthenticationRestored"),b.FRk);b=v.AFrameworkApplication.va;b.ra(Ob.a.NEn,vc.a.application,zn);b.fb(Ob.a.tto,vc.a.application,uo,96);b.fb(Ob.a.auo,vc.a.application,Ik,96);b=v.AFrameworkApplication.va;b.fb(Ob.a.Mvo,vc.a.application,Ko,96);b.fb(Ob.a.jto,vc.a.application,Qq,96);hi.Tb();this.Lzm();this.GSe=this.W.resolve("Common.IStandaloneRootController")}Lzm(){this.W.Ta("Box4.IGeneralCuiUser").execute(b=>{this.W.Ta("Common.IStandaloneRootController").execute(h=>
{h.eea.CF=b})})}dispose(){this.GSe.dispose();this.GSe=null}static main(){M.a.instance.Gc(new mn,6)}}Object(m.a)(mn,"Box4UIPackage",null,[1,2]);var Wo=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Am=c(1852);class Om{get name(){return"Box4.Insights"}init(){}dispose(){}wc(b){b.ia("Box4.Insights.Box4InsightsSelection",
()=>new Am.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(m.a)(Om,"Box4InsightsPackage",null,[1,2]);const nn=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var Um=c(400),hm=c(544),Vl=c(1821);class pm{Amb(){return!1}reset(){}update(){}}Object(m.a)(pm,"NullTaskYieldStrategy",null,[603]);var fo=c(1417);class Fq{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=
this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(Fq,"CatchUpConfiguration",null,[]);class Mp{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=
this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(Mp,"SharedControllerFactoryParameters",null,[]);var hk=c(161),Qc=c(15);class aa{constructor(b,h,u,B){this.Ksn=(Q,ca)=>{(this.rnd=!this.rnd)&&ca.ek&&ca.ek.contextId===vc.a.Tc&&this.eCh(ca.ek.node,ca.ek.Ij);return 32};this.hy=b;this.Zp=h;this.ga=u;this.Vb=B;this.fpd=this.gpd=null;this.rnd=!1;this.ga.ra(Qc.a.hyj,vc.a.view,this.Ksn);this.Vb.ae($d.AFrame.xp).bindAction(Nb.KeyInputManager.ic(Se.a.Jpc,6),Qc.a.hyj)}MY(b,h){this.rnd&&
this.Zp&&h&&h.pl&&h.pl.lb&&h.pl.lb.Pa&&h.pl.lb.Pa.node&&h.pl.lb.Pa.contextId===vc.a.Tc&&this.eCh(h.pl.lb.Pa.node,h.pl.lb.Pa.Ij)}eCh(b,h){b&&(this.cQi(b)?(this.gpd&&this.gpd.id.equals(b.id)||(this.Zp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.gpd=b),this.p7m(b,h)):this.fpd=this.gpd=null)}cQi(b){return 0<this.hy.cGb(b).count}p7m(b,h){if(b){var u=-1,B=null,Q=null;for(let ca=0;ca<b.qa.length;ca++){const qa=b.qa.J(ca);if(!(null==Q||qa.changeStart&&
qa.changeStart.equals(B))&&h>=u&&h<=qa.cp&&!B.equals(this.fpd))if(this.hy.XIb(B)){(b=this.hy.wOc(B,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Zp.sendNotification(b,!1),this.fpd=B);break}else this.fpd=null;qa.changeStart&&!qa.changeStart.equals(B)&&(u=qa.cp,B=qa.changeStart);Q=qa.changeStart}}}}Object(m.a)(aa,"ActivityAnnouncementManager",
null,[]);var na=c(1387),ub=c(536),hc=c(770),wc=c(593);class fd{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(fd,"Activity",null,[]);var wd=c(392);class Sd extends fd{constructor(){super();this.Hv=this.objectId=null}static ZG(b){const h=new wc.a(new wd.a);if(b.Hv)for(const u of b.Hv)h.add(u);return h}}Object(m.a)(Sd,"RevisionSetActivity",fd,[]);class Pe{constructor(b,h,u,B=!1){this.awe=
null;this.dismiss=()=>{this.yQi.then(Q=>{Q.removeNotification(this.awe);return this.awe=null})};this.mX=b;this.nc=h;this.yQi=u;this.Icc=B}uNo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.nc.Rb(Za.a.w5a,2,null);break;default:this.Vfn()}else r.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}Vfn(){this.yQi.then(b=>{var h=Object.assign(new xr.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,
content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new na.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const u=Object.assign(new ub.a,{expirationOptions:Object.assign(new hc.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.awe=b.addNotification(h,u)})}doesContentExist(b){if(!b)return r.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return r.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.nc.Rb(Za.a.WKd,2,h))return!1;break;case 1:return this.ipl(b)}return!0}ipl(b){b=Sd.ZG(b);return b?0<this.mX.cRd(b).count:(r.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(m.a)(Pe,"ActivityContentManager",null,[664]);var wf=c(1484),rg=c(2050),Dg=c(391),Ye=c(703);class Sg{constructor(){this.Hv=this.gY=null}compare(b){if(!b)return!1;
if(this.gY&&b.gY){if(this.gY.count!==b.gY.count)return!1;for(const h of this.gY)if(!b.gY.contains(h))return!1}else if(!b.gY&&this.gY||!this.gY&&b.gY)return!1;if(b.Hv&&this.Hv){if(b.Hv.count!==this.Hv.count)return!1;for(const h of this.Hv)if(!b.Hv.contains(h))return!1}else if(!this.Hv&&b.Hv||!b.Hv&&this.Hv)return!1;return!0}}Object(m.a)(Sg,"ActivityHighlightableObject",null,[]);class Eg extends wf.a{constructor(b,h){super();this.XNe=this.CZb=null;this.rfd=b;this.hy=h;this.V2=[new rg.a(Dg.a.MAh,Dg.a.LAh),
new rg.a(Dg.a.JAh,Dg.a.IAh),new rg.a(Dg.a.qEd,Dg.a.rEd),new rg.a(Dg.a.sEd,Dg.a.T5e)]}get Djb(){return 1}get a3a(){return this.V2}get Aca(){return!0}v2a(b,h){if(b=Object(Na.a)(Sg,b))if(b.gY)for(const u of b.gY)h.add(u);else r.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}jHa(b,h){if(this.zr.VDa){var u=this.rfd.k7a,B=this.rfd.Fjb,Q=!!u&&u.compare(B),ca=this.zr.VDa,qa=ca.action,Qa=this.cqo(ca,b),rb=!1;2!==qa&&qa&&(rb=(rb=this.zr.DYc)?1===rb.type:!!u||!!B);h=h.FHa("*");
for(let Lb=0,Yb=h.length;Lb<Yb;Lb++){const gc=h[Lb],Fc=this.HUl(gc,Dg.a.sHc);if(Fc&&Fc.ku)if(this.UXn(gc),1===ca.type)switch(qa){case 0:Qa&&u.Hv.contains(Fc.ku)&&this.oCd(gc,2,Fc,!1);break;case 2:Qa&&B.Hv.contains(Fc.ku)&&this.oCd(gc,Q?2:1,Fc,!1);break;default:this.jac(b,gc,Fc,!1)}else rb?this.jac(b,gc,Fc,!1):this.jac(b,gc,Fc,!0)}this.CZb&&(this.CZb.classList.add(Dg.a.sEd),this.XNe=this.CZb=null)}}HUl(b,h){return ed.a.Eb(b,h)}cqo(b,h){if(b&&b.GA){const u=b.GA,B=b.action;if(1===b.type&&(2===B||!B)&&
u.gY)return u.gY.contains(h);if(u.Hv)for(const Q of u.Hv){b=this.hy.QPc(Q);for(const ca of b)if(ca===h)return!0}}return!1}jac(b,h,u,B){const Q=this.rfd.k7a,ca=this.rfd.Fjb;Q&&Q.Hv.contains(u.ku)&&(!Q.gY||Q.gY.contains(b))?this.oCd(h,2,u,B):ca&&ca.Hv.contains(u.ku)&&(!ca.gY||ca.gY.contains(b))&&this.oCd(h,1,u,B)}oCd(b,h,u,B){b&&Ye.a(b)&&(b.classList.add(this.FYl(2===h,B)),this.Ogo(b,u,B))}Ogo(b,h,u){this.CZb?-1!==h.cpEnd&&this.XNe.cpEnd!==h.cpBegin&&(this.CZb.classList.add(u?Dg.a.T5e:Dg.a.sEd),b.classList.add(u?
Dg.a.rEd:Dg.a.qEd)):b.classList.add(u?Dg.a.rEd:Dg.a.qEd);b.classList.add(Dg.a.KAh);this.CZb=b;this.XNe=h}UXn(b){this.zr.gTa(b);this.LWn(b)}LWn(b){b.classList.remove(Dg.a.qEd,Dg.a.rEd,Dg.a.KAh,Dg.a.sEd,Dg.a.T5e)}FYl(b,h){return h?b?Dg.a.IAh:Dg.a.LAh:b?Dg.a.JAh:Dg.a.MAh}}Object(m.a)(Eg,"ActivityHighlightActor",wf.a,[]);var mh=c(2051),Dh=c(166);class Qj{constructor(b,h,u,B,Q,ca,qa,Qa){this.nW=b;this.hO=h;this.hy=u;this.Ick=Q;this.ib=ca;this.Zp=Qa;this.Vb=qa;this.hO.C_d=!1}AWi(b,h,u){b?this.Dsm(b,h,u):
this.hO.k7a&&(b=Object.assign(new mh.a,{action:1,type:1,GA:null,SJ:this.hO.k7a}),this.hO.k7a=null,this.nW.EF(b))}Dsm(b,h,u){if(h){b=new wc.a(new wd.a);for(Q of h){var B=this.hy.XOc(Q);for(let ca=0;ca<B.length;ca++){const qa=B[ca];this.hy.XIb(qa)&&b.add(qa)}}var Q=this.hy.cRd(b);Q=this.zJh(Q,b);B=this.hO.k7a;this.hO.k7a=Q;Q=Object.assign(new mh.a,{action:0,type:1,GA:this.hO.k7a,SJ:B});this.nW.EF(Q);u&&!this.c$n(h.J(0),b)||this.Rao(h.J(0),b)}else r.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}c$n(b,h){if(!b)return r.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return r.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.MRl(b,h);return this.Ick.FTa(b.id,h)?this.Bc(b,h)?!0:!1:(r.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}Rao(b,h){b=this.GYl(b,h);h=new Sys.StringBuilder;for(let u=0;u<
b.count;u++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,u+1,b.count,b.J(u)));this.Zp.sendNotification(h.toString(),!0)}Bc(b,h){if(!b||!me.ParagraphReader.Wb(b))return r.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return r.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.hO.C_d=!0;b=Je.a.Oc(b,h);b=new Dh.Selection([b],!0);this.ib.Bc(b);hd.FocusManager.iK()&&this.Vb.kg($d.AFrame.Un);
return!0}MRl(b,h){if(h&&0<h.count)for(let u=0;u<b.qa.length;u++){const B=b.qa.J(u);if(B.changeStart&&h.contains(B.changeStart))return B.cp}r.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}GYl(b,h){const u=new zb.a;if(h&&0<h.count&&b){let B=-1;for(let Q=0;Q<b.qa.length;Q++){const ca=b.qa.J(Q);if(-1!==B&&ca.Ar)if(ca.changeStart&&h.contains(ca.changeStart))continue;else u.add(b.characterData.substring(B,ca.cp)),B=-1;ca.changeStart&&
h.contains(ca.changeStart)&&(B=ca.cp)}}return u}HVi(b,h){if(b)switch(b.type){case 1:if(h){b=new wc.a(new wd.a);for(var u of h){h=this.hy.XOc(u);for(let B=0;B<h.length;B++){const Q=h[B];this.hy.XIb(Q)&&b.add(Q)}}}else b=Sd.ZG(b);h=this.hy.cRd(b);this.hO.Fjb=this.zJh(h,b);u=Object.assign(new mh.a,{action:2,type:1,GA:this.hO.Fjb,SJ:null});this.nW.EF(u)}else this.hO.Fjb&&(u=Object.assign(new mh.a,{action:3,type:1,GA:null,SJ:this.hO.Fjb}),this.hO.Fjb=null,this.nW.EF(u))}zJh(b,h){var u=null;if(b){u=new Ca.a;
for(const B of b)12===B.type&&u.add(B)}b=new Sg;b.gY=u;b.Hv=h?h:this.B3l(u);return b}B3l(b){const h=new wc.a(new wd.a);if(!b)return h;for(const u of b)for(const B of this.hy.cGb(u))h.add(B);return h}}Object(m.a)(Qj,"ActivityHighlightManager",null,[]);var Mh=c(504),Bi=c(463),hl=c(1482),Vm=c(111),Do=c(58);class on{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(m.a)(on,"CreateIndicatorTooltipParameters",null,[]);class vp{constructor(){this.clearSticky=
!1}}Object(m.a)(vp,"DismissIndicatorTooltipParameters",null,[]);class Zp{constructor(){this.target=null;this.isSticky=!1}}Object(m.a)(Zp,"UpdateIndicatorTooltipParameters",null,[]);class fs extends Sys.EventArgs{constructor(b,h,u){super();this.xEb=b;this.Dpi=h;this.fro=u}}Object(m.a)(fs,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class pn{constructor(){this.Epi=new Map;this.Fpi=new Set}kKo(b,h){this.Fpi.add(b);this.Epi.set(b,h)}uMm(b){return Qd.a.cwi(b.htmlElement)}yim(){const b=new Set;for(const h of this.Fpi){const u=
this.Epi.get(h);u&&this.tMm(u)&&b.add(h)}return b}tMm(b){return b.parentElement&&Qd.a.cwi(b.parentElement)}}Object(m.a)(pn,"IndicatorVisibilityTracker",null,[]);class qn extends hl.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){super();this.sa=new Nc.a;this.vvb=this.Aaa=null;this.rom=(gc,Fc,Sc,ld,Hd)=>{if(!Hd)return r.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Fc=Sd.ZG(Hd.Activity);gc=null;if(Hd.NodeId&&(Hd=Vm.b(Hd.NodeId),!W.a.zq(Hd,W.a.nil)&&(Hd=this.hy.j9h(Hd),
this.Gmg(Hd,!1))))return 32;for(const Ie of Fc)if(this.hy.XIb(Ie)){Hd=this.hy.f9b(Ie);if(this.Gmg(Hd,!0))return 32;Hd&&!gc&&(gc=Hd)}if(this.Gmg(gc,!1))return 32;r.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.pom=(gc,Fc,Sc,ld,Hd)=>{r.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Hd&&Fc&&Fc.Vk&&(gc=Fc.node)&&((gc=this.cqc.oRd(gc))?this.hAd(gc,!1,!1):r.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.Ovo=gc=>{(gc=this.cqc.oRd(gc.customData))&&this.hAd(gc,!1,!1)};this.onMouseEnter=gc=>this.MUi(gc.Uw,!0);this.jqa=gc=>{gc=gc.Uw;if(gc===this.Aaa)return!0;this.h9i(gc);return!0};this.$Ga=gc=>{this.vvb=null;return this.MUi(gc.Uw,!1)};this.Z0=()=>{this.Bgg();this.oFd(!0);return!1};this.ht=()=>{this.pZi()};this.Z8d=()=>{this.Aaa&&this.HEj(this.Aaa);this.vvb&&this.h9i(this.vvb);this.cnn()};this.pZi=()=>{this.Aaa?
this.HEj(this.Aaa):this.V6e()};this.hy=b;this.Nre=h;this.FYg=u;this.c5j=B;this.sxb=Q;this.T6=null;this.Ib=qa;this.cqc=Qa;this.ODe=new pn;this.yx=rb;this.CK=Lb;this.GI=Yb;this.zk&&(this.zk.Cma(this.Z8d),this.zk.Eph(this.pZi));ca&&ca.execute(gc=>{gc.XY(this.ht)})}get zk(){return this.sxb&&this.sxb.Vi?this.sxb:(r.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}sna(b,h,u){if(this.Aaa){var B=Do.a(this.Aaa);if(b===B)return this.Aaa}const Q=b.Tg.ownerDocument;B=Mh.a.createElement(Q,
Bi.a.div);B.className=Dg.a.tEd;B.style.left=h+"px";B.style.top=u+"px";h=Mh.a.createElement(Q,Bi.a.div);h.className=this.yx?Dg.a.SAh:Dg.a.NAh;B.style.cursor="pointer";h.style.cursor="pointer";this.GI&&(h.style.backgroundColor=this.CK.uOl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.CK.vOl());B.appendChild(h);vf.a.instance.ob(Kd.a.TR,B,this.onMouseEnter);vf.a.instance.ob(Kd.a.uL,B,this.jqa);Wi.a.instance.ob(Kd.a.click,B,this.$Ga);vf.a.instance.ob(Kd.a.contextMenu,
B,this.Z0);r.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.w3m(b);h=this.v4l(b);this.ODe.kKo(h,B);this.ODe.uMm(b)&&this.bUi(h);return B}G7a(b){return this.Yoo(b)}q0a(b){const h=this.tPk(b),u=[];u.push(this.sna(b.d1,h,b.Hoc[0].y-b.B4[0].y));return u}tPk(b){let h=Dg.a.Ewm+(0>b.TYc?-b.TYc:0);const u=kf.a.Ki(b.leftMargin,0)/2;1>=u&&r.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>u?u:h;h=h<Dg.a.OAh?Dg.a.OAh:h;return v.AFrameworkApplication.isRtl?
b.B4[0].width/this.zoom+h:-h}koj(b){if(b&&393230===b.Nc||393251===b.Nc){const h=this.hy.cGb(b);if(h)for(const u of h)if(b===this.hy.f9b(u))return!0}return!1}Yoo(b){for(const h of me.ParagraphReader.vw(b.Bb,!0,!1))if(this.koj(h))return!0;return!1}Tb(b){b.ra(Qc.a.Upj,vc.a.Tc,this.pom);b.ra(Qc.a.Ufg,vc.a.Tc,this.rom)}Gmg(b,h){if(!b)return!1;const u=this.cqc.oRd(b);if(u)return this.hAd(u,!1,!0),!0;if(!h){let B;this.R4c((B=new zb.a,B.add(b),B),!1,!0,!0);h=new bf.a(3,1,0,this.Ovo,181);h.customData=b;this.Ib.Xb(h);
return!0}return!1}m$k(b,h=!1){h&&this.oFd(!0);if(b&&b.parentNode){var u=this.$tf(b);u=this.qKl(u);this.T6||(this.T6=document.createElement("Div"),document.getElementById(v.AFrameworkApplication.I2b).appendChild(this.T6));this.Nre.createActivityIndicatorTooltip(Object.assign(new on,{target:b,container:this.T6,activityIds:u,isSticky:h,dirHint:9}));h&&(this.Aaa=b)}else r.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Stl(b){b&&
b.classList.add(Dg.a.uEd)}MUi(b,h){return this.hAd(b,h,!1)}hAd(b,h,u){if(h&&b===this.Aaa)return!0;const B=this.$tf(b);h||this.Bgg();this.m$k(b,!h);this.Stl(b.getElementsByClassName(this.yx?Dg.a.SAh:Dg.a.NAh)[0]);this.R4c(B,h,!0,u);this.cJi(B,h?1:2);this.c5j.I2d();h&&(this.vvb=b);return!0}oFd(b=!1){this.Nre.dismissActivityIndicatorTooltips(Object.assign(new vp,{clearSticky:b}));this.vvb=null;b&&(this.Aaa=null)}Brj(b){b&&b.classList.remove(Dg.a.uEd)}Bgg(){this.Aaa&&this.Brj(this.Aaa.getElementsByClassName(Dg.a.uEd)[0])}h9i(b){const h=
this.$tf(b);this.R4c(h,!0,!1,!1);this.Brj(b.getElementsByClassName(Dg.a.uEd)[0]);this.oFd(!1);this.vvb=null}$tf(b){let h=null;(b=(b=Do.a(b))?b.Bb:null)&&11===b.type&&(h=me.ParagraphReader.vw(b,!0,!1));return h}V6e(){const b=!!this.vvb;if(this.Aaa||b)this.Bgg(),this.oFd(!0),this.R4c(null,!1,!1,!1),this.R4c(null,!0,!1,!1)}Cuk(b){this.sa.addHandler(qn.hmh,b)}Duk(b){this.sa.addHandler(qn.imh,b)}R4c(b,h,u,B){let Q=null;if(u&&b){for(const ca of b)if(u=this.hy.XOc(ca))for(let qa=0;qa<u.length;qa++){const Qa=
u[qa];if(this.hy.XIb(Qa)){Q=this.hy.wOc(Qa,ca.id);break}}if(!Q){r.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(qn.hmh,new fs(Q,b,!1)):this.sa.raiseEvent(qn.imh,new fs(Q,b,B))}qKl(b){const h=[];if(b)for(const B of b){var u=this.hy.cGb(B);for(const Q of u)(u=this.hy.wOc(Q,B.id))&&h.push(u.activityId)}!h.length&&b&&b.count&&r.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}HEj(b){b&&b.parentNode?(this.Nre.updateActivityIndicatorTooltip(Object.assign(new Zp,{target:b,isSticky:!0})),this.Aaa=b):r.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}cnn(){const b=this.ODe.yim();for(const h of b)this.bUi(h)}bUi(b){this.FYg.bJi(b,3)}v4l(b){return(b=me.ParagraphReader.vw(b.Bb,!0,!1))&&b.count?b.J(0).id:null}w3m(b){b=me.ParagraphReader.vw(b.Bb,!0,!1);this.cJi(b,0)}cJi(b,
h){b&&b.count&&this.v3m(b.J(0).id,h)}v3m(b,h){this.FYg.bJi(b,h)}}qn.hmh="ActivityIndicatorPreviewed";qn.imh="ActivityIndicatorSelected";Object(m.a)(qn,"ActivityIndicatorActor",hl.a,[]);var gf=c(36);class cm{constructor(b,h,u){this.hy=b;this.jyd=h;this.sxb=u}get zk(){return this.sxb&&this.sxb.Vi?this.sxb:(r.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}oRd(b){r.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.i$h(b);if(!h){r.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.hy.cGb(b);for(const u of b)if(b=this.hy.f9b(u),b=this.i$h(b))return b}return h}i$h(b){if(!b||12!==b.type)return r.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return r.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.jyd.GGb(b);if(!h||11!==h.type)return r.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.pe(this.zk.$b);if(!h||!h.htmlElement)return r.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var u=kc.a.YOc(h.htmlElement,cm.gmh);if(u)return u;h=h.DNd();if(!h)return r.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=kc.a.iPl(h,cm.gmh);if(!h)return r.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(u=0;u<h.length;u++){const B=Do.a(h[u]),Q=gf.OutlineElementNavigator.Hl(b);if(B&&B.Bb&&Q&&B.Bb.id.equals(Q.id))return h[u]}r.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}UZl(b){b=this.hy.j9h(b);if(!b||12!==b.type)return r.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
W.a.nil;b=this.oRd(b);if(!b)return r.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),W.a.nil;b=Do.a(b);return b?b.Bb.id:(r.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),W.a.nil)}}cm.gmh="CatchUpActivityIndicatorContainer";Object(m.a)(cm,"ActivityIndicatorHelper",null,[]);var vo=c(1690);class Cn{constructor(b,h,u,B,Q,ca,qa){this.fxa=
b;this.pageContentNode=h;this.hYe=u;this.nc=B;this.mX=Q;this.Ne=ca;this.pYd=qa;this.iDi=!1;this.o8m=(Qa,rb,Lb)=>{if(1===Lb)return this.Jxf?32:8;2===Lb&&(this.Jxf&&(this.hYe.V6e(),this.iWk()),r.ULS.sendTraceTag(38138719,377,50,G.c({["MarkAsRead invoked"]:!0})));Fb.App.za.updateCommandUI();return 8};this.fxa.dTa(this.hYe)}initialize(){this.nc.ra(Qc.a.ILi,Ad.a.frame,this.o8m)}get Jxf(){return!!this.mX.UR&&0<this.mX.UR.count||!!this.mX.Efc&&0<this.mX.Efc.count}get FVm(){return this.iDi}VXf(b){const h=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.pYd||0<h||!b){const u=new Map;u.set("activityCount",h.toString());this.Ne.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:u})}b?(this.Mhn(b.wywaActivities),this.iDi=!0):(r.ULS.shipAssertTag(36538305,377,!1),this.pYd||Object(vo.a)(),this.Ne.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}Mhn(b){b?(r.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.qno(b),b=this.mX.Wtk(b),this.rno(b)):r.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}qno(b){if(b){var h=new zb.a;for(const u of b)switch(u.type){case 2:case 3:case 4:case 10:b=4===u.type?u.WZi:u.contentId,h.add(b),this.mX.Efc.add(b)}0<h.count&&(r.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.nc.Rb(Za.a.sPi,2,h.toArray()))}}rno(b){const h=new wc.a(new wd.a),u=new Qg.GraphTransaction(3);try{u.Db(this.pageContentNode);for(const B of b){const Q=this.mX.f9b(B);Q&&this.hYe.koj(Q)&&
(h.add(Q.id),this.fxa.pIb(Q,!0))}}finally{u&&u.dispose()}0<b.count&&Fb.App.za.updateCommandUI();b={};b.highlightedNodeCount=h.count;r.ULS.sendTraceTag(36509257,377,50,"{0}",G.c(b))}iWk(){r.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.mX.Efc.count&&(this.nc.Rb(Za.a.NRh,2,this.mX.Efc.toArray()),this.mX.Efc.clear());const b=this.jYk(this.mX.UR);this.FWn(b)}FWn(b){r.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new Qg.GraphTransaction(3);try{h.Db(this.pageContentNode);for(const u of b){this.mX.UR.remove(u);for(const B of this.mX.QPc(u))this.fxa.pIb(B,!0)}this.mX.PCh()}finally{h&&h.dispose()}}jYk(b){const h=new wc.a(new wd.a);for(const u of b)h.add(u);return h}}Object(m.a)(Cn,"ActivityIndicatorManager",null,[]);class hr{constructor(){this.Fjb=this.k7a=null;this.isFirstDocumentOpen=this.C_d=!1}}Object(m.a)(hr,"ActivityStateManager",null,[661]);class Mo{constructor(b,h){this.Ngd={};this.AUb=b;this.EK=
h;this.Efc=new zb.a}get UR(){return this.AUb.UR}cGb(b){const h=new wc.a(new wd.a);if(!b)return h;b=this.AUb.APd(b);for(let u=0;u<b.length;u++){const B=b[u];this.XIb(B)&&h.add(B)}return h}QPc(b){return this.AUb.QPc(b)}cRd(b){const h=new zb.a;if(b)for(const u of b)h.addRange(this.QPc(u));return h}Wtk(b){const h=new wc.a(new wd.a);if(b)for(const u of b)if(1===u.type&&(b=u))for(const B of b.Hv){h.add(B);this.UR.add(B);const Q=B.toString();this.Ngd[Q]||(this.Ngd[Q]=new zb.a);this.Ngd[Q].add(b)}this.PCh();
return h}XIb(b){return this.UR&&b?this.UR.contains(b):!1}wOc(b,h){if(b&&(b=this.Ngd[b.toString()])&&0<b.count){for(const u of b)if(u.objectId.equals(h))return u;return b.J(0)}return null}f9b(b){return this.AUb.f9b(b)}PCh(){this.AUb.VVk()}XOc(b){return this.AUb.XOc(b)}j9h(b){if(!this.EK)return null;const h=this.EK.Lc;return h?h.Eb(b):null}}Object(m.a)(Mo,"ChangeIdCache",null,[]);var Rq=c(152),Gq=c(102);class Sq extends Rq.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new Gq.a,{T_:Sq.getTypeName(),B_:Sq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(m.a)(Sq,"ChangeSummariesResponse",Rq.a,[]);var Np=c(442);class kq extends Np.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Gq.a,{T_:kq.getTypeName(),B_:kq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(kq,"ChangeSummariesRequest",Np.a,[]);var ak=c(331),Hm=c(369),Wl=c(240),gp=c(368);class ir{constructor(){this.Cic=this.J6c=null}}Object(m.a)(ir,"ActionPair",null,[]);class Pn{constructor(b,h,u,B){this.Jtl=Q=>{Q=Q.customData;const ca=this.G8i(Q);ca&&(r.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.jrf(Q)),ca.Cic("Request timeout"))};this.oA=b;this.PV=h;this.Oe=u;this.Ib=B;this.QDe=null;this.gOe=
new tb.a;this.Ybh=new tb.a}ACo(b){const h=Object.assign(new ak.a,{parentPath:["Signal",kq.getTypeName()],items:[Object.assign(new Hm.a,{body:b})]});return this.initialize().then(()=>{const u=new Promise((B,Q)=>{this.gOe.Z(b.requestId,Object.assign(new ir,{J6c:B,Cic:Q}))});this.Ybh.Z(b.requestId,new Date);r.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Pn.requestTimeoutMs);this.PV.getAugLoopRuntimeManager().submitOperation(Object.assign(new gp.a,
{operation:h}));this.cko(b.requestId);return u})}initialize(){this.QDe||(this.QDe=this.oA.Uk().then(()=>{this.Oe.ob(this,Sq.getTypeName())}));return this.QDe}GB(b,h){if(b&&Wl.a.getTypeNameFor(b.content)===Sq.getTypeName())if(b=b.content){var u=this.G8i(b.correspondingRequest);u?h!==ak.a.getTypeName()?u.Cic("Invalid operation type"):(r.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.jrf(b.correspondingRequest)),
u.J6c(b)):r.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.jrf(b.correspondingRequest))}else r.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else r.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}cko(b){const h=new bf.a(3,1,Pn.requestTimeoutMs,
this.Jtl,176);h.Vzd=0;h.customData=b;this.Ib.Xb(h)}G8i(b){if(!b)return null;let h;if(!({value:h}=this.gOe.Fc(b,h)).returnValue)return null;this.gOe.remove(b);return h}jrf(b){if(!b)return-1;let h;return({value:h}=this.Ybh.Fc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return v.AFrameworkApplication.K.lc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(m.a)(Pn,"ChangeSummariesAugloopProvider",null,[292]);class zt{constructor(){this.activityGroups=null}}Object(m.a)(zt,
"FeaturedActivityGroupPayload",null,[]);class yr{constructor(b,h,u,B,Q){this.vfk=b;this.aVj=h;this.SWj=u;this.A_j=B;this.ksb=Q}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.A_j.Sxb.then(()=>this.DVl(b)):yr.Fgf}Klm(b,h,u){if(!h)return r.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;nn("TranslateFeaturedActivityGroups");u=this.SWj.YKo(b,h,u.wywaActivities);r.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<u.length);this.ksb.set(h.correspondingRequest,u);return Object.assign(new zt,{activityGroups:u})}DVl(b){nn("BuildFeaturedActivityGroupRequest");const h=this.vfk.qLk();if(!h||!h.documentContent||!h.activityChanges)return r.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
yr.Fgf;if(!h.documentContent.length||!h.activityChanges.length)return yr.Fgf;r.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);nn("SubmitFeaturedActivityGroupRequest");return this.aVj.ACo(h).then(u=>this.Klm(h,u,b))}}yr.Fgf=Promise.resolve(Object.assign(new zt,{activityGroups:[]}));Object(m.a)(yr,"ChangeSummariesDataProvider",null,[660]);class Ia{constructor(b,h){this.hy=b;this.gkk=h}qLk(){const b=new zb.a,
h=new zb.a,u=new wc.a(new wd.a);var B=this.hy.UR;if(!B||!B.count)return Ia.Igf;B=this.hy.cRd(B);if(!B||!B.count)return r.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Ia.Igf;for(const Q of B)u.contains(Q.id)||(u.add(Q.id),this.JGn(Q,b,h));return h.count&&b.count?Object.assign(new kq,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Vm.a(W.a.create())}):Ia.Igf}JGn(b,h,u){if(me.ParagraphReader.Wb(b)){var B=
me.ParagraphReader.Hda(b);if(B&&B.length){h.add(B);B=this.hy.cGb(b);B=this.Tkm(B);for(const Q of B){B=new zb.a;const ca=this.getTextRanges(b,Q);for(const qa of ca)B.add({changeEnd:qa.endIndex,changeSpanId:qa.Xco,changeStart:qa.startIndex,contentIndex:h.count-1,locationId:Vm.a(b.id)});(B=this.a7k(Q,B.toArray()))&&u.add(B)}}else r.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else r.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}Tkm(b){const h=
new tb.a;for(const u of b)(b=this.idi(u))?(h.nb(b)||h.Z(b,new wc.a(new wd.a)),h.J(b).add(u)):r.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}a7k(b,h){const u=[];let B=null;for(const Q of b)if(b=this.hy.wOc(Q,W.a.nil)){if(!B){const ca=this.idi(Q);if(!ca||!ca.length){r.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}B=
ca}u.push(b)}else r.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return u.length?B?h.length?{activityId:u[0].activityId,changes:h,personId:B,timestamp:u[0].displayTimestamp.toISOString()}:(r.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(r.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(r.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}idi(b){b=this.hy.wOc(b,W.a.nil);if(!b)return r.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return r.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const u=new zb.a;if(!h||!h.count||!b)return u;let B=-1,Q=new wc.a(new wd.a);for(let ca=0;ca<b.qa.length;ca++){const qa=b.qa.J(ca);if(-1!==B&&qa.Ar){if(qa.changeStart&&h.contains(qa.changeStart)){Q.add(qa.changeStart);continue}u.add({startIndex:B,endIndex:qa.cp,Xco:this.gkk.Zhj(Q)});B=-1;Q=new wc.a(new wd.a)}qa.changeStart&&h.contains(qa.changeStart)&&(B=qa.cp,Q.add(qa.changeStart))}return u}}Ia.Igf=Object.assign(new kq,{activityChanges:[],
documentContent:[],requestId:Vm.a(W.a.nil)});Object(m.a)(Ia,"ChangeSummariesRequestBuilder",null,[]);class Db{constructor(){this.changes=this.content=null}}Object(m.a)(Db,"ContentChange",null,[]);class lc{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(m.a)(lc,"FeaturedActivityGroup",null,[]);class Gc{constructor(){this.end=this.start=0}}Object(m.a)(Gc,"TextRange",null,[]);class id{constructor(b){this.cqc=b}YKo(b,h,u){if(!h)return r.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),id.zLd;if(!h.inferences)return r.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),id.zLd;if(!h.activityClassifications)return r.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),id.zLd;if(!h.inferences.length||!h.activityClassifications.length)return r.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),id.zLd;const B=[],Q=new Oa.a(new wd.a);for(const ca of h.inferences){const qa=this.XKo(ca,b,h,u);if(!qa)continue;const Qa=this.cqc.UZl(Vm.b(qa.locationId));Qa.equals(W.a.nil)?B.push(qa):Q.nb(Qa)?Q.J(Qa).ranking>qa.ranking&&Q.Z(Qa,qa):Q.add(Qa,qa)}b=[...Array.from(Q.values),...B];b.sort((ca,qa)=>ca.ranking-qa.ranking);return b.slice(0,id.D9m)}XKo(b,h,u,B){if(!b||Cl.a.Xe(b.activitiesInGroup))return r.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const Q=new zb.a,ca=new tb.a;let qa=null;for(const rb of b.activitiesInGroup){if(!rb){r.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>rb.activityIndex||rb.activityIndex>=u.activityClassifications.length){r.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Lb=u.activityClassifications[rb.activityIndex];if(!Lb||Cl.a.Xe(Lb.contents))r.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Qa=this.gBl(B,Lb.activityId);if(Qa){Q.add(Qa);for(const Yb of rb.changes){if(!Yb){r.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Qa=Yb.value;if(0>Qa||Qa>=Lb.contents.length){r.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Qa=Lb.contents[Qa];if(!Qa){r.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const gc=h.documentContent[Qa.contentIndex],Fc=Object.assign(new Gc,{start:Qa.changeStart,end:Qa.changeEnd});if(ca.nb(gc))ca.J(gc).add(Fc);else{let Sc;ca.Z(gc,(Sc=new zb.a,Sc.add(Fc),Sc))}qa||(qa=Qa.locationId)}}else r.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!Q.count)return r.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.Lgm(ca);return h.count?Object.assign(new lc,{ranking:b.ranking.value,reasons:[1],activities:Q.toArray(),contentChanges:h.toArray(),locationId:qa}):(r.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}gBl(b,h){for(const u of b)if(u&&u.activityId&&u.activityId===h)return u;return null}Lgm(b){const h=new zb.a;for(const B of b){b=B.key;const Q=B.value;Q.Sc((ca,qa)=>ca.start-qa.start);var u=Q.J(0).start;if(u>id.jMi){u-=id.jMi;b=b.substring(u,b.length);for(const ca of Q)ca.start-=u,ca.end-=u}h.add(Object.assign(new Db,{content:b,changes:Q.toArray()}))}return h}}id.zLd=[];id.jMi=10;id.D9m=4;Object(m.a)(id,"ChangeSummariesResponseTranslator",null,[]);class je{constructor(){this.ksb=new tb.a;this.qPe=
new tb.a}set(b,h){if(h.length&&b){this.ksb.Z(b,h);for(const u of h)if(u.activities)for(const B of u.activities)B&&B.activityId?this.qPe.Z(B.activityId,b):r.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else r.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.ksb.nb(b)?this.ksb.J(b):null}r6m(b){return b&&this.qPe.nb(b)?this.qPe.J(b):null}}Object(m.a)(je,"FeaturedActivityGroupCache",null,
[]);class ef{constructor(b){this.d2d=(h,u,B,Q,ca)=>{if(!ca)return r.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ca.Activity;if(!h)return r.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;u=this.ksb.r6m(h.activityId);if(!u)return r.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;B=Sd.ZG(h);r.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",u,h.activityId,this.Zhj(B));return 32};this.ksb=b;this.RMg=new Map}Tb(b){b.ra(Qc.a.d2d,Ad.a.frame,this.d2d)}Zhj(b){let h=0;const u=Array(b.count);for(const B of b)b=this.o5l(B),u[h]=Vm.a(b),h++;return u.join(",")}o5l(b){let h=this.RMg.get(b);if(h&&h!=W.a.nil)return h;h=W.a.create();this.RMg.set(b,h);return h}}Object(m.a)(ef,"FeaturedActivityGroupTelemetryActor",
null,[]);var Fa=c(76);class Ua extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(m.a)(Ua,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class sb{constructor(b,h,u){this.fO=null;this.bLo=B=>{this.JZa.reset();B=this.Cgm(B.customData);let Q=null;for(;B.moveNext();){const ca=B.currentNode;if(ca&&(me.ParagraphReader.Wb(ca)&&this.sa.raiseEvent("OPV",new Ua(ca)),this.JZa.update(),this.JZa.Amb())){Q=ca;break}}Q?this.Goh(Q):this.fO(!0)};this.Ib=b;this.JZa=h;this.EK=u;this.sa=new Nc.a;this.Sxb=new Promise(B=>
{this.fO=B})}rwk(b){this.sa.addHandler("OPV",b)}oIk(){this.Goh(null)}Goh(b){const h=new bf.a(3,1,0,this.bLo,182);h.customData=b;this.Ib.Xb(h)}Cgm(b){if(!b)return Fa.a.ap(this.EK);b=vd.GraphIterator.eb(b);b.zb(7);return Fa.a.zs(b,this.EK)}}Object(m.a)(sb,"DocumentTraverser",null,[]);class oc{constructor(b){this.nc=b}shouldShowEmptyExperienceButton(){return v.AFrameworkApplication.J0d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.nc.Rb(Za.a.Cie,
2,null)}onInviteOthersButtonClick(){this.nc.Rb(Za.a.K8,2,null)}}Object(m.a)(oc,"EmptyCatchUpBehaviorManager",null,[657]);class Dc{constructor(b,h){this.uFl=()=>{const u=document.getElementById("flyoutItem0");u&&(r.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),u.focus())};this.hp=b;this.Vb=h}initialize(){const b=this.Vb.ae($d.AFrame.Q3b);b.$H=!0;b.parent=$d.AFrame.xp;b.cga(this.uFl);this.hp.wT($d.AFrame.Q3b)}enableF6Focus(){this.hp.QI($d.AFrame.Q3b)}disableF6Focus(){this.hp.$w($d.AFrame.Q3b)}}
Object(m.a)(Dc,"FlyoutFocus",null,[656]);var Xc=c(416);class rd{constructor(b,h,u){this.TLg=this.tWg=this.Lwc=this.Wnd=!1;this.JAe=this.xgd=null;this.Ypn=(B,Q,ca,qa,Qa)=>{Qa[gg.a.Visible]=!0;Qa[gg.a.On]=this.Lwc&&this.Wnd;return 32};this.Lsn=(B,Q,ca)=>{if(1===ca)return this.Wnd?(this.tWg||(this.tWg=!0,r.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.xgd)return r.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.TLg=!0;this.xgd();return 32};this.ga=b;this.zUg=h;this.Vb=u}get Dkf(){return this.JAe?this.JAe:(r.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Dkf(b){this.JAe=b}initialize(){this.Tb()}registerButtonClickedEvent(b){this.xgd&&r.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.xgd=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Wnd&&r.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.Dkf.getTime();r.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.Wnd=!0;(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||Xc.a.eSa("ribbon","catchUp");Fe.c(Za.a.rSk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.Lwc!==b.flyoutIsVisible&&
(this.Lwc=b.flyoutIsVisible,Fb.App.za&&Fb.App.za.updateCommandUI(!0),this.Lwc&&this.TLg&&this.Vb.kg($d.AFrame.Q3b),this.Lwc||this.zUg&&this.zUg.M1m())}logFlightTriggers(b){b.hasFlyoutData&&v.AFrameworkApplication.le("WoCha187;WoCha187cf")}Tb(){this.ga.ra(Za.a.lyj,Ad.a.frame,this.Lsn);this.ga.fb(Za.a.p4i,Ad.a.frame,this.Ypn,96)}}Object(m.a)(rd,"FlyoutRibbonButton",null,[652]);var Vd=c(149);class Ee{constructor(b,h){this.UR=null;this.UXd=this.Gzi=!1;this.mX=b;this.Ne=h;this.kkb=new Vd.a;this.zXd=new Map;
this.kkb.Z(1,new wc.a(new wd.a));this.kkb.Z(0,new wc.a(new wd.a));this.kkb.Z(2,new wc.a(new wd.a));this.kkb.Z(3,new wc.a(new wd.a));this.zXd.set(3,"CatchUpIndicatorVisible");this.zXd.set(1,"CatchUpIndicatorPreviewed");this.zXd.set(2,"CatchUpIndicatorSelected");this.dde=0}bJi(b,h){if(this.kkb.J(h).add(b)){this.x3m(h);switch(h){case 0:r.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:r.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:r.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:r.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.$Bh()}}mpn(b){this.Zul();b=this.mX.cGb(b);for(const h of b)if(this.UR.remove(h)){this.dde++;break}}Zul(){if(!this.UR){this.UR=new wc.a(new wd.a);for(const b of this.mX.UR)this.UR.add(b)}}Qzk(){r.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.dde);this.$Bh()}$Bh(){this.dde&&
(this.hUk(),this.STk())}hUk(){!this.Gzi&&.5<=this.kkb.J(0).count/this.dde&&(this.Gzi=!0,Fe.c(Za.a.tSk),r.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}STk(){if(!this.UXd){var b="";1<=this.kkb.J(1).count&&(this.UXd=!0,b="previews");1<=this.kkb.J(2).count&&(this.UXd=!0,b="selections");this.UXd&&(Fe.c(Za.a.mSk),r.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}x3m(b){(b=this.zXd.get(b))&&this.Ne.logKpiUsage(b,0)}}Object(m.a)(Ee,"IndicatorTelemetryActor",
null,[]);var of=c(483);c(1082);class qh{constructor(b,h){this.p9c=b;this.tHc=h}Bim(){return this.tHc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return of.b(this.p9c.requestActivities(b,h))}getRelevantActivities(b,h){return this.tHc.promise.then(u=>u.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(u.getRelevantActivitiesResponse):of.b(this.p9c.requestRelevantActivities(b,h)))}updateActivityState(b){return of.b(this.p9c.updateActivityState(b))}getActivityFeed(){return this.tHc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):of.b(this.p9c.requestActivityFeed()))}updateWaterline(){return of.b(this.p9c.$2n())}}Object(m.a)(qh,"ActivityRepository",null,[]);var ri=c(1083),eg=c(1585);class mi{constructor(b,h,u,B,Q,ca=!1){this.activityContentManager=b;this.nc=h;this.$pl=u;this.Ne=B;this.Fwm=Q;this.Icc=ca}wMf(b){const h=new Map;h.set("activityType",b.type.toString());this.Ne.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}KLf(b){this.Ne.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}Adn(b){try{const h=b.activity;this.wMf(b.activity);1==h.type&&this.Fwm.I2d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.uNo(h),this.KLf("Content does not exist"),Promise.resolve(2);const u={};let B=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:u.ActivityId=h.activityId;u.NavigationId=atob(h.navigationId);B=this.nc.Rb(Za.a.e8e,2,u);break;case 1:u.Activity=
h,u.NodeId=b.locationId,B=this.nc.Rb(Qc.a.Ufg,2,u),u.NodeId&&this.nc.Rb(Qc.a.d2d,2,u)}8==B&&this.KLf("Action failed")}catch(h){return r.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.KLf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.$pl.Sxb.then(()=>this.Adn(b))}}Object(m.a)(mi,"WordActivityNavigationManager",null,[650]);var Aj;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";
b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Aj||(Aj={}));Object(m.b)("ProfilePhotoDimension",Aj);var Bj=c(775),qf=c(1483);class Ve{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(Ve,"ActivityFeedEntry",null,[]);const lf=(b,h)=>h.ZXc?An.toArray(An.select(An.asEnumerable(b),
u=>{if(!u||!u.activityFeedItemPayload)return u;const B=JSON.parse(u.activityFeedItemPayload);var Q=B.actor;if(!Q||Q.pictureUrl)return u;const ca=Q.userPrincipalName||Q.email;if(!ca)return u;Q=h.RCb(ca,Q.provider,v.AFrameworkApplication.km,0);if(!Q)return u;B.actor.pictureUrl=Q;return Object.assign(new Ve,{id:u.id,type:u.type,collectionId:u.collectionId,activityState:u.activityState,activityFeedItemPayload:JSON.stringify(B),timestamp:u.timestamp})})):b,og=(b,h)=>{const u=new Map,B=new Map;for(const Q of b){if(!Q||
!Q.activityFeedItemPayload)continue;b=JSON.parse(Q.activityFeedItemPayload).actor;if(!b)continue;const ca=b.email||b.userPrincipalName;ca&&!B.has(ca)&&B.set(ca,new Bj.a(ca,null,b.name))}B.forEach(Q=>{const ca=h.C$b(Q,6);u.set(Q.UserId,ca)});return u};var sg=c(507);class Cj{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(Cj,"ActivityRequestPayload",null,[]);class Ti{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(m.a)(Ti,"Person",null,[]);class Dj extends fd{constructor(){super();this.relationship=0}}Object(m.a)(Dj,"TaskActivity",fd,[]);class Ij extends fd{constructor(){super();this.contentId=null}}Object(m.a)(Ij,"CommentActivity",fd,[]);class Nk extends Ij{constructor(){super()}}Object(m.a)(Nk,"CommentReplyActivity",Ij,[]);class lq extends Ij{constructor(){super();this.WZi=null}}Object(m.a)(lq,"MentionActivity",Ij,[]);class Xn{constructor(b,
h,u,B){this.lsb=b;this.vMa=h;this.RAc=u;this.hO=B;this.hO.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.lsb.Bim().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.xaf("GetWYWAActivities",b);155===b.StatusCode&&(r.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.hO.isFirstDocumentOpen=!0);const h=this.cmg(b.People);return Object.assign(new Cj,{activities:this.Rle(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.lsb.getActivities(b,h).then(u=>{if(!u||u.StatusCode)throw this.xaf("GetActivities",u);const B=this.cmg(u.People);return Object.assign(new Cj,{activities:this.Rle(u.Activities,B),actors:B,hasMore:!u.RequestedRetrieved,highWaterline:u.HighWaterline,lowWaterline:u.LowWaterline})})}requestRelevantActivities(b){return this.lsb.getRelevantActivities(b,this.hO.isFirstDocumentOpen).then(h=>
{if(!h||h.StatusCode)throw this.xaf("GetRelevantActivities",h);const u=this.cmg(h.People),B=this.Rle(h.NewActivities,u,2);h=this.Rle(h.OutstandingActivities,u,3);for(const Q of h)B.push(Q);return Object.assign(new Cj,{activities:B,actors:u})})}updateActivityState(b){return this.lsb.updateActivityState(b)}requestActivityFeed(){return this.lsb.getActivityFeed().then(b=>({activityFeedItems:this.lAm(b),personaColorMap:this.IMk(b)}))}Rle(b,h,u=1){const B=[];if(!b)return B;for(const qa of b){var Q=null;
b=[];b.push(h[qa.CreatorIndex]);switch(qa.ActivityType){case 1:Q=qa;var ca=new Sd;ca.Hv=new zb.a;for(const Qa of Q.ChangeIds)ca.Hv.add(Vm.b(Qa));ca.objectId=Vm.b(Q.ObjectId);Q=ca;break;case 2:Q=qa;ca=new Ij;ca.contentId=Q.ContentId;ca.navigationId=Q.NavigationId;Q=ca;break;case 4:Q=qa;ca=new lq;b.push(h[Q.MentioneeIndex]);ca.WZi=Q.ParentContentId;ca.navigationId=Q.NavigationId;Q=ca;break;case 3:case 10:Q=qa;ca=new Nk;b.push(h[Q.RepliedIndex]);ca.contentId=Q.ContentId;ca.navigationId=Q.NavigationId;
Q=ca;break;case 6:case 7:case 8:case 9:Q=qa,ca=new Dj,b.push(h[Q.MentioneeIndex]),ca.navigationId=Q.NavigationId,ca.relationship=Q.Relationship,Q=ca}Q&&(Q.actors=b,Q.displayTimestamp=new Date(qa.DisplayTimestamp),Q.activityId=Vm.b(qa.ActivityId).toString(),Q.type=qa.ActivityType,1!==u&&(Q.relevancy=u),B.push(Q))}return B}K5n(b,h,u){return this.RAc&&this.RAc.ZXc?this.RAc.RCb(h,u,v.AFrameworkApplication.km,Aj.default):b}cmg(b){if(!b)return null;const h=Array(b.length);for(let u=0;u<b.length;u++){if(!b[u])continue;
const B=new Ti;B.id=b[u].Id;B.provider=b[u].Provider;B.displayName=b[u].DisplayName;B.email=b[u].Email;B.imageUrl=this.K5n(b[u].PictureUrl,b[u].Email,b[u].Provider);this.vMa&&(B.color=this.vMa.C$b(new Bj.a(B.email,void 0,B.displayName),qf.a.catchUpFlyout));h[u]=B}return h}xaf(b,h){let u="null";h&&(u=sg.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,u))}lAm(b){return this.RAc?lf(b,this.RAc):b}IMk(b){return this.vMa?og(b,this.vMa):new Map}}Object(m.a)(Xn,"WordActivityRequestManager",
null,[649]);class At{constructor(b,h,u){this.Tqd=0;this.$Ac=!1;this.H2g=null;this.updateWaterline=()=>{if(Fb.App.lostSession)r.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.$Ac||3>=this.Tqd){this.$Ac?this.$Ac=!1:this.Tqd++;const B=Math.max(this.Ga.lc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.H2g),0);r.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",B);ce.Task.delay(B).continueWith(()=>
{this.lsb.updateWaterline().then(()=>{this.Fee();return null}).catch(()=>{this.Fee();this.$Ac=!0;this.Tqd=0})})}else this.Fee()};this.Ga=b;this.lsb=u;h.kBd(()=>{this.$Ac=!0;this.H2g=new Date;this.Tqd=0})}start(){this.Fee()}Fee(){window.setTimeout(this.updateWaterline,6E4)}}Object(m.a)(At,"WordEditorActivityScheduler",null,[]);class jr{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}ieo(b){this.resolve(b)}}Object(m.a)(jr,"CatchUpNetworkRequestWorkerCache",null,[]);class rn{constructor(b,
h,u){this.jfl=b;this.K=h;this.Ne=u}VXf(b){b&&b.authors&&this.q3m(b.authors)}q3m(b){for(const h of b)h&&h.displayName===this.jfl&&(this.Ne.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),r.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.kb("PresenceUserId"),h.email===this.K.kb("UserPrincipalName")))}}Object(m.a)(rn,
"WywaAuthorComparator",null,[]);class $p{constructor(b){this.A1=b}I2d(){this.A1&&this.A1.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(m.a)($p,"IndicatorSurveyActor",null,[]);var hw=c(1056),ev=c(1048);class Ok{constructor(){this.uSk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get oSk(){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get nCf(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get Rvi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get ivi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get WXd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get pYd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",
!1)}get wUm(){return v.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get Icc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}wc(b){nn("Configure");this.container=b;b.ia("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new jr).ha()}init(){nn("Init");this.oSk&&(M.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,v.AFrameworkApplication.rootQuerySignature,
Fb.App.webServiceBase+"OneNote.ashx",2,this.WXd)}),nn("HotStore"),Fb.App.Y5.l3a.execute(()=>{nn("ChromeReady");Yk.a.get_instance().lk(7,()=>{nn("ScriptDownload");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").aA.loadScript("catchUpActivity")).catch(b=>{r.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.xjn()).catch(b=>
{r.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}xjn(){nn("CreateObjectsAndInitializeState");this.G2m();this.n7k();return this.Gym()}G2m(){r.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");r.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");r.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.nCf&&r.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");
this.Rvi&&r.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.ivi&&r.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");r.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.wUm);this.WXd&&r.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Gym(){this.lzm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Dkf=new Date;nn("InitializeCatchUpApp");return this.P3b.initialize(Object.assign(new Fq,{featuredActivityGroupsEnabled:this.nCf,
summaryStringEnabled:!0,dynamicEntryPointEnabled:this.Rvi,customDynamicEntryPointEnabled:this.ivi,activityFeedDataEnabled:this.WXd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}n7k(){this.container.ia("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Mo(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),hk.App.hn.jb.qc.ed)).ha();this.container.ia("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new hw.a(xa.Health.instance,
new ev.a,this.uSk)).ha();this.container.ia("WordEditor.CatchUpActivity.IActivityStateManager",()=>new hr).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Pe(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),v.AFrameworkApplication.va,mk.UISurfaces.IM(),this.Icc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ia("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new qh(new ri.a(ob.a.gyj(this.container.Ta("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),
()=>v.AFrameworkApplication.rootQuerySignature,Fb.App.webServiceBase+"OneNote.ashx",2,ob.a.gyj(this.container.Ta("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Xn(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),
this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.Icc)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Qj(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),hk.App.hn.jb.qc,new eg.a(hk.App.hn.jb.qc),xf.a.instance,hd.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();
this.container.ia("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Vl.a(50,Qd.a.We):new pm;return new sb(v.AFrameworkApplication.oc,b,hk.App.hn.jb.qc.ed)}).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new $p(this.container.Ta("Common.ISystemInitiatedFeedback"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityNavigationManager",
()=>new mi(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.Icc)).ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new rd(v.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),
hd.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Dc(Um.a.instance,hd.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new je).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new cm(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
hk.App.hn.jb.qc)).ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new ef(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new yr(new Ia(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Pn(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),v.AFrameworkApplication.oc),new id(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.Icc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new oc(v.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();
this.P3b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new Mp,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:v.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),
dataCulture:v.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.WXd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new hm.a}));this.P3b.setWebpackPublicPath(v.AFrameworkApplication.R5);this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightActor",
()=>new Eg(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();this.container.ia("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new At(v.AFrameworkApplication.K,fo.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Ee(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new qn(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.P3b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),hk.App.hn.jb.qc,this.container.Ta("Common.IZoomManager"),v.AFrameworkApplication.oc,
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Fb.App.instance&&Fb.App.instance.tpa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Fb.App.instance&&Fb.App.instance.cD)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Cn(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,hk.App.hn.jb.qc.ed,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),v.AFrameworkApplication.va,
this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.pYd)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new aa(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),v.AFrameworkApplication.va,hd.FocusManager.instance())).ha();this.container.ia("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>
new rn(v.AFrameworkApplication.userName,v.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}lzm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.C6a(h);const u=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const B=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const Q=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),ca=xf.a.instance,qa=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ca.Sw(()=>{Q.C_d?Q.C_d=!1:(Q.k7a&&u.AWi(null,null,!1),Q.Fjb&&u.HVi(null,null),B.V6e())});ca.Sw(Object(z.a)(h,h.MY,"onSelectionChanged"));this.P3b.getWywaEvent().addListener(Object(z.a)(b,b.VXf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");
this.P3b.getWywaEvent().addListener(Object(z.a)(b,b.VXf,"onWywaActivityReady"));const Qa=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");qa.rwk((rb,Lb)=>{Lb&&Qa.mpn(Lb.node)});qa.Sxb.then(()=>{Qa.Qzk()});this.P3b.getWywaEvent().addListener(()=>{qa.oIk()});B.Cuk((rb,Lb)=>{Lb&&u.HVi(Lb.xEb,Lb.Dpi)});B.Duk((rb,Lb)=>{Lb&&u.AWi(Lb.xEb,Lb.Dpi,Lb.fro)});B.Tb(v.AFrameworkApplication.va);this.nCf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Tb(v.AFrameworkApplication.va);
this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.pvo()}pvo(){ah.c()&&(r.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(m.a)(Ok,
"WordEditorCatchUpActivityPackageManager",null,[1,2]);var gt=c(185),qs=c(398),fv=c(1514),kr=c(454),Tq=c(1625),aq=c(1515),mq=c(1685),iw=c(1686),Pr=c(642),Uq=c(1687),lr=c(863),ht=c(134),Qn=c(1523);class nq{constructor(){this.jt=this.annotation=null}}Object(m.a)(nq,"AnnotationChangedData",null,[]);class it{constructor(b,h,u,B,Q,ca,qa,Qa=!1,rb){this.annotationType=b;this.rA=h;this.Xp=u;this.$lc=B;this.ddd=Q;this.NZo=ca;this.jb=qa;this.hoj=Qa;this.K=rb;this.YA=null;this.Jzi=!1;this.hd=new Nc.a;this.K0c=
0}bG(b){this.hd.addHandler("AnnotationChangedEvent",b)}fI(b){this.hd.removeHandler("AnnotationChangedEvent",b)}register(){return this.ddd().then(()=>{0===this.K0c&&(this.hoj&&(this.YA=this.Xp.Vf("WebServiceCall",this.annotationType)),this.rA.ob(this,this.annotationType));this.K0c++})}unregister(){return this.ddd().then(()=>(new Promise(b=>setTimeout(b,this.K.lc(ht.a.ykl,3E3)))).then(()=>{0<this.K0c&&(this.K0c--,0===this.K0c&&this.rA.sc(this,this.annotationType))}))}B8b(){return this.ddd().then(()=>
this.rA.getAnnotationsByType(this.annotationType))}H3h(b){b=qs.a.yJ(b);return(b=this.rA.Nmf(b))&&0<b.count?b.toArray().filter(h=>Wl.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.NZo(this.jb.Yc.vd,b.parentPath):null:(r.ULS.shipAssertTag(575930380,3016,!1),null)}Vva(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new lr.a,{parentPath:["Signal",Wl.a.getTypeNameFor(b)],items:[Object.assign(new Hm.a,{body:b})]});this.$lc.submitOperation(b)}Lsl(b,
h){b=Object.assign(new ak.a,{parentPath:["Signal",h],items:b});this.$lc.submitOperation(b)}GB(b,h){b?h?(this.hoj&&!this.Jzi&&(this.YA.stop(),this.Jzi=!0),this.hd.Z8&&(b=new Qn.a(Object.assign(new nq,{annotation:b,jt:h})),this.hd.raiseEvent("AnnotationChangedEvent",b))):r.ULS.shipAssertTag(575930382,3016,!1):r.ULS.shipAssertTag(575930381,3016,!1)}}Object(m.a)(it,"AnnotationManager",null,[667,292]);class Bt{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.kJ=b;this.dee=h;this.QEb=u;this.F1a=B;this.A8=
Q;this.rxj=ca;this.P1=qa;this.yRb=Qa;this.E6b=rb;this.CNb=Lb;this.kFo=Yb}}Object(m.a)(Bt,"AnnotationManagerHolder",null,[666]);class jw{constructor(b,h){this.J3=b;this.ddd=h}submitOperation(b){return this.ddd().then(()=>{this.J3.getAugLoopRuntimeManager().submitOperation(Object.assign(new gp.a,{operation:b}))})}}Object(m.a)(jw,"SubmitOperationHelper",null,[]);var oq=c(878),Zw=c(1688),Zt=c(1080),Lf=c(93),wp=c(122),Hq=c(78),hp=c(767);class Jl{constructor(b,h,u){this.A8=b;this.Vm=h;this.BMb=u;this.pEa=
{};this.NSh=!1;this.Xmb=(B,Q)=>{var ca;Q.data.jt!==ak.a.getTypeName()&&Q.data.jt!==hp.n.getTypeName()||!Q.data.annotation||Q.data.annotation.annotationType!==Zw.a.getTypeName()||(B=Q.data.annotation.content)&&null!==(ca=B.documentTypeConfidences)&&void 0!==ca&&ca.length&&(this.MSh=B.documentTypeConfidences[0].documentTypeLabel,r.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.MSh))};this.A8.bG(this.Xmb);this.A8.register();this.pEa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,
["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}pRd(){this.NSh||(this.A8.Vva(new Zt.a),r.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.NSh=!0);this.cff();this.pEa.docType=this.MSh;this.pEa.characterCount=this.characterCount;this.pEa.paragraphCount=this.bS;this.pEa.imageCount=this.CJ;this.pEa.tableCount=this.L$;this.pEa.listElementsCount=this.DFi;this.pEa.blobsCount=this.AGc;this.pEa.pageCount=
this.BMb.HGb();this.pEa.currentPage=this.BMb.zci();return this.pEa}cff(){this.bS=this.AGc=this.DFi=this.L$=this.CJ=this.characterCount=0;var b=this.Vm.qoa(hk.App.hn.jb.qc.ed,7,7).currentNode,h=vd.GraphIterator.eb(b);for(b=Fa.a.zs(h,b);b.moveNext();)if(h=b.currentNode)if(Dd.ImageReader.Jt(h))this.CJ++;else if(Zi.TableReader.HR(h))this.L$++;else if(Lf.ListItemReader.jg(h))this.DFi++;else if(me.ParagraphReader.Wb(h)){var u=Hq.e(h);for(let B=0;B<u.length;B++)5===u[B].qh?this.CJ++:this.AGc++;u=wp.AParagraphNode.NP(h.characterData);
u=u.trim();this.characterCount+=u.length;0<u.length&&!me.ParagraphReader.D0(h)&&!me.ParagraphReader.CR(h)&&this.bS++}}}Object(m.a)(Jl,"LoggingDocumentInfo",null,[639]);class Hu{constructor(){this.sa=new Nc.a}Nwk(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}s_n(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}Ivk(b){this.sa.addHandler("BlueDotClickedEvent",b)}WZn(b){this.sa.removeHandler("BlueDotClickedEvent",b)}Wvk(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}Yvk(b){this.sa.addHandler("OnFormattingReviewCompleted",
b)}Vvk(b){this.sa.addHandler("OnFormattingAccept",b)}Xvk(b){this.sa.addHandler("OnFormattingReject",b)}Dwk(b){this.sa.addHandler("OnReviewInvalidated",b)}Qph(b){this.sa.addHandler("OnTraigeAction",b)}h_e(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}l_n(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}Fvk(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}zwk(b){this.sa.addHandler("OnRegisterEnhancement",b)}Pwk(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}t_n(b){this.sa.removeHandler("onTooltipVisibilityChanged",
b)}U4c(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Qn.a(b)):r.ULS.shipAssertTag(575930374,3016,!1)}RLn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Qn.a(b)):r.ULS.shipAssertTag(575930375,3016,!1)}ULn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new Qn.a(b)):r.ULS.shipAssertTag(575930376,3016,!1)}T4i(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Qn.a(b)):r.ULS.shipAssertTag(573850377,3016,!1)}TLn(b){b?this.sa.raiseEvent("OnFormattingAccept",new Qn.a(b)):r.ULS.shipAssertTag(575930377,
3016,!1)}VLn(b){b?this.sa.raiseEvent("OnFormattingReject",new Qn.a(b)):r.ULS.shipAssertTag(575930378,3016,!1)}WLn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Qn.a(b)):r.ULS.shipAssertTag(575930379,3016,!1)}c4f(b){b?this.sa.raiseEvent("OnTraigeAction",new Qn.a(b)):r.ULS.shipAssertTag(573850378,3016,!1)}U4i(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Qn.a(b)):r.ULS.shipAssertTag(573850379,3016,!1)}QLn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Qn.a(b)):r.ULS.shipAssertTag(573687395,
3016,!1)}nic(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Qn.a(b)):r.ULS.shipAssertTag(555055117,3016,!1)}n5i(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Qn.a(b)):r.ULS.shipAssertTag(540587343,3016,!1)}}Object(m.a)(Hu,"ReviewEvents",null,[638]);class $l{constructor(b){this.eu=b;if(!b)throw gt.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}wc(b){this.W=b;b.ia("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new jw(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),
qs.a.Uk)).ha();b.ia("WordEditor.Designer.IDesignerControl",()=>new oq.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.uiCulture)).ha();b.ia("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Hu).ha();b.ia("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new Bt(this.ODa(aq.DocumentRoleDetectionAnnotation.getTypeName()),this.ODa(aq.RoleDetectionAnnotation.getTypeName()),this.ODa(fv.FormattingSuggestionsSummaryAnnotation.getTypeName(),
!0),this.ODa(fv.FormattingSuggestionsAnnotation.getTypeName()),this.ODa(kr.DocumentTypeClassifierAnnotation.getTypeName()),this.ODa(iw.ThemeExtractorAnnotation.getTypeName()),this.ODa(Pr.ThemeGeneratorAnnotation.getTypeName()),this.ODa(mq.TextToImageAnnotation.getTypeName()),this.ODa(Tq.DocumentPullQuoteAnnotation.getTypeName()),this.ODa(Tq.PullQuoteAnnotation.getTypeName()),this.ODa(Uq.TableTypeAnnotation.getTypeName()))).ha();b.ia("WordEditor.Designer.DocumentInfo",()=>new Jl(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A8,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}ODa(b,h=!1){return new it(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),qs.a.Uk,qs.a.Kib,this.eu,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(m.a)($l,"PackageManager",null,[1,2]);var Iu=c(1044),$t=c(1507),Dn=c(1691);class ip extends Sys.EventArgs{constructor(b,
h){super();this.node=b;this.cSf=h}}Object(m.a)(ip,"RoleChangeArgs",Sys.EventArgs,[]);class Iq{constructor(b){this.Mh=!1;this.w7=b;this.w7.pnd++}dispose(){this.Mh||(this.Mh=!0,this.w7.pnd--)}}Object(m.a)(Iq,"InvalidationSuspension",null,[10]);class Ju{constructor(){this.oad=null;this.role=this.d4d=0;this.JAb=this.J_d=this.gia=this.Cdc=!1;this.j3d=this.j_c=this.kPa=null;this.Eob=this.placeholder=!1;this.jCd=this.jbf=null;this.iCd=0}get T3a(){return!this.role||!this.kPa||!this.kPa.length}XDm(){this.JAb=
this.J_d=!0}MUm(){return!!this.role||!!this.kPa||!!this.oad}}Object(m.a)(Ju,"RoleState",null,[679]);class rs{constructor(b,h,u,B,Q){this.Xh=!1;this.HXd=null;this.vNf=new Jh.a;this.mXg=0;this.Z6n=(ca,qa)=>{qa.data.jt===ak.a.getTypeName()&&(qa=qa.data.annotation,(ca=qa.content)?(qa=this.b_b.getParent(qa))&&this.K8c(qa,$t.e(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):r.ULS.shipAssertTag(575813856,3016,!1))};this.Lpl=(ca,qa)=>{if(qa.data.jt===ak.a.getTypeName())if(ca=
qa.data.annotation.content)for(r.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.vNf=new Jh.a,qa=0;ca.listInfos&&qa<ca.listInfos.length;qa++){const Qa=ca.listInfos[qa];this.vNf.Z(Qa.listID,Qa)}else r.ULS.shipAssertTag(556323522,3016,!1)};this.yyi=(ca,qa)=>{ca=ca.PL;if(!ca||ca.ja(Jc.a.sB,!1))return!1;ca=ca.getValue(Jc.a.ma);if(!ca)return!1;ca=$t.f(ca);return 1!=ca&&ca!=qa.role};this.qHl=(ca,qa)=>{ca=qa.data.annotation;const Qa=this.eld.getParent(ca);if(Qa)if(qa.data.jt===ak.a.getTypeName()){const rb=
qa.data.annotation.content;rb?this.aea(Qa,Lb=>{this.HXd&&Lb.jbf&&this.HXd>Lb.jbf&&!Lb.JAb||Lb.role!==Lb.d4d||this.yyi(Qa,Lb)?(r.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.HXd,Lb.JAb,Lb.role===Lb.d4d),Lb.oad=rb.suggestions):(Lb.kPa=rb.suggestions,Lb.JAb=!1)}):r.ULS.shipAssertTag(575813859,3016,!1)}else qa.data.jt===Iu.a.getTypeName()&&this.aea(Qa,rb=>{rb.kPa=null;rb.oad=null});else r.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};
this.bmn=(ca,qa)=>{(ca=qa.data.paragraphNode)?this.aea(ca,Qa=>{qa.data.vHj?(Qa.jCd=Qa.kPa,Qa.iCd=Qa.role):(Qa.jCd=null,Qa.iCd=0);Qa.gia=!0}):r.ULS.shipAssertTag(575930368,3016,!1)};this.dmn=(ca,qa)=>{(ca=qa.data.paragraphNode)?this.aea(ca,Qa=>{Qa.gia=!1;Qa.jCd=null;Qa.iCd=0;5!==qa.data.state&&(Qa.kPa=null)}):r.ULS.shipAssertTag(573850380,3016,!1)};this.$ln=(ca,qa)=>{(ca=qa.data.paragraphNode)?this.aea(ca,Qa=>{Qa.gia=!0}):r.ULS.shipAssertTag(575930369,3016,!1)};this.cmn=(ca,qa)=>{(ca=qa.data.paragraphNode)?
this.K8c(ca,1,!0,!0):r.ULS.shipAssertTag(575930370,3016,!1)};this.DXf=(ca,qa)=>{(ca=qa.data.paragraphNode)?this.K8c(ca,qa.data.cSf,!0,!0):r.ULS.shipAssertTag(575484484,3016,!1)};this.ukm=(ca,qa)=>{if(qa.node){var Qa=qa.node;ca=this.FA(Qa);27==ca.role&&r.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.gia&&27!==ca.role&&28!==ca.role&&this.cnj(this.$Ob-1);ca.T3a||27===ca.role||28===ca.role||this.Wmj(this.inconsistenciesCount-1);this.aea(Qa,rb=>{rb.Eob=!0});setTimeout(()=>this.removeNode(Qa),
1E4)}else r.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let qa;({value:qa}=this.Au.Fc(ca.id));(null===qa||void 0===qa?0:qa.Eob)&&this.Au.remove(ca.id)};this.tkm=(ca,qa)=>{qa.node?(ca=qa.node,this.yFf(ca)?this.aea(ca,Qa=>{Qa.Eob=!1}):this.aea(ca,Qa=>{Qa.JAb=!1})):r.ULS.shipAssertTag(540672206,3016,!1)};this.vkm=(ca,qa)=>{qa.node?this.Heg(qa.property,qa.node)&&(ca=qa.node,this.pnd||ca.C$d?this.aea(ca,Qa=>{Qa.JAb=!1}):this.aea(ca,Qa=>{Qa.XDm();Qa.oad&&(Qa.kPa=Qa.oad,Qa.role=Qa.d4d)}).gia&&
this.QYa.WLn(new Dn.a(qa.node))):r.ULS.shipAssertTag(575930372,3016,!1)};this.oqn=(ca,qa)=>{switch(qa.data.role){case 27:const Qa=qa.data;this.aea(qa.data.paragraphNode,Lb=>{Lb.role=27;Lb.Cdc=!0;Lb.placeholder=Qa.placeholder});break;case 28:const rb=qa.data;this.aea(qa.data.paragraphNode,Lb=>{Lb.role=28;Lb.Cdc=!0;Lb.placeholder=rb.placeholder;Lb.Ooa=rb.Ooa});break;case 2:this.aea(qa.data.paragraphNode,Lb=>{Lb.role=2})}};this.eld=b;this.b_b=h;this.zye=u;this.Pq=B;this.QYa=Q;this.Au=new Jh.a;this.sa=
new Nc.a;this.pnd=this.Rud=this.Tmd=0}get sEm(){return this.pnd}awk(b){this.sa.addHandler(rs.aUi,b)}Hwk(b){this.sa.addHandler(rs.kWi,b)}Gwk(b){this.sa.addHandler(rs.jWi,b)}get inconsistenciesCount(){return this.Tmd}Wmj(b){this.Tmd!==b&&(this.Tmd=b,this.sa.raiseEvent(rs.aUi,new Qn.a(this.Tmd)))}get $Ob(){return this.Rud}cnj(b){this.Rud!==b&&(this.Rud=b,this.sa.raiseEvent(rs.kWi,new Qn.a(this.Rud)))}get qyf(){return this.mXg}yFf(b){return this.Au.nb(b.id)}b2l(b){var h,u;return null===(u=null===(h=this.vNf)||
void 0===h?void 0:h.Fc(b))||void 0===u?void 0:u.value}Rci(b,h){var u,B,Q;const ca=new Map;for(const qa of h)if(h=qa){const Qa=null!==(Q=null===(B=null===(u=this.Au.Fc(h.id))||void 0===u?void 0:u.value)||void 0===B?void 0:B.role)&&void 0!==Q?Q:1;b.has(Qa)&&(ca.has(Qa)?ca.get(Qa).add(h):ca.set(Qa,new zb.a([h])))}return ca}FA(b){if(!b)return r.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Au.Fc(b.id)).returnValue?h:Object.assign(new Ju,{role:1,Cdc:!1})}M2n(){this.HXd=new Date;
return new Iq(this)}register(){this.eld.register();this.b_b.register();this.zye.register()}unregister(){this.eld.unregister();this.b_b.unregister();this.zye.unregister()}initialize(){if(!this.Xh){const b=this.Pq.Te(12);b.Fx(this.ukm);b.hu(this.tkm);b.Mo(this.vkm);this.eld.bG(this.qHl);this.b_b.bG(this.Z6n);this.zye.bG(this.Lpl);this.QYa.Xvk(this.cmn);this.QYa.Vvk(this.$ln);this.QYa.Wvk(this.bmn);this.QYa.Yvk(this.dmn);this.QYa.Qph(this.DXf);this.QYa.zwk(this.oqn);this.Xh=!0}}Nd(){}K8c(b,h,u,B=!1,
Q=0,ca=0,qa){let Qa=0,rb=!1;this.aea(b,Lb=>{const Yb=Lb.J_d||!Lb.role||1==Lb.role;u||(Lb.d4d=h);if(B||Yb)rb=Lb.role!==h,Qa=Lb.role,Lb.role=h,Lb.Cdc=u,Lb.J_d=!1,Lb.j_c=Q,Lb.j3d=ca,Lb.listItemPrefix=qa,Lb.jbf=new Date});if(rb){const Lb=h-4;Lb>this.qyf&&8>Lb&&(this.mXg=Lb);1===h&&this.aea(b,Yb=>{Yb.kPa=null});this.sa.raiseEvent(rs.jWi,new Qn.a(new ip(b,h,Qa)))}}aea(b,h){let u;if(({value:u}=this.Au.Fc(b.id)).returnValue){b=u.T3a;const B=u.gia;h(u);if(27!==u.role&&28!==u.role){if(u.Eob)return u;b!==u.T3a&&
this.Wmj(this.inconsistenciesCount+(b?1:-1));B!==u.gia&&this.cnj(this.$Ob+(B?-1:1))}}else h(u=new Ju),u.MUm()&&this.Au.add(b.id,u);return u}Heg(b,h){({value:h}=this.Au.Fc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Xe.a.vo:!(null===h||void 0===h?0:h.placeholder)&&(b===Xe.a.vo||b===Xe.a.Ln||Array.contains(wp.AParagraphNode.Mha(),b))}}rs.aUi="OnInconsistenciesChanged";rs.kWi="OnRoleReviewCount";rs.jWi="OnRoleChanged";Object(m.a)(rs,"RoleLifecycleManager",
null,[645,646,647]);class gs{constructor(b,h,u,B,Q){this.QYa=b;this.b_b=h;this.Oe=u;this.Pq=B;this.w7=Q;this.Xh=!1;this.DXf=(ca,qa)=>{(ca=qa.data.paragraphNode)?this.SDj(ca,()=>!0,Qa=>Qa.userSetRole=$t.d(qa.data.cSf)):r.ULS.shipAssertTag(557057378,3016,!1)};this.ipn=(ca,qa)=>{0<this.w7.sEm||this.Heg(qa.property)&&this.SDj(qa.node,Qa=>!(Qa&&Qa.isInvalidated),Qa=>Qa.isInvalidated=!0)}}initialize(){this.Xh||(this.QYa.Qph(this.DXf),this.Pq.Te(12).Mo(this.ipn),this.Xh=!0)}Nd(){}SDj(b,h,u){if(b=(b=this.b_b.H3h(b))&&
1===b.length&&b[0]){var B=b.content;B=B&&B.M_&&B.M_.customMetadata;h(B)&&(h=new aq.RoleDetectionCustomMetadata,h.isInvalidated=B&&B.isInvalidated,h.userSetRole=B&&B.userSetRole,u(h),this.Oe.nRo(b,h))}}Heg(b){return b===Xe.a.vo||b===Xe.a.Ln||Array.contains(wp.AParagraphNode.Mha(),b)}}Object(m.a)(gs,"RoleDetectionMetadataUpdater",null,[640]);class Op{constructor(b,h){this.$lc=b;this.CDb=h;this.h1c=(u,B)=>{u=B.data;if(u.jt==hp.a.getTypeName()||u.jt==hp.n.getTypeName())if(u=u.annotation&&u.annotation.content)this.runId=
u.runId};this.revisionId=0}initialize(){this.CDb.bG(this.h1c)}Nd(){this.CDb.fI(this.h1c)}Iin(){if(void 0===this.runId)Promise.resolve();else{var b=new aq.RoleDetectionSettings({acceptedRunId:this.runId});b=new hp.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.$lc.submitOperation(b)}}}Object(m.a)(Op,"RoleDetectionSettingsUpdater",null,[]);class Ps{constructor(b,h,u){this.aDm=b;this.rA=h;this.Xd=u;this.Sri=this.initialized=
!1;this.YRi=()=>{this.Joj()&&(this.qqi(),this.rA.OZn(this.YRi))}}initialize(){this.initialized||(this.qAf(),this.initialized=!0)}Nd(){}qAf(){this.Joj()?this.qqi():this.rA.tvk(this.YRi)}Joj(){return!this.Sri&&(this.Xd.yvi()||this.rA.tbc(aq.DocumentRoleDetectionAnnotation.getTypeName())||this.rA.tbc(aq.RoleDetectionAnnotation.getTypeName()))}qqi(){for(const b of this.aDm)b.initialize();this.Sri=!0}}Object(m.a)(Ps,"RLMInitializer",null,[]);class Qr{constructor(b,h,u){this.sZ=b;this.eu=h;this.Vfd=u;this.W=
null;this.Yja=()=>{this.FUc();this.eu.Dob(this.Yja)};if(!b)throw gt.a.argument("AppLifecycleManager is null");if(!h)throw gt.a.argument("Workspace is null");if(!u)throw gt.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>this.sn())}wc(b){this.W=b;b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new Op(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kJ)).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new gs(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dee,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",
()=>new rs(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").F1a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dee,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").kJ,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",
()=>new Ps([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}sn(){this.Vfd.IJ?this.sZ.lk(16,()=>this.UTc()):this.UTc()}UTc(){this.eu.mxa?this.FUc():this.eu.fga(this.Yja)}FUc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(m.a)(Qr,"PackageManager",null,[1,2]);class jp{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const u=new jp;u.ContractVersion=b;u.FileName=h;u.Paragraphs=[];return u}}Object(m.a)(jp,"DocumentSwayPreviewContent",null,[]);class hj{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static P4k(b,h,u,B){const Q=
new hj;Q.RawText=b;Q.ParagraphFormatting=h;Q.TextRuns=u;Q.IsRTL=B;Q.ParagraphIndex=0;return Q}}Object(m.a)(hj,"ParagraphContent",null,[]);var im=c(96),R=c(1204);class Ba{constructor(){this.Name=null;this.Size=0}static construct(b,h){const u=new Ba;u.Name=b;u.Size=h;return u}}Object(m.a)(Ba,"FontData",null,[]);class lb{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,u,B,Q,ca){const qa=new lb;qa.IsBold=b;qa.IsUnderline=
h;qa.IsUppercase=u;qa.Font=B;qa.Alignment=Q;qa.LeftIndent=ca;return qa}}Object(m.a)(lb,"TextFormatting",null,[]);class Vb{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const u=new Vb;u.RawText=b;u.RunFormatting=h;return u}}Object(m.a)(Vb,"TextRunContent",null,[]);var zc=c(103),Yc=c(40);class Zd{constructor(b,h){this.Q$a=null;this.Q8j=b;this.WN=h||""}get Kwn(){return this.Q8j.value}wyl(){var b=Date.now();const h=jp.construct(2,this.WN);h.Paragraphs=this.kLl();b=Date.now()-
b;const u={};u.ExtractionDurationInMs=b.toString();r.ULS.sendTraceTag(25268374,382,50,"{0}",u);return h}kLl(){const b=new zb.a;var h=0;let u=0,B=!1;var Q=new vd.GraphIterator;Q.set(this.Kwn);Q=Fa.a.ap(Q.currentNode);const ca=new Jh.a(0);for(;Q.moveNext()&&2100>u&&25>h;){var qa=Q.currentNode;if(me.ParagraphReader.Wb(qa)&&!me.ParagraphReader.D0(qa)){!B&&me.ParagraphReader.CR(qa)&&(B=!0);let Qa=wp.AParagraphNode.NP(qa.characterData);Qa=Qa.trim();if(0<Qa.length){const rb=this.qU(qa);rb.ParagraphIndex=
h;h++;u+=Qa.length;b.add(rb);this.KUo(ca,me.ParagraphReader.language(qa))}}}this.Q$a=this.gSl(ca);h={};h.documentHasList=B;r.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}gSl(b){let h=-1,u=1033;for(const B of b.keys.toArray())B&&b.J(B)>h&&(h=b.J(B),u=B);return Jj.a.qg(u)}KUo(b,h){b.nb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}qU(b){const h=wp.AParagraphNode.NP(b.characterData),u=this.G6l(b),B=this.wfm(b);b=this.zPm(b);return hj.P4k(h,u,B,b)}G6l(b){const h=me.ParagraphReader.Wn(b,Xe.a.bold,!1),u=
me.ParagraphReader.Wn(b,Xe.a.underline,!1);var B=me.ParagraphReader.Wn(b,Xe.a.fontSize,im.a.DM);const Q=me.ParagraphReader.Wn(b,Xe.a.font,im.a.GH);var ca=me.ParagraphReader.Kx(b);ca=this.zmf(ca);const qa=!!me.ParagraphReader.Wn(b,xh.a.capitalization,0);b=(new R.a).nU(b).value/20;B=Ba.construct(Q,B);return lb.construct(h,u,qa,B,ca,b)}wfm(b){const h=new zb.a;for(let Q=0;Q<b.qa.length-1;Q++){var u=b.qa.J(Q),B=b.qa.J(Q+1);u.formatting&&(B=wp.AParagraphNode.NP(b.characterData.substr(u.cp,B.cp-u.cp)),u=
this.xfm(u.formatting),u=Vb.construct(B,u),h.add(u))}return h.toArray()}xfm(b){const h=zc.FormattingReader.dRc(b,Xe.a.bold,!1),u=zc.FormattingReader.dRc(b,Xe.a.underline,!1);var B=zc.FormattingReader.dRc(b,Xe.a.fontSize,im.a.DM);const Q=zc.FormattingReader.dRc(b,Xe.a.font,im.a.GH);B=Ba.construct(Q,B);b=!!zc.FormattingReader.dRc(b,xh.a.capitalization,0);return lb.construct(h,u,b,B,5,0)}zmf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}zPm(b){const h=
new vd.GraphIterator;h.set(b);h.zb(11);return(b=h.ld(11))?Yc.OutlineElementReader.In(b):!1}}Object(m.a)(Zd,"DocumentContentExtractor",null,[598]);class $e{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}wc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Zd(new hg.a(()=>hk.App.hn.jb.qc.ed),v.AFrameworkApplication.Cs.uz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){M.a.instance.Gc(new $e)}}Object(m.a)($e,"DocumentContentExtractorPackage",
null,[1,2]);class pa{}pa.Yg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(m.a)(pa,"EmbedDialogHtml",null,[]);class Ma{constructor(b,h,u,B){this.Ngc=b;this.e3a=h;this.z8d=u;this.value=B}}Object(m.a)(Ma,"OptionInfo",null,[]);class ya{constructor(b,h,u){this.gag=b;this.Aac=h;this.e3a=u}}Object(m.a)(ya,"SectionInfo",null,[]);var wa=c(273);class Ta extends Hf.a{constructor(b,
h=!1){super(!1,!1,h);this.Njd=476;this.eWb=288;this.Rxe=798;this.Odk=476;this.Ndk=288;this.J2c={};this.$ob=[];this.hW=this.pYa=this.gxb=this.Mtb=this.Urd=this.AZb=null;this.auc=v.AFrameworkApplication.TSc;this.Lxb=b;this.WLe=Object(z.a)(this,this.bvn,"optionClickHandler");this.Ozc=Object(z.a)(this,this.cvn,"optionKeyHandler");this.Use=Object(z.a)(this,this.QFk,"arrowClickHandler");this.eUb=Object(z.a)(this,this.RFk,"arrowKeyHandler");this.Pxd=Object(z.a)(this,this.AGo,"textAreaOnFocusHandler");this.m7j=
h;this.Yg=pa.Yg;this.Cd=0;this.ug="EmbedDialog"}get Mr(){return this.eWb}set Mr(b){this.eWb=b}erj(b){const h={["id"]:this.ug,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:fa.a.$o(this.Lxb,"wdPreview","1"),["initialEmbedUrl"]:this.auc,["getEmbedCode"]:Ta.M7h,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};
for(const u of Object.keys(b))h[u]=b[u];this.Cd=1;this.xe(1,CommonUIStrings.l_CopyAction);this.xe(0,CommonUIStrings.l_Close);this.Qh(CommonUIStrings.l_Embed,null,h)}mlc(){if(this.m7j)this.erj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.AZb=document.getElementById("embedpreviewpane");this.Urd=document.getElementById("embedoptionpane");this.AZb.style.width=String.format("{0}px",this.Odk);this.pYa=document.createElement("iframe");this.pYa.className=Ta.Mdk;this.pYa.frameBorder="0";this.pYa.style.height=
String.format("{0}px",this.Ndk);this.pYa.tabIndex=-1;this.AZb.appendChild(this.EId(CommonUIStrings.l_Preview,this.pYa,Ta.jah,Ta.iah,Ta.jah,!0));this.hW=document.createElement("textarea");this.hW.className=Ta.U_j;Sys.UI.DomElement.addCssClass(this.hW,wa.a.i0e);this.hW.id=Ta.rSg;Z.a.ri||(this.hW.readOnly=!0);this.hW.rows=4;this.hW.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.hW.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.hW.setAttribute(af.a.lga,String.format("{0} {1}",
Ta.qSg,Ta.pSg));this.AZb.appendChild(this.EId(CommonUIStrings.l_EmbedCode,this.hW,Ta.qSg));Me.a.addHandler(this.hW,"focus",this.Pxd);var b=document.createElement("span");b.className=Ta.H1j;b.innerText=CommonUIStrings.l_CopyText;b.id=Ta.pSg;this.AZb.appendChild(b);this.Mtb=document.createElement("div");this.Mtb.className=Ta.$Zj;this.Urd.appendChild(this.EId(CommonUIStrings.l_Dimensions,this.Mtb));this.gxb=document.createElement("div");this.Urd.appendChild(this.c8k(Ta.X8g,this.gxb));this.Cd=0;this.xe(1,
CommonUIStrings.l_Close);this.Rng();this.JFj();Z.a.ri||this.hW.focus()}}dispose(){if(this.J2c){var b=this.J2c;for(let h in b){const u=b[h];this.Nq.sc(Kd.a.click,u.Ngc,this.WLe);this.ee.sc(Kd.a.$h,u.Ngc,this.Ozc);this.ee.sc(Kd.a.sh,u.Ngc,this.Ozc)}this.Ozc=this.WLe=this.J2c=null}if(this.$ob){for(b=0;b<this.$ob.length;++b)this.Nq.sc(Kd.a.click,this.$ob[b].Aac,this.Use),this.ee.sc(Kd.a.$h,this.$ob[b].Aac,this.eUb),this.ee.sc(Kd.a.qu,this.$ob[b].Aac,this.eUb),this.ee.sc(Kd.a.sh,this.$ob[b].Aac,this.eUb);
this.ee=this.Use=this.$ob=null}this.Pxd&&this.hW&&(Me.a.removeHandler(this.hW,"focus",this.Pxd),this.Pxd=null);this.hW=this.pYa=this.gxb=this.Mtb=this.Urd=this.AZb=null;super.dispose()}Jda(){super.Jda();this.Jc.style.width=String.format("{0}px",this.Rxe);this.oDa()}gTo(b,h){const u=fa.a.$o(this.auc,b,h);return this.auc!==u?(this.auc=u,this.Lxb=fa.a.$o(this.Lxb,b,h),!0):!1}Rng(){this.hW&&(this.hW.innerText=Ta.M7h(this.auc,this.Njd,this.eWb))}JFj(){this.pYa&&this.pYa.contentWindow.location.replace(fa.a.$o(this.Lxb,
"wdPreview","1"))}jne(b,h){this.gTo(b,h)&&(this.Rng(),this.JFj())}EId(b,h,u=null,B=null,Q=null,ca=!1){const qa=document.createElement("div");qa.className=Ta.xgk;B&&(qa.id=B);Q&&qa.setAttribute(af.a.lga,Q);ca&&(qa.tabIndex=0);B=document.createElement("span");B.className=Ta.ygk;B.innerText=b;u&&(B.id=u);qa.appendChild(B);qa.appendChild(h);return qa}c8k(b,h){const u=this.EId(CommonUIStrings.l_Interaction,h),B=this.ej.createElement("div");B.className=Ta.GUj;B.id=Ta.AKg+b;B.setAttribute(af.a.oh,af.a.L3);
B.tabIndex=0;u.insertBefore(B,h);b=ze.createClusteredImage(16,16,Ta.HUj,Ta.IUj,!0,"");B.appendChild(b);b=b.childNodes[0];b.className=ze.getImageClass(Ta.GRg);b.title=CommonUIStrings.l_Expand;B.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new ya(h,B,b);Array.add(this.$ob,h);this.Nq.jE(Kd.a.click,B,this.Use,h);this.ee.jE(Kd.a.$h,B,this.eUb,h);this.ee.jE(Kd.a.qu,B,this.eUb,h);this.ee.jE(Kd.a.sh,B,this.eUb,h);return u}QFk(b){this.hBh(b);return!0}RFk(b){return this.oYc(b,Object(z.a)(this,
this.hBh,"changeArrowState"))}hBh(b){b=b.Uo;"visible"===b.gag.style.visibility?(b.gag.style.visibility="hidden",b.e3a.className=ze.getImageClass(Ta.GRg),b.e3a.title=CommonUIStrings.l_Expand,b.Aac.title=CommonUIStrings.l_Expand):(b.gag.style.visibility="visible",b.e3a.className=ze.getImageClass(Ta.Mlk),b.e3a.title=CommonUIStrings.l_Collapse,b.Aac.title=CommonUIStrings.l_Collapse)}VJh(b,h){const u=document.createElement("div");u.className=Ta.U8g;u.id=b+Ta.V8g;var B=this.ej.createElement("div");B.tabIndex=
0;B.className=Ta.WMg;B.id=b+Ta.yrc;B.setAttribute(af.a.oh,af.a.P1e);B.setAttribute(af.a.aDa,af.a.pp);B.setAttribute(af.a.lga,b+Ta.CVb);u.appendChild(B);u.setAttribute(af.a.oh,af.a.rz);var Q=ze.createClusteredImage(16,16,Ta.bNg,Ta.aNg,!0,"");B.appendChild(Q);Q=Q.childNodes[0];Q.id=b+Ta.W8g;Q.className=ze.getImageClass(Ta.Rue);B=new Ma(u,Q,B,1);this.J2c[b]=B;this.Nq.jE(Kd.a.click,u,this.WLe,b);B=document.createElement("span");B.className=Ta.CVb;B.innerText=h;B.id=b+Ta.CVb;u.appendChild(B);this.ee.jE(Kd.a.$h,
u,this.Ozc,b);this.ee.jE(Kd.a.sh,u,this.Ozc,b);return u}bvn(b){this.oYi(b);return!0}cvn(b){return this.oYc(b,Object(z.a)(this,this.oYi,"optionHandler"))}oYi(b){const h=this.J2c[b.Uo.toString()];h.value?(h.value=0,h.e3a.className=ze.getImageClass(Ta.MVe),h.z8d.setAttribute(af.a.aDa,af.a.uM)):(h.value=1,h.e3a.className=ze.getImageClass(Ta.Rue),h.z8d.setAttribute(af.a.aDa,af.a.pp));this.jne(b.Uo.toString(),h.value.toString())}AGo(){this.hW.select()}static M7h(b,h,u){if(!Ta.AKe){const B=String.format('<a target="_blank" href="{0}">{1}</a>',
F.a.sac("https://office.com"),CommonUIStrings.l_Office),Q=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.sac("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Ta.AKe=String.format(CommonUIStrings.l_NoFrames,B,Q)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',F.a.sac(b),h,u,Ta.AKe)}}Ta.AKe=null;Ta.Rue="CheckboxChecked_16x16x32";Ta.MVe="CheckboxUnchecked_16x16x32";Ta.Mlk="OutlookSearchChevronUp_16x16x32";Ta.GRg="OutlookSearchChevronDown_16x16x32";
Ta.bNg="CommentChecked";Ta.HUj="UpArrowServer";Ta.CVb="EmbedDescription";Ta.xgk="EmbedSectionHeader";Ta.ygk="EmbedSectionName UIFontBold";Ta.H1j="EmbedCodeFooter";Ta.aNg="EmbedOptionImage";Ta.Mdk="EmbedPreviewFrame";Ta.U_j="EmbedCodeTextArea";Ta.U8g="EmbedOption";Ta.$Zj="EmbedDimensionSection";Ta.IUj="EmbedArrowIcon";Ta.GUj="WACGlyph EmbedArrowHolder";Ta.WMg="EmbedCheckBoxHolder";Ta.V8g="Option";Ta.W8g="OptionImage";Ta.rSg="EmbedCode";Ta.qSg="EmbedCodeHeader";Ta.jah="Preview";Ta.iah="PreviewHeader";
Ta.X8g="Options";Ta.AKg="Arrow";Ta.yrc="Check";Ta.pSg="EmbedCodeFooter";Object(m.a)(Ta,"EmbedDialog",Hf.a,[]);class Bb extends Ma{constructor(b,h,u,B,Q){super(b,h,u,B);this.m3a=Q}}Object(m.a)(Bb,"OptionInputInfo",Ma,[]);class Qb extends Ta{constructor(b,h){super(b,Qb.NL);this.cba=null;this.vtc=[];this.Jwd=Object(z.a)(this,this.kAo,"startOnOptionClickHandler");this.Z_b=Object(z.a)(this,this.lAo,"startOnOptionKeyHandler");this.lsd=Object(z.a)(this,this.$on,"onPageNumberChanged");this.cye=Object(z.a)(this,
this.gln,"onDimensionChanged");this.kH=h}mlc(){if(Qb.NL){var b=Qb.sNn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.kH.n2i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.kH.b7i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.kH.Jtj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.kH.Ktj}});this.erj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.Njd,["defaultHeight"]:this.eWb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.kH.hJj,["heightLabel"]:this.kH.Tmi},["interactionOptions"]:h})}else super.mlc(),this.Tmh(this.kH.hJj,"EmbedWidthInput",this.Njd),this.Tmh(this.kH.Tmi,"EmbedHeightInput",this.eWb),this.gxb.appendChild(this.VJh("wdPrint",this.kH.n2i)),this.gxb.appendChild(this.VJh("wdEmbedCode",this.kH.b7i)),this.xpk(this.kH.Jtj),this.oDa(),hd.FocusManager.iK()&&(b=hd.FocusManager.instance(),h=[document.getElementById(Ta.rSg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Ta.AKg+Ta.X8g),document.getElementById("wdPrint"+Ta.yrc),document.getElementById("wdEmbedCode"+Ta.yrc),document.getElementById("wdStartOn"+Ta.yrc),document.getElementById("wdStartOnText"),document.getElementById(em.a.lfd),document.getElementById(Ta.iah)],h=new Rd(h),b.Ys().ak=h,Z.a.ri?this.u1(document.getElementById(em.a.lfd)):this.hW.select())}dispose(){if(!Qb.NL){if(this.vtc){for(let b=
0;b<this.vtc.length;++b)Me.a.removeHandler(this.vtc[b],"change",this.cye);this.vtc=this.cye=null}this.lsd&&(Me.a.removeHandler(this.cba.m3a,"change",this.lsd),this.lsd=null);this.Jwd&&(this.Nq.sc(Kd.a.click,this.cba.Ngc,this.Jwd),this.Jwd=null);this.Z_b&&(this.ee.sc(Kd.a.$h,this.cba.Ngc,this.Z_b),this.ee.sc(Kd.a.sh,this.cba.Ngc,this.Z_b),this.Z_b=null);this.cba=null}super.dispose()}Tmh(b,h,u){const B=document.createElement("label");B.className="EmbedInputPrefix";B.innerText=b;this.Mtb.appendChild(B);
b=document.createElement("input");b.className=h;b.id=h;b.value=u.toString();b.type="text";b.setAttribute("data-lpignore","true");B.setAttribute("for",h);this.Mtb.appendChild(b);this.vtc.push(b);Me.a.addHandler(b,"change",this.cye);this.Mtb.appendChild(document.createElement("br"))}gln(b){"EmbedWidthInput"===b.target.id?this.Njd=this.YLd(b.target,375):this.eWb=this.YLd(b.target,250);this.Rng()}YLd(b,h){let u=parseInt(b.value);if(isNaN(u)||u<h)u=h;b.value=u.toString();return u}$on(b){b=this.YLd(b.target,
1);1===this.cba.value&&this.jne("wdStartOn",b.toString())}xpk(b){const h=document.createElement("div");h.className=Ta.U8g+" EmbedInlineOption";h.id="wdStartOn"+Ta.V8g;const u=this.ej.createElement("div");u.tabIndex=0;u.className=Ta.WMg;u.id="wdStartOn"+Ta.yrc;u.setAttribute(af.a.oh,af.a.P1e);u.setAttribute(af.a.aDa,af.a.uM);u.setAttribute(af.a.lga,"wdStartOn"+Ta.CVb);h.appendChild(u);h.setAttribute(af.a.oh,af.a.rz);var B=ze.createClusteredImage(16,16,Ta.bNg,Ta.aNg,!0,"");u.appendChild(B);B=B.childNodes[0];
B.id="wdStartOn"+Ta.W8g;B.className=ze.getImageClass(Ta.MVe);const Q=document.createElement("span");Q.className=Ta.CVb;Q.innerText=b;Q.id="wdStartOn"+Ta.CVb;h.appendChild(Q);this.gxb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.kH.Ktj;b.setAttribute("data-lpignore","true");this.gxb.appendChild(b);Me.a.addHandler(b,"change",this.lsd);this.cba=new Bb(h,B,u,0,b);this.jne("wdStartOn","1");this.Nq.ob(Kd.a.click,h,this.Jwd);
this.ee.ob(Kd.a.$h,h,this.Z_b);this.ee.ob(Kd.a.sh,h,this.Z_b)}kAo(b){this.Htj(b);return!0}lAo(b){return this.oYc(b,Object(z.a)(this,this.Htj,"startOnOptionHandler"))}Htj(){let b=1;this.cba.value?(this.cba.value=0,this.cba.e3a.className=ze.getImageClass(Ta.MVe),this.cba.z8d.setAttribute(af.a.aDa,af.a.uM)):(this.cba.value=1,this.cba.e3a.className=ze.getImageClass(Ta.Rue),b=this.YLd(this.cba.m3a,1),this.cba.z8d.setAttribute(af.a.aDa,af.a.pp));this.jne("wdStartOn",b.toString())}static get NL(){return v.AFrameworkApplication.ua.Lb.pF}static sNn(b,
h,u,B=null){if("wdPrint"===h||"wdEmbedCode"===h)return fa.a.$o(b,h,u?"1":"0");if("wdStartOn"===h){let Q="1";u&&B&&(B=parseInt(B),!isNaN(B)&&1<=B&&(Q=B.toString()));return fa.a.$o(b,h,u?Q:"1")}return b}}Object(m.a)(Qb,"WordEmbedDialog",Ta,[]);class jc{constructor(b,h,u,B,Q){this.jfa=null;this.ga=b;this.dbb=h;this.gQ=u;this.kH=B;this.Hea=Q}Tb(){this.ga.ra(this.gQ,Ad.a.frame,Object(z.a)(this,this.Lto,"showEmbedCode"));this.dbb.execute(Object(z.a)(this,this.vVf,"onHostPostmessengerCreated"))}vVf(b){r.ULS.shipAssertTag(4994850,
332,!!b);this.jfa=b;v.AFrameworkApplication.aia||(this.jfa.Fv(L.a.Uzh),this.jfa.bC(L.a.Uzh,Object(z.a)(this,this.mlc,"showEmbedDialog")))}mlc(b){b=b.Values.HostEmbeddedViewUrl.toString();v.AFrameworkApplication.TSc=b;this.Hea.Bgf=b;(new Qb(b,this.kH)).mlc()}Lto(b,h,u){if(2===u)if(v.AFrameworkApplication.TSc)(new Qb(this.Hea.Bgf,this.kH)).mlc();else return v.AFrameworkApplication.Ql.h3a(jc.CMj),v.AFrameworkApplication.lpg&&this.jfa.sendMessage(L.a.kAl,null)?32:v.AFrameworkApplication.ua.RU(!0,v.AFrameworkApplication.jjf);
return 32}}jc.CMj=10381;Object(m.a)(jc,"EmbedActor",null,[]);class Ic{}Object(m.a)(Ic,"WordEmbedDialogStrings",null,[]);var Oc=c(223);class kd extends jc{constructor(b,h){super(b,h,Qc.a.Nfg,Object.assign(new Ic,{hJj:WordEditorIntl.WordEditorStrings.l_Width,Tmi:WordEditorIntl.WordEditorStrings.l_Height,n2i:WordEditorIntl.WordEditorStrings.l_PrintOption,b7i:WordEditorIntl.WordEditorStrings.l_ReembedOption,Jtj:WordEditorIntl.WordEditorStrings.l_StartOnOption,Ktj:WordEditorIntl.WordEditorStrings.l_StartPage}),
Oc.WoncaApp.instance)}}Object(m.a)(kd,"EmbedActor",jc,[]);class td{constructor(){this.W=null}get name(){return"WordEditor.Embed"}wc(b){this.W=b;b.ia("WordEditor.Embed.EmbedActor",()=>new kd(v.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Tb()}dispose(){}}Object(m.a)(td,"EmbedPackage",null,[1,2]);class qd{constructor(b,h,u){this.ew=this.SKa=this.aNa=null;this.GKa=0;this.OXb=this.IXb=this.uXb=this.XXb=this.VWa=this.UWa=!1;
this.Rj=b;this.fn=u}tP(b){return Fb.App.za.jb.isEditingAllowed?""!==this.SPc(b.uf):!1}wL(b){if(!this.tP(b))return!1;this.Qeo(b);this.Reo();this.Seo();this.aNa=b.hI;this.ew=new Sys.UI.Point(0,0);r.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}TU(b){this.SKa=b.hI;this.bPk();this.Rj.EEj(this.ew.x,this.ew.y,this.XXb,this.uXb,this.IXb,this.OXb,!1);return!0}eE(){this.Rj.EEj(this.ew.x,this.ew.y,this.XXb,this.uXb,this.IXb,this.OXb,!0);r.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}JY(){this.Rj.WRk();
r.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}Reo(){this.OXb=this.IXb=this.uXb=this.XXb=!1;switch(this.GKa){case 1:this.XXb=!0;break;case 5:this.uXb=!0;break;case 3:this.OXb=!0;break;case 7:this.IXb=!0;break;case 0:this.IXb=this.XXb=!0;break;case 2:this.OXb=this.XXb=!0;break;case 6:this.IXb=this.uXb=!0;break;case 4:this.OXb=this.uXb=!0}}Seo(){this.VWa=this.UWa=!1;switch(this.GKa){case 0:this.VWa=this.UWa=!0;break;case 1:case 2:this.VWa=!0;break;case 7:case 6:this.UWa=!0}}SPc(b){var h=
b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const u=b[h].toString();if(u.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==u)return u}return""}Qeo(b){switch(this.SPc(b.uf)){case "WACImageCropHandleNW":this.GKa=0;break;case "WACImageCropHandleN":this.GKa=1;break;case "WACImageCropHandleNE":this.GKa=2;break;case "WACImageCropHandleE":this.GKa=3;break;case "WACImageCropHandleSE":this.GKa=4;break;case "WACImageCropHandleS":this.GKa=
5;break;case "WACImageCropHandleSW":this.GKa=6;break;case "WACImageCropHandleW":this.GKa=7}}bPk(){var b=1;this.fn.instance&&(b=this.fn.instance.ij);const h=(this.SKa.x-this.aNa.x)/b;b=(this.SKa.y-this.aNa.y)/b;this.ew.x=this.UWa?-h:h;this.ew.y=this.VWa?-b:b}}Object(m.a)(qd,"ImageCropDragAdapter",null,[219]);class Fd{constructor(b,h){this.ga=b;this.fn=h}mZl(b){return new qd(b,this.ga,this.fn)}}Object(m.a)(Fd,"ImageCropDragAdapterFactory",null,[593]);var se=c(298),qe=c(241),Ud=c(41),Ke=c(439),We=c(701),
pd=c(81),pe=c(61),Kf=c(401),Yf=c(988),Pf=c(516),vi=c(905),Df=c(137),si=c(359),Hi=c(251),ih=c(871),uf=c(206),Rj=c(83),qg=c(21),Ii=c(282),am=c(780),No=c(374),sk=c(116);class al{constructor(b,h,u,B,Q,ca,qa,Qa,rb=null){this.Zb=rb;this.wUc=null;this.BK=b;this.mh=h;this.Kc=u;this.Ts=B;this.Ld=Q;this.ib=ca;this.Zm=qa;this.JE=Qa}get nX(){return null!=this.ivg?this.ivg:this.ivg=Ga.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get uc(){return null!=this.xIg?this.xIg:this.xIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get wi(){return Df.PageReader.instance}bho(b,
h,u){const B=this.Kc.Pc(15);B.Db(h.node);this.QTa(b,u);B.dispose()}aho(b,h,u){const B=this.Kc.Pc(15);B.Db(h.node);this.HPb(b,u);B.dispose()}QTa(b,h){b.setValue(Xe.a.imageAltText,h)}HPb(b,h){b.setValue(Jc.a.kY,h)}iho(b,h){b.setValue(Xe.a.Gjb,h)}hkj(b,h){var u=Dd.ImageReader.vi(b);Fb.App.instance&&Fb.App.instance.HU(u)?(u=b.ja(Ud.a.A5d,null),h=am.a.$al(h,u),b.setValue(Ud.a.A5d,h)):b.setValue(Jc.a.lY,h)}eho(b,h,u,B,Q){let ca=0;var qa=0;({width:ca,height:qa}=Dd.ImageReader.Fib(b));qa-=(h+u)/1E5*qa;this.mIa(b,
ca-(B+Q)/1E5*ca);this.lIa(b,qa);this.Akj(b);b.setValue(Jc.a.sTc,h);b.setValue(Jc.a.pTc,u);b.setValue(Jc.a.qTc,B);b.setValue(Jc.a.rTc,Q)}flo(b,h,u,B){const Q=this.Kc.Pc(15);Q.Db(h.node);this.Kfe(b,u,B);Q.dispose()}Kfe(b,h,u){this.mIa(b,h);this.lIa(b,u);this.Akj(b);b.removeProperty($c.a.Y9d);b.removeProperty($c.a.W9d)}mIa(b,h){b.setValue(Xe.a.sia,h);b.setValue($c.a.BFa,-1)}lIa(b,h){b.setValue(Xe.a.ria,h);b.setValue($c.a.AFa,-1)}lE(b,h){b.setValue(Jc.a.OSc,h);b.setValue(Xe.a.Ih,h);b.setValue(Xe.a.er,
h)}Wlo(b,h){b.setValue(Jc.a.zRb,h)}Udo(b,h){b.setValue(Jc.a.X2e,h)}$lo(b){if(!Dd.ImageReader.G4(b)&&b.Vk){var h=b.node;if(Dd.ImageReader.h9(h)){const Q=this.Kc.Pc(15);Q.Db(b.node);b=vd.GraphIterator.eb(h);b.zb(12);b=b.parentNode;var u=b.properties.rf(Jc.a.rq),B=h.properties.getValue(Jc.a.runId);h.ja(Jc.a.Wc,gk.a.uS);const ca=b.qa,qa=[Jc.a.OSc,Xe.a.Ih,Xe.a.er,Jc.a.X2e,Jc.a.zRb,Jc.a.e_a];Fb.App.instance&&Fb.App.instance.HU(Dd.ImageReader.vi(h))&&qa.push(Ud.a.Evf,Ud.a.Dvf);h.zg.apply(h,qa);u=this.nof(B,
u,ca);B=Je.a.Oc(b,u);this.Ts.aIh(h,B);(h=this.JE.gJ(b,u,u+1))&&this.ib.Bc(h);this.nX.cra(b,u,u+1);Q.dispose()}}}ubg(b,h){if(b.properties.hasProperty(Jc.a.N7)){const u=b.properties.rf(Jc.a.N7);u.push(h);b.properties.setValue(Jc.a.N7,Array.clone(u))}else b.properties.setValue(Jc.a.N7,[h])}Yge(b,h,u=0,B=!1){if(b.Vk){var Q=this.Kc.Pc(15),ca=b.node;Q.Db(ca);if(Dd.ImageReader.G4(b)){const Lb=this.Zb&&this.Zb.isFeatureEnabled(48)?new vi.a:new Pf.a;Lb.Yw(Dd.ImageReader.nn(b));var qa=ca.qa,Qa=this.ZBl(b.cpBegin,
qa);this.aFk(b.cpEnd,qa,Qa)&&r.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");qa=qa.J(Qa).blob;Qa=qa.oe;var rb=ca.properties.rf(Jc.a.rq);rb=this.SMn(rb);Qa=rb[Qa];rb=ca.ja(Jc.a.Wc,gk.a.uS);if(qa=Object(Na.a)(Yf.ImageBlobObject,qa))qa.iQb=!1;this.Ld.Ge(b,"");qa&&(qa.iQb=!0);Lb.properties.setValue(Jc.a.runId,Qa);Lb.properties.setValue(Jc.a.Wc,rb);b=vd.GraphIterator.eb(ca);b.zb(12);b.xf(Lb,6);this.ubg(b.currentNode,Lb.anchor.node.id);ca=Lb}u&&this.lE(ca.properties,
u);this.Udo(ca.properties,B);this.Wlo(ca.properties,h);this.nX.pkc(ca);(h=this.JE.Aq(ca))&&this.ib.Bc(h);Q.dispose()}}N$f(b,h){if(!(0>=h)){var u=kf.a.Kl(h,0),B=Dd.ImageReader.iF(b),Q=Dd.ImageReader.EG(b);B>u&&(Q*=u/B,this.mIa(b,u),this.lIa(b,Q),r.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}aFk(b,h,u){const B=h.length;if(u>=B||!h.J(u).nf)return!1;const Q=new fp.a;for(;u<B;u++){const ca=h.J(u);if(ca.cp>b||!ca.nf)break;for(let qa=0;qa<ca.nf.length;qa++){if(Q.contains(ca.nf.J(qa).$j))return!0;
Q.add(ca.nf.J(qa).$j)}}return!1}SMn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var u=0;u<b.length;)b[u]=u+1,u++;else{var B=b[h];u=h-1;for(var Q=B-1;0<=u;)b[u]=Q,u--,Q--;Q=0;for(u=h+1;u<b.length;)(h=b[u])?h<B?(B=h+Q,b[u]=B):B=h:(Q+=2,B++,b[u]=B),u++}return b}Tjf(b,h){let u=0;for(;u<h.length&&!(b<h[u]);)u++;return u}nof(b,h,u){let B=0;const Q=this.Tjf(b,h);let ca=0;if(Q===h.length)ca=u.length-1;else for(;ca<u.length;){h=u.J(ca);if(h.formatting&&h.formatting.oe===Q)break;ca++}ca<u.length?
B=u.J(ca).cp:r.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:b,["CharacterPropertiesArrayLength"]:u.length});return B}ZBl(b,h){let u=0;for(;u<h.length&&h.J(u).cp!==b;)u++;u===h.length&&r.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:u,["CharacterPropertiesArrayLength"]:h.length});return u}Akj(b){b.setValue(Xe.a.yxa,!0)}z$d(b,h,u,B=!1){h&&u?(h=Math.max(h,We.a.CNi),u=Math.max(u,We.a.CNi)):
u=h=We.a.KOh;b.setValue(Xe.a.sia,kf.a.Kl(h,0));b.setValue(Xe.a.ria,kf.a.Kl(u,1));b.setValue(Xe.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(xh.a.s0,1);b.setValue(Jc.a.fia,B)}iXd(){return null}vSh(b,h,u){let B=null;h=({wLb:B}=this.wSh(b,h,u)).returnValue;B&&b.view.mb.Bc(B);return h}wSh(b,h,u){var B=null;if(!this.uga(b))return{returnValue:null,wLb:B};var Q=b.view;const ca=this.Kc.Pc(15,Ob.a.cIb);ca.Db(Q.ed);h||(h=new Od.DictionaryPropertySet);h.setValue($c.a.yql,!0);let qa=Q.mb.ng;
var Qa=new ih.a;if(!Ge.SelectionEditor.ef(qa)){if(2===v.AFrameworkApplication.va.processAction(Ob.a.Cna,2))return ca.dispose(),{returnValue:null,wLb:B};qa=Q.mb.ng}else if(qa.Vk&&me.ParagraphReader.Wb(qa.node)){Fb.App.xd.So&&Fb.App.xd.Yp.$F(qa.node);Q=zc.FormattingReader.Vr(qa);if(!Q)return ca.dispose(),{returnValue:null,wLb:B};Q.cache.OB&&(Q=Q.yf(null),al.Xn.v5(Q));Qa.formatting=Q.Tj;Qa.languageId=zc.FormattingReader.language(Q);Qa.zka=this.uc.Ro(qa.node)}if(!qa.Vk)return ca.dispose(),{returnValue:null,
wLb:B};if(!this.bBf(b.ek,h))return ca.dispose(),this.wUc=null,{returnValue:null,wLb:B};b=this.wUc;this.wUc=null;1===b.location?(B=b.node,h=No.a.instance.Guf(B),gf.OutlineElementNavigator.$r(h,!1,!1)||(uf.OutlineNavigator.Sde(h),this.BK.P7(h,!0,Qa)),gf.OutlineElementNavigator.Ce(h),Zi.TableReader.isTable(h)&&(Object(Cb.a)(sk.a,h)||Object(Cb.a)(si.a,h)?(Qa=new vd.GraphIterator,Qa.set(h.currentNode),qg.moveToCellContent(Qa,0,0),h.set(Qa.currentNode)):qg.moveToCellContent(h,0,0),Yc.OutlineElementReader.Bh(h)?
gf.OutlineElementNavigator.Ce(h):h=No.a.instance.Guf(B)),B=me.ParagraphReader.At(h.currentNode)?this.JE.ne(h.currentNode,0):this.JE.Aq(h.currentNode)):b.location||(Qa=b.blob.Kb.cp+1,B=this.JE.gJ(b.node,Qa-1,Qa));ca.HGa(u,1);ca.Qj=Ob.a.cIb;ca.dispose();return{returnValue:b,wLb:B}}bBf(){return!1}uga(b){b.contextId===vc.a.view&&b.view.qe&&b.view.mb&&(b=b.view.mb.ng);if(!b)return al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.noSelection}),!1;if(al.Uf.R_(b))return al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ZE}),!1;if(al.Uf.hia(b))return al.Hc.Yb(pd.a.Ye,
{["Reason"]:pe.a.kri}),!1;if(this.Zm&&this.Zm.instance&&this.Zm.instance.EU(b))return al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.o1a}),!1;if(this.wi.D4)return al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.compatMode}),!1;if(b.Vk)return Rj.OutlineReader.l_d(b)?(al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.n9e}),!1):Dd.ImageReader.fZd(b)?(al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.g9e}),!1):Ii.c(b)?(al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.h9e}),!1):Hi.a.LDf(b)?(al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.f9e}),!1):me.ParagraphReader.AU(b)||Dd.ImageReader.IFm(b)?
(al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.yO}),!1):!0;if(Kf.a.aFf(b)){let h=!0;for(let u=0;u<b.length;++u){const B=b.getContext(u);if(!B.Vk)return!1;h&&!me.ParagraphReader.AU(B)&&(h=!1)}return h?(al.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.yO}),!1):!0}return!1}R6f(b,h){const u=this.Kc.Pc(7);u.Db(b);if(12===b.type){h=h.Kb.cp;var B=me.ParagraphReader.textLength(b);B=Je.a.FO(h,h+1,h+1===B?!0:!1,b);this.Ld.Ge(B,"");b=Je.a.Oc(b,h);this.ib.Bc(Cg.SelectionFactory.Tn(b))}else this.mh.Vya(b);u.dispose()}static get Xn(){return null!=
al.Uyg?al.Uyg:al.Uyg=Ga.a.instance.resolve("Box4.IFormattingEditor")}static get Uf(){return ti.a.instance}static get Hc(){return Wh.a.instance}}Object(m.a)(al,"ImageEditor",null,[592]);class xp{constructor(b,h,u,B=0){this.node=b;this.blob=h;this.location=u;this.yU=B}}Object(m.a)(xp,"InsertPictureResult",null,[]);var mj=c(827),fg=c(287),yp=c(1190);class Xo extends al{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc){super(b,h,u,B,Q,ca,qa,Qa,Sc);this.YYj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");
this.M$a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");this.oK=this.yLa=this.XAa=null;this.Uka=Array(8);this.Gmd=this.rBa=null;this.zLa=!1;this.Fmd=this.xDe=null;this.did=this.vjd=!1;this.eT=this.dT=this.cT=this.fT=this.cW=this.bW=this.aW=this.dW=this.xW=this.yW=0;this.MY=()=>{this.zLa&&
this.Tgf()};this.eya=ld=>{this.zLa&&ld.Hb.keyCode!==Se.a.Ls&&this.Tgf(!0);return!1};this.iYg=Fc;ca.Sw(this.MY);this.ee=gc;this.I2=se.a.instance;this.ga=v.AFrameworkApplication.va;this.Ud=Lb;this.wq=rb;this.od=Sc}bge(b,h,u,B,Q){b.hasProperty($c.a.DRa)&&b.removeProperty($c.a.DRa);const ca=Array(4);ca[0]=h;ca[1]=u;ca[2]=B;ca[3]=Q;b.setValue(Jc.a.Gda,ca)}BXn(b){b.setValue(Jc.a.DFa,0);b.setValue(Jc.a.WMb,"");this.bge(b,0,0,0,0)}pcg(b,h,u,B,Q){b.setValue(Jc.a.sTc,h);b.setValue(Jc.a.pTc,u);b.setValue(Jc.a.qTc,
B);b.setValue(Jc.a.rTc,Q)}dge(b,h,u,B){b.setValue(Jc.a.DJ,h);b.setValue(Jc.a.kSc,u);b.setValue(Jc.a.ySc,B);b.setValue($c.a.DJ,-1)}gXd(b,h){b=b.node;const u=vd.GraphIterator.eb(b);if(me.ParagraphReader.Wb(b)&&me.ParagraphReader.isEmpty(u)){var B=b.properties.rf(Jc.a.Wc);h.setValue(Jc.a.Wc,B);h.setValue(Jc.a.runId,1);B=new yp.a;h&&B.Yw(h);u.xf(B,6);this.ubg(b,B.anchor.node.id);this.nX.pkc(B);return new xp(B,null,3)}return null}iXd(b,h){var u=mj.a.instance.Ced;h&&u.Yw(h);u.setValue(Jc.a.imageType,1);
let B=0;B=qe.a.zF();u.setValue(Jc.a.yU,B);const Q=b.node.Lc.Su(u,u.id);u=this.Ld.Uha(b,ca=>new Yf.ImageBlobObject(ca,Q));fg.GraphTransactionManager.instance.bVf(b.node);if(this.Ud.tg){const ca=new Qg.GraphTransaction(15);ca.Db(b.node);this.wq.kra(b.node,b.cpBegin,b.cpBegin+1,1,null);ca.dispose()}this.nX.RNa&&!h.ja(Jc.a.fia,!1)&&this.nX.cra(b.node,b.cpBegin,b.cpBegin+1);return new xp(b.node,u,0,B)}bBf(b,h){if(!this.uga(b))return!1;const u=this.Kc.Pc(7);u.Db(b.node);v.AFrameworkApplication.K.$("ContentAppIsEnabled")&&
h.ja(Jc.a.yti,!1)?this.wUc=this.gXd(b,h):this.wUc=this.iXd(b,h);u.dispose();return!0}Hic(b,h,u,B){if(!u.Wb(b))return!1;u=this.Kc.Pc(7,Ob.a.Jkm);u.Db(b);var Q=b.properties.ja(Xe.a.Dm,[]);Q.push(0);for(const ca of Q)if((Q=B.bnf(b,ca))&&5===Q.qh&&Q.id.equals(h))return this.Ld.Ge(Je.a.createTextRange(b,ca,ca+1),""),u.dispose(),!0;u.dispose();r.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}OWn(b,h,u,B){if(!Dd.ImageReader.h9(b))return!1;h.set(b);
h.zb(12);const Q=h.fo(12);if(!Q)return r.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(u.FWc(Q))return r.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;B(b);u=this.Kc.Pc(7);u.Db(b);h.vg();u.dispose();return!0}A1n(b,h,u,B){return Dd.ImageReader.B3a(b)?this.o1n(b,u):Dd.ImageReader.G4(b)?this.D1n(b,h,u,B):null}D1n(b,h,u,B){const Q=
mj.a.instance.Ced;u&&Q.Yw(u);u=0;u=qe.a.zF();Q.setValue(Jc.a.yU,u);u=b.node.Lc;b=b.node;B=B.NOc(b,5);for(const ca of B)if(ca.id.equals(h)){this.Ld.Ge(Je.a.createTextRange(b,ca.Kb.cp,ca.Kb.cp+1),"");const qa=u.Su(Q,Q.id);h=Je.a.Oc(b,ca.Kb.cp);this.Ld.Uha(h,Qa=>new Yf.ImageBlobObject(Qa,qa));return Q}return null}o1n(b,h){if(!Dd.ImageReader.B3a(b))return null;h.setValue(Jc.a.yU,qe.a.zF());b=b.node;var u=b.anchor.node.id;b=vd.GraphIterator.eb(b);b.zb(12);const B=b.parentNode;let Q;B.properties.hasProperty(Jc.a.N7)?
(Q=B.properties.rf(Jc.a.N7),u=W.a.indexOf(Q,u),-1!==u&&Array.removeAt(Q,u)):Q=[];B.properties.setValue(Jc.a.N7,Array.clone(Q));b.vg();u=this.od&&this.od.isFeatureEnabled(48)?new vi.a:new Pf.a;u.Yw(h);b.xf(u,6);this.ubg(B,u.anchor.node.id);return u}cbd(b,h){this.zLa?this.Tgf():this.Lzo(b,h)}kho(b,h){b.setValue($c.a.DJ,h)}qZl(b){let h=null,u=null;if(!b)return r.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,nj:u};if(!nb.InteractiveViewManager.instance.zd)return r.ULS.sendTraceTag(22381027,
322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,nj:u};const B=b.node;if(!B)return r.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,nj:u};u=B.Lc;var Q=B.pe(nb.InteractiveViewManager.instance.zd.$b);if(!Q)return r.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,
view:h,nj:u};h=Q.Tg;if(b.Vk&&Dd.ImageReader.G4(b)){b=Dd.ImageReader.aFa(b);if(!b)return r.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,nj:u};Q=b.Fwa(h,Q);if(!Q)return r.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,nj:u};Q=Q.element}else if(Dd.ImageReader.Jt(B))Q=Q.htmlElement;else return r.ULS.sendTraceTag(22381059,
322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,nj:u};return{returnValue:Q,view:h,nj:u}}vno(b){for(let B=0;B<this.Uka.length;B++){this.Uka[B]=b.Kk(Bi.a.span);this.Uka[B].className="WACImageCropHandles "+this.YYj[B];if(2>=B){var h=b.Kk(Bi.a.span);h.className=this.M$a[0];var u=b.Kk(Bi.a.span);u.className=this.M$a[1];this.Uka[B].appendChild(h);this.Uka[B].appendChild(u)}else 4<B&&(h=b.Kk(Bi.a.span),h.className=this.M$a[2],
u=b.Kk(Bi.a.span),u.className=this.M$a[3],this.Uka[B].appendChild(h),this.Uka[B].appendChild(u));if(!B||3===B||5===B)h=b.Kk(Bi.a.span),h.className=this.M$a[4],u=b.Kk(Bi.a.span),u.className=this.M$a[5],this.Uka[B].appendChild(h),this.Uka[B].appendChild(u);else if(2===B||4===B||7===B)h=b.Kk(Bi.a.span),h.className=this.M$a[6],u=b.Kk(Bi.a.span),u.className=this.M$a[7],this.Uka[B].appendChild(h),this.Uka[B].appendChild(u)}}Lzo(b,h){r.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.zLa)r.ULS.sendTraceTag(22381061,
322,100,"Attempted to start Crop Mode when it was already On.");else{var u=null,B=null;if((this.rBa=({view:u,nj:B}=this.qZl(h)).returnValue)&&u){this.rBa.classList.add("ImageCropMode");this.XAa=u.Kk(Bi.a.div);this.XAa.className="WACImageCropMode";this.yLa=u.Kk(Bi.a.f3a);this.yLa.className="WACImageCropBase";this.oK=u.Kk(Bi.a.span);this.oK.className="WACImageCropSrcRect";this.vno(u);this.XAa.appendChild(this.oK);for(u=0;u<this.Uka.length;u++)this.oK.appendChild(this.Uka[u]);this.XAa.appendChild(this.yLa);
this.yLa.style.visibility="";this.yLa.style.display="";this.rBa.appendChild(this.XAa);this.CCn(b);B=Dd.ImageReader.Ewa(b,B);u=Dd.ImageReader.lZ(b,$c.a.pqa,null);this.yLa.src=u?u:Dd.ImageReader.Gib(B);this.iYg&&this.iYg.execute(Q=>{this.Gmd||(this.Gmd=Q.mZl(this))});this.vjd||(this.I2.LP(this.rBa,this.Gmd),this.vjd=!0);this.ee&&this.ee.ob(Kd.a.eG,nb.InteractiveViewManager.instance.ve.editingElement,this.eya);this.zLa=!0;this.xDe=b;this.Fmd=h;this.did=!1;b=new Qg.GraphTransaction(4);b.Db(this.Fmd.node);
this.xDe.setValue($c.a.sxa,this.zLa);b.dispose()}else r.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}CCn(b){const h=kf.a.jf(Dd.ImageReader.iF(b),0),u=kf.a.jf(Dd.ImageReader.EG(b),1);var B=Dd.ImageReader.mca(b);const Q=Math.max(B.top,0),ca=Math.max(B.bottom,0),qa=Math.max(B.left,0);B=Math.max(B.right,0);this.yW=1E5*h/(1E5-(qa+B));this.xW=1E5*u/(1E5-(Q+ca));this.dW=Math.floor(Q*this.xW/1E5);this.aW=Math.floor(ca*
this.xW/1E5);this.bW=Math.floor(qa*this.yW/1E5);this.cW=Math.floor(B*this.yW/1E5);this.oK.style.top=this.dW+"px";this.oK.style.bottom=this.aW+"px";this.oK.style.left=this.bW+"px";this.oK.style.right=this.cW+"px";this.yLa.style.width=this.yW+"px";this.yLa.style.height=this.xW+"px";Dd.ImageReader.Jy(b)&&(this.XAa.style.width=this.yW+"px",this.XAa.style.height=this.xW+"px");this.fT=this.dW;this.cT=this.aW;this.dT=this.bW;this.eT=this.cW}Tgf(b=!1){r.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");
this.zLa?(b||this.R0k(),this.yLa?kc.a.HC(this.yLa):r.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.rBa?(this.XAa?this.XAa.parentNode===this.rBa?this.rBa.removeChild(this.XAa):r.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):r.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.rBa.classList.remove("ImageCropMode"),
this.zLa=!1,b=new Qg.GraphTransaction(4),b.Db(this.Fmd.node),this.xDe.setValue($c.a.sxa,this.zLa),b.dispose(),this.vjd&&(this.I2.$P(this.rBa,this.Gmd),this.vjd=!1),this.ee&&this.ee.sc(Kd.a.eG,nb.InteractiveViewManager.instance.ve.editingElement,this.eya),this.rBa=this.XAa=null):r.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):r.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}EEj(b,
h,u,B,Q,ca,qa){if(u){u=Math.max(this.dW-h,0);const Qa=Math.floor(this.xW)-this.aW-u;5<=Qa?(this.fT=u,this.cT=this.aW):5>Qa&&0<=Qa||0>Qa&&!this.aW?(this.fT=u-(5-Qa),this.cT=this.aW):0>Qa&&5>=Math.abs(Qa)?(this.fT=Math.floor(this.xW)-this.aW,this.cT=Math.max(this.aW-(u-(this.xW-this.aW))-(5-Math.abs(Qa)),0)):(this.fT=Math.floor(this.xW)-this.aW,this.cT=Math.max(this.aW-(u-(this.xW-this.aW)),0));this.oK.style.top=this.fT+"px";this.oK.style.bottom=this.cT+"px";qa&&(this.dW=this.fT,this.aW=this.cT)}B&&
(h=Math.max(this.aW-h,0),B=Math.floor(this.xW)-this.dW-h,5<=B?(this.cT=h,this.fT=this.dW):5>B&&0<=B||0>B&&!this.dW?(this.cT=h-(5-B),this.fT=this.dW):0>B&&5>=Math.abs(B)?(this.cT=Math.floor(this.xW)-this.dW,this.fT=Math.max(this.dW-(h-(this.xW-this.dW))-(5-Math.abs(B)),0)):(this.cT=Math.floor(this.xW)-this.dW,this.fT=Math.max(this.dW-(h-(this.xW-this.dW)),0)),this.oK.style.top=this.fT+"px",this.oK.style.bottom=this.cT+"px",qa&&(this.dW=this.fT,this.aW=this.cT));Q&&(Q=Math.max(this.bW-b,0),h=Math.floor(this.yW)-
this.cW-Q,5<=h?(this.dT=Q,this.eT=this.cW):5>h&&0<=h||0>h&&!this.cW?(this.dT=Q-(5-h),this.eT=this.cW):0>h&&5>=Math.abs(h)?(this.dT=Math.floor(this.yW)-this.cW,this.eT=Math.max(this.cW-(Q-(this.yW-this.cW))-(5-Math.abs(h)),0)):(this.dT=Math.floor(this.yW)-this.cW,this.eT=Math.max(this.cW-(Q-(this.yW-this.cW)),0)),this.oK.style.left=this.dT+"px",this.oK.style.right=this.eT+"px",qa&&(this.bW=this.dT,this.cW=this.eT));ca&&(b=Math.max(this.cW-b,0),ca=Math.floor(this.yW)-this.bW-b,5<=ca?(this.eT=b,this.dT=
this.bW):5>ca&&0<=ca||0>ca&&!this.bW?(this.eT=b-(5-ca),this.dT=this.bW):0>ca&&5>=Math.abs(ca)?(this.eT=Math.floor(this.yW)-this.bW,this.dT=Math.max(this.bW-(b-(this.yW-this.bW))-(5-Math.abs(ca)),0)):(this.eT=Math.floor(this.yW)-this.bW,this.dT=Math.max(this.bW-(b-(this.yW-this.bW)),0)),this.oK.style.left=this.dT+"px",this.oK.style.right=this.eT+"px",qa&&(this.bW=this.dT,this.cW=this.eT));qa&&(this.did=!0,Fb.App.za.updateCommandUI())}WRk(){this.fT=this.dW;this.cT=this.aW;this.dT=this.bW;this.eT=this.cW;
this.oK.style.top=this.fT+"px";this.oK.style.bottom=this.cT+"px";this.oK.style.left=this.dT+"px";this.oK.style.right=this.eT+"px"}R0k(){if(this.did){r.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.dW/this.xW),h=Math.floor(1E5*this.aW/this.xW),u=Math.floor(1E5*this.bW/this.yW),B=Math.floor(1E5*this.cW/this.yW),Q=new Od.DictionaryPropertySet;Q.setValue($c.a.Ojb,b);Q.setValue($c.a.Ljb,h);Q.setValue($c.a.Mjb,u);Q.setValue($c.a.Njb,B);this.ga.Kf(this.Fmd,
Qc.a.Boi,2,!1,null,Q)}else r.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}sxa(){return this.zLa}lSl(){return{top:this.fT,bottom:this.cT,left:this.dT,right:this.eT}}pUo(b,h){if(0>b)r.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.dW=this.fT=Math.min(Math.floor(this.xW)-this.cT-5,b);this.oK.style.top=this.fT+"px";break;case 1:this.aW=this.cT=Math.min(Math.floor(this.xW)-this.fT-5,b);this.oK.style.bottom=
this.cT+"px";break;case 2:this.bW=this.dT=Math.min(Math.floor(this.yW)-this.eT-5,b);this.oK.style.left=this.dT+"px";break;case 3:this.cW=this.eT=Math.min(Math.floor(this.yW)-this.dT-5,b),this.oK.style.right=this.eT+"px"}this.did=!0}}}Object(m.a)(Xo,"ImageEditor",al,[591,592]);class zr{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}wc(b){this.W=b;this.W.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Fd(v.AFrameworkApplication.va,Ga.a.instance.Ta("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();
this.W.ia("WordEditor.ImageEditors.ImageEditor",()=>new Xo(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Ta("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Nb.KeyInputManager.instance,b.Ta("WordEditor.IImageCropDragAdapterFactory"),b.Oa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){M.a.instance.Gc(new zr)}}Object(m.a)(zr,"WordEditorImageEditorsPackage",null,[1,2]);class wo{}Object(m.a)(wo,"FolderContentEditor",null,[1329]);class Yo{}Object(m.a)(Yo,"PageEditor",null,[1225]);
class au extends Yo{constructor(){super()}}Object(m.a)(au,"PageEditor",Yo,[]);class ml{get name(){return"WordEditor.NotebookLevelEditors"}wc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new wo).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new au).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){M.a.instance.Gc(new ml)}}Object(m.a)(ml,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Wm{get sNb(){return v.AFrameworkApplication.privacyUrl}Wua(){r.ULS.sendTraceTag(37034014,
342,50,"User clicked on the Privacy statement.");Qd.a.om(this.sNb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(m.a)(Wm,"PrivacyLinkHandler",null,[779]);class Oo{constructor(b,h){this.qLe=null;this.Pgk=b;this.Ogk=h}showDialog(b){this.qLe=b;this.Ogk.create().Qh(Object(z.a)(this,this.nmm,"handleDialog"))}nmm(b){1===b&&this.Pgk.Ohj();this.qLe();this.qLe.prototype}}Object(m.a)(Oo,"SendUsYourFileController",null,[754]);class ss extends mg.StandardDialog{constructor(b,h,u){super();
this.FZb=null;this.gg=b;this.PAc=h;this.kH=u}Qh(b){this.Cd=1;this.xe(1,this.kH.send);this.xe(0,this.kH.Ren);r.ULS.shipAssertTag(37034013,342,!this.FZb,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.pmb(this.kH.FBk,null,"CancelRequest_32x32x32",null,b,h);this.C5(this.mj(ss.Xhj))}dialogContent(){const b=document.createElement("span");b.innerText=this.kH.HFn;const h=document.createElement("span");h.innerText=this.kH.kGo;h.style.fontWeight=this.kH.HZo;const u=
document.createElement("span");u.innerText=this.kH.Cco;const B=this.U2k(),Q=document.createElement("span");Q.id=this.mj(ss.Xhj);Q.appendChild(b);Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(h);Q.appendChild(document.createElement("br"));Q.appendChild(u);Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(B);return Q}U2k(){const b=document.createElement("span"),
h=document.createElement("a");h.innerText=this.kH.pFn;h.href=this.PAc.sNb||"";b.appendChild(h);this.FZb=h;this.gg.ob(Kd.a.click,this.FZb,Object(z.a)(this.PAc,this.PAc.Wua,"clickHandler"));return b}dispose(){this.FZb&&(this.gg.sc(Kd.a.click,this.FZb,Object(z.a)(this.PAc,this.PAc.Wua,"clickHandler")),this.FZb=null);super.dispose()}}ss.Xhj="sendUsYourFileId";Object(m.a)(ss,"SendUsYourFileDialog",mg.StandardDialog,[778]);class Po{create(){return Ga.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}
Object(m.a)(Po,"Factory",null,[777]);var Qs=c(589);class go extends Qs.a{constructor(){super();this.FileId=null}el(){return 38}static construct(b){const h=new go;h.FileId=b;return h}}Object(m.a)(go,"CreateSendUsYourFileRequest",Qs.a,[]);var pq=c(1004);class jt{constructor(b,h,u){this.s6=b;this.pQ=h;this.B9j=u}Ohj(b=!1){if(this.pQ){const h=go.construct(this.pQ()),u=new pq.a;u.Gq=h;u.status=1;u.QG="BootErrorReport";b=b?this.s6(null):this.s6(B=>{this.M6c(u,B)});b.BH(u);b.$T();this.B9j()}}M6c(b){5===
b.statusCode&&this.Ohj(!0)}}Object(m.a)(jt,"SendUsYourFileManager",null,[753]);class bu{constructor(b,h){this.W=null;this.kH=b;this.pQ=h}wc(b){this.W=b;this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.kH).ha();this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new ss(Wi.a.instance,new Wm,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new jt(h=>this.sha(0,h),this.pQ,
()=>{r.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new Po;return new Oo(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(m.a)(bu,"SendUsYourFilePackageManager",null,[]);var Ar=c(515),Vq=c(1043),cu;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]=
"word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(cu||(cu={}));Object(m.b)("AppMode",cu);class Ku{get FBk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get Ren(){return CommonUIStrings.l_NoThanks}get HFn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get kGo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get HZo(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Cco(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get pFn(){return CommonUIStrings.l_PrivacyStatement}}
Object(m.a)(Ku,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Li extends bu{constructor(){super(new Ku,()=>v.AFrameworkApplication.rootQuerySignature)}sha(b,h){return new Vq.a(b,h,"SendUsYourFile.ashx",cu.word,Fb.App.webServiceBase,Ar.a.amIAlone,Ar.a.O6c,Ar.a.A6c)}get name(){return"WordEditor.SendUsYourFile"}static main(){M.a.instance.Gc(new Li)}}Object(m.a)(Li,"PackageManager",bu,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Yn=c(546),Ej=c(648),qq=c(1853),Kl=c(120),Jf=c(27),rl=c(151),zl=c(74),Zn=c(950),Yh=c(145),Rr=c(1014);class rh{constructor(b,h,u,B,Q,ca){this.a2h=b;this.gallerySectionId=h;this.dyl=u;this.Kzk=B;this.commandId=Q;this.queryCommandId=ca}}Object(m.a)(rh,"BorderStyleMenuPropsArguments",null,[]);class tk{constructor(b,h,u,B,Q,ca,qa){this.j3b=b;this.Puj=h;this.width=u;this.$Qi=B;this.height=Q;this.yFi=ca;this.altText=qa}}Object(m.a)(tk,"TableBorderStyleProperties",null,[]);class Qf{constructor(){this.pwh=
[new tk(Qf.Asj,"","2",1,8,0,"Solid Line"),new tk(Qf.aOh,"5,3","1",1,8,0,"Dashed Line"),new tk(Qf.tTh,"1,1","1",1,8,0,"Dotted Line"),new tk(Qf.vTh,"","1",2,8,3,"Double Line")];this.qwh=[new tk(Qf.xwh,"","1",1,8,0,"0.25pt"),new tk(Qf.uwh,"","1",1,8,0,"0.5pt"),new tk(Qf.Awh,"","2",1,8,0,"0.75pt"),new tk(Qf.vwh,"","2",1,8,0,"1pt"),new tk(Qf.twh,"","3",1,8,0,"1.5pt"),new tk(Qf.Bwh,"","4",1,8,0,"2.25pt"),new tk(Qf.zwh,"","4",1,8,0,"3pt"),new tk(Qf.swh,"","5",1,8,0,"4.5pt"),new tk(Qf.ywh,"","6",1,8,0,"6pt")]}initialize(){this.M5f()}PIl(){const b=
new rh("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.pwh,Ob.a.Bpb,Ob.a.L3f);return this.C2h(b)}QIl(){const b=new rh("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.qwh,Ob.a.Cpb,Ob.a.M3f);return this.C2h(b)}u4h(b){switch(b){case Qf.Asj:return Yh.a.k3b;case Qf.aOh:return Yh.a.Zeb;case Qf.tTh:return Yh.a.KGc;case Qf.vTh:return Yh.a.P3;default:return Yh.a.Oua}}v4h(b){switch(b){case Qf.xwh:return Yh.a.wwh;case Qf.uwh:return Yh.a.E3e;case Qf.Awh:return Yh.a.i3b;
case Qf.vwh:return Yh.a.Yeb;case Qf.twh:return Yh.a.Rma;case Qf.Bwh:return Yh.a.gDa;case Qf.zwh:return Yh.a.rga;case Qf.swh:return Yh.a.q_a;case Qf.ywh:return Yh.a.fDa;default:return Yh.a.iG}}C2h(b){const h=new Rk.a,u=new wh.a,B=Object.assign(new Ej.a,{Id:b.a2h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.dyl,Type:4,Width:1,GalleryItems:[]});for(const ca of b.Kzk){var Q={};const qa={};qa.width=Qf.EZm;qa.height=Qf.DZm;Q.root=qa;Q=Object.assign(new qq.a,{Id:ca.j3b,ExternalId:String.format("{0}_GalleryButton",
ca.j3b),Icon:ca.j3b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ca.j3b,FullIconStyle:Q,ShouldSetTitle:"true",Alt:ca.altText});B.GalleryItems.push(Q)}u.ControlList=[];h.MenuSectionList=[];u.ControlList.push(B);h.MenuSectionList.push(u);h.UpdateDynamically=!0;return h}M5f(){const b={};for(const h of this.pwh)b[h.j3b]=appChrome.buildBorderStyleIcon(h.Puj,h.width,h.$Qi,h.height,h.yFi);for(const h of this.qwh)b[h.j3b]=appChrome.buildBorderStyleIcon(h.Puj,h.width,
h.$Qi,h.height,h.yFi);appChrome.api.registerIconProvider(()=>b)}deo(b,h,u){if(!b)return r.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==vc.a.V5)return r.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.w1(Kl.a.mU(b),b.node,5,u,h);break;case 0:this.w1(Kl.a.mU(b),b.node,3,u,h);break;case 1:this.w1(Kl.a.mU(b),b.node,4,u,h);break;case 3:this.w1(Kl.a.mU(b),
b.node,0,u,h);break;case 7:this.w1(Kl.a.mU(b),b.node,1,u,h);break;case 8:this.w1(Kl.a.mU(b),b.node,2,u,h);break;case 6:this.w1(Kl.a.mU(b),b.node,1,u,h);this.w1(Kl.a.mU(b),b.node,2,u,h);break;case 5:this.w1(Kl.a.mU(b),b.node,3,u,h);this.w1(Kl.a.mU(b),b.node,5,u,h);this.w1(Kl.a.mU(b),b.node,4,u,h);this.w1(Kl.a.mU(b),b.node,0,u,h);break;case 4:this.w1(Kl.a.mU(b),b.node,3,u,h),this.w1(Kl.a.mU(b),b.node,5,u,h),this.w1(Kl.a.mU(b),b.node,4,u,h),this.w1(Kl.a.mU(b),b.node,0,u,h),this.w1(Kl.a.mU(b),b.node,
1,u,h),this.w1(Kl.a.mU(b),b.node,2,u,h)}return!0}Dbg(b,h,u,B){if(!h)return r.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==vc.a.E1)return r.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var Q=h.node;const ca=new vd.GraphIterator;ca.set(Q);ca.zb(14);Q=Jf.TableCellReader.vPa(ca);switch(h.border){case 2:this.LTa(b,h.node,5,B,u,Q);this.vge(h.node,5,u);this.tfe(b,h.H1a(),3,u,B,Q);
break;case 0:this.LTa(b,h.node,3,B,u,Q);this.vge(h.node,3,u);this.tfe(b,h.H1a(),1,u,B,Q);break;case 1:this.LTa(b,h.node,4,B,u,Q);this.vge(h.node,4,u);this.tfe(b,h.H1a(),0,u,B,Q);break;case 3:this.LTa(b,h.node,0,B,u,Q),this.vge(h.node,0,u),this.tfe(b,h.H1a(),2,u,B,Q)}return!0}sKn(b,h){if(Ge.SelectionEditor.FXc(b)&&h)switch(b=Object(Na.a)(rl.TableNodeBorderContext,b),b.border){case 2:this.gP(b.node,Qf.No.KM(5),h);break;case 0:this.gP(b.node,Qf.No.KM(3),h);break;case 3:this.gP(b.node,Qf.No.KM(0),h);
break;case 1:this.gP(b.node,Qf.No.KM(4),h);break;case 7:this.gP(b.node,Qf.No.KM(1),h);break;case 8:this.gP(b.node,Qf.No.KM(2),h);break;case 5:h=this.gP(b.node,Qf.No.KM(5),h);h=this.gP(b.node,Qf.No.KM(3),h);h=this.gP(b.node,Qf.No.KM(0),h);this.gP(b.node,Qf.No.KM(4),h);break;case 6:h=this.gP(b.node,Qf.No.KM(1),h);this.gP(b.node,Qf.No.KM(2),h);break;case 4:h=this.gP(b.node,Qf.No.KM(5),h),h=this.gP(b.node,Qf.No.KM(3),h),h=this.gP(b.node,Qf.No.KM(0),h),h=this.gP(b.node,Qf.No.KM(4),h),h=this.gP(b.node,
Qf.No.KM(1),h),this.gP(b.node,Qf.No.KM(2),h)}}RIn(b,h){if(Ge.SelectionEditor.GXc(b)&&h)switch(b=Object(Na.a)(rl.TableNodeBorderContext,b),b.border){case 2:this.gP(b.node,Qf.No.bP(5),h);break;case 0:this.gP(b.node,Qf.No.bP(3),h);break;case 3:this.gP(b.node,Qf.No.bP(0),h);break;case 1:this.gP(b.node,Qf.No.bP(4),h)}}inf(b,h,u){u=null;if(!b)return r.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),u;b.properties.hasProperty(h.size)&&(u=new Rr.a,u.weight=b.properties.ja(h.size,Yh.a.iG),u.style=
b.properties.ja(h.style,Yh.a.Oua),u.color=b.properties.ja(h.color,0));return u}Cbg(b,h,u){b?u?(b.properties.setValue(h.size,u.weight),b.properties.setValue(h.style,u.style),b.properties.setValue(h.color,u.color)):r.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):r.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}uOb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):r.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}w1(b,h,u,B,Q){Q=this.yXo(b,h,u,B,Q);this.kkc(h,Qf.No.KM(u),Q);switch(u){case 5:this.Aob(h,2,B,Q);break;case 4:this.Aob(h,1,B,Q);break;case 0:this.Aob(h,3,B,Q);break;case 3:this.Aob(h,0,B,Q);break;case 1:this.Aob(h,7,B,Q);break;case 2:this.Aob(h,8,B,Q)}}yXo(b,h,u,B,Q){if(3!==B){var ca=Qf.Eg.vQd(b,h,u,3);void 0!==ca&&null!==ca&&ca!==Yh.a.D_&&(ca=zl.a.pjc(ca),Q.color=Qf.q8a.cva(h,ca))}1!==B&&(ca=Qf.Eg.vQd(b,h,u,1),void 0!==ca&&null!==ca&&ca!==Yh.a.hG&&(Q.weight=parseFloat(ca)*
Yh.a.JGc));2!==B&&(b=Qf.Eg.vQd(b,h,u,2),void 0!==b&&null!==b&&b!==Yh.a.hG&&(Q.style=b));return Q}LTa(b,h,u,B,Q,ca){B&&(Q=this.VRo(b,h,ca,u,B,Q));this.kkc(h,Qf.No.bP(u),Q)}VRo(b,h,u,B,Q,ca){if(3!==Q){var qa="",Qa=Qf.Eg.zFb(b,h,B,!1,!0,u,3);Qa&&(qa=Qa.dBb);void 0!==qa&&null!==qa&&qa!==Yh.a.D_&&(qa=zl.a.pjc(qa),ca.color=Qf.q8a.cva(h,qa))}if(1!==Q){qa="";if(Qa=Qf.Eg.zFb(b,h,B,!1,!0,u,1))qa=Qa.dBb;void 0!==qa&&null!==qa&&qa!==Yh.a.hG&&(ca.weight=parseFloat(qa)*Yh.a.JGc)}if(2!==Q){Q="";if(b=Qf.Eg.zFb(b,
h,B,!1,!0,u,2))Q=b.dBb;void 0!==Q&&null!==Q&&Q!==Yh.a.hG&&(ca.style=Q)}return ca}bcn(b){let h=0,u=0;({Cbn:h,f$m:u}=this.G2l(b.style,h,u));b.weight<h&&(b.weight=h);b.weight>u&&(b.weight=u);return b}G2l(b,h,u){switch(b){case Yh.a.k3b:case Yh.a.Zeb:case Yh.a.KGc:h=2;u=48;break;case Yh.a.P3:h=2;u=24;break;default:h=2,u=48}return{Cbn:h,f$m:u}}tfe(b,h,u,B,Q,ca){if(h)if(B)for(let qa=0;qa<h.length;qa++)switch(u){case 2:this.LTa(b,h[qa],5,Q,B,ca);break;case 0:this.LTa(b,h[qa],3,Q,B,ca);break;case 1:this.LTa(b,
h[qa],4,Q,B,ca);break;case 3:this.LTa(b,h[qa],0,Q,B,ca)}else r.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else r.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}vge(b,h,u){const B=new vd.GraphIterator;B.set(b);B.zb(14);const Q=Jf.TableCellReader.Boa(b);b=Jf.TableCellReader.cP(b);qg.forEachCell(B,Q,b,(ca,qa,Qa)=>{ca=ca.currentNode;Jf.TableCellReader.Xr(ca)&&0==Qa&&0<qa&&this.kkc(ca,Qf.No.bP(h),u)})}kkc(b,h,u){b?(u=this.bcn(u),b.properties.setValue(h.color,
u.color),b.properties.setValue(h.size,u.weight),b.properties.setValue(h.style,u.style)):r.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}Aob(b,h,u,B){if(b){var Q=Zi.TableReader.eg(b),ca=Zi.TableReader.eh(b),qa=new vd.GraphIterator,Qa=[];for(let rb=0;rb<Q;rb++)for(let Lb=0;Lb<ca;Lb++)if(qa.set(b),qg.moveToCell(qa,rb,Lb),qa&&qa.currentNode&&!Jf.TableCellReader.fg(qa))switch(h){case 2:Jf.TableCellReader.cia(qa)&&Qa.push(rl.TableNodeBorderContext.o8(qa.currentNode,2));break;case 0:Jf.TableCellReader.dia(qa)&&
Qa.push(rl.TableNodeBorderContext.o8(qa.currentNode,0));break;case 3:Jf.TableCellReader.CEf(b,qa.currentNode)&&Qa.push(rl.TableNodeBorderContext.o8(qa.currentNode,3));break;case 1:Jf.TableCellReader.DEf(b,qa.currentNode)&&Qa.push(rl.TableNodeBorderContext.o8(qa.currentNode,1));break;case 7:Jf.TableCellReader.DEf(b,qa.currentNode)||Qa.push(rl.TableNodeBorderContext.o8(qa.currentNode,1));break;case 8:Jf.TableCellReader.CEf(b,qa.currentNode)||Qa.push(rl.TableNodeBorderContext.o8(qa.currentNode,3))}for(b=
0;b<Qa.length;b++)switch(h=Qa[b],h.border){case 2:this.H5c(h.node,Qf.No.bP(5),u,B);this.xce(h.H1a(),Qf.No.bP(0),u,B);break;case 0:this.H5c(h.node,Qf.No.bP(3),u,B);this.xce(h.H1a(),Qf.No.bP(4),u,B);break;case 1:this.H5c(h.node,Qf.No.bP(4),u,B);this.xce(h.H1a(),Qf.No.bP(3),u,B);break;case 3:this.H5c(h.node,Qf.No.bP(0),u,B),this.xce(h.H1a(),Qf.No.bP(5),u,B)}}else r.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}xce(b,h,u,B){if(b)for(let Q=0;Q<b.length;Q++)this.H5c(b[Q],h,u,B);else r.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}H5c(b,h,u,B){if(b){var Q=b.ja(h.color,Qf.Dcf),ca=b.ja(h.size,Qf.Fcf),qa=b.ja(h.style,Qf.Ecf),Qa=new Rr.a;Qa.weight=B.weight;Qa.style=B.style;Qa.color=B.color;2!==u||Q===Qf.Dcf&&ca===Qf.Fcf?3!==u||qa===Qf.Ecf&&ca===Qf.Fcf?1!==u||Q===Qf.Dcf&&qa===Qf.Ecf?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Qa.color=Q,Qa.style=qa,this.kkc(b,h,Qa)):(Qa.style=qa,Qa.weight=ca,this.kkc(b,h,Qa)):(Qa.color=
Q,Qa.weight=ca,this.kkc(b,h,Qa))}else r.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}gP(b,h,u){var B=b.properties.ja(h.style,Yh.a.hG);B!==Yh.a.hG&&(u.lineStyle!==Yh.a.hG?u.lineStyle!==B&&(u.lineStyle=Yh.a.jKk):u.lineStyle=B);B=b.properties.ja(h.size,Yh.a.iG);B!==Yh.a.iG&&(u.iZc!==Yh.a.iG?u.iZc!==B&&(u.iZc=Yh.a.bKk):u.iZc=B);b=b.properties.ja(h.color,0);b=zl.a.aF(b);b!==Yh.a.D_&&(u.borderColor!==Yh.a.D_?u.borderColor!==b&&(u.borderColor=Yh.a.UJk):u.borderColor=b);return u}static get No(){return null!=
Qf.Xug?Qf.Xug:Qf.Xug=Yh.a.instance}static get Eg(){return null!=Qf.SIg?Qf.SIg:Qf.SIg=Ga.a.instance.Oa("WordEditor.IWACTableStyleReader")}static get q8a(){return null!=Qf.FGg?Qf.FGg:Qf.FGg=Zn.a.instance}}Qf.EZm="110px";Qf.DZm="20px";Qf.Asj="SolidLineStyle";Qf.aOh="DashedLineStyle";Qf.tTh="DottedLineStyle";Qf.vTh="DoubleLineStyle";Qf.xwh="BorderPointSizeOneQuarter";Qf.uwh="BorderPointSizeOneHalf";Qf.Awh="BorderPointSizeThreeQuarters";Qf.vwh="BorderPointSizeOne";Qf.twh="BorderPointSizeOneAndHalf";Qf.Bwh=
"BorderPointSizeTwoAndQuarter";Qf.zwh="BorderPointSizeThree";Qf.swh="BorderPointSizeFourAndHalf";Qf.ywh="BorderPointSizeSix";Qf.Ecf="single";Qf.Fcf=4;Qf.Dcf=0;Object(m.a)(Qf,"TableBorderManager",null,[590]);var Xm=c(855),Im=c(53),Sr=c(208);class yk{constructor(b,h){this.nbh=this.X6g=null;this.TNa=b;this.s9g=h}get CYi(){return this.s9g}get eqa(){return this.X6g}get l5f(){return this.nbh}llj(b,h){this.nbh=b;this.X6g=h}ejo(b){this.s9g=b}}Object(m.a)(yk,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var nj=c(84),bq=c(197),qm=c(363),ts=c(144),Pk=c(252),cq=c(596),Lu=c(77),Pp=c(479),rq=c(1059);class Ym extends Xm.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb=null,gc=null){super(b,h,u,gc,Yb);this.y$a=rq.a.instance;this.sa=new Nc.a;this.$Ah=[Jc.a.qmc,Jc.a.zqb,Jc.a.mRb,Jc.a.omc,Jc.a.xqb,Jc.a.kRb,Jc.a.nmc,Jc.a.wqb,Jc.a.jRb,Jc.a.pmc,Jc.a.yqb,Jc.a.lRb];this.QWj=[Jc.a.ya,Jc.a.xa,Xe.a.Ih,Xe.a.er];this.ei=B;this.dzb=Q;this.Zc=ca;this.ib=qa;this.S6=Qa;this.em=rb;this.evc=Lb;this.qih=Yb;this.dlk=gc;this.HHn=
this.s2f.bind(this)}get nj(){return this.ei.value}get Xs(){return this.S6?this.S6.instance:null}g_e(b){this.sa.addHandler("OnParagraphDelete",b)}get fh(){return!!this.evc.instance&&this.evc.instance.fh}sUc(b,h,u,B,Q){h.setValue(Jc.a.Wc,qe.a.zF());h.setValue(Jc.a.yHm,Q);cq.c(B,h,[Jc.a.G1]);super.sUc(b,h,u,B,Q)}VWd(b,h,u,B,Q){const ca=this.URc(h,u,B,Q);this.DHd(ca,h,!1);return super.VWd(b,h,u,B,Q)}uAd(b,h,u,B,Q){const ca=this.URc(h,u,B,Q);this.DHd(ca,h,!0);super.uAd(b,h,u,B,Q);return ca}e$e(b,h,u,B){h=
this.URc(b,h,u,B);this.DHd(h,b,!0);return h}insertRows(b,h,u,B){const Q=Im.a.Es(b),ca=new vd.GraphIterator;ca.jd(b);const qa=ca.currentNode;ca.Ub(1);let Qa;Qa=h?b.MM(1):b.currentNode;const rb=b.rc();if(!rb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Lb=Zi.TableReader.eg(rb),Yb=rb.Q_.Eg;let gc=!1;try{rb.bza=1;const Fc=this.y$a.oib(rb,Yb.kF(rb));this.ZTa(b.currentNode);this.Nra(b);this.Nrk(u,b,Qa,ca,qa,h,B);const Sc=this.y$a.oib(rb,Yb.kF(rb));this.C7a(rb,
Zi.TableReader.eg(rb)+u);gc=!0;this.FXd(rb,Fc,Sc)}finally{rb.bza=0,gc||this.C7a(rb,Zi.TableReader.eg(rb)+u)}Q+1!==Lb||h?!Q&&h&&Ym.wBf(rb,u):Ym.wBf(rb,Q);h=Q+u+(h?0:1);h<Lb+u&&this.Ysi(rb,h);return b.currentNode}Nrk(b,h,u,B,Q,ca,qa){let Qa=null,rb=null;for(var Lb=0;Lb<b;++Lb){var Yb=Sr.a.instance.createInstance(393251);rb||(rb=Yb);Qa=Yb;this.sUc(h,Yb,u,Q,ca)}b=Zi.TableReader.eh(h.currentNode);u=!0;do{u?(h.wj(Qa),u=!1):h.Jf(1);Q=Array(b);for(Lb=0;Lb<b;++Lb){Yb=this.vOa();const gc=this.e$e(Yb,B.currentNode,
ca,!0);let Fc=null;gc.fg||(Fc=qa(gc));Q[Lb]=new yk(Yb,Fc);Q[Lb].llj(gc,null);B.Jf(1)}for(Lb=0;Lb<b;++Lb)Yb=Q[Lb].TNa,h.C3(Yb,1,Xm.a.mLa?Xm.a.mLa():null),Jf.TableCellReader.Xr(Yb)||(this.CAb(h,Yb,Q[Lb].CYi),this.LIh(Q[Lb].l5f,Yb,!0));B.Nha(1)}while(h.currentNode!==rb)}insertColumns(b,h,u,B,Q){let ca=b.currentNode,qa=!1,Qa=Zi.TableReader.eh(b.currentNode);const rb=Qa;try{this.ZTa(b.currentNode);this.Nra(b);const Lb=ca.Q_.Eg;ca.bza=1;const Yb=this.y$a.oib(ca,Lb.kF(ca));Qa=Zi.TableReader.eh(b.currentNode);
-1===h&&(h=Qa);this.Lrk(b,B,u,h,Q);ca=b.currentNode;Qa+=B;this.E4f(b,Qa,B,h);qa=!0;const gc=this.y$a.oib(ca,Lb.kF(ca));this.FXd(ca,Yb,gc)}finally{ca.bza=0,qa||this.E4f(b,Qa,B,h)}h!==rb||u?!h&&u&&Ym.vBf(ca,B):Ym.vBf(ca,h-1)}Lrk(b,h,u,B,Q){var ca=b.currentNode;B=u?B:B-1;b.Ub(1);var qa=new zb.a;do{var Qa=b.HG(B,1);b.rc();var rb=Array(h);for(let Yb=0;Yb<h;++Yb){var Lb=this.vOa();const gc=this.w4l(b,Qa,u),Fc=this.e$e(Lb,Qa,u,!1);Lb=new yk(Lb,null);Lb.llj(Fc,gc);rb[Yb]=Lb}qa.add(rb)}while(b.Ni(1));u=qa.toArray();
for(B=0;B<u.length;B++)for(qa=0;qa<h;qa++)Qa=u[B][qa],rb=Qa.l5f,rb.fg||Qa.ejo(Q(rb));b.set(ca);b.Ub(1);Q=0;do{for(ca=0;ca<h;++ca)B=u[Q][ca],qa=B.TNa,b.ZHb(qa,B.eqa,1,Xm.a.mLa?Xm.a.mLa():null),Jf.TableCellReader.Xr(qa)||(this.CAb(b,qa,B.CYi),this.LIh(B.l5f,qa,!1));Q++}while(b.Ni(1))}FXd(b,h,u){if(h){var B=2===b.bza,Q=[],ca=new vd.GraphIterator;ca.set(b);for(var qa=ca.Ub(1);qa;){for(qa=ca.Ub(1);qa;){const Qa=qa.id.toString();Qa in h&&h[Qa]===u[Qa]&&(!B||!Jf.TableCellReader.dia(ca)&&!Jf.TableCellReader.cia(ca))||
Q.push(qa);qa=ca.Ni(1)}qa=ca.Ni(1)}if(0<Q.length){h=new Qg.GraphTransaction(3);try{h.set(b.tj);for(const Qa of Q)Qa.xBf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const u=Im.a.Es(b),B=u+h;let Q=b.rc();const ca=Q.Q_.Eg;let qa=!1;r.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",Q.id.toString(),Q.type,u,h);const Qa=Zi.TableReader.eg(Q);try{Q.bza=2;const rb=this.y$a.oib(Q,ca.kF(Q));this.ZTa(b.currentNode);
this.Nra(b);for(let Yb=B-1;Yb>=u;--Yb){b.HG(Yb,1);let gc=b.Ub(1);for(;gc;)this.d1c(gc,!0),gc=b.Ni(1);this.Q2a(b);r.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Ue);b.vg()}Q=b.currentNode;const Lb=this.y$a.oib(Q,ca.kF(Q));this.C7a(Q,Zi.TableReader.eg(Q)-h);this.j6d(b);qa=!0;this.FXd(Q,rb,Lb)}finally{Q.bza=0,qa||(this.C7a(b.currentNode,Zi.TableReader.eg(b.currentNode)-h),this.j6d(b))}Qa===B&&0<=u-1&&Ym.wBf(Q,u-1);u<Qa-h&&this.Ysi(Q,u)}deleteColumns(b,
h,u){b=Object(Na.a)(vd.GraphIterator,b);let B=Object(Na.a)(Pp.a,b.currentNode),Q=Zi.TableReader.eh(b.currentNode);const ca=B.Q_.Eg;let qa=!1;r.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",B.id.toString(),B.type,h,u);const Qa=Q;try{B.bza=2;const rb=this.y$a.oib(B,ca.kF(B));this.ZTa(b.currentNode);this.Nra(b);-1===h&&(h=Q-u);b.Ub(1);do for(let Yb=h+u-1;Yb>=h;--Yb)b.HG(Yb,1),this.d1c(b.currentNode,
!1),this.Q2a(b),b.vg();while(b.Ni(1));Q-=u;this.D4f(b,Q,h,u);qa=!0;B=Object(Na.a)(Pp.a,b.currentNode);const Lb=this.y$a.oib(B,ca.kF(B));this.FXd(B,rb,Lb);this.i6d(b)}finally{B&&(B.bza=0),qa||(this.D4f(b,Q,h,u),this.i6d(b))}Qa===h+u&&0<=h-1&&Ym.vBf(B,h-1)}mergeCells(b,h,u){if(b&&(1!==h||1!==u)){var B=new vd.GraphIterator;B.jd(b);B.zb(14);this.vaf(B,h,u);this.CRo(B,h,u);B.rc();B.rc();this.BUi(B)}}ctj(b,h,u){if(b&&(1!==h||1!==u)){var B=new vd.GraphIterator;B.jd(b);B.zb(14);this.Lcl(B,h,u);B.rc();B.rc();
this.RWi(B)}}d1c(b,h){r.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.fmm(b,h,this.HHn)}s2f(b,h){const u=b.currentNode;u.fg=!1;this.DHd(h.currentNode,b.currentNode,!0);u.removeProperty(Jc.a.skippedCell);u.removeProperty(Jc.a.renderCell);1===u.colSpan&&1===u.rowSpan&&u.VHc();Xm.a.BK.P7(b,!0,Xm.a.mci(h.currentNode));qg.returnToCell(b);this.h6k(h,b)}Rwf(b,h,u){super.Rwf(b,h,u);1===h.xM.colSpan&&1===h.xM.rowSpan?h.xM.VHc():!u&&h.gee&&(b.aQa?
1<b.colSpan&&(h=new vd.GraphIterator,h.set(b),h.zb(15),qg.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(u=new vd.GraphIterator,u.set(h.xM),u.zb(15),h=Lu.a(u),u=new vd.GraphIterator,u.set(b),u.zb(15),qg.moveToColumnByIndex(u,h),--u.currentNode.colSpan))}URc(b,h,u,B){const Q=super.URc(b,h,u,B);if(b.fg&&!B){var ca=h.Vxa;ca.gee&&(B=Xm.a.K8b(ca.xM,B),!ca.OFd&&u||ca.OFd===B-1&&!u?b.colSpan=1:(u=new vd.GraphIterator,u.set(ca.xM),u.zb(15),ca=Lu.a(u),u=new vd.GraphIterator,u.set(h),u.zb(15),qg.moveToColumnByIndex(u,
ca),u.currentNode.colSpan+=1))}Q.ja(Jc.a.skippedCell,!1)&&(b.fg=!0,b.Q4=!0,b.Qpb=!0);return Q}j6d(b){this.nSb(b,Jc.a.complexTable)}i6d(b){this.nSb(b,Jc.a.complexTable)}BUi(b){this.nSb(b,Jc.a.complexTable)}RWi(b){this.nSb(b,Jc.a.complexTable)}h6k(b,h){if(b&&h){let u;b=vd.GraphIterator.eb(b.currentNode);uf.OutlineNavigator.I9(b)&&(b.Ub(2),b=b.currentNode,12==b.type&&(u=b.rf(Xe.a.Ih)));u&&(b=new vd.GraphIterator,b.jd(h),uf.OutlineNavigator.I9(b)&&b.Ub(2)&&(h=b.currentNode,12==h.type&&h.Dg(Xe.a.Ih,u)))}}DHd(b,
h,u){b&&(cq.c(b,h,this.$Ah),cq.c(b,h,[Xe.a.QK]),u&&cq.c(b,h,[Jc.a.kS,Jc.a.xV,Jc.a.CUa,Jc.a.BUa,Jc.a.OIa,Jc.a.skippedCell,Jc.a.renderCell]))}LIh(b,h,u){b&&(b=vd.GraphIterator.eb(b),b.rd(),b.Qd(),h=vd.GraphIterator.eb(h),h.rd(),h.Qd(),Yc.OutlineElementReader.Bh(b)&&gf.OutlineElementNavigator.Ce(b)&&Yc.OutlineElementReader.Bh(h)&&gf.OutlineElementNavigator.Ce(h)&&cq.c(b.currentNode,h.currentNode,this.QWj),u&&(gf.OutlineElementNavigator.Wd(b),gf.OutlineElementNavigator.Wd(h),Lf.ListItemReader.jg(b)&&
(u=Ym.q_m.tw(b),u.dC=nj.a.qm,{gxa:u}=Ym.Jn.Gma(u.propertySet,h,u))))}Q2a(b){this.fh&&this.em.qWn(b.currentNode);for(b=bq.a.Np(b);b.moveNext();)if(me.ParagraphReader.Wb(b.currentNode)){const h=Hq.e(b.currentNode);for(const u of h)u.Nia();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else Lf.ListItemReader.jg(b.iterator)&&this.Xs&&this.Xs.Lda(b.iterator)}lE(b,h){let u=null;if(this.qih.tg){const B=Object(Na.a)(Pp.a,b);B&&(u=B.cV())}Zi.TableReader.In(b)&&(1===h?h=3:3===h&&(h=1));super.lE(b,h);
this.qih.tg&&this.dlk.$Ta(b,u);Object(Cb.a)(Pp.a,b)&&Xm.a.mh.Zlj(Object(Na.a)(Pp.a,b),(new qm.a(1,0)).Ut)}Kcg(b,h){const u=Array(h),B=this.ahi(b)/h;for(let Q=0;Q<h;Q++)u[Q]=Math.max(kf.a.Kl(ts.a.nea,0),B);b.setValue(Xe.a.Vz,u)}Skj(b){b.setValue(Jc.a.tableLayout,0)}yqh(b,h,u,B,Q){const ca=Array(u);for(var qa=0,Qa=0;qa<B;++qa)ca[qa]=h[qa],Qa+=ca[qa];for(;qa<u;++qa)ca[qa]=0>qa-Q?h[0]:h[qa-Q],Qa+=ca[qa];qa=this.ahi(b.currentNode);if(Qa>qa)for(Qa=qa/Qa,qa=0;qa<u;++qa)ca[qa]=Math.max(kf.a.Kl(ts.a.nea,0),
ca[qa]*Qa);return ca}ahi(b){var h=vd.GraphIterator.eb(b);b=kf.a.Kl(kf.a.Ki(Zi.TableReader.Ogi(h),0),0);if(h.zb(16))return qg.returnToCell(h),h=ts.a.nnc(h.currentNode),kf.a.Kl(kf.a.Ki(h,0),0)-b;h=Pk.a.kbd(h);return kf.a.Kl(kf.a.Ki(h,0),0)-b}cP(b,h,u){const B=new vd.GraphIterator;B.set(b);qg.moveToCell(B,h,u);return B.currentNode.ja(Jc.a.colSpan,1)}rkc(b){var h=Fb.App.za.jb.gu;if(h.qe&&(h=b.pe(h.$b))){var u=!1,B=Zi.TableReader.eh(b),Q=b.ja(Xe.a.Vz,Array(B));for(var ca of Q)if(!ca){u=!0;break}if(u){Q=
Cl.a.clone(Q);ca=b.ja(Jc.a.complexTable,!1);r.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",B,Q,ca);u=1;var qa=0;for(let rb=0;rb<B;)if(ca&&(u=this.cP(b,0,rb)),1<u){for(var Qa=0;Qa<u;Qa++)Q[rb]||(Q[rb]=this.Sai(0)),rb++;qa+=u-1}else(Qa=h.kSl(rb-qa))||r.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",rb,qa),Q[rb]||(Q[rb]=this.Sai(Qa)),rb++;b.setValue(Xe.a.Vz,Q)}}}Sai(b){return kf.a.Kl(Math.max(b,
ts.a.nea),0)}ZTa(b){b=vd.GraphIterator.eb(b);this.rkc(b.currentNode);b.zb(14)&&(qg.returnToContainingTable(b),this.rkc(b.currentNode))}Wlj(b,h){h&&b.setValue(Jc.a.M$,h)}pdg(b,h){h&&b.setValue(Jc.a.mmc,h)}jDh(b,h){const u=Zi.TableReader.eh(b);Xm.a.wWk(b,h,u)}cfo(b,h,u){let B;if(!({tableNode:B}=this.udc(b)).returnValue)return!1;if(h&&u&&h.length===u.length){if(!this.uol(B,h))return!1;for(let Q=0;Q<h.length;++Q){const ca=this.dzb.v8c(b,h[Q],u[Q]);if(ca)return r.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ca),!1}this.n4d(B);return!0}return!1}fCk(b,h){let u;if(!({tableNode:u}=this.udc(b)).returnValue||Zi.TableReader.MB(u))return!1;var B=Object(Na.a)(vd.GraphIterator,this.Zc.Tf(u));qg.moveToLastRow(B);var Q=Zi.TableReader.eg(u);if(h&&0<h.length){this.insertRows(B,!1,h.length,()=>null);B=Zi.TableReader.eg(u);var ca=this.Zc.Tf(u);Q=this.Kgi(ca,Q,B-1);for(B=0;B<Q.length;++B){ca=Q[B];const qa=h[B];for(let Qa=0;Qa<ca.length;++Qa){let rb;if(rb=qa&&qa[Qa]?this.dzb.v8c(b,ca[Qa],qa[Qa].toString()):this.dzb.v8c(b,
ca[Qa],""))return r.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",rb),!1}}}this.n4d(u);return!0}OBk(b,h){let u;if(!({tableNode:u}=this.udc(b)).returnValue||Zi.TableReader.MB(u))return!1;var B=this.Zc.Tf(u),Q=Zi.TableReader.eh(u);if(h&&0<h.length){this.insertColumns(Object(Na.a)(vd.GraphIterator,B),Q,!1,h[1].length,()=>null);var ca=Zi.TableReader.eh(u);B=this.oem(B,Q,ca-1);for(Q=0;Q<B.length;++Q){ca=h[Q];const qa=B[Q];for(let Qa=
0;Qa<qa.length;++Qa){let rb;if(rb=ca&&ca[Qa]?this.dzb.v8c(b,qa[Qa],ca[Qa].toString()):this.dzb.v8c(b,qa[Qa],""))return r.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",rb),!1}}}this.n4d(u);return!0}Xhl(b){let h;if(!({tableNode:h}=this.udc(b)).returnValue)return!1;let u=this.f2a(h);const B=Zi.TableReader.eg(h);var Q=this.Zc.Tf(h);Q=this.Kgi(Q,u,B-1);for(let ca=0;ca<Q.length;++ca){const qa=Q[ca];for(let Qa=0;Qa<qa.length;++Qa){const rb=
this.dzb.v8i(b,qa[Qa]);if(rb)return r.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",rb),!1}}u=u?u:1;b=this.Zc.Tf(h);b.lF(u)&&15===b.Ue&&this.deleteRows(Object(Na.a)(vd.GraphIterator,b),B-u);this.n4d(h);return!0}f2a(b){let h=0;const u=this.Zc.Tf(b);let B=u.Qd();for(;B&&B.ja(Jc.a.llb,!1);)h++,B=u.Gt();return!h&&Xm.a.Dx.i0(b)&32?1:h}CRo(b,h,u){var B,Q;const ca=b.currentNode,qa=new vd.GraphIterator;qa.jd(b);let Qa=null,rb=null,Lb=null;
const Yb=Yh.a.instance.bP(3),gc=Yh.a.instance.bP(4),Fc=Yh.a.instance.bP(5),Sc=Yh.a.instance.bP(0);qg.forEachCell(qa,h,u,(ld,Hd,Ie)=>{ld=ld.currentNode;Hd||Ie||(Qa=Ym.Uz.inf(ld,Yb,Qa));Hd||Ie!==u-1||(rb=Ym.Uz.inf(ld,gc,rb));0<Hd&&!Ie&&(Qa?Ym.Uz.Cbg(ld,Yb,Qa):Ym.Uz.uOb(ld,Yb),rb?Ym.Uz.Cbg(ld,gc,rb):Ym.Uz.uOb(ld,gc),Ym.Uz.uOb(ld,Fc),Hd!==h-1&&Ym.Uz.uOb(ld,Sc));Ie||Hd!==h-1||(Lb=Ym.Uz.inf(ld,Sc,Lb))});b=null===(Q=null===(B=null===Fb.App||void 0===Fb.App?void 0:Fb.App.za)||void 0===B?void 0:B.jb)||void 0===
Q?void 0:Q.gu;rb?(B=rl.TableNodeBorderContext.o8(ca,1),Ym.Uz.Dbg(Kl.a.kq(b),B,rb,0)):Ym.Uz.uOb(ca,gc);B=rl.TableNodeBorderContext.o8(ca,0);if(Qa)Ym.Uz.Dbg(Kl.a.kq(b),B,Qa,0);else for(B=Object(Na.a)(rl.TableNodeBorderContext,B).H1a(),Q=0;Q<B.length;Q++)Ym.Uz.uOb(B[Q],gc);Lb?Ym.Uz.Cbg(ca,Sc,Lb):Ym.Uz.uOb(ca,Sc)}uol(b,h){for(let B=0;B<h.length;++B){var u=this.Zc.Tf(h[B]);if(u.zb(14)&&(u=u.ld(14),b.id===u.id))continue;return!1}return!0}udc(b){let h=null;if(b&&b.xu.toString()!==b.Az.toString())return{returnValue:!1,
tableNode:h};h=this.nj.Eb(b.xu);return 14===h.type&&this.dzb.udc(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}Kgi(b,h,u){const B=[];qg.forEachCellInTable(Object(Na.a)(vd.GraphIterator,b),(Q,ca,qa)=>{if(ca>=h&&ca<=u)qa||B.push([]),Jf.TableCellReader.fg(Q)||Array.add(B[ca-h],Q.currentNode);else if(ca>u)return!1;return!0});return B}oem(b,h,u){const B=[];qg.forEachCellInTable(Object(Na.a)(vd.GraphIterator,b),(Q,ca,qa)=>{qa>=h&&qa<=u&&(qa===h&&B.push([]),Jf.TableCellReader.fg(Q)||Array.add(B[ca],
Q.currentNode));return!0});return B}n4d(b){if(b&&14===b.type){b=Object(Na.a)(vd.GraphIterator,this.Zc.Tf(b));const h=new zb.a;me.ParagraphReader.Qib(b,!0,!1,h);b=Cg.SelectionFactory.ne(h.J(h.count-1),0);this.ib.Bc(b)}}static get Uz(){Ym.Yta||(Ym.Yta=Ga.a.instance.Oa("WordEditor.ITableBorderManager"));return Ym.Yta}static get q_m(){return null!=Ym.GCg?Ym.GCg:Ym.GCg=Ga.a.instance.resolve("Box4.List.IListReader")}static get Jn(){return null!=Ym.ACg?Ym.ACg:Ym.ACg=Ga.a.instance.resolve("Box4.List.IListEditor")}Ysi(b,
h){const u=new vd.GraphIterator;u.set(b);qg.moveToFirstRow(u);qg.moveToRowByIndex(u,h);do u.currentNode.gl(4,!0);while(qg.moveToNextRow(u))}static wBf(b,h){if(b){var u=Zi.TableReader.eg(b),B=Zi.TableReader.eh(b);if(!(!Fb.App.za.jb.gu.qe||0>h||h>=u))for(u=new vd.GraphIterator,u.set(b),b=0;b<B;b++){b?qg.moveToNextColumn(u):qg.moveToCell(u,h,b);if(!u||!u.currentNode||16!==u.currentNode.type)continue;let Q=u.currentNode;Jf.TableCellReader.Xr(Q)&&(Q=Jf.TableCellReader.iha(Q));Q&&Q.gl(4,!0)}}else r.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static vBf(b,h){if(b){var u=Zi.TableReader.eg(b),B=Zi.TableReader.eh(b),Q=new vd.GraphIterator;if(!(!Fb.App.za.jb.gu.qe||0>h||h>=B))for(B=0;B<u;B++){Q.set(b);qg.moveToCell(Q,B,h);if(!Q||!Q.currentNode)continue;let ca=Q.currentNode;Jf.TableCellReader.Xr(ca)&&(ca=Jf.TableCellReader.iha(ca));ca&&ca.gl(4,!0)}}else r.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}Ym.Yta=null;Object(m.a)(Ym,"TableEditor",
Xm.a,[589,377]);class Ct{get name(){return"WordEditor.TableEditors"}wc(b){v.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new Ym(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new hg.a(()=>Fb.App.za.jb.Yc.vd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Yn.a,xf.a.instance,b.Ta("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Ta("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ia("WordEditor.TableEditors.TableBorderManager",()=>new Qf).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){M.a.instance.Gc(new Ct)}}Object(m.a)(Ct,"WordEditorTableEditorsPackage",null,[1,2]);class Dt{get name(){return"WordEditor.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new Dt)}}
Object(m.a)(Dt,"WordEditorTextLevelEditorsPackage",null,[1,2]);var mr=c(1975);c(471);var sn=c(769),$w=c(220),Wq=c(250);class Br{constructor(b){this.ock=b}ebl(){const b=Sr.a.instance.createInstance(393228);b.setValue(Xe.a.yL,$w.a.first);b.setValue(Xe.a.Uvh,0);b.setValue(Xe.a.sia,Rj.OutlineReader.Ygl);(new sn.OutlineIndentInfo(!0)).yfj(b);return b}P7(b,h,u=null){const B=b.currentNode;if(!b.zJ(1))return this.akb(b,null,h,u);Yc.OutlineElementReader.pL(b)&&gf.OutlineElementNavigator.mPf(b,!0);return Yc.OutlineElementReader.Bh(b)?
Br.Yf.Iz(b,!1,h,u):(b.V6c(B),null)}cRk(b){return Rj.OutlineReader.uFf(b.currentNode)||Yc.OutlineElementReader.Bh(b)||Yc.OutlineElementReader.pL(b)||Jf.TableCellReader.isTableCell(b)}akb(b,h=null,u=!1,B=null){if(!this.cRk(b))return null;const Q=Br.Yf.hgb();this.yko(Q,b);b.ZHb(Q,h,1,null);b.wj(Q);u&&(Br.Yf.fJ(b,B),gf.OutlineElementNavigator.Wd(b));return Q}yko(b,h){if(h=this.ram(h))switch(h.type){case 11:Br.Yf.Uff(h,b,!0);break;case 8:h=Br.wi.isRtl(h),Br.Yf.SPb(b,h)}}ram(b){return this.ock.sam(b)}RPb(b,
h){b.setValue(Xe.a.er,h?11:9)}kfo(b,h){const u=Wq.WordSectionNavigator.instance.OJ(b);return u?Rj.OutlineReader.LX(b)!==h?(u.setValue(Jc.a.Ocf,h),!0):!1:null}static get wi(){return Df.PageReader.instance}static get Yf(){return Br.mh||(Br.mh=Ga.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Yf(b){Br.mh=b}}Br.mh=null;Br.Be=null;Object(m.a)(Br,"OutlineEditor",null,[391]);const Ev=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new Br(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();
b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new mr.a(b.Re("Box4.IOutlineEditor"),b.Re("Box4.List.IListEditor"),b.Re("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").ha()};
class du{Soj(){return{Roj:!0,jJj:!1}}}Object(m.a)(du,"CursorMovementValidator",null,[317]);class kw{get name(){return"Box4.OutlineLevelEditors"}wc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new du).as("Box4.List.ICursorMovementValidator").ha();Ev(b)}init(){}dispose(){}static main(){M.a.instance.Gc(new kw)}}Object(m.a)(kw,"Box4OutlineLevelEditorsPackage",null,[1,2]);class pz{constructor(b){this.cJd=null;this.sRi=b.kb("OfficeOnlineChromeExtensionId");this.BRi=b.kb("ChromeClipboardAccessExtensionId");
this.GGm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.Keh=!this.POm();this.cJd=this.kQb?this.BRi:this.sRi}B3n(){this.cJd===this.sRi&&this.lyi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.cJd=this.BRi;this.Keh=!0}get kQb(){return this.Keh}POm(){if(this.GGm&&this.lyi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get lyi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){r.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(m.a)(pz,"ChromeExtensionHelper",null,[954]);var gv=c(1452),Rx=c(679),eu=c(1404);class lw{create(b){return new eu.a(b)}}Object(m.a)(lw,"Factory",null,[517]);var Qp=c(142);class Sx{constructor(b,
h,u){this.Xlk=b;this.ue=h;this.tZa=u}Tb(){this.tZa.fb(Ob.a.o$d,vc.a.application,this.o$d.bind(this),96);this.tZa.ra(Ob.a.hoc,vc.a.view,this.pXo.bind(this));this.tZa.fb(Ob.a.t4i,vc.a.view,this.rXo.bind(this),96)}o$d(b,h,u,B,Q){if(1===u)return 32;b=Object.assign(new Rk.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];u=Object.assign(new wh.a,{ControlList:[]});u.ControlList.push(Object.assign(new yg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));
h.push(u);Array.addRange(b.MenuSectionList,h);Q.MenuItems=b;return 32}rXo(b,h,u,B,Q){if(1===u)return 32;b=lk.a.Vuj();null==b&&8;b=this.ue.qR(b);Q[xm.a.LabelText]=String.format(F.a.vf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}pXo(b,h,u){b=lk.a.zJb(h);if(1===u||b)return b?8:32;u=new Map;u.set("Source","StyleContextMenuActor");u.set("Action","UpdateStyle");xa.Health.instance.recordKpiUsage(Qp.a.mAa,0,Qp.a.xB,u);this.Xlk.Rog(h)?Pc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new Ub.a,{extendedProperties:h}),xa.Health.instance.recordKpiFailure(Qp.a.mAa,"UpdateStyleFailed",!1,!0,h),Pc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(m.a)(Sx,"StyleContextMenuActor",null,[]);var Cr=c(1045),qz=c(1522),mw=c(445),ax=c(1772);class bx extends ax.a{constructor(b,h,u,B,Q,ca,qa=null,Qa=null){super(b,ca,qa,Qa);this._formatting=
null;this.gLa=!1;this.Aub=v.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Nwb=0;this.pDc=new zb.a;Pc.a(8128527,307,Yc.OutlineElementReader.Bh(b));this.mM=h;this.mM.a3b(this);this.mq=u;this.Jn=B;this.Fd=Q;this.Z3e=Qa;this.$Me=Lf.ListItemReader.jg(this.zc)}get il(){return null!=this.eEg?this.eEg:this.eEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get VId(){return null}get Y4b(){return this.$Me&&!this.mM.aEa}get eDb(){return 0<this.Nwb}wda(b,h){if(!this.wZ.ymg(this.zc,
h,!0)){Pc.a(8701077,307,me.ParagraphReader.kh(this.zc));var u=this.zc.currentNode,B=Je.a.rw(u);this.Aub&&this._formatting.jR&&(u=u.qa.last,this.gLa&&(u.formatting=this._formatting.jR.yf(u),this.gLa=!1),b=this.wZ.axf(b,h),this.wZ.y$(this.zc.currentNode,this._formatting.Dda,h));this.ig.Ge(B,b)}}vda(){Pc.a(8701078,307,me.ParagraphReader.kh(this.zc));const b=Je.a.rw(this.zc.currentNode);this.ig.Uha(b,h=>new mw.a(h))}snb(){this.wZ.gxf(this.zc)}cHa(){this.Aub&&(this.gLa=!0)}kSa(){Pc.a(8701079,307,me.ParagraphReader.kh(this.zc))}jSa(){Pc.a(8701080,
307,me.ParagraphReader.kh(this.zc))}fE(b){this.mM.aEa||(this.Aub?(this.M0e(b),this._formatting.dme(this.zc.currentNode),b&&"P"===b.V9.UVd&&this.Z3e.bea(this.zc.currentNode,this._formatting.cS),this.wZ.y$(this.zc.currentNode,this._formatting.Dda,b)):this.qIk(b))}tF(){this.mM.aEa||this.oMc()}pSa(){}J5a(){}lya(){Pc.a(8701081,307,Yc.OutlineElementReader.Bh(this.zc)||Rj.OutlineReader.ix(this.zc)||me.ParagraphReader.kh(this.zc)&&this.mM.aEa);let b=!1;this.eDb||(b=this.Y4b||!0);b||(this.aV+=1);this.Nwb++}jya(){this.Nwb--;
let b=!1;this.eDb||(b=this.Y4b||!0,this.Jn.I9i(this.pDc));b||--this.aV}hHa(b){Pc.a(8701082,307,Yc.OutlineElementReader.Bh(this.zc)||Rj.OutlineReader.ix(this.zc)||me.ParagraphReader.kh(this.zc)&&this.mM.aEa);Pc.a(8701083,307,!!b.listStyleType)}kya(){Pc.a(8701084,307,Yc.OutlineElementReader.Bh(this.zc)||me.ParagraphReader.kh(this.zc)&&this.mM.aEa);this.mM.aEa||Pc.a(8701085,307,this.zc.Fs(2))}R9(b){this.mM.R9(b)}P9(){this.mM.P9()}wbd(b){this.pDc.add(b)}k5(b){this.mM.k5(b)}Q9(){this.mM.Q9()}O9(b){this.mM.O9(b)}N9(){this.mM.N9()}qIk(b){this.xfc(!1);
(new vd.GraphIterator).jd(this.zc);b=ax.a.Yf.fJ(this.zc,this.qQc(b));Pc.a(8128534,307,b===this.zc.currentNode);Pc.a(8128535,307,me.ParagraphReader.Wb(b))}oMc(){Pc.a(8128536,307,me.ParagraphReader.kh(this.zc));gf.OutlineElementNavigator.Wd(this.zc)}reset(){this.Aub&&(super.reset(),this._formatting=this.Fof(!0))}M0e(b){this.xfc(!1);(new vd.GraphIterator).jd(this.zc);b=ax.a.Yf.fJ(this.zc,this.qQc(b));Pc.a(36577367,307,b===this.zc.currentNode);Pc.a(36577368,307,me.ParagraphReader.Wb(b));-1!==this._formatting.ww&&
this.il.lE(b,this._formatting.ww);this._formatting.lineSpacing&&this.Z3e.jD(b,this._formatting.lineSpacing);this._formatting.O5&&this.Z3e.Mge(b,this._formatting.O5);this.gLa=!0;this._formatting.paragraph=b}static Z9e(b,h){let u=0;switch(h){case 3:u=Of.a.Mv(b);break;case 7:u=kf.a.Sy(b,0);break;case 1:u=Of.a.d6e(b);break;case 5:u=Of.a.Mv(Of.a.T_f(b));break;default:r.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return u}}
Object(m.a)(bx,"TextOnlyBox4PasteSteward",ax.a,[]);class Fy extends bx{constructor(b,h,u,B,Q,ca,qa,Qa=null,rb=null){super(h,u,B,Q,ca,qa,Qa,rb);this.Pwc=!1;this.Bvb=[];this.whh=b;h={};h.textOnlyPasteFlags=b;r.ULS.sendTraceTag(509088282,307,50,G.c(h))}reset(){super.reset();this.Pwc=!1;this.Bvb.length=0;this.tnd=!1}fE(b){this.Pwc||(super.fE(b),this.Pwc=!0)}tF(){this.tnd?this.tnd=!1:this.vda(null)}vda(b){this.whh&2||super.vda(b)}lya(){}jya(){}hHa(){}kya(){}R9(){}P9(){}k5(b){this.Pwc||(super.k5(b),this.Pwc=
!0);this.Bvb.push(!1)}Q9(){this.whh&1&&this.vda(null);0<this.Bvb.length?this.Bvb.pop():Pc.a(509088281,307,!1)}O9(){var b=this.Bvb.length-1;0<=b?this.Bvb[b]?(b=Je.a.rw(this.zc.currentNode),this.ig.Ge(b,", ")):this.Bvb[b]=!0:Pc.a(509088280,307,!1);this.tnd=!0}N9(){this.tnd=!1}wbd(){}}Object(m.a)(Fy,"StrictTextOnlyBox4PasteSteward",bx,[]);class us{constructor(b,h,u,B){this.hMe=b;this.zK=h;this.Ef=u;this.wZ=B}create(b,h,u,B,Q=null,ca=null,qa=null,Qa=null){return 1===b?null!==Qa&&0!==Qa?new Fy(Qa,h,B,
this.hMe,this.zK,this.Ef,Q,ca,this.wZ):new bx(h,B,this.hMe,this.zK,this.Ef,Q,ca,this.wZ):new qz.Box4PasteSteward(h,u,B,this.hMe,this.zK,this.Ef,Q,ca,this.wZ,qa)}}Object(m.a)(us,"Box4PasteStewardFactory",null,[516]);var rz=c(189),ik=c(334),zp=c(1582);class fu{constructor(b,h,u){this.ez=null;this.Owb=0;this.zc=b;this.Gk=u}a3b(b){this.ez=b}get aEa(){return 0<this.Owb}R9(b){var h;Pc.a(7869459,307,!!this.ez);Pc.a(7869460,307,Yc.OutlineElementReader.Bh(this.zc)||Rj.OutlineReader.ix(this.zc));Pc.b(38563978,
307,50,"Table pasting started");this.ez.xfc(!0);const u=new vd.GraphIterator;u.jd(this.zc);let B=zp.a.Ftm[b.styleId];B||(v.AFrameworkApplication.le("gdea6103;0df65435"),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.iCf?(r.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),B=zp.a.ifn):B=zp.a.fPh);h=this.Gk.fRn(this.zc,b.rowCount,b.Ffb,B,b.tableLook,this.ez.qQc(b),b.iCf);b.njg&&
(Pc.b(573691298,3022,100,"Applying table border properties"),zp.a.Ish(b.njg,this.zc,!1,!0));b.GWd&&(Pc.b(573691299,3022,100,"Applying indentation properties"),zp.a.aDk(this.zc,b.GWd.spaceBefore,b.GWd.spaceAfter));b.PFd&&(Pc.b(573691328,3022,100,"Applying column widths"),zp.a.HCk(b.PFd,this.zc,Object(Na.a)(ik.TableNode,h),b.n4a));this.ez.rCd(u,!1);this.Owb++;Lf.ListItemReader.jg(u)&&this.ez.wbd(u.currentNode);Pc.a(7869461,307,Zi.TableReader.isTable(this.zc))}P9(){Pc.a(7869462,307,!!this.ez);Pc.a(7869463,
307,Im.a.isTableRow(this.zc));Pc.b(38563979,307,50,"Table pasting finished");this.zc.ot(14)&&zp.a.Dfj(this.zc.Cn);gf.OutlineElementNavigator.Wd(this.zc);this.Owb--}k5(b){Pc.a(7869464,307,!!this.ez);Pc.b(573691329,3022,100,"Table row pasting started");Zi.TableReader.isTable(this.zc)?qg.moveToFirstRow(this.zc):Im.a.isTableRow(this.zc)&&qg.moveToNextRow(this.zc);b.height&&(Pc.b(573691330,3022,100,"Applying table row height"),zp.a.SDk(this.zc,b.height));Pc.a(7869465,307,Im.a.isTableRow(this.zc))}Q9(){Pc.a(7869466,
307,!!this.ez);Pc.a(7869467,307,Jf.TableCellReader.isTableCell(this.zc));qg.returnToContainingRow(this.zc)}O9(b){Pc.a(7869468,307,!!this.ez);Pc.a(7869469,307,!this.ez.aV);Im.a.isTableRow(this.zc)?qg.moveToFirstColumn(this.zc):Jf.TableCellReader.isTableCell(this.zc)?qg.moveToNextColumn(this.zc):Pc.a(7869471,307,!1);if(this.zc.currentNode){Pc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Na.a)(rz.TableCellNode,this.zc.currentNode);Pc.a(50689760,307,!h&&16!==this.zc.currentNode.type||
!!h&&16===this.zc.currentNode.type);if(h){var u=new vd.GraphIterator;u.jd(this.zc);if(b.odc)Pc.b(573691332,3022,100,"Processing skipped cell"),zp.a.iHn(u,b);else{if(1<b.colSpan||1<b.rowSpan){const B=qg.returnToContainingTable(u);if(!B)return;B.setValue(Jc.a.complexTable,!0);u.jd(this.zc);Pc.b(573691333,3022,100,"Processing merged cell");zp.a.zGn(u,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}zp.a.YDk(this.zc,b.shadingColor);zp.a.NEk(this.zc,b.verticalAlignment);zp.a.vCk(this.zc,b.qke);zp.a.Ish(b.cka,
this.zc,!b.colSpan&&!b.rowSpan,!1);(new vd.GraphIterator).jd(this.zc);qg.forEachCell(u,b.rowSpan,b.colSpan,(B,Q,ca)=>{Pc.b(573691334,3022,100,"Setting ghost cell borders");zp.a.Vjj(B,b.cka,Q,ca,b.rowSpan,b.colSpan)});zp.a.PEk(this.zc,b.width,b.n4a);Pc.a(7869472,307,Rj.OutlineReader.ix(this.zc))}}}}N9(){Pc.a(7869473,307,!!this.ez);Pc.a(7869474,307,Yc.OutlineElementReader.Bh(this.zc)||Jf.TableCellReader.isTableCell(this.zc));qg.returnToCell(this.zc);Pc.a(7869475,307,0>=this.ez.aV);this.ez.a7e()}}Object(m.a)(fu,
"Box4TableSteward",null,[537,181]);class Et{constructor(b,h,u){this.ez=null;this.Owb=0;this.zc=b;this.Gk=u}a3b(b){this.ez=b}get aEa(){return 0<this.Owb}R9(){this.aEa&&(Pc.a(8787101,307,me.ParagraphReader.kh(this.zc)),gf.OutlineElementNavigator.Wd(this.zc));Pc.a(8701086,307,!!this.ez);Pc.a(8701087,307,Yc.OutlineElementReader.Bh(this.zc)||Rj.OutlineReader.ix(this.zc));this.Owb++}P9(){Pc.a(8701088,307,!!this.ez);gf.OutlineElementNavigator.Wd(this.zc);this.Owb--;if(this.aEa){this.ez.xfc(!0);const b=Et.Yf.fJ(this.zc);
Pc.a(8787102,307,b===this.zc.currentNode);Pc.a(8787103,307,me.ParagraphReader.kh(this.zc))}}k5(b){Pc.a(8701089,307,!!this.ez);this.ez.xfc(!0);const h=new vd.GraphIterator;h.jd(this.zc);this.ez.rCd(h,!1);Lf.ListItemReader.jg(h)&&this.ez.wbd(h.currentNode);b=Et.Yf.fJ(this.zc,this.ez.qQc(b));Pc.a(8701090,307,b===this.zc.currentNode);Pc.a(8701091,307,me.ParagraphReader.kh(this.zc))}Q9(){Pc.a(8701120,307,!!this.ez);Pc.a(8701121,307,me.ParagraphReader.kh(this.zc));gf.OutlineElementNavigator.Wd(this.zc)}O9(){Pc.a(8701122,
307,!!this.ez);Pc.a(8701123,307,me.ParagraphReader.kh(this.zc));Pc.a(8701124,307,!this.ez.aV);var b=this.zc.currentNode;me.ParagraphReader.textLength(b)&&(b=Je.a.rw(b),this.ez.ig.Ge(b,", "))}N9(){Pc.a(8701125,307,!!this.ez);Pc.a(8701126,307,me.ParagraphReader.kh(this.zc));Pc.a(8701127,307,0>=this.ez.aV);this.ez.a7e()}static get Yf(){return null!=Et.tDg?Et.tDg:Et.tDg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(m.a)(Et,"TextOnlyBox4TableSteward",null,[537,181]);class Ft{constructor(b,
h,u=!1,B=!1){this.zK=b;this.nA=h;this.Wck=u;this.cdk=B}create(b,h){return 1===b?new Et(h,this.zK,this.nA):new fu(h,this.zK,this.nA,this.Wck,this.cdk)}}Object(m.a)(Ft,"Box4TableStewardFactory",null,[515]);class Dr{create(){return new sk.a}}Object(m.a)(Dr,"Factory",null,[514]);class Ll{constructor(b){this.ga=b}ucn(b){if(4===b)b=Ob.a.vGa;else if(2===b)b=Ob.a.Aja;else if(1===b)b=Ob.a.gSb;else if(3===b)b=Ob.a.W0a;else return;this.ga.processAction(b,2)}rhb(){this.ga.processAction(Ob.a.rhb,2)}}Object(m.a)(Ll,
"SelectionCommands",null,[512]);var Rp=c(230),Rn=c(1102),sq=c(138),vs=c(638);class ho{constructor(){this.fYc=!1;this.U0o=v.AFrameworkApplication.K.kb("WordEditorVisiFontFileUri");this.W0o=v.AFrameworkApplication.K.kb("WordEditorVisiRtlFontFileUri");this.V0o=v.AFrameworkApplication.K.kb("WordEditorVisiPilcrowFontFileUri");this.R0o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnFontFileUri");this.T0o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnRtlFontFileUri")}XIo(){this.fYc=
!this.fYc}WIo(b){this.XIo();let h=b.getElementsByClassName("VisiFontStyle")[0],u=b.getElementsByClassName("VisiFontRtlStyle")[0],B=b.getElementsByClassName("VisiFontPilcrowStyle")[0],Q=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ca=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",kc.a.tv(h,""),b.appendChild(h));u||(u=document.createElement("Style"),u.className="VisiFontRtlStyle",kc.a.tv(u,""),b.appendChild(u));
B||(B=document.createElement("Style"),B.className="VisiFontPilcrowStyle",kc.a.tv(B,""),b.appendChild(B));Q||(Q=document.createElement("Style"),Q.className="VisiFontCarriageReturnStyle",kc.a.tv(Q,""),b.appendChild(Q));ca||(ca=document.createElement("Style"),ca.className="VisiFontCarriageReturnRtlStyle",kc.a.tv(ca,""),b.appendChild(ca));if(this.fYc)return r.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.$Fc(h)&&this.$Fc(u)&&this.$Fc(B)&&this.$Fc(Q)&&this.$Fc(ca);r.ULS.sendTraceTag(593294046,
324,50,"Formatting markers are removed");return this.Y5c(h)&&this.Y5c(u)&&this.Y5c(B)&&this.Y5c(Q)&&this.Y5c(ca)}$Fc(b){return""===kc.a.Ey(b)?("VisiFontStyle"===b.className?kc.a.tv(b,this.IPc("WordVisi_MSFontService",this.U0o)):"VisiFontRtlStyle"===b.className?kc.a.tv(b,this.IPc("WordVisiRtl_MSFontService",this.W0o)):"VisiFontPilcrowStyle"===b.className?kc.a.tv(b,this.IPc("WordVisiPilcrow_MSFontService",this.V0o)):"VisiFontCarriageReturnStyle"===b.className?kc.a.tv(b,this.IPc("WordVisiCarriageReturn_MSFontService",
this.R0o)):"VisiFontCarriageReturnRtlStyle"===b.className&&kc.a.tv(b,this.IPc("WordVisiCarriageReturnRtl_MSFontService",this.T0o)),!0):!1}Y5c(b){return""!==kc.a.Ey(b)?(kc.a.tv(b,""),!0):!1}IPc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(m.a)(ho,"VisiMarkersOperation",null,[510]);var Rs=c(449),hs=c(376);class Fv extends Rs.a{constructor(b,h){super(b,h);this.SDe=-1;this.yub=0;this.HAe=null;this.uYg=!1;
this.VBe=[];this.pod=!1;this.D6g=!0;this.vLe=this.Zld=null;this.preventDismissOnScroll=this.E$d=this.Nhc=!1;this.l8=null;this.wyd=!1;this.uSc=!0;this.Rs=!1;this.K_g=v.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Fv.tbh||(v.AFrameworkApplication.va.ra(Za.a.showFloatie,Ad.a.frame,dd.ActionManager.Lf),Fv.tbh=!0)}get S_h(){return this.uO}set S_h(b){this.uO=b}get Tyj(){return this.wyd}get FTc(){return this.uYg}set FTc(b){this.uYg=b;this.yub=0}get $A(){return!0}get cssClass(){return v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Lb.t9?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Rs}NTa(){for(let b of this.children)if(b.NTa())return!0;return!1}get p$(){return 9}xf(b){this.VBe[this.VBe.length]=b;super.xf(b)}Cm(){super.Cm();Le.c(this.Mc)&&this.QC();this.Mc=ig.a.jTa(this.Mc);this.gX(this.Mc);this.dirty=!1}kgc(b){3===b.hg||this.E$d||this.dismissFloatie(b);return!1}ngc(){return!1}lgc(b){3!==b.hg&&this.uSc&&!this.Nhc&&this.IVo(b);return!1}mgc(){return!1}igc(b){3===b.hg&&this.dismissFloatie(b);
return!1}jgc(b){void 0!==this.l8&&null!==this.l8||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}eD(){this.ohf();return!1}Y6d(){this.FTc=!0}IVo(b){if(b=qe.a.y6b(b.clientPoint,this.HAe)){if(this.FTc){if(!this.yub||b<this.yub)this.yub=b;b-=this.yub}b-=this.SDe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():Z.a.setOpacity(this.Mc,Math.max(h/255,0))}else this.FTc=!1,this.yub=0,Z.a.setOpacity(this.Mc,1)}YTo(b){let h=null;void 0!==this.Zld&&null!==this.Zld&&(h=this.Zld(b));
b=null;for(const u of this.VBe){let B=!this.Tyj&&u.uCi;if(!B&&void 0!==h&&null!==h)for(let Q=0;Q<h.length;Q++)if(u.id===h[Q]){B=!0;break}u.Mc.style.display=B?"none":"";u.v6b=!B;B||(b=u)}b&&(b.v6b=!1)}I8h(){const b=this.Mc.style.top,h=this.Mc.style.left;this.Mc.style.top="0px";this.Mc.style.left="0px";const u=this.DFb();this.Mc.style.top=b;this.Mc.style.left=h;return u}DFb(){const b=this.Mc.style.visibility,h=this.Mc.style.display;this.Mc.style.visibility="hidden";this.Mc.style.display="";const u=
Qd.a.getElementBounds(this.Mc);this.Mc.style.display=h;this.Mc.style.visibility=b;return u}h7i(b){3===b||this.Lle?(Sys.UI.DomElement.addCssClass(this.Mc,hs.a.LRb),this.wyd=!0):(Sys.UI.DomElement.removeCssClass(this.Mc,hs.a.LRb),this.wyd=!1);this.YTo(b)}M7a(b,h,u,B=!1){this.isVisible||(this.l8||!this.D6g&&this.preventDismissOnScroll||(this.D6g=!1,Qd.a.I3d("ShowLegacyFloatie",""),v.AFrameworkApplication.va.processAction(Za.a.showFloatie,2)),this.h7i(u),this.uSc=!0,this.yub=0,this.FTc=!1,!this.K_g||
void 0!==this.l8&&null!==this.l8?(this.pod=!1,this.pga(this,!1)):(this.pod=!0,this.pIk(this)),h=B?b:this.ACn(b,h),this.Mc.style.top=h.y.toString()+"px",this.Mc.style.left=h.x.toString()+"px",this.vu(),this.HAe=this.DFb(),this.SDe=qe.a.y6b(b,this.HAe),Z.a.setOpacity(this.Mc,1),this.Mc.style.zIndex=String(v.AFrameworkApplication.ua.sua),this.Mc.style.display="",this.Rs=!0)}ACn(b,h){const u=this.Tyj?30:17,B=this.I8h(),Q=kc.a.NGb(),ca=kc.a.ZX();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=B.height:3===h?(b.y-=
B.height,b.x-=B.width):2===h&&(b.x-=B.width);b.x+B.width>Q&&(b.x=Math.floor(Q-B.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-u:b.y+u;0>b.y&&(b.y=0);b.y+B.height>ca&&(b.y=ca-B.height);return b}BCn(b,h){const u=b.XMi;if(u){this.h7i(h);var B=this.I8h();this.l8=b;b=u.hqg-u.YNc>B.width;var Q=u.YNc+u.Fkf>B.width,ca=u.Z7b>B.height+17,qa=u.wIj-(u.Z7b+u.Bkf)>B.height+17;B=new Sys.UI.Point(u.YNc,u.Z7b);Q||b||(Q=!0,B.x=u.hqg);b=u.Ilb?u.gJf?qa?Q?2:0:Q?3:1:ca?Q?3:1:Q?2:0:u.gJf?qa?b?0:2:b?1:3:ca?b?1:3:b?0:2;if(3===
b||2===b)B.x=u.YNc+u.Fkf;if(2===b||0===b)B.y=u.Z7b+u.Bkf;this.M7a(B,b,h);this.uSc=!1;h=this.l8.cYe.Mc;void 0!==h&&null!==h&&(h.style.zIndex=String(v.AFrameworkApplication.ua.sua))}}c4(){let b=super.c4();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.TEc&&null!==this.TEc&&this.TEc.Gva(null);void 0!==this.l8&&null!==this.l8&&this.l8.S3();this.S3();this.K_g&&this.pod?this.Ctl(this):this.Yba(this,!1);this.pod=!1;this.SDe=-1;this.l8=null;this.Mc.style.display=
"none";this.Rs=!1;this.vLe&&this.vLe(b);return!0}ohf(){void 0!==this.l8&&null!==this.l8&&(this.l8.OZa=null,this.l8.S3(),this.l8=null,this.c4d.style.zIndex=String(v.AFrameworkApplication.ua.JCa),this.Mc.style.zIndex=String(v.AFrameworkApplication.ua.sua))}JTn(b){this.Zld=b}vUn(b){this.vLe=b}set $A(b){super.$A=b}}Fv.tbh=!1;Object(m.a)(Fv,"Floatie",Rs.a,[673,326,327]);class Gv{constructor(b,h){this.Av=this.dLa=null;this.nKi=b;this.Gej=h}get U_h(){return this.dLa}Xmo(b){this.dLa=b}DFb(){return this.Av.DFb()}C0(){return this.Av?
this.Av.isVisible:!1}Fvh(b){this.Xmo(b)}showFloatie(b,h){this.M7a(h.location,h.Qx,h.isRtl)}M7a(b,h,u){u=u?this.Gej:this.nKi;this.XLd();this.Av&&this.Av.M7a(b,u,h)}dismissFloatie(){this.Av&&this.Av.dismissFloatie()}XLd(){this.dLa&&!this.Av&&(this.Av=Object(Na.a)(Fv,this.dLa()))}LMd(){}}Object(m.a)(Gv,"AFloatieManager",null,[535]);class hv extends Gv{constructor(){super(1,3);this.Zwj=!1;this.uQh=""}M7a(b,h,u){u=u?this.Gej:this.nKi;this.XLd();this.Av&&(this.Av.isVisible&&this.Av.dismissFloatie(),this.Zwj||
this.Av.Bm(),this.Av.M7a(b,u,h,!0))}XLd(){this.U_h&&!this.Av&&(this.Av=this.dLa())}LMd(){if(this.Av&&this.Av.isVisible){const b=Object(Na.a)(qo.Control,this.Av.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.ax(b.wib(),1,null)}}jdg(b){this.uQh=b}b0n(b){b=b.Dof("Menu16",null);ah.a("renderIcon")&&b&&appChrome.api.renderIcon(hv.PZj,b.firstElementChild)}goc(b,h,u){if(this.Av){const B=this.Av.controls[this.uQh];B&&(hv.i_g||(this.b0n(B),hv.i_g=!0),B.Rd[Th.a.labelText]=b,B.Rd[Th.a.alt]=h,u&&B.behavior.Bm())}}}
hv.i_g=!1;hv.PZj="Designer_20";Object(m.a)(hv,"PasteFloatieManager",Gv,[]);var nw=c(1054);class Tr{constructor(){this.Md=null}get Xw(){return null}getTitle(){return null}l7h(){return null}reset(b){this.Md=b.node}gJa(b){b=Hq.d(this.Md,b);let h=null;if(!b||b.qh!==this.qh)return{returnValue:!1,aG:h};h=Object.assign(new nw.a,{TG:this.key,contentObject:b,title:this.getTitle(b),description:this.l7h(b)});return{returnValue:!0,aG:h}}}Object(m.a)(Tr,"BlobDetailsProvider",null,[335,336]);class qC extends Tr{constructor(){super()}get key(){return"EQUATION"}get qh(){return 11}get Xw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}
Object(m.a)(qC,"EquationDetailsProvider",Tr,[]);class Ss{constructor(){this.XXg=null}get key(){return"LINK"}get Xw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.XXg=ok.a.q9b(b.node)}gJa(b){let h=null;for(const u of this.XXg)if(u.cpBegin<=b&&b<u.cpEnd)return h=Object.assign(new nw.a,{TG:this.key,contentObject:u.hyperlink}),{returnValue:!0,aG:h};return{returnValue:!1,aG:h}}}Object(m.a)(Ss,"HyperlinkDetailsProvider",null,[335,336]);var Gy=c(1384),kt=c(907);class kA{constructor(){this.R1g=
!1}get key(){return"IFRAMENODE"}get Xw(){return this.R1g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}Hnc(b){let h=null;b=b?me.ParagraphReader.HPa(b.currentNode):null;if(!b)return{returnValue:!1,nna:h};h=Object.assign(new Gy.a,{TG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,nna:h}}sFb(b,h){b=b?Object(Na.a)(kt.a,b.contentObject):null;h=h?Object(Na.a)(kt.a,h.contentObject):null;let u="";h&&b.id===h.id||(this.R1g=b.A4a,u=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,
b.Xw,this.Xw));return u}}Object(m.a)(kA,"IFrameDetailsProvider",null,[534,336]);class lA extends Tr{constructor(){super()}get key(){return"IMAGE"}get qh(){return 5}reset(b,h){super.reset(b,h);this.l7j=!Ge.SelectionEditor.Il(h)}get Xw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Dd.ImageReader.PX(b.properties)}l7h(b){var h;b=Dd.ImageReader.JPa(b.properties);return null!==(h=Fb.App.instance)&&void 0!==h&&h.P0d&&this.l7j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,
b):b}}Object(m.a)(lA,"ImageDetailsProvider",Tr,[]);class tq{get key(){return"IMAGENODE"}get Xw(){return Box4Intl.Box4Strings.l_ImageContentTitle}Hnc(b){let h=null;if(!b||!Dd.ImageReader.Jt(b.currentNode))return{returnValue:!1,nna:h};h=Object.assign(new Gy.a,{TG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,nna:h}}sFb(b,h){b=b.contentObject;const u=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let B="";h&&b.id===h.contentObject.id||(B=String.format(u,
Dd.ImageReader.PX(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return B}}Object(m.a)(tq,"ImageNodeDetailsProvider",null,[534,336]);let tn,ow;class iv{constructor(b,h){this.SSg=null;this.zn=h;this.mOe=b;this.key=iv.keys.J(b);this.Xw=iv.k4k.J(b)}reset(b){this.SSg=this.zn.s4(b.node)}gJa(b){var h=iv.CDl(this.SSg||[],u=>this.fIm(b,u));h=this.v8k(h);return{returnValue:!!h,aG:h}}fIm(b,h){return h.Ac<=b&&b<h.end&&(!h.errorDetails||this.mOe===h.errorDetails.proofingType)}v8k(b){return b?Object.assign(new nw.a,
{TG:this.key,contentObject:b.errorDetails,description:this.tib()}):null}tib(){return Jp.a.OQa()?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static CDl(b,h){for(const u of b)if(h(u))return u;return null}}iv.keys=(ow=new Vd.a,ow.add(1,"SPELLINGERROR"),ow.add(2,"GRAMMATICALERROR"),ow.add(3,"ADVANCEDERROR"),ow);iv.k4k=(tn=new Vd.a,tn.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),tn.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),tn.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),
tn);Object(m.a)(iv,"ProofingDetailsProvider",null,[335,336]);class wB{constructor(){this.tableNode=null;this.NFd=this.fee=this.columns=this.rows=0}}Object(m.a)(wB,"TableInfo",null,[]);class kh{get key(){return"TABLE"}get Xw(){return Box4Intl.Box4Strings.l_TableContentTitle}Hnc(b){var h=null;if(!Jf.TableCellReader.isTableCell(b))return{returnValue:!1,nna:h};h=new vd.GraphIterator;h.jd(b);b=new wB;b.fee=Im.a.Es(h)+1;b.NFd=Lu.a(h)+1;qg.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=Zi.TableReader.eh(b.tableNode);
b.rows=Zi.TableReader.eg(b.tableNode);h=Object.assign(new Gy.a,{TG:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,nna:h}}sFb(b,h){b=b.contentObject;const u=new Ck.a;h||u.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.NFd===b.NFd||u.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.NFd));h&&h.contentObject.fee===b.fee||u.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,
b.fee));return u.toArray().join(" ")}}Object(m.a)(kh,"TableDetailsProvider",null,[534,336]);class Tx{constructor(b,h){this.iLa=b;this.zn=h}get xSb(){return null!=this.KHg?this.KHg:this.KHg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}B5f(){this.iLa.execute(b=>{b.t5(new Ss);this.xSb||(b.t5(new iv(1,this.zn)),b.t5(new iv(2,this.zn)));b.t5(new iv(3,this.zn));b.t5(new qC);b.t5(new lA);b.Bic(new kh);b.Bic(new tq);b.Bic(new kA)})}}Object(m.a)(Tx,
"AccessibilityActor",null,[]);class dq{constructor(b,h,u){this.Ytn=(B,Q,ca)=>{if(1===ca)return 32;this.jVj().Yfg();return 32};this.tZa=b;this.jVj=u}Tb(){this.tZa.fb(Ob.a.SXi,vc.a.view,this.Ytn,1028)}}Object(m.a)(dq,"AutoCorrectActor",null,[]);var ws=c(1976);class an{constructor(){this.D3d=!0}hya(){}L5a(){}a3b(){}BWf(){}cge(){}get uhc(){return!1}get Mmb(){return 0}get pMi(){return!1}get yX(){return yb.a.nil}}Object(m.a)(an,"TextOnlyBox4ImageSteward",null,[532]);class Cv{constructor(b,h,u,B,Q,ca,qa=
!1){this.nP=b;this.taskManager=h;this.Qg=u;this.qvm=B;this.notificationBar=Q;this.Zb=ca;this.n1m=qa}create(b,h,u,B){return 1===b?new an:new ws.a(h,this.nP,this.taskManager,this.Qg,this.Zb,this.qvm,this.notificationBar,this.n1m,u,B)}}Object(m.a)(Cv,"Box4ImageStewardFactory",null,[509]);var Fo=c(37);class tB{constructor(b){this.u_d=b}mPm(b){if(!b||!b.IB||1>b.IB.count)return!1;const h=[Fo.a.kNh,Fo.a.jNh];return!!this.HPd(b.IB,1,u=>this.TGd(u,h))}Svi(b){return!b||!b.IB||1>b.IB.count?!1:!!this.HPd(b.IB,
1,h=>this.TGd(h,[Fo.a.yG]))}lMm(b){return!b||!b.IB||1>b.IB.count?!1:!!this.HPd(b.IB,2,h=>this.TGd(h,[Fo.a.cZc]))}kh(b){return!b||!b.IB||1>b.IB.count?!1:!!this.HPd(b.IB,1,h=>this.TGd(h,[Fo.a.aja]))}kZd(b){if(!b||!b.IB)return!1;b=b.IB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).CGk)return!1;return!0}lwl(b,h){return this.Svi(h)||this.lMm(h)?"":b}HPd(b,h,u){if(b&&0<b.count)for(let B=b.count-1;0<=B;--B){if(u(b.J(B)))return b.J(B);if(b.count-B>=h)break}return null}TGd(b,h){b=b&&b.Sni?b.Sni.split(" "):
null;if(!b)return!1;for(const u of h)if(0<=Array.indexOf(b,u))return!0;return!1}}Object(m.a)(tB,"Box4PasteStewardUtils",null,[507]);var Yt=c(731);class Ox{constructor(){this.Snc=0;this.wec=Array(9)}}Object(m.a)(Ox,"FullListMetadata",null,[]);class er{constructor(b,h,u){this.Snc=this.level=0;this.lYh=null;this.nhc=!1;this.level=b;this.Zoe=h;this.ivn=u}}Object(m.a)(er,"ListItemMetadata",null,[]);var Ls=c(1587);class iA{constructor(){this.level=0;this.tagName="UL";this.smb=null;this.ignore=!1;this.Ogn=
0;this.listStyle="BulletListStyle1";this.Vlb=new Ls.a;this.font=this.levelText=""}}Object(m.a)(iA,"ListLevelMetadata",null,[]);class mz{constructor(){}}Object(m.a)(mz,"LevelLists",null,[]);class uB{constructor(b){this.nodes=b;this.xOa=0;this.lists={};this.Vlb=[];this.pEi=null;this.Zel=[];this.Zel[0]=new mz}}Object(m.a)(uB,"WordConverterArguments",null,[]);var Mr=c(594);class Nf{}Nf.Sfl="data-ccp-timestamp";Nf.mJd="data-clipservice-ccpid";Nf.Vfl="data-shapeids";Nf.jkm="docs-internal-guid-";Nf.Ptn=
"SCXO";Nf.aDn="SCXP";Nf.a3o="SCXW";Nf.mdn="MsoListParagraphCxSpFirst";Nf.ndn="MsoListParagraphCxSpLast";Nf.scf="data-pkey";Nf.tcf="data-clipservice-type";Nf.qcf="data-clipservice-count";Nf.rcf="data-clipservice-dc";Nf.vKc="data-clipservice-client";Nf.ucf="data-clipservice-version";Object(m.a)(Nf,"HtmlContentMetadataConstants",null,[]);class xq{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(m.a)(xq,"AbsolutePosition",null,[]);var fr=c(862);class gn{constructor(b,h,u="",B=0){this.zx=
!1;this.KXg=this.LXg=null;let Q=!1;gn.xLm(b)&&(Q=!0,this.LXg=b);gn.PLm(h)&&(this.KXg=h);this.h4j=u;this.RUj=B;this.zx=Q&&this.UVd?!0:!1}get isValid(){return this.zx}get Vni(){return this.LXg}get UVd(){return this.KXg}get Sni(){return this.h4j}get CGk(){return this.RUj}static xLm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static PLm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(m.a)(gn,"HtmlElementInfo",null,[]);class Vw{constructor(b){this.next=null;this.data=b}}Object(m.a)(Vw,"StackNode",
null,[]);class Dv{constructor(){this.Sq=null;this.Xj=0}get count(){return this.Xj}get isEmpty(){return!this.count||!this.Sq}push(b){b=new Vw(b);b.next=this.Sq;this.Sq=b;this.Xj=this.count+1}RY(){return this.count&&this.Sq?this.Sq.data:null}pop(){if(!this.count||!this.Sq)return null;const b=this.Sq;this.Sq=b.next;this.Xj=this.count-1;return b.data}clear(){this.Sq=null;this.Xj=0}toArray(){const b=Array(this.count);let h=this.Sq;for(let u=this.count-1;0<=u&&h;u--)b[u]=h.data,h=h.next;return b}}Object(m.a)(Dv,
"Stack",null,[]);class Uj{constructor(b){this.Wi=b;this.Yuc=this.wrd=null;this.Djd=!1}get VId(){return this.Yuc.RY()}reset(){this.Wi.reset();this.wrd=new Dv;this.Yuc=new Dv;this.Yuc.push(this.Wi.FKc);this.Djd=!1}Q5d(){this.Djd=!1}VJ(b){this.Djd||(this.wrd.push(null),this.Djd=!0);this.wrd.push(b)}onClose(){for(;;){const b=this.wrd.pop();if(!b)break;b()}}Tjj(){return!1}hgn(){this.hv(()=>!0)}hv(b){const h=this.VId.clone();return b(h)?(this.Yuc.push(h),this.Wi.cHa(h),this.VJ(Object(z.a)(this,this.amn,
"onFormattingEnd")),!0):!1}Mwf(b){return b.style?this.hv(h=>this.Tjj(h,b))?1:2:2}amn(){this.Yuc.pop();this.Wi.cHa(this.VId)}wda(){}K5d(){return 2}wTf(){return 2}xTf(){return 2}CTf(){return 2}RTf(){return 3}TTf(){}P5d(){return 2}UTf(){}VTf(){}WTf(){return 2}S5d(){return 2}T5d(){return 2}jUf(){return 2}U5d(){}lUf(){return 2}V5d(){return 2}W5d(){return 2}Z5d(){return 2}$5d(){return 2}yUf(){}zUf(){return 2}g6d(){return 2}h6d(){return 2}k6d(){return 2}l6d(){return 2}n6d(){return 2}o6d(){return 2}q6d(){return 2}s6d(){return 2}$Uf(){return 2}z6d(){return 2}gVf(){return 2}iVf(){}jVf(){return 2}C6d(){return 2}D6d(){return 2}E6d(){return 2}F6d(){return 2}G6d(){return 2}H6d(){return 2}qVf(){return 3}I6d(){}xVf(){return 2}J6d(){return 2}zVf(){return 3}M6d(){}GVf(){}N6d(){return 2}MVf(){return 3}P6d(){return 2}R6d(){return 2}T6d(){return 2}U6d(){return 2}XVf(){}aWf(){return 3}W6d(){return 2}onMenuOpen(){return 2}fWf(){}oWf(){return 2}pWf(){return 2}rWf(){return 3}h7d(){return 2}tWf(){return 2}i7d(){return 2}m7d(){return 2}AWf(){}t7d(){return 2}LWf(){return 2}A7d(){return 2}B7d(){return 2}cXf(){return 3}jXf(){return 2}J7d(){return 2}K7d(){return 2}M7d(){return 2}N7d(){return 2}nXf(){return 3}O7d(){return 2}R7d(){return 2}T7d(){return 2}qXf(){return 2}M1c(){return 2}tXf(){return 2}uXf(){return 2}W7d(){return 2}vXf(){return 2}yXf(){return 3}a8d(){return 2}b8d(){return 2}c8d(){return 2}d8d(){return 2}h8d(){return 2}e8d(){return 2}static Hha(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static Zdi(b){if(!b||""===b)return-1;const h=F.a.Zg(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static Qai(b){b=Uj.Zdi(b);return-1===b?0:0>b?(r.ULS.sendTraceTag(508925786,307,50,"Negative margin in px or pt"),0):b}static rcm(b){return Uj.Zdi(b)}static wdi(b){return b&&
""!==b?Uj.Hha(b):null}static hE(b){let h=null,u=null,B=null,Q=null;b&&b.mf&&(h=Uj.nR(b.mf,"id"),u=Uj.nR(b.mf,"lang"),B=b.mf.tagName,b.sCk&&(Q=Object.assign(new xq,{x:Uj.Hha(b.mf.style.left),y:Uj.Hha(b.mf.style.top),left:Uj.wdi(b.mf.style.left),top:Uj.wdi(b.mf.style.top)})),void 0===h&&(h=""),void 0===u&&(u=""));return new fr.a(new gn(h,B),b.IB,null,u,Q)}static nR(b,h){return b[h]}}Object(m.a)(Uj,"AHtmlTranslator",null,[184]);class rj extends fr.a{constructor(b,h,u,B=0,Q=0,ca=null){super(ca?ca.V9:
null,ca?ca.IB:null,ca?ca.uya:null,ca?ca.cultureName:null,ca?ca.HCa:null);this.width=B;this.height=Q}}Object(m.a)(rj,"AugmentationSemanticArgs",fr.a,[]);class wn{constructor(b,h,u,B,Q,ca,qa){this.ccpId=b;this.pKey=h;this.type=u;this.count=B;this.dc=Q;this.client=ca;this.version=qa}}Object(m.a)(wn,"ClipServiceArgs",null,[]);var Ql;(Ql||(Ql={})).Chart="chart";Object(m.b)("ClipServiceDataType",Ql);var xt;(xt||(xt={})).ExcelOnline="XLO";Object(m.b)("ClipServiceClientApp",xt);class Fp{constructor(){this.stop=
this.color=null}}Object(m.a)(Fp,"ColorStopPair",null,[]);var Lq=c(1982);class Ww{constructor(){this.direction=null;this.sIc=new Ls.a}Nli(){return!!this.direction&&0<this.direction.length}}Object(m.a)(Ww,"LinearGradient",null,[]);class pC{constructor(){this.Nbc=!1}}Object(m.a)(pC,"HtmlTranslatorContext",null,[]);var pw=c(1856);class Ux{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(m.a)(Ux,"IndentationProperties",null,[]);var $i=c(1390);class gw extends fr.a{constructor(b,h,u,B,Q=null,
ca=0,qa=null,Qa=null,rb=!1,Lb=!1,Yb=69905,gc=null){super(gc?gc.V9:null,gc?gc.IB:null,gc?gc.uya:null,gc?gc.cultureName:null,gc?gc.HCa:null);this.colSpan=b;this.rowSpan=h;this.width=u;this.odc=Lb;this.height=B;this.n4a=rb;this.shadingColor=Q;this.verticalAlignment=ca;this.cka=qa;this.qke=Qa;this.a8=Yb}}Object(m.a)(gw,"TableCellSemanticArgs",fr.a,[]);class yq extends fr.a{constructor(b,h=null){super(h?h.V9:null,h?h.IB:null,h?h.uya:null,h?h.cultureName:null,h?h.HCa:null);this.height=b}}Object(m.a)(yq,
"TableRowSemanticArgs",fr.a,[]);class bl extends fr.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb=null,Yb=-1,gc=null){super(gc?gc.V9:null,gc?gc.IB:null,gc?gc.uya:null,gc?gc.cultureName:null,gc?gc.HCa:null);this.PFd=null;this.rowCount=b;this.Ffb=h;this.width=u;if(Q)for(this.PFd=Array(Q.length),b=0;b<Q.length;++b)this.PFd[b]=Q[b];this.iCf=ca;this.njg=Qa;this.yGm=qa;this.n4a=B;this.GWd=rb;this.styleId=Lb;this.tableLook=Yb}}Object(m.a)(bl,"TableSemanticArgs",fr.a,[]);var lo=c(1405);let bv;class tl extends Uj{get SKm(){if(null!=
this.SBg)var b=this.SBg;else{var h;v.AFrameworkApplication.le("FontFamilyFix;FontFamilyFixCf");b=this.SBg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",!1)}return b}constructor(b,h,u=new pC,B=null){super(b);this.settings=h;this.context=u;this.wZc=B;this.pwb=null;this.m9j=mb.a.Z5("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,
"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Qio=new Set(["DIV","P"])}get VFi(){return this.m9j}xai(b,h){var u;if((u=b.style?b.style.listStyleType:"")&&""!==u&&(u=this.VFi[F.a.Zg(u)])||(u=Uj.nR(b,"type"))&&""!==u&&(u=this.VFi[u]))return u;if((u=b.tagName.toLowerCase())&&("ol"===u||"ul"===u)&&(b=b.className))if("ul"===u)switch(b=tl.fUd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;
case "BulletListStyle3":return 5}else if("ol"===u)switch(b=tl.fUd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}qai(b){let h=-1,u=b.tagName.toLowerCase();if("ol"===u||"ul"===u){b=kc.a.s8h(b,"li");if(!b)return h;u="li"}if("li"===u){h=(h=this.qPd(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=kc.a.s8h(b,"p"))return tl.a1l(b)-1}return h}qPd(b,
h,u){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?u:b}Pnn(){this.pwb.pop();this.Wi.jya()}VRc(b,h){this.hv(Q=>Q.bea(0,0));const u=this.xai(b.mf,h?6:2);let B=1;h&&(B=this.qPd(b.mf,"start",1));h=!1;h=b.mf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.mf.removeAttribute("data-pasteFromRc");(Z.a.I4||Z.a.lj)&&tl.rFd(b.mf);b=new $i.a(u,B,Uj.hE(b),0,-1,h);this.pwb.push(b);this.Wi.lya(b);this.VJ(Object(z.a)(this,this.Pnn,"onListElementClose"));return 1}Scl(b,h,u){return(h=h.getAttribute(u))?
b.Xaf(h):!1}reset(){super.reset();this.pwb=new Dv}static get KWc(){if(null!=tl.YBg)var b=tl.YBg;else{var h;v.AFrameworkApplication.le("ghdeg324;j91ib322");b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isPastedHtmlRenderingInIframeEnabled",!1);b=tl.YBg=b}return b}Tjj(b,h){var u,B,Q,ca;let qa=!1;try{var Qa=h.getAttribute("xml:lang")||Uj.nR(h,"lang")}catch(Yb){Qa=null}Qa&&""!==Qa&&(qa=b.wcg(Qa)||qa);(Qa=Uj.nR(h,"dir"))&&(qa=b.Lkc(Qa)||
qa);if(this.settings.Spo(this.context)&&h.getAttribute)for(Qa=0;Qa<tl.Ruj.length;Qa++)qa=this.Scl(b,h,tl.Ruj[Qa])||qa;Qa=h.style;var rb=0;lo.a.bRa&&(rb=window.performance.now());const Lb=tl.KWc?getComputedStyle(h):null;lo.a.bRa&&(lo.a.Ile+=window.performance.now()-rb,lo.a.c5d+=1);if(Qa){if(Qa.fontWeight){rb=F.a.ZA(Qa.fontWeight);const Yb=parseInt(rb);isNaN(Yb)?"BOLD"===rb?qa=b.EL(!0)||qa:"NORMAL"===rb&&(qa=b.EL(!1)||qa):qa=600<=Yb?b.EL(!0)||qa:b.EL(!1)||qa}this.settings.yoj&&Qa.fontSize&&(rb=null!==
(u=null===Lb||void 0===Lb?void 0:Lb.fontSize)&&void 0!==u?u:Qa.fontSize,u=Uj.rcm(rb),0<u&&(qa=b.Ufe(Math.floor(2*u))||qa));(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.Qio.has(h.tagName)&&(B=Uj.Qai(null!==(Q=null===Lb||void 0===Lb?void 0:Lb.marginTop)&&void 0!==Q?Q:Qa.marginTop),Q=Uj.Qai(null!==(ca=null===Lb||void 0===Lb?void 0:Lb.marginBottom)&&void 0!==ca?ca:Qa.marginBottom),qa=b.bea(B,Q)||
qa);this.settings.Wpo(this.context)&&(this.settings.Coj&&h.getAttribute?(ca=h.getAttribute("data-indent"))&&0<ca.length&&(ca=kf.a.Ki(parseInt(ca),0)+"px",qa=b.Vge(ca)||qa):Qa.textIndent&&(qa=b.Vge(Qa.textIndent)||qa));this.settings.Rpo(this.context)&&Qa.marginLeft&&(this.settings.Coj&&h.getAttribute?(ca=h.getAttribute("data-margin"))&&0<ca.length&&(qa=b.Lja(Qa.marginLeft)||qa):"TABLE"!==h.tagName&&(qa=b.Lja(Qa.marginLeft)||qa));if(this.settings.Upo(this.context)&&(ca=h.getAttribute("style"))&&""!==
ca)for(ca=ca.split(";"),Q=0;Q<ca.length;Q++)B=ca[Q].trim(),B.startsWith("tab-stops")&&(qa=b.odg(B.replace("tab-stops:",""))||qa);this.settings.Qpo(this.context)&&Qa.lineHeight&&(qa=b.jD(Qa.lineHeight)||qa);this.settings.Npo&&(ca=Qa.textTransform?F.a.Zg(Qa.textTransform):null,Q=Qa.fontVariantCaps?F.a.Zg(Qa.fontVariantCaps):null,B=Qa.fontVariant?F.a.Zg(Qa.fontVariant):null,"uppercase"===ca?qa=b.Z8c("uppercase")||qa:"small-caps"===Q||B&&0<=B.indexOf("small-caps")?qa=b.Z8c("small-caps")||qa:this.settings.dSk&&
"none"===ca&&(qa=b.Z8c("none")||qa));this.settings.Vpo(this.context)&&Qa.textAlign&&(qa=b.ZPb(F.a.Zg(Qa.textAlign))||qa);Qa.fontStyle&&(ca=F.a.ZA(Qa.fontStyle),"ITALIC"===ca||"OBLIQUE"===ca?qa=b.qpb(!0)||qa:"NORMAL"===ca&&(qa=b.qpb(!1)||qa));ca=tl.qfm(h);if(Qa.textDecoration||ca)Q=F.a.Zg(Qa.textDecoration||""),ca=F.a.Zg(ca||""),h.parentNode&&h.parentNode.tagName&&"a"===F.a.Zg(h.parentNode.tagName)?(B=(h.querySelector(".TextRun")||h).className)&&-1<B.indexOf("Underlined")&&(qa=b.H5(!0)||qa):Qa.Tqp||
tl.isUnderline(Q)||tl.isUnderline(ca)?qa=b.H5(!0)||qa:this.settings.Ipj&&(qa=b.H5(!1)||qa),Qa.Sqp||tl.eyi(Q)||tl.eyi(ca)?qa=b.Oja(!0)||qa:this.settings.Ipj&&(qa=b.Oja(!1)||qa);if(Qa.verticalAlign){ca=F.a.ZA(Qa.verticalAlign);Q=this.KNn(ca);if("SUB"===ca||this.settings.Boj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>Q&&this.settings.fpj)qa=b.pIa(!0)||qa;else if("SUPER"===ca||this.settings.Boj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<Q&&this.settings.fpj)qa=
b.jra(!0)||qa;this.settings.yoj&&("SUB"===ca||"SUPER"===ca)&&h.getAttribute&&(ca=parseFloat(h.getAttribute("data-fontsize")),isNaN(ca)||(qa=b.Ufe(Math.floor(2*ca))||qa))}ca=!1;v.AFrameworkApplication.K&&(ca=v.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.Ppo&&Qa.fontFamily&&(this.settings.Ypo&&h.getAttribute?(Q=h.getAttribute("data-usefontface"))&&"true"===Q&&(ca&&r.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),qa=this.Rjj(b,Qa.fontFamily,qa)):qa=this.Rjj(b,
Qa.fontFamily,qa));Q=null;this.settings.Opo&&Qa.color&&(Q=Lq.a.nva(Qa.color));B=!!Q;this.settings.Xpo(this.context)&&h.getAttribute&&(Q=h.getAttribute("data-scheme-color"),Q=null!==Q?Q:"",B=""!==Q||!this.context.Nbc||tl.RTm(h));B&&(qa=b.Xv(Q)||qa);this.settings.Lpo&&Qa.backgroundColor&&(h.tagName&&tl.iFo.contains(F.a.ZA(h.tagName))||(qa=b.oza(Lq.a.nva(Qa.backgroundColor))||qa));if(this.settings.Mpo&&Qa.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Qa=tl.dim(Qa.backgroundImage))&&
0<Qa.sIc.count){Q=Qa.sIc.J(0).color;B=!0;for(u=0;u<Qa.sIc.count&&(B=B&&Q===Qa.sIc.J(u).color,B);u++);B&&(ca&&r.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),qa=b.oza(Lq.a.nva(Q))||qa)}}this.settings.Aoj(this.context)&&h.getAttribute&&(Qa=h.getAttribute("data-ccp-props"))&&(qa=b.y$(Qa)||qa);h.getAttribute&&((Qa=h.getAttribute("data-ccp-charstyle"))&&this.settings.Opb&&(qa=b.Afe(Qa)||qa),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.Opb&&(qa=b.Dge(h)||qa));return qa}Sro(b){if(this.settings.Tro)for(b=
b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.ZA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.ZA(b.tagName))break;b=b.parentNode}return!1}Rjj(b,h,u){if(this.SKm){h=tl.$Kl(h);let Q=!1,ca=0;if(!h)return u;for(var B of h){if(Q=b.OTa(B,this.settings.ovj))break;ca++}1<h.length&&(Q?r.ULS.sendTraceTag(508889217,307,50,"Secondary font matched from font-family at : {0} out of {1}",ca+1,h.length):r.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",
h.length));return Q||u}B=tl.M8h(h);return b.OTa(B,this.settings.ovj)||u}KNn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}wda(b,h){"\u200b"===b&&(b="\u00a0");h&&h.mf&&this.Sro(h.mf)&&(b="");this.Wi.wda(b,Uj.hE(h))}K5d(b){const h=Uj.nR(b.mf,"href");return h&&""!==h?(this.Wi.kSa(h,Uj.hE(b)),this.VJ(Object(z.a)(this.Wi,this.Wi.jSa,"onAnchorEnd")),1):2}P5d(){return this.hv(b=>b.EL(!0))?1:2}S5d(){return this.hv(b=>b.Hwf())?1:2}T5d(b){this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,
this.Wi.tF,"onParagraphEnd"));return 1}U5d(b){this.Wi.vda(Uj.hE(b))}V5d(b){this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}Z5d(){return this.hv(b=>b.qpb(!0))?1:2}W5d(b){this.hv(h=>h.ZPb("center"));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}$5d(){return this.hv(b=>b.OTa("consolas"))?1:2}h6d(){return this.hv(b=>b.Oja(!0))?1:2}g6d(b){return this.VRc(b,!1)}k6d(){return this.hv(b=>b.qpb(!0))?1:2}l6d(b){return this.VRc(b,
!1)}n6d(b){var h=b.mf.getAttribute("data-render-src");const u=b.mf.getAttribute("data-render-method");if(h&&""!==h&&u&&""!==u){const qa=b.mf.getAttribute("data-render-fallback");let Qa=0,rb=0;if(b.mf.currentStyle){var B=b.mf.currentStyle.width,Q=b.mf.currentStyle.height;B&&-1!==B.indexOf("px")&&(B=parseInt(F.a.substring(B,0,B.indexOf("px"))),isNaN(B)||(Qa=B));Q&&-1!==Q.indexOf("px")&&(Q=parseInt(F.a.substring(Q,0,Q.indexOf("px"))),isNaN(Q)||(rb=Q))}b=new rj(h,u,qa,Qa,rb,Uj.hE(b));this.Wi.L5a(b);return 2}(Z.a.I4||
Z.a.lj)&&(h=b.mf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&tl.rFd(b.mf);const ca=b.mf.getAttribute("align");this.hv(qa=>qa.ZPb(ca));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}o6d(b){this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}q6d(b){this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}s6d(){return this.hv(b=>b.qpb(!0))?1:2}z6d(b){return this.hv(h=>{var u=tl.M8h(b.mf.getAttribute("face"));
u=h.OTa(u);h=h.Xv(Lq.a.nva(b.mf.getAttribute("color")));return u||h})?1:2}C6d(b){this.hv(h=>this.settings.Opb?h.spb(1):h.upb(1));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}D6d(b){this.hv(h=>this.settings.Opb?h.spb(2):h.upb(2));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}E6d(b){this.hv(h=>this.settings.Opb?h.spb(3):h.upb(3));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}F6d(b){this.hv(h=>
this.settings.Opb?h.spb(4):h.upb(4));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}G6d(b){this.hv(h=>this.settings.Opb?h.spb(5):h.upb(5));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}H6d(b){this.hv(h=>this.settings.Opb?h.spb(6):h.upb(6));this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}I6d(b){this.Wi.vda(Uj.hE(b))}M6d(b){var h=b.mf;const u=h.src,B=h.alt,Q=h.Yjp,ca=h.getAttribute("data-external-content-url");
let qa=0,Qa=0;h.style&&(qa=Uj.Hha(h.style.width),Qa=Uj.Hha(h.style.height));qa&&Qa||(qa=h.width,Qa=h.height);let rb=0,Lb=0;b.mf.currentStyle&&(qa||Qa||(qa=Uj.Hha(b.mf.currentStyle.width),Qa=Uj.Hha(b.mf.currentStyle.height)),rb=Uj.Hha(b.mf.currentStyle.maxWidth),Lb=Uj.Hha(b.mf.currentStyle.maxHeight));let Yb=null;const gc=h.getAttribute(Nf.mJd);if(gc&&(r.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Fc=
h.getAttribute(Nf.scf),Sc=h.getAttribute(Nf.tcf),ld=h.getAttribute(Nf.qcf),Hd=h.getAttribute(Nf.rcf),Ie=h.getAttribute(Nf.vKc);h=h.getAttribute(Nf.ucf);Fc&&Hd&&(Yb=new wn(gc,Fc,Sc,ld,Hd,Ie,h))}b=new pw.a(u,B,qa,Qa,Uj.hE(b),rb,Lb,Q,null,ca,Yb);this.Wi.hya(b)}J6d(){return this.hv(b=>b.qpb(!0))?1:2}N6d(){return this.hv(b=>b.H5(!0))?1:2}P6d(){return this.hv(b=>b.OTa("consolas"))?1:2}R6d(b){this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}T6d(b){this.Wi.fE(Uj.hE(b));
this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}U6d(b){let h;const u=this.xai(b.mf,0);let B=this.qPd(b.mf,"value",0);0<this.pwb.count?h=this.pwb.RY():(h=new $i.a(2,1,Uj.hE(b)),B||(B=1));var Q=tl.m1l(b.mf,$i.a.RBj);3!==Q&&(h.Zr=Q);Q=h.listLevel;let ca=h.listId;this.settings.zoj?(Q=this.qai(b.mf),Q=0>Q&&0>h.listLevel&&0<this.pwb.count?h.listLevel=this.pwb.count-1:h.listLevel=0<=Q?Q:h.listLevel,this.wZc&&this.wZc.b<Q&&(this.wZc.b=Q)):0>Q&&(Q=h.listLevel=this.qai(b.mf));1>ca&&(ca=h.listId=
this.qPd(b.mf,$i.a.nZc,0));b.mf.getAttribute($i.a.P1d)&&(h.levelText=b.mf.getAttribute($i.a.P1d));var qa=b.mf.getAttribute($i.a.UJf);qa&&(h.font=qa);qa=!1;v.AFrameworkApplication.K&&(qa=v.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(qa){var Qa=b.mf.getAttribute("data-charcodes");qa=[];if(Qa&&""!==Qa)if(-1<Qa.indexOf(",")){Qa=Qa.split(",");for(var rb=0;rb<Qa.length;rb++)qa.push(parseInt(Qa[rb]))}else qa.push(parseInt(Qa));if(qa&&0<qa.length){Qa=Array(qa.length);for(rb=0;rb<
qa.length;rb++)Qa[rb]=qa[rb];h.q6e=Qa}(qa=b.mf.getAttribute("data-buAutoNum"))&&0<qa.length&&(h.buAutoNum=parseInt(qa))}(Q=0<=Q&&0<ca)&&tl.rFd(b.mf);h.uDk(u,B,Q);h.TJf=this.N0l(b.mf);this.Wi.hHa(h.clone());this.VJ(Object(z.a)(this.Wi,this.Wi.kya,"onListItemEnd"));return 1}N0l(b){var h=b.getAttribute($i.a.EFi);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{r.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;
h=new Od.DictionaryPropertySet;for(const u in b)h.Amj(+u,b[u]);return h}onMenuOpen(b){return this.VRc(b,!1)}W6d(b){if(this.hv(h=>h.Akc(!0))){const h=b.mf.getAttribute("OuterHtml");this.Wi.pSa(h,Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.J5a,"onMathEnd"))}return 1}h7d(b){return this.VRc(b,!0)}i7d(b){this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}m7d(b){const h=b.mf.getAttribute("align");this.hv(B=>B.ZPb(h));const u=b.mf.parentNode;u&&u.tagName.toLowerCase().startsWith("li")&&
tl.rFd(b.mf,Z.a.I4||Z.a.lj);this.Wi.fE(Uj.hE(b));this.VJ(Object(z.a)(this.Wi,this.Wi.tF,"onParagraphEnd"));return 1}t7d(){this.hv(b=>b.OTa("consolas"));this.Wi.nnb();this.VJ(Object(z.a)(this.Wi,this.Wi.mnb,"onPreFormattedTextEnd"));return 1}A7d(){return this.hv(b=>b.Oja(!0))?1:2}B7d(){return this.hv(b=>b.OTa("consolas"))?1:2}J7d(){return this.hv(b=>b.zgg())?1:2}K7d(b){var h=b.mf.attributes.getNamedItem("style"),u="";h&&h.value&&(u=h.value);h=Lq.a.Dyn(u);if(0<h&&this.settings.vAm){for(u=0;u<h;u++)this.Wi.snb(Uj.hE(b));
return 3}return 2}M7d(){return this.hv(b=>b.Oja(!0))?1:2}N7d(){return this.hv(b=>b.EL(!0))?1:2}O7d(){return this.hv(b=>b.pIa(!0))?1:2}R7d(){return this.hv(b=>b.jra(!0))?1:2}T7d(b){this.hv(Yb=>Yb.JC()&&Yb.R8f());Lq.a.OUd(b.mf,this);const h=Lq.a.Oii(b.mf),u=Lq.a.Q4h(b.mf),B=Lq.a.xJ(b.mf),Q=Lq.a.jL(b.mf),ca=!parseInt(Uj.nR(b.mf,"border")),qa=Lq.a.rTm(b.mf);let Qa=-1,rb="";var Lb=-1;b.mf.attributes.hasOwnProperty("style")&&-1!==(Lb=b.mf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?
Qa=parseInt(b.mf.attributes.getNamedItem("style").value.substr(Lb+17)):b.mf.attributes.hasOwnProperty(Mr.a.nJd.toString())&&(Qa=parseInt(b.mf.attributes.getNamedItem(Mr.a.nJd.toString()).value));Lb=-1;b.mf.attributes.hasOwnProperty("class")&&-1!==(Lb=b.mf.attributes.getNamedItem("class").value.indexOf("Mso"))?rb=b.mf.attributes.getNamedItem("class").value.substr(Lb).split(" ")[0]:b.mf.attributes.hasOwnProperty(Mr.a.wKc.toString())&&(rb=b.mf.attributes.getNamedItem(Mr.a.wKc.toString()).value);this.Wi.R9(new bl(0,
0,h.value,h.wAi,null,ca,qa,u,new Ux(B.value,Q.value),rb,Qa,Uj.hE(b)));this.VJ(Object(z.a)(this.Wi,this.Wi.P9,"onTableEnd"));v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}M1c(b){const h=Lq.a.A9h(b.mf),u=Lq.a.Oii(b.mf);if(!u.value&&u.nZd&&(v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.o_i))return 3;let B=parseInt(Uj.nR(b.mf,"colSpan"));if(void 0===B||null===
B||""===B+"")B=u.value?1:0;let Q=parseInt(Uj.nR(b.mf,"rowSpan"));if(void 0===Q||null===Q||""===Q+"")Q=h.value?1:0;let ca=!1;b.mf.attributes.hasOwnProperty("style")&&(ca=-1!==b.mf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.mf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ca&&b.mf.attributes.hasOwnProperty("class")&&(ca=-1!==b.mf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let qa=69905;if(b.mf.attributes.hasOwnProperty(Mr.a.pcf.toString())){var Qa=
parseInt(b.mf.attributes.getNamedItem(Mr.a.pcf.toString()).value);isNaN(Qa)||(qa=Qa)}Qa=Lq.a.nva(b.mf.style.backgroundColor);const rb=Lq.a.him(b.mf);this.hv(gc=>gc.bea(0,0));Lq.a.OUd(b.mf,this);const Lb=Lq.a.Q4h(b.mf),Yb=this.settings.pzn?Lq.a.AOl(b.mf):null;b=new gw(B,Q,u.value,h.value,Qa,rb,Lb,Yb,u.wAi,ca,qa,Uj.hE(b));this.Wi.O9(b);this.VJ(Object(z.a)(this.Wi,this.Wi.N9,"onTableCellEnd"));this.hgn();return 1}W7d(b){const h=this.M1c(b);if(3===h)return h;this.hv(u=>{const B=u.EL(!0);u=u.ZPb("center");
return B||u});Lq.a.OUd(b.mf,this);return 1}a8d(b){Lq.a.OUd(b.mf,this);const h=Lq.a.A9h(b.mf);if(h.nZd&&!h.value&&(v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.o_i))return 3;this.Wi.k5(new yq(h.value,Uj.hE(b)));this.VJ(Object(z.a)(this.Wi,this.Wi.Q9,"onTableRowEnd"));return 1}b8d(){return this.hv(b=>b.OTa("consolas"))?1:2}c8d(){return this.hv(b=>b.H5(!0))?1:2}d8d(b){return this.VRc(b,!1)}e8d(){return 2}h8d(){return this.hv(b=>b.H5(!0))?
1:2}static AUl(b){if(!b)return null;b=b.split(",");1<b.length&&r.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static ZKl(b){return b?b.split(","):null}static dAj(b){if(!b)return null;b=F.a.d7f(b.trim(),'"');return b=F.a.d7f(b,"'")}static M8h(b){if(!b)return null;b=tl.AUl(b);return b=tl.dAj(b)}static $Kl(b){var h;if(!b)return null;b=null===(h=tl.ZKl(b))||void 0===h?void 0:h.map(u=>tl.dAj(u));h=null===b||void 0===b?void 0:b.filter(u=>!!u);return null!==h&&
void 0!==h?h:null}static qoh(b,h){h=h.trim();var u=h.match(RegExp("^-?[0-9]+deg$"));if(u&&0<u.length){if(b.Nli())return!1;b.direction=h;return!0}if((u=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<u.length){if(b.Nli())return!1;b.direction=h;return!0}var B=(u=h.match(RegExp("^rgb\\(.*\\)")))&&0<u.length?h.indexOf(")")+1:h.indexOf(" ");u=-1===B?h:Lq.a.nva(h.substr(0,B).trim());if(!u||""===u)return!1;h=-1===B?"":h.substr(B).trim();B=new Fp;B.color=u;B.stop=
h;b.sIc.add(B);return!0}static dim(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const u=new Ww;for(;0<h.trim().length;){let B=h.indexOf(",");const Q=h.indexOf("(");if(0<Q&&Q<B){const ca=h.indexOf(")");if(ca<Q)return null;B=h.indexOf(",",ca)}if(-1===B){if(!tl.qoh(u,h))return null;h=""}else{const ca=h.substr(0,B);h=h.substr(B+1);if(!tl.qoh(u,ca))return null}}return u}catch(h){return null}}static fUd(b,
h){b=b.split(" ");if(0<b.length)for(let u=0;u<b.length;u++)if(0<=b[u].indexOf(h))return b[u];return""}static rFd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&tl.iDh(b,h))}static iDh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&tl.iDh(b,h)),b=b.nextSibling}static a1l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let u=0;u<b.length;u++){var h=b[u].split(":");if(2===h.length&&
"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static m1l(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static RTm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static qfm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static eyi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=
b.indexOf("underline")}}tl.iFo=(bv=new zb.a,bv.add("TABLE"),bv.add("THEAD"),bv.add("TBODY"),bv.add("TFOOT"),bv.add("TR"),bv.add("TH"),bv.add("TD"),bv);tl.Ruj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(m.a)(tl,"DefaultHtmlTranslator",Uj,[]);var $n=c(1557);class Jm{constructor(b=null){this.z3=b||$n.a.Tii("");this.P6g=Number.parseInvariant((new Date).format("HHmmss"))}get Ic(){return this.z3}process(b,h){if(b&&b.querySelectorAll){const ca=
b.querySelectorAll("p");if(ca&&0<ca.length){for(var u=0,B=!1,Q=ca[0].parentNode;5>u&&Q&&Q!==b;){u++;const qa=Q.id.toLowerCase();if(qa&&qa.length&&-1!==qa.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(Q,"WACEditing")&&Sys.UI.DomElement.containsCssClass(Q,"EditingSurfaceBody")){B=!0;break}Q=Q.parentNode}if(B&&Q!==b){u=b.firstChild;for(B=!1;0<Q.children.length&&Q.children[0]!==u;)b.insertBefore(Q.children[0],u),B=!0;if(B)for(;u;)Q=u.nextSibling,b.removeChild(u),u=Q}b=new Yt.a(h,Object(z.a)(this,
this.CGn,"processNodesDiscovery"),new uB(ca));b.Ml("Word Converter Operation");b.Hh=!h||h.Hh;b.run()}}}CGn(b,h){const u=h.nodes[h.xOa];var B=Jm.W0l(u);if(B){let ca=B.Zoe.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?ca:B.Zoe;let qa=h.lists[ca];qa||(qa=new Ox,qa.Snc=this.P6g++);let Qa=qa.wec[B.level-1];Qa||(Qa=new iA,Qa.level=B.level);var Q=u.parentNode;if(Q&&"li"===Q.tagName.toLowerCase()){if(Q=Q.parentNode)!(Q=Q.tagName.toUpperCase())||"OL"!==Q&&"UL"!==Q||(Qa.tagName=Q)}else Qa.smb=Jm.f8h(u,
5),Qa.smb&&Qa.smb.length||(Qa.smb=Jm.Ltf(u,5)),Qa.ignore=!Qa.smb||!Qa.smb.length,Qa.tagName=Jm.e8h(Qa.smb),"UL"===Qa.tagName&&(Qa.font=this.P8h(u,5));B.Snc=qa.Snc;Qa.Ogn++;Qa.ignore||"li"===u.parentNode.tagName.toLowerCase()||(Q=(Q=Jm.Ltf(u,5))?Q:Qa.smb)&&Q.length&&(B.lYh=Q,(Q=Jm.kio(u,Q,Qa.listStyle,B.level-1))&&Q.length&&(Qa.listStyle=Q));h.Vlb[h.Vlb.length]=B;Qa.Vlb.contains(B)||Qa.Vlb.add(B);if(void 0===qa.wec[B.level-1]||null===qa.wec[B.level-1]||qa.wec[B.level-1]!==Qa)qa.wec[B.level-1]=Qa;h.lists[ca]&&
h.lists[ca]===qa||(h.lists[ca]=qa);h.pEi=u}else if((B=h.pEi)&&Jm.U9l(u)===B&&u.tagName===B.tagName&&u.className===B.className){B.appendChild(B.ownerDocument.createElement("BR"));for(B.appendChild(B.ownerDocument.createElement("BR"));u.firstChild;)B.appendChild(u.firstChild);u.parentNode.removeChild(u)}h.xOa++;if(h.nodes.length<=h.xOa){if(!h.Vlb.length)return!1;h.xOa=0;b.gi(Object(z.a)(this,this.BGn,"processNodeConvert"))}return!0}BGn(b,h){b=h.Vlb[h.xOa];var u=b.ivn,B=b.Zoe.replace(RegExp("level[0-9]"),
"").trim();B=B&&B.length?B:b.Zoe;B=h.lists[B];var Q=B.wec[b.level-1],ca=u.parentNode.tagName.toLowerCase();if(!Q.ignore&&u.parentNode&&"li"!==ca){if(ca=Jm.Q$k(u,Q)){Jm.VCh(u,5);const qa=u.ownerDocument.createElement("LI");qa.setAttribute("data-aria-level",String.format("{0}",b.level));qa.setAttribute($i.a.nZc,String.format("{0}",B.Snc));"UL"===Q.tagName&&(qa.setAttribute($i.a.P1d,String.format("{0}",b.lYh)),qa.setAttribute($i.a.UJf,String.format("{0}",Q.font)));for(;u.firstChild;)qa.appendChild(u.firstChild);
ca.appendChild(qa);u.parentNode.removeChild(u);"UL"===Q.tagName?this.Ic.b++:this.Ic.c++}}else"li"===ca&&(Q=Q.tagName,u=u.parentNode,b.nhc&&(b=u.parentNode)&&b.tagName.toUpperCase()===Q&&b.setAttribute("data-pasteFromRc","true"),u.setAttribute($i.a.nZc,String.format("{0}",B.Snc)),"UL"===Q?this.Ic.b++:this.Ic.c++);h.xOa++;return h.xOa<h.Vlb.length}P8h(b,h){let u=null;for(let B=0;!u&&B<b.childNodes.length;B++){const Q=b.childNodes[B];u=Jm.TWl(Q);!u&&1===Q.nodeType&&1<h&&(u=this.P8h(Q,h-1))}return u}static Q$k(b,
h){b=Jm.P$k(b,h.tagName);return Jm.r5k(b,h)}static r5k(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static P$k(b,h){h=b.ownerDocument.createElement(h?h:"UL");var u=b.getAttribute("start");u&&0<u.length&&(h.setAttribute("start",u),b.removeAttribute("start"));(u=b.className)&&0<u.length&&(u="OL"===h.tagName?tl.fUd(u,"NumberListStyle"):tl.fUd(u,"BulletListStyle"),
0<u.length&&(Sys.UI.DomElement.addCssClass(h,u),Sys.UI.DomElement.removeCssClass(b,u)));b.parentNode.insertBefore(h,b);return h}static VCh(b,h){for(let u=0;u<b.childNodes.length;u++){const B=b.childNodes[u];1===B.nodeType&&1<h&&Jm.VCh(B,h-1);if(Jm.LJm(B)||Jm.pxi(B))b.removeChild(B),u--}}static W0l(b){if(1===b.nodeType){var h=Jm.Gtf(b,"mso-list");if(h&&0<h.length)try{var u=h.split(" ");if(3===u.length){const B=Number.parseInvariant(u[1].substr(5)),Q=new er(B,h,b);Q.nhc=!0;return Q}}catch(B){}else if((u=
b.parentNode)&&"li"===u.tagName.toLocaleLowerCase()&&(h=u.getAttribute("data-"+af.a.ECd),u=u.getAttribute($i.a.nZc),h&&u&&0<h.length&&0<u.length))return b=new er(Number.parseInvariant(h),u+" level"+h,b),b.nhc=!1,b}return null}static kio(b,h,u,B){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===Jm.e8h(h))return u=Jm.RNl(h),Sys.UI.DomElement.addCssClass(b,u),u;var Q=h.match(RegExp("^[0-9]+"));return Q&&Q.length?(u="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,u),b.setAttribute("start",
Q[0]),u):(Q=h.match(RegExp("^[a-zA-Z]+")))&&Q.length&&(Q=Q[0],B=(h=Q.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Jm.$$l(u,B):1,1!==B&&((u=Jm.rHd(b,Q,RegExp("^[ivxlcdm]+"),F.a.kIh,"NumberListStyle3"))||(u=Jm.rHd(b,Q,RegExp("^[IVXLCDM]+"),F.a.kIh,"NumberListStyle5")))||B&&((u=Jm.rHd(b,Q,RegExp("^[a-z]+"),F.a.iIh,"NumberListStyle2"))||(u=Jm.rHd(b,Q,RegExp("^[A-Z]+"),F.a.iIh,"NumberListStyle4"))))?u:"NumberListStyle1"}return null}static RNl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";
default:return"BulletListStyle1"}}static $$l(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static rHd(b,h,u,B,Q){return(h=h.match(u))&&h.length?(B=B(h[0]),B=1>B?1:B,Sys.UI.DomElement.addCssClass(b,Q),b.setAttribute("start",B+""),Q):null}static e8h(b){return Jm.HGm(b)?"UL":"OL"}static HGm(b){return!b||
"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Ltf(b,h){let u=null;var B;let Q,ca;for(let qa=-1;!u&&qa<b.childNodes.length;qa++){const Qa=-1===qa?b:b.childNodes[qa];if(Qa)if((B=Qa.innerHTML)&&0<B.length){if(Q=B.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=Q&&(ca=B.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){B=B.substring(Q,ca+14);Qa.innerHTML=Qa.innerHTML.replace(B,"");if(B.length){b=b.ownerDocument.createElement("span");b.innerHTML=
B;u=b.innerText.trim();break}u&&u.length||(u="o")}}else 0<=qa&&1===Qa.nodeType&&1<h&&(u=Jm.Ltf(Qa,h-1))}return u}static TWl(b){let h=null;1===b.nodeType&&((h=Jm.O8h(b,"font-family"))||(h=Jm.O8h(b,"mso-ascii-font-family")));return h}static O8h(b,h){return(b=Jm.Gtf(b,h))&&0<b.length?b.trim():null}static f8h(b,h){let u=null;for(let B=0;!u&&B<b.childNodes.length;B++){const Q=b.childNodes[B];Jm.pxi(Q)?(u="string"===typeof Q.innerText?Q.innerText.trim():Q.textContent.trim(),u.length||(u="o"),Q.parentNode.removeChild(Q)):
1===Q.nodeType&&1<h&&(u=Jm.f8h(Q,h-1))}return u}static pxi(b){return 1===b.nodeType&&(b=Jm.Gtf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static LJm(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static Gtf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let u=0;u<b.length;u++){const B=b[u].split(":");if(2===B.length&&B[0].trim()===h)return B[1].trim()}}return null}static U9l(b){do b=b.previousSibling;while(b&&
Jm.hwi(b));return b}static hwi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Jm.f9j,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Jm.hwi(b.firstChild):!0}}Jm.f9j=RegExp("[\n|\r]","gi");Object(m.a)(Jm,"WacAndRichClientWordConverter",null,[179]);class Ur{constructor(){}create(b=null){return new Jm(b)}}Object(m.a)(Ur,"Box4WordConverterFactory",null,[508]);var xB=c(1775);class nz{constructor(b,h,u,B,Q){this.LSg=0;this.v1o=ca=>{let qa=
!0;const Qa=this.Qfa.bvl;null!=Qa?(ca.oqa=Qa,qa=!1):Date.now()-this.LSg>this.ave&&(r.ULS.sendTraceTag(18354843,307,50,null),this.yd.Yb(pd.a.Zna,{["Reason"]:pe.a.lYi}),qa=ca.oqa=!1);return qa};this.yd=b;this.Pe=h;this.ave=Q;this.Qfa=u;this.YMa=B}jVk(b,h,u){r.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,u,this.Pe.jG);b.Hh&&this.Pe.Cr&&window.chrome&&r.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",
h);this.Qfa.DMc(!!(h&16));this.YMa.create(b,this.v1o,null).Ml("ClipboardPreProcess");this.LSg=Date.now()}l4n(){this.Qfa.reset()}}Object(m.a)(nz,"ClipboardOperationClipboardAccessHelper",null,[506]);var zq=c(339);class Xw{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd){this.nXa=null;this.ga=b;this.yd=h;this.fA=u;this.mh=B;this.ib=Q;this.Qfa=ca;this.gb=qa;this.De=Qa;this.Pn=rb;this.Zc=Lb;this.scb=Yb;this.bPe=gc;this.JE=Fc;this.hk=ld;this.gXb=Sc?Sc.$("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.uod=Sc?Sc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.od=Hd;this.og=Re.a.getInstance(zq.a.I_a)}get Yf(){return this.mh}get Hc(){return this.yd}get sVc(){if(null==this.nXa)if(this.od)if(this.od.lq.isCompleted)this.nXa=this.od.isFeatureEnabled(3);else return!1;else this.nXa=!1;return this.nXa}n1o(b){b.EN();return!0}OIh(b,h){b=h.Qw;r.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let B=!1,Q;Z.a.Exa&&v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");
this.sVc&&h.ie&&h.ie.rh&&(B=this.hk.unh(h.ie.rh.editingElement));Q=this.hk.jxf(h.ie.rh.editingElement,!1);var u=h.ie.rh.editingElement;this.hk.JBf(u,!1,1);this.gXb&&Z.a.Exa?(u=h.ie.rh.editingElement,this.hk.f8f(u,"data-src","data-srcurl"),b=this.Qfa.copy(),this.hk.f8f(u,"data-srcurl","data-src")):this.uod&&h.ie&&h.ie.rh?(u=this.hk.h6e(h.ie.rh.editingElement,h.ie.tB,!0),b=this.Qfa.copy(),u&&this.hk.h6e(h.ie.rh.editingElement,h.ie.tB,!1)):(this.hk.B$i(h.ie.rh.editingElement),b=this.Qfa.copy());this.sVc&&
B&&this.hk.fZn(h.ie.rh.editingElement);Q&&this.hk.jxf(h.ie.rh.editingElement,!0);u=h.ie.rh.editingElement;this.hk.JBf(u,!1,0);if(!b)return r.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.og.logKpiFailure({kpiName:zq.a.yEd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Hc.Yb(pd.a.jEb,{["Reason"]:pe.a.jjg}),h.$R&&h.$R.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}g$e(b,
h){const u=h.ie;r.ULS.shipAssertTag(18130961,307,!!(h.Qw&16));h.Rwo?this.fA.qDh():this.fA.KHd(u,b);return!0}MPh(b,h){var u=h.context,B=h.Ad;const Q=h.n$;var ca=!1;b=this.ib.hb.lb.Rc;if(this.gb.nm(b)||this.De.Fk(b)){const qa=this.Zc.Tf(b.node),Qa=qa.rd();r.ULS.shipAssertTag(18130962,307,Qa);this.Pn.Wd(qa);this.scb.Mkb(qa)&&(ca=!0)}B=h.Qw&64?new Od.DictionaryPropertySet:B||new Od.DictionaryPropertySet;B.setValue($c.a.zLc,!1);u=this.ga.Kf(u,Ob.a.HH,2,!0,Q,B);8===u&&(r.ULS.sendTraceTag(18130963,307,50,
"DeleteKey failed"),this.Hc.Yb(pd.a.Zna,{["Reason"]:pe.a.LPh}),h.$R&&h.$R.fail("DeleteKey failed",!1),this.og.logKpiFailure({kpiName:zq.a.W5e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===u&&this.og.logKpiSuccess({kpiName:zq.a.W5e});32===u&&ca&&(h=this.ib.hb.lb,this.De.Il(h)&&h.Pa.node===b.node&&!this.gb.textLength(h.Pa.node)&&(h=this.Zc.Tf(h.Pa.node),b=this.De.yu(h),r.ULS.shipAssertTag(18130964,307,b),this.Pn.Wd(h),this.scb.bZd(h)||(b=this.bPe.create(),b.jd(h),this.Pn.X0(b,!1,!1),ca=this.Pn.Ce(b),
this.gb.Wb(ca)&&(this.Pn.Wd(b),this.Yf.merge(b,h,!1,!1),this.ib.Bc(this.JE.ne(ca,this.gb.textLength(ca)))))));return!0}}Object(m.a)(Xw,"ClipboardOperationCutCopy",null,[527]);class qp{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd){this.ga=b;this.yd=h;this.fA=u;this.Qfa=ca;this.ib=Q;this.mh=B;this.gb=qa;this.De=Qa;this.Pn=rb;this.Zc=Lb;this.scb=Yb;this.bPe=gc;this.JE=Fc;this.Ga=Sc;this.hk=ld;this.od=Hd}create(){return new Xw(this.ga,this.yd,this.fA,this.mh,this.ib,this.Qfa,this.gb,this.De,
this.Pn,this.Zc,this.scb,this.bPe,this.JE,this.Ga,this.hk,this.od)}}Object(m.a)(qp,"Factory",null,[505]);var Px=c(1693);class Aq{constructor(b,h){this.Ehd=null;this.b6k=(u,B)=>{if(!Object(Cb.a)(85,B.Ad))return!1;const Q=Object(Na.a)(85,B.Ad);if(!Q.hasProperty($c.a.nvf))return!1;const ca=Q.getValue($c.a.nvf),qa=B.ie,Qa=qa.mb;this.fA.hHj();Qa.fPb(()=>{Qa.Bc(ca,void 0,!0);this.fA.KHd(qa,u)},!0);return!0};this.fA=b;this.A6=h;this.yI=0}process(b,h){this.yI||(this.Ehd=[this.b6k,Object(z.a)(this.A6,this.A6.izn,
"pasteGlossaryPlaceholder")]);let u=!0;this.yI<this.Ehd.length&&(u=this.Ehd[this.yI++](b,h));return u?this.yI<this.Ehd.length:!1}}Object(m.a)(Aq,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[530]);class Vp{constructor(b){this.ytb=null;this.r2=b;this.yI=-1}process(b,h){-1===this.yI&&(this.Dfl(b,h),this.yI=0);let u=!1;this.yI<this.ytb.length&&(u=this.ytb[this.yI++](b,h));return u?this.yI<this.ytb.length:!1}Dfl(b,h){Z.a.K4||h.Qw&512?(this.ytb=[Object(z.a)(this.r2,this.r2.g$e,"copyInternal")],
r.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Hh&&h.Qw&256?(this.ytb=[Object(z.a)(this.r2,this.r2.n1o,"waitBeforeCopy"),Object(z.a)(this.r2,this.r2.OIh,"copyExternal"),Object(z.a)(this.r2,this.r2.g$e,"copyInternal")],r.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.ytb=[Object(z.a)(this.r2,this.r2.OIh,"copyExternal"),Object(z.a)(this.r2,this.r2.g$e,
"copyInternal")],r.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.Qw&32&&(b=Object(z.a)(this.r2,this.r2.MPh,"deleteForCut"),this.ytb.push(b),r.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));zq.a.b2m(h)}}Object(m.a)(Vp,"ClipboardOperationCutCopyProcessor",null,[529]);class bk{constructor(b,h,u,B){this.Lqd=null;this.e6k=(Q,ca)=>{ca=ca.ie;this.fA.cZo();this.fA.KHd(ca,
Q);return!0};this.Y_c=(Q,ca)=>{ca=new Dh.Selection([ca.Ad],!0);this.ib.Bc(ca,Q);return!0};this.fA=b;this.ib=h;this.r2=u;this.A6=B;this.yI=0}process(b,h){this.yI||(this.Lqd=[this.e6k,Object(z.a)(this.r2,this.r2.MPh,"deleteForCut"),this.Y_c,Object(z.a)(this.A6,this.A6.t_i,"pasteInternal"),Object(z.a)(this.A6,this.A6.Flj,"setSelectionAfterPaste")]);let u=!0;this.yI<this.Lqd.length&&(u=this.Lqd[this.yI++](b,h));return u?this.yI<this.Lqd.length:!1}}Object(m.a)(bk,"ClipboardOperationMoveProcessor",null,
[528]);var Bq=c(1692);class cp{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe){this.fA=b;this.ga=h;this.Arc=u;this.yd=B;this.De=Q;this.Pe=ca;this.Kc=qa;this.Ygd=Qa;this.kXj=rb;this.LUb=Lb;this.ove=Yb;this.mrc=gc;this.YMa=Fc;this.ED=Sc;this.Ud=ld;this.Lm=Hd;this.a_=Ie;this.Sfa=fe}create(b,h,u,B,Q,ca,qa,Qa,rb=!0){const Lb=this.Ygd.create(B,Object(Na.a)(85,Qa));var Yb=this.kXj.create();const gc=new Aq(this.fA,Lb),Fc=new bk(this.fA,xf.a.instance,Yb,Lb);Yb=new Vp(Yb);B=new Bq.a(v.AFrameworkApplication.K,
gv.a.instance,B,Wh.a.instance,Lb,this.LUb);return new Px.a(b,h,u,Q,ca,qa,Qa,this.Arc,this.ga,this.yd,this.De,this.Pe,this.Kc,gc,Fc,Yb,B,this.LUb,this.ove,this.mrc,this.YMa,this.ED,this.Ud,this.Lm,this.a_,this.Sfa,v.AFrameworkApplication.vfg(),rb)}}Object(m.a)(cp,"Factory",null,[504]);var oz=c(260);class Ms{constructor(b,h){this.UGb=b.Npf(h);this.o$e=b.PRl(h);this.NBb=b.Cnf(h);this.Seb=b.cnf(h)}static hF(b){return Ms.Ur(b)}static Ur(b){return new Ms(vs.a.instance,b)}}Object(m.a)(Ms,"CpUsageHelper",
null,[]);class cv{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc){this.o3=!1;this.yd=b;this.fA=h;this.oAc=u;this.jua=B;this.ib=Q;this.ga=ca;this.VCe=qa;this.NVe=rb;this.XMe=Qa;this.Cye=Lb;this.mve=Yb;this.Ud=gc;this.og=Re.a.getInstance(zq.a.I_a);this.o3=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get Qg(){return this.NVe.value}get Pra(){return this.jua}get Hc(){return this.yd}get FSa(){return this.XMe.FSa}paste(b,h){const u=this.Ud.p_a();try{const B=h.ie,
Q=h.Qw;this.ib&&this.ib.hb&&this.ib.hb.lb&&oz.TableBorderSelectionCache.$mo(this.ib.hb.lb.Ov||this.ib.hb.lb.nlb);zp.a.Tko(this.ib);r.ULS.shipAssertTag(18131010,307,!!(Q&1));Object(Cb.a)(85,h.Ad)&&h.Ad.setValue(Sh.a.Wga,B.rh.editingElement.clientWidth);this.mve.RNo(b,h);let ca;if(!({fHd:ca}=this.VCe.value.JAj()).returnValue)return this.LZc(h,"HTML import strategy failed",!1),this.o3?this.og.logKpiFailure({kpiName:zq.a.SNa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:zq.a.Qnb,isIntentional:!1,
isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):xa.Health.instance.recordQosError("HtmlImportStrategyFailed",[zq.a.Qnb],!1,!0,!0,!1,null),!1;this.Qg.nF();let qa=!0,Qa=null;const rb=this.Cye.create(ca),Lb=h.eHj;if(!B||!B.mb)return this.LZc(h,"Fail to set selection.",!1),this.o3?this.og.logKpiFailure({kpiName:zq.a.SNa,errorName:"SetSelectionFailed",optionalVeto:{name:zq.a.Qnb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):xa.Health.instance.recordQosError("SetSelectionFailed",
[zq.a.Qnb],!1,!0,!0,!1,null),!1;B.mb.fPb(()=>{Lb&&2===this.ga.processAction(Ob.a.Cna,2)?qa=!1:(Qa=Lb?this.ib&&this.ib.hb&&this.ib.hb.lb?this.ib.hb.lb.Pa:null:h.Ad)?(r.ULS.shipAssertTag(18158338,307,Ge.SelectionEditor.ef(Qa)),this.oJi(Qa,"paste")):r.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Lb)},this.XMe.Izi);if(!qa)return this.LZc(h,"fail to deleteForReplace.",!0),!1;if(!Qa)return this.LZc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Qa.node||
!Qa.node.isConnected)return this.LZc(h,"node is null or not connected in ip context.",!0),!1;B.ve.disable(!0,25);rb.restore();this.oAc.czn(ca,Qa,b);return!0}finally{u&&u.dispose()}}LZc(b,h,u){b.failed=!0;b.$R&&b.$R.fail(h,u)}izn(b,h){const u=Object(Na.a)(85,h.Ad).getValue($c.a.Bji);r.ULS.shipAssertTag(20492440,307,Ge.SelectionEditor.ef(u));if(!this.vCh(u,h))return!1;this.Qg.nF();h=(new $k.a).Pc(15);h.Db(this.fA.hka);this.oAc.ysi(u,b);this.fA.qDh();h.dispose();return!0}t_i(b,h){const u=this.ib.hb.lb.Pa;
if(!this.vCh(u,h))return!1;this.Qg.nF();this.ga.processAction(Ob.a.Cna,2);this.oJi(u,"intPaste");this.oAc.ysi(u,b);return!0}vCh(b,h){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return r.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.MXc),h.$R&&(h.$R.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:zq.a.SNa,
errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!Ge.SelectionEditor.ef(b))return r.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.MXc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:zq.a.SNa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),
h.$R&&(h.$R.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}oJi(b,h){h=Ms.hF(h);this.Pra.LOn(h,b.node,b.cpBegin);this.Pra.d2m(h.o$e);this.Pra.TLf(h.UGb);this.Pra.FLf(h.NBb);this.Pra.CLf(h.Seb)}Flj(b,h){if(!h.eHj)return!1;h.Qw&64&&this.fA.gHj();if(!h.t1a)return r.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.lkb}),h.$R&&h.$R.fail("No selection after paste",!1),h.failed=!0,!1;this.XMe.uYo(h);this.Qg.nF();return!1}}
Object(m.a)(cv,"ClipboardOperationPaste",null,[525]);class dv{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.yd=b;this.fA=h;this.oAc=u;this.jua=B;this.ib=Q;this.ga=ca;this.NVe=Qa;this.adk=qa;this.Cye=rb;this.mve=Lb;this.Ud=Yb}create(b,h){h=this.adk.create(this.ib,h);return new cv(this.yd,this.fA,this.oAc,this.jua,this.ib,this.ga,b,h,this.NVe,this.Cye,this.mve,this.Ud)}}Object(m.a)(dv,"Factory",null,[503]);var Qx=c(1627);class vB{constructor(b,h){this.hCo=b;this.ayn=h}}Object(m.a)(vB,"ParagraphFormatStore",
null,[]);class jA{constructor(b,h,u){this.ib=b;this.gb=h;this.ue=u}RNo(b,h){if(h.Occ){h=b.oqa;var u=this.ib.hb.lb.Pa.node,B=null;this.gb.Wb(u)&&(B=this.ue.Ro(u),u=this.gb.u2a(u),B=new vB(B,u));h=new Qx.a(h.context,h.Qw,h.$R,h.n$,h.Ad,B);b.oqa=h}}}Object(m.a)(jA,"ClipboardOperationPasteOvertypeStrategy",null,[502]);class ft{constructor(b){this.KIe=null;this.ib=b;b.fPb(h=>{this.KIe=h},!1)}get Izi(){return!1}uYo(b){b=this.O_e(b);this.Bc(this.ib,b)}O_e(b){let h=b.t1a;(b.iVa||b.Gja)&&b.rje&&(h=Cg.SelectionFactory.Dy(b.rje,
h.Pa));return h}Bc(b,h){b.Bc(h)}}Object(m.a)(ft,"AClipboardOperationPasteStrategy",null,[553]);class Ns extends ft{constructor(b){super(b)}get FSa(){return this.KIe}}Object(m.a)(Ns,"ClipboardOperationPasteToLiveSelectionStrategy",ft,[]);class Yw extends ft{constructor(b,h){super(b);this.RWe=null;this.p$j=h;b.fPb(u=>{this.RWe=u},!0)}get Izi(){return!0}get FSa(){return this.RWe}O_e(b){let h=super.O_e(b);b.Ad.setValue($c.a.y_i,h);return h=this.p$j.abi(this.KIe.lb,this.RWe.lb,h)}}Object(m.a)(Yw,"ClipboardOperationPasteToVirtualSelectionStrategy",
ft,[]);class gq{constructor(b){this.QWe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ja($c.a.iVa,!1)&&this.QWe?new Yw(b,this.O0o):new Ns(b)}get O0o(){return null!=this.$Hg?this.$Hg:this.$Hg=Ga.a.instance.Oa("Box4.Actors.IVirtualSelectionMerger")}}Object(m.a)(gq,"ClipboardOperationPasteStrategyFactory",null,[501]);class yB{constructor(b,h,u,B){this.Hc=b;this.mb=h;this.Om=u;this.Uf=B}UDn(b){(b&1||b&32)&&this.Om.So&&this.mb.x1b()}dHm(b,h){return b&1&&this.Uf.R_(h,!0)?(this.Hc.Yb(pd.a.Ye,
{["Reason"]:pe.a.ZE}),!1):!0}}Object(m.a)(yB,"ClipboardOperationWordStrategy",null,[]);class io{constructor(){}A5k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var u=Array.clone(h);u.reverse();var B=h=0,Q=0,ca=0;for(const Qa of u){u=Qa.style;var qa=Qa.selectorText;u=u?u.cssText:null;qa=qa?qa.split(","):null;if(u&&qa&&Qa.type===Qa.STYLE_RULE){ca+=qa.length;for(const rb of qa){0<=rb.indexOf("#")&&h++;0<=rb.indexOf(".")&&B++;0>rb.indexOf("#")&&0>rb.indexOf(".")&&Q++;qa=null;try{qa=b.querySelectorAll(rb)}catch(Lb){r.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",rb,Lb.message)}if(qa)for(let Lb=0;Lb<qa.length;Lb++)qa[Lb].setAttribute("style",u+(qa[Lb].getAttribute("style")||""))}}}r.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,h,B,Q)}else this.NJi();else this.NJi()}NJi(){r.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
Z.a.jG)}}Object(m.a)(io,"ExternalPasteCssConverter",null,[500]);class sz{constructor(b){this.xOa=0;this.ODh=null;this.node=b}}Object(m.a)(sz,"ChartConverterArguments",null,[]);class zk{constructor(b=null){this._imgNodesConverted=0;this.z3=b||$n.a.d5h("")}get Ic(){return this.z3}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Yt.a(h,this.qyl.bind(this),new sz(b[0])),b.Ml("Chart Converter Operation"),b.Hh=!h||h.Hh,b.run())))}qyl(b,h){var u=
h.node;if(1<h.xOa)return!1;if(1===u.nodeType&&"DIV"===u.tagName){const B=u.getAttribute(Nf.mJd);if(B){const Q=u.getAttribute(Nf.scf),ca=u.getAttribute(Nf.tcf),qa=u.getAttribute(Nf.qcf),Qa=u.getAttribute(Nf.rcf),rb=u.getAttribute(Nf.vKc);u=u.getAttribute(Nf.ucf);Q&&Qa&&ca&&"chart"===ca&&rb&&"XLO"===rb&&(h.ODh=new wn(B,Q,ca,qa,Qa,rb,u))}}b.gi(this.Vbn.bind(this));return!0}Vbn(b,h){var u=h.node;if(b=h.ODh)1===u.childElementCount&&1===u.firstChild.nodeType&&"IMG"===u.firstChild.tagName?(u=u.firstChild,
u.setAttribute(Nf.mJd,b.ccpId),u.setAttribute(Nf.scf,b.pKey),u.setAttribute(Nf.tcf,b.type),u.setAttribute(Nf.rcf,b.dc),u.setAttribute(Nf.vKc,b.client),b.version&&u.setAttribute(Nf.ucf,b.version),b.count&&u.setAttribute(Nf.qcf,b.count),this._imgNodesConverted++):r.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.z3._imgNodesConverted=this._imgNodesConverted;h.xOa++;return!1}}Object(m.a)(zk,"ChartConverter",null,[]);class dh{constructor(b,h=null,u=null){this.gf=b;this.z3=h||$n.a.xfi("");
this.Sjk=u||$n.a.yfi("")}get Ic(){return this.z3}get Kjg(){return this.Sjk}R9(b){this.Kjg.b++;this.gf.R9(b)}P9(){this.gf.P9()}k5(b){this.Kjg.c++;this.gf.k5(b)}Q9(){this.gf.Q9()}O9(b){this.Kjg.d++;this.gf.O9(b)}N9(){this.gf.N9()}reset(){this.gf.reset()}get FKc(){return this.gf.FKc}wda(b,h){this.Ic.b++;this.gf.wda(b,h)}vda(b){this.Ic.c++;this.gf.vda(b)}snb(b){this.Ic.b++;this.gf.snb(b)}hya(b){this.Ic.d++;this.gf.hya(b)}cHa(b){this.Ic.f++;this.gf.cHa(b)}kSa(b,h){this.Ic.g++;this.gf.kSa(b,h)}jSa(){this.gf.jSa()}fE(b){this.Ic.h++;
this.gf.fE(b)}tF(){this.gf.tF()}nnb(){this.gf.nnb()}mnb(){this.gf.mnb()}pSa(b,h){this.Ic.i++;this.gf.pSa(b,h)}J5a(){this.gf.J5a()}lya(b){this.Ic.j++;this.gf.lya(b)}jya(){this.gf.jya()}hHa(b){this.Ic.k++;this.gf.hHa(b)}kya(){this.gf.kya()}L5a(b){this.Ic.l++;this.gf.L5a(b)}}Object(m.a)(dh,"SemanticEventUsageCollector",null,[180,181]);class xs{constructor(b,h=null,u=null,B=null){this.PXj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.gf=
b;this.z3=h||$n.a.J9h(Z.a.gBb,"");this.zv=u;this.Mhk=B?B.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.Nhk=B?B.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.jOg=new wc.a(Ra.a.jh());for(const Q of this.PXj)this.jOg.add(Q)}get Ic(){return this.z3}get vl(){return this.zv}Ah(b){return b?b+1:1}reset(){this.gf.reset()}Q5d(){this.gf.Q5d()}Mwf(b){if(b&&this.vl&&(b.getAttribute&&(b.getAttribute(Nf.Sfl)&&(this.vl.A1h=!0),b.getAttribute(Nf.mJd)&&(this.vl.sHl=!0),b.getAttribute(Nf.vKc)&&(this.vl.s7e=
b.getAttribute(Nf.vKc)),b.getAttribute(Nf.Vfl)&&(this.vl.B1h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Nf.jkm)&&(this.vl.C1h=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Nf.Ptn)&&(this.vl.G1h=!0);h.startsWith(Nf.aDn)&&(this.vl.H1h=!0);h.startsWith(Nf.a3o)&&(this.vl.I1h=!0);if(h.startsWith(Z.a.h4e)&&h.length===Z.a.h4e.length+1){const u=parseInt(F.a.substring(h,h.length-1,h.length));isNaN(u)||(this.vl.qJc=u)}if(h===Nf.mdn||h===Nf.ndn)this.vl.gOc=!0}return this.gf.Mwf(b)}onClose(){this.gf.onClose()}HOm(b){for(const h of b)if("\n"!==
h)return!0;return!1}wda(b,h){this.vl&&(this.vl.uHl=!0);this.vl&&!this.vl.Alf&&b&&(this.vl.Alf=this.HOm(b));this.Ic.d=this.Ah(this.Ic.d);this.gf.wda(b,h)}K5d(b){this.vl&&(this.vl.E1h=!0);this.Ic.e=this.Ah(this.Ic.e);this.hi(b);return this.gf.K5d(b)}wTf(b){this.Ic.f=this.Ah(this.Ic.f);this.hi(b);return this.gf.wTf(b)}xTf(b){this.Ic.g=this.Ah(this.Ic.g);this.hi(b);return this.gf.xTf(b)}CTf(b){this.Ic.h=this.Ah(this.Ic.h);this.hi(b);return this.gf.CTf(b)}RTf(b){this.Ic.i=this.Ah(this.Ic.i);this.hi(b);
return this.gf.RTf(b)}TTf(b){this.Ic.j=this.Ah(this.Ic.j);this.hi(b);this.gf.TTf(b)}P5d(b){this.Ic.k=this.Ah(this.Ic.k);this.hi(b);return this.gf.P5d(b)}UTf(b){this.Ic.l=this.Ah(this.Ic.l);this.hi(b);this.gf.UTf(b)}VTf(b){this.Ic.m=this.Ah(this.Ic.m);this.hi(b);this.gf.VTf(b)}WTf(b){this.Ic.n=this.Ah(this.Ic.n);this.hi(b);return this.gf.WTf(b)}S5d(b){this.Ic.o=this.Ah(this.Ic.o);this.hi(b);return this.gf.S5d(b)}T5d(b){this.Ic.p=this.Ah(this.Ic.p);this.hi(b);return this.gf.T5d(b)}jUf(b){this.Ic.q=
this.Ah(this.Ic.q);this.hi(b);return this.gf.jUf(b)}U5d(b){this.Ic.r=this.Ah(this.Ic.r);this.hi(b);this.gf.U5d(b)}lUf(b){this.Ic.s=this.Ah(this.Ic.s);this.hi(b);return this.gf.lUf(b)}V5d(b){this.Ic.t=this.Ah(this.Ic.t);this.hi(b);return this.gf.V5d(b)}W5d(b){this.Ic.u=this.Ah(this.Ic.u);this.hi(b);return this.gf.W5d(b)}Z5d(b){this.Ic.v=this.Ah(this.Ic.v);this.hi(b);return this.gf.Z5d(b)}$5d(b){this.Ic.w=this.Ah(this.Ic.w);this.hi(b);return this.gf.$5d(b)}yUf(b){this.Ic.x=this.Ah(this.Ic.x);this.hi(b);
this.gf.yUf(b)}zUf(b){this.Ic.y=this.Ah(this.Ic.y);this.hi(b);return this.gf.zUf(b)}g6d(b){this.Ic.z=this.Ah(this.Ic.z);this.hi(b);return this.gf.g6d(b)}h6d(b){this.Ic.ba=this.Ah(this.Ic.ba);this.hi(b);return this.gf.h6d(b)}k6d(b){this.Ic.bb=this.Ah(this.Ic.bb);this.hi(b);return this.gf.k6d(b)}l6d(b){this.Ic.bc=this.Ah(this.Ic.bc);this.hi(b);return this.gf.l6d(b)}n6d(b){this.Ic.bd=this.Ah(this.Ic.bd);this.hi(b);return this.gf.n6d(b)}o6d(b){this.Ic.be=this.Ah(this.Ic.be);this.hi(b);return this.gf.o6d(b)}q6d(b){this.Ic.bf=
this.Ah(this.Ic.bf);this.hi(b);return this.gf.q6d(b)}s6d(b){this.Ic.bg=this.Ah(this.Ic.bg);this.hi(b);return this.gf.s6d(b)}$Uf(b){this.Ic.bh=this.Ah(this.Ic.bh);this.hi(b);return this.gf.$Uf(b)}z6d(b){this.Ic.bi=this.Ah(this.Ic.bi);this.hi(b);return this.gf.z6d(b)}gVf(b){this.Ic.bj=this.Ah(this.Ic.bj);this.hi(b);return this.gf.gVf(b)}iVf(b){this.Ic.bk=this.Ah(this.Ic.bk);this.hi(b);this.gf.iVf(b)}jVf(b){this.Ic.bl=this.Ah(this.Ic.bl);this.hi(b);return this.gf.jVf(b)}C6d(b){this.Ic.bm=this.Ah(this.Ic.bm);
this.hi(b);return this.gf.C6d(b)}D6d(b){this.Ic.bm=this.Ah(this.Ic.bm);this.hi(b);return this.gf.D6d(b)}E6d(b){this.Ic.bm=this.Ah(this.Ic.bm);this.hi(b);return this.gf.E6d(b)}F6d(b){this.Ic.bm=this.Ah(this.Ic.bm);this.hi(b);return this.gf.F6d(b)}G6d(b){this.Ic.bm=this.Ah(this.Ic.bm);this.hi(b);return this.gf.G6d(b)}H6d(b){this.Ic.bm=this.Ah(this.Ic.bm);this.hi(b);return this.gf.H6d(b)}qVf(b){this.Ic.bn=this.Ah(this.Ic.bn);return this.gf.qVf(b)}I6d(b){this.Ic.bo=this.Ah(this.Ic.bo);this.hi(b);this.gf.I6d(b)}xVf(b){this.Ic.bp=
this.Ah(this.Ic.bp);return this.gf.xVf(b)}J6d(b){this.Ic.bq=this.Ah(this.Ic.bq);this.hi(b);return this.gf.J6d(b)}zVf(b){this.Ic.br=this.Ah(this.Ic.br);this.hi(b);return this.gf.zVf(b)}M6d(b){this.vl&&(this.vl.D1h=!0);this.hi(b);this.Ic.bs=this.Ah(this.Ic.bs);this.gf.M6d(b)}GVf(b){this.Ic.bt=this.Ah(this.Ic.bt);this.hi(b);this.gf.GVf(b)}N6d(b){this.Ic.bu=this.Ah(this.Ic.bu);this.hi(b);return this.gf.N6d(b)}MVf(b){this.Ic.bv=this.Ah(this.Ic.bv);this.hi(b);return this.gf.MVf(b)}P6d(b){this.Ic.bw=this.Ah(this.Ic.bw);
this.hi(b);return this.gf.P6d(b)}R6d(b){this.Ic.bx=this.Ah(this.Ic.bx);this.hi(b);return this.gf.R6d(b)}T6d(b){this.Ic.by=this.Ah(this.Ic.by);this.hi(b);return this.gf.T6d(b)}U6d(b){this.vl&&(this.vl.gOc=!0);this.Ic.bz=this.Ah(this.Ic.bz);this.hi(b);return this.gf.U6d(b)}XVf(b){this.Ic.ca=this.Ah(this.Ic.ca);this.hi(b);this.gf.XVf(b)}aWf(b){this.Ic.cb=this.Ah(this.Ic.cb);this.hi(b);return this.gf.aWf(b)}W6d(b){this.vl&&(this.vl.tHl=!0);this.Ic.cc=this.Ah(this.Ic.cc);this.hi(b);return this.gf.W6d(b)}onMenuOpen(b){this.Ic.cd=
this.Ah(this.Ic.cd);this.hi(b);return this.gf.onMenuOpen(b)}fWf(b){this.Ic.ce=this.Ah(this.Ic.ce);this.gf.fWf(b)}oWf(b){this.Ic.cf=this.Ah(this.Ic.cf);this.hi(b);return this.gf.oWf(b)}pWf(b){this.Ic.cg=this.Ah(this.Ic.cg);this.hi(b);return this.gf.pWf(b)}rWf(b){this.Ic.ch=this.Ah(this.Ic.ch);this.hi(b);return this.gf.rWf(b)}h7d(b){this.vl&&(this.vl.gOc=!0);this.Ic.ci=this.Ah(this.Ic.ci);this.hi(b);return this.gf.h7d(b)}tWf(b){this.Ic.cj=this.Ah(this.Ic.cj);this.hi(b);return this.gf.tWf(b)}i7d(b){this.Ic.ck=
this.Ah(this.Ic.ck);this.hi(b);return this.gf.i7d(b)}m7d(b){this.Ic.cl=this.Ah(this.Ic.cl);this.hi(b);return this.gf.m7d(b)}AWf(b){this.Ic.cm=this.Ah(this.Ic.cm);this.hi(b);this.gf.AWf(b)}t7d(b){this.Ic.cn=this.Ah(this.Ic.cn);this.hi(b);return this.gf.t7d(b)}LWf(b){this.Ic.co=this.Ah(this.Ic.co);this.hi(b);return this.gf.LWf(b)}A7d(b){this.Ic.cp=this.Ah(this.Ic.cp);this.hi(b);return this.gf.A7d(b)}B7d(b){this.Ic.cq=this.Ah(this.Ic.cq);this.hi(b);return this.gf.B7d(b)}cXf(b){this.Ic.cr=this.Ah(this.Ic.cr);
return this.gf.cXf(b)}jXf(b){this.Ic.cs=this.Ah(this.Ic.cs);this.hi(b);return this.gf.jXf(b)}J7d(b){this.Ic.ct=this.Ah(this.Ic.ct);this.hi(b);return this.gf.J7d(b)}K7d(b){this.Ic.cu=this.Ah(this.Ic.cu);this.hi(b);return this.gf.K7d(b)}M7d(b){this.Ic.cv=this.Ah(this.Ic.cv);this.hi(b);return this.gf.M7d(b)}N7d(b){this.Ic.cw=this.Ah(this.Ic.cw);this.hi(b);return this.gf.N7d(b)}nXf(b){this.Ic.cx=this.Ah(this.Ic.cx);return this.gf.nXf(b)}O7d(b){this.Ic.cy=this.Ah(this.Ic.cy);this.hi(b);return this.gf.O7d(b)}R7d(b){this.Ic.cz=
this.Ah(this.Ic.cz);this.hi(b);return this.gf.R7d(b)}T7d(b){this.vl&&(this.vl.goa=!0);this.Ic.da=this.Ah(this.Ic.da);this.hi(b);return this.gf.T7d(b)}qXf(b){this.vl&&(this.vl.goa=!0);this.Ic.db=this.Ah(this.Ic.db);this.hi(b);return this.gf.qXf(b)}M1c(b){this.vl&&(this.vl.goa=!0);this.Ic.dc=this.Ah(this.Ic.dc);this.hi(b);return this.gf.M1c(b)}tXf(b){this.Ic.dd=this.Ah(this.Ic.dd);this.hi(b);return this.gf.tXf(b)}uXf(b){this.Ic.de=this.Ah(this.Ic.de);this.hi(b);return this.gf.uXf(b)}W7d(b){this.vl&&
(this.vl.goa=!0);this.Ic.df=this.Ah(this.Ic.df);this.hi(b);return this.gf.W7d(b)}vXf(b){this.vl&&(this.vl.goa=!0);this.Ic.dg=this.Ah(this.Ic.dg);this.hi(b);return this.gf.vXf(b)}yXf(b){this.Ic.dh=this.Ah(this.Ic.dh);this.hi(b);return this.gf.yXf(b)}a8d(b){this.vl&&(this.vl.goa=!0);this.Ic.di=this.Ah(this.Ic.di);this.hi(b);return this.gf.a8d(b)}b8d(b){this.Ic.dj=this.Ah(this.Ic.dj);this.hi(b);return this.gf.b8d(b)}c8d(b){this.Ic.dk=this.Ah(this.Ic.dk);this.hi(b);return this.gf.c8d(b)}d8d(b){this.vl&&
(this.vl.gOc=!0);this.Ic.dl=this.Ah(this.Ic.dl);this.hi(b);return this.gf.d8d(b)}h8d(b){this.Ic.dm=this.Ah(this.Ic.dm);this.hi(b);return this.gf.h8d(b)}e8d(b){this.Ic.dn=this.Ah(this.Ic.dn);this.lvi&&this.hi(b);return this.gf.e8d(b)}get lvi(){if(null!=this.MBg)var b=this.MBg;else{var h;b=this.MBg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForUnknownElementsEnabled",!1)}return b}p2m(b){var h,u,B;v.AFrameworkApplication.le("ec3e8394;h715g427");
null!==(h=this.vl)&&void 0!==h&&h.dwi&&(h=b.cssText)&&(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),this.vl.nSf+=null!==(u=null===b||void 0===b?void 0:b.length)&&void 0!==u?u:0,this.vl.oSf+=null!==(B=null===h||void 0===h?void 0:h.length)&&void 0!==B?B:0)}hi(b){const h=b.mf;if(h&&this.vl){var u=h.tagName.toLowerCase();this.p2m(h.style);if(this.Mhk&&this.Hui(u)||this.Nhk&&!this.Hui(u)||this.vl.kvi)if("font"===u&&this.Qyn(b),h.style&&(b=h.style)){0===b.length&&this.vl.KTc(h.tagName,"no style present");
for(const B of b)B&&0<B.length&&this.vl.KTc(h.tagName,B)}}}Qyn(b){if((b=b.mf)&&"font"===b.tagName.toLowerCase()&&this.vl){var h=b.getAttribute("face");h&&0<h.length&&this.vl.KTc(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.vl.KTc(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.vl.KTc(b.tagName,"font-attr-size")}}Hui(b){return this.jOg.contains(b)}}Object(m.a)(xs,"HtmlEventUsageCollector",null,[184]);class un{constructor(b,h,u=!1){this.mf=b;this.IB=
h;this.sCk=u}}Object(m.a)(un,"TagEventParam",null,[]);class Eo{constructor(b,h=null){this.qjd=this._prunedElements=this.BVe=this._voidElements=null;this.ud=b;this.z3=h||$n.a.K9h("");this.smo()}get Ic(){return this.z3}ugn(b,h,u){this.BVe[h]?this.MQi():(this.Ic.e++,(h=this.qjd[h])&&h(new un(b,u,!1)),this.Ic.b++)}MQi(){this.Ic.d++}pgn(){this.Ic.c++}cgn(b,h,u){if(this.BVe[h])this.MQi();else{if(h=this.qjd[h])return this.Ic.b++,h(new un(b,u,!1));this.Ic.f++;if(this.ud.lvi)return this.ud.e8d(new un(b,null))}return 2}smo(){this._voidElements=
mb.a.Z5("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.BVe=mb.a.Z5("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=mb.a.Z5("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",
!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,h=this.ud,u=this.ud,B=this.ud,Q=this.ud,ca=this.ud,qa=this.ud,Qa=this.ud,rb=this.ud,Lb=this.ud,Yb=this.ud,gc=this.ud,Fc=this.ud,Sc=this.ud,ld=this.ud,Hd=this.ud,Ie=this.ud,fe=this.ud,de=this.ud,ne=this.ud;this.qjd=mb.a.Z5("A",Object(z.a)(this.ud,this.ud.K5d,"onAOpen"),"ABBR",Object(z.a)(this.ud,this.ud.wTf,"onAbbrOpen"),"ACRONYM",Object(z.a)(this.ud,this.ud.xTf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.ud,this.ud.CTf,"onAddressOpen"),
"APPLET",Object(z.a)(this.ud,this.ud.RTf,"onAppletOpen"),"AREA",Object(z.a)(this.ud,this.ud.TTf,"onAreaTag"),"B",Object(z.a)(this.ud,this.ud.P5d,"onBOpen"),"BASE",Object(z.a)(this.ud,this.ud.UTf,"onBaseTag"),"BASEFONT",Object(z.a)(this.ud,this.ud.VTf,"onBasefontTag"),"BDO",Object(z.a)(this.ud,this.ud.WTf,"onBdoOpen"),"BIG",Object(z.a)(this.ud,this.ud.S5d,"onBigOpen"),"BLOCKQUOTE",Object(z.a)(this.ud,this.ud.T5d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.ud,this.ud.jUf,"onBodyOpen"),"BR",Object(z.a)(this.ud,
this.ud.U5d,"onBrTag"),"BUTTON",Object(z.a)(this.ud,this.ud.lUf,"onButtonOpen"),"CAPTION",Object(z.a)(this.ud,this.ud.V5d,"onCaptionOpen"),"CENTER",Object(z.a)(this.ud,this.ud.W5d,"onCenterOpen"),"CITE",Object(z.a)(this.ud,this.ud.Z5d,"onCiteOpen"),"CODE",Object(z.a)(this.ud,this.ud.$5d,"onCodeOpen"),"COL",Object(z.a)(this.ud,this.ud.yUf,"onColTag"),"COLGROUP",Object(z.a)(this.ud,this.ud.zUf,"onColgroupOpen"),"DD",Object(z.a)(this.ud,this.ud.g6d,"onDdOpen"),"DEL",Object(z.a)(this.ud,this.ud.h6d,"onDelOpen"),
"DFN",Object(z.a)(this.ud,this.ud.k6d,"onDfnOpen"),"DIR",Object(z.a)(this.ud,this.ud.l6d,"onDirOpen"),"DIV",Object(z.a)(this.ud,this.ud.n6d,"onDivOpen"),"DL",Object(z.a)(this.ud,this.ud.o6d,"onDlOpen"),"DT",Object(z.a)(this.ud,this.ud.q6d,"onDtOpen"),"EM",Object(z.a)(this.ud,this.ud.s6d,"onEmOpen"),"FIELDSET",Object(z.a)(this.ud,this.ud.$Uf,"onFieldsetOpen"),"FONT",Object(z.a)(this.ud,this.ud.z6d,"onFontOpen"),"FORM",Object(z.a)(this.ud,this.ud.gVf,"onFormOpen"),"FRAME",Object(z.a)(this.ud,this.ud.iVf,
"onFrameTag"),"FRAMESET",Object(z.a)(this.ud,this.ud.jVf,"onFramesetOpen"),"H1",Object(z.a)(this.ud,this.ud.C6d,"onH1Open"),"H2",Object(z.a)(this.ud,this.ud.D6d,"onH2Open"),"H3",Object(z.a)(this.ud,this.ud.E6d,"onH3Open"),"H4",Object(z.a)(this.ud,this.ud.F6d,"onH4Open"),"H5",Object(z.a)(this.ud,this.ud.G6d,"onH5Open"),"H6",Object(z.a)(this.ud,this.ud.H6d,"onH6Open"),"HEAD",Object(z.a)(this.ud,this.ud.qVf,"onHeadOpen"),"HR",Object(z.a)(this.ud,this.ud.I6d,"onHrTag"),"HTML",Object(z.a)(this.ud,this.ud.xVf,
"onHtmlOpen"),"I",Object(z.a)(this.ud,this.ud.J6d,"onIOpen"),"IFRAME",Object(z.a)(this.ud,this.ud.zVf,"onIframeOpen"),"IMG",Object(z.a)(this.ud,this.ud.M6d,"onImgTag"),"INPUT",Object(z.a)(this.ud,this.ud.GVf,"onInputTag"),"INS",Object(z.a)(this.ud,this.ud.N6d,"onInsOpen"),"ISINDEX",Object(z.a)(this.ud,this.ud.MVf,"onIsindexOpen"),"KBD",Object(z.a)(this.ud,this.ud.P6d,"onKbdOpen"),"LABEL",Object(z.a)(this.ud,this.ud.R6d,"onLabelOpen"),"LEGEND",Object(z.a)(this.ud,this.ud.T6d,"onLegendOpen"),"LI",Object(z.a)(this.ud,
this.ud.U6d,"onLiOpen"),"LINK",Object(z.a)(this.ud,this.ud.XVf,"onLinkTag"),"MAP",Object(z.a)(this.ud,this.ud.aWf,"onMapOpen"),"MATH",Object(z.a)(this.ud,this.ud.W6d,"onMathOpen"),"MENU",Object(z.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.ud,this.ud.fWf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.ud,this.ud.oWf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.ud,this.ud.pWf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.ud,this.ud.rWf,"onObjectOpen"),"OL",Object(z.a)(this.ud,this.ud.h7d,
"onOlOpen"),"OPTGROUP",Object(z.a)(this.ud,this.ud.tWf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.ud,this.ud.i7d,"onOptionOpen"),"P",Object(z.a)(this.ud,this.ud.m7d,"onPOpen"),"PARAM",Object(z.a)(this.ud,this.ud.AWf,"onParamTag"),"PRE",Object(z.a)(this.ud,this.ud.t7d,"onPreOpen"),"Q",Object(z.a)(this.ud,this.ud.LWf,"onQOpen"),"S",Object(z.a)(this.ud,this.ud.A7d,"onSOpen"),"SAMP",Object(z.a)(this.ud,this.ud.B7d,"onSampOpen"),"SCRIPT",Object(z.a)(this.ud,this.ud.cXf,"onScriptOpen"),"SELECT",Object(z.a)(this.ud,
this.ud.jXf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.J7d,"onSmallOpen"),"SPAN",Object(z.a)(h,h.K7d,"onSpanOpen"),"STRIKE",Object(z.a)(u,u.M7d,"onStrikeOpen"),"STRONG",Object(z.a)(B,B.N7d,"onStrongOpen"),"STYLE",Object(z.a)(Q,Q.nXf,"onStyleOpen"),"SUB",Object(z.a)(ca,ca.O7d,"onSubOpen"),"SUP",Object(z.a)(qa,qa.R7d,"onSupOpen"),"TABLE",Object(z.a)(Qa,Qa.T7d,"onTableOpen"),"TBODY",Object(z.a)(rb,rb.qXf,"onTbodyOpen"),"TD",Object(z.a)(Lb,Lb.M1c,"onTdOpen"),"TEXTAREA",Object(z.a)(Yb,Yb.tXf,"onTextareaOpen"),
"TFOOT",Object(z.a)(gc,gc.uXf,"onTfootOpen"),"TH",Object(z.a)(Fc,Fc.W7d,"onThOpen"),"THEAD",Object(z.a)(Sc,Sc.vXf,"onTheadOpen"),"TITLE",Object(z.a)(ld,ld.yXf,"onTitleOpen"),"TR",Object(z.a)(Hd,Hd.a8d,"onTrOpen"),"TT",Object(z.a)(Ie,Ie.b8d,"onTtOpen"),"U",Object(z.a)(fe,fe.c8d,"onUOpen"),"UL",Object(z.a)(de,de.d8d,"onUlOpen"),"VAR",Object(z.a)(ne,ne.h8d,"onVarOpen"))}}Object(m.a)(Eo,"AHtmlProcessor",null,[]);class Ts{constructor(b,h){this.childNodes=b.childNodes;this.IB=h;this.Dbf=0;this.NYd=!1}}
Object(m.a)(Ts,"HtmlProcessorArguments",null,[]);class ki extends Eo{constructor(b,h=null){super(b,h);this.MFe=null}get KPm(){null==this.MFe&&(this.MFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.MFe}process(b,h=null){b&&(this.ud.reset(),this.G2i(new Ts(b,new Ls.a),h))}G2i(b,h){b.childNodes.length&&(b=new Yt.a(h,Object(z.a)(this,this.XFn,"processChild"),b),b.Ml("HTML Processing Operation"),h||(b.Hh=!0),b.run())}XFn(b,h){const u=
h.childNodes[h.Dbf];if(3===u.nodeType)return this.ud.Q5d(),this.ud.wda(u.nodeValue,new un(u,h.IB.A6h())),ki.Nnc(h);if(1!==u.nodeType)return ki.Nnc(h);if(!h.NYd){const Q=F.a.ZA(u.tagName);if(!ki.vpm(u))if(this._prunedElements[Q])this.pgn();else{ki.k8m(u);this.ud.Q5d();var B=u.id;const ca=u.tagName,qa=h.IB.A6h(),Qa=u.getAttribute?u.getAttribute("class"):null;B=new gn(B,ca,Qa?Qa:"",u.attributes?u.attributes.length:0);B.isValid&&qa.add(B);if(this._voidElements[Q])return this.ugn(u,Q,qa),ki.Nnc(h);B=!1;
switch(this.cgn(u,Q,qa)){case 1:B=!0;break;case 3:return ki.Nnc(h)}switch(this.ud.Mwf(u)){case 1:B=!0}h.NYd=B;this.G2i(new Ts(u,qa),b);if(!b.Hh)return!0}}if(h.NYd){if(this.KPm&&!this.qjd[F.a.ZA(u.tagName)])return ki.Nnc(h);this.ud.onClose()}return ki.Nnc(h)}static k8m(b){3!==b.nodeType&&ed.a.Nl(b,"alreadyPasted",!0)}static vpm(b){return 3!==b.nodeType&&ed.a.Eb(b,"alreadyPasted")}static Nnc(b){b.Dbf++;b.NYd=!1;return b.Dbf<b.childNodes.length}}Object(m.a)(ki,"HtmlProcessor",Eo,[]);var Vx=c(2044),qw=
c(542);const rC={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,
["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,
["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,
["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,
["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,
["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,
["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,
["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,
["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,
["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,
["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,
["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,
["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,
["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,
["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,
["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,["border-right"]:325,["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,
["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,
["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},
Vr={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,
["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,
["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,
["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class jv{constructor(){this.Qw=0;this.qJc=6;this.sHl=this.A1h=!1;this.s7e=null;this.I1h=this.H1h=this.G1h=this.C1h=this.B1h=!1;this.progId=null;this.Alf=this.E1h=this.D1h=this.goa=this.gOc=this.tHl=this.uHl=!1;this.C_i=this.PMb=0;this.lYf=this.platform=null;this.bui=this.C0d=!1;this.oSf=this.nSf=0;this.Mik={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,
["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.Xef=[1,3,4,2,5];this.hvb={}}get vIm(){if(null!=this.KBg)var b=this.KBg;else{var h;b=this.KBg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get wIm(){if(null!=this.LBg)var b=this.LBg;else{var h;v.AFrameworkApplication.le("diei0591;5a40j462");b=this.LBg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent3Enabled",
!1)}return b}get kvi(){if(null!=this.JBg)var b=this.JBg;else{var h;b=this.JBg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get dwi(){if(null!=this.RBg)var b=this.RBg;else{var h;b=this.RBg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get Wie(){if(null!==this.s7e)switch(this.s7e){case "XLO":return"Excel Online"}if(this.I1h)return"Word Online";
if(this.H1h||this.B1h)return"PowerPoint Online";if(this.A1h)return"Excel Online";if(this.C1h)return"Google Docs";if(this.G1h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}GO(b,h){const u=new ha.a;u.name=b;"number"===typeof h?u.int64=h:u.bool=h;return u}Z7c(b,h,u){const B=new qw.a;B.name=b;B.dataFields=h;B.dnmInterval=u;B.dnmAllowedPartA=this.Xef;
ea.a.sendDirectNumericEvent(B)}i3m(){const b=this.eMk();if(this.vIm){var h=[];const u=[this.GO("isUserConsumer",this.C0d),this.GO("isDocumentBlank",this.bui),this.GO("FoundText",this.Alf),this.GO("FoundTable",this.goa),this.GO("FoundImage",this.D1h),this.GO("FoundList",this.gOc),this.GO("FoundLink",this.E1h),this.GO("Browser",this.PMb),this.GO("SourceApp",this.Mik[this.Wie])];for(const B of u)h.push(B);this.Z7c("Office.DNM.Word.Online.ExternalPasteEvent2",h,2)}this.dwi&&(h=[this.GO("NumberOfEm",this.nSf),
this.GO("NumberOfRem",this.oSf)],Object(Fe.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));r.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}z8k(b,h){var u,B;const Q=[];b=this.GO("tag",null!==(u=Vr[b])&&void 0!==u?u:Vr.OTHERS);h=this.GO("style",null!==(B=rC[h])&&void 0!==B?B:rC.OTHERS);B=this.GO("IsUserConsumer",this.C0d);Q.push(b);Q.push(h);Q.push(B);this.Z7c("Office.DNM.Word.Online.ExternalPasteEvent1",Q,2)}A8k(b){var h;const u=[];b=this.GO("tag",null!==(h=Vr[b])&&void 0!==h?h:Vr.OTHERS);
h=this.GO("IsUserConsumer",this.C0d);u.push(b);u.push(h);this.Z7c("Office.DNM.Word.Online.ExternalPasteEvent3",u,2)}j3m(){const b=this.hvb;for(const B in b){var h=B,u=b[B];this.wIm&&this.A8k(h);if(this.kvi)for(const Q of Object.keys(u))this.z8k(h,Q);u&&(u.SourceApp=this.Wie,u.Browser=Vx.a[this.PMb],u.TagName=h,u.OperationId=this.lYf,r.ULS.sendTraceTag(51406242,307,50,JSON.stringify(u)))}}KTc(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.hvb||(this.hvb[b]={}),this.hvb[b][h]=
this.odm(b,h)+1)}odm(b,h){if(!(b&&b.length&&h&&h.length&&this.hvb&&b in this.hvb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.hvb[b])&&h in b?b[h]:0}eMk(){const b={};b.ActionIdFlags=this.Qw;b.SourceApp=this.Wie;b.CopySourceBrowser=this.qJc;b.PasteBrowser=this.PMb;b.IsSameBrowserPaste=this.yRm(this.qJc,this.PMb);b.IsCrossBrowserPaste=this.jIm(this.qJc,this.PMb);b.IsUncategorizedBrowserPaste=this.mUm(this.qJc,this.PMb);b.Platform=this.platform;b.OperationId=this.lYf;return b}yRm(b,h){return 5===
b||6===b?!1:b===h}jIm(b,h){return 6===b?!1:b!==h}mUm(b,h){return 5===b&&5===h}}Object(m.a)(jv,"HtmlContentMetadata",null,[]);var Mu=c(246),Hy=c(1450),mA=c(1069),gu=c(375),Pm=c(139),nA=c(1694),In=c(57),oA=c(158);class En{get eo(){return null!=this.OFg?this.OFg:this.OFg=Ga.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h,u,B,Q,ca,qa){this.L7b=qa;this.l1g=!1;this.Fyj=this.VEe=null;this.gzn=Qa=>{Gj.a.mark(5568);this.rXh(Qa);let rb=this.YMi;if(this.Dyi){const Lb=this.wpj();Lb&&(rb=this.Rnb);
r.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Lb)}Qa.gi(rb);return!0};this.YMi=Qa=>{Gj.a.mark(5569);var rb=new vd.GraphIterator;this.h6a.restore(rb);var Lb=new vd.GraphIterator;this.Nkf.restore(Lb);this.Nkf=null;r.ULS.shipAssertTag(6305489,307,Yc.OutlineElementReader.Bh(rb));r.ULS.shipAssertTag(6305490,307,Yc.OutlineElementReader.Bh(Lb));gf.OutlineElementNavigator.Ce(rb);var Yb=me.ParagraphReader.kh(rb)?me.ParagraphReader.textLength(rb.currentNode):0;gf.OutlineElementNavigator.Wd(rb);
gf.OutlineElementNavigator.Ce(Lb);r.ULS.shipAssertTag(6305491,307,me.ParagraphReader.kh(Lb));var gc=me.ParagraphReader.textLength(Lb.currentNode);gf.OutlineElementNavigator.Wd(Lb);let Fc=this.C9c;var Sc=new sk.a;Sc.jd(rb);gf.OutlineElementNavigator.$r(Sc,!1,!1);var ld=Sc.currentNode===Lb.currentNode,Hd=!!this.xi&&!!(this.xi.Qw&8192);let Ie=!1;if(!Hd&&this.xi.Ad&&Object(Cb.a)(Od.DictionaryPropertySet,this.xi.Ad)){var fe=this.xi.Ad.rf($c.a.QMb);Hd=fe&&""!==fe?!0:!1}fe=!1;this.xi.Ad instanceof Mu.APropertySet&&
(fe=this.xi.Ad.ja($c.a.F4,!1));if(ld){Yb=vd.GraphIterator.eb(rb.currentNode);me.ParagraphReader.At(gf.OutlineElementNavigator.Ce(Yb))||(rb=Lb);rb.currentNode.id!==Lb.currentNode.id&&(r.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Lf.ListItemReader.jg(rb),Lf.ListItemReader.jg(Lb)),Hd=En.Yf.merge(rb,Lb,!0,Hd),r.ULS.shipAssertTag(6305492,307,Hd));Lb=rb;var de=!0}else{ld=!!(this.xi.Qw&4);de=this.Pd.tg&&ld&&this.xi.P3a;var ne=
!!(this.xi.Qw&262144);this.TZf&&this.xi&&!ld&&!ne&&(this.TZf.hli(rb,!1),this.TZf.hli(Lb,!0));gf.OutlineElementNavigator.Ce(Sc);ld=me.ParagraphReader.kh(Sc)?me.ParagraphReader.textLength(Sc.currentNode):0;gf.OutlineElementNavigator.Wd(Sc);In.a.sr&&this.xi.Qw&65536||this.IEk(Sc,rb,Lb);ne=new sk.a;ne.jd(Sc);gf.OutlineElementNavigator.$r(ne,!1,!1);ne.currentNode.id===Lb.currentNode.id&&(this.l1g=!0);if(this.nX.RNa||this.Tpo)if(ne.Cn.id!==Lb.Cn.id){for(;Sc.currentNode.id!==Lb.currentNode.id;)gf.OutlineElementNavigator.Ce(Sc,
!1),this.nX.jIa(Je.a.create(Sc.currentNode)),Sc.rc(),gf.OutlineElementNavigator.$r(Sc,!1,!1);Sc.jd(rb);gf.OutlineElementNavigator.$r(Sc,!1,!1)}else Ie=!0;this.EZ&&({C9c:Fc,jwa:Sc}=this.EZ.V1f(rb,Lb,Fc,Sc));oA.a.aL&&this.L7b&&(Sc=this.L7b.V1f(rb,Lb,Sc));if(this.xi.lde&&(r.ULS.shipAssertTag(6305493,307,this.xi.Occ),ne=new vd.GraphIterator,ne.jd(Sc),ne=gf.OutlineElementNavigator.Ce(ne))){var ye=this.xi.lde.yf(ne.qa.J(0));ne.qa.J(0).formatting=ye}ne=0;Hd&&this.YMe&&(ne=1);ye=this.sqo(rb,Sc,ne);this.xi.rje=
null;if(this.xi.Gja||this.xi.iVa)this.xi.rje=this.Tcm(ye?rb.currentNode:Sc.currentNode,ye);var Vf=!1;ye&&(Vf=Lf.ListItemReader.jg(rb),r.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Vf,Lf.ListItemReader.jg(Lb)),this.VEe=Vf=En.Yf.merge(rb,Sc,!0,Hd,Lb,void 0,Ie,de,this.YMe),this.tqo(rb,ne)&&this.ban(rb,Lb,ne,Hd));ne=En.uzn.vzm(rb,Sc,Lb,Yb,Vf,this.EVc);var Og=!1;if(Fc){const Bl=new sk.a;Bl.jd(Lb);gf.OutlineElementNavigator.X0(Bl,
!1,!1);Og=Lf.ListItemReader.jg(Bl);const sm=Lf.ListItemReader.jg(Lb),op=fe;r.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",op);de=En.Yf.merge(Bl,Lb,!0,Hd,void 0,!0,void 0,de,this.YMe,op);r.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Og,sm,de?"True":"False, will cause IP to reset to zero.");Lb=(Og=de)?Bl:Lb}else de=!1,r.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");
this.nX.RNa&&Ie&&(ye&&!this.FKm(ne,Vf)?(Sc=new vd.GraphIterator,Sc.jd(rb),rb=gf.OutlineElementNavigator.Ce(Sc),this.nX.cra(rb,Yb,Yb+ld)):Fc&&!this.lNm(ne,Og)?(rb=new vd.GraphIterator,rb.jd(Sc),rb=gf.OutlineElementNavigator.Ce(rb),this.nX.cra(rb,0,ld)):(rb=new vd.GraphIterator,rb.jd(Sc),rb=gf.OutlineElementNavigator.Ce(rb),this.nX.jIa(Je.a.create(rb))));this.RCn(ne);this.r9&&!Hd&&this.MH.RGn(ne)}r.ULS.shipAssertTag(6305494,307,Lb.isValid);Hd=gf.OutlineElementNavigator.Ce(Lb);gc=de?me.ParagraphReader.textLength(Hd)-
gc:0;this.xi.t1a=fe?Cg.SelectionFactory.gJ(Hd,gc-1,gc):Cg.SelectionFactory.ne(Hd,gc);this.xi&&this.xi.Occ&&me.ParagraphReader.Wb(Hd)&&this.xi.B8d&&((gc=this.xi.B8d.hCo)&&this.qE.YJ(gc,Hd,!0),(gc=this.xi.B8d.ayn)&&this.il.lth(Hd,gc));Qa.gi(this.Rnb);return!0};this.Rko=Qa=>{const rb=vd.GraphIterator.eb(this.Fyj);rb.zJ(1);this.xi.t1a=Cg.SelectionFactory.oo(rb.currentNode,!1);Qa.gi(this.Rnb);return!0};this.Rnb=()=>{var Qa=void 0===this.xi.Qw||null===this.xi.Qw?"not available":Object(Hy.a)(nA.a,this.xi.Qw);
r.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.xi.Qw,Qa);r.ULS.shipAssertTag(6305497,307,!!this.xi.t1a);this.EVc?Object(Fe.a)("ExternalPasteAction",!0):Object(Fe.a)("InternalPasteAction",!0);this.h6a&&(Qa=new vd.GraphIterator,this.h6a.restore(Qa),this.h6a=null,this.Jom(Qa));this.transaction.dispose();lo.a.bRa&&lo.a.q4m();Qa=this.eu.gu;if(!Qa.qe||!Qa.ve.Vj)return!1;Qa.ve.TFo();return!1};this.YFa=b;this.Nkf=this.h6a=null;this.xi=h;this.transaction=u;this.EZ=B;this.eu=Q;this.W6=ca}get K(){return v.AFrameworkApplication.K}get YMe(){return!!this.K&&
this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get MH(){return null!=this.Fyg?this.Fyg:this.Fyg=Ga.a.instance.resolve("Box4.IFontStylesGalleryCache")}get r9(){return this.eo&&this.eo.r9}get qE(){return null!=this.fIg?this.fIg:this.fIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get uc(){return null!=this.IIg?this.IIg:this.IIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get il(){return null!=this.lEg?this.lEg:this.lEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get Fd(){return null!=
this.TCg?this.TCg:this.TCg=Ga.a.instance.resolve("Box4.List.IListReader")}get Jn(){return null!=this.FCg?this.FCg:this.FCg=Ga.a.instance.resolve("Box4.List.IListEditor")}get sR(){return null!=this.pzg?this.pzg:this.pzg=Ga.a.instance.resolve("Box4.IBox4GraphWriter")}get o$c(){return null!=this.sFg?this.sFg:this.sFg=Ga.a.instance.Oa("Box4.List.ISingleLevelListEditor")}get Bj(){return null!=this.YGg?this.YGg:this.YGg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Dh(){return null!=
this.xHg?this.xHg:this.xHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Pd(){return null!=this.gHg?this.gHg:this.gHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get nX(){return null!=this.jvg?this.jvg:this.jvg=Ga.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get TZf(){return null!=this.xEg?this.xEg:this.xEg=Ga.a.instance.Oa("Box4.IPastedParagraphSpaceHandler")}get K_i(){return!1}sXh(){}get EVc(){return!1}w_i(b){var h=
void 0===this.xi.Qw||null===this.xi.Qw?"not available":Object(Hy.a)(nA.a,this.xi.Qw);r.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.xi.Qw,h);r.ULS.shipAssertTag(6305487,307,Ge.SelectionEditor.ef(this.YFa));if(this.i5d)return r.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.xi.t1a=Cg.SelectionFactory.Tn(this.YFa),b.gi(this.Rnb),!0;if(!this.YFa.node)return r.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new vd.GraphIterator;
h.set(this.YFa.node);Ge.SelectionEditor.yu(h);gf.OutlineElementNavigator.Wd(h);this.Fyj=h.origin;if(this.K_i)return h.ot(10),this.sXh(h,b),b.gi(this.Rko),!0;this.EZ&&this.EZ.ajn(this.YFa);if(!this.bzo(this.YFa))return this.xi.$R&&(this.xi.$R.fail("SplitLine Failed",!0),this.xi.failed=!0),this.xi.t1a=Cg.SelectionFactory.Tn(this.YFa),b.gi(this.Rnb),!0;const u=new sk.a;u.jd(h);gf.OutlineElementNavigator.$r(u,!1,!1);this.h6a=new mA.a(h);this.Nkf=new mA.a(u);b.gi(this.gzn);return!0}wpj(){return!1}get Dyi(){return this.K.$("PptCcpFix2IsEnabled")}get Tpo(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}FKm(b,
h){return!h&&!!b&&Yc.OutlineElementReader.Bh(b.jwa)&&Yc.OutlineElementReader.Qfb(b.jwa)}lNm(b,h){return!h&&!!b&&Yc.OutlineElementReader.Bh(b.Dlb)&&Yc.OutlineElementReader.Qfb(b.Dlb)}RCn(b){En.s1i&&b&&En.s1i.NGn(b)}sqo(b,h,u){var B;Lf.ListItemReader.jg(b)?(null===(B=this.o$c)||void 0===B?void 0:B.Rzf(b),h=Lf.ListItemReader.jg(h)?this.Qoj:!0):Yc.OutlineElementReader.isEmpty(b,!0)&&!u?(En.Yf.R0a(b),h=!1):h=!0;this.EZ&&(h=this.EZ.aVk(b,h));return h}tqo(b,h){return Lf.ListItemReader.jg(b)||1===h?!0:!1}ban(b,
h,u,B){const Q=Lf.ListItemReader.jg(b);if(Q){if(B=new sk.a,B.jd(b),gf.OutlineElementNavigator.$r(B,!1,!1),B.Cn.id!==h.Cn.id){u=this.Fd.tw(b);this.Fd.BP(b);var ca=b.currentNode.ja(Jc.a.listID,0);b.rc();var qa=this.Fd.hsj,Qa=!0;for(u.dC=nj.a.qm;B.currentNode.id!==h.currentNode.id;){if(!qa||!Yc.OutlineElementReader.Xro(B))if(!Lf.ListItemReader.jg(B))Pm.a.getInstance().Nv?(Yc.OutlineElementReader.$$b(B)||({gxa:u}=this.Jn.Gma(u.propertySet,B,u)),this.Jn.i6()):{gxa:u}=this.Jn.Gma(u.propertySet,B,u),Qa=
!1;else if(Q){Qa=this.Fd.Nqf(B);var rb=this.Fd.Lx(b.currentNode,ca,Qa);rb=rb?gu.a.p8(rb,null):u;Qa=gu.a.V_(rb.listType,u.listStyle,null,0,Qa,"","");Qa.Pmb=b.currentNode;this.Jn.wjo(Qa);this.Jn.pge(B,!0);Qa=!1}gf.OutlineElementNavigator.$r(B,!1,!1)}qa&&Qa&&this.Jn.SGk()}}else if(1===u)for(u=new sk.a,u.jd(b),gf.OutlineElementNavigator.Ce(u),b=me.ParagraphReader.kh(u)?u.currentNode:null,ca=this.uc.Btf(u),gf.OutlineElementNavigator.Wd(u),gf.OutlineElementNavigator.$r(u,!1,!1);u.currentNode.id!==h.currentNode.id;)gf.OutlineElementNavigator.Ce(u),
qa=me.ParagraphReader.kh(u)?u.currentNode:null,gf.OutlineElementNavigator.Wd(u),qa&&b&&B&&(ca&&this.qE.YJ(ca,qa,!0),this.W6.iNi(b,qa,Q),this.W6.LGa(b,qa,1,!0)),gf.OutlineElementNavigator.$r(u,!1,!1)}IEk(b,h,u){var B=!1;if(this.Pd.tg)if(In.a.sr)B=!0;else{var Q=!1;this.EZ&&(Q=h.currentNode,Q=this.EZ.NPm(Q)||this.EZ.CFf(Q));Q?this.Pd.c6a=4:B=!0}if(B){for(;b.currentNode!==u.currentNode;){gf.OutlineElementNavigator.Ce(b,!1);B=this.Dh.B$c(Je.a.create(b.currentNode));let ca;({type:ca}=B.gUd()).returnValue&&
this.Pd.Us(ca);for(Q=0;Q<B.length;Q++){let qa;const Qa=({x0d:qa}=B.getContext(Q)).returnValue;qa&&(En.Sp.Imb(Qa,1),this.Bj.Epb(Qa,1,null,!0))}b.rc();gf.OutlineElementNavigator.$r(b,!1,!1)}b.jd(h);gf.OutlineElementNavigator.$r(b,!1,!1)}}Tcm(b,h){b=vd.GraphIterator.eb(b);gf.OutlineElementNavigator.Ce(b);return me.ParagraphReader.Wb(b.currentNode)?(h=h?me.ParagraphReader.textLength(b.currentNode):0,Cg.SelectionFactory.ne(b.currentNode,h)):Zi.TableReader.HR(b.currentNode)?Cg.SelectionFactory.Aq(b.currentNode):
null}Jom(b){if(b){if(this.EVc&&Zi.TableReader.hx(b)&&this.l1g){if(null!=this.VEe&&0==this.VEe){var h=new sk.a;h.jd(b);gf.OutlineElementNavigator.$r(h,!1,!1);b.jd(h)}h=zp.a.K1n(b);const u=me.ParagraphReader.fl(h);h&&u&&(this.xi.t1a=Cg.SelectionFactory.ne(u,0),b=vd.GraphIterator.eb(h))}else En.JPm&&zp.a.ozn(b);b&&Zi.TableReader.hx(b)&&qg.returnToContainingCell(b)&&zp.a.xyk(b.currentNode)}else r.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}Too(b,h){const u=new vd.GraphIterator;
u.jd(b);b=gf.OutlineElementNavigator.Ce(u);h=me.ParagraphReader.Wb(b)&&h===me.ParagraphReader.textLength(b);r.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}bzo(b){var h;r.ULS.shipAssertTag(6305498,307,Ge.SelectionEditor.ef(b));if(null===(h=this.sR)||void 0===h?0:h.eqb)return!!this.sR.eqb(b.node,b.cpBegin,{VHl:!0,Fb:b.Fb,Sb:b.Sb});h=vd.GraphIterator.eb(b.node);var u=h.rd();gf.OutlineElementNavigator.Wd(h);u&&b.isValid||r.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",
{["tryToRootAtOutlineAncestorSuccess"]:u,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Yc.OutlineElementReader.Bh(h)&&(r.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;u=En.Yf.Zoa(h,!0);const B=this.Too(h,b.cpBegin);En.Yf.G$(h,u,b,!1,!1,!0,B);return!0}static get Sp(){return null!=En.xzg?En.xzg:En.xzg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get wi(){return Df.PageReader.instance}static get Yf(){return null!=
En.xDg?En.xDg:En.xDg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}static get vp(){return Pm.a.getInstance()}static get Zb(){return null!=En.Oxg?En.Oxg:En.Oxg=Ga.a.instance.Oa("Box4.IFeatureHelper")}static get s1i(){return null!=En.DEg?En.DEg:En.DEg=Ga.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get uzn(){return null!=En.wEg?En.wEg:En.wEg=Ga.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get JPm(){null==this.LFe&&(v.AFrameworkApplication.le("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),
this.LFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.LFe}}En.LFe=null;Object(m.a)(En,"APasteExecutionManager",null,[]);class zB{constructor(b){this.Pj=b}reset(){this.Pj.reset()}get FKc(){return this.Pj.FKc}wda(b,h){this.Pj.wda(b,h)}vda(b){this.Pj.vda(b)}snb(b){this.Pj.snb(b)}hya(b){this.Pj.hya(b)}cHa(b){this.Pj.cHa(b)}kSa(b,h){this.Pj.kSa(b,h)}jSa(){this.Pj.jSa()}fE(b){this.Pj.fE(b)}tF(){this.Pj.tF()}nnb(){this.Pj.nnb()}mnb(){this.Pj.mnb()}lya(b){this.Pj.lya(b)}jya(){this.Pj.jya()}hHa(b){this.Pj.hHa(b)}kya(){this.Pj.kya()}L5a(b){this.Pj.L5a(b)}R9(b){this.Pj.R9(b)}P9(){this.Pj.P9()}k5(b){this.Pj.k5(b)}Q9(){this.Pj.Q9()}O9(b){this.Pj.O9(b)}N9(){this.Pj.N9()}pSa(b,
h){this.Pj.pSa(b,h)}J5a(){this.Pj.J5a()}}Object(m.a)(zB,"AHtmlNormalizer",null,[180,181]);class kv extends zB{constructor(b){super(b);this.TJ=!1}wda(b,h){this.TJ?this.jN.FM(()=>{this.h2f(b,h)}):this.h2f(b,h)}h2f(b,h){this.Pj.wda(b,h)}vda(b){this.TJ?this.jN.FM(()=>{this.L1f(b)}):this.L1f(b)}L1f(b){this.Pj.vda(b)}hya(b){this.TJ?this.jN.FM(()=>{this.F3c(b)}):this.F3c(b)}F3c(b){this.Pj.hya(b)}cHa(b){this.TJ?this.jN.FM(()=>{this.J1f(b)}):this.J1f(b)}J1f(b){this.Pj.cHa(b)}kSa(b,h){this.TJ?this.jN.FM(()=>
{this.E1f(b,h)}):this.E1f(b,h)}E1f(b,h){this.Pj.kSa(b,h)}jSa(){this.TJ?this.jN.FM(Object(z.a)(this,this.D1f,"processAnchorEnd")):this.D1f()}D1f(){this.Pj.jSa()}fE(b){this.TJ?this.jN.FM(()=>{this.U1f(b)}):this.U1f(b)}U1f(b){this.Pj.fE(b)}tF(){this.TJ?this.jN.FM(Object(z.a)(this,this.T1f,"processParagraphEnd")):this.T1f()}T1f(){this.Pj.tF()}nnb(){this.TJ?this.jN.FM(Object(z.a)(this,this.X1f,"processPreFormattedTextStart")):this.X1f()}X1f(){this.Pj.nnb()}mnb(){this.TJ?this.jN.FM(Object(z.a)(this,this.W1f,
"processPreFormattedTextEnd")):this.W1f()}W1f(){this.Pj.mnb()}lya(b){this.TJ?this.jN.FM(()=>{this.P1f(b)}):this.P1f(b)}P1f(b){this.Pj.lya(b)}jya(){this.TJ?this.jN.FM(Object(z.a)(this,this.M1f,"processListEnd")):this.M1f()}M1f(){this.Pj.jya()}hHa(b){this.TJ?this.jN.FM(()=>{this.O1f(b)}):this.O1f(b)}O1f(b){this.Pj.hHa(b)}kya(){this.TJ?this.jN.FM(Object(z.a)(this,this.N1f,"processListItemEnd")):this.N1f()}N1f(){this.Pj.kya()}R9(b){this.TJ?this.jN.FM(()=>{this.g2f(b)}):this.g2f(b)}g2f(b){this.Pj.R9(b)}P9(){this.TJ?
this.jN.FM(Object(z.a)(this,this.d2f,"processTableEnd")):this.d2f()}d2f(){this.Pj.P9()}k5(b){this.TJ?this.jN.FM(()=>{this.f2f(b)}):this.f2f(b)}f2f(b){this.Pj.k5(b)}Q9(){this.TJ?this.jN.FM(Object(z.a)(this,this.e2f,"processTableRowEnd")):this.e2f()}e2f(){this.Pj.Q9()}O9(b){this.TJ?this.jN.FM(()=>{this.c2f(b)}):this.c2f(b)}c2f(b){this.Pj.O9(b)}N9(){this.TJ?this.jN.FM(Object(z.a)(this,this.b2f,"processTableCellEnd")):this.b2f()}b2f(){this.Pj.N9()}pSa(b,h){this.TJ?this.jN.FM(()=>{this.R1f(b,h)}):this.R1f(b,
h)}R1f(b,h){this.Pj.pSa(b,h)}J5a(){this.TJ?this.jN.FM(Object(z.a)(this,this.Z2i,"processMathEnd")):this.Z2i()}Z2i(){this.Pj.J5a()}}Object(m.a)(kv,"AQueuingHtmlNormalizer",zB,[]);var rw=c(1986);class cx{constructor(){this.wOe=new rw.a}FM(b){this.wOe.enqueue(b)}flush(b=!1){for(b&&this.Gfe();!this.wOe.isEmpty;)this.wOe.dequeue()();b&&this.Ade()}Gfe(){}Ade(){}}Object(m.a)(cx,"QueuedEventManager",null,[]);class Wr extends cx{constructor(b){super();this.id=void 0;this.Rbf=null;this.GZd=!1;this.tqa="";this.FZd=
this.A_d=!1;this.Hbf=this.G5b=null;this.o0c=0;this.mWc=this.QXc=this.rHf=!1;this.table=null;this.JRf=0;this.ZZ=b}get GFc(){return!!this.table}Gfe(){this.ZZ.Rgc.push(this.ZZ.currentState);this.ZZ.currentState=this}Ade(){this.ZZ.currentState=this.ZZ.Rgc.pop()}}Wr.nextId=void 0;Object(m.a)(Wr,"ContentState",cx,[]);class sC{constructor(b,h,u){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.n4a=b.n4a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.cka=b.cka;this.qke=b.qke;this.odc=b.odc;this.a8=b.a8;this.contents=u;this.$jm=h}}Object(m.a)(sC,"TableCell",null,[]);var pA=c(1695),Nu=c(1696);class Iy extends cx{constructor(b,h){super();this.ZZ=b;this.ghh=new Ls.a;this.Tka=new Ls.a;this.JJe=[];this.Zud=[];this.BKa=-1;this.iWa=0;this.f6j=h.iCf;this.e6j=h.yGm;this.Ijk=h.njg;this.Lp=h.width;this.a1g=h.n4a;this.k3j=new fr.a(new gn(h.V9.Vni,h.V9.UVd),h.IB,h.uya,h.cultureName,h.HCa);this.Z4j=h.GWd;this.Bxd=h.styleId;this.Njk=h.tableLook}get Pj(){return this.ZZ.Pj}kEn(b){this.BKa++;
this.ghh.add(b);this.Zud[this.BKa]=b.height;this.iWa=0}get Sel(){for(;this.iWa>=this.Tka.count;)this.Tka.add(Array(this.BKa+1));return this.Tka.J(this.iWa)}tpk(b,h,u,B,Q,ca,qa){if(0>this.BKa)return!1;for(;this.JJe[this.iWa]>=this.BKa;)this.iWa++;b=new sC(b,new fr.a(h,u,B,Q,ca),qa);this.Sel[this.BKa]=b;if(1<b.rowSpan)for(h=this.BKa+b.rowSpan-1,B=this.iWa,u=this.iWa+b.colSpan-1;B<=u;B++)this.JJe[B]>=h||(this.JJe[B]=h);this.iWa+=b.colSpan;this.Zud[this.BKa]<b.height&&(this.Zud[this.BKa]=b.height);return!0}Gfe(){this.ZZ.currentState.table=
this}Ade(){this.ZZ.currentState.table=null}e0h(){v.AFrameworkApplication.le("fd8b6402;j6e17681");this.flush(!0);const b=this.BKa+1;var h=Array(b);for(var u=0;u<b;u++)h[u]=Array(this.Tka.count);u=!0;var B=0;for(var Q=0;Q<this.Tka.count;Q++){var ca=this.Tka.J(Q),qa=!0;for(var Qa=0;Qa<b;Qa++){var rb=ca[Qa];rb&&(qa=!1,h[Qa][Q+B]=new gw(rb.colSpan,rb.rowSpan,rb.width,rb.height,void 0,void 0,void 0,void 0,rb.n4a,rb.odc))}qa?(this.Tka.removeAt(Q),Q--,++B):u=!1}if(!u){(h=this.a1g?this.ZZ.Bzh(h,this.Lp/100):
this.ZZ.Bzh(h,1,this.Lp))&&h.length!==this.Tka.count&&(h=null);this.ZZ.khb(!0);this.ZZ.HFd();this.Pj.R9(new bl(b,this.Tka.count,this.Lp,this.a1g,h,this.f6j,this.e6j,this.Ijk,this.Z4j,this.Bxd,this.Njk,this.k3j));for(h=0;h<b;h++){u=this.ghh.J(h);this.Pj.k5(new yq(this.Zud[h],new fr.a(u.V9,u.IB,u.uya,u.cultureName,u.HCa)));for(u=0;u<this.Tka.count;u++){B=this.Tka.J(u)[h];var Lb=!!this.Bxd&&""!==this.Bxd&&"Custom"!==this.Bxd;Q=B?B.colSpan:0;ca=B?B.rowSpan:0;B&&(Q=Math.min(B.colSpan,this.Tka.count-u),
ca=Math.min(B.rowSpan,b-h));qa=B?B.width:0;Qa=B?B.height:0;rb=B?B.a8:0;const Yb=B?B.n4a:!1,gc=B&&(65536&rb||!Lb)?B.shadingColor:"",Fc=B?B.verticalAlignment:0,Sc=B?B.odc:!1;Lb=B?this.ZZ.F4l(B.cka,u,h,this.Tka,Lb,B.a8):new pA.a;const ld=B?B.qke:new Nu.a,Hd=B?B.$jm:null;this.Pj.O9(new gw(Q,ca,qa,Qa,gc,Fc,Lb,ld,Yb,Sc,rb,new fr.a(Hd?Hd.V9:null,Hd?Hd.IB:null,Hd?Hd.uya:null,Hd?Hd.cultureName:null,Hd?Hd.HCa:null)));B&&!B.odc&&(B.contents.Gfe(),B.contents.flush(),this.ZZ.khb(!1),this.ZZ.HFd(),B.contents.Ade());
this.Pj.N9()}this.Pj.Q9()}this.Pj.P9();this.ZZ.currentState.mWc=!1;this.ZZ.kWh(!1)}}}Object(m.a)(Iy,"NormalizedTable",cx,[]);class qA{constructor(b=!1,h=!1){this.P6j=b;this.hma=h}get yMm(){return this.P6j}get W7a(){return this.hma}}Object(m.a)(qA,"HtmlNormalizerSettings",null,[183]);class sw extends kv{constructor(b,h=null){super(b);this.EGe=null;this.Rgc=new Dv;this.eXb=h||new qA}reset(){super.reset();this.currentState=new Wr(this);this.Rgc.clear();this.TJ=!1}get jN(){return this.currentState&&this.currentState.GFc?
this.currentState.table:this.currentState}aMd(b=!1){this.currentState.GZd||(this.HFd(),this.Pj.fE(this.currentState.Rbf),this.currentState.GZd=!0,this.currentState.mWc=!1);b||!this.currentState.G5b||this.currentState.FZd||(this.Pj.kSa(this.currentState.G5b,this.currentState.Hbf),this.currentState.FZd=!0)}CMc(){this.currentState.FZd&&(this.Pj.jSa(),this.currentState.FZd=!1)}cvl(){this.currentState.GZd&&(this.Pj.tF(),this.currentState.GZd=!1,this.currentState.tqa="")}kWh(b){this.currentState.QXc&&(this.currentState.mWc?
b||(this.Pj.fE(null),this.Pj.tF(),this.Pj.kya(),this.currentState.QXc=!1):(this.Pj.kya(),this.currentState.QXc=!1,this.currentState.mWc=!0))}khb(b){this.CMc();this.cvl();this.kWh(b)}Iun(b){this.Pj.lya(new $i.a(2,1,b));this.currentState.o0c++;this.currentState.rHf=!0}HFd(){!this.currentState.QXc&&this.currentState.rHf&&(this.Pj.jya(),this.currentState.o0c--,this.currentState.rHf=!1)}h2f(b,h){b=this.ufn(b);if(""!==b)if(this.aMd(),this.currentState.A_d)this.i2f(b,h);else{b=b.split(sw.qOk);for(let u=
0;u<b.length-1;u++)this.i2f(b[u],h),this.Pj.snb(h);this.i2f(b[b.length-1],h)}}R1f(b,h){""!==b&&(this.aMd(),this.Pj.pSa(b,h))}L1f(b){this.eXb.W7a||this.CMc();this.aMd(!0);this.Pj.vda(b)}J1f(b){this.currentState.GFc||this.Pj.cHa(b)}F3c(b){this.currentState.G5b&&(b.href=this.currentState.G5b);super.F3c(b)}E1f(b,h){this.CMc();this.currentState.G5b=b;this.currentState.Hbf=h}D1f(){this.CMc();this.currentState.G5b=null;this.currentState.Hbf=null}U1f(b){this.currentState.Rbf=b;this.khb(!0)}T1f(){this.currentState.Rbf=
null;this.khb(!0)}X1f(){this.currentState.A_d=!0}W1f(){this.currentState.A_d=!1}P1f(b){this.khb(!1);this.HFd();this.Pj.lya(b);this.currentState.o0c++}M1f(){this.khb(!1);this.Pj.jya();this.currentState.o0c--}O1f(b){this.khb(!1);this.currentState.o0c||this.Iun(b);this.Pj.hHa(b);this.currentState.QXc=!0;this.currentState.mWc=!0}N1f(){this.khb(!1)}R9(b){this.currentState.GFc||(this.TJ=!0,this.currentState.table=new Iy(this,b))}g2f(){}P9(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.Rgc.isEmpty?(this.TJ=!1,b.e0h()):this.jN.FM(Object(z.a)(b,b.e0h,"flushTable"))}}d2f(){}k5(b){this.currentState.GFc&&this.currentState.table.kEn(b)}f2f(){}Q9(){}e2f(){}O9(b){let h=!1;if(this.currentState.GFc){const u=new Wr(this);this.currentState.table.tpk(b,new gn(b.V9.Vni,b.V9.UVd),b.IB,b.uya,b.cultureName,b.HCa,u)?(this.Rgc.push(this.currentState),this.currentState=u):h=!0}else h=!0;h&&this.currentState.JRf++}c2f(){}N9(){0<this.currentState.JRf?this.currentState.JRf--:this.currentState=
this.Rgc.pop()}b2f(){}Bzh(b,h=1,u=0){if(!b)return null;const B=b.length;if(!B)return null;const Q=b[0].length;for(var ca=1;ca<B;ca++)if(b[ca].length!==Q)return null;ca=Array(Q+1);ca[0]=0;const qa=Array(Q+1);for(var Qa=0;Qa<qa.length;Qa++)qa[Qa]=!1;const rb=new zb.a;Qa=0;for(let Yb=0;Yb<Q;Yb++){for(var Lb=0;Lb<B;Lb++){const gc=b[Lb][Yb];if(gc&&0<gc.width){const Fc=Math.min(Yb+gc.colSpan,Q);ca[Fc]=ca[Yb]+gc.width*(gc.n4a?h:1);qa[Fc]=!0}}if(qa[Yb+1]){Lb=ca[Yb+1]-ca[Yb];if(0>=Lb)return null;rb.add(Lb)}else ca[Yb+
1]=ca[Yb],0<u&&this.QBi&&(rb.add(-1),Qa++)}b=rb.toArray();if(0<Qa&&0<u&&this.QBi)for(r.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),u=(u-ca[ca.length-1])/Qa,h=0;h<b.length;h++)-1===b[h]&&(b[h]=u);return b}get QBi(){null==this.EGe&&(v.AFrameworkApplication.le("2i46g603;2fc7g589"),this.EGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.EGe}T8m(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}F4l(b,h,u,B,Q,ca){if(!b)return null;Q&&(b=this.T8m(b,ca));if(0>u||0>h||h>B.count-1)return b;0<=h-1&&u<=B.J(h-1).length-1&&1===b.borderLeftStyle&&(Q=B.J(h-1)[u])&&1!==Q.cka.borderRightStyle&&(b.borderLeftStyle=Q.cka.borderRightStyle,b.borderLeftColor=Q.cka.borderRightColor,b.borderLeftWidth=Q.cka.borderRightWidth);0<=u-1&&u<=B.J(h).length-1&&1===b.borderTopStyle&&(h=B.J(h)[u-
1])&&1!==h.cka.borderBottomStyle&&(b.borderTopStyle=h.cka.borderBottomStyle,b.borderTopColor=h.cka.borderBottomColor,b.borderTopWidth=h.cka.borderBottomWidth);return b}ufn(b){this.currentState.A_d||(b=this.eXb.yMm?b.replace(sw.Qtm," "):b.replace(sw.Ptm," "));b.startsWith(" ")&&(this.currentState.tqa.endsWith(" ")||""===this.currentState.tqa)&&(b=F.a.substring(b,1,b.length));return b}i2f(b,h){""!==b&&(this.Pj.wda(b,h),this.currentState.tqa+=b)}}sw.Ptm=RegExp("[ \t\f\u200b\r\n]+","g");sw.Qtm=RegExp("[ \f\u200b\r\n]+",
"g");sw.qOk="\t";Object(m.a)(sw,"DefaultHtmlNormalizer",kv,[]);class tz extends sw{constructor(b,h,u){super(b,u);this.WWg=!1;this.mvb=h}static QIm(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=tz.ekl.exec(b))&&0<b.length:!1}F3c(b){this.mvb.uhc&&(v.AFrameworkApplication.Ppa?this.WWg||(b=new mg.StandardDialog,b.Cd=0,b.xe(1,CommonUIStrings.l_DialogClose),b.pv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.WWg=!0):this.mvb.pMi?this.mvb.D3d=!0:b.src&&""!==b.src?fa.a.getOrigin(b.src)!==fa.a.getOrigin(window.location.href)||tz.QIm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?v.AFrameworkApplication.va.processAction(Ob.a.F_i,2):b.src.startsWith("webkit-fake-url")?v.AFrameworkApplication.va.processAction(Ob.a.E_i,2):(this.CMc(),this.aMd(!0),this.Pj.hya(b)):v.AFrameworkApplication.va.processAction(Ob.a.H_i,2):v.AFrameworkApplication.va.processAction(Ob.a.G_i,2))}}tz.ekl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(m.a)(tz,"Box4HtmlNormalizer",sw,[]);class AB{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.htmlProcessor=b;this.szf=h;this.pTk=u;this.yJj=B;this.pHl=Q;this.Kao=ca;this.Lao=qa;this.TVd=Qa;this.Itm=rb;this.Ltm=Lb;this.wZc=Yb}}Object(m.a)(AB,"ExecutePasteArguments",null,[]);class Fn extends En{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie){super(h,u,B,Lb,gc,ld,Ie);this.Z2=null;this.nfn=fe=>{this.lmd.aEi(this.Oaa)&&v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.Uhk&&this.lmd.OLo(this.Oaa);fe.gi(this.pEn);return!0};this.pEn=fe=>{if(this.hhk){const de=this.Oaa.getElementsByTagName("style");if(de&&0<de.length){r.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let ne=0;ne<de.length;ne++)this.Xze.A5k(this.Oaa,de[ne]),de[ne]&&(de[ne].parentNode.removeChild(de[ne]),ne--)}}fe.gi(this.N5k);return!0};this.N5k=(fe,de)=>{this.kXe.value.create(de.yJj).process(this.Oaa,fe);(de=Ga.a.instance.Oa("Box4.IFeatureHelper"))&&
de.isFeatureEnabled(11)?fe.gi(this.V4k):fe.gi(this.T2i);return!0};this.V4k=(fe,de)=>{(new zk(de.pTk)).process(this.Oaa,fe);fe.gi(this.T2i);return!0};this.T2i=(fe,de)=>{var ne;if(tl.KWc&&!document.getElementById("FrameContainingPastedDOM")){var ye=window.performance.now(),Vf=document.createElement("iframe");Vf.style.display="none";Vf.style.contain="strict";Vf.setAttribute("sandbox","allow-same-origin");Vf.id="FrameContainingPastedDOM";document.body.appendChild(Vf);lo.a.bRa&&(lo.a.kbf=window.performance.now()-
ye)}Vf=null;tl.KWc&&(Vf=document.getElementById("FrameContainingPastedDOM"));tl.KWc&&Vf instanceof HTMLIFrameElement?(ye=0,lo.a.bRa&&(ye=window.performance.now()),Vf=null===(ne=Vf.contentDocument)||void 0===ne?void 0:ne.querySelector("body"),null===Vf||void 0===Vf?void 0:Vf.appendChild(this.Oaa),lo.a.bRa&&(lo.a.Waj=window.performance.now()-ye),ne=null===Vf||void 0===Vf?void 0:Vf.children,1!==(null===ne||void 0===ne?void 0:ne.length)&&r.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),
de.htmlProcessor.process(1===(null===ne||void 0===ne?void 0:ne.length)?ne[0]:this.Oaa,fe)):de.htmlProcessor.process(this.Oaa,fe);fe.gi(de.szf&&de.szf.uhc?this.HOb:this.wVh);return!0};this.HOb=(fe,de)=>{if(de=de.szf){let ye=!1,Vf=!1,Og=!1,Bl=!1;var ne=-1;const sm=new Od.DictionaryPropertySet,op=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Cb.a)(85,this.xi.Ad)?(ye=this.xi.Ad.ja(Jc.a.fia,!1),ne=this.xi.Ad.ja($c.a.IP,""),Og=this.xi.Ad.ja($c.a.F4,!1),Bl=this.xi.Ad.ja(Xe.a.yxa,!1),op.test(ne)&&
(Vf=!0),ne=this.xi.Ad.ja(Sh.a.Wga,-1)):this.xi.Qw&256&&this.Oaa&&(ye=!0,op.test(this.Oaa.innerHTML)&&(Vf=!0));sm.setValue(Jc.a.fia,ye);sm.setValue($c.a.WXc,Vf);sm.setValue($c.a.F4,Og);sm.setValue(Sh.a.Wga,ne);sm.setValue(Xe.a.yxa,Bl);de.cge(sm);de.BWf();de.Mmb&&(this.xi.bWc=!0,this.xi.Mzf=de.yX,this.xi.aTf=de.Mmb,ye&&!Og&&Fe.c(Ob.a.jyl),v.AFrameworkApplication.va.processAction(Ob.a.HOb,2))}fe.gi(this.wVh);return!0};this.wVh=(fe,de)=>{var ne;fe=0;lo.a.bRa&&(fe=window.performance.now());if(tl.KWc){var ye=
document.getElementById("FrameContainingPastedDOM");ye instanceof HTMLIFrameElement&&(ye=null===(ne=ye.contentDocument)||void 0===ne?void 0:ne.querySelector("body"),(null===ye||void 0===ye?0:ye.firstElementChild)?(r.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===ye||void 0===ye?void 0:ye.removeChild(null===ye||void 0===ye?void 0:ye.firstElementChild)):r.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}lo.a.bRa&&(lo.a.maj=window.performance.now()-
fe);$n.a.b6m(de.yJj);$n.a.l3m(de.Ltm);$n.a.V4m(de.Kao);$n.a.W4m(de.Lao);$n.a.K3m(de.wZc);ne="Others";de.TVd&&(de.TVd.i3m(),de.TVd.j3m(),ne=de.TVd.Wie);$n.a.k3m(de.Itm,ne);$n.a.V2m(de.pHl,ne);return!1};this.Oaa=b;this.Nte=Q;this.BDe=ca;this.WTe=qa;this.kXe=Qa;this.Ovc=rb;this.eXb=Sc;this.Ga=Yb;this.OXg=Object.assign(new pC,{Nbc:2===this.xi.a5b||3===this.xi.a5b});this.Xze=Fc;this.lmd=Hd;this.J_b=Yb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.hhk=Yb.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.Uhk=Yb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get i5d(){return!1}get EVc(){return!0}rXh(b){this.Z2=new vd.GraphIterator;this.h6a.restore(this.Z2);r.ULS.shipAssertTag(6305550,307,Yc.OutlineElementReader.Bh(this.Z2));this.xi.$R&&this.xi.$R.G2b("external");var h=this.xi.Qw&8192?1:0,u=this.BDe.value.create(h,this.Z2,this.xi.hIc,this.xi.Qob);const B=this.WTe.value.create(h,this.Z2),Q=$n.a.d5h(v.AFrameworkApplication.userSessionId),ca=$n.a.Tii(v.AFrameworkApplication.userSessionId),qa=$n.a.Hpf(Z.a.gBb,
this.xi.hIc),Qa=$n.a.xfi(v.AFrameworkApplication.userSessionId),rb=$n.a.yfi(v.AFrameworkApplication.userSessionId),Lb=this.J_b?this.Zym():null,Yb=$n.a.J9h(Z.a.gBb,this.xi.hIc),gc=$n.a.K9h(v.AFrameworkApplication.userSessionId),Fc=this.Ovc.zoj?$n.a.D1l(v.AFrameworkApplication.userSessionId):null;h=this.Nte.value.create(h,this.Z2,u,B,null,qa,this.xAk,this.xi.Wke);h=new dh(h,Qa,rb);h=new tz(h,u,this.eXb);h=new tl(h,this.Ovc,this.OXg,Fc);h=new xs(h,Yb,Lb,this.Ga);h=new ki(h,gc);u=new AB(h,u,Q,ca,qa,Qa,
rb,Lb,Yb,gc,Fc);u=new Yt.a(b,this.nfn,u);u.Ml("paste and request pictures");u.Hh=!b||b.Hh;u.run()}get xAk(){return this.Oaa.getElementsByTagName("a").length}Zym(){const b=new jv;b.PMb=Z.a.gBb;this.xi&&(b.Qw=this.xi.Qw,b.lYf=this.xi.hIc,this.xi.Ad&&(b.progId=this.xi.Ad.ja($c.a.D_i,"")));this.Oaa&&this.Oaa.innerHTML&&(b.C_i=this.Oaa.innerHTML.length,lo.a.bRa&&(lo.a.A_i=b.C_i));v.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=v.AFrameworkApplication.sessionStartInfoSettings.Platform,b.C0d=
v.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.bui=me.ParagraphReader.tba(Fb.App.za.jb.qc.ed));return b}get Qoj(){return!0}get C9c(){r.ULS.shipAssertTag(6305551,307,!!this.Z2);if(this.Ovc.Aoj(this.OXg)){var b=!1;Yc.OutlineElementReader.Bh(this.Z2)&&(this.Z2.$X(),b=!0);var h=me.ParagraphReader.kh(this.Z2)&&!this.Z2.currentNode.ja($c.a.nwi,!1);b&&this.Z2.rc();return h}return this.xi.Qw&524288?(b=!1,Yc.OutlineElementReader.Bh(this.Z2)&&(this.Z2.$X(),b=!0),h=me.ParagraphReader.kh(this.Z2),b&&this.Z2.rc(),
h):me.ParagraphReader.kh(this.Z2)}}Object(m.a)(Fn,"ExternalPasteExecutionManager",En,[]);class lv{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc){this.L7b=gc;this.Nte=b;this.BDe=h;this.WTe=u;this.kXe=B;this.Ovc=Q;this.EZ=ca;this.Ga=qa;this.Xze=Qa;this.eXb=rb;this.W6=Lb;this.lmd=Yb}create(b,h,u,B){return new Fn(b,h,u,B,this.Nte,this.BDe,this.WTe,this.kXe,this.Ovc.value,this.EZ,this.Ga,Fb.App.za.jb,this.Xze,this.eXb,this.W6,this.lmd,this.L7b)}}Object(m.a)(lv,"Factory",null,[499]);class Gt{aEi(b){if(!b||
!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.TJm(b.childNodes[h-2])&&this.sVm(b.childNodes[h-1])}OLo(b){this.aEi(b)&&(b.removeChild(b.lastChild),r.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}sHm(b){return!!b&&8===b.nodeType}NTm(b){return!!b&&3===b.nodeType}TJm(b){return this.sHm(b)&&"EndFragment"===b.nodeValue}sVm(b){if(!this.NTm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(m.a)(Gt,"HtmlNormalizerHelper",null,[497]);var hu=c(1974),
tC=c(641);class rA extends En{constructor(b,h,u,B,Q,ca,qa,Qa,rb){super(b,h,u,Q,ca,Qa,rb);this.fA=B;this.fM=qa}get tl(){return this.fM.value}get i5d(){return this.fA.i5d()}get K_i(){const b=this.fA;return b.o9e&&!b.rsi()}sXh(b,h){r.ULS.shipAssertTag(6305616,307,Rj.OutlineReader.ix(b));const u=tC.a(b.currentNode);if(Rj.OutlineReader.isEmpty(b)){var B=Je.a.create(b.currentNode);b.ot(8);v.AFrameworkApplication.va.Kf(B,Ob.a.HH,2,!0,null,null)}else b.ot(8);(B=b.zJ(1))&&b.rc();this.fA.r_i(this.xi.ie,b.currentNode,
B,-1,u,h)}rXh(b){const h=new vd.GraphIterator;this.h6a.restore(h);r.ULS.shipAssertTag(6305618,307,Yc.OutlineElementReader.Bh(h));this.xi.$R&&this.xi.$R.G2b("internal");let u=-1;if(Object(Cb.a)(85,this.xi.Ad))u=this.xi.Ad.ja(Sh.a.Wga,-1);else{const B=this.LSl(h.currentNode);u=B?B.clientWidth:u}this.fA.r_i(this.xi.ie,h.parentNode,h.currentNode,u,null,b);this.Dyi&&(this.h6a.restore(h),Yc.OutlineElementReader.Bh(h)&&this.fA.NBi(h)&&(b=gf.OutlineElementNavigator.Ce(h)))&&(this.xi.t1a=Cg.SelectionFactory.ne(b,
0))}LSl(b){return b?(b=b?b.pe(this.tl.$b):null)?b.htmlElement:null:null}wpj(){const b=new vd.GraphIterator;this.h6a.restore(b);return this.fA.NBi(b)}get Qoj(){return!0}get C9c(){return!this.fA.bwa&&!this.fA.o9e}}Object(m.a)(rA,"InternalPasteExecutionManager",En,[]);class Nh{constructor(b,h,u,B,Q){this.L7b=Q;this.fA=b;this.EZ=h;this.fM=u;this.W6=B}create(b,h,u){return new rA(b,h,u,this.fA,this.EZ,Fb.App.za.jb,this.fM,this.W6,this.L7b)}}Object(m.a)(Nh,"Factory",null,[496]);var dx;(function(b){b[b.unknown=
0]="unknown";b[b.Jep=1]="differentBox4App";b[b.lop=2]="sameBox4AppDifferentSession";b[b.mop=3]="sameBox4AppSameSession"})(dx||(dx={}));Object(m.b)("CopySource",dx);class Ag{constructor(b,h,u,B){this.fA=b;this.iZg=h;this.D0j=u;this.Ik=B}czn(b,h,u){r.ULS.shipAssertTag(6305620,307,!!b);r.ULS.shipAssertTag(6305621,307,Ge.SelectionEditor.ef(h));r.ULS.shipAssertTag(6305622,307,!!u);r.ULS.shipAssertTag(6305623,307,Object(Cb.a)(Qx.a,u.oqa));const B=u.oqa;B.a5b=this.fA.C6h(b);this.y3m(b,B);let Q=!1;In.a.dHd&&
this.Ik.hia(h,Qa=>Q=Qa)&&(B.Qw|=8192,In.a.eHd&&(B.Wke=1,Q||(B.Wke|=2)));const ca=this.OMm(B);var qa=new Qg.GraphTransaction(7,Ob.a.paste);qa.Db(h.node);h.node.uJ().mF.V7(8);ca?(r.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",B.Qw,B.browserName),b=this.iZg.create(h,B,qa)):(r.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",B.Qw,B.a5b,B.browserName),Ag.o3m(b),b=this.D0j.create(b,h,B,qa));u=new Yt.a(u,Object(z.a)(b,b.w_i,"pasteSetup"),null);
u.Ml("Paste");u.run()}OMm(b){return!this.LPm(b)&&3===b.a5b}LPm(b){return 1===(b.Qw&8192?1:0)}ysi(b,h){r.ULS.shipAssertTag(6305624,307,Ge.SelectionEditor.ef(b));r.ULS.shipAssertTag(6305625,307,!!h);r.ULS.shipAssertTag(6305626,307,Object(Cb.a)(Qx.a,h.oqa));const u=new Qg.GraphTransaction(7,Ob.a.BXd);u.Db(b.node);b=this.iZg.create(b,h.oqa,u);h=new Yt.a(h,Object(z.a)(b,b.w_i,"pasteSetup"),null);h.Ml("InternalPasteAtIp");h.run()}y3m(b,h){if(b){let u=!1,B=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?
B=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(u=!0);(u||B)&&r.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",dx[h.a5b],u,B)}}static o3m(b){b&&Ag.Ymk.test(b.innerText)&&r.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Ag.Ymk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(Ag,"PasteCoordinator",null,[]);class uz{constructor(b,
h,u,B,Q){this.jwa=b;this.Dlb=h;this.tzn=u;this.szn=B;this.EVc=Q}}Object(m.a)(uz,"PastedContentsPostProcessorParams",null,[]);class sA{vzm(b,h,u,B,Q,ca){b=this.yWl(b,h,Q);u=this.i0l(u);if(!b||!u)return null;B=this.F7l(b,B,Q);Q=this.E7l(u);return new uz(b,u,B,Q,ca)}yWl(b,h,u){b=u?b:h;if(!Yc.OutlineElementReader.Bh(b))return null;h=new sk.a;h.jd(b);return h}i0l(b){if(!Yc.OutlineElementReader.Bh(b))return null;const h=new sk.a;h.jd(b);gf.OutlineElementNavigator.X0(h,!1,!1);return h}F7l(b,h,u){gf.OutlineElementNavigator.Ce(b);
let B=-1;me.ParagraphReader.kh(b)&&(B=u?h:0);gf.OutlineElementNavigator.Wd(b);return B}E7l(b){gf.OutlineElementNavigator.Ce(b);const h=me.ParagraphReader.kh(b)?me.ParagraphReader.textLength(b.currentNode):-1;gf.OutlineElementNavigator.Wd(b);return h}}Object(m.a)(sA,"PastedContentsPostProcessorHelper",null,[]);var uC=c(800),ex=c(1097),fx=c(1096);class vz{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc=null){this.uqa=b;this.Y9=h;this.lm=u;this.$1i=B;this.ua=Q;this.$5a=ca;this.K=qa;this.hzn=Qa;this.Cda=
rb;this.VGb=Lb;this.mva=Yb;this.mb=gc;this.lia=Fc;this.hOh=100;this.Adc=!1;this.Owe=null;this.uFe=!1;this.Esd=null;this.Uod=this.ILa=!1;this.KEl=(Sc,ld)=>{this.dismissFloatie(ld.cBl)};this.buo=(Sc,ld)=>{this.x9k(Sc,ld)};this.LY=(Sc,ld)=>{ld.property===Xe.a.lastModifiedTime?(r.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.VGb.Obf.contains(Ob.a.Dog)||this.Y3f(ld)):r.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};
this.kMb=(Sc,ld)=>{this.Y3f(ld)};this.Pia=(Sc,ld)=>{ld.ZCf||this.Y3f(ld)};this.VUi=()=>{uC.a.instance.keyCode===Se.a.eAa&&this.Y9.N4i()};this.Szo()}Szo(){this.Y9.Mph(this.buo);this.Y9.sph(this.KEl)}x9k(b,h){var u,B,Q;(null===(B=null===(u=this.mb.hb)||void 0===u?void 0:u.lb)||void 0===B?0:B.KVc)?r.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.$5a.uBf(),1===this.hzn.M9k(h.R2c)?r.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",
h.correlationId):this.showFloatie(b,h)?(this.ILa?this.ILa=!1:this.UVn(),this.r5c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Ob.a.pU(h.QY)||"Unknown",h.correlationId),r.ULS.sendTraceTag(40379588,307,50,b),Fe.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ha.a,{name:"PasteCommand",int64:Ob.a.pU(h.QY)||"Unknown"}),Object.assign(new ha.a,{name:"CorrelationId",string:null===(Q=h.correlationId)||void 0===Q?void 0:Q.toString()})]),this.jSb()):r.ULS.sendTraceTag(575255108,
307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.uFe&&(this.ILa||(this.lia?null===(h=this.mva)||void 0===h?0:h.C0:this.uqa.C0()))&&(b&&(this.$5a.uBf(),this.xCj(),r.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Esd)),this.ILa=!b,this.Tme(),this.lia?v.AFrameworkApplication.va.processAction(Ob.a.sHb,2):this.uqa.dismissFloatie())}UVn(){this.Uod||(this.Owe=this.lm.zd,Me.a.addHandler(this.Owe.container,
"scroll",Object(z.a)(this,this.nPb,"scrollHandler")),this.ua.u_(Object(z.a)(this,this.xja,"resizeHandler")),this.Uod=!0)}xCj(){this.Uod&&(Me.a.removeHandler(this.Owe.container,"scroll",Object(z.a)(this,this.nPb,"scrollHandler")),this.ua.Oda(Object(z.a)(this,this.xja,"resizeHandler")),this.Uod=!1)}jSb(){if(this.lia)this.mva.C0&&v.AFrameworkApplication.va.processAction(Ob.a.sHb,2),v.AFrameworkApplication.va.processAction(Ob.a.a$c,2),this.Adc=!1;else{const b=new fx.a(0,v.AFrameworkApplication.isRtl);
b.location=this.$5a.FPa();this.$5a.LKm(b.location)?this.showFloatie(null,b):this.Y9.IHa(new ex.a(!1))}}xja(){this.lia?(v.AFrameworkApplication.va.processAction(Ob.a.sHb,2),this.zKc()):this.jSb()}nPb(){this.lia?(v.AFrameworkApplication.va.processAction(Ob.a.sHb,2),this.zKc()):this.jSb()}r5c(){this.$1i.cwk(this.VUi);this.Y9.xph(Object(z.a)(this.uqa,this.uqa.LMd,"expandFloatie"));this.Y9.Iph(Object(z.a)(this,this.z_i,"pastedFloatieStatusChange"));this.Cda.hu(this.Pia);this.Cda.Fx(this.kMb);this.Cda.Mo(this.LY)}Tme(){this.$1i.d_n(this.VUi);
this.Y9.W$i(Object(z.a)(this.uqa,this.uqa.LMd,"expandFloatie"));this.Y9.caj(Object(z.a)(this,this.z_i,"pastedFloatieStatusChange"));this.Cda.iV(this.Pia);this.Cda.Pqa(this.kMb);this.Cda.jV(this.LY)}z_i(b,h){this.uFe=h.JVc;h.QY&&(this.Esd=h.QY);h.ofg&&this.uqa.C0()&&this.jSb()}Y3f(b){b.node.loading||this.Y9.IHa(new ex.a(!0))}showFloatie(b,h){h||(h=new fx.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.$5a.FPa());if(!h.location)return!1;this.ILa&&(this.ILa=!1,this.r5c());this.lia?v.AFrameworkApplication.va.processAction(Ob.a.a$c,
2):this.uqa.showFloatie(b,h);return!0}zKc(){if(!this.Adc){const b=new bf.a(3,1,this.hOh,()=>{this.jSb()},215);Bg.a.instance.Xb(b);this.Adc=!0}}}Object(m.a)(vz,"PasteFloatieEventManager",null,[]);class wz{constructor(b,h){this.hk=b;this.uI=h}M9k(b){return An.any(An.where(An.asEnumerable(wz.VCo),h=>this.uI.hXc(h)))?(b=this.hk.Onb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}wz.VCo=[Ob.a.ZSa.toString(),Ob.a.$Sa.toString(),Ob.a.Oya.toString()];Object(m.a)(wz,"PasteFloatieFeatureSetBuilder",null,[]);
class BB{constructor(){this.zya=null;this.phc=0}}Object(m.a)(BB,"PasteFloatieAnchorData",null,[]);class ys{constructor(b,h,u,B,Q,ca=!1){this.zxb=null;this.ib=b;this.aua=h;this.kd=u;this.n2j=B;this.VMe=Q;this.VFe=ca}uBf(){this.zxb=null}FPa(){const b=this.xpf(this.zxb)||this.nzh();if(!b){let h="null",u="null";if(this.zxb&&this.zxb.zya){if(!this.kd.zd)return r.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.zxb.zya).getName();const B=
this.kd.zd.vj(this.zxb.zya);B&&(u=Object.getType(B).getName())}r.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,u)}return b}LKm(b){if(!b)return!1;const h=this.VMe.DFb(),u=this.n2j(this.kd.zd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=u.y&&b.y+b.height<=u.y+u.height}nzh(){if(!this.ib||!this.ib.hb||!this.ib.hb.lb)return r.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),
null;var b=this.ib.hb.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let u=b.node;if(u&&h){do u=this.Gdi(u);while(u&&Object(Cb.a)(wp.AParagraphNode,u)&&!u.characterData.trim().length)}let B="";const Q=Object(Na.a)(wp.AParagraphNode,u);Q&&(B=Q.characterData.length===b.cpBegin||h?Q.characterData.trimEnd():Q.characterData.substring(0,b.cpBegin).trimEnd());h=Q?B.length:b.cpBegin;b=Object.assign(new BB,{zya:Object(Na.a)(134,(Q?Object(Na.a)(134,Q):Object(Na.a)(134,u))||b.node),phc:h});return this.xpf(b)}Gdi(b){const h=new vd.GraphIterator;
if(!b.anchor)return null;h.set(b);if(!h.rd())return null;h.ld(11);return h.AJ()?h.Ub(2):null}xpf(b){if(!b||!b.zya)return null;this.zxb=b;const h=this.kd.zd;if(!h)return r.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.L9h(b,h);if(!b)return null;v.AFrameworkApplication.isRtl&&this.VMe.C0()&&(b.x-=this.VMe.DFb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}L9h(b,h){h=h.pe(b.zya);if(!h)return null;let u=null;if(Object(Cb.a)(wp.AParagraphNode,
b.zya)){const B=Object(Na.a)(105,h);if(!B)return null;try{u=this.aua.E_(b.phc,B,0<b.phc,!1,!1,!1),u.height+=this.VFe?ys.dNn:ys.NEl}catch(Q){r.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",Q),u=null}}else Object(Cb.a)(ik.TableNode,b.zya)&&(u=Object(Na.a)(235,h).Vtf());u||(u=h.getBounds());return u}}ys.NEl=2;ys.dNn=60;Object(m.a)(ys,"PasteFloatiePositionProvider",null,[]);class zs{constructor(b,h){this.rtc=b;this.gXj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get y1h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get kcf(){return CommonUIStrings.l_ClipboardCut}get nNf(){return CommonUIStrings.l_ClipboardCut_Mac}get i$e(){return CommonUIStrings.l_ClipboardCopy}get mNf(){return CommonUIStrings.l_ClipboardCopy_Mac}get QZf(){return CommonUIStrings.l_ClipboardPaste}get oNf(){return CommonUIStrings.l_ClipboardPaste_Mac}get Z9(){return CommonUIStrings.l_ClipboardPasteText}get pNf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get t7e(){return this.gXj}get QDh(){return CommonUIStrings.l_ClipboardExtensionLink}get Cfb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}LXh(){r.ULS.sendTraceTag(8716421,
307,50,null);Qd.a.om(this.t7e,"_blank",void 0,"ClipboardAccessExtensionLink")}Rda(b,h){let u=Z.a.Wk;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(u=Z.a.ri||u);return u?String.format(h,"\u2318"):b}dispose(){this.rtc=null}n4f(b){this.VIh(b)}fZm(b){this.VIh(b)}VIh(b){this.rtc&&this.rtc(b)}}zs.id="CopyPasteShortcutDialog";zs.bxj="CopyPasteText";Object(m.a)(zs,"ACopyPasteShortcutDialog",null,[10]);class CB extends zs{constructor(b,h,u){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=zs.bxj;var B=document.createElement("span");B.innerText=this.y1h;var Q=document.createElement("span");Q.className="UIFontBold";Q.innerText=this.Rda(this.kcf,this.nNf);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.Rda(this.i$e,this.mNf);const qa=document.createElement("span");qa.className="UIFontBold";qa.innerText=this.Rda(this.QZf,this.oNf);h.appendChild(B);h.appendChild(document.createElement("br"));
h.appendChild(Q);h.appendChild(ca);h.appendChild(qa);u.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Z.a.Cr||Z.a.lj)&&(u=document.createElement("span"),u.className="UIFontBold",u.innerText=this.Rda(this.Z9,this.pNf),h.appendChild(u));b.appendChild(h);this.t7e?(r.ULS.sendTraceTag(8716420,307,50,null),u=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.QDh,Me.a.addHandler(h,"click",Object(z.a)(this,this.LXh,"extensionLinkHandler")),u.appendChild(h),Q=this.Cfb.indexOf("{0}"),
-1!==Q&&(B=this.Cfb.substring(0,Q),Q=this.Cfb.substring(Q+3,this.Cfb.length),B=document.createTextNode(B),Q=document.createTextNode(Q),u.insertBefore(B,h),u.appendChild(Q)),b.appendChild(document.createElement("br")),b.appendChild(u)):r.ULS.sendTraceTag(8716422,307,50,null);u=new mg.StandardDialog;u.Cd=0;u.ug=zs.id;u.pv(this.titleText,null,0,Object(z.a)(this,this.fZm,"legacyCopyPasteShortcutDialogHandler"),b);u.C5(zs.bxj)}}Object(m.a)(CB,"CopyPasteShortcutDialog",zs,[]);class xz extends zs{constructor(b,
h){super(b,h);h={};b=this.ZCm;h.extensionStartText=this.Zxl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.Coo;h.cutText=this.Rda(this.kcf,this.nNf);h.copyText=this.Rda(this.i$e,this.mNf);h.pasteText=this.Rda(this.QZf,this.oNf);4!==v.AFrameworkApplication.ua.Lb.Nk&&(h.pasteTextOnly=this.Rda(this.Z9,this.pNf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const u=new Hf.a(!1,!1,!0);u.ug="CopyPasteInstallDialog";u.Cd=0;u.xe(1,this.YCm);u.rV(1);u.Qh(b,Object(z.a)(this,
this.n4f,"reactCopyPasteShortcutDialogHandler"),h)}get Coo(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get YCm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get ZCm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get Zxl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Kso(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(m.a)(xz,"ReactCopyPasteInstallDialog",zs,[]);class mv extends zs{constructor(b){super(b,null);this.jFi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.Ien;var u="";let B="";this.messageText&&(u=this.messageText.split(" {")[0],B=this.messageText.split("} ")[1]);h.startText=u;h.endText=B;h.cutText=this.Efl;h.copyText=this.d6k;h.pasteText=this.kzn;
h.cutShortcutText=this.Rda(this.Ffl,this.e7m);h.copyShortcutText=this.Rda(this.n6k,this.d7m);h.pasteShortcutText=this.Rda(this.nzn,this.g7m);h.imageSrc=Pd.a.Iba("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.fFn;this.jFi&&(r.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Klb,["onExecute"]:()=>{this.$Ym()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
u=new Hf.a(!1,!1,!0);u.Cd=0;u.ug="CopyPasteNoClipboardAccessDialog";u.Qh(b,Object(z.a)(this,this.n4f,"reactCopyPasteShortcutDialogHandler"),h)}get Ien(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Klb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get fFn(){return CommonUIStrings.l_DialogOk}get Efl(){return CommonUIStrings.l_CutString}get Ffl(){return CommonUIStrings.l_CutShortcut}get e7m(){return CommonUIStrings.l_CutShortcut_Mac}get d6k(){return CommonUIStrings.l_CopyString}get n6k(){return CommonUIStrings.l_CopyShortcut}get d7m(){return CommonUIStrings.l_CopyShortcut_Mac}get kzn(){return CommonUIStrings.l_PasteString}get nzn(){return CommonUIStrings.l_PasteShortcut}get g7m(){return CommonUIStrings.l_PasteShortcut_Mac}$Ym(){r.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Qd.a.om(this.jFi,"_blank",void 0,"learnMoreLink")}}Object(m.a)(mv,"ReactCopyPasteNoClipboardAccessDialog",zs,[]);class yz extends zs{constructor(b,h,u){super(b,h);b={};b.forwardElementText=this.y1h;b.cutText=this.Rda(this.kcf,this.nNf);b.copyText=this.Rda(this.i$e,this.mNf);b.pasteText=this.Rda(this.QZf,this.oNf);u.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Z.a.Cr||Z.a.lj)&&(b.pasteTextOnly=this.Rda(this.Z9,this.pNf));this.t7e?(r.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.QDh,["onExecute"]:B=>{this.LXh(B)}},u=this.Cfb.indexOf("{0}"),-1!==u&&(b.suggestionPrefixElement=this.Cfb.substring(0,u),b.suggestionSuffixElement=this.Cfb.substring(u+3,this.Cfb.length))):r.ULS.sendTraceTag(40726915,307,50,null);u={["id"]:zs.id,["bodyControls"]:b};b=new Hf.a(!1,!1,!0);b.Cd=0;b.ug=zs.id;b.Qh(this.titleText,Object(z.a)(this,this.n4f,"reactCopyPasteShortcutDialogHandler"),u)}}Object(m.a)(yz,"ReactCopyPasteShortcutDialog",
zs,[]);class nv{constructor(){this.JLa=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pF}I$e(b,h,u=!1){r.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.JLa,u));this.JLa?u?new xz(b,h):new yz(b,h,v.AFrameworkApplication.K):new CB(b,h,v.AFrameworkApplication.K)}static get instance(){return nv._instance||(nv._instance=new nv)}}nv._instance=null;Object(m.a)(nv,"CopyPasteShortcutDialogFactory",null,[958]);class Wx{constructor(b,h,u,B,
Q,ca,qa,Qa){this.Ueh=this.c0g=this.aTe=!1;this.Bjk=b;this.kd=h;this.eu=u;this.Vb=B;this.ze=Q;this.ag=ca;this.Pe=qa;Qa&&(this.Ueh=Qa.$("ShouldLogExecCommandCopySuccess"))}get zUa(){return this.Bjk}get e4a(){return this.c0g}set e4a(b){this.c0g=b;this.ag.bzf=b}DMc(b){this.zUa.DMc(b);b||this.Jad(!0)}get bvl(){return this.zUa.n9f}oNb(b){this.e4a=!0;this.zUa.oNb(b,this.Pjg)}reset(){this.e4a=!1}paste(){var b=null;let h=null;if(!this.zUa.aTb){(b=this.kd.zd)&&this.Vb.kg(b.pJ);var u=this.eu.gu;if(!u.qe||!u.ve.Vj)return null;
h=u.ve;b=this.ze.sw();this.e4a=!0;u.g9a()}u=null;try{h&&h.RDn(),u=b=this.zUa.SMc(this.Pjg,b)}catch(B){r.ULS.shipAssertTag(6305672,307,!1),this.wki()}this.e4a=!1;return u}copy(){var b=this.kd.zd;b&&this.Vb.kg(b.pJ);b=this.eu.gu;if(!b.qe||1!==b.ve.mode)return!1;this.e4a=!0;let h;try{const u=new Map;u.set("View","ContentEditableView");xa.Health.instance.recordKpiUsage(zq.a.V3b,0,zq.a.AEd,u);const B=this.zUa.lif(this.Pjg);h=!0;this.Ueh&&r.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
B,this.Pe.jG);if(!B){const Q=Object.assign(new Ub.a,{extendedProperties:u});xa.Health.instance.recordKpiFailure(zq.a.V3b,zq.a.V5e,!0,!0,Q)}}catch(u){r.ULS.shipAssertTag(6305673,307,Z.a.lj),r.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",Z.a.jG),h=!1}this.e4a=!1;return h?!0:!1}Jad(){if(this.aTe)return!0;var b=this.eu.gu;if(!b.qe||!b.ve.Vj)return!1;const h=b.ve;b=this.ze.sw();this.e4a=!0;const u=new eu.a(b);let B=!1;try{B=this.zUa.Jad(b,()=>{h.uFd()},
()=>{h.dIa()})}catch(Q){}u.restore();this.e4a=!1;B?this.aTe=!0:(r.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",Z.a.jG),this.wki());return B}wki(){this.aTe=!1;if(v.AFrameworkApplication.e1o)nv.instance.I$e(null,null);else{const b=new mg.StandardDialog;b.Cd=0;b.uV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get Pjg(){const b=this.ze.xib();return b?b.Vn:null}}Object(m.a)(Wx,"SystemClipboard",null,
[495]);class lt{constructor(b,h,u){this.izd=!1;this.Hzd=this.mT=this.V2g=this.lve=this.Xgd=null;this.uCn=B=>{1===B?(r.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.$ue)),this.e1b&&(r.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.e1b)),Qd.a.om(this.OBe+this.aLe,"_blank",void 0,"ChromeCCPInstallDialog"))):B||r.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.$ue))};this.$ue=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.OBe=b.kb("ChromeClipboardAccessExtensionLink");this.zab=h;this.hk=u;this.aLe=b.kb("ChromeClipboardAccessExtensionId");this.gmk=b.$("UseGetClipboardDataIsEnabled");this.ibh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.e1b=!1;b.$("CcpInstallDialogIsEnabled")&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pF&&(this.e1b=xz.Kso()||b.$("IgnoreDomainCheckCcpInstallDialog"),r.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.e1b));this.suc=null}DMc(b){b?this.mT=!0:(this.mT=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.suc=this.zab.cJd,this.zab.kQb?(this.izd=this.gmk,this.XBh()):(this.izd=!0,this.XBh(),r.ULS.sendTraceTag(19256732,307,50,W.a.create().toString()))):(this.DQb(),this.mT=!1))}get n9f(){return this.mT}get aTb(){return this.Hzd}Jad(){return!0}lif(b){r.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Qd.a.cEb(b,"copy"))||r.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}Enf(b){if(!b)return null;var h=b.img;const u=b.text;b=b.html;const B=this.hk.Egj(!!h,!!u,b);let Q=null;if(3===B){if(!b)return null;h=this.hk.UXh(b);(h=this.hk.aYh(h))&&(b+=h);Q=this.hk.Onb(b)}else 2===B?Q=this.hk.JZf(u,!0):1===B&&(Q=this.hk.Onb(h));return Q}SMc(b,h){if(this.aTb)h=this.Enf(this.lve),this.lve=null;else{if(!this.Xgd)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.Xgd;h=b.body;this.Xgd=null}return h}oNb(b){const h=W.a.create();this.V2g=
h;this.zab.kQb?r.ULS.sendTraceTag(7377737,307,50,h.toString()):r.ULS.sendTraceTag(19256735,307,50,h.toString());const u={};u.command=this.aTb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.suc,u,B=>{h.equals(this.V2g)?this.aTb?this.lve=B:this.Xgd=B:r.ULS.sendTraceTag(7385868,307,50,null);r.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.Zql(),this.zab.kQb?r.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):r.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}DQb(){r.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.e1b?b=this.OBe+this.aLe:this.$ue&&(b=this.OBe+this.suc);nv.instance.I$e(this.uCn,b,this.e1b)}Zql(){this.zab.B3n();this.DQb()}Uhj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}CTk(){const b=W.a.create();this.zab.kQb?r.ULS.sendTraceTag(592491466,307,50,b.toString()):r.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.suc,{command:"getAvailableCommands"},
h=>{r.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Cb.a)(Array,h)?(r.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.Hzd=-1!==Array.indexOf(h,"getClipboardData")):(r.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.Hzd=!1):(r.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.Hzd=!1)})}XBh(){const b=W.a.create();this.zab.kQb?r.ULS.sendTraceTag(7726105,
307,50,b.toString()):r.ULS.sendTraceTag(591984032,307,50,b.toString());this.izd&&this.CTk();this.Uhj(this.suc,h=>{r.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.mT=!0:(h?"ping"!==h&&r.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):r.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.DQb(),this.mT=!1);this.izd&&!this.aTb&&r.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}fJi(b,h){const u={};u.OfficeOnlineExtensionInstallationStatus=b;u.OfficeClipboardExtensionInstallationStatus=h;r.ULS.sendTraceTag(51144839,307,50,JSON.stringify(u));this.ibh&&(b&&xa.Health.instance.recordKpiSuccess(lt.E7g,null),h&&xa.Health.instance.recordKpiSuccess(lt.B7g,null))}B2m(){this.ibh&&(xa.Health.instance.recordKpiUsage(lt.E7g,1,lt.gTg,null),xa.Health.instance.recordKpiUsage(lt.B7g,
1,lt.gTg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.zab.kQb;this.Uhj(this.aLe,h=>{this.fJi(b,!!h)})}else this.fJi(!1,!1)}}lt.E7g="OfficeOnlineExtensionInstallationStatus";lt.B7g="OfficeClipboardExtensionInstallationStatus";lt.gTg="wwccp";Object(m.a)(lt,"ChromeSystemClipboardAccessManager",null,[522]);class tA{constructor(b,h){this.mT=null;this.Pe=b;this.Ga=h;this.AVj=!this.Ga.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ga.$("BlockCopyCutOnFirefoxIsEnabled");this.$gk=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}DMc(b){this.AVj&&b&&this.Pe.lj?(this.DQb(),this.mT=!1):this.mT=!0}get n9f(){return this.mT}get aTb(){return!1}lif(b){return Qd.a.cEb(b,"copy")}SMc(b,h){Qd.a.cEb(b,"paste");return h}oNb(b){b()}Jad(b,h,u){if(this.Pe.E4)return this.$gk&&(this.mT=!1),!1;h();u();b=this.SMc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=yb.a.create().toString();u();b=this.SMc(b.ownerDocument,b);return this.mT=b=h===b.innerHTML}DQb(){nv.instance.I$e(null,null)}}
Object(m.a)(tA,"DefaultSystemClipboardAccessManager",null,[522]);class DB{constructor(b,h,u){this.mT=this.yaa=this.sZb=this.Nla=this.jYa=this.Tgd=null;this.hk=h;this.tYa=u;this.W9j=b.lc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.Ehk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}DMc(b){this.Ehk&&b&&(this.mT=!0)}get n9f(){return this.mT}get aTb(){return!1}lif(b){return b?Qd.a.cEb(b,Kd.a.copy):!1}SMc(b,h){this.jYa&&(h=this.jYa,this.jYa=
null);return h}oNb(b,h=null){if(b&&h){this.Tgd=b;this.sZb=h;$addHandler(this.sZb,Kd.a.paste,Object(z.a)(this,this.oVi,"onPasteEvent"));this.yaa=this.Nla=null;if(this.oBj(this.sZb)){if(this.yaa&&0<this.yaa.length&&(!this.Nla||this.hk.Wne(this.Nla))){this.tYa.lIh(this.yaa,Object(z.a)(this,this.Smn,"onImageConverted"));this.jYa&&!this.jYa.hasChildNodes()&&r.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Nla&&this.Nla.innerHTML&&((this.jYa=this.Wni(this.Nla.innerHTML))&&
!this.jYa.hasChildNodes()&&r.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),kc.a.HC(this.Nla))}this.k_h()}else b&&b()}Jad(b){return this.mT=b=this.oBj(b.ownerDocument)}oVi(b){try{b&&b.rawEvent&&((this.Nla=b.rawEvent.target)&&this.Nla.id&&-1<this.Nla.id.indexOf("Paste")?(r.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Nla.id),this.Nla=null):this.yaa=this.jZl(b.rawEvent))}catch(h){r.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}Smn(b){b&&(this.tYa.Xoj&&(b=String.format('<img src="{0}">',b)),this.jYa=this.Wni(b));this.k_h()}k_h(){this.sZb&&($removeHandler(this.sZb,Kd.a.paste,Object(z.a)(this,this.oVi,"onPasteEvent")),this.sZb=null);this.Tgd&&(this.Tgd(),this.Tgd=null)}jZl(b){let h=null;(b=this.hk.x5h(b))&&({hzf:h}=this.hk.QAj(b,this.W9j,this.tYa.gMi));return h}oBj(b){return Qd.a.cEb(b,Kd.a.paste)}Wni(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}DQb(){}}Object(m.a)(DB,
"EdgeSystemClipboardAccessManager",null,[522]);class EB{constructor(b,h,u,B){this.Ga=b;this.WWj=h;this.hk=u;this.Pe=B}create(){let b=null;v.AFrameworkApplication.rfg()&&this.Pe.Cr&&window.chrome?(r.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new lt(this.Ga,this.WWj,this.hk),this.Ga.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.B2m()):this.Ga.$("EdgeContextMenuPasteFixIsEnabled")&&this.Pe.pu?(r.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new DB(this.Ga,Ga.a.instance.resolve("Box4.IClipboardDataHelper"),Ga.a.instance.resolve("Box4.IProcessImageStrategy"),Ga.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(r.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new tA(this.Pe,this.Ga));return b}}Object(m.a)(EB,"SystemClipboardAccessManagerFactory",null,[494]);class FB{Fwl(b){return b}}Object(m.a)(FB,"DeleteTableSegmentStrategy",null,[493]);var Qo=c(443),Ap=c(1046);class uA{get mq(){return Cr.a.jGb}get il(){return null!=
this.dEg?this.dEg:this.dEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get g1(){return this.il.mq}get Hc(){return Wh.a.instance}get RA(){return null!=this.oEg?this.oEg:this.oEg=Ga.a.instance.resolve("Box4.IParagraphIndentationReader")}ZFc(b,h,u,B,Q,ca,qa){let Qa=2;if(!b.qe)return 2;const rb=b.mb;if(!rb)return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.rda}),8;if(v.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.aAh(h===Ob.a.SG,u,!0);if(1===B)return b?32:8;b&&(Qa=Ap.a.shc(h,u,B,
Q,ca,qa))}else Qa=Ap.a.shc(h,u,1,Q,ca,qa),1!==B&&32===Qa?(b.mb.F7d(),b=new Qg.GraphTransaction(15),b.Db(u.view.ed),Qa=this.aAh(h===Ob.a.SG,u,!1)?Ap.a.shc(h,u,B,Q,ca,qa):8,b.dispose()):1!==B&&8===Qa&&(b.mb.F7d(),this.w1k(h,u,rb));return Qa}aAh(b,h,u){h=h.view.mb;if(!h||!h.hb.lb)return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ALb}),!1;if(h.hb.HJ)return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.n9e}),!1;h=Qo.OutlineElementGeneralizer.nha(h.hb,!1);if(!h)return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.WMd}),!1;let B=
!1;for(let Q=0;Q<h.length;Q++){const ca=h.getContext(Q),qa=new vd.GraphIterator;qa.set(ca.node);Ge.SelectionEditor.yu(qa);if(!Yc.OutlineElementReader.Bh(qa))if(u)continue;else return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.DDb}),!1;if(b?!this.mq.ABb(qa):!this.mq.G3b(qa))if(u)continue;else return this.Hc.Yb(pd.a.z6b,{["Reason"]:pe.a.N5e}),!1;B=!0}return u?B:!0}w1k(b,h,u){const B=new Qg.GraphTransaction(15);try{B.Db(h.view.ed);h=!0;const Q=Qo.OutlineElementGeneralizer.nha(u.hb,!1);for(let ca=0;ca<Q.length;ca++){const qa=
Q.getContext(ca),Qa=new vd.GraphIterator;Qa.set(qa.node);Ge.SelectionEditor.yu(Qa);if(!Yc.OutlineElementReader.Bh(Qa))h=!1;else if(b===Ob.a.SG?this.mq.ABb(Qa):this.mq.G3b(Qa))switch(h=!1,b){case Ob.a.SG:this.mq.MSa(Qa,-1,0);break;case Ob.a.LO:this.mq.SKc(Qa,1)}}if(h){const ca=u.hb.lb;for(u=0;u<ca.length;u++){const qa=ca.J(u);if(qa.Vk){const Qa=this.RA.Hib(qa.node),rb=Qa.hea;if(b===Ob.a.SG?Qa.KB>rb:Qa.KB<18*rb){const Lb=new vd.GraphIterator;Lb.set(qa.node);this.g1.qza(Lb,1,b===Ob.a.SG?Qa.KB>=2.5*rb?
Qa.KB-2*rb:rb:Qa.KB<16*rb?Qa.KB+2*rb:18*rb)}}}}}finally{B&&B.dispose()}}}Object(m.a)(uA,"IndentationActorExtension",null,[492]);var Jy=c(751),Ky=c(1222);class gx{constructor(b,h){this.io=new Od.DictionaryPropertySet;this.std=new Od.DictionaryPropertySet;this.Hvb=!1;this.VBa=this.ftb=null;this.U6=b;this.JUg=h}get Iqb(){return null!=this.uGg?this.uGg:this.uGg=Ga.a.instance.Oa("Box4.ITextFormattingCommands")}get Xn(){return null!=this.Syg?this.Syg:this.Syg=Ga.a.instance.resolve("Box4.IFormattingEditor")}get uc(){return null!=
this.BIg?this.BIg:this.BIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}Q6a(){this.Hvb||(0<this.BQa.zM()&&(this.std=this.io.clone()),this.io.o6f(),this.ftb=null,this.fYn())}m6k(b){var h;const u=null!==(h=zc.FormattingReader.Vr(b))&&void 0!==h?h:zc.FormattingReader.QQd(b.node,b.cpBegin,-1);!u.cache.OB&&(b=u.En)&&(h=new Od.DictionaryPropertySet,h.Yw(b),h.Yw(this.io),h.hasProperty(xh.a.nw)&&(this.ftb=u.paragraph.Lc),this.io=h)}hasProperty(b){return this.io.hasProperty(b)}rSc(){return 0<this.io.zM()}get BQa(){return this.io}freeze(){this.Hvb=
!0}TIa(){this.Hvb=!1}FG(b,h){return this.BQa.ja(b,h)}WA(b){this.io.setValue(Xe.a.fontSize,this.Xn.I4b(b));this.v1();im.a.T4f(this.std,this.io)}fontSize(){return this.io.ja(Xe.a.fontSize,im.a.DM)}Tfe(b){this.io.setValue(Xe.a.font,b);this.JUg&&this.JUg.execute(h=>{null==h?r.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.Tfe(this.io)});this.U6&&this.U6.enabled&&(Pc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.U6.vgo(this.io,
b));this.v1();im.a.T4f(this.std,this.io)}udg(b){this.io.setValue(Jc.a.Ee,b);this.U6&&this.U6.enabled&&(Pc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.U6.Xlo(this.io,b));this.v1()}Xv(b){b=Zn.a.instance.cva(xf.a.instance.hb.lb.Pa.node,b);this.io.setValue(Xe.a.fontColor,b);this.v1();im.a.T4f(this.std,this.io)}wga(){this.io.setValue(Xe.a.fontColor,zl.a.auto);this.v1()}fontColor(){return this.io.ja(Xe.a.fontColor,zl.a.nil)}oza(b){this.io.setValue(Xe.a.highlight,parseInt(b,
16));this.v1()}mFd(){this.io.setValue(Xe.a.highlight,zl.a.auto);this.v1()}isBold(){return this.io.ja(Xe.a.bold,!1)}EL(b){this.io.setValue(Xe.a.bold,b);this.v1()}isItalic(){return this.io.ja(Xe.a.italic,!1)}Wy(b){this.io.setValue(Xe.a.italic,b);this.v1()}isUnderline(){return this.io.ja(Xe.a.underline,!1)}H5(b){this.io.setValue(Xe.a.underline,b);this.io.setValue(Xe.a.underlineType,b?im.a.aSb:im.a.GV);this.v1()}underlineType(){return this.io.ja(Xe.a.underlineType,im.a.GV)}Qja(b){b<im.a.aSb||b>im.a.GV||
(this.io.setValue(Xe.a.underline,b!==im.a.GV),this.io.setValue(Xe.a.underlineType,b),this.v1())}isSuperscript(){return this.io.ja(Xe.a.superscript,!1)}jra(b){this.io.setValue(Xe.a.superscript,b);b&&this.isSuperscript()&&this.io.setValue(Xe.a.subscript,!1);this.v1()}isSubscript(){return this.io.ja(Xe.a.subscript,!1)}pIa(b){this.io.setValue(Xe.a.subscript,b);b&&this.isSubscript()&&this.io.setValue(Xe.a.superscript,!1);this.v1()}isStrikethrough(){return this.io.ja(Xe.a.strikethrough,!1)}Oja(b){this.io.setValue(Xe.a.strikethrough,
b);this.v1()}isDoubleStrikethrough(){return this.io.ja(xh.a.Et,!1)}Nfe(b){this.io.setValue(xh.a.Et,b);this.v1()}c5h(){return this.io.ja(xh.a.nw,null)}E7a(b,h){this.io.o6f();this.io.setValue(xh.a.nw,b.id);this.ftb=h.Lc;this.v1()}E5(b){let h=Xe.a.rL;const u=Jy.a.D1d(b);switch(u){case 1:h=Jc.a.$dc;break;case 2:h=Jc.a.aec}this.io.setValue(Jc.a.G4a,u);this.io.setValue(h,b);this.v1()}language(){let b=Xe.a.rL;switch(this.io.ja(Jc.a.G4a,0)){case 1:b=Jc.a.$dc;break;case 2:b=Jc.a.aec}return this.io.ja(b,0)}Lio(b){this.io.setValue(Jc.a.noProof,
b);this.v1()}ZIb(){return this.io.ja(Jc.a.noProof,!1)}BOm(){return this.io.hasProperty(Jc.a.noProof)}hNm(){return this.io.hasProperty(Xe.a.rL)||this.io.hasProperty(Jc.a.$dc)||this.io.hasProperty(Jc.a.aec)}v1(){if(Z.a.hmc){var b=xf.a.instance.hb.lb.Pa,h=b.node;if(h===this.VBa)this.VBa.gl(16,!0);else{this.VBa=h;h=this.VBa.jZ();try{this.VBa.a0(b.cpBegin).uxa=!0}finally{h&&h.dispose()}}}}fYn(){if(Z.a.hmc&&this.VBa){var b=0,h=this.VBa.jZ();try{for(let u=this.VBa.qa.length-1;0<=u;u--){const B=this.VBa.qa.J(u);
B.uxa&&(B.uxa=!1,b++,B.isEmpty&&this.VBa.qa.removeAt(u))}}finally{h&&h.dispose()}this.VBa=null}}n4k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.zh(b.cpBegin);return!!b&&b.uxa}c1e(b){if(this.Iqb){this.freeze();var h=new Qg.GraphTransaction(7);h.Db(b.node);this.Iqb.Vfe(b);this.TIa();this.Q6a();h.dispose()}}ftf(b){const h=me.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!F.a.Pv(h.charCodeAt(b.cpBegin))&&Ky.a.instance.c2a(h,b.cpBegin-1)!==b.cpBegin&&Ge.SelectionEditor.hlb(b)?
(b=Ge.SelectionEditor.c0(b,!1))?1<b.length||Ge.SelectionEditor.nl(b.Pa)?b:null:null:null}}Object(m.a)(gx,"InsertionPointFormatting",null,[488]);class zz{constructor(b){this.ga=b}get nc(){return this.ga}PNk(b,h,u=null){const B=new Od.DictionaryPropertySet;B.setValue($c.a.LA,b);B.setValue($c.a.BRa,h);u&&B.Yw(u);B.CommandSource="autobulleting";this.nc.Rb(Ob.a.oD,2,B)}Xgn(b,h,u,B,Q){const ca=new Od.DictionaryPropertySet;ca.setValue($c.a.LA,b);ca.setValue($c.a.BRa,h);ca.setValue($c.a.P4a,u);Q&&ca.setValue(Sh.a.LQ,
Q);B&&ca.setValue(Jc.a.nv,B);Pm.a.wY&&(ca.setValue(Sh.a.Qpa,"autocorrect"),Q&&ca.setValue(Sh.a.uia,Q));ca.CommandSource="autonumbering";return 32===this.nc.Rb(Ob.a.JL,2,ca)}}Object(m.a)(zz,"ListCommands",null,[489]);var eq=c(295);class hx extends eq.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){super();this.JZb=this.en=this.zKa=null;this.cGn=(gc,Fc)=>{Fc=this.Dta.O$d(this.zKa,Fc);gc.gi(this.UHl);return Fc};this.UHl=(gc,Fc)=>{if(this.en.moveNext())return gc=this.en.currentNode,12!==gc.type||gc===this.zKa.node?
!0:this.Dta.H3c(gc,Fc);this.fNk();gc.gi(this.WHl);return!0};this.WHl=(gc,Fc)=>{if(this.en.moveNext()){const Sc=this.en.currentNode;return 12!==Sc.type?!0:Sc===this.zKa.node?(gc.gi(this.dGn),!0):this.Dta.H3c(Sc,Fc)}return!1};this.dGn=(gc,Fc)=>{this.Dta.P$d(this.zKa,Fc);return!1};this.init(b);this.Ml(Yb);this.Ujb(Qa,h,B,Q,ca);this.VL=ca;this._context=u;this.ib=rb;this.De=Lb;this.Dta=qa;this.jz=0}run(){this.z6e();this.jz||this.Lno();1===this.jz&&this.jHn();2===this.jz&&this.WFo();3===this.jz&&this.pDl()}z6e(){this.ib.hb&&
this.ib.hb.lb?1===this.behavior&&(this.Dta.z6e(this._context)?this.qr=32:this.qr=2,this.jz=3):(r.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.qr=2,this.jz=3)}Lno(){this.KMk();this.Dta.Wdg(this.zKa)?(this.cMk(),this.jz=1):(this.qr=8,this.jz=3)}jHn(){this.GC||new Yt.a(this,this.cGn,this.VL);do if(this.GC.run(),this.GC.inProgress&&!this.Hh)return;while(this.GC.inProgress);this.iFd();this.jz=2}WFo(){this.Dta.akg(this)?this.qr=32:this.qr=8;this.jz=3}pDl(){this.hra()}KMk(){let b=
this.ib.hb.lb;if(b=this.De.Fj(b,!0,!1))this.zKa=b.Pa;this.zKa&&this.zKa.node&&(this.JZb=this.Dta.Wdi(this.zKa.node))}cMk(){if(!this.JZb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new sk.a;b.set(this.zKa.node);b.zb(this.JZb.type);this.en=bq.a.zs(b,this.JZb);this.en.wo(Object(z.a)(this.Dta,this.Dta.Ilc,"spellErrorFilter"),null)}fNk(){if(!this.JZb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new sk.a;b.set(this.JZb);this.en=bq.a.Np(b);this.en.wo(Object(z.a)(this.Dta,
this.Dta.Ilc,"spellErrorFilter"),null)}}Object(m.a)(hx,"ProofingWholeDocumentOperation",eq.a,[]);var dj=c(277);class ov extends Xj{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(m.a)(ov,"ContextMenuRootProperties",Xj,[]);var Xx=c(1371);class Hv{constructor(b){const h=new ov;h.ImageSideArrow=v.AFrameworkApplication.$s;h.ImageSideArrowClass=ze.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=
Ob.a.m$d.toString();this.Ehh=new Xx.ContextMenuRoot("ContextMenuRootName",h);b.execute(u=>{this.N1.CF=u});this.N1.refresh();v.AFrameworkApplication.va.ra(Za.a.showContextMenu,Ad.a.frame,dd.ActionManager.Lf);v.AFrameworkApplication.va.ra(Za.a.klc,Ad.a.frame,dd.ActionManager.Lf)}get N1(){return this.Ehh}dispose(){this.N1&&(this.N1.dispose(),this.Ehh=null)}showContextMenu(b,h){this.Rpb(b,h.clientPoint,h.hg)}e5b(b,h,u,B,Q){this.N1.e5b(b,h,u,B,Q)}K7a(b,h,u){Qd.a.I3d(this.N1.OZa?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");Fb.App.za.OGl();this.vu();this.N1.K7a(b,h,u);this.N1.OZa?v.AFrameworkApplication.va.processAction(Za.a.klc,2):v.AFrameworkApplication.va.processAction(Za.a.showContextMenu,2)}Rpb(b,h,u){this.K7a(b,new Sys.UI.Bounds(h.x,h.y,0,0),u)}vu(){this.N1.root.Bm()}c4(){return this.N1.c4()}klc(b,h,u,B){const Q=this.N1;let ca=!1;u=Object(Na.a)(Fv,u);Q.OZa=u;B.tza(b,h);Q.cYe?u&&(u.BCn(Q,h),ca=!0):(r.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
B.ffl()),Q.OZa=null);return ca}}Object(m.a)(Hv,"AContextMenuController",null,[538,10]);class iu{}iu.Thc="faProofing";iu.iUh="EditorMenuSection";Object(m.a)(iu,"ContextMenuControlId",null,[]);var ju=c(531);class tw{constructor(b){this.De=b}z6e(b){b=Object(Na.a)(ju.a,b);return!!b&&!!b.view&&b.view.qe}Wdg(){return!0}O$d(){return!0}H3c(){return!0}P$d(){}akg(){return!0}Ilc(b){if(b.Wr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}Wdi(b){if(!b||!this.De)return b;const h=new sk.a;h.set(b);if(this.De.yu(h)){for(;!h.Wr;)h.rc();
return h.currentNode}return b}}Object(m.a)(tw,"SimpleProofingWholeDocumentCallBacks",null,[363]);class Az{constructor(b){this.value=b}}Object(m.a)(Az,"RefBool",null,[]);class ix{constructor(){this.MMc=this.yLb=null;this.bCj=new Az(!1)}}Object(m.a)(ix,"FindNextErrorOperationParam",null,[]);class Iv{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=Iv.Tsl;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=
0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}Iv.Tsl=[];Object(m.a)(Iv,"Critique",null,[]);class vn{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(vn,"Suggestion",null,[]);var Yx=c(604);class uw extends Sys.EventArgs{constructor(b,h,u,B,Q,ca){super();this.q3j=b;this.w5j=h;this.x5j=u;this.Cre=B;
this.Xz=Q;this.H9a=ca}}Object(m.a)(uw,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var vw=c(335);class mt{constructor(b,h,u){this.Dze=b;this.Nn=h;this.sa=u}mIh(b){const [h,u,B]=this.yii(b);return this.V7h(h,u,B)}hIm(b){return Wl.a.getTypeNameFor(b.content)===vw.a.getTypeName()}V7h(b,h,u){if(u&&this.hIm(u)){if(this.u2b(u.content))return null;const Q=u.content;var B=new Iv;B.ExplanationTitle=Q.explanationTitle;B.Suggestions=this.Mdm(u);B.CategoryTitle=Q.categoryName;B.TypeId=Q.typeId;B.CritiqueActions=
Q.critiqueActions;B.Priority=Q.priority;u=this.Dze.create(B);B=Q.context;u.token=B.substring(Q.range.start,Q.range.start+Q.range.length);u.lcid=Jj.a.qg(Q.language).LCID;u.originalText=B;return new Yx.a(b,h,u)}return null}Mdm(b){var h=b.content.suggestions;b=[];for(const u of h)h=new vn,h.Action=u.suggestionActions,h.Text=u.text,h.Description=u.description,b.push(h);return b}u2b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}yii(b){const h=this.Nn.eQc(b,0),u=b.cpBegin,
B=b.cpEnd,Q=Ge.SelectionEditor.ef(b);b=me.ParagraphReader.text(b.node,0);for(const ca of h)if(Q){if(ca.Ac<=u&&ca.end>=B)return[ca.Ac,ca.end,ca.intent]}else if(ca.Ac<=u&&ca.end>=u&&F.a.sHh(b,ca.end,B))return[ca.Ac,ca.end,ca.intent];return[null,null,null]}static LB(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}Nwf(b,h,u){const [B,Q,ca]=this.yii(b);ca&&this.sa.raiseEvent(mt.Xuh,new uw(b,B,Q,h,ca,u))}xvk(b){this.sa.addHandler(mt.Xuh,
b)}Pzl(b,h,u){b=this.Nn.uRd(b,0,0,b.characterData.length);for(let B=0;B<b.count;B++){const Q=b.J(B);if(Q.intent){const ca=Q.intent;if(ca.content&&(0==ca.content.priority||1==ca.content.priority)&&Q.Ac>=h&&(!u||u(Q.intent)))return this.V7h(Q.Ac,Q.end,Q.intent)}}return null}}mt.Xuh="augloopProofingContextMenuActionEventKey";Object(m.a)(mt,"AugLoopProofingErrorDetailHelper",null,[]);class ww extends tw{constructor(b,h,u,B){super(h);this.zn=b;this.zCc=u;this.ZUj=B}O$d(b,h){return!this.uLf(b.node,b.cpBegin,
h)}H3c(b,h){return!this.uLf(b,0,h)}P$d(b,h){this.uLf(b.node,0,h);Object(Na.a)(ix,h)}uLf(b,h,u){u=Object(Na.a)(ix,u);if(me.ParagraphReader.Wb(b)&&!b.FJ)if(zc.FormattingReader.Vr(Je.a.Oc(b,h)).cache.ZIb)u.bCj.value=!0;else{if(mt.LB())return h=this.ZUj.Pzl(b,h,this.zCc),null!=h?(u.yLb=h,u.MMc=b,!0):!1;const B=this.zn.s4(b);for(let Q=0;Q<B.length;Q++){const ca=B[Q];if(ca.Ac>=h&&!ca.errorDetails.$3a()&&(!this.zCc||this.zCc(ca.errorDetails)))return u.yLb=ca,u.MMc=b,!0}return!1}}}Object(m.a)(ww,"FindNextErrorCallbackSteps",
tw,[]);var Mi=c(303);class GB{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd){this.rZk=(Ie,fe,de,ne,ye)=>{fe=this.ib.hb.lb;if(!fe)return this.yd.Yb(pd.a.Ye,{["Reason"]:pe.a.noSelection}),2;fe=this.De.Fj(fe,!0,!1);return this.ga.Kf(fe.Pa,Ie,de,!1,ne,ye)};this.Cun=(Ie,fe,de)=>{if(1===de)return this.ga.processAction(Ob.a.E5,1);this.t8j().Yfg();return 32};this.gEa=(Ie,fe,de)=>{if(1===de)return 32;Gj.a.mark(4670);de=this.zn.noa(fe);if(this.mme(de))return 8;fe=fe.node;const ne=this.Kc.Pc(15);let ye=
de.Ac;" "===me.ParagraphReader.text(fe).charAt(ye-1)&&ye--;ne.Db(fe);const Vf=this.Ld.Ge(Je.a.createTextRange(fe,0<de.Ac?de.Ac-1:0,de.end),"",!0,!1);this.ib.Bc(Cg.SelectionFactory.ne(fe,Vf+ye));ne.dispose();de.errorDetails.Wqb(Ie);Gj.a.mark(4671);return 32};this.Ywa=(Ie,fe,de)=>{if(1===de)return 32;r.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(mt.LB())return this.Y9a.Nwf(fe,null,Mi.b.IgnoreOnce),32;Gj.a.mark(4670);de=this.zn.noa(fe);if(this.mme(de))return 8;fe=fe.node;const ne=
this.Kc.Pc(15);ne.Db(fe);this.zn.Cob(fe,[de],!0);fe.setValue(Xe.a.k9e,!0);ne.dispose();de.errorDetails.Wqb(Ie);Gj.a.mark(4671);r.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.L4m(de);this.xYa.toi(de,fe,!0);return 32};this.A6k=(Ie,fe,de)=>{var ne,ye=!this.Ik.n9(fe);this.Zm&&this.Zm.instance&&this.Zm.instance.EU(fe)&&(ye=!1);if(1===de||!ye)return ye?32:8;this.ga.processAction(Ob.a.zra,2);Gj.a.mark(4670);ye=this.ERl(Ie);if(0>ye)return 8;if(mt.LB())return this.Y9a.Nwf(fe,
ye,Mi.b.Apply),32;de=this.zn.noa(fe);if(this.mme(de))return 8;fe=fe.node;var Vf=de.errorDetails.suggestions;if(!Vf)return this.yd.Yb(pd.a.jEb,{["Reason"]:"NoSuggestionsFound"}),Gj.a.mark(4671),8;ye=ye<Vf.length?Vf[ye]:null;if(!ye)return this.yd.Yb(pd.a.jEb,{["Reason"]:"RequestedSuggestionIsNull"}),Gj.a.mark(4671),8;(null===(ne=Fb.App.xd)||void 0===ne?0:ne.So)&&Fb.App.xd.Yp.$F(fe);ye=ye.replace("  "," \u00a0");ne=this.Kc.Pc(15);ne.Db(fe);Vf=this.Ld.Ge(Je.a.createTextRange(fe,de.Ac,de.end),ye,!0,!1,
Ob.a.zra);this.ib.Bc(Cg.SelectionFactory.ne(fe,de.Ac+ye.length+Vf));ne.dispose();de.errorDetails.Wqb(Ie);Gj.a.mark(4671);this.k1m(de);return 32};this.Tao=(Ie,fe)=>{fe=this.zn.noa(fe);if(this.mme(fe))return 8;fe.errorDetails.Wqb(Ie);return 32};this.tCl=(Ie,fe,de,ne,ye)=>{if(!fe.view.qe)return 2;const Vf=fe.view;if(!this.ib.hb.lb)return this.yd.Yb(pd.a.Ye,{["Reason"]:pe.a.noSelection}),2;if(1===de)return 32;const Og=new ix,Bl=new ww(this.zn,this.De,this.zCc,this.Y9a);fe=new hx(null,Ie,fe,de,ne,Og,Bl,
this.ga,this.ib,this.De,null);fe.Hh=!0;fe.run();if(fe.isCompleted&&Og.yLb){if(fe=Cg.SelectionFactory.ne(Og.MMc,Og.yLb.Ac),fe=Cg.SelectionFactory.Dy(fe,Je.a.Oc(Og.MMc,Og.yLb.end)),!this.Eah.instance||!this.Eah.instance.yEn(Og.yLb,fe,Vf)){this.ib.Bc(fe);let sm=0;ye&&(sm=ye.Qx);Vf.Ehe=!1;Bg.a.instance.Xb(new bf.a(1,1,1,()=>{this.$9n(Vf,sm,Og.MMc,Og.yLb)}))}}else{const sm=new mg.StandardDialog;sm.Cd=0;Fb.App.xN.vXc?sm.Uja(CommonUIStrings.l_DefaultDialogTitle,Og.bCj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:
Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(sm.Uja(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Fb.App.xN.TAd(()=>{sm.ypa&&(sm.hide(),this.ga.processAction(Ie,2))}))}return 32};this.m$d=(Ie,fe,de)=>{if(1===de)return 32;this.Sea&&this.Sea.N1&&(Ie=this.Sea.N1.Suf(iu.Thc))&&!Ie.tL&&(Ie.J0(0),Ie.menu.bL(0));return 32};this.ga=h;this.zn=b;this.t8j=u;this.Ld=B;this.Kc=Q;this.ib=ca;this.Zm=qa;this.De=Qa;this.Hgk=rb;this.Ik=Lb;this.yd=Yb;this.Y9a=Hd;this.Sea=
Object(Na.a)(Hv,gc);this.JXb=Fc.WWc;this.Eah=Sc;this.xYa=ld;this.Opc=new Map;this.Opc.set(1,Ob.a.khg);this.Opc.set(2,Ob.a.uvf);this.Opc.set(3,Ob.a.jig);this.kBc=new Map;this.kBc.set(1,Ob.a.lhg);this.kBc.set(2,Ob.a.vvf);this.kBc.set(3,Ob.a.kig)}Tb(){const b=this.ga,h=this.A6k,u=this.rZk;b.fb(Ob.a.q8d,vc.a.view,this.Cun,1028);b.ra(Ob.a.gEa,vc.a.Tc,this.gEa);b.ra(Ob.a.Ywa,vc.a.Tc,this.Ywa);b.ra(Ob.a.Dqb,vc.a.Tc,h);b.ra(Ob.a.Eqb,vc.a.Tc,h);b.ra(Ob.a.Fqb,vc.a.Tc,h);b.ra(Ob.a.pRb,vc.a.Tc,h);b.ra(Ob.a.qRb,
vc.a.Tc,h);b.ra(Ob.a.gEa,vc.a.view,u);b.ra(Ob.a.Ywa,vc.a.view,u);b.ra(Ob.a.Dqb,vc.a.view,u);b.ra(Ob.a.Eqb,vc.a.view,u);b.ra(Ob.a.Fqb,vc.a.view,u);b.ra(Ob.a.pRb,vc.a.view,u);b.ra(Ob.a.qRb,vc.a.view,u);b.Xc(Ob.a.gEa,1028);b.Xc(Ob.a.Ywa,1028);b.Xc(Ob.a.Dqb,1028);b.Xc(Ob.a.Eqb,1028);b.Xc(Ob.a.Fqb,1028);b.Xc(Ob.a.pRb,1028);b.Xc(Ob.a.qRb,1028);b.ra(Ob.a.zra,Ad.a.frame,dd.ActionManager.Lf);this.JXb&&b.fb(Ob.a.m$d,vc.a.view,this.m$d,1124);b.fb(Ob.a.t0c,vc.a.view,this.tCl,1028);b.fb(Ob.a.t2f,vc.a.Jd,this.Tao,
1124);this.hUn([Ob.a.eje,Ob.a.khg,Ob.a.lhg,Ob.a.zUd,Ob.a.uvf,Ob.a.vvf,Ob.a.Hje,Ob.a.jig,Ob.a.kig,Ob.a.s3i,Ob.a.VOi,Ob.a.Qsj])}hUn(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],vc.a.view,dd.ActionManager.cR,1028)}vVn(b){this.zCc=b}mme(b){return b?b.errorDetails?!1:(r.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.yd.Yb(pd.a.jEb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Gj.a.mark(4671),!0):(r.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),
this.yd.Yb(pd.a.jEb,{["Reason"]:"RequestedErrorRangeNotFound"}),Gj.a.mark(4671),!0)}L4m(b){b=b.errorDetails.proofingType;if(this.kBc.has(b)){const h=this.kBc.get(b);this.ga.processAction(h,2);r.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}ERl(b){switch(b){case Ob.a.Dqb:return 0;case Ob.a.Eqb:return 1;case Ob.a.Fqb:return 2;case Ob.a.pRb:return 3;case Ob.a.qRb:return 4;default:return-1}}k1m(b){b=b.errorDetails.proofingType;if(this.Opc.has(b)){const h=
this.Opc.get(b);this.ga.processAction(h,2);r.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}$9n(b,h,u,B){b.z5();(b=u.pe(b.$b))?(B=dj.a.Tq(b,v.AFrameworkApplication.isRtl?B.Ac:B.end),this.Hgk.tza(new Sys.UI.Point(B.x,B.y+B.height),h)):r.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(m.a)(GB,"ProofingActor",null,[]);var jx=c(408),Xq=c(1566),Er=c(1859),pv=c(539);class Bz{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.Zlc=
null;this.UEl="StyleUsageActivity";this.VEl="StylesFloodgateSurveyIsEnabled";this.ENa=(gc,Fc,Sc,ld)=>{gc=this.ndm(gc);return 0>gc||gc>this.Zlc.length?2:(gc=this.Zlc[gc])?v.AFrameworkApplication.va.Kf(Fc,Ob.a.KQ,Sc,!0,ld,gc):2};this.fNb=(gc,Fc,Sc,ld,Hd)=>{gc=!0;Fc.contextId!==vc.a.paragraph&&Fc.contextId!==vc.a.Jd&&Fc.contextId!==vc.a.Tc&&(gc=!1);if(1===Sc||!gc)return gc?32:8;if(2===Sc&&!Hd)return 8;Fc=this.uc.ZC(Fc.node);Hd.MenuItems=jx.a.f3l(Fc);return 32};this.nKn=(gc,Fc,Sc,ld,Hd)=>{gc=!0;Fc.contextId!==
vc.a.paragraph&&(gc=!1);if(1===Sc&&!gc)return 8;Fc=Fc.node;Sc=this.uc.Ro(Fc);if(!Sc||!Hd)return r.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Hd,Fc,Sc),8;Hd.sUa.Yw(Sc.xl());return 32};this.hEk=(gc,Fc,Sc,ld,Hd)=>{if(Fc.contextId!==vc.a.paragraph)return 8;if(this.Uf.m4a(Fc,!1))return this.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),8;if(1===Sc)return 32;const Ie=Fc.node;if(me.ParagraphReader.jva(Ie)||!Hd)return 8;const fe=this.Ftf(Hd,Ie);if(!fe)return this.Hc.Yb(pd.a.U1,
{["Reason"]:pe.a.kEb}),8;if(2!==this.uc.GG(fe))return 2;Sc=new Qg.GraphTransaction(15);this.eo&&this.eo.r9&&this.MH.ulc(Hd);Sc.Db(Ie);this.xj.Q6a();const de=[];gc!=Ob.a.JC&&de.push(Ud.a.DJa);this.T5.YJ(fe,Ie,!1,void 0,void 0,void 0,In.a.Sj?new Er.a(de,!1,!0):null);(gc=this.uc.ZC(Ie))&&this.uc.je(fe,gc)&&Pc.b(593078098,3017,50,"Custom linked style applied by user");Ie.Dr&&(gc=[Object.assign(new ha.a,{name:"Source",string:"ApplyStyle"})],Fe.a("TOCFormatting",!0,void 0,gc));Sc.dispose();Hd=F.a.NQ(Hd);
ld.As=Hd>>>16^Hd&65535;ld&&Xq.a.Gqb&&(ld.MC|=Xq.a.rib(Fc.node));return 32};this.oKn=(gc,Fc,Sc,ld,Hd)=>{gc=!0;Fc.contextId!==vc.a.Jd&&(gc=!1);if(1===Sc&&!gc)return 2;Fc=zc.FormattingReader.Vr(Fc);Fc=zc.FormattingReader.Eoa(Fc);if(!Fc)return 2;if(!Hd)return 8;Hd.sUa.Yw(Fc.xl());return 32};this.iEk=(gc,Fc,Sc,ld,Hd)=>{if(Fc.contextId!==vc.a.Jd)return 8;this.Uf.m4a(Fc);if(1===Sc)return 32;gc=Fc;In.a.dHd&&(Fc=this.Io.KSd(gc))&&(gc=Fc);Fc=gc.node;if(!Hd)return 8;const Ie=this.Ftf(Hd,gc.node);if(!Ie)return this.Hc.Yb(pd.a.U1,
{["Reason"]:pe.a.kEb}),8;if(1!==this.uc.GG(Ie))return 2;Sc=this.uc.ZC(Fc);if(!Sc)return this.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.hYh}),8;if(!Sc.jj(this.uc.wg(Ie)))return this.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.kEb}),8;const fe=new Qg.GraphTransaction(7);try{if(this.eo&&this.eo.r9&&this.MH.ulc(Hd),fe.Db(Fc),this.T5.Qog(Fc,Sc),this.Cra.w_(gc,de=>{this.Xn.vga(de);this.Xn.E7a(de,Ie)}),Fc.Dr){const de=[Object.assign(new ha.a,{name:"Source",string:"ApplyStyle"})];Fe.a("TOCFormatting",!0,void 0,de)}}finally{fe&&
fe.dispose()}Sc&&this.uc.je(Ie,Sc)&&Pc.b(593078097,3017,50,"Custom linked style applied by user");Hd=F.a.NQ(Hd);ld.As=Hd>>>16^Hd&65535;ld&&Xq.a.Gqb&&(ld.MC|=Xq.a.rib(gc.node));return 32};this.mKn=(gc,Fc,Sc,ld,Hd)=>{gc=!0;Fc.contextId!==vc.a.Tc&&(gc=!1);if(1===Sc&&!gc)return 2;Fc=this.T5.tdm(Fc);if(!Fc)return 2;if(!Hd)return 8;Hd.sUa.Yw(Fc.xl());return 32};this.gEk=(gc,Fc,Sc,ld,Hd)=>{if(Fc.contextId!==vc.a.Tc)return 8;if(this.Uf.m4a(Fc,!1))return this.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),8;if(1===Sc)return 32;
var Ie=Fc.node;if(!Hd)return 8;Sc=this.Ftf(Hd,Fc.node);if(!Sc)return this.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.kEb}),8;const fe=this.uc.GG(Sc);if(1!==fe&&2!==fe)return 2;(Fc=this.xj.ftf(Fc))?(Fc=xf.a.ICb(Fc),gc=v.AFrameworkApplication.va.Kf(Fc,gc,2,!1,ld,Hd)):(gc=new Qg.GraphTransaction(7),this.eo&&this.eo.r9&&this.MH.ulc(Hd),gc.Db(Ie),this.T5.vlo(Sc,Ie),gc.dispose(),gc=32);Ie.Dr&&(Fc=[Object.assign(new ha.a,{name:"Source",string:"ApplyStyle"})],Fe.a("TOCFormatting",!0,void 0,Fc));(Ie=this.uc.ZC(Ie))&&
this.uc.je(Sc,Ie)&&Pc.b(593078096,3017,50,"Custom linked style applied by user");Hd=F.a.NQ(Hd);ld.As=Hd>>>16^Hd&65535;return gc};this.pKn=(gc,Fc,Sc,ld,Hd)=>{const Ie=this.pdd.xqa(gc,Fc,Sc,ld,Hd,null,0);return 2!==Ie?Ie:this.pdd.xqa(gc,Fc,Sc,ld,Hd,null,12)};this.jEk=(gc,Fc,Sc,ld,Hd)=>{var Ie;const fe={};fe[this.pdd.GJa]=6168;fe[this.pdd.FJa]=6169;let de=12;if(!Fc.view.qe)return 2;var ne=Fc.view.mb,ye=ne?ne.ng:null;if(!ye)return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.noSelection}),8;if(this.Xg.IDa(Dd.ImageReader.B3a,
ye))return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.UIc}),8;if(this.Xg.hAa(me.ParagraphReader.AU,ye))return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.yO}),8;if(this.Uf.Mbc(ye,!1))return this.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ZE}),8;ye=this.uc.yr();if(Hd&&ye){const Vf=ye.jj(Hd);if(Vf){(null===(Ie=v.AFrameworkApplication.K)||void 0===Ie?0:Ie.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("Style");Ie=this.uc.ywa(Vf,ye);let Og=this.uc.GG(Vf);Ie&&(ne=ne.hb.J(0),ne.Vw&&
ne.Pa.contextId===vc.a.Jd||2===ne.length&&ne.Pa.contextId===vc.a.Jd&&ne.Rc.contextId===vc.a.Uc)&&(Og=1,Hd=Ie.getValue(xh.a.la));1===Og?de=0:3===Og&&(de=14);!this.uc.je(Vf,ye)&&this.uc.Hd(Vf)&&(ne=this.uc.wg(Vf),Pc.b(562317522,3017,50,String.format("{0}: style applied by user",ne)));this.Gra(this.UEl,this.VEl)}}return this.pdd.xqa(gc,Fc,Sc,ld,Hd,fe,de)};this.Yu=h;this.Be=u;this.ON=B;this.dA=Q;this.Ik=ca;this.yd=qa;this.OW=Qa;this.Kmk=rb;this.ue=Lb;this.Io=Yb}get eo(){return null!=this.SFg?this.SFg:
this.SFg=Ga.a.instance.Oa("Box4.Styles.StyleSettings")}get T5(){return this.Yu}get Xg(){return this.ON}get xj(){return this.dA}get Xn(){return this.Be}get Uf(){return this.Ik}get Hc(){return this.yd}get Cra(){return this.OW}get pdd(){return this.Kmk}get uc(){return this.ue}Tb(){const b=v.AFrameworkApplication.va,h=Fb.App.JUa.hKh(12);b.ra(Ob.a.KQ,vc.a.Jd,this.iEk);b.ra(Ob.a.HHa,vc.a.Jd,this.oKn);b.ra(Ob.a.KQ,vc.a.Tc,this.gEk);b.ra(Ob.a.HHa,vc.a.Tc,this.mKn);b.ra(Ob.a.KQ,vc.a.paragraph,this.hEk);b.ra(Ob.a.KQ,
vc.a.view,this.jEk);b.Xc(Ob.a.KQ,1036);b.ra(Ob.a.HHa,vc.a.view,this.pKn);b.ra(Ob.a.HHa,vc.a.paragraph,this.nKn);b.Xc(Ob.a.HHa,99);b.ra(Ob.a.fNb,vc.a.view,h);b.ra(Ob.a.fNb,vc.a.paragraph,this.fNb);b.Xc(Ob.a.fNb,1127);b.fb(Ob.a.n1e,vc.a.view,this.ENa,4);b.fb(Ob.a.o1e,vc.a.view,this.ENa,4);b.fb(Ob.a.p1e,vc.a.view,this.ENa,4);b.fb(Ob.a.q1e,vc.a.view,this.ENa,4);b.fb(Ob.a.r1e,vc.a.view,this.ENa,4);b.fb(Ob.a.s1e,vc.a.view,this.ENa,4);b.fb(Ob.a.t1e,vc.a.view,this.ENa,4);b.fb(Ob.a.vth,vc.a.view,this.ENa,
4);b.fb(Ob.a.wth,vc.a.view,this.ENa,4);b.fb(Ob.a.xth,vc.a.view,this.ENa,4);this.Zlc=Array(10);this.uc.tlo(this.Zlc)}ndm(b){switch(b){case Ob.a.n1e:return 0;case Ob.a.o1e:return 1;case Ob.a.p1e:return 2;case Ob.a.q1e:return 3;case Ob.a.r1e:return 4;case Ob.a.s1e:return 5;case Ob.a.t1e:return 6;case Ob.a.vth:return 7;case Ob.a.wth:return 8;case Ob.a.xth:return 9;default:return-1}}Gra(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const u=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");
u&&u.execute(B=>{B.logActivity(b,h)})},Bz.fEa)}Ftf(b,h){if(b&&h&&me.ParagraphReader.Wb(h))h=this.uc.ZC(h);else return null;return h.jj(b)}get MH(){return null!=this.Gyg?this.Gyg:this.Gyg=Ga.a.instance.resolve("Box4.IFontStylesGalleryCache")}}Bz.fEa=5E3;Object(m.a)(Bz,"StyleActor",null,[]);var kx=c(1984);class Zx{constructor(b){this.ga=b}get nc(){return this.ga}Vfe(b,h=!1){this.nc.Kf(b,Ob.a.BQa,2,!0,null,h)}E5(b){this.nc.Rb(Ob.a.E5,2,b)}}Object(m.a)(Zx,"TextFormattingCommands",null,[487]);class Bp{constructor(b,
h,u,B){this.oVe=this.mih=!1;this.FJo=(Q,ca,qa)=>{if(2!==qa)return 2;this.mih||(this.mih=!0);v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");return 32};this.qGn=(Q,ca,qa,Qa,rb)=>{if(2!==qa)return 2;this.U2i(rb,!0);return 32};this.pGn=(Q,ca,qa,Qa,rb)=>{if(2!==qa)return 2;this.U2i(rb,!1);return 32};this.kHn=(Q,ca,qa)=>{if(2!==qa)return 2;if(!this.Wab)return 8;
this.Wab.esm();return 32};this.jGn=(Q,ca,qa)=>{if(2!==qa)return 2;if(!this.Wab)return 8;this.Wab.m5n();return 32};this.kqa=(Q,ca)=>{3===ca.Qx&&Ge.SelectionEditor.Il(ca.pl.lb)&&(Fe.c(Ob.a.AJo),v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),this.oVe=!0)};this.ga=b;this.Ga=h;this.Wab=u;this.ib=B}get EJo(){return this.oVe}Tb(){var b;this.ga.fb(Za.a.YP,vc.a.view,this.FJo,4);this.ga&&this.Ga&&(this.Ga.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(Ob.a.Plg,
vc.a.view,this.qGn,4),this.ga.fb(Ob.a.Rlg,vc.a.view,this.pGn,4)),this.ga.fb(Za.a.Ntj,vc.a.application,this.kHn,4),this.ga.fb(Za.a.Ygf,vc.a.application,this.jGn,4),Hp.EventHandlerManager.instance.BUn(()=>{this.Ssn()}));(null===(b=Fb.App.za.jb.qc)||void 0===b?0:b.qe)&&Fb.App.za.jb.qc.Cma(()=>{this.d$n()});this.ib&&this.ib.Sw(this.kqa)}JMn(){Fe.c(Ob.a.DJo);this.oVe=!0}d$n(){const b=window.performance.now();Bp.bIe&&250>b-Bp.bIe&&1E3<b-Bp.h3g&&(Fe.c(Ob.a.CJo),Bp.h3g=b);this.Wab&&Bp.Zb&&Bp.Zb.NB(117)&&
this.Wab.showFloatie()}WEm(b,h){if(h){var u=null;Z.a.bK&&b&&(u=b.getSelection());b=null;u&&"Caret"===u.type&&(b=u.getRangeAt(0))&&this.Wab&&this.Wab.WTo(b.getBoundingClientRect(),h)}}Ssn(){Bp.bIe=window.performance.now()}U2i(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Bp.mvm)){for(b=b.firstChild;b;)this.Dyk(b,h),b=b.nextSibling;break}b=b.nextSibling}}Dyk(b,h){if(b.classList.contains(Bp.Moi)){const u="WACImageResizeHandleTouch"+this.$Xl(b);h?b.classList.add(Bp.Noi,
u):b.classList.remove(Bp.Noi,u)}}$Xl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Bp.Moi)return F.a.substring(h,20,h.length);return""}static get Zb(){return null!=Bp.Bxg?Bp.Bxg:Bp.Bxg=Ga.a.instance.Oa("Box4.IFeatureHelper")}}Bp.Moi="WACImageResizeHandles";Bp.Noi="WACImageResizeHandlesTouch";Bp.mvm="WACImgSelection";Bp.bIe=0;Bp.h3g=0;Object(m.a)(Bp,"TouchInputActor",null,[486]);class xw{get GJa(){return Ap.a.GJa}get FJa(){return Ap.a.FJa}get Goc(){return Ap.a.Goc}xqa(b,
h,u,B,Q,ca,qa){return Ap.a.xqa(b,h,u,B,Q,ca,qa)}shc(b,h,u,B,Q,ca){return Ap.a.shc(b,h,u,B,Q,ca)}static get instance(){xw._instance||(xw._instance=new xw);return xw._instance}}xw._instance=null;Object(m.a)(xw,"ViewActionHandlerProxy",null,[485]);class lx{constructor(b,h){this.kpiName="VisiMarkersUsage";this.I8="wwaengidc";this.zlb=new Map;this.ewo=(u,B,Q,ca,qa)=>{if(1===Q)return 32;if(!qa)return 2;this.zlb.set("Source",Gb.a[this.ga.y0]);this.SWe.fYc?this.zlb.set("Action","Removed"):this.zlb.set("Action",
"Applied");xa.Health.instance.recordKpiUsage(this.kpiName,1,this.I8,this.zlb);u=document.getElementsByTagName("head")[0];if(!this.SWe.WIo(u))return r.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Fb.App.za.cH({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.FJn=(u,B,Q,ca,qa)=>{if(1===Q)return 32;qa[gg.a.On]=this.SWe.fYc;return 32};this.ga=b;this.SWe=h}Tb(){this.ga.fb(Ob.a.Die,vc.a.application,this.ewo,1);this.ga.fb(Ob.a.l4i,vc.a.application,this.FJn,96)}}Object(m.a)(lx,
"VisiMarkersActor",null,[]);var Jv=c(108);class $x{constructor(b,h,u,B,Q){this.Jn=b;this.hhn=h;this.Bj=u;this.Pd=B;this.ig=Q}get gRi(){return this.hhn.value}execute(b,h,u,B){const Q=Wh.a.instance.Ap(Ob.a.Zho);Yc.OutlineElementReader.isEmpty(b,!1)?this.hxl(b):this.ixl(b,h,u,B);Q.end()}hxl(b){this.gRi.v5e(b,-1)?this.gRi.MSa(b,-1,0):this.Jn.QHa(b,{y9i:!0})}ixl(b,h,u,B){h=B(b,h,u);b=me.ParagraphReader.fl(b.currentNode);!this.Jn.LQb&&this.fUm(b)&&this.fuk(h);this.Jn.i6();(null===b||void 0===b?0:b.qa)&&
!b.qa.last.formatting&&this.ig.i1a(b)}fUm(b){return b.Ji&&!b.Oz.hasProperty(Jc.a.listID)}fuk(b){gf.OutlineElementNavigator.Ce(b);b=b.currentNode;const h=new Jv.a;b.Lc.Su(h);this.Bj.sV(b,h,this.Pd.tg)}}Object(m.a)($x,"ListNewLineStrategy",null,[]);var is=c(1214);class Mx{constructor(b,h,u,B,Q,ca){this.u$m=b;this.rqa=h;this.q8a=u;this.Zs=B;this.l1=Q;this.JYf=ca;this.pzi=!1;this.U1c=(qa,Qa,rb)=>{if(1===rb)return 32;qa=this.pageContentNode.ja(Xe.a.YU,zl.a.white);(new is.a(Mx.rIc,Ob.a.Ekc)).ilc(qa);return 32};
this.Hhc=(qa,Qa,rb,Lb,Yb)=>{if(1===rb)return 32;qa=this.pageContentNode.ja(Xe.a.YU,zl.a.white);qa=zl.a.aF(qa);this.HFa(this.JYf);this.JYf.sPb=qa;this.l1.Ene(qa);qa=this.JYf.oOc(this.pageContentNode,Fb.App.VBb);if(!qa)return 8;Yb.MenuItems=qa;r.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.j1e=(qa,Qa,rb,Lb,Yb)=>{if(1===rb)return 32;Qa=this.Zs.Pc(15);Qa.Db(this.pageContentNode);switch(qa){case Ob.a.sFd:this.pageContentNode.removeProperty(Xe.a.YU);break;case Ob.a.TTa:Yb=
this.q8a.cva(this.pageContentNode,Yb);this.pageContentNode.setValue(Xe.a.YU,Yb);break;case Ob.a.Ekc:qa=this.q8a.cva(this.pageContentNode,Yb),this.pageContentNode.setValue(Xe.a.YU,qa),this.l1.VZa(Yb)}Qa.dispose();return 32}}HFa(b){this.pzi||(b.dX(2,Ob.a.sFd),b.dX(3,Ob.a.TTa),b.dX(4,Ob.a.TTa),b.dX(5,Ob.a.Ekc),b.dX(6,Ob.a.U1c),b.qAb(this.u$m,1),this.pzi=!0)}Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.U1c,vc.a.view,this.U1c);b.ra(Ob.a.Hhc,vc.a.view,this.Hhc);b.ra(Ob.a.TTa,vc.a.view,this.j1e);b.ra(Ob.a.sFd,
vc.a.view,this.j1e);b.ra(Ob.a.Ekc,vc.a.view,this.j1e);b.Xc(Ob.a.Hhc,1127)}get pageContentNode(){return this.rqa.value}}Mx.rIc="Page";Object(m.a)(Mx,"PageColorActor",null,[]);var yw=c(474),qv=c(541),Nx=c(1218);class Xi{wc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new us(Cr.a.jGb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();b.ia("Box4.Actors.Box4PasteStewardUtils",()=>
new tB(v.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();b.ia("Box4.Actors.ClipboardActor",()=>new xB.ClipboardActor(b.Re("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),Wh.a.instance,b.resolve("Box4.IClipboardDataHelper"),xf.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,hd.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),
b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),v.AFrameworkApplication.vfg(),v.AFrameworkApplication.Npj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ga.a.instance.resolve("Common.IReactContextualUILauncher"),!!Fb.App.instance&&Fb.App.instance.lia)).ha();b.ia("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new pz(v.AFrameworkApplication.K)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManagerFactory",
()=>new EB(v.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),gv.a.instance)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ia("Box4.Actors.ISystemClipboard",()=>new Wx(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),nb.InteractiveViewManager.instance,Fb.App.za.jb,hd.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),
b.resolve("Box4.IEditViewStateManager"),gv.a.instance,v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IDeleteTableSegmentStrategy",()=>new FB).ha();b.ia("Box4.ISelectionFactory",()=>new Rn.a).ha();b.ia("Box4.IRenderOrderGraphIteratorFactory",()=>new Dr).ha();b.ia("Common.IDomElementContentStateFactory",()=>new lw).ha();b.ia("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new jA(xf.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();b.ia("Box4.Actors.PastedContentsPostProcessorHelper",
()=>new sA).ha();b.ia("Box4.Actors.PasteFloatiePositionProvider",()=>new ys(xf.a.instance,b.resolve("Box4.ITextMetricsAdapter"),nb.InteractiveViewManager.instance,Qd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Fb.App.instance&&Fb.App.instance.lia)).ha();b.ia("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new wz(b.resolve("Box4.IClipboardDataHelper"),Fb.App.Gv.$I)).ha();b.ia("Box4.Actors.PasteFloatieEventManager",()=>new vz(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),
nb.InteractiveViewManager.instance,Rx.a.instance(),v.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Fb.App.ni.zl.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Fb.App.instance&&Fb.App.instance.lia)).ha();b.ia("Box4.Actors.IClipboardOperationPasteFactory",()=>new dv(Wh.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.PasteCoordinator"),vs.a.instance,xf.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Re("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new qp(v.AFrameworkApplication.va,Wh.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.IOutlineElementEditor"),xf.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),Rp.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Oa("Box4.IFeatureHelper"))).ha();b.ia("Box4.Actors.IClipboardOperationClipboardAccessHelper",
()=>new nz(Wh.a.instance,gv.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),v.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new gq(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IClipboardOperationFactory",()=>new cp(b.resolve("Box4.Actors.InternalClipboard"),v.AFrameworkApplication.va,v.AFrameworkApplication.rfg(),Wh.a.instance,Rp.a.instance,gv.a.instance,
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),
b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new lv(b.Re("Box4.Actors.IBox4PasteStewardFactory"),b.Re("Box4.Actors.IBox4ImageStewardFactory"),b.Re("Box4.Actors.IBox4TableStewardFactory"),b.Re("Box4.Actors.IBox4WordConverterFactory"),b.Re("HtmlImport.IHtmlTranslatorSettings"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),
b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.Actors.InternalClipboard",()=>new hu.a(b.resolve("Box4.Images.IImageEditor"),b.Re("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Fb.App.ni,b.resolve("Box4.IParagraphIndentationReader"),v.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").Yhj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ia("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new Nh(b.resolve("Box4.Actors.InternalClipboard"),b.Oa("Box4.IContentControlCopyPasteHelper"),new hg.a(()=>Fb.App.za.jb.qc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.List.IListCommands",()=>new zz(v.AFrameworkApplication.va)).ha();b.ia("Box4.List.ListNewLineStrategy",()=>new $x(b.resolve("Box4.List.IListEditor"),b.Re("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ia("Box4.Actors.PasteCoordinator",()=>new Ag(b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),ti.a.instance)).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new Cv(b.resolve("Box4.Images.IImageEditor"),v.AFrameworkApplication.oc,b.resolve("Box4.IUndoManager"),b.Oa("Box4.Actors.IImageStewardBridge"),Fb.App.za.notificationBar,b.Oa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();
b.ia("Box4.Actors.Box4TableStewardFactory",()=>new Ft(Ga.a.instance.resolve("Box4.List.IListEditor"),Ga.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").ha();b.ia("Box4.Actors.ClipboardOperationWordStrategy",()=>new yB(Wh.a.instance,xf.a.instance,Fb.App.xd,ti.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",
()=>new Ur(v.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").ha();b.ia("Box4.Actors.IExternalPasteCssConverter",()=>new io(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IHtmlNormalizerHelper",()=>new Gt).ha();b.ia("Box4.ISelectionCommands",()=>new Ll(v.AFrameworkApplication.va)).ha();b.ia("Box4.ITextFormattingCommands",()=>new Zx(v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.AccessibilityActor",()=>new Tx(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();
b.ia("Box4.Actors.InsertionPointFormatting",()=>new gx(b.Oa("Box4.IFontSlotProvider"),b.Ta("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ia("Box4.UI.PasteFloatieManager",()=>new hv).as("Box4.UI.IFloatieManager").ha();b.ia("Box4.Actors.ProofingActor",()=>new GB(Ga.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.va,()=>Ga.a.instance.resolve("Box4.UI.ILanguageDialog"),Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
xf.a.instance,Ga.a.instance.Ta("Box4.IExternalSelectionManager"),Rp.a.instance,Ga.a.instance.resolve("Box4.ISelectionContextMenuProvider"),ti.a.instance,Wh.a.instance,Ga.a.instance.resolve("Box4.IContextMenuController"),Ga.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ga.a.instance.Ta("Box4.Actors.IProofingErrorPresenter"),Ga.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Ga.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ia("Box4.Actors.StyleActor",
()=>new Bz(Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ga.a.instance.resolve("Box4.IFormattingEditor"),On.ContextSetEditor.instance,Ga.a.instance.resolve("Box4.IInsertionPointFormatting"),ti.a.instance,Wh.a.instance,Ga.a.instance.resolve("Box4.TextFormattingHelper"),xw.instance,Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ia("Box4.Actors.StyleContextMenuActor",
()=>new Sx(Ga.a.instance.resolve("Box4.IUpdateStyleManager"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.TextFormattingActor",()=>new kx.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Oa("Box4.IFontSlotProvider"),b.Oa("Box4.IContentControlChpHelper"),Ga.a.instance.resolve("Box4.IFormattingEditor"),Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.IParagraphEditor"),
Ga.a.instance.resolve("Box4.ILineSpacingHelper"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),Ga.a.instance.resolve("Box4.List.IListFormattingEditor"),Ga.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("Box4.Actors.AutoCorrectActor",()=>new dq(v.AFrameworkApplication.va,Wh.a.instance,()=>Ga.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ia("Box4.Actors.TouchInputActor",
()=>new Bp(v.AFrameworkApplication.va,v.AFrameworkApplication.K,sq.GrippersManager.instance,xf.a.instance)).as("Box4.ITouchInputActor").ha();b.register(ho,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ia("Box4.Actors.VisiMarkersActor",()=>new lx(v.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).ha();b.ia("Box4.Actors.IndentationActorExtension",()=>new uA).as("Box4.Actors.IIndentationActorExtension").ha();Object(qv.a)()&&b.ia("Box4.Actors.PageColorActor",()=>
new Mx(yw.a.instance,new hg.a(()=>Fb.App.za.jb.qc.ed),Zn.a.instance,$k.a.instance,Ga.a.instance.Oa("Box4.UI.RecentColorsSectionHandler"),new Nx.a(Mx.rIc))).ha()}}Object(m.a)(Xi,"Box4ActorsComponentConfiguration",null,[2]);var sl=c(222),Fr=c(1098);const cg=()=>{const b=sB;v.AFrameworkApplication.va.ra(Ob.a.Eff,vc.a.chb,b);v.AFrameworkApplication.va.ra(Ob.a.Eff,vc.a.Y7b,b);v.AFrameworkApplication.va.ra(Ob.a.Dff,vc.a.chb,Ly);v.AFrameworkApplication.va.ra(Ob.a.Dff,vc.a.Y7b,Ly)},sB=(b,h,u)=>Fb.App.pKd?
8:2===u?(b=new mg.StandardDialog,b.Cd=4,b.rV(1),b.xe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.xe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.jgg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,ku),32):2,ku=b=>{1===b&&v.AFrameworkApplication.va.processAction(Ob.a.Dff,2)},Ly=(b,h,u)=>{if(Fb.App.pKd)return 8;if(1===u)return h.node.hasProperty(Xe.a.embeddedFileContainer)?32:2;if(2===u&&(h.contextId===vc.a.view&&h.view.mb&&
(h=h.view.mb.ng),sl.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=Fr.a.RVl(h.node);ac.a.Lmo();try{My(b)}catch(B){r.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",B)}}return 32},My=b=>{Qd.a.om(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var vC=c(783);class Ht{constructor(b){this.yBa=this.WV=null;this.Sia=(h,u,B,Q,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Rb(Ob.a.r6a,2,ca);h=ca&&0<=ca.fontColor&&16777215>=ca.fontColor?ca.fontColor:0;Fb.App.za.dismissFloatie();
(new is.a(Ht.rIc,Ob.a.gra)).ilc(h);return 32};this.eNb=(h,u,B,Q,ca)=>{if(1===B)return 32;if(2===B&&!ca)return 8;h=Ht.wi.rSd(u);u=new vC.a;B=null;32===v.AFrameworkApplication.va.Rb(Ob.a.r6a,2,u)&&u&&(B=u.fontColor);Q="";B&&!u.a8b&&(Q=zl.a.aF(B)||"");this.w0h.sPb=Q;this.cXc&&this.l1.Ene(Q);h=this.w0h.oOc(h,Fb.App.VBb);if(!h)return 8;ca.MenuItems=h;r.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.EJe=b}get w0h(){this.WV||(this.WV=new Nx.a(Ht.rIc),this.HFa(this.WV));
return this.WV}HFa(b){b.dX(1,Ob.a.wga);b.dX(3,Ob.a.Xv);b.dX(4,Ob.a.Xv);b.dX(5,Ob.a.gra);b.dX(6,Ob.a.Sia);b.qAb(this.EJe,1)}Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.Sia,vc.a.view,this.Sia);b.ra(Ob.a.eNb,vc.a.view,this.eNb);b.Xc(Ob.a.eNb,1127)}static PWl(){return new Ht(yw.a.instance)}static get instance(){return null!=Ht.CAg?Ht.CAg:Ht.CAg=Ht.PWl()}get l1(){return null!=this.LEg?this.LEg:this.LEg=Ga.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get wi(){return Df.PageReader.instance}get cXc(){null==
this.yBa&&(v.AFrameworkApplication.le("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.yBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.yBa}}Ht.rIc="Font";Object(m.a)(Ht,"FontColorActor",null,[]);class Kv{constructor(b){this.Sia=(h,u,B,Q,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Rb(Ob.a.r6a,2,ca);h=ca&&0<=ca.highlight&&16777215>=ca.highlight?ca.highlight:0;Fb.App.za.dismissFloatie();
(new is.a("Highlighter",Ob.a.v$)).ilc(h);return 32};this.ga=b}Tb(){this.ga.ra(Ob.a.eYi,vc.a.view,this.Sia)}static HYl(){return new Kv(v.AFrameworkApplication.va)}static get instance(){return null!=Kv.nBg?Kv.nBg:Kv.nBg=Kv.HYl()}}Object(m.a)(Kv,"HighlighterColorActor",null,[]);var nr=c(373),uq=c(88);class Gr{static get Yg(){return Hf.a.Bz(Gr.Sm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Gr.Sm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(Gr,"InsertLinkDialogHtml",null,[]);class Ao extends Hf.a{constructor(b){super();this.V6d=()=>{const h=document.getElementById("txtLink");this.bra(1,!h||!h.value.length||ok.a.y4a(h.value))};this.SAf=(h,u)=>{if(this.lh.kv){var B=this.lh.mb.hb.lb;if(B)if(B.equals(this.Cx)&&0!==h){h=new Qg.GraphTransaction(15);h.Db(this.pT[0].node);for(B=0;B<this.pT.length;B++)this.pT[B].node.uJ().mF.V7(4);B=u.txtLink.trim();u=this.Yhl();B=this.uBm(B);(u||B)&&Ao.Pd.Us(7);this.hide();h.dispose()}else this.lh.U5()}};
this.pT=b;this.lh=nb.InteractiveViewManager.instance.zd;this.Cx=this.lh.mb.hb.lb;this.akf=b[0].cpBegin;this.CIf=b[b.length-1].cpEnd;this.ug="InsertMultiParagraphLinkDialog";b=this.qTo();this.showDialog("",b)}showDialog(b,h){r.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Yg=Gr.Yg;""===h.trim()&&this.xe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Qh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.SAf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;Ao.hEf&&(b=document.getElementById("txtLink"),Me.a.addHandler(b,Kd.a.input,this.V6d),Me.a.addHandler(b,Kd.a.yHc,this.V6d))}hide(){if(Ao.hEf){const b=document.getElementById("txtLink");b&&(Me.a.removeHandler(b,Kd.a.yHc,this.V6d),Me.a.removeHandler(b,Kd.a.input,this.V6d))}super.hide()}Kva(b){return Ao.hEf?this.UNl(this.Usc)?super.Kva(b):!1:super.Kva(b)}qTo(){let b;var h="";const u=this.pT.length,B=ok.a.EA(this.pT[0],!1);0<B.length&&({cpBegin:Q,cpEnd:b}=
Ao.q0.Dha(this.pT[0],B[0]),Q<=this.pT[0].cpBegin&&(h=B[0].hyperlink.url),this.akf=Math.min(this.akf,Q));var Q=ok.a.EA(this.pT[u-1],!1);0<Q.length&&({cpBegin:Q,cpEnd:b}=Ao.q0.Dha(this.pT[u-1],Q[Q.length-1]),this.CIf=Math.max(this.CIf,b));this.pMo(this.akf,this.CIf);return h}pMo(b,h){const u=this.pT.length;if(b!==this.pT[0].cpBegin||h!==this.pT[u-1].cpEnd){b=Je.a.Oc(this.pT[0].node,b);b=Cg.SelectionFactory.Tn(b);h=Je.a.Oc(this.pT[u-1].node,h);h=Cg.SelectionFactory.Dy(b,h);b=this.yhi(h.Pa.clone());const B=
this.yhi(h.Rc.clone());b&&B&&(this.pT[0]=b,this.pT[u-1]=B,this.lh.mb.Bc(h),this.Cx=h)}}uBm(b){if(!b)return!1;b=ok.a.PPa(b);for(let u=0;u<this.pT.length;u++){var h=this.pT[u];if(Ao.vua&&Ge.SelectionEditor.nl(h)&&(h=Ge.SelectionEditor.mmg(h),!Ge.SelectionEditor.nl(h)))continue;h=Je.a.createTextRange(this.pT[u].node,h.cpBegin,h.cpEnd);this.RLo(h);Ao.Sp.qG(h,b,!1)}return!0}RLo(b){uq.a.instance.J(1)&&Ao.Pd.jAj(b)}yhi(b){return me.ParagraphReader.nm(b)&&!Ge.SelectionEditor.l9(b)&&me.ParagraphReader.textLength(b.node)?
Je.a.createTextRange(b.node,0,me.ParagraphReader.textLength(b.node)):Ge.SelectionEditor.nl(b)?b:null}Yhl(){let b=!1;for(const h of this.pT){const u=ok.a.EA(h,!1);u&&(b=Ao.q0.v9i(h,u)||b)}return b}static get q0(){return null!=Ao.Jzg?Ao.Jzg:Ao.Jzg=Ga.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Pd(){return null!=Ao.hHg?Ao.hHg:Ao.hHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Sp(){return null!=Ao.Azg?Ao.Azg:Ao.Azg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get vua(){null==
Ao.V$&&(Ao.V$=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ao.V$}static get hEf(){null==Ao.hFe&&(Ao.hFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return Ao.hFe}}Ao.V$=null;Ao.hFe=null;Object(m.a)(Ao,"InsertMultiParagraphLinkDialog",Hf.a,[]);var Cz;(function(b){b.A8o="Heading";b.Bookmark="Bookmark";b.Url="Url";b.o$o="RecentLinks"})(Cz||(Cz={}));Object(m.b)("InsertLinkUserActivitySource",
Cz);class ay{constructor(b,h,u,B,Q){this.linkurl=b;this.isHeading=h;this.startCp=u;this.endCp=B;this.paragraphNode=Q}}Object(m.a)(ay,"HeadingDataForLinkDialog",null,[]);class HB{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(m.a)(HB,"BookmarkDataForLinkDialog",null,[]);class vA{constructor(b,h,u,B,Q,ca){this.key=b;this.name=h;this.startIndex=u;this.count=B;this.level=Q;this.isCollapsed=ca}}Object(m.a)(vA,"GroupHeaderDataForLinkDialog",null,[]);class cD{constructor(b,h){this.selectedIndex=
b;this.selectedGroupId=h}}Object(m.a)(cD,"SelectedItemFromLinkDialogGroupedList",null,[]);class wA{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.hr=b;this.Ad=h;this.Apl=u;this.bookmarkManager=B;this.q0=Q;this.Sp=ca;this.ig=qa;this.Pd=Qa;this.Bj=rb;this.Ck=Lb;this.kxa=Yb;this.SEb=null;this.Gvi=!1;this.SAf=(Sc,ld)=>{var Hd;if(this.ie.kv){var Ie=ok.a.ZQc(this.hr),fe=this.ie.mb.hb.lb;if(fe){fe=fe.Pa;me.ParagraphReader.nm(fe)&&(fe=Je.a.createTextRange(fe.node,0,me.ParagraphReader.textLength(fe.node)));
var de=Ge.SelectionEditor.URb(fe);Ge.SelectionEditor.nl(de)&&(fe=de);if(0!==Sc&&32===v.AFrameworkApplication.va.Kf(fe,Ob.a.insertHyperlink,1,!0,null,null)&&this.hr.equals(fe)){Gj.a.mark(5562);(null===(Hd=Fb.App.xd)||void 0===Hd?0:Hd.So)&&this.ie.mb.x1b();Sc=new Qg.GraphTransaction(15);Sc.Db(this.hr.node);this.hr.node.uJ().mF.V7(4);Hd=ld.txtDisplay;fe=!1;if(null!=ld.linkurl)if(fe=!0,ld.isHeading){l(this.Ad,"Heading");de=ld.paragraphNode;const ne=ld.startCp,ye=ld.endCp;ld=this.bookmarkManager.hNl(de);
this.bookmarkManager.ZEc(ld,ne,ye,de,de,!1)}else l(this.Ad,"Bookmark"),ld=ld.linkurl;else l(this.Ad,"Url"),ld=ld.txtLink.trim();this.insertLink(Hd,ld,Ie,fe);Sc.Qj=Ob.a.insertHyperlink;Sc.dispose();Gj.a.mark(5563);this.hr.node.mhb()}else this.ie.U5()}else r.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ie=nb.InteractiveViewManager.instance.zd;this.hr=b;u=Ge.SelectionEditor.URb(this.hr);Ge.SelectionEditor.nl(u)&&(this.hr=u);const gc=
new Hf.a(!1,!1,!0);u=this.TXl();B={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:u};Q=this.SEb="";Q=me.ParagraphReader.text(this.hr.node);qa=this.hr.cpBegin;Qa=this.hr.cpEnd;({sag:Q,uif:qa,vif:Qa,Syf:ca}=this.wTl(Q));if((h="object"===typeof h?h:null)&&
(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,ca);else{ca[0]&&this.Gxl(qa,Qa,ca[0].paragraph);h=""===Q.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;gc.xe(1,h);(null===Q||void 0===Q?0:Q.startsWith(F.a.Teb))?(h=this.fbm(Q,u))?u.selectedItem=h:B.txtLink=Q:B.txtLink=Q;B.txtDisplay=this.SEb;1>=ca.length&&this.q0.j3k(b,ca[0],1===ca.length)&&(this.Gvi=!0,B.textDisplayDisabled=!0);var Fc={["id"]:"InsertLinkDialog",["bodyControls"]:B};
this.Ck.ge(()=>{gc.Qh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.SAf,Fc)},"RILD:IAS")}}wTl(b){const h=ok.a.ZQc(this.hr);let u=this.hr.cpBegin,B=this.hr.cpEnd,Q="";if(!h.length)return this.SEb=b.substring(this.hr.cpBegin,this.hr.cpEnd),{returnValue:!0,sag:Q,uif:u,vif:B,Syf:h};if(h[0].hyperlink){let ca,qa=0,Qa=Math.max(0,b.length-1),rb=0;for(let Lb=0;Lb<h.length;Lb++)h[Lb].cpBegin>=qa&&({cpBegin:ca,cpEnd:qa}=this.q0.Dha(this.hr,h[Lb]),Qa=Math.min(ca,Qa),rb=Math.max(qa,rb));u=Math.min(Qa,u);B=Math.max(rb,
B);this.SEb=b.substring(u,B);u===Qa&&(Q=h[0].hyperlink.url);return{returnValue:!0,sag:Q,uif:u,vif:B,Syf:h}}return{returnValue:!1,sag:Q,uif:u,vif:B,Syf:h}}Gxl(b,h,u){if(h!==this.hr.cpEnd||b!==this.hr.cpBegin)b=Cg.SelectionFactory.gJ(u,b,h),this.ie.mb.Bc(b),this.hr=Ge.SelectionEditor.URb(b.Pa.clone())}gKo(b,h,u,B,Q,ca=!1){B?(B=Je.a.createTextRange(this.hr.node,this.hr.cpBegin,this.hr.cpBegin+b.length),this.Sp.Arl(B,u,h),b=Cg.SelectionFactory.ne(this.hr.node,this.hr.cpBegin+b.length)):(this.Sp.Imb(this.hr,
2),this.Bj.Epb(this.hr,2),u=Je.a.Oc(this.hr.node,this.hr.cpEnd),this.ig.Ge(u,b,!0),B=Je.a.createTextRange(this.hr.node,this.hr.cpEnd,this.hr.cpEnd+b.length),this.Sp.qG(B,h,Q,!1,!0,ca),b=Cg.SelectionFactory.ne(this.hr.node,this.hr.cpEnd+b.length));b&&this.ie.mb.Bc(b)}insertLink(b,h,u,B=!1){var Q=null;b||(b=h,v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!u.length||h!==u[0].hyperlink.url)&&!B){h=ok.a.PPa(h);
var ca="";this.kxa&&({d6f:ca}=this.kxa.rmg(h)).returnValue&&(h=ca)}this.Gvi||(b=this.Sp.P1n(b));ca=!1;if(h){Q=0<u.length;const qa=me.ParagraphReader.text(this.hr.node).substring(this.hr.cpBegin,this.hr.cpEnd)!==b,Qa=this.Pd.tg;if(Qa&&1===u.length&&!u[0].hyperlink.JG&&!(u[0].cpBegin>this.hr.cpBegin&&u[0].cpEnd<=this.hr.cpEnd)){this.gKo(b,h,u[0].hyperlink,!qa,Q,B);return}if(Q)for(let rb=0;rb<u.length;rb++)u[rb].hyperlink.JG&&(ca=!0),this.Sp.fS(this.hr.node,u[rb].hyperlink,!1);qa?this.ig.Ge(this.hr,
b,!ca):Qa&&!ca&&this.Bj.Epb(this.hr,1);u=Je.a.createTextRange(this.hr.node,this.hr.cpBegin,this.hr.cpBegin+b.length);this.Sp.qG(u,h,Q,ca,!0,B);Q=Cg.SelectionFactory.ne(this.hr.node,this.hr.cpBegin+b.length)}else 0<u.length&&(b=u[0],b.hyperlink.JG&&(ca=!0),this.Sp.fS(b.paragraph,b.hyperlink));ca&&this.Pd.Us(ca?2:7);Q&&this.ie.mb.Bc(Q);Fb.App.ELo()}fbm(b,h){h=h.items;const u=b.substring(F.a.Teb.length),B=this.bookmarkManager.Eci(u);b=-1;let Q=0;for(let ca=0;ca<h.length;ca++)if(h[ca].isHeading&&0!=B.count&&
h[ca].paragraphNode.id==B.J(0).id){b=ca;break}else if(!h[ca].isHeading&&h[ca].linkurl==u){b=ca;Q=1;break}h=new cD(b,Q);return-1!=b?h:null}TXl(){const b={};let h=[],u=0,B=0;var Q=this.Apl.tYl();Q&&(u=Q.count,h=h.concat(this.yYl(Q)));if(Q=this.bookmarkManager.hPd(!1))B=Q.count,h=h.concat(this.lNl(Q));b.groups=this.mYl(u,B);b.items=h;return b}mYl(b,h){const u=[],B=new vA("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);u.push(B);b=new vA("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,
b,h,0,!0);u.push(b);return u}yYl(b){const h=[],u=/\uFFFC/;for(const B of b)b=B.characterData.replace(u," "),b=new ay(b,!0,B.Ac,B.end,B.paragraphNode),h.push(b);return h}lNl(b){const h=[];for(const u of b)b=u.rf(Jc.a.zt).toString(),b=new HB(b,!1),h.push(b);return h}}Object(m.a)(wA,"ReactInsertLinkDialog",null,[]);class mf{static get Uf(){return ti.a.instance}static get sX(){return null!=mf.Nvg?mf.Nvg:mf.Nvg=Ga.a.instance.Oa("Box4.IContentControlChpHelper")}static get q0(){return null!=mf.Kzg?mf.Kzg:
mf.Kzg=Ga.a.instance.resolve("Box4.IHyperlinkStrategy")}static fx(){return mf.Zm||(mf.Zm=Ga.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Pd(){return null!=mf.tHg?mf.tHg:mf.tHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Dh(){return null!=mf.AHg?mf.AHg:mf.AHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Xg(){return On.ContextSetEditor.instance}static get Hc(){return Wh.a.instance}static get d0c(){null==
mf.dsb&&(mf.dsb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return mf.dsb}static get vua(){null==mf.V$&&(mf.V$=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return mf.V$}static get Sp(){return null!=mf.Gzg?mf.Gzg:mf.Gzg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get ig(){return null!=mf.yvg?mf.yvg:mf.yvg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get l4a(){mf.FFe||
(mf.FFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"):!1);return mf.FFe}static get GHo(){mf.Phh||(mf.Phh=v.AFrameworkApplication.K?v.AFrameworkApplication.K.lc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return mf.Phh}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.insertHyperlink,vc.a.view,mf.DHb);b.ra(Ob.a.insertHyperlink,vc.a.Tc,mf.insertLink);b.ra(Ob.a.insertHyperlink,vc.a.Jd,mf.insertLink);b.Xc(Ob.a.insertHyperlink,
1028);b.ra(Ob.a.Q6b,vc.a.view,mf.DHb);b.ra(Ob.a.Q6b,vc.a.Tc,mf.insertLink);b.ra(Ob.a.Q6b,vc.a.Jd,mf.insertLink);b.Xc(Ob.a.Q6b,1028);b.ra(Ob.a.fS,vc.a.view,mf.DHb);b.ra(Ob.a.fS,vc.a.Tc,mf.F9i);b.ra(Ob.a.fS,vc.a.Jd,mf.F9i);b.Xc(Ob.a.fS,1028);b.ra(Ob.a.Ree,vc.a.view,mf.DHb);b.ra(Ob.a.Ree,vc.a.Tc,mf.Igj);b.ra(Ob.a.Ree,vc.a.Jd,mf.Igj);b.ra(Ob.a.O5a,vc.a.view,mf.DHb);b.ra(Ob.a.O5a,vc.a.Tc,mf.hYi);b.ra(Ob.a.O5a,vc.a.Jd,mf.hYi);b.ra(Ob.a.O5a,vc.a.image,mf.eYf);b.ra(Ob.a.O5a,vc.a.EEb,mf.eYf);b.ra(Ob.a.O5a,
vc.a.M7,mf.eYf);b.ra(Ob.a.aIc,vc.a.application,mf.aIc);b.ra(Ob.a.IHd,vc.a.view,mf.DHb);mf.l4a&&(b.fb(Za.a.y6a,vc.a.view,this.DHb.bind(this),1028),b.ra(Za.a.y6a,vc.a.Tc,this.y6a.bind(this)),b.ra(Za.a.y6a,vc.a.Jd,this.y6a.bind(this)),b.Xc(Za.a.y6a,1028),b.ra(Za.a.TAf,vc.a.Tc,this.y6a.bind(this)),b.ra(Za.a.TAf,vc.a.Jd,this.y6a.bind(this)),b.Xc(Za.a.TAf,1028),b.ra(Za.a.r0f,vc.a.view,this.r0f.bind(this)),b.ra(Za.a.l0f,vc.a.view,this.l0f.bind(this)),b.fb(Za.a.bkb,vc.a.Tc,this.bkb.bind(this),1028),b.fb(Za.a.bkb,
vc.a.Jd,this.bkb.bind(this),1028))}static aIc(){return 32}static y6a(b,h,u){if(!mf.l4a)return 2;b=mf.SHj(h);if(32!=b)return b;if(!mf.mRa(h,!0).returnValue||mf.M4b(h))return 8;1!==u||mf.x_h||(mf.Ane(!0),mf.x_h=!0);return 32}static r0f(b,h,u,B,Q){if(!mf.l4a)return 2;if(1===u)return 32;mf.ace(mf.zdk,mf.Adk,mf.ebh);nr.a.instance.ge(()=>{mf.Ane();Q.MenuItems=Object.assign(new Rk.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.YLh();ca?(r.ULS.sendTraceTag(526242130,324,50,
"Recent Links data load success in ribbon"),Q.MenuItems.MenuSectionList.push(ca)):mf.W0i(Q,mf.ebh)},"HA:PRLF");return 32}static l0f(b,h,u,B,Q){if(!mf.l4a)return 2;if(1===u)return 32;mf.ace(mf.xdk,mf.ydk,mf.dbh);nr.a.instance.ge(()=>{mf.Ane();Q.MenuItems=Object.assign(new Rk.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});Q.MenuItems.MenuSectionList.push(this.q$k());const ca=this.YLh(!0);ca?(r.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),
Q.MenuItems.MenuSectionList.push(ca)):mf.W0i(Q,mf.dbh)},"HA:PILF");return 32}static W0i(b,h){r.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);mf.ace(mf.bak,mf.cak,h);b.MenuItems.MenuSectionList.push(this.Rbl());mf.Ane(!0)}static Rbl(){const b=this.Kaf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new yg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static q$k(){const b=this.Kaf("InsertLinkSection");
b.ControlList.push(Object.assign(new yg.a,{ExternalId:"InsertLink"}));return b}static YLh(b=!1){if(Yi.instance.Ytd){var h=this.Kaf("RecentLinksSection",b);b=JSON.parse(Yi.instance.Ytd);this.Xtd.clear();b.forEach((u,B)=>{this.Xtd.set(B,[u.FileName,u.DocumentUrl]);const Q=mf.V9l(u.FileName);var ca=mf.oXl(u.TimeStamp),qa=h.ControlList,Qa=qa.push,rb=Object,Lb=rb.assign,Yb=new yg.a,gc=Za.a.bkb,Fc=Za.a.bkb;ca=Q!==u.FileName?u.FileName+"\n"+ca:ca;var Sc=u.FileName;let ld="SaveAsWordDocx_32";switch(u.App){case "Word":ld=
"SaveAsWordDocx_32";break;case "PowerPoint":ld="SaveAsPowerPointPptx_32";break;case "Excel":ld="SaveAsExcelXlsx_32"}Qa.call(qa,Lb.call(rb,Yb,{ExternalId:B,Command:gc,CommandValueId:Fc,LabelText:Q,Alt:ca,AriaDescription:Sc,ExternalImageId:ld,KeyTip:u.FileName}))});return h}}static Kaf(b,h=!1){return Object.assign(new wh.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static bkb(b,h,u,B,Q){if(!mf.l4a)return 2;
if(!Q||Q.CommandValueId!=Za.a.bkb)return 32;mf.ace(mf.o5j,mf.p5j,mf.Nek);u=h;h=new Qg.GraphTransaction(15);h.Qj=b;h.Db(u.node);B=mf.mRa(u,!0).hyperlink;u=Ge.SelectionEditor.URb(u);if(B)mf.$6f(u),b=Cg.SelectionFactory.gJ(u.node,Math.min(u.cpBegin,B.cpBegin),Math.max(u.cpEnd,B.cpEnd)),xf.a.instance.Bc(b),u=b.Pa;else if(Ge.SelectionEditor.ef(u)){var ca;Ge.SelectionEditor.hlb(u)&&(ca=Ge.SelectionEditor.c0(u,!1));ca||(ca=this.Xtd.get(Q.SourceControlId)[0],mf.ig.Ge(u,ca,!0,void 0,b),ca=Cg.SelectionFactory.gJ(u.node,
u.cpBegin,u.cpBegin+ca.length));if(ca&&(xf.a.instance.Bc(ca),u=ca.Pa,mf.M4b(u)))return mf.Pd.CQb(!1),8}try{mf.Sp.qG(u,this.Xtd.get(Q.SourceControlId)[1],0<ok.a.ZQc(u).length);const qa=Cg.SelectionFactory.ne(u.node,u.cpEnd);qa&&xf.a.instance.Bc(qa);l(Q,"RecentLinks")}finally{h&&h.dispose()}r.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static DHb(b,h,u,B,Q){if(mf.d0c)return mf.Ztm(b,h,u,B,Q);if(!h.view.qe)return 2;var ca=h.view.mb;if(!ca||!ca.hb||!ca.hb.length)return 8;var qa=
ca.hb.lb;let Qa=qa.Pa.clone();if(2===qa.length){if(qa=qa.J(1),!Ge.SelectionEditor.nl(Qa)||!Ge.SelectionEditor.Fk(qa)||Qa.node!==qa.node)return 8}else if(2<qa.length)return 8;if(ca.hb.HJ)return 8;if(mf.Xg.hAa(me.ParagraphReader.AU,ca.ng))return mf.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.yO}),8;me.ParagraphReader.nm(Qa)&&!Ge.SelectionEditor.l9(Qa)&&(ca=Qa.node,Qa=Je.a.createTextRange(ca,0,me.ParagraphReader.textLength(ca)));return b===Ob.a.IHd?mf.UIh(h,Qa,u,B):v.AFrameworkApplication.va.Kf(Qa,b,u,!0,B,Q)}static Ztm(b,
h,u,B,Q){if(!h.view.qe)return 2;var ca=h.view.mb;if(!ca||!ca.hb||!ca.hb.length||ca.hb.HJ)return 8;var qa=ca.hb.lb;if(ca=mf.DGf(qa))qa=mf.guf(qa.Pa.clone(),!0);else{let Qa=qa.J(0).clone(),rb=1;for(;rb<qa.length&&(!me.ParagraphReader.textLength(Qa.node)||Ge.SelectionEditor.Fk(Qa)||mf.vua&&Hq.l(Qa));)Qa=qa.J(rb).clone(),rb++;qa=mf.guf(Qa,!1)}return mf.vua&&Ge.SelectionEditor.nl(qa)&&Hq.l(qa)||!Ge.SelectionEditor.nl(qa)&&!ca?8:b===Ob.a.IHd?mf.UIh(h,qa,u,B):v.AFrameworkApplication.va.Kf(qa,b,u,!0,B,Q)}static DGf(b){if(1===
b.length)return!0;if(2===b.length){const h=b.Pa.clone();b=b.J(1);return Ge.SelectionEditor.nl(h)&&Ge.SelectionEditor.Fk(b)&&h.node===b.node?!0:!1}return!1}static jGh(b){let h=null;const u=[];for(let B=0;B<b.length;B++){const Q=mf.guf(b.J(B).clone(),!1);if(Ge.SelectionEditor.nl(Q))mf.vua&&Hq.l(Q)||u.push(Q);else if(!Ge.SelectionEditor.Fk(Q)&&!me.ParagraphReader.nm(Q))return{returnValue:!1,Yfb:h}}h=u;return{returnValue:!mf.vua||0<h.length?!0:!1,Yfb:h}}static insertLink(b,h,u,B,Q){if(mf.d0c)return mf.CBm(h,
u,Q);B=mf.SHj(h);if(32!==B)return B;let ca;if(!({hyperlink:ca}=mf.mRa(h,!0)).returnValue||mf.M4b(h)||!ca&&b==Ob.a.Q6b)return 8;if(1===u)return 32;if(!ca&&Ge.SelectionEditor.ef(h)&&Ge.SelectionEditor.hlb(h)&&(b=Ge.SelectionEditor.c0(h,!1))&&(xf.a.instance.Bc(b),h=b.Pa,mf.M4b(h)))return mf.Pd.CQb(!1),8;ca&&r.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,Q);return 32}static SHj(b){return!mf.t5e()||!mf.bEd(b)||b.node.Dr||xf.a.instance.hb.HJ?8:Ge.SelectionEditor.G4(b)||Hi.a.NDf(b)?2:32}static CBm(b,
h,u){var B=xf.a.instance.hb.lb;const Q=mf.DGf(B);if(Q)b=[b];else if(!({Yfb:b}=mf.jGh(B)).returnValue)return 8;if(!mf.t5e())return 8;for(B=0;B<b.length;B++)if(!mf.bEd(b[B]))return 8;if(xf.a.instance.hb.HJ)return 8;B=Array(b.length);let ca=null;for(let qa=0;qa<b.length;qa++)if(B[qa]=b[qa],!({hyperlink:ca}=mf.mRa(B[qa],!0)).returnValue||mf.M4b(B[qa]))return 8;if(1===h)return 32;if(!ca&&1===B.length&&Q&&Ge.SelectionEditor.ef(B[0])&&Ge.SelectionEditor.hlb(B[0])&&(h=Ge.SelectionEditor.c0(B[0],!1))&&(xf.a.instance.Bc(h),
B[0]=h.Pa,mf.M4b(B[0])))return mf.Pd.CQb(!1),8;Q?a(B[0],u):new Ao(B,u);return 32}static F9i(b,h,u){if(mf.d0c)return mf.gYn(b,h,u);if(!mf.bEd(h)||Ge.SelectionEditor.G4(h))return 2;let B;if(!({hyperlink:B}=mf.mRa(h,!1)).returnValue)return 2;if(2===u){u=new Qg.GraphTransaction(15);try{u.Qj=b,u.Db(B.paragraph),mf.$6f(h)}finally{u&&u.dispose()}B.hyperlink.JG&&mf.Pd.Us(2)}return 32}static gYn(b,h,u){var B=xf.a.instance.hb.lb;if(mf.DGf(B))h=[h];else if(!({Yfb:h}=mf.jGh(B)).returnValue)return 8;if(!mf.t5e())return 8;
for(B=0;B<h.length;B++)if(!mf.bEd(h[B]))return 8;if(1===u&&!mf.mRa(h[0],!1).returnValue)return 2;if(2===u){for(u=0;u<h.length;u++)if(!mf.mRa(h[u],!0).returnValue)return 2;u=new Qg.GraphTransaction(15);try{const Q=h[0];u.Qj=b;u.Db(Q.node);for(b=0;b<h.length;b++)mf.$6f(h[b])}finally{u&&u.dispose()}mf.Pd.Us(7)}return 32}static $6f(b){const h=ok.a.ZQc(b);let u=0;for(let B=0;B<h.length;B++)if(h[B].cpBegin>=u){const Q=({cpEnd:u}=mf.q0.Dha(b,h[B])).returnValue;mf.q0.v9i(b,Q)}}static Igj(b,h,u){if(Dd.ImageReader.C3a(h)||
!({hyperlink:b}=mf.mRa(h,!1)).returnValue)return 2;if(2===u){const {cpBegin:B,cpEnd:Q}=mf.q0.Dha(h,b);xf.a.instance.Bc(Cg.SelectionFactory.gJ(b.paragraph,B,Q))}return 32}static hYi(b,h,u){if(({hyperlink:b}=mf.PUm(h)).returnValue)r.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=mf.mRa(h,!1)).returnValue)return 2;2===u&&Fb.App.Phb(b.hyperlink.url);return 32}static eYf(b,h,u){b=Dd.ImageReader.Dha(h.node);if(!b)return 2;2===u&&Fb.App.Phb(b);return 32}static UIh(b,
h,u,B){if(Dd.ImageReader.C3a(h)||!nb.InteractiveViewManager.instance.ve.Vj)return 2;let Q;if(!({hyperlink:Q}=mf.mRa(h,!1)).returnValue)return 2;if(1===u)return 32;const {cpBegin:ca,cpEnd:qa}=mf.q0.Dha(h,Q);xf.a.instance.Bc(Cg.SelectionFactory.gJ(Q.paragraph,ca,qa));h=nb.InteractiveViewManager.instance.xDa.ownerDocument.createElement("span");h.innerText=Q.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return v.AFrameworkApplication.va.Kf(b,Ob.a.HHd,2,!0,B,h)}static mRa(b,h){if(Ge.SelectionEditor.nl(b)){const u=
Hq.g(b),B=Cl.a.all(u,Q=>6===Q.qh);if(0<u.length&&(!mf.vua||!B)||mf.Uf.fh&&mf.sX&&0<mf.sX.XPd(b).count)return{returnValue:!1,hyperlink:null}}return mf.EUm(b,h)}static PUm(b){let h=null;return Dd.ImageReader.C3a(b)&&(h=ok.a.s9b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static EUm(b,h){let u=null;const B=ok.a.ZQc(b);return B.length?B[0].hyperlink?(u=B[0],b.cpBegin<B[0].cpBegin?{returnValue:h,hyperlink:u}:{returnValue:!0,hyperlink:u}):{returnValue:!1,hyperlink:u}:{returnValue:h,hyperlink:u}}static M4b(b){if(uq.a.instance.J(1)){b=
mf.Dh.QPa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Kd.changeType)return!0}return!1}static t5e(){return uq.a.instance.J(1)?!0:!uq.a.instance.J(1)||!Fb.App.Gv.QRb}static bEd(b){return mf.Uf.R_(b)||mf.Uf.hia(b)||mf.fx()&&mf.fx().instance&&mf.fx().instance.EU(b)?!1:!0}static guf(b,h){return me.ParagraphReader.nm(b)&&!Ge.SelectionEditor.l9(b)&&(me.ParagraphReader.textLength(b.node)||h)?Je.a.createTextRange(b.node,0,me.ParagraphReader.textLength(b.node)):b}static V9l(b){return b&&
b.length<=mf.a6i?b:b.substring(0,mf.a6i)+"..."}static oXl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static Ane(b=!1){const h=Date.now();if(b||h-mf.lEi>mf.GHo)Yi.instance.u7m(),mf.lEi=h}static ace(b,h,u){const B=new Map;B.set("Source",u);B.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.SWa,B)}}mf.Zm=null;mf.dsb=null;
mf.V$=null;mf.Xtd=new Map;mf.FFe=null;mf.a6i=35;mf.lEi=Date.now();mf.x_h=!1;mf.SWa="wwaengidc";mf.Nek="RecentLinks";mf.ebh="RecentLinksRibbonOptions";mf.dbh="RecentLinksContextMenuOptions";mf.zdk="PopulateRecentLinksRibbon";mf.Adk="PopulateRecentLinksRibbonAction";mf.xdk="PopulateRecentLinksContextMenu";mf.ydk="PopulateRecentLinksContextMenuAction";mf.bak="PopulateRecentLinksContextMenu";mf.cak="PopulateRecentLinksContextMenuAction";mf.o5j="InsertRecentLinks";mf.p5j="InsertRecentLinksAction";Object(m.a)(mf,
"HyperlinkActor",null,[]);class Ou{}Ou.xlb=Object.freeze({pwm:"WordIndentationShortcutUsage"});Ou.xB="wwaengidc";Object(m.a)(Ou,"IndentationConstants",null,[]);class Bm{static get mq(){return Cr.a.jGb}static get Xg(){return On.ContextSetEditor.instance}static get Uf(){return ti.a.instance}static get Hc(){return Wh.a.instance}static get lm(){return nb.InteractiveViewManager.instance}static fx(){return Bm.Zm||(Bm.Zm=Ga.a.instance.Ta("Box4.IExternalSelectionManager"))}static get owm(){return null!=Bm.Rzg?
Bm.Rzg:Bm.Rzg=Ga.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.SG,vc.a.view,Bm.ZFc);b.ra(Ob.a.SG,vc.a.HP,Bm.sth);b.Xc(Ob.a.SG,1036);b.ra(Ob.a.LO,vc.a.view,Bm.ZFc);b.ra(Ob.a.LO,vc.a.HP,Bm.sth);b.Xc(Ob.a.LO,1036)}static FPn(b){const h=new Map;b=b?b.ja(Sh.a.tpi,"Unknown"):"tab";h.set("actionCallSource",b);xa.Health.instance.recordKpiUsage(Ou.xlb.pwm,1,Ou.xB,h)}static ZFc(b,h,u,B,Q){const ca=h.view;if(!ca.qe)return 2;var qa=ca.mb;
if(!qa)return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.rda}),8;qa=qa.ng;if(!qa)return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.noSelection}),8;if(Hi.a.eia(h))return 8;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Bm.Uf.Mbc(qa))return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ZE}),8;if(1===u)return 32;if(Bm.Xg.IDa(Bm.q0e,qa))return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.UIc}),8;if(Bm.Xg.hAa(me.ParagraphReader.AU,qa))return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.yO}),8;if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",
!1)&&Bm.Uf.Mbc(qa))return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ZE}),8;if(Bm.fx()&&Bm.fx().instance&&Bm.fx().instance.EU(qa))return Bm.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.o1a}),8;qa={};qa[Ap.a.GJa]=5794;qa[Ap.a.FJa]=5795;return Bm.owm.ZFc(ca,b,h,u,B,Q,qa)}static sth(b,h,u,B,Q){var ca,qa;if(h.contextId!==vc.a.HP)return 2;var Qa=h.clone().ghg();if(Zi.TableReader.RBi(Qa)){if(Bm.Uf.SBi(Qa))return Bm.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),8}else if(Bm.Uf.m4a(Qa))return Bm.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),2;Qa=
new vd.GraphIterator;Qa.set(h.node);Ge.SelectionEditor.yu(Qa);if(!Yc.OutlineElementReader.Bh(Qa))return 2;let rb;switch(b){case Ob.a.SG:rb=Bm.mq.ABb(Qa);break;case Ob.a.LO:rb=Bm.mq.G3b(Qa);break;default:return 2}if(1===u||!rb)return rb?32:8;u=0;b===Ob.a.LO&&Q&&Q.ja($c.a.gvh,!1)&&(u|=2);if(Yc.OutlineElementReader.UQ(Qa))return Bm.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.yO}),2;(null===(qa=null===(ca=Bm.lm)||void 0===ca?void 0:ca.zd)||void 0===qa?0:qa.FU)&&Bm.lm.ve&&(Bm.lm.ve.kI=!0);switch(b){case Ob.a.SG:Bm.mq.MSa(Qa,
-1,u);break;case Ob.a.LO:Bm.mq.SKc(Qa,1)}B&&Xq.a.Gqb&&(B.As|=Xq.a.rib(h.node,!0));Bm.FPn(Q);return 32}}Bm.Zm=null;Bm.q0e=Dd.ImageReader.B3a;Object(m.a)(Bm,"IndentationActor",null,[]);var ng=c(1588);class uk{static get il(){return null!=uk.bEg?uk.bEg:uk.bEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get Gk(){return null!=uk.mGg?uk.mGg:uk.mGg=Ga.a.instance.resolve("Box4.ITableEditor")}static get Uf(){return ti.a.instance}static get Hc(){return Wh.a.instance}static fx(){return uk.Zm||(uk.Zm=
Ga.a.instance.Ta("Box4.IExternalSelectionManager"))}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.$wj,vc.a.view,(h,u)=>Hi.a.eia(u)?8:32);b.ra(Ob.a.y9,vc.a.view,ng.a.jw);b.ra(Ob.a.y9,vc.a.paragraph,uk.XCa);b.ra(Ob.a.y9,vc.a.table,uk.u1e);b.Xc(Ob.a.y9,1036);b.ra(Ob.a.Aba,vc.a.view,ng.a.jw);b.ra(Ob.a.Aba,vc.a.paragraph,uk.XCa);b.ra(Ob.a.Aba,vc.a.table,uk.u1e);b.Xc(Ob.a.Aba,1036);b.ra(Ob.a.o$,vc.a.view,ng.a.jw);b.ra(Ob.a.o$,vc.a.paragraph,uk.XCa);b.ra(Ob.a.o$,vc.a.table,uk.u1e);b.Xc(Ob.a.o$,
1036);b.ra(Ob.a.NEa,vc.a.view,ng.a.jw);b.ra(Ob.a.NEa,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.NEa,1036);b.ra(Ob.a.uLc,vc.a.view,ng.a.jw);b.ra(Ob.a.uLc,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.uLc,1036);b.ra(Ob.a.UJb,vc.a.view,ng.a.jw);b.ra(Ob.a.UJb,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.UJb,1036);b.ra(Ob.a.$8c,vc.a.view,ng.a.jw);b.ra(Ob.a.$8c,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.$8c,1036);b.ra(Ob.a.qec,vc.a.view,ng.a.jw);b.ra(Ob.a.qec,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.qec,1036);b.ra(Ob.a.Y3b,vc.a.view,ng.a.jw);b.ra(Ob.a.Y3b,
vc.a.paragraph,uk.XCa);b.Xc(Ob.a.Y3b,1036);b.ra(Ob.a.rjc,vc.a.view,ng.a.jw);b.ra(Ob.a.rjc,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.rjc,1036);b.ra(Ob.a.r8b,vc.a.view,ng.a.jw);b.ra(Ob.a.r8b,vc.a.paragraph,uk.XCa);b.Xc(Ob.a.r8b,1036)}static u1e(b,h,u,B){let Q=!0;if(!h)return 8;Zi.TableReader.RBi(h)?uk.Uf.SBi(h)?(uk.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),Q=!1):uk.fx()&&uk.fx().instance&&uk.fx().instance.EU(h)&&(uk.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.o1a}),Q=!1):(uk.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.xff}),Q=!1);if(1===u||
!Q)return Q?32:8;h=h.node;switch(b){case Ob.a.y9:uk.Gk.lE(h,1);break;case Ob.a.Aba:uk.Gk.lE(h,2);break;case Ob.a.o$:uk.Gk.lE(h,3)}B&&Xq.a.Gqb&&(B.As|=2);return 32}static XCa(b,h,u,B,Q){let ca=!0;h.contextId!==vc.a.paragraph?ca=!1:uk.Uf.m4a(h)?(uk.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),ca=!1):uk.fx()&&uk.fx().instance&&uk.fx().instance.EU(h)&&(uk.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.o1a}),ca=!1);if(1===u||!ca)return ca?32:8;h=h.node;u=me.ParagraphReader.Kx(h);switch(b){case Ob.a.y9:case Ob.a.qec:uk.il.lE(h,
1===u&&uk.u0d(Q)?6:1);break;case Ob.a.Aba:case Ob.a.Y3b:uk.il.lE(h,2===u&&uk.u0d(Q)?1:2);break;case Ob.a.o$:case Ob.a.rjc:uk.il.lE(h,3===u&&uk.u0d(Q)?1:3);break;case Ob.a.NEa:case Ob.a.r8b:uk.il.lE(h,6===u&&uk.u0d(Q)?1:6);break;case Ob.a.UJb:uk.il.lE(h,11);break;case Ob.a.uLc:uk.il.lE(h,7);break;case Ob.a.$8c:uk.il.lE(h,13)}B&&Xq.a.Gqb&&(B.As|=Xq.a.rib(h));return 32}static u0d(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}uk.Zm=null;
Object(m.a)(uk,"JustificationActor",null,[]);const or=()=>{const b=v.AFrameworkApplication.va;b.ra(Ob.a.save,Ad.a.frame,xA);b.ra(Ob.a.sync,Ad.a.frame,wC)},wC=(b,h,u)=>{if(1===u)return 32;v.AFrameworkApplication.va.processAction(Ob.a.M3b,2);Fb.App.ni.lke();return 32},xA=(b,h,u)=>{if(1===u)return 2===Fb.App.za.mode?32:8;v.AFrameworkApplication.va.processAction(Ob.a.M3b,2);if(2!==Fb.App.za.mode)return 32;Fb.App.ni.mfj(null,null);return 32};class zw{constructor(){this.activateRibbonTab=(b,h,u,B,Q)=>{Fb.App.Gv.$I.Xde(Q.toString());
return 32};this.qYm=(b,h,u,B,Q)=>{v.AFrameworkApplication.Spa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Fb.App.Gv.$I.CDi(1,Q.toString());return 32};this.Psn=(b,h)=>{if(h.contextId!==Ad.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.activateRibbonTab,vc.a.view,this.activateRibbonTab);b.Xc(Ob.a.activateRibbonTab,5);b.ra(Ob.a.DDi,vc.a.view,this.qYm);b.ra(Ob.a.ulg,Ad.a.frame,this.Psn)}static get instance(){return null!=
zw.sAg?zw.sAg:zw.sAg=zw.Wl()}static Wl(){return new zw}}Object(m.a)(zw,"RibbonActor",null,[]);var Yq=c(568);class Pu{constructor(b,h){this.Lm=null;this.$Oo=(u,B,Q,ca,qa)=>{let Qa;ca=B.view;if(!ca.qe)return Pu.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ALb}),8;Qa=u===Ob.a.undo?this.Qg.dY:this.Qg.cQa;if(1===Q)return Hi.a.eia(B)&&Hi.a.bcc()?8:Qa?32:8;if(!Qa)return r.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",u===Ob.a.undo?"undo":"redo"),this.mKa.value.eCj(),Pu.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.UOo}),
2;B=new Qg.GraphTransaction(3);B.Db(ca.ed);B.vfe();u=u===Ob.a.undo?this.Qg.undo():this.Qg.pja();B.dispose();qa&&sq.GrippersManager.instance.uSb(qa.Qx);if(u)return 32;Pu.Hc.Yb(pd.a.z6b,{["Reason"]:pe.a.UPi});return 8};this.uma=b;this.mKa=h}get Qg(){return this.Lm||(this.Lm=this.uma())}Tb(){const b=v.AFrameworkApplication.va,h=this.$Oo;b.fb(Ob.a.undo,vc.a.view,h,1028);b.fb(Ob.a.pja,vc.a.view,h,1028)}static get instance(){return null!=Pu.cAg?Pu.cAg:Pu.cAg=Pu.Wl()}static Wl(){const b=Ga.a.instance;return new Pu(()=>
b.resolve("Box4.IUndoManager"),b.Re("Box4.ICoauthCashTelemetry"))}static get Hc(){return Wh.a.instance}}Object(m.a)(Pu,"UndoActor",null,[]);class by{constructor(){this.W=null}get name(){return"Box4.Actors"}wc(b){this.W=b;(new Xi).wc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Object(qv.a)()&&this.W.resolve("Box4.Actors.PageColorActor").Tb();b.Tb();b.u5();cg();Ht.instance.Tb();mf.Tb();Bm.Tb();uk.Tb();this.W.resolve("Box4.Actors.TouchInputActor").Tb();Kv.instance.Tb();this.W.resolve("Box4.ISelectAllHandlers").Tb();
or();this.W.resolve("Box4.Actors.ProofingActor").Tb();zw.instance.Tb();(b=this.W.Oa("Box4.IFeatureHelper"))?b.lq.continueWith(()=>{this.e8i()}):this.e8i();Yq.a.Tb(Fb.App.JUa);this.W.resolve("Box4.Actors.TextFormattingActor").Tb();Pu.instance.Tb();this.W.resolve("Box4.Actors.AccessibilityActor").B5f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Fb.App.za.updateCommandUI()}e8i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Tb();this.W.resolve("Box4.Actors.StyleActor").Tb()}dispose(){}static main(){M.a.instance.Gc(new by)}}
Object(m.a)(by,"Box4ActorsPackage",null,[1,2]);class yA extends tw{constructor(b,h,u,B){super(b);this.Wna=u;this.$6a=B;this.irg=0;this.YA=h.ORa("UserAction","WordOnlineAddToDictionary")}Wdg(b){this.nMd=this.Wna.noa(b);if(!this.PTk())return!1;const h=this.nMd.errorDetails.token;this.$6a.Moh(h);if(!this.$6a.Kad(h))return r.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;r.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");
this.YA.start();this.transaction=new Qg.GraphTransaction(15);this.transaction.Db(b.node);return!0}O$d(b){this.wNb(b.node);return!0}H3c(b){this.wNb(b);return!0}P$d(b){this.wNb(b.node)}akg(b){this.transaction.dispose();this.nMd.errorDetails.Wqb(b.actionId);this.$6a.K$f("unused corelation id.");this.YA.stop();r.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.irg,this.YA.li,this.nMd.errorDetails.proofingType));
return!0}Ilc(b,h){const u=b.role;return super.Ilc(b,h)||9===u||10===u||13===u||7===u||8===u}wNb(b){if(b){var h=this.Wna.s4(b,u=>this.$6a.Kad(u.errorDetails.token));this.Wna.Cob(b,h,!0);this.irg+=h.length}}PTk(){var b,h;return null!==(h=null===(b=this.nMd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(r.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(m.a)(yA,"AddToDictionaryCallbackSteps",tw,[]);class Dz{constructor(b,
h,u,B,Q,ca,qa){this.nc=b;this.mb=h;this.oV=u;this.Wna=B;this.Xp=Q;this.$6a=ca;this.MHn=qa;this.nlm=(Qa,rb,Lb,Yb,gc,Fc)=>{const Sc=new yA(this.oV,this.Xp,this.Wna,this.$6a);return new hx(Qa,rb,Lb,Yb,gc,Fc,Sc,this.nc,this.mb,this.oV,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Tb(){this.nc.vT(Ob.a.addToDictionary,vc.a.view,this.nlm,1124);this.MHn.nVn(this.$6a)}}Object(m.a)(Dz,"PersonalDictionaryOrchestrator",null,[]);class zA{get name(){return"Box4.PersonalDictionary"}wc(b){this.container=
b;b.register(Dz,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().Sd(()=>new Dz(v.AFrameworkApplication.va,xf.a.instance,Rp.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Tb()}dispose(){}static main(){Yk.a.get_instance().lk(7,()=>{M.a.instance.Gc(new zA)})}}
Object(m.a)(zA,"PersonalDictionaryPackage",null,[1,2]);var Zo=c(174);class jo{constructor(b,h,u,B,Q,ca){this.yBa=this.s$a=this.WV=null;this.wHc=(qa,Qa,rb,Lb,Yb)=>this.jBi(Qa,rb,Yb,!1)?32:8;this.QK=(qa,Qa,rb,Lb,Yb)=>{if(!({xy:qa}=this.toj(Qa,rb,Yb,!0)).returnValue)return qa;r.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Yb=this.Dkk.cva(Qa.node,Yb);this.$zn(Qa.node,Yb);this.eQ();return 32};this.PBb=(qa,Qa,rb,Lb,Yb)=>{if(!({xy:qa}=this.toj(Qa,rb,Yb,
!1)).returnValue)return qa;this.Wzn(Qa.node);return 32};this.SIn=(qa,Qa,rb,Lb,Yb)=>{if(1===rb)return 32;if(!Qa||!Qa.view.qe)return 2;qa=Qa.view.mb;if(!qa)return 2;qa=qa.ng;if(!qa)return 2;qa=jo.Xg.lR(qa,16);if(!qa||!qa.length)return 2;Qa=null;for(rb=0;rb<qa.length;rb++){Lb=qa.getContext(rb);if(!Lb||Lb.contextId!==vc.a.Ew)return 2;const gc={};this.bli(Lb,gc);if(gc.CellShading)if(Qa&&Qa!==gc.CellShading){Qa=null;break}else Qa=gc.CellShading;else{Qa=null;break}}Yb.CellShading=Qa;return 32};this.GNb=
(qa,Qa,rb,Lb,Yb)=>1===rb?32:this.bli(Qa,Yb);this.cNb=(qa,Qa,rb,Lb,Yb)=>{if(1===rb)return 32;qa=Qa.contextId===vc.a.view?this.SBa.rSd(Qa):this.Qrf(Qa);rb={};Qa=null;32===v.AFrameworkApplication.va.Rb(Ob.a.GNb,2,rb)&&rb&&(Qa=rb.CellShading);rb="";Qa&&(rb=zl.a.aF(Qa)||"");this.qnj.sPb=rb;this.cXc&&this.l1.Ene(rb);qa=this.qnj.oOc(qa,Fb.App.VBb);if(!qa)return 8;Yb.MenuItems=qa;r.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.Sia=(qa,Qa,rb,Lb,Yb)=>{if(1===rb)return 32;
Fb.App.za.dismissFloatie();v.AFrameworkApplication.va.Rb(Ob.a.GNb,2,Yb);this.s$a=new is.a("Shading",Ob.a.okc);this.s$a.ilc(Yb&&Yb.CellShading?Yb.CellShading:0);return 32};this.JSk=(qa,Qa,rb,Lb,Yb)=>{if(1===rb)return 32;v.AFrameworkApplication.va.Rb(Ob.a.t$,2,Yb);this.l1.VZa(Yb)||r.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.Dkk=h;this.EJe=u;this.SBa=B;this.Ud=Q;this.wq=ca}get l1(){return null!=this.KEg?this.KEg:this.KEg=
Ga.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get qnj(){this.WV||(this.WV=new Nx.a("Shading"),this.HFa(this.WV));return this.WV}HFa(b){b.dX(2,Ob.a.PBb);b.dX(3,Ob.a.t$);b.dX(4,Ob.a.t$);b.qAb(this.EJe,1)}Tb(){this.ga.ra(Ob.a.cNb,vc.a.view,this.cNb);this.ga.ra(Ob.a.cNb,vc.a.Ew,this.cNb);this.ga.Xc(Ob.a.cNb,1126);this.ga.ra(Ob.a.wHc,vc.a.view,Yq.a.sOc);this.ga.ra(Ob.a.wHc,vc.a.Ew,this.wHc);this.ga.Xc(Ob.a.wHc,1028);this.ga.ra(Ob.a.t$,vc.a.view,Yq.a.sOc);this.ga.ra(Ob.a.t$,vc.a.Ew,this.QK);this.ga.Xc(Ob.a.t$,
1028);this.ga.ra(Ob.a.PBb,vc.a.view,Yq.a.sOc);this.ga.ra(Ob.a.PBb,vc.a.Ew,this.PBb);this.ga.Xc(Ob.a.PBb,1028);this.ga.ra(Ob.a.GNb,vc.a.view,this.SIn);this.ga.ra(Ob.a.GNb,vc.a.Ew,this.GNb);this.ga.Xc(Ob.a.GNb,1124);this.ga.ra(Ob.a.okc,vc.a.view,Yq.a.sOc);this.ga.ra(Ob.a.okc,vc.a.Ew,this.JSk);this.ga.Xc(Ob.a.okc,1028);this.ga.ra(Ob.a.hYf,vc.a.view,this.Sia);this.ga.Xc(Ob.a.hYf,1028)}eQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>
{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}toj(b,h,u,B){return this.jBi(b,h,u,B)?{returnValue:2===h,xy:32}:(2==h&&Yq.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],pe.a.Xyl),{returnValue:!1,xy:8})}jBi(b,h,u,B){return b.contextId!==vc.a.Ew||2===h&&(B&&!u||!b.node)?!1:!0}$zn(b,h){const u=new Qg.GraphTransaction(15);u.Db(b);this.Ylj(b);b.properties.setValue(Xe.a.QK,
h);u.dispose()}Wzn(b){const h=new Qg.GraphTransaction(15);h.Db(b);this.Ylj(b);b.properties.removeProperty(Xe.a.QK);h.dispose()}Qrf(b){return b.contextId!==vc.a.Ew?null:(b=jo.ai.ru(b.node))?b:null}Ylj(b){if(this.Ud&&this.Ud.tg&&(b=Object(Na.a)(rz.TableCellNode,b))){const h=b.cV();this.wq.Y8c(b,h)}}bli(b,h){if(b.contextId!==vc.a.Ew)return 8;(b=b.node)&&b.hasProperty(Xe.a.QK)&&(h.CellShading=b.getValue(Xe.a.QK));return 32}static GOl(){return new jo(v.AFrameworkApplication.va,Zn.a.instance,yw.a.instance,
Df.PageReader.instance,Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get ai(){return Zo.PageNavigator.instance}static get Xg(){return null!=jo.mwg?jo.mwg:jo.mwg=On.ContextSetEditor.instance}static get instance(){return null!=jo.xBg?jo.xBg:jo.xBg=jo.GOl()}get cXc(){null==this.yBa&&(v.AFrameworkApplication.le("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.yBa=v.AFrameworkApplication.K?
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.yBa}}Object(m.a)(jo,"CellShadingActor",null,[]);class Lv{constructor(){this.W=null}get name(){return"Box4.CellShading"}wc(b){this.W=b}init(){const b=this.W.Oa("Box4.IFeatureHelper");b?b.lq.continueWith(()=>{this.sn()}):this.sn()}sn(){jo.instance.Tb();Fb.App.za.updateCommandUI()}dispose(){}}Object(m.a)(Lv,"CellShadingPackage",null,[1,2]);var Us;(function(b){b[b.none=
0]="none";b[b.cCo=1]="style1";b[b.dCo=2]="style2";b[b.eCo=3]="style3";b[b.fCo=4]="style4";b[b.gCo=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Us||(Us={}));Object(m.b)("ListStyle",Us);const AA={[Us.cCo]:{[1]:"disc",[0]:"decimal"},[Us.dCo]:{[1]:"circle",[0]:"lower-alpha"},[Us.eCo]:{[1]:"square",[0]:"lower-roman"},[Us.fCo]:{[0]:"upper-alpha"},[Us.gCo]:{[0]:"upper-roman"},[Us.bullet]:{[1]:"bullet"}};var cy;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";
b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(cy||(cy={}));Object(m.b)("ListType",cy);var nt=c(1628);class Zq{constructor(b,h){this.VB=this.$Yc=null;this.levelText=b;this.font=h}get F$d(){return this.levelText}get listStyle(){return 6}get ww(){return"left"}}Object(m.a)(Zq,"ListMarkerBullet",null,[350]);class ni{static get Jn(){return null!=ni.xCg?ni.xCg:ni.xCg=Ga.a.instance.resolve("Box4.List.IListEditor")}static get Fd(){return ni.Ef||(ni.Ef=Ga.a.instance.resolve("Box4.List.IListReader"))}static set Fd(b){ni.Ef=
b}static get xj(){return null!=ni.Wzg?ni.Wzg:ni.Wzg=Ga.a.instance.resolve("Box4.IInsertionPointFormatting")}static fx(){return ni.Zm||(ni.Zm=Ga.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Xg(){return On.ContextSetEditor.instance}static get Uf(){return ti.a.instance}static get Hc(){return Wh.a.instance}static get vp(){return Pm.a.getInstance()}static get o$c(){return null!=ni.rFg?ni.rFg:ni.rFg=Ga.a.instance.Oa("Box4.List.ISingleLevelListEditor")}static Tb(){const b=v.AFrameworkApplication.va;
b.ra(Ob.a.oD,vc.a.view,ni.TFc);b.ra(Ob.a.oD,vc.a.HP,ni.Gma);b.Xc(Ob.a.oD,1036);b.ra(Ob.a.JL,vc.a.view,ni.TFc);b.ra(Ob.a.JL,vc.a.HP,ni.Gma);b.Xc(Ob.a.JL,1036);b.ra(Ob.a.pda,vc.a.view,ni.TFc);b.ra(Ob.a.pda,vc.a.HP,ni.Gma);b.Xc(Ob.a.pda,1036);b.ra(Ob.a.h1e,vc.a.view,dd.ActionManager.Lf);b.ra(Ob.a.sDh,vc.a.view,dd.ActionManager.Lf);b.ra(Ob.a.THf,vc.a.view,ni.r3n);b.ra(Ob.a.S0e,vc.a.view,dd.ActionManager.Lf);b.ra(Ob.a.i1e,vc.a.view,dd.ActionManager.Lf);b.ra(Ob.a.bjg,vc.a.view,dd.ActionManager.Lf);b.ra(Ob.a.Ivj,
vc.a.view,dd.ActionManager.Lf);b.ra(Ob.a.Eme,vc.a.view,dd.ActionManager.Lf)}static r3n(){nt.a.wcj();return 32}static TFc(b,h,u,B,Q){var ca,qa,Qa;if(!h.view.qe)return 2;const rb=ni.Hc.Ap(Ob.a.TFc);B.As=42;B.MC=42;const Lb={[Ap.a.GJa]:5796,[Ap.a.FJa]:5797};var Yb=h.view;if(ni.Xg.IDa(ni.Lum,Yb.mb.ng))return ni.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.l9e}),rb.end(),8;if(ni.Xg.IDa(ni.q0e,Yb.mb.ng))return ni.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.UIc}),rb.end(),8;if(ni.Xg.hAa(me.ParagraphReader.AU,Yb.mb.ng))return ni.Hc.Yb(pd.a.Ye,
{["Reason"]:pe.a.yO}),rb.end(),8;if(ni.Uf.Mbc(Yb.mb.ng))return ni.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.ZE}),rb.end(),8;if(null===(qa=null===(ca=ni.fx())||void 0===ca?void 0:ca.instance)||void 0===qa?0:qa.EU(h))return ni.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.o1a}),rb.end(),8;if(1===u)return rb.end(),32;Q||(Q=new Od.DictionaryPropertySet);ca=null;if(2===u){ca=new Qg.GraphTransaction(15);ca.Db(h.view.ed);ni.DXc=!1;qa=Qo.OutlineElementGeneralizer.nha(Yb.mb.hb,!1);if(!qa)return ca.dispose(),ni.Hc.Yb(pd.a.Zna,{["Reason"]:pe.a.WMd}),
rb.end(),8;1<qa.length&&Q.setValue($c.a.WOi,null);const gc=Q.ja($c.a.KJ,-1),Fc=Q.ja($c.a.LA,-1);null===(Qa=ni.o$c)||void 0===Qa?void 0:Qa.lVk(qa);if(Qa=ni.Qoo(gc,Fc,qa))Q.setValue($c.a.LA,16),Q.setValue($c.a.BRa,0);if(!Ge.SelectionEditor.ef(Yb.mb.ng)&&!Qa&&0<qa.length&&gc){Yb=new vd.GraphIterator;Qa=Array(qa.length);for(let Sc=0;Sc<qa.length;Sc++)Yb.set(qa.getContext(Sc).node),Qa[Sc]=ni.Fd.tw(Yb);ni.Poo(Qa,Q)&&(Yb=new Od.DictionaryPropertySet,Yb.setValue($c.a.LA,16),Yb.setValue($c.a.BRa,0),Pm.a.wY&&
(Yb.setValue(Sh.a.Qpa,"clean-list-before-apply-new-list-style"),Yb.setValue(Sh.a.uia,Q.ja(Sh.a.Qpa,"unknown")+"@"+Q.ja(Sh.a.uia,"undefined"))),Ap.a.xqa(b,h,u,B,Yb,Lb,11),v.AFrameworkApplication.va.processAction(Ob.a.Ivj,2),r.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),ni.DXc=!0)}Yb=new vd.GraphIterator;Yb.set(qa.getContext(0).node);Yb=ni.Fd.tw(Yb);ni.J3m(gc,Fc,Yb,qa.length)}b=Ap.a.xqa(b,h,u,B,Q,Lb,11);32===b&&Q.ja($c.a.gvh,!1)&&(b=Ap.a.xqa(Ob.a.LO,h,u,B,Q,Lb,
11));ca&&ca.dispose();rb.end();return b}static Poo(b,h){let u=null;var B=!1;for(let Q=b.length-1;0<=Q&&(u?(B=b[Q],B=-1!==h.ja($c.a.KJ,-3)?B?u.listType!==B.listType||u.listStyle!==B.listStyle:!0:B?u.listType!==B.listType:!0):u=b[Q],!B);Q--);return u&&(b=!1,B||(b=h.ja($c.a.LA,42),h=h.ja($c.a.KJ,-3),b=b!==u.listType||0<h),B||b)?!0:!1}static J3m(b,h,u,B){0>=B||ni.DXc||(b?u?(u=u.listType,-1===b&&h===u?(v.AFrameworkApplication.va.processAction(Ob.a.Eme,2),r.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):
0<b&&(!h||1===h)&&(v.AFrameworkApplication.va.processAction(h?Ob.a.S0e:Ob.a.i1e,2),r.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(v.AFrameworkApplication.va.processAction(h?Ob.a.S0e:Ob.a.i1e,2),ni.FLo(),r.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(v.AFrameworkApplication.va.processAction(Ob.a.Eme,2),r.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Qoo(b,
h,u){if(-1!==b&&b||!u.length)return!1;b=new vd.GraphIterator;let B=null;for(let Q=u.length-1;0<=Q&&!(b.set(u.getContext(Q).node),B=ni.Fd.tw(b));Q--);return B&&h===B.listType?!0:!1}static Gma(b,h,u,B,Q){var ca;if(h.contextId!==vc.a.HP)return 2;var qa=h.clone().ghg();if(ni.Uf.m4a(qa))return ni.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),2;const Qa=new vd.GraphIterator;Qa.set(h.node);Ge.SelectionEditor.yu(Qa);if(!Yc.OutlineElementReader.Bh(Qa))return 2;if(1===u)switch(b){case Ob.a.oD:return 32;case Ob.a.JL:return 32;
case Ob.a.pda:return 32;default:return 2}if(Yc.OutlineElementReader.UQ(Qa))return ni.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.yO}),2;h=ni.Fd.tw(Qa);var rb;Pm.a.wY&&(rb=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Lb=Q;if(!Lb)return 8;b===Ob.a.JL||b===Ob.a.oD||b===Ob.a.pda?(Lb=ni.Jn.EMc(b,Lb),qa=gu.a.V_(Lb.getValue($c.a.LA),Lb.getValue($c.a.BRa))):qa=null;ni.P0(b,Lb);ni.iio(qa,Lb);let Yb=!1;b===Ob.a.oD&&Lb&&(Lb.hasProperty(Jc.a.nv)&&(qa.levelText=Lb.ja(Jc.a.nv,"")),Lb.hasProperty(Xe.a.font)&&(qa.font=
Lb.ja(Xe.a.font,"")),Lb.hasProperty($c.a.flf)&&(Yb=Lb.ja($c.a.flf,!1)));ni.Sjo(Lb,Qa);qa=ni.Jn.Gma(Lb,Qa,qa,Yb);if(!qa.returnValue)return ni.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.XJf}),2;qa=qa.gxa;Pm.a.wY&&ni.LPn(Q,rb,qa);2===u&&(u=Q.ja($c.a.LA,-1),qa&&-1!==u&&((rb=Q.ja(Jc.a.Zr,"Invalid MultiLevel Type"),b===Ob.a.JL&&r.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===Q||void 0===Q?void 0:Q.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,
["listStyle"]:Us[null==(null===h||void 0===h?void 0:h.listStyle)?null===qa||void 0===qa?void 0:qa.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:cy[null==(null===h||void 0===h?void 0:h.listType)?null===qa||void 0===qa?void 0:qa.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===qa||void 0===qa?void 0:qa.listType)})),h)?qa.listType&&1!==qa.listType||ni.DXc||(v.AFrameworkApplication.va.processAction(Ob.a.bjg,2),r.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",
u?"Bullet":"Numbering",rb)):16===qa.listType?(v.AFrameworkApplication.va.processAction(Ob.a.sDh,2),r.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",u?"Bullet":"Numbering",rb)):qa.listType&&1!==qa.listType||ni.DXc||(v.AFrameworkApplication.va.processAction(Ob.a.h1e,2),r.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",u?"Bullet":"Numbering",rb))),(b=hd.FocusManager.instance())&&b.currentScope&&b.currentScope.name===Zj.AppFrame.Vqa&&b.iD($d.AFrame.Un));
B.As=qa.listType;B.MC=qa.listStyle;(null===(ca=v.AFrameworkApplication.K)||void 0===ca?0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("List");return 32}static LPn(b,h,u){var B,Q,ca,qa,Qa,rb,Lb,Yb;const gc=new Map;gc.set("actionCallSource",b.ja(Sh.a.Qpa,"unknown"));gc.set("actionCallSourceTrigger",b.ja(Sh.a.uia,"undefined"));gc.set("fromListType",cy[null!==(B=null===h||void 0===h?void 0:h.listType)&&void 0!==B?B:16]);gc.set("fromListStyle",Us[null!==
(Q=null===h||void 0===h?void 0:h.listStyle)&&void 0!==Q?Q:0]);gc.set("fromListMarkerType",null!==(Qa=k(null!==(ca=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ca?ca:0,null!==(qa=null===h||void 0===h?void 0:h.listType)&&void 0!==qa?qa:16))&&void 0!==Qa?Qa:"undefined");gc.set("fromLevelText",(null===h||void 0===h?0:h.Joa)?h.levelText:"undefined");gc.set("toListType",null!==(rb=cy[null===u||void 0===u?void 0:u.listType])&&void 0!==rb?rb:"undefined");gc.set("toListStyle",null!==(Lb=Us[null===u||
void 0===u?void 0:u.listStyle])&&void 0!==Lb?Lb:"undefined");gc.set("toListMarkerType",null!==(Yb=k(null===u||void 0===u?void 0:u.listStyle,null===u||void 0===u?void 0:u.listType))&&void 0!==Yb?Yb:"undefined");gc.set("toLevelText",(null===u||void 0===u?0:u.Joa)?u.levelText:"undefined");xa.Health.instance.recordKpiUsage(nj.a.xlb.y_m,0,nj.a.xB,gc)}static Sjo(b,h){var u=new vd.GraphIterator;u.jd(h);(h=u.Ub(2))&&me.ParagraphReader.Wb(h)&&(u=xf.a.instance.hb.lb)&&u.Pa&&u.Pa.node===h&&Ge.SelectionEditor.U_d(u)&&
(ni.ugo(b),ni.sgo(b))}static iio(b,h){h.hasProperty(Jc.a.Zr)&&b.rge(h.getValue(Jc.a.Zr));h.hasProperty(Sh.a.LQ)&&(b.LQ=h.getValue(Sh.a.LQ));h.hasProperty(Jc.a.nv)&&(b.levelText=h.getValue(Jc.a.nv));b.KJ=h.ja($c.a.KJ,-1);let u=null;b.Cpa&&(u=ni.c1l(b,h));b.Cpa&&u?ni.Njo(b,u):(b.Cpa?r.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.KJ,b.Zr,b.Kz):r.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),
ni.ifo(b))}static ifo(b){if(b.Kz)b.nVd&&-1===b.KJ||(b.levelText="%1.",b.propertySet.hasProperty(Xe.a.a5)||b.w$(0,1));else if(1===b.listType)b.nVd&&-1===b.KJ||(b.font=nj.a.DKc,b.levelText=nj.a.sJd,b.propertySet.hasProperty(Xe.a.a5)||b.w$(1,6));else return;b.ww="left"}static Njo(b,h){1===b.Zr?ni.Dio(b,h):ni.Tgo(b,h)}static Dio(b,h){(b.VB=h.VB)?b.e6=h.VB.e6:h.VB||r.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",
b.KJ,b.Zr,b.Kz)}static Tgo(b,h){b.levelText=h.levelText;b.Kz?b.w$(0,h.listStyle):(b.font=h.font,b.w$(1,1));b.ww=h.ww}static c1l(b,h){let u=null;2===b.Zr?u=b.Kz?Ga.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ga.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Zr&&(u=Ga.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let B=u.vKb.value;const Q=b.KJ+"";Q in B||(B=u.A9,r.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
Q,b.Zr,b.Kz));if(!(Q in B)){r.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",Q,b.Zr,b.Kz);if(h.hasProperty(Xe.a.font))return r.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",Q,b.Zr,b.Kz),b=h.ja(Xe.a.font,""),new Zq(F.a.fromCharCode(parseInt(Q)),b);r.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
Q,b.Zr,b.Kz)}return B[Q]}static sgo(b){ni.xj.hasProperty(Xe.a.fontColor)&&b.setValue(Xe.a.fontColor,ni.xj.fontColor())}static ugo(b){ni.xj.hasProperty(Xe.a.fontSize)&&b.setValue(Xe.a.fontSize,ni.xj.fontSize())}static P0(b,h){b=b===Ob.a.oD?0:b===Ob.a.JL?1:b===Ob.a.pda?2:-1;h=h.ja($c.a.KJ,-1);r.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static FLo(){const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");if(b){var h=v.AFrameworkApplication.K.lc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(u=>{window.setTimeout(()=>{u.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else r.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}ni.Lum=Dd.ImageReader.$Vc;ni.q0e=Dd.ImageReader.B3a;ni.Ef=null;ni.Zm=null;ni.DXc=!1;Object(m.a)(ni,"ListActor",null,[]);class Uw{constructor(){this.vKb=new hg.a(()=>this.oaf());this.A9={}}R2h(b){return b}}Object(m.a)(Uw,"AListMarkerGalleryLoader",null,[351]);var et=c(1388),
It=c(441);class Zm extends Uw{constructor(){super();this.qwb=new wc.a(Ra.a.jh())}R2h(b){Zm.MQ||this.feo();b in Zm.MQ&&(b=Zm.MQ[b]);return b}oaf(){const b={};b["0"]=new Zq(Box4Intl.Box4Strings.L_ListStyleNone,et.a.Isi);b["1"]=new Zq(String.fromCharCode(61623),"Symbol");b["2"]=new Zq(String.fromCharCode(111),"Courier New");b["3"]=new Zq(String.fromCharCode(61607),"Wingdings");b["4"]=new Zq(String.fromCharCode(9643),"Courier New");b["5"]=new Zq(String.fromCharCode(61611),"Wingdings");b["6"]=new Zq(String.fromCharCode(61614),
"Symbol");b["7"]=new Zq(String.fromCharCode(61483),"Symbol");b["8"]=new Zq(String.fromCharCode(61485),"Symbol");b["9"]=new Zq(String.fromCharCode(9830),"Courier New");b["10"]=new Zq(String.fromCharCode(61664),"Symbol");b["11"]=new Zq(String.fromCharCode(61558),"Wingdings");b["12"]=new Zq(String.fromCharCode(61656),"Wingdings");b["13"]=new Zq(String.fromCharCode(61514),"Wingdings");b["14"]=new Zq(String.fromCharCode(61516),"Wingdings");b["15"]=new Zq(String.fromCharCode(61692),"Wingdings");b["16"]=
new Zq(String.fromCharCode(61691),"Wingdings");b["17"]=new Zq(String.fromCharCode(61553),"Wingdings");return b}qne(b){b&&b.length&&this.z4e(b)}R0f(){if(this.A9){var b=It.a(this.A9),h=b.length;for(let u=0;u<h;u++){const B=this.A9[b[u]];this.qwb.add(B.levelText+"_"+B.font)}}}z4e(b){this.R0f();for(const h of b)if(h&&!h.Kz&&h.Joa&&h.jSc&&(b=h.levelText+"_"+h.font,!this.qwb.contains(b))){const u=It.a(this.A9).length+It.a(this.vKb.value).length+"";this.A9[u]=new Zq(h.levelText,h.font);this.qwb.add(b)}}feo(){Zm.MQ=
{};Zm.MQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Zm.MQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;Zm.MQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Zm.MQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;Zm.MQ["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;Zm.MQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Zm.MQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Zm.MQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;Zm.MQ["Courier New 0x2666"]=
Box4Intl.Box4Strings.L_BlackDiamond;Zm.MQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Zm.MQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Zm.MQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Zm.MQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;Zm.MQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Zm.MQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Zm.MQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;Zm.MQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}
Zm.MQ=null;Object(m.a)(Zm,"ListMarkerBulletLoader",Uw,[]);class vq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(vq,"InfoAtLevel",null,[]);class lu{constructor(b){this.VB=b}get font(){return"Calibri"}get listStyle(){return 42}get ww(){return"left"}get F$d(){return this.VB?this.TEn():this.VEn()}get $Yc(){return this.VB?this.UEn():null}get levelText(){return""}pWl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}TEn(){let b=
"";for(let h=0;3>h;h++)b+=this.OQc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',lu.sof(),b)}UEn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new vq,{textAtLevel:this.Fdi(h),styleAtLevel:this.qdm(h)}));return b}VEn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',lu.tof(),Box4Intl.Box4Strings.L_ListStyleNone)}Fdi(b){b=this.VB.aZc[b];for(let h=0;9>h;h++)b=F.a.replaceAll(b,"%"+(h+1),this.pWl(this.VB.yKb[h]));return b}qdm(b){const h=
{};h.fontFamily=6===this.VB.yKb[b]?this.VB.LEa[b]:this.font;return h}OQc(b){const h=this.Fdi(b),u=new Sys.StringBuilder;6===this.VB.yKb[b]&&u.append(String.format("font-family:{0};",this.VB.LEa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,u.toString(),h)}static sof(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static tof(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(lu,"ListMarkerMultilevel",null,[350]);var Vs=c(1400);class mu extends Uw{constructor(){super()}oaf(){const b=new Vs.a,h={};h["0"]=new lu(null);h["1"]=new lu(b.L$e());h["2"]=new lu(b.Caf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new lu(b.PJh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}qne(){}}Object(m.a)(mu,"ListMarkerMultilevelLoader",Uw,[]);var kp=c(136);class Sp{constructor(b,h){this.VB=null;this.levelText=b;this.Npd=h}get font(){return"Calibri"}get listStyle(){return this.Npd}get ww(){switch(this.Npd){case 3:case 5:return"right";default:return"left"}}get F$d(){switch(this.Npd){case 1:return this.Ohc("1",
"2","3");case 2:return this.Ohc("a","b","c");case 3:return this.Ohc("i","ii","iii");case 4:return this.Ohc("A","B","C");case 5:return this.Ohc("I","II","III");case 0:return this.WEn();default:return this.Ohc("1","2","3")}}get $Yc(){const b=[],h={};h.fontFamily=kp.FontUtils.MDa(this.font);switch(this.Npd){case 1:return b.push(Object.assign(new vq,{textAtLevel:this.WX("1"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("2"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new vq,{textAtLevel:this.WX("a"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("b"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new vq,{textAtLevel:this.WX("i"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("ii"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new vq,
{textAtLevel:this.WX("A"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("B"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new vq,{textAtLevel:this.WX("I"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("II"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new vq,{textAtLevel:this.WX("1"),
styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("2"),styleAtLevel:h})),b.push(Object.assign(new vq,{textAtLevel:this.WX("3"),styleAtLevel:h})),b}}Ohc(b,h,u){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Sp.sof(),this.OQc(b),this.OQc(h),this.OQc(u))}WEn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Sp.tof(),Box4Intl.Box4Strings.L_ListStyleNone)}OQc(b){b=this.WX(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}WX(b){return F.a.replaceAll(this.levelText,"%1",b)}static sof(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static tof(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Sp,"ListMarkerNumbering",null,[350]);class BA extends Uw{constructor(){super();this.qwb=new wc.a(Ra.a.jh())}wSm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}oaf(){const b=
{};b["0"]=new Sp(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Sp("%1.",5);b["2"]=new Sp("%1.",4);b["3"]=new Sp("%1.",1);b["4"]=new Sp("%1.",2);b["5"]=new Sp("%1.",3);b["6"]=new Sp("%1)",5);b["7"]=new Sp("%1)",4);b["8"]=new Sp("%1)",1);b["9"]=new Sp("%1)",2);b["10"]=new Sp("%1)",3);b["11"]=new Sp("(%1)",5);b["12"]=new Sp("(%1)",4);b["13"]=new Sp("(%1)",1);b["14"]=new Sp("(%1)",2);b["15"]=new Sp("(%1)",3);return b}qne(b){b&&b.length&&this.z4e(b)}R0f(){if(this.A9){var b=It.a(this.A9),h=b.length;
for(let u=0;u<h;u++){const B=this.A9[b[u]];this.qwb.add(B.levelText+"_"+B.listStyle)}}}z4e(b){this.R0f();for(const h of b)if(h&&h.Kz&&h.Joa&&this.wSm(h.levelText)&&h.listStyle&&(b=et.a.Tlf(h.levelText))){const u=b+"_"+h.listStyle;if(!this.qwb.contains(u)){const B=It.a(this.A9).length+It.a(this.vKb.value).length+"";this.A9[B]=new Sp(b,h.listStyle)}this.qwb.add(u)}}}Object(m.a)(BA,"ListMarkerNumberingLoader",Uw,[]);class Qu{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){ni.Tb()}dispose(){}wc(b){this.W=
b;this.W.ia("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new Zm).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new BA).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new mu).ha()}static main(){M.a.instance.Gc(new Qu)}}Object(m.a)(Qu,"Box4ListMarkerPackage",null,[1,2]);class mx{static get Yg(){return Hf.a.Bz(mx.Sm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}mx.Sm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(m.a)(mx,"DefineNewBulletDialogHtml",null,[]);class js extends Hf.a{constructor(b,h,u,B){super();this.Yxc=this.FIe=this.mYb=this.fYb=null;this.Xwb=0;this.oGc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.bqi=!0;this.whl=Q=>{if(this.fYb&&Q.target!==this.fYb){const ca=this.focusManager.Ys();ca&&ca.ak&&(ca.ak.Zy(Q.target),this.fYb=Q.target)}this.yrn(Q.target.id)};this.i_m=Q=>{Q=Q.uf;if(!this.VCi(Q))return!1;this.focusManager.Ys().ak.Zy(Q);Q.focus();return!0};this.j_m=Q=>{var ca=
Q.uf;if(!this.VCi(ca))return!1;var qa=ca.id;qa=parseInt(qa.substr(qa.lastIndexOf("_")+1))-this.Xwb;if(Q.Hb.ctrlKey||Q.Hb.altKey||Q.Hb.keyCode>=Se.a.zTb&&Q.Hb.keyCode<=Se.a.ATb)return!1;const Qa=Q.Hb.keyCode;if(Q.eventName===Kd.a.$h){Q=-1;if(Qa===Sys.UI.Key.enter)return this.focusManager.Ys().ak.Zy(ca),ca.focus(),this.fUi(ca.id),this.hide(),!0;Qa===Sys.UI.Key.up?Q=qa-17:Qa===Sys.UI.Key.down?Q=qa+17:Qa===Sys.UI.Key.left?Q=v.AFrameworkApplication.isRtl?qa+1:qa-1:Qa===Sys.UI.Key.right&&(Q=v.AFrameworkApplication.isRtl?
qa-1:qa+1);0<=Q&&(ca=this.sai(js.b6b+"_"+(Q+this.Xwb)))&&ca.focus()}return!0};this.vhl=Q=>{1===Q&&this.fUi(this.mYb);this.hide()};this.Eu=b;this.focusManager=h;this.ga=u;this.KS=!1;B&&(b=B.indexOf(","),-1!==b&&(B=B.substring(0,b)));this.fontName=B;this.ug="DefineNewBulletDialog";this.Yg=mx.Yg;this.xe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.xe(0,CommonUIStrings.l_DialogClose);this.Qh(Box4Intl.Box4Strings.L_SymbolSingle,this.vhl,null);this.taa=!1;this.LHa();document.getElementById(js.nOd).focus()}LHa(){this.focusManager.Ys().scope.kr(hd.FocusManager.instance().LW);
this.focusManager.Ys().scope.kr(hd.FocusManager.instance().MW);this.focusManager.Ys().scope.bindAction(hd.FocusManager.instance().LW,Ob.a.DJd);this.focusManager.Ys().scope.bindAction(hd.FocusManager.instance().MW,Ob.a.CJd)}L9(){this.CDd(js.nOd,"DefineNewBulletFontPlaceholder",Ob.a.BJd.toString(),Ob.a.KNb.toString(),Ob.a.e3c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.DLk()}IL(){super.IL();document.getElementById(this.mj("WACDialogPanel")).style.width="auto"}CDd(b,h,u,B,Q,ca,qa){u=zj.c(b,
u,!0,!0,B,Q,F.a.vf(ca),!0,qa);this.gId(b,h,u,"Medium")}DLk(){const b=document.getElementById(js.b6b);b&&(b.innerHTML=this.h7h(),this.P7i(b))}P7i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Me.a.addHandler(b[h],Kd.a.focus,this.whl)}ATo(){var b=document.getElementById(js.b6b);if(b){let h=this.fontName;const u=et.a.bCf(this.fontName);u&&61472!==this.Xwb||!u&&32!==this.Xwb?(b.innerHTML=this.h7h(),this.P7i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.Vnh(h),b[0].style.fontFamily=h)}}yrn(b){this.Lkj(this.mYb,!1);this.mYb=b;this.Lkj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.mYb){let h=parseInt(this.mYb.substr(this.mYb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.Xwb?61440:0,b.innerText=F.a.dJ(h,4))}}Lkj(b,h){(b=this.sai(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}sai(b){const h=document.getElementById(js.b6b);return h?h.querySelector("#"+b):null}Pma(){const b=document.getElementById(js.b6b);
b&&(this.FIe||(this.FIe=this.i_m,this.Nq.ob(Kd.a.click,b,this.FIe)),this.Yxc||(this.Yxc=this.j_m,this.ee.ob(Kd.a.$h,b,this.Yxc),this.ee.ob(Kd.a.qu,b,this.Yxc),this.ee.ob(Kd.a.sh,b,this.Yxc)));super.Pma()}VCi(b){return b.classList.contains("DefineNewBulletTableCell")}fUi(b){if(b){b=b.split("_");const h=new Od.DictionaryPropertySet;h.setValue($c.a.KJ,parseInt(b[1]));h.setValue(Xe.a.font,this.fontName);h.setValue($c.a.LA,1);Pm.a.wY&&(h.setValue(Sh.a.Qpa,"command-ui"),h.setValue(Sh.a.uia,"define-new-bullet-dialog"));
this.ga.Rb(Ob.a.oD,2,h)}this.focusManager.zL(this.dL,!0)}h7h(){const b=new Sys.StringBuilder,h=et.a.bCf(this.fontName);let u=this.fontName;u=this.Vnh(u);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',u));h?(this.Xwb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Xwb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}Vnh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}gId(b,h,u,B){h=document.getElementById(h);this.Eu.RZa(b,u);u=this.Eu.vFb(b,B);h.appendChild(u);this.Eu.Cqa(b)}dispose(){this.KS||(this.Eu.YY(js.nOd),this.KS=!0);super.dispose()}}js.nOd="DefineNewBulletFontStyleComboBox";js.b6b="DefineNewBulletTableContainer";Object(m.a)(js,"DefineNewBulletDialog",Hf.a,[]);class dy{kQc(){return Ob.a.e_m}NQc(){return Ob.a.m0f}}Object(m.a)(dy,"ListMarkerGalleryBulletCommands",
null,[352]);class Ml{kQc(){return Ob.a.g_m}NQc(){return Ob.a.bCn}}Object(m.a)(Ml,"ListMarkerGalleryMultilevelCommands",null,[352]);class IB{kQc(){return Ob.a.h_m}NQc(){return Ob.a.n0f}}Object(m.a)(IB,"ListMarkerGalleryNumberingCommands",null,[352]);class CA{constructor(b,h,u,B,Q){this.VAa=this.RLa=null;this.jPh=ca=>{if(!this.VAa)return 2;if(this.VAa.focusManager.Ys().ak.Z3.id.startsWith(js.b6b)){let qa=null;ca===Ob.a.DJd?qa=this.VAa.w_a:ca===Ob.a.CJd&&(qa=document.getElementById(js.nOd));if(!qa)return 2;
this.VAa.focusManager.Ys().ak.Zy(qa);qa.focus()}else if(ca===Ob.a.DJd)this.VAa.focusManager.Ys().vfc();else if(ca===Ob.a.CJd)this.VAa.focusManager.Ys().tfc();else return 2;return 32};this.PFi=(ca,qa)=>{ca=null;qa.view.qe&&(ca=qa.view);return ca&&ca.mb?32:(Pc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",qa.toString()),8)};this.ZXm=(ca,qa,Qa)=>{var rb;return 1===Qa?32:2===Qa?((null===(rb=v.AFrameworkApplication.K)||
void 0===rb?0:rb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("ListDefine"),ca=this.i$b(qa),ca=zc.FormattingReader.Vr(ca).cache.zG,this.VAa=new js(this.Sik,hd.FocusManager.instance(),v.AFrameworkApplication.va,ca),32):8};this.e3c=(ca,qa,Qa,rb,Lb)=>{if(1===Qa)return 32;if(2===Qa&&!Lb)return 8;if(this.VAa.bqi){for(ca=0;ca<et.a.oGc.length;ca++)kp.FontUtils.BBj(et.a.oGc[ca]);this.VAa.bqi=!1}im.a.QWd(qa);Lb.PopulationXML=kp.FontUtils.w2h(im.a.Khe,im.a.tlf,
Ob.a.BJd);return 32};this.aCn=(ca,qa,Qa,rb,Lb)=>{ca=qa.contextId===vc.a.HP;if(1===Qa||!ca)return ca?32:8;if(2===Qa&&!Lb)return 8;Lb.MenuItems=this.i9j.g1l();return 32};this.uhl=(ca,qa,Qa,rb,Lb)=>{if(1===Qa)return 32;if(2===Qa){ca=Object(Na.a)(26,Lb);if(!ca||!ca.Ad)return 8;this.VAa.fontName=ca.Ad.fontName;this.VAa.ATo();return 32}return 8};this.ga=b;this.Ef=B.resolve("Box4.List.IListReader");this.g7=h;this.Sik=u;switch(this.g7){case 0:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.RLa=
new dy;break;case 1:b=B.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.RLa=new IB;break;case 2:b=B.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.RLa=new Ml;break;default:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.RLa=new dy}Q=this.Ef?this.Ef.U0l(Q):null;b.qne(Q);this.i9j=new et.a(h,b,Q,!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.uJb)}Tb(){this.ga.ra(this.RLa.NQc(),vc.a.view,Fb.App.JUa.hKh(11));this.ga.ra(this.RLa.NQc(),vc.a.HP,
this.aCn);this.ga.Xc(this.RLa.NQc(),1124);this.g7||(this.ga.fb(Ob.a.WIf,vc.a.view,this.ZXm,1028),this.ga.fb(Ob.a.e3c,vc.a.view,this.e3c,1124),this.ga.fb(Ob.a.BJd,vc.a.view,this.uhl,1028),this.ga.fb(Ob.a.DJd,Ad.a.frame,this.jPh,64),this.ga.fb(Ob.a.CJd,Ad.a.frame,this.jPh,64));this.ga.ra(this.RLa.kQc(),vc.a.view,this.PFi);this.ga.ra(this.RLa.kQc(),vc.a.HP,this.PFi);this.ga.Xc(this.RLa.kQc(),1124)}i$b(b){return this.JPd(b).Pa}JPd(b){let h=null;b=b.view;return b?h=Ge.SelectionEditor.Fj(b.mb.hb.J(0),!1,
!1):h}}Object(m.a)(CA,"ListMarkerGalleryActor",null,[316]);class Mv{constructor(){this.Bf=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(nb.InteractiveViewManager.instance){var b=nb.InteractiveViewManager.instance;b.ve&&(this.Bf=b.ve.ed,this.eUn())}}dispose(){}wc(b){this.W=b}eUn(){(new CA(v.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").eea,this.W,this.Bf)).Tb();(new CA(v.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").eea,
this.W,this.Bf)).Tb();(new CA(v.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").eea,this.W,this.Bf)).Tb()}static main(){M.a.instance.Gc(new Mv)}}Object(m.a)(Mv,"Box4ListMarkerGalleryPackage",null,[1,2]);var Fg=c(426),Ws=c(492),Nv=c(450),ks=c(126);const JB=b=>{b.element.style.top=""};var As=c(714);class nu{constructor(b,h,u){this.yH=!1;this.V$a=0;this.Tea=this.h9g=null;this.ul=b;this.Vjk=h;this.tt=u;this.Z6=b.ownerDocument.createElement("div");this.htmlElement.className=
"WACBusinessBar";(this.Mw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.qL)&&!this.tt.Pef&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";Z.a.lj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.Z6}get visible(){return this.yH}set_visible(b){if(this.yH!==b)return(this.yH=b)?this.k2e():this.WKc(),b}dispose(){this.visible&&this.WKc();kc.a.K_(this.htmlElement);this.ul=this.Z6=null}gqj(b,h){const u=
b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(u):this.htmlElement.insertBefore(u,this.htmlElement.childNodes[h]);b.Kcj();this.V$a+=b.htmlElement.clientHeight;var B=this.htmlElement.childNodes,Q=b.lrh,ca=Object(z.a)(this,this.fin,"onAfterShowEntry");ks.WacAirSpace.pV(u,"Shared_BasicClass");var qa=new Nv.a(u);qa.Cua(0,1);const Qa=new Ws.a(u);Qa.UCa(u.clientTop-30,u.clientTop);Q?(ks.WacAirSpace.umb(qa,null,null),ks.WacAirSpace.umb(Qa,null,ca)):(ks.WacAirSpace.animate(qa,
null,null),ks.WacAirSpace.animate(Qa,null,ca));for(h+=1;h<B.length;h++)ca=B[h],ks.WacAirSpace.pV(ca,"Shared_BasicClass"),qa=new Ws.a(ca),qa.UCa(ca.clientTop-u.clientHeight,ca.clientTop),Q?ks.WacAirSpace.umb(qa,null,null):ks.WacAirSpace.animate(qa,null,null);b.Nto();this.set_visible(!0)}dni(b){const h=b.htmlElement;if(kc.a.scc(h)){this.V$a-=b.htmlElement.clientHeight;var u=h.parentNode.children;b=b.lrh;var B=Object(z.a)(this,this.Zhn,"onAfterHideEntry");ks.WacAirSpace.pV(h,"Shared_BasicClass");var Q=
new Fg.a(h);Q.Cua(1,0);b?ks.WacAirSpace.umb(Q,null,B):ks.WacAirSpace.animate(Q,null,B);B=!1;for(Q=0;Q<u.length;Q++){if(B){const ca=u[Q];ks.WacAirSpace.pV(ca,"Shared_BasicClass");const qa=new Ws.a(ca);qa.UCa(ca.clientTop,-h.clientHeight);b?ks.WacAirSpace.umb(qa,null,JB):ks.WacAirSpace.animate(qa,null,JB)}B||u[Q]!==h||(B=!0)}}}fin(b){b.element.style.top="";v.AFrameworkApplication.ua.G0c()}Zhn(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);v.AFrameworkApplication.ua.G0c()}k2e(){""===
this.ul.style.top.trim()&&(this.ul.style.top=this.ul.offsetTop+"px");this.htmlElement.style.left=this.ul.style.left;this.htmlElement.style.top=this.ul.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.h9g=this.ul.style.top;this.V$a=b.height;this.Gne();v.AFrameworkApplication.ua.u_(Object(z.a)(this,this.onResize,"onResize"));Me.a.addHandler(this.htmlElement,Kd.a.Vee,Me.a.L3b);this.Tea=Object(z.a)(this,
this.KDa,"contextMenuHandler");v.AFrameworkApplication.ua.Kza.ob(this.htmlElement,this.Tea,null);if(hd.FocusManager.iK()){var h=hd.FocusManager.instance();b=h.ae(As.a.NNa);b.parent=$d.AFrame.xp;const u=new te.DOMFocusListing(()=>this.htmlElement);u.Mm(1);u.Mm(2);u.Mm(8);h.Vma(()=>this.htmlElement,b,u);h=h.getRegion(As.a.NNa);h.fTa();h.xP=!0;h.$_a=!0;const B=v.AFrameworkApplication.ua.ux;b.SZa(()=>{B.$w(As.a.NNa)});B.wT(As.a.NNa);(u.kha||v.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&B.QI(As.a.NNa)}}WKc(){this.Kpj()&&
(this.ul.style.top=this.h9g);this.htmlElement.style.visibility="hidden";v.AFrameworkApplication.ua&&(hd.FocusManager.iK()&&hd.FocusManager.instance().J6a(As.a.NNa),this.Tea&&(v.AFrameworkApplication.ua.Kza.sc(this.htmlElement,this.Tea),this.Tea=null));Me.a.removeHandler(this.htmlElement,Kd.a.Vee,Me.a.L3b)}Gne(){if(this.Kpj()&&this.visible){var b=this.ul,h=this.V$a+this.Vjk;const u=kc.a.hN(b.style.top);ks.WacAirSpace.pV(b,"Shared_BasicClass");b=new Ws.a(b);b.UCa(u,h);ks.WacAirSpace.animate(b,null,
null)}}Kpj(){return!this.Mw&&!this.tt.Pef}onResize(){const b=this.tt.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let u;for(let B=0;B<b;++B)u=this.tt.entries[B],u.htmlElement&&u.Kcj();this.V$a=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.V$a&&this.Gne()}KDa(){return!0}}Object(m.a)(nu,"BusinessBarDom",null,[1100,10]);var rv;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(rv||(rv={}));Object(m.b)("BusinessBarId",
rv);class ot{constructor(b,h=0,u=null,B=null){this.X0g=this.lRg=!1;this.DZb=null;this.dB=[];this.OVa=B||new nu(b,h,this);this.wzm(u)}wzm(b){if(b){this.DZb={};b=b.ranking;for(let h=0;h<b.length;h++)this.DZb[rv[b[h]]]=h}}dispose(){this.OVa.dispose();Aa.a.t$f(this.dB);this.dB=null}get htmlElement(){return this.OVa.htmlElement}get visible(){return this.OVa.visible}get Pef(){return this.lRg}set Pef(b){this.lRg=b}get VFf(){return this.X0g}set VFf(b){this.X0g=b}get entries(){return this.dB}set entries(b){this.dB=
b}uY(b){for(let h=0;h<this.dB.length;h++)if(this.dB[h].id===b)return!0;return!1}qA(b,h=!1,u=null,B=null,Q=null){b.NK=this;let ca=this.MZl(b.id);h&&!this.DZb&&(ca=0);ca<ot.aLb&&(this.OVa.gqj(b,ca),this.dB.length>=ot.aLb&&this.OVa.dni(this.dB[ot.aLb-1]),this.OVa.Gne());Array.insert(this.dB,ca,b);r.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",rv[b.id],void 0===b.a0a||null===b.a0a?"":b.a0a);b.errorCode&&v.AFrameworkApplication.lN(b.errorCode,u,B,Q)}removeEntry(b){const h=
Array.indexOf(this.dB,b);-1!==h&&h<ot.aLb&&(this.dB.length>ot.aLb&&this.OVa.gqj(this.dB[ot.aLb],ot.aLb),this.OVa.dni(b),this.OVa.Gne());Array.remove(this.dB,b);b.NK=null;b.dispose()}MZl(b){if(!this.DZb||0===b)return this.dB.length;b=this.DZb[rv[b]];if(void 0===b||null===b)return this.dB.length;for(let h=0;h<this.dB.length;h++)if(b<this.DZb[rv[this.dB[h].id]])return h;return this.dB.length}}ot.aLb=2;Object(m.a)(ot,"BusinessBar",null,[1068,10,1069]);class ey{create(b,h,u){return new Fh.a(b,h,u)}}Object(m.a)(ey,
"Factory",null,[1099]);class KB{static d2k(b,h){b.register(ot,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().Sd(()=>new ot(h.value,0,b.Oa("CommonUI.IBusinessBarRankProvider")));b.register(ey,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(m.a)(KB,"CommonUIComponentConfiguration",null,[]);var DA=c(1015);class Ru extends DA.a{constructor(){super()}static get instance(){return Ru._instance||Ru.sAf()}static sAf(){Ru._instance=new Ru;return Ru._instance}}
Ru._instance=null;Object(m.a)(Ru,"ReactRootManager",DA.a,[472,473]);class EA extends yg.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(EA,"CompoundButtonProps",yg.a,[]);class LB{constructor(b,h,u,B,Q,ca,qa){this.EW=h;this.qBc=b;this.k_g=h.hJm;this.JXb=h.WWc;this.kFe=ca;this.Dmd=B;this.Emd=Q;this.ymd=u;this.vK=qa;this.ibb=new Vd.a;this.ibb.Z(1,"SpellingIssue_16x16x32");this.ibb.Z(2,"GrammarIssue_16x16x32");this.ibb.Z(3,"WritingIssue_16x16x32");this.ibb.Z(4,null);this.ibb.Z(0,null)}create(b,
h,u){h=Object(Na.a)(Il.a,h);if(!h)return r.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const B=new Sys.StringBuilder;b=this.T$h(b);this.bKc(B,h,u,b);this.jaf(B,h);this.Hbl(B,h,b);return B.toString()}HCb(b,h,u){const B=Object(Na.a)(Il.a,h);if(!B)return r.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.T$h(b);this.Vaf(h,B,u,b);this.kaf(h,B);this.Ibl(h,B,b);for(u=0;u<h.length;u++)h[u].Id=`${iu.iUh}_${u}`;return h}bKc(b,h,u,B=null){h.errorType?
1===h.errorType&&(this.s7b(h)||b.append(this.v4e(h,u,B))):b.append(this.qBc.build())}Vaf(b,h,u,B=null){h.errorType?1===h.errorType&&(this.s7b(h)||b.push(this.ALk(h,u,B))):b.push(this.qBc.Lxh())}jaf(b,h){const u=new Sys.StringBuilder;this.drj(h)?u.append(zj.a("btnIgnoreAllSpellingError",(2===h.errorType?Ob.a.pJa:Ob.a.Noa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.s7b(h)||u.append(zj.a("btnIgrnoreSpellingError",this.P9h(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,
null));this.jrj(h)&&(this.EW.Hvi&&u.append(zj.a("btnDoNotCheckForThisIssue",Ob.a.yDb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),u.append(zj.a("btnGrammarOptions",Ob.a.xnb.toString(),F.a.vf(Box4Intl.Box4Strings.l_GrammarOptions),null)));u.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(u.toString()),b.append("</Controls></MenuSection>"))}kaf(b,h){const u=Object.assign(new wh.a,{ControlList:[]});if(this.drj(h)){var B=mt.LB()?
Object.assign(new yg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Ob.a.Noa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new yg.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});u.ControlList.push(B)}else this.s7b(h)||(B=Object.assign(new yg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.P9h(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),u.ControlList.push(B));this.jrj(h)&&(this.EW.Hvi&&
(h=Object.assign(new yg.a,{ExternalId:"DoNotCheckForThisIssue"}),u.ControlList.push(h)),h=Object.assign(new yg.a,{ExternalId:"GrammerSettingsContext"}),u.ControlList.push(h));b.push(u)}T$h(b){if(!this.vK)return null;b=this.vK.language(this.vK.Vr(b.Pa));return Jj.a.qg(b)?Jj.a.qg(b).name:null}P9h(b){return 2===b?Ob.a.pJa:this.EW.ZLm?Ob.a.xum:Ob.a.Ywa}Hbl(b,h,u=null){if(this.xeg(h)){var B=F.a.vf(h.Bt.CategoryTitle);B=zj.m(iu.Thc,Za.a.Dma,this.ibb.J(h.proofingType),""!==B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
[b.toString()],this.Dmd,this.Emd);B=zj.d("cgProofingOuter",[B]);b.clear();b.append(zj.g("msProofingOuter",B,"Menu16",void 0,void 0,u,"ariaLabelledById"));r.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}Ibl(b,h,u=null){if(this.xeg(h)){var B=F.a.vf(h.Bt.CategoryTitle);u=Object.assign(new ee.a,{ExternalId:String.format("{0}_{1}",iu.Thc,h.proofingType),Command:Za.a.Dma.toString(),Image16by16Class:this.ibb.J(h.proofingType),LabelText:""!==
B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:u,Menu:Object.assign(new Rk.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.oMl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});u.Menu.MenuSectionList.push(...b);Array.clear(b);B=Object.assign(new wh.a,{ControlList:[]});B.ControlList.push(u);b.push(B);r.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",
h.proofingType,h.typeId)}}v4e(b,h,u=null){const B=this.PUl(b);var Q=[];let ca=!1;var qa=b.Bt.Suggestions;if(qa)if(qa=qa.slice(0,Math.min(3,qa.length)),this.k_g&&(ca=!Cl.a.any(qa,Qa=>!Qa||!Qa.Description)),1!==qa.length||qa[0].Action){let Qa=0,rb=null;ca&&(rb="font-weight: bold;");for(const Lb of qa){if(!Lb)continue;qa=null;let Yb="";const gc=F.a.vf(Lb.Text);ca&&(qa=this.D4h(Lb.Description),Yb=this.C4h(Lb.Description));Q.push(zj.a("btnCorrectWord"+Qa,h[Qa].toString(),gc,null,null,null,null,null,rb,
null,qa,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,B,gc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.vIh(b.token)),"ariaDescribedById",Yb));Qa++}}else h=F.a.vf(qa[0].Text),Q.push(zj.a("btnCorrectWord0",Ob.a.pJa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,B,h)));h="Menu16";
0<Q.length?ca&&(h="Menu16DescriptionEnabled"):Q=[zj.a("btnNoSuggestions",Ob.a.pJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return zj.g("msUnknownWord",zj.d(null,Q),h,B,this.m2l(b),u,"ariaLabelledById")}ALk(b,h,u=null){var B=1!==b.proofingType&&0!==b.proofingType?b.Bt.ExplanationTitle:"";B=Object.assign(new wh.a,{Title:B,Lang:u,ControlList:[]});let Q=!1;var ca=b.Bt.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.k_g&&(Q=!Cl.a.any(ca,qa=>!qa||!qa.Description)),1!==ca.length||
ca[0].Action){let qa=0;for(const Qa of ca){if(!Qa)continue;ca=null;let rb="";Q&&(ca=this.D4h(Qa.Description),rb=this.C4h(Qa.Description));if(qa>=h.length)break;ca?(ca=Object.assign(new EA,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",qa,b.proofingType),Command:h[qa].toString(),LabelText:Qa.Text,Description:ca,Lang:u,AriaDescription:rb}),B.ControlList.push(ca)):(ca=Object.assign(new yg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",qa,b.proofingType),Command:h[qa].toString(),
LabelText:Qa.Text,Lang:u,RoleInMenu:"menuitem"}),B.ControlList.push(ca));qa++}}else b=ca[0],b=Object.assign(new yg.a,{ExternalId:"NoSuggestion",Command:Ob.a.pJa.toString(),LabelText:b.Text}),B.ControlList.push(b);0>=B.ControlList.length&&B.ControlList.push(Object.assign(new yg.a,{ExternalId:"btnNoSuggestions",Command:Ob.a.pJa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return B}PUl(b){return F.a.vf(0!==b.proofingType?b.Bt.ExplanationTitle:"")}m2l(b){return this.xeg(b)?null:this.ibb.J(b.proofingType)}xeg(b){return this.JXb&&
2!==b.errorType&&(1!==b.errorType||!this.s7b(b))}drj(b){return this.kFe&&!!b.errorType&&1===b.proofingType&&!this.s7b(b)}oMl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.vIh(b.token)):""}jrj(b){return this.EW.D_d&&this.JXb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}s7b(b){return!!b.errorType&&!!this.ymd&&this.ymd.contains(b.token,b.lcid)}D4h(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):
b}C4h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}vIh(b){let h="";if(b){let u;for(u=0;u<b.length-1;u++)h=h+b.charAt(u)+",";h+=b.charAt(u)}return h}}Object(m.a)(LB,"EditorServiceProofingContextMenuCreator",null,[]);class fy{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(m.a)(fy,"BusinessBarRankProvider",null,[312]);class Ez{constructor(){this.W=
null}get name(){return"Wonca.UI"}wc(b){this.W=b;b.ia("CommonUI.IBusinessBarRankProvider",()=>new fy).ha();KB.d2k(b,new hg.a(()=>Fb.App.za.Vga));b.ia("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new LB(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),v.AFrameworkApplication.Bca,v.AFrameworkApplication.$s,v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).ha();
b.ia("CommandUI.ReactRootManager",()=>Ru.instance).as("Common.IReactRootManager").ha()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){M.a.instance.Gc(new Ez)}}Object(m.a)(Ez,"WoncaUIPackage",null,[1,2]);class nx{constructor(b){this.QN=this.wzc=null;this.xn=b}get key(){return"BOOKMARK"}get Xw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get a4(){return this.QN}reset(b){this.QN=b.node}gJa(b){let h=null;v.AFrameworkApplication.le("bookmarks-core-ex;bookmarks-core-ex-cf");
if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.wzc&&this.xn.dvi(b,this.a4,this.wzc))return h=Object.assign(new nw.a,{TG:this.key,contentObject:this.wzc}),{returnValue:!0,aG:h};this.wzc=null;if(!this.a4.hasBookmark)return{returnValue:!1,aG:h};const u=new vd.GraphIterator;u.set(this.a4.Ui());this.xn.a0c(u);if(this.xn.tGm(u)){let B=u.Qd();for(;B;){if(this.xn.dvi(b,this.a4,B))return this.wzc=B,h=Object.assign(new nw.a,
{TG:this.key,contentObject:B,description:this.tib()}),{returnValue:!0,aG:h};B=u.Kj()}}}return{returnValue:!1,aG:h}}tib(){return null}}Object(m.a)(nx,"BookmarkDetailsProvider",null,[335,336]);class Ov{constructor(b,h,u,B,Q=null){this.IZg=this.Xh=!1;this.Pqd=this.qsd=null;this.oSi=(ca,qa)=>{ca=qa.node;1074135152!==ca.Nc?r.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ca.Nc):(r.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.NVh(!0))};
this.iA=u;this.oi=B;this.Bx=h;this.uLg=b;this.yS=Q}get mx(){return this.Bx.value}initialize(){this.H5f();this.Xh=!0}NVh(b=!1){if(!this.Xh)return r.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.IZg)return!0;let h=!1;this.oi.ge(()=>{this.qsd={};this.Pqd={};if(this.mx){const u=new vd.GraphIterator;u.set(this.mx);if(this.Ocn(u)){if(u.Ub(1)){do this.Prk(u.currentNode);while(u.Jf(1))}h=this.IZg=!0}}},"BGM:EBGL");return h}owa(b){return this.NVh()?b in this.Pqd?this.Pqd[b]:
null:null}dispose(){this.Xh?this.RPo():r.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}Ocn(b){if(this.iA.EP(b))return(b=b.Ub(30))||r.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;r.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}H5f(){r.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.uLg.Fph(this.oSi)}RPo(){r.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");
this.uLg.$$i(this.oSi)}Prk(b){var h,u,B,Q;b?(this.Fnh(null!==(u=this.yS.Xeb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==u?u:W.a.nil,b),this.Fnh(null!==(Q=this.yS.f3b.get(null===(B=b.id)||void 0===B?void 0:B.toString()))&&void 0!==Q?Q:W.a.nil,b),(h=b.properties.ja(Jc.a.zt,null))&&(this.Pqd[h]=b)):r.ULS.sendTraceTag(24155022,324,50,"Node is null")}Fnh(b,h){b===W.a.nil?r.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.qsd||(this.qsd[b]=new zb.a),b=
this.qsd[b],b.contains(h)||b.add(h))}}Object(m.a)(Ov,"BookmarkGraphManager",null,[455]);var FA=c(813),Aw=c(1124);class MB{create(){return new Aw.a}}Object(m.a)(MB,"BookmarkContainerNodeFactory",null,[349]);class Ny{constructor(b,h,u,B=null){this.jpn=(Q,ca)=>{this.xn.iVi(ca)};this.yWf=(Q,ca)=>{var qa=this.mZh(ca.clone);Q=ca.original.Lc;const Qa=new tb.a;for(const rb of qa)qa=rb.un.toString(),Qa.nb(qa)||(Qa.add(qa,!0),(qa=Q.Eb(rb.un))&&!qa.anchor&&(qa=this.xn.eFb(rb.un)),qa?qa.anchor?this.f6k(qa,ca.clone):
r.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",qa.id,qa.ja(Jc.a.bBb,-1))):r.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.zWf=(Q,ca)=>{Q=ca.clone;ca=this.mZh(Q);this.xn.G5c(Q,ca)};this.nA=h;this.xn=u;this.FVj=B||new MB}init(){FA.a.ZRn(Object(z.a)(this.xn,this.xn.ETf,"onAfterFullBookmarkRangeDeleted"));this.nA.g_e(this.jpn);hu.a.f_e(this.yWf);hu.a.jBd(this.zWf)}mZh(b){const h=new zb.a;for(let u=0;u<b.qa.length;u++){const B=b.qa.J(u);if(B.Fh)for(let Q=
0;Q<B.Fh.length;Q++)h.add(B.Fh.J(Q))}return h}f6k(b,h){var u=h.Ui().vd;u=cq.b(b,u,!0);h=vd.GraphIterator.eb(h);this.aul(h);h.Ub(30);h.C3(u,1,b.id);h.wj(u)}aul(b){if(b.zb(25)&&b.ld(25)&&!b.Fs(30)){const h=this.FVj.create(1074135152);b.xf(h,30)}}}Object(m.a)(Ny,"BookmarksEventHandler",null,[]);var Hr=c(204),Ui=c(254),Pv=c(451),ox=c(1179),xo=c(128),Qv=c(1071);class gy{create(){return new Qv.a}}Object(m.a)(gy,"BookmarkNodeFactory",null,[349]);class Bs{constructor(b,h){this.xba=b;this.PVj=h}get aOb(){return this.PVj}}
Object(m.a)(Bs,"FoundBookmarkRangeObject",null,[348]);class px{constructor(b,h,u,B,Q,ca,qa,Qa=null,rb,Lb=null){this.U2="_";this.xLg=40;this.Oik=" ";this.Bx=b;this.iA=h;this.Ld=u;this.rIe=B;this.Kc=Q;this.gb=ca;this.ib=qa;this.OVj=Qa||new gy;this.yS=Lb}FQc(b,h){return b?this.yS.Xeb.get(null===h||void 0===h?void 0:h.toString()):this.yS.f3b.get(null===h||void 0===h?void 0:h.toString())}get mx(){return this.Bx.value}get JJa(){return this.rIe.value}oYe(b,h){if(!h||!h.Pa||!h.Rc)return r.ULS.sendTraceTag(36471765,
3029,15,"There is no selection"),!1;const u=h.Pa.node,B=h.Rc.node,Q=Hr.a.uib(h,!0);h=Hr.a.uib(h,!1);return this.ZEc(b,Q,h,u,B)}ZEc(b,h,u,B,Q,ca=!1){r.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const qa=this.owa(b);if(qa)if(ca)this.Q8i(qa);else return r.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!B||!Q)return r.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;ca=this.Kc.Pc(15);
ca.Db(this.JJa);b=this.jpk(b);if(!b)return!1;this.fpk(B,h,b,Q,u);ca.dispose();return!0}owa(b){r.ULS.shipAssertTag(34936482,3029,!!b);return this.pZh(h=>b===h.properties.ja(Jc.a.zt,null))}eFb(b){return b&&b!==W.a.nil?this.pZh(h=>b.equals(h.id)):(r.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}ETf(b){const h=this.eFb(b);h?(r.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.P8i(h),this.F5c(h)):r.ULS.sendTraceTag(36569436,
3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}pwa(b,h){var u;const B=null!==(u=this.FQc(h,b.id))&&void 0!==u?u:W.a.nil;if(B===W.a.nil)return r.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Bs(null,2);u=this.mx.vd.Eb(B);return u?u.isConnected?this.getBookmarkRange(u,b,h):(r.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Bs(null,3)):(r.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new Bs(null,2))}iVi(b){const h=
this.SCl(b);h[Symbol.iterator]().next().done||this.Kcn(b,h)}G5c(b,h){const u=new zb.a;let B=0,Q=!1;for(const ca of h)ca&&ca.Kb.Fh?(B++,ca.Kb.Fh.remove(ca),0<=ca.oe&&ca.oe<b.we.length&&(ca.Kb.cp||(Q=!0),u.add(ca.oe))):r.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Mqa(u);r.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",B,u.count));Q&&!b.we.length&&b.we.append(Ui.CharacterPropertiesEditor.$M,1024)}hPd(b=!1){r.ULS.sendTraceTag(559228943,
3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new zb.a,u=vd.GraphIterator.eb(this.mx);if(null!==this.a0c(u)){var B=u.Qp();r.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",B);if(0<B)for(B=u.Qd();null!==B;){const Q=B.ja(Jc.a.zt,"");F.a.Xe(Q)||(b?h.add(B):Q.startsWith(this.U2)||h.add(B));B=u.Kj()}}!b&&0<h.count&&r.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}xpm(){return this.mx?this.k3k():!1}k3k(){r.ULS.sendTraceTag(524321506,3029,50,
"Finding bookmarks with includeHidden: {0}",!1);const b=vd.GraphIterator.eb(this.mx);if(null!==this.a0c(b)&&0<b.Qp())for(var h=b.Qd();null!==h;){h=h.ja(Jc.a.zt,"");if(!F.a.Xe(h)&&!h.startsWith(this.U2))return!0;h=b.Kj()}return!1}Eci(b){var h=this.owa(b);const u=new zb.a;if(h){b=this.FQc(!0,h.id);h=this.FQc(!1,h.id);var B=this.mx.vd.Eb(b);B&&u.add(B);if(b.equals(h))return u;b=B;do(b=B=this.gb.$f(b,!1,!1,!0))&&u.add(B);while(B&&!B.id.equals(h))}else r.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return u}O8i(b){if(null===b)return r.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.eFb(b);return this.Q8i(b)}hNl(b){let h="";const u=b.id;b=b.characterData.split(this.Oik);for(let B=0;3>B&&B<b.length;B++)h+=this.U2+b[B];h.length>this.xLg&&(h=h.substring(0,this.xLg));return this.BLj(h,u)}BLj(b,h){const u=this.hPd(!0),B=[];let Q;for(let qa=0;qa<u.count;qa++){var ca=u.J(qa);Q=ca.ja(Jc.a.zt,"");ca=this.FQc(!0,ca.id);Q.startsWith(b)&&!h.equals(ca)&&B.push(Q)}return 0<
B.length?(B.sort((qa,Qa)=>qa.localeCompare(Qa,void 0,{numeric:!0})),(h=B[B.length-1].substring(b.length+1))?b+this.U2+(parseInt(h)+1):b+this.U2+1):b}Dji(b){F.a.Xe(b)?r.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.owa(b),null===b?r.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.pwa(b,!0))?(b=Cg.SelectionFactory.ne(b.xba.paragraph,b.xba.Kb.cp))&&this.ib.Bc(b):r.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}Q8i(b){if(!b)return r.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;r.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Kc.Pc(15);h.Db(this.JJa);this.P8i(b);this.F5c(b);h.dispose();return!0}BQd(b,h){if(!b||0>h)return r.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let u=null;const B=new zb.a,Q=new zb.a;var ca=b.qa;for(var qa=0;qa<ca.length;qa++){var Qa=ca.J(qa);if(Qa.cp>h||Qa.cp===h&&0<B.count)break;if(Qa.Fh){var rb=
Qa.Fh;if(2===rb.length&&rb.J(0).un.equals(rb.J(1).un)&&Qa.cp===h){B.add(rb.J(0).un.toString());break}for(let Lb=0,Yb=rb.length;Lb<Yb;Lb++){Qa=rb.J(Lb);const gc=b.Lc.Eb(Qa.un).ja(Jc.a.zt,"");F.a.Xe(gc)||gc.startsWith(this.U2)||(Qa.Qc?B.add(Qa.un.toString()):B.contains(Qa.un.toString())?B.remove(Qa.un.toString()):Q.add(Qa.un.toString()))}}}0<B.count&&(u=b.Lc.Eb(W.a.Ff(B.J(B.count-1))));if(!u)for(h=me.ParagraphReader.$f(b,!0);h&&!u;){for(ca=0;ca<h.qa.length;ca++)if(qa=h.qa.J(ca),qa.Fh){qa=qa.Fh;for(let Lb=
0,Yb=qa.length;Lb<Yb;Lb++)rb=qa.J(Lb),Qa=b.Lc.Eb(rb.un).ja(Jc.a.zt,""),F.a.Xe(Qa)||Qa.startsWith(this.U2)||(rb.Qc?Q.contains(rb.un.toString())?Q.remove(rb.un.toString()):B.add(rb.un.toString()):B.contains(rb.un.toString())?B.remove(rb.un.toString()):Q.add(rb.un.toString()))}0<B.count?u=h.Lc.Eb(W.a.Ff(B.J(B.count-1))):h=me.ParagraphReader.$f(h,!0)}return u}ARo(b,h){if(null===b)return r.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.uGm(h)||this.iql(h))return!1;const u=this.Kc.Pc(15);
u.Db(this.JJa);this.zRo(b,h);u.dispose();return!0}pZh(b){if(!this.mx)return r.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new vd.GraphIterator;h.set(this.mx);if(!this.a0c(h))return r.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Ub(1))return null;do{const u=h.currentNode;if(b(u))return u}while(h.Jf(1));return null}getBookmarkRange(b,h,u){for(let B=0;B<b.qa.length;B++){const Q=b.qa.J(B);if(Q.Fh)for(let ca=0;ca<Q.Fh.length;ca++){const qa=
Q.Fh.J(ca);if(qa.un.equals(h.id)&&u===qa.Qc)return new Bs(qa,0)}}r.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ja(Jc.a.bBb,-1),u,h.id,b.qa.length,this.yJ(b));return new Bs(null,1)}a0c(b){if(this.iA.EP(b))return b=b.Ub(30),r.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;r.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}SCl(b){const h=new tb.a;
for(let u=0;u<b.qa.length;u++){const B=b.qa.J(u);if(B.Fh)for(let Q=0;Q<B.Fh.length;Q++){const ca=B.Fh.J(Q),qa=ca.un.toString();h.nb(qa)?(r.ULS.shipAssertTag(36218379,3029,ca.Qc!==h.J(qa).Qc),h.remove(qa)):h.add(qa,ca)}}return h.values}Kcn(b,h){this.G5c(b,h);this.ocn(b,h)}ocn(b,h){let u=me.ParagraphReader.$f(b,!1,!0);b=me.ParagraphReader.$f(b,!0,!0);u||b?(u||this.hwh(h,!0)&&r.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.hwh(h,!1)&&r.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),u=u||b,b=b||u,this.bOi(u,h,0,!0),this.bOi(b,h,b.qa.last.cp,!1)):r.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}hwh(b,h){for(const u of b)if(h===u.Qc)return!0;return!1}bOi(b,h,u,B){const Q=new zb.a;u=this.Bnf(b,u);for(const ca of h)ca.Qc===B&&(u?(h=this.lpk(b,B,u,ca.un))&&Q.add(h):r.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",B));
Q.count&&(b.Zl(),this.apg(b,Q),r.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",Q.count,B)))}lpk(b,h,u,B){const Q=this.eFb(B);return Q?this.pYe(b,h,u,Q):(r.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",B)),null)}pYe(b,h,u,B){var Q;if(!B)return r.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!u)return r.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;u.Fh||(u.Fh=new Pv.a(u));const ca=new ox.a(u,null,B.id,h);u.Fh.add(ca);(h?this.yS.Xeb:this.yS.f3b).set(null===(Q=B.id)||void 0===Q?void 0:Q.toString(),b.id);return ca}apg(b,h){if(h){r.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((u,B)=>u.oe-B.oe);for(let u=0;u<h.count;u++){const B=h.J(u);B.oe?b.we.mY(B.oe-1,1024):b.we.Xoa(B.oe,1024);b.we.rq.Z(B.oe,Ui.CharacterPropertiesEditor.$M);b.we.kt.Z(B.oe,Ui.CharacterPropertiesEditor.WR)}}else r.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Bnf(b,h){if(!b||!b.qa||!b.qa.last)return null;r.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var u=b.qa.length-1;if(!b.qa.J(u).formatting)for(var B=u-1;0<=B;B--){var Q=b.qa.J(B);if(Q.formatting){this.Ld.hZ(b,u,h,Q.formatting);break}}return b.qa.last}u=null;for(B=0;B<b.qa.length;B++){Q=b.qa.J(B);if(Q.cp>=h){if(Q.cp>h||!Q.formatting)this.Ld.hZ(b,B,h,u),Q=b.qa.J(B);Q.Fh||(Q.Fh=new Pv.a(Q));
r.ULS.shipAssertTag(36471768,3029,Q!==b.qa.last);return Q}Q.formatting&&(u=Q.formatting)}return null}jpk(b){const h=new vd.GraphIterator;h.set(this.mx);if(!this.a0c(h))return r.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.L7k(b);h.C3(b,1,null);h.wj(b);return b}L7k(b){const h=this.OVj.create(1074135153);h.setValue(Jc.a.zt,b);h.setValue(Jc.a.bBb,qe.a.zF());return h}F5c(b){if(b&&b.anchor){r.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ja(Jc.a.bBb,-1),b.id);var h=new vd.GraphIterator;h.set(b);h.zb(64);h.vg()}}yJ(b){const h=[];let u=0;for(;b.anchor.Pp&&7!==b.type;)h[u]=xo.a[b.type],b=b.anchor.Pp.hs.node,u++;h[u]=xo.a[b.type];return h.join(" ")}zRo(b,h){b.setValue(Jc.a.zt,h)}P8i(b){const h=this.pwa(b,!0).xba;b=this.pwa(b,!1).xba;if(h&&b&&h.paragraph===b.paragraph){let u;this.G5c(h.paragraph,(u=new zb.a,u.add(h),u.add(b),u))}else{if(h){let u;this.G5c(h.paragraph,(u=new zb.a,u.add(h),u))}if(b){let u;this.G5c(b.paragraph,(u=new zb.a,
u.add(b),u))}}}fpk(b,h,u,B,Q){if(h=this.pYe(b,!0,this.Bnf(b,h),u)){b.Zl();var ca;this.apg(b,(ca=new zb.a,ca.add(h),ca));(u=this.pYe(B,!1,this.Bnf(B,Q),u))?(B.Zl(),this.apg(b,(ca=new zb.a,ca.add(u),ca))):r.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else r.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}Fci(b,h){var u;if(!b)return null;h=null!==(u=this.FQc(h,
b.id))&&void 0!==u?u:W.a.nil;return b.Lc.Eb(h)?b.Lc.Eb(h):null}tGm(b){return!!b&&64===b.Ue}nZf(b){var h;if(0===b.H$)return!1;for(let u=0;u<(null===(h=b.qa)||void 0===h?void 0:h.length);u++){const B=b.qa.J(u);if(null!=B.Fh)for(let Q=0;Q<B.Fh.length;Q++){const ca=B.Fh.J(Q),qa=b.Lc.Eb(ca.un).sPa();if(!F.a.Xe(qa)&&!qa.startsWith(this.U2)&&ca.Qc)return!0}}return!1}r4h(b){var h;const u=[];if(0===b.H$)return u;for(let B=0;B<(null===(h=b.qa)||void 0===h?void 0:h.length);B++){const Q=b.qa.J(B);if(null!=Q.Fh)for(let ca=
0;ca<Q.Fh.length;ca++){const qa=Q.Fh.J(ca),Qa=b.Lc.Eb(qa.un),rb=Qa.sPa();F.a.Xe(rb)||rb.startsWith(this.U2)||!qa.Qc||u.push(Qa)}}return u}Uro(b){return b.ja(Jc.a.LG,!1)}uGm(b){return F.a.Xe(b)?(r.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}iql(b){return null!==this.owa(b)?(r.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}q4h(b,h,u){return this.getBookmarkRange(b,h,u).xba}dvi(b,h,u){if(this.Uro(u)||this.ILm(u))return!1;
const B=this.Fci(u,!0),Q=this.Fci(u,!1);if(B&&Q&&this.gb.GWc(h,B,Q)){if(h!==B&&h!==Q)return!0;const ca=this.q4h(B,u,!0);if(ca&&(B!==h||ca.Kb.cp<=b)&&(u=this.q4h(Q,u,!1))&&(Q!==h||u.Kb.cp>=b))return!0}return!1}ILm(b){b=null===b||void 0===b?void 0:b.ja(Jc.a.zt,"");return!F.a.Xe(b)&&b.startsWith(this.U2)?!0:!1}}Object(m.a)(px,"FullBookmarkManager",null,[315]);class Bw{constructor(){this.Fte=this.Pq=this.W=null}get name(){return"WordEditor.Bookmark"}wc(b){this.W=b;this.Pq=this.W.resolve("Box4.INotebookManager").zl;
const h=new px(new hg.a(()=>Fb.App.za.jb.Yc),Zo.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new hg.a(()=>Fb.App.za.jb.qc.ed),$k.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ia("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.W.ia("WordEditor.Bookmark.BookmarksEventHandler",()=>new Ny(this.Pq.Te(12),this.W.resolve("WordEditor.ITableEditor"),
this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();hk.App.NJj&&(this.Fte=new Ov(this.Pq.Te(64),new hg.a(()=>Fb.App.za.jb.Yc),Zo.PageNavigator.instance,nr.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Fte).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}dispose(){this.Fte.dispose()}sn(){r.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");
this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();r.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.fSn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}fSn(b,h){b&&b.execute(u=>{u.t5(new nx(h))})}static main(){M.a.instance.Gc(new Bw)}}Object(m.a)(Bw,"BookmarkPackage",null,[1,2]);var Oy=c(881),Jt=c(1063),Td=c(1551),pt=c(1411);class Eh extends pt.a{constructor(b){super();this.Nlk=b}get index(){return 3}run(){this.Nlk()}ZJ(){this.IY()}}
Object(m.a)(Eh,"FootnoteEndnoteGraphUpdateTracker",pt.a,[]);class GA{constructor(){this.Dld=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}wc(){}init(){GA.Zb.lq.continueWith(()=>{this.sn()})}sn(){Oy.a.Rhb=Td.a.instance;this.xyf()}dispose(){}xyf(){this.Dld=new Eh(()=>{Td.a.instance.Wu()});Jt.a.nce(Object(z.a)(this.Dld,this.Dld.ZJ,"setUpdateNeeded"));fg.GraphTransactionManager.instance.ara(this.Dld,3)}static get Zb(){return Ga.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(GA,
"PackageManager",null,[1,2]);var NB=c(772),qx=c(202),Cs=c(533),ou=c(473),Py=c(1655);class hy extends Tr{constructor(){super()}get Xw(){return null}getTitle(b){b=b.roa();if(!b||!Cs.a.instance.jpa(b))return"";const h=new Sys.StringBuilder,u=Cs.a.instance.u4(b);h.append(1===u?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Cs.a.instance.i9b(b));return h.toString()}}Object(m.a)(hy,"FootnoteEndnoteBaseDetailsProvider",
Tr,[]);class Fz extends hy{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get qh(){return 7}}Object(m.a)(Fz,"FootnoteEndnoteDetailsProvider",hy,[]);var rx=c(1610),xC=c(1629),OB=c(1699);class HA extends hy{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get qh(){return 10}}Object(m.a)(HA,"FootnoteEndnoteRefMarkDetailsProvider",hy,[]);class Cw{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe){this.dri=(de,ne,ye,Vf,Og)=>{Vf=ne.view;if(!Vf.features.Wje||this.uD.Zui)return 8;
const Bl=Vf.mb.ng;if(!Bl)return 2;if(this.Ik.R_(Bl))return 8;Vf=de===Qc.a.insertFootnote?1:0;var sm=this.JPd(ne);if(!sm)return r.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;ne=!0;sm=sm.Pa;Og&&Og.cdc&&Og.YFa&&(sm=Og.YFa,ne=!Og.keepCurrentFocus);if(1===ye&&Hi.a.eia(Bl)||!sm||!Ge.SelectionEditor.ef(sm)||this.yOg.instance&&this.yOg.instance.WMm(sm)||ok.a.vxa(sm,!0))return 8;if(1===ye)return 32;2===ye&&(ye=this.rT.Vf("UserAction","InsertFootnoteEndnote"),de=this.I1j.KBm(sm,Vf,de),
Og&&Og.cdc&&(Og.sQi=de),ne&&this.p8d(de,!0,!0),ye.stop(),this.Ud.Us(6));return 32};this.Ifc=(de,ne,ye)=>{const Vf=ne.view;if(de===Qc.a.N7a||de===Qc.a.Spb){if(!Vf.features.Wje)return 8}else if(!Vf.features.Sig)return 8;if(!Vf.mb.ng)return 2;ne=this.i$b(ne);return ne?de!==Qc.a.N7a&&de!==Qc.a.Spb||this.fLa.Spm(ne.node,de===Qc.a.N7a?1:0)?1===ye?32:2===ye&&32===this.ga.Rb(Qc.a.d4,2,!0)?(this.ga.Rb(Qc.a.yRf,2,de),32):8:8:2};this.kGl=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;if(2===ye){de=this.zbm(ne);if(!de)return 8;
ye=ne=null;switch(Og){case Qc.a.K4d:ye=de.Rc;ne=this.IWb.yUd(ye,1);break;case Qc.a.J4d:ye=de.Rc;ne=this.IWb.yUd(ye,0);break;case Qc.a.M4d:ye=de.Pa;ne=this.IWb.Tji(ye,1);break;case Qc.a.L4d:ye=de.Pa;ne=this.IWb.Tji(ye,0);break;case Qc.a.N7a:ye=de.Pa;(ne=this.IWb.yUd(ye,1,!0))||(ne=this.fLa.t8h(ye.node,1));break;case Qc.a.Spb:ye=de.Pa,(ne=this.IWb.yUd(ye,0,!0))||(ne=this.fLa.t8h(ye.node,0))}if(ne)this.p8d(ne);else{if(!this.eu.qc)return 8;(Og=Hq.d(ye.node,ye.cpBegin))&&7===Og.qh&&this.fLa.Ggj(Og)}}return 32};
this.euo=(de,ne,ye,Vf,Og)=>1===ye?32:2===ye?(r.ULS.shipAssertTag(4520066,308,!!Og),r.ULS.shipAssertTag(4520067,308,!!Og.e0a),de=Og.e0a,r.ULS.shipAssertTag(4520068,308,this.zE.jpa(de)),this.p8d(de,Og.qhe)?32:8):32;this.fuo=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;2===ye&&(de=Og.footnoteEndnoteNode,Og=Og.nGl)&&(this.Tsa.o7b(),ne=this.zE.Ckb(de),Og.title=this.zE.mXl(de)+(ne?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.N5a=(de,ne,ye,Vf,Og)=>2===ye?(r.ULS.shipAssertTag(4520069,308,!!Og),r.ULS.shipAssertTag(4520070,308,!!Og.e0a),r.ULS.shipAssertTag(4520071,308,me.ParagraphReader.Wb(Og.e0a)),de=this.zE.b2a(Og.e0a),this.p8d(de,Og.qhe)?32:8):32;this.dgo=(de,ne,ye)=>{2===ye&&this.uD.bZ();return 32};this.jnl=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;if(2===ye)return void 0!==Og&&null!==Og?this.uD.Aef(Og,Og):this.uD.Aef(),32;r.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.lYm=(de,ne,ye)=>{de=this.i$b(ne);return de&&Ge.SelectionEditor.ef(de)?1===ye?32:2===ye?(ye=0<this.Zo.t4(de.node).Ut,this.uD.T$e(),this.uD.dialog.sjb=ye,32):8:(r.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.iGl=(de,ne,ye)=>1===ye?32:2===ye?(this.uD.dialog.sjb=!1,32):8;this.cJn=(de,ne,ye,Vf,Og)=>this.R0h(de,ye,Og);this.aJn=(de,ne,ye,Vf,Og)=>1===ye?32:this.uD.dialog&&this.uD.dialog.fontName?(Og[Zh.a.Value]=this.uD.dialog.fontName,32):this.ZYj.XOa(Ob.a.KNb.toString(),
Og,null)?32:8;this.hGl=(de,ne,ye)=>1===ye?32:2===ye?(this.uD.dialog.sjb=!0,32):8;this.bJn=(de,ne,ye,Vf,Og)=>this.R0h(de,ye,Og);this.fGl=(de,ne,ye)=>{if(1===ye)return 32;if(2===ye){de=this.i$b(ne);if(!de)return r.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;ne=this.zE.b2a(de.node);this.zE.jpa(ne)&&(ye=this.Kc.Pc(15),ye.Db(ne),this.lEj(de),this.fLa.Tsh(ne,this.uD.dialog),ye.dispose());this.uD.F6c();return 32}return 8};this.eGl=(de,ne,ye)=>{if(1===ye)return 32;if(2===ye){de=
this.i$b(ne);if(!de)return r.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;ne=this.zE.b2a(de.node);this.zE.jpa(ne)&&(ye=this.Kc.Pc(15),ye.Db(ne),this.lEj(de),this.fLa.XCk(ne,this.uD.dialog),ye.dispose());this.uD.F6c();return 32}return 8};this.gGl=(de,ne,ye)=>1===ye?32:2===ye?(this.uD.F6c(),32):8;this.cGl=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;if(2===ye){de=Object(Na.a)(26,Og);if(!de||!de.Ad)return 8;this.uD.dialog.fontName=de.Ad.fontName;return 32}return 8};this.dGl=(de,
ne,ye,Vf,Og)=>{if(1===ye)return 32;if(2===ye){de=Object(Na.a)(26,Og);if(!de||!de.Ad)return 8;this.uD.dialog.HWb=de.Ad;return 32}return 8};this.ga=b;this.eu=h;this.ZYj=u;this.kd=B;this.zE=Q;this.I1j=ca;this.fLa=qa;this.Tsa=Qa;this.uD=rb;this.Zo=Lb;this.IWb=Yb;this.Kc=gc;this.Ik=Fc;this.Ib=Sc;this.rT=ld;this.Ud=Hd;this.PSj=Ie;this.yOg=fe}lEj(b){(b=zc.FormattingReader.Vr(b))?(this.uD.dialog.fontName||(this.uD.dialog.fontName=b.cache.zG),-1===this.uD.dialog.fontSize&&(this.uD.dialog.HWb=b.cache.fontSize)):
r.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}R0h(b,h,u){return 1===h&&this.uD.dialog?32:2===h&&this.uD.dialog?(u[oh.a.On]=b===Qc.a.d3f?this.uD.dialog.sjb:!this.uD.dialog.sjb,32):8}Tb(){Fb.App.instance.roi([Qc.a.K4d,Qc.a.J4d,Qc.a.M4d,Qc.a.L4d,Qc.a.yRf,Qc.a.N7a,Qc.a.Spb,Qc.a.d4]);this.ga.fb(Qc.a.insertFootnote,vc.a.view,this.dri,4);this.ga.fb(Qc.a.insertEndnote,vc.a.view,this.dri,4);this.ga.ra(Qc.a.K4d,vc.a.view,this.Ifc);this.ga.ra(Qc.a.yRf,vc.a.view,
this.kGl);this.ga.ra(Qc.a.J4d,vc.a.view,this.Ifc);this.ga.ra(Qc.a.M4d,vc.a.view,this.Ifc);this.ga.ra(Qc.a.L4d,vc.a.view,this.Ifc);this.ga.ra(Qc.a.N7a,vc.a.view,this.Ifc);this.ga.ra(Qc.a.Spb,vc.a.view,this.Ifc);this.ga.ra(Qc.a.qqj,vc.a.view,this.euo);this.ga.fb(Qc.a.P0h,vc.a.view,this.hGl,4);this.ga.fb(Qc.a.d3f,vc.a.view,this.bJn,100);this.ga.fb(Qc.a.Q0h,vc.a.view,this.iGl,4);this.ga.fb(Qc.a.X3i,vc.a.view,this.cJn,100);this.ga.ra(Qc.a.rqj,vc.a.view,this.fuo);this.ga.fb(Qc.a.N5a,vc.a.view,this.N5a,
96);this.ga.fb(Qc.a.sOd,vc.a.view,this.dgo,96);this.ga.ra(Qc.a.d4,vc.a.view,this.jnl);this.ga.fb(Qc.a.QEi,vc.a.view,this.lYm,4);this.ga.fb(Qc.a.M0h,vc.a.view,this.fGl,4);this.ga.fb(Qc.a.N0h,vc.a.view,this.eGl,4);this.ga.fb(Qc.a.O0h,vc.a.view,this.gGl,4);this.ga.fb(Qc.a.qOd,vc.a.view,this.cGl,4);this.ga.fb(Qc.a.W3i,vc.a.view,this.aJn,100);this.ga.fb(Qc.a.rOd,vc.a.view,this.dGl,4);this.ga.fb(Qc.a.h3c,vc.a.view,Cw.h3c,100);this.ga.fb(Qc.a.i3c,vc.a.view,Cw.i3c,100)}A5f(){this.PSj.execute(b=>{b.t5(new Fz);
b.t5(new HA)})}i$b(b){b=this.JPd(b);return b?b.Pa:(r.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}JPd(b){let h=null;b=b.view;if(!b)return r.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.mb;if(!b)return r.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.hb;if(!b||!b.length)return r.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return r.ULS.sendTraceTag(51512529,
308,10,"We expected that we have a current selection here."),h;(h=Ge.SelectionEditor.Fj(b,!1,!1))||r.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}zbm(b){return(b=b.view)?b.mb.hb.J(0):null}p8d(b,h=!0,u=!1){if(b){this.Tsa.o7b();var B=b.doa;if(B){var Q=B.Kb,ca=Cg.SelectionFactory.gJ(Q.paragraph,Q.cp,Q.cp+1);Q=this.eu.qc;if(!Q)return!1;this.kd.dea(Q,ca);Q.Xob=150;Q.z5();b=new ou.a(b,h);ca=qx.a.p9b(B,Q);B=B.Fwa(Q,ca);if(!B)return r.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),
!1;u||B.element?this.uD.Efg(b):(this.uD.Efg(new ou.a(b.e0a,!1)),h&&(h=new bf.a(2,1,10,()=>{this.uD.bZ()}),this.Ib.Xb(h)));return!0}}return!1}static dXl(){return new Cw(v.AFrameworkApplication.va,Fb.App.za.jb,Ga.a.instance.resolve("Box4.IGeneralCuiUser"),nb.InteractiveViewManager.instance,Cs.a.instance,xC.a.instance,rx.a.instance,Td.a.instance,Py.FootnoteEndnoteControlManager.instance,Ga.a.instance.resolve("Box4.IParagraphIndentationReader"),OB.a.instance,new $k.a,ti.a.instance,Bg.a.instance,v.AFrameworkApplication.ua.Iq,
Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Ga.a.instance.Ta("Box4.IContentControlReader"))}static cXl(){return Cw.dXl()}static h3c(b,h,u,B,Q){if(1===u)return 32;if(2===u&&!Q)return 8;im.a.QWd(h);Q.PopulationXML=kp.FontUtils.w2h(im.a.Khe,im.a.tlf,Qc.a.qOd);return 32}static i3c(b,h,u,B,Q){if(1===u)return 32;if(2===u&&!Q)return 8;Q.PopulationXML=kp.FontUtils.x2h(Qc.a.rOd);return 32}}Object(m.a)(Cw,
"FootnoteEndnoteActor",null,[394]);class pr extends pt.a{constructor(b){super();this.fWe=b}get index(){return 1}run(){this.fWe()}ZJ(){this.IY()}}Object(m.a)(pr,"FootnoteEndnoteControlUpdateTracker",pt.a,[]);var sv=c(350);class Rv extends sv.a{constructor(b,h,u,B,Q,ca,qa,Qa){super(b,h,u,B);this.ht=()=>{this.ocd(this.Bb)};this.vI=b.container;this.aw=document.createElement("div");b.container.appendChild(this.aw);this.UG(this.aw);this.ufk=Q;this.Do.execute(rb=>{rb.XY(this.ht)});this.jLa=ca;this.CK=qa;
this.GI=Qa;this.jLa.execute(rb=>{rb.Vdg(this.mc,this.vI)});this.GI&&(this.vI.style.backgroundColor=this.CK.N9b())}dispose(){super.dispose();this.Do.instance&&this.Do.instance.lTa(this.ht)}get Do(){return null!=this.izg?this.izg:this.izg=Ga.a.instance.Ta("Common.IZoomManager")}nC(b){this.vI.classList.add("FootnoteEndnoteViewElement");this.ocd(b.currentNode)}ocd(b){this.Do.instance&&(this.Do.instance.Wdd(this.aw),this.aw.style.width=Math.round(100/this.Do.instance.ij)+"%");this.ufk(b)}}Object(m.a)(Rv,
"FootnoteEndnoteViewElement",sv.a,[]);class Gz{constructor(){this._initialized=!1;this.Rhd=this.NAe=this.W=null;this.pGl=(b,h,u,B)=>b.Y3a?new Rv(b,h,u,B,Q=>{Py.FootnoteEndnoteControlManager.instance.B2n(Q)},this.W.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Fb.App.instance&&Fb.App.instance.cD):null}get name(){return"WordEditor.FootnoteEndnote"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>
{this.sn()})}sn(){Wq.WordSectionNavigator.instance.BRf=Object(z.a)(rx.a.instance,rx.a.instance.Idn,"navigateToWordSectionNodeWithFootnoteEndnote");NB.a.Kdg(this.pGl);Py.FootnoteEndnoteControlManager.instance.bind(Fb.App.za.pD);this.NAe=Cw.cXl();this.NAe.Tb();this.NAe.A5f();Fb.App.za.updateCommandUI();this.xyf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,Py.FootnoteEndnoteControlManager.instance.dispose())}xyf(){this.Rhd=new pr(()=>{Py.FootnoteEndnoteControlManager.instance.pcd()});
Jt.a.nce(Object(z.a)(this.Rhd,this.Rhd.ZJ,"setUpdateNeeded"));fg.GraphTransactionManager.instance.ara(this.Rhd,3)}}Object(m.a)(Gz,"PackageManager",null,[1,2]);class pu{constructor(b,h,u,B){this.ib=h;this.qfa=B}get bookmarkManager(){return this.qfa.value}NMm(b){return hk.App.NJj?b.startsWith(F.a.Teb):!1}bnm(b){try{this.cnm(b)}catch(h){r.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}rmg(b){return{returnValue:!1,d6f:b,SEb:""}}cnm(b){if(this.bookmarkManager){b=
b.split("/");var h=this.bookmarkManager.owa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.pwa(h,!0).xba,h=this.bookmarkManager.pwa(h,!1).xba,b||h?b?this.Hlj(b):(r.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Hlj(h)):(r.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.GDi(!1))):(r.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.GDi(!0))}}GDi(b){b=Cg.SelectionFactory.oo(Fb.App.za.jb.Yc.s6h(),b);this.ib.Bc(b)}Hlj(b){b.paragraph&&
b.Kb?(b=Cg.SelectionFactory.ne(b.paragraph,b.Kb.cp),b.gui=!0,this.ib.Bc(b)):r.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(m.a)(pu,"InternalLinkManager",null,[314]);class Dw{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}wc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new pu(new hg.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new hg.a(()=>
b.Oa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){M.a.instance.Gc(new Dw)}}Object(m.a)(Dw,"WordEditorInternalLinksPackage",null,[1,2]);class Ew{constructor(b){this.OLa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){Gj.a.mark(4763);var u=vd.GraphIterator.eb(h);if(u.zb(8)&&u.ld(8)&&u.ZAj(h)===h){if(Rj.OutlineReader.isEmpty(u)){let B=!1;for(let Q=0;Q<xf.a.instance.hb.length;Q++){const ca=
xf.a.instance.hb.J(Q);for(let qa=0;qa<ca.length;qa++)if(ca.J(qa).node===h){B=!0;break}}B||this.QPh(u)}Gj.a.mark(4764)}}};Ew.BK=b}uId(b){if(!Ew.wi.q_d(b))return null;b.Ub(1)&&(b.currentNode.gl(8,!0),b.rc());const h=Ew.BK.ebl();Ew.wi.isRtl(b.currentNode)?h.setValue(Xe.a.er,11):h.setValue(Xe.a.er,9);b.xf(h,1);b.wj(h);return h}Eho(b){if(this.OLa&&b!==this.OLa){const h=new bf.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.OLa;v.AFrameworkApplication.oc.Xb(h)}this.OLa=b}QPh(b){this.OLa===
b.currentNode&&(this.OLa=null);const h=new Qg.GraphTransaction(7);h.Qt(b);b.vg();h.dispose()}NCh(){if(this.OLa&&this.OLa.anchor){const b=vd.GraphIterator.eb(this.OLa);b.gp()&&Rj.OutlineReader.DVc(b)&&this.QPh(b);this.OLa=null}}static get wi(){return Df.PageReader.instance}}Ew.BK=null;Object(m.a)(Ew,"PageContentEditor",null,[1226]);var PB=c(1175),tv=c(640);class Hz extends du{constructor(){super()}Soj(b,h,u,B,Q){let ca=!1,qa=!0;Ge.SelectionEditor.ef(Q)&&(h=Lf.ListItemReader.jg(b)&&h,Q=Yc.OutlineElementReader.JA(b,
Q,!1)&&!Yc.OutlineElementReader.JA(b,Q,!0),h&&u.v5e(b,B)&&(ca=!0),Fb.App.xd.So&&(Q||h&&!ca)&&(qa=!1));return{Roj:qa,jJj:ca}}}Object(m.a)(Hz,"CursorMoveValidator",du,[]);class ao{constructor(b,h,u,B,Q){this.cE=Q;this.KMe=b;this.S6=B;this.Rsa=h;this.mh=u}get Pd(){return null!=this.fHg?this.fHg:this.fHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Bj(){return null!=this.RGg?this.RGg:this.RGg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get uc(){return null!=
this.GIg?this.GIg:this.GIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Xs(){return this.S6.value}get Yf(){return this.mh.value}get Zq(){return this.Rsa}Vkm(b){const h=window.performance.now(),u=new Eq.ScriptSharpLegacyMap,B=new fp.a,Q=new Eq.ScriptSharpLegacyMap;if(b&&b.gx){var ca=null;for(let qa=0;qa<b.length;qa++){const Qa=b.getContext(qa);ca=ca||ao.ai.ru(Qa.node);let rb;if(!({groupId:rb}=this.KMo(Qa.node,ca)).returnValue)continue;let Lb;u.nb(rb)||(Lb=[],u.add(rb,Lb));Lb=u.J(rb);Lb.push(Qa)}for(const qa of An.toArray(u.keys))b=
u.J(qa),ca=new vd.GraphIterator,ca.set(b[0].node),({ddj:b,gt:ca}=this.Rsa.hMo(ca)).returnValue?(u.Z(qa,b),Q.add(qa,ca)):B.add(qa)}r.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:u,Ykm:B,Xkm:Q}}ABb(b){return this.tRk(b)}G3b(b){return this.RQk(b)}dEd(b,h,u=!0){return vd.GraphIterator.$ba(()=>{var B=!1;if(Lf.ListItemReader.jg(b))return this.v5e(b,h,u);B||(gf.OutlineElementNavigator.Ce(b),B=me.ParagraphReader.kh(b)||
Zi.TableReader.isTable(b),gf.OutlineElementNavigator.Wd(b),B=B&&this.rRk(b,h));return B})}v5e(b,h,u=!0){return vd.GraphIterator.$ba(()=>{const B=Yc.OutlineElementReader.cFa(b),Q=Rj.OutlineReader.LX(b.currentNode);if(u?!this.pOm(b,h):!this.qOm(b,h))return!1;var ca=vd.GraphIterator.eb(b.currentNode);if(0<h&&ca.zb(14)){ca.ld(16);var qa=ca.currentNode;const Qa=Jf.TableCellReader.Stf(ca);ca.ld(14);const rb=ca.currentNode;ca=ts.a.LM(qa,rb,Jc.a.kS,Jc.a.Aa,0);qa=ts.a.LM(qa,rb,Jc.a.xV,Jc.a.Ba,0);ca=kf.a.Sy(ca,
0);qa=kf.a.Sy(qa,0);return B+Q<Qa-ca-qa}return!0})}rRk(b,h){const u=Yc.OutlineElementReader.cFa(b);var B=Yc.OutlineElementReader.DG(b);if(0<h){h=Rj.OutlineReader.LX(b.currentNode);B=0;const {Go:Qa,marginLeft:rb,marginRight:Lb}=ao.pSd(b.currentNode);var Q=vd.GraphIterator.eb(b.currentNode);gf.OutlineElementNavigator.Ce(b);if(Zi.TableReader.isTable(b)){B=Zi.TableReader.uha(b);var ca=0;for(var qa of B)ca+=qa;B=kf.a.Sy(kf.a.jf(ca,0),0)}gf.OutlineElementNavigator.Wd(b);return Q.zb(14)?(Q.ld(16),qa=Q.currentNode,
b=Jf.TableCellReader.Stf(Q),Q.ld(14),ca=Q.currentNode,Q=ts.a.LM(qa,ca,Jc.a.kS,Jc.a.Aa,0),qa=ts.a.LM(qa,ca,Jc.a.xV,Jc.a.Ba,0),Q=kf.a.Sy(Q,0),qa=kf.a.Sy(qa,0),u+h<b-Q-qa-B):u+h<Qa-rb-Lb-B}return 0<u-B}MSa(b,h){this.DYi(b,-1*Math.abs(h))}SKc(b,h){this.DYi(b,Math.abs(h))}$kl(b,h,u,B,Q){let ca=ao.xNi;if(h>=ao.xNi){ca=h-=u;const qa=B*Q,Qa=Math.abs(qa),rb=Math.abs(h)%Qa;rb&&(ca=0>ca?0>B?ca+rb:ca-(Qa-rb):0<B?ca-rb:ca+(Qa-rb));ca+=qa;ca+=u;ao.k9d&&(u=Yc.OutlineElementReader.t4(b),ca=ao.k9d.y5h(b.currentNode,
h+u,ca+u,Q,ca<h)-u)}return ca}pRk(b,h,u){if(!b||!b.length)return!1;h=u?h?-1:1:this.k7h(b[0].node,h);return this.qRk(b,h,u)}Ivn(b,h,u){if(!b)return r.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return r.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!u)return r.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!u.length)return r.ULS.shipAssertTag(589592459,
338,!1,"The listIds are empty which are sent for indentation."),8;const B=b[0].node;h=this.k7h(B,h);if(!this.Wbn(B,u[0],h)||!this.Tbn(b,h))return 8;this.Xs.i6();return 32}Tbn(b,h){for(let u=0;u<b.length;u++){const B=new vd.GraphIterator;B.set(b[u].node);let Q=null;gf.OutlineElementNavigator.Ce(B);if(me.ParagraphReader.kh(B)){if(Q=B.currentNode,!Q)return r.ULS.shipAssertTag(589592461,338,!Q,"The paraNode is null for the list OE node"),!1}else if(!me.ParagraphReader.kh(B)&&!Zi.TableReader.isTable(B))return r.ULS.shipAssertTag(589592460,
338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;B.rc();if(Q){if(this.Ypm(Q)){const ca=Q.VD(),qa=Yc.OutlineElementReader.cFa(B);this.Yf.qza(B,1,qa+h);ca&&this.Bj.sV(Q,ca,this.Pd.tg)}Pm.a.getInstance().Nv||Q.setValue(Xe.a.KR,new Date)}}return!0}Wbn(b,h,u){for(let B=0;B<nj.a.V4;B++){const Q=this.Rsa.Lx(b,h,B);if(!Q)return r.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ca=Q.getValue(Jc.a.$d);ca&&Q.setValue(Jc.a.$d,ca+u)}return!0}Ypm(b){return b.hasProperty(Jc.a.$d)||
b.hasProperty(Jc.a.mt)||b.hasProperty(Jc.a.QA)}RQk(b){return this.dEd(b,1,!0)}tRk(b){return this.dEd(b,-1,!0)}k7h(b,h){var u=new vd.GraphIterator;u.set(b);const B=Yc.OutlineElementReader.cFa(u),Q=Yc.OutlineElementReader.DG(u),ca=Yc.OutlineElementReader.t4(u);u=Rj.OutlineReader.LX(b);ao.pSd(b);b=(Q?B-Q:ca)%u;return h?-1*(b?b:u):u-b>ao.LOh?ao.LOh:u-b}KMo(b,h){let u;const B=new vd.GraphIterator;B.set(b);b=B.Ub(4).getValue(Jc.a.listID);return({id:u}=this.Rsa.Gnc(b,h)).returnValue?{returnValue:!0,groupId:u}:
{returnValue:!1,groupId:u}}qRk(b,h,u){var B=!1;for(let Q=0;Q<b.length;Q++){B=b[Q];const ca=new vd.GraphIterator;ca.set(B.node);Ge.SelectionEditor.yu(ca);if(!Yc.OutlineElementReader.Bh(ca))return ao.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.DDb}),!1;if(this.dEd(ca,h,u))B=!0;else return ao.Hc.Yb(pd.a.z6b,{["Reason"]:pe.a.N5e}),!1}return B}DYi(b,h){if(this.dEd(b,h,!0)){var u=!1;if(Lf.ListItemReader.jg(b)){var B=new vd.GraphIterator;B.jd(b);this.Zq.BP(B);var Q=B.currentNode;B.rc();u=!0;const {listId:qa,listLevel:Qa}=
Lf.ListItemReader.YFb(b);var ca=this.ldm(qa,Qa+h);if(ca)gf.OutlineElementNavigator.Ce(B),me.ParagraphReader.kh(B)&&ao.qE.YJ(ca,B.currentNode,!1),B.rc();else{ca=null;let rb;gf.OutlineElementNavigator.Ce(B);me.ParagraphReader.kh(B)&&(ca=B.currentNode);B.rc();rb=ca?ca.VD():null;ca||(gf.OutlineElementNavigator.Ce(B),me.ParagraphReader.kh(B)&&(ca=B.currentNode),B.rc());ca&&(ca.hasProperty(Jc.a.$d)&&ca.removeProperty(Jc.a.$d),ca.hasProperty(Jc.a.mt)&&ca.removeProperty(Jc.a.mt));Pm.a.getInstance().QB||this.cE.oSb(Q,
Qa+h);Pm.a.getInstance().Nv&&this.cE.oSb(ca,Qa+h);Pm.a.getInstance().QB||Q.removeProperty(Jc.a.M0);ca&&rb&&(this.Bj.sV(ca,rb,this.Pd.tg),this.Xs.i6());this.TDo(b,Q)}}u||(u=Yc.OutlineElementReader.cFa(b),B=Yc.OutlineElementReader.DG(b),Q=Rj.OutlineReader.LX(b.currentNode),h=this.$kl(b,u,B,h,Q),this.Yf.qza(b,1,h))}}qOm(b,h){const u=Yc.OutlineElementReader.cFa(b),B=Yc.OutlineElementReader.DG(b),Q=Yc.OutlineElementReader.t4(b),{Go:ca,marginLeft:qa,marginRight:Qa}=ao.pSd(b.currentNode);if(0<h){if(b=ca-
qa-Qa,Q&&Q+h+Fb.App.lAa>b||u+h+Fb.App.lAa>b)return!1}else if(Q&&0>u+h||0>u-B+h)return!1;return!0}pOm(b,h){var u=this.Xs.DB(b);const B=u.level+h;if($w.a.NXm<B||B<$w.a.PDl)return!1;u=this.Zq.Lx(b.currentNode,u.listID,B);if(!u)return r.ULS.shipAssertTag(590700875,338,!!u),!1;if(0<h&&u.hasProperty(Jc.a.$d)){h=u.getValue(Jc.a.$d);const {Go:Q,marginLeft:ca,marginRight:qa}=ao.pSd(b.currentNode);if(h+Fb.App.lAa>Q-ca-qa)return!1}return!0}ldm(b,h){const u=this.uc.yr();for(let B=0;B<u.BO;B++){const Q=u.mFa(B);
if(this.Zq.Lgb(Q)&&Q.ja(Jc.a.listID,this.Xs.x9+1)===b&&Q.ja(Jc.a.listLevel,-1)===h)return Q}return null}TDo(b,h){gf.OutlineElementNavigator.Ce(b);if(me.ParagraphReader.kh(b)&&b.currentNode.hasProperty(Jc.a.$d)&&(h=this.Zq.y9b(h))){if(h.hasProperty(Jc.a.mt)){var u=h.getValue(Jc.a.mt);this.KMe.opb(b.currentNode,u)}h.hasProperty(Jc.a.$d)&&(u=h.getValue(Jc.a.$d),this.KMe.qza(b,1,u));h.hasProperty(Jc.a.QA)&&(h=h.getValue(Jc.a.QA),this.KMe.Zda(b.currentNode,h))}gf.OutlineElementNavigator.Wd(b)}static get qE(){return null!=
ao.gIg?ao.gIg:ao.gIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get k9d(){return null!=ao.sEg?ao.sEg:ao.sEg=Ga.a.instance.Oa("WordEditor.ParagraphIndentationUtility")}static get il(){return ao.Ts||(ao.Ts=Ga.a.instance.resolve("Box4.IParagraphEditor"))}static set il(b){ao.Ts=b}static get Hc(){return Wh.a.instance}static get Qf(){return Pk.a.instance}static get ai(){return Zo.PageNavigator.instance}static pSd(b){var h=Wq.WordSectionNavigator.instance.OJ(b);b=ao.Qf.Ft(h);const u=ao.Qf.xJ(h);
h=ao.Qf.jL(h);return{Go:b,marginLeft:u,marginRight:h}}}ao.LOh=Of.a.Mv(.25);ao.Ts=null;ao.xNi=Of.a.Mv(-11);Object(m.a)(ao,"OutlineElementIndentationEditor",null,[470,471]);var Qy=c(233),iy;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(iy||(iy={}));Object(m.b)("StyleTargetType",iy);var sx=c(217);class qu{constructor(b,h){this.ZW=null;this.zK=h;this.Ef=b}get il(){return null!=this.aEg?this.aEg:this.aEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}get MH(){return null!=
this.Dyg?this.Dyg:this.Dyg=Ga.a.instance.resolve("Box4.IFontStylesGalleryCache")}get eo(){return null!=this.VFg?this.VFg:this.VFg=Ga.a.instance.Oa("Box4.Styles.StyleSettings")}get Xn(){return null!=this.Vyg?this.Vyg:this.Vyg=Ga.a.instance.resolve("Box4.IFormattingEditor")}get uc(){return null!=this.JIg?this.JIg:this.JIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Dea(){return this.ZW||(this.ZW=new tv.WACStyleSet)}set Dea(b){this.ZW=b}get Zb(){return null!=this.hyg?this.hyg:this.hyg=Ga.a.instance.Oa("Box4.IFeatureHelper")}get Jn(){return this.zK.value}get xj(){return null!=
this.Zzg?this.Zzg:this.Zzg=Ga.a.instance.Oa("Box4.IInsertionPointFormatting")}get tZc(){return this.Ef||(this.Ef=Ga.a.instance.resolve("Box4.List.IListReader"))}get ig(){return null!=this.Bvg?this.Bvg:this.Bvg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Pd(){return null!=this.wHg?this.wHg:this.wHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Bj(){return null!=this.XGg?this.XGg:this.XGg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get sR(){return null!=
this.ozg?this.ozg:this.ozg=Ga.a.instance.resolve("Box4.IBox4GraphWriter")}tdm(b){const h=b.node;var u=this.xj?this.xj.c5h():null;if(u&&!u.equals(W.a.nil)){b=h.Lc;if(!b)return null;u=b.Eb(u);if(!u||(u=new sx.a(u),1!==this.uc.GG(u)))return null}else u=zc.FormattingReader.Vr(b),u=zc.FormattingReader.Eoa(u);return u}vlo(b,h){const u=this.uc.ZC(h);u&&u.jj(this.uc.wg(b))&&(this.Qog(h,u),this.xj&&(this.xj.Q6a(),this.xj.E7a(b,h)))}wCk(b,h){if(h)if(h.REb&&0<h.REb.length){let Q=new Ca.a;for(var u of h.REb)Q.add(u);
if(h.LDi){u=zc.FormattingReader.o3h(b);const ca=[];for(var B of u)B.formatting&&B.formatting.En&&ca.push(B.formatting.En);if(0<ca.length){B=Mu.APropertySet.D$h(ca);u=new Ca.a;for(const qa of Q)(!B.hasProperty(qa)||h.AWm&&qa===Ud.a.DJa)&&u.add(qa);Q=u}}this.il.i4b(b,!0,Q)}else this.il.i4b(b,!0);else Pc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}YJ(b,h,u,B=!1,Q=!1,ca=!1,qa=null,Qa=!1){var rb,Lb,Yb,gc,Fc;(null===(rb=v.AFrameworkApplication.K)||
void 0===rb?0:rb.$("RefactorListCodeIsEnabled"))||(Qa=!1);if(me.ParagraphReader.Wb(h))if(b)if(this.uc.$ca(b.xl()))if(2!==this.uc.GG(b))r.ULS.shipAssertTag(593506381,324,!1);else{var Sc=this.uc.ZC(h);if(Sc)if(rb=this.uc.wg(b),!rb)r.ULS.shipAssertTag(593506377,324,!1);else{if(Sc.jj(rb)){var ld=null,Hd=uq.a.instance.J(1)&&!B?h.VD():null;u||((null===qa||void 0===qa?0:qa.IQk)&&(null===(Lb=this.Zb)||void 0===Lb?0:Lb.isFeatureEnabled(102))?(this.wCk(h,qa),In.a.Sj&&1==qa.REb.length&&qa.REb[0]==Ud.a.DJa?ld=
this.Jn.Y5i(ld,h):this.gVo(h,b,qa)):(ld=this.Jn.Y5i(ld,h),this.il.i4b(h,!0)));this.Qog(h,Sc);Q&&(null===Hd||void 0===Hd?0:Hd.hasProperty(xh.a.Uv))&&Hd.removeProperty(xh.a.Uv);Lf.ListItemReader.$l&&(h.removeProperty(xh.a.Uv),h.PL=null,this.Qlj(b,h,ld,Qa));(null===(Yb=this.sR)||void 0===Yb?0:Yb.y$)?this.sR.y$(h,xh.a.Uv,b.id):h.properties.setValue(xh.a.Uv,b.id);In.a.Sj&&(Qa||this.tZc.oca(h))&&(null===(gc=this.Zb)||void 0===gc?0:gc.isFeatureEnabled(102))&&this.$Dj(h,b,qa);h.PL=b;h.IIa=null;for(u=0;u<
h.qa.length;u++)h.qa.J(u).formatting&&h.qa.J(u).formatting.oIb();Lf.ListItemReader.$l||this.Qlj(b,h,ld,Qa);(null===(Fc=this.eo)||void 0===Fc?0:Fc.r9)&&null!=this.MH&&this.MH.ulc(rb);B||!Hd||ca||this.Bj.sV(h,Hd,this.Pd.tg);Lf.ListItemReader.$l&&this.tZc.Lgb(b)&&this.Jn.i6()}}else r.ULS.shipAssertTag(593506379,324,!1)}else r.ULS.shipAssertTag(593506382,324,!1);else r.ULS.shipAssertTag(593506383,324,!1);else r.ULS.shipAssertTag(593506384,324,!1)}Qlj(b,h,u,B){this.tZc.Lgb(b)&&(u||(u=new vd.GraphIterator,
u.set(h),u.rd(),gf.OutlineElementNavigator.Wd(u)),B||Lf.ListItemReader.jg(u)||(h.zg(Jc.a.$d,Jc.a.gN,Jc.a.QA,Jc.a.f1,Jc.a.BSa,Jc.a.yw),this.qCd(u,b)))}gVo(b,h,u){const B=this.tZc.oca(b),Q=this.tZc.Lgb(h);B&&(this.$Dj(b,h,u),Q||B.removeProperty(Jc.a.M0))}$Dj(b,h,u){const B=b.Lc;if(b=this.ig.i1a(b)){var Q=null==b.En?new Qy.a:b.En.clone();lk.a.oWo(Q,h,u&&!u.LDi&&u.REb?u.REb:null);Q.pGa?h=B.fV(Q,!0):(B.Su(Q,null),h=Q);b.Tj=h.id}else r.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}qCd(){}X8c(b,
h){if(h){r.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var u=this.uc.ZC(h);u?(b=u.nFa(b))?this.uc.$ca(b.xl())?this.YJ(b,h,!1,void 0,void 0,void 0,null):r.ULS.shipAssertTag(593506368,324,this.uc.$ca(b.xl())):r.ULS.shipAssertTag(593506369,324,!!b):r.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else r.ULS.shipAssertTag(593506372,324,!1)}f7e(b,h=!1,u=!1){const B=this.uc.ZC(b).jj(Yj.StyleReader.wordStyleIdNormal);this.YJ(B,b,h,void 0,
u)}Qog(b,h){(b=qu.ai.ru(b))&&h.Pge(b)}IPh(b){var h=null;if(this.Zb&&this.Zb.isFeatureEnabled(37)){if(!b||!b.count)return r.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=lk.a.xr(),!h))return r.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var u=this.Dea.XX(h);if(!u)return r.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var B=new Map;B.set("NumberOfStyles",b.count.toString());B.set("Source",
"DeleteStyleAPI");xa.Health.instance.recordKpiUsage(Qp.a.Poe,0,Qp.a.xB,B);B=0;const qa=(new Date).getTime();var Q=null;let Qa=null,rb=null,Lb=null;const Yb=this.Zb.isFeatureEnabled(36)&&!0;Yb&&(Q=new zb.a,Qa=new zb.a,rb=new zb.a,Lb=new zb.a);for(var ca of b){if(!ca)return r.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const gc=u.jj(ca);if(!gc||!this.uc.je(gc,u))return r.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!gc,!!gc&&this.uc.je(gc,
u)),!1;const Fc=this.uc.GG(gc);if(2!==Fc&&1!==Fc)return r.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Fc),!1;const Sc=this.uc.ywa(gc,u);let ld=0;if(Sc){if(!this.uc.je(Sc,u))return r.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;ld=this.uc.GG(Sc);if(2!==ld&&1!==ld)return r.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Fc,ld),!1}else r.ULS.sendTraceTag(592221658,
3018,50,"Provided style's linked style is null.");let Hd=this.pDb(gc,u);if(!Hd)return!1;B++;Yb&&(1===Fc?(Qa.add(ca),Lb.add(gc.id)):(Q.add(ca),rb.add(gc.id)));if(Sc){Hd=this.pDb(Sc,u);if(!Hd)return!1;B++;Yb&&(1===ld?(Qa.add(this.uc.wg(Sc)),Lb.add(Sc.id)):(Q.add(this.uc.wg(Sc)),rb.add(Sc.id)))}}jx.a.KUc();u=lk.a.Dtf(u);ca=new Qg.GraphTransaction(15);ca.Db(h);Yb&&this.hZn(Q,Qa,rb,Lb,h);h.setValue(xh.a.uUa,u);Pc.b(572302817,3018,50,String.format("Style Object Ids - {0}",u));ca.Lfe();ca.dispose();h=(new Date).getTime();
Q=new Map;Q.set("Source","DeleteStyleAPI");Q.set("NumberOfStyles",b.count.toString());Q.set("TrueStyleCount",B.toString());Q.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Ub.a,{extendedProperties:Q,durationMs:h-qa});xa.Health.instance.recordKpiSuccess(Qp.a.Poe,b);return!0}return!1}hZn(b,h,u,B,Q){if(b&&b.count||h&&h.count)if(Q){var ca=(new Date).getTime();if(Q=this.gUl(Q)){for(;Q.moveNext();){if(!me.ParagraphReader.kh(Q.iterator))continue;const qa=Q.currentNode;this.SYn(qa,b,u);
this.TYn(qa,h,B)}u=(new Date).getTime();r.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",u-ca));B=new Map;B.set("Source","DeleteStyleRemoveStylesReferences");B.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new Ub.a,{extendedProperties:B,durationMs:u-ca});xa.Health.instance.recordKpiSuccess(Qp.a.Poe,b)}}else Pc.b(577520338,3018,50,"PageContentNode not provided.");else Pc.b(577520337,3018,50,"No style IDs provided")}SYn(b,h,u){if(h&&h.count&&
b){var B=b.Oz;B&&B.hasProperty(xh.a.Uv)&&u.contains(B.getValue(xh.a.Uv))&&(B.removeProperty(xh.a.Uv),b.Oz=B,b.VD()&&this.Bj.sV(b,b.VD(),this.Pd.tg));(u=this.uc.Ro(b))&&(u=this.uc.wg(u))&&h.contains(u)&&this.f7e(b,!0,!0)}}TYn(b,h,u){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let qa=0;qa<b.qa.length;qa++){var B=b.qa.J(qa);if(B&&B.formatting&&(B=B.formatting)&&B.Kb){var Q=zc.FormattingReader.Eoa(B);Q&&(Q=this.uc.wg(Q))&&h.contains(Q)&&this.Xn.X6e(B);if(Q=B.Kb.ao){var ca=Q.En;ca&&(ca=ca.clone(),ca.hasProperty(xh.a.nw)&&
u.contains(ca.getValue(xh.a.nw))&&this.bXn(b,ca,Q,B));uq.a.instance.J(1)&&(ca=qa===b.qa.length-1?b.characterData.length:b.qa.J(qa+1).cp,this.Bj.FPb(b,B.Kb,B.Kb.cp,ca,Q,B,this.Pd.tg))}}}}bXn(b,h,u,B){b&&h&&u&&B&&(b=b.Lc)&&(h.removeProperty(xh.a.nw),h.pGa?h=b.fV(h,!0):b.Su(h,null),u.Tj=h.id,B.Kb.ao=u)}gUl(b){if(!b)return null;b=vd.GraphIterator.eb(b);return b.gp()?Fa.a.zs(b,b.origin):null}pDb(b,h){if(!b)return r.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var u=b.xl();
return this.uc.$ca(u)?h.gZn(b)?!0:(u=new Map,u.set("Source","DeleteStyle"),u.set("StyleType",iy[this.uc.GG(b)]),u.set("IsCustomStyle",this.uc.je(b,h).toString()),u.set("IsLinkedStyle",(!!this.uc.ywa(b,h)).toString()),b=Object.assign(new Ub.a,{extendedProperties:u}),xa.Health.instance.recordKpiFailure(Qp.a.Poe,"UnableToDeleteStyle",!1,!0,b),r.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(r.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),
!1)}ZRa(b,h,u,B){if(this.Zb&&this.Zb.isFeatureEnabled(83)){if(!b)return r.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!u&&(u=lk.a.xr(),!u))return r.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=this.Dea.XX(u);if(!ca)return r.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ca.jj(b);if(!b)return r.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Q=this.uc.GG(b);
if(2!==Q&&1!==Q)return r.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",Q),!1;xa.Health.instance.recordKpiUsage(Qp.a.$qg,0,Qp.a.xB,new Map([["Source","ModifyStyleAPI"]]));Q=Date.now();const qa=new Qg.GraphTransaction(15);let Qa,rb;try{qa.Db(u);if(!(B&&0!=B.length||h&&0!=h.count))return!1;if(B&&0!=B.length&&(Qa=lk.a.MRd(b),!ca.kjl(b,B)))return this.Sxa("ModifyStyleAPI",b,ca,Q,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Sc=ca.oXo(b,h);rb=lk.a.MRd(b);if(!Sc)return this.Sxa("ModifyStyleAPI",
b,ca,Q,"UnableToModifyStyle"),!1}this.Ybn(b,u,rb,Qa);jx.a.KUc();const Lb=lk.a.Dtf(ca);u.setValue(xh.a.uUa,Lb);Pc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Lb));const Yb=Date.now(),gc=new Map([["Source","ModifyStyleAPI"]]),Fc=Object.assign(new Ub.a,{extendedProperties:gc,durationMs:Yb-Q});xa.Health.instance.recordKpiSuccess(Qp.a.$qg,Fc);return!0}finally{qa&&qa.dispose()}}return!1}Ybn(b,h,u,B){var Q,ca;if(null!==b){var qa;B&&((qa=null===(Q=this.Jn)||void 0===Q?void 0:Q.vne(h,B,b,!0))||
Pc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));u&&((qa=null===(ca=this.Jn)||void 0===ca?void 0:ca.vne(h,u,b,!1))||Pc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}Sxa(b,h,u,B,Q){const ca=Date.now();b=new Map([["Source",b],["StyleType",iy[this.uc.GG(h)]],["IsCustomStyle",this.uc.je(h,u).toString()],["IsLinkedStyle",(!!this.uc.ywa(h,u)).toString()]]);B=Object.assign(new Ub.a,{extendedProperties:b,
durationMs:ca-B});xa.Health.instance.recordKpiFailure(Qp.a.$qg,Q,!1,!0,B)}static get ai(){return Zo.PageNavigator.instance}}Object(m.a)(qu,"WACStyleEditor",null,[1124]);class QB extends qu{constructor(b,h,u){super(b,u);this.S6=h}get Xs(){return this.S6.value}qCd(b,h){this.Xs.qCd(b,h)}}Object(m.a)(QB,"WACStyleEditor",qu,[]);class tx{y7a(b,h){b.properties.setValue(Jc.a.marginTop,h)}w7a(b,h){b.properties.setValue(Jc.a.marginBottom,h)}Lja(b,h){b.properties.setValue(Jc.a.marginLeft,h)}x7a(b,h){b.properties.setValue(Jc.a.marginRight,
h)}Ocg(b,h){b.properties.setValue(Jc.a.Go,h)}Ncg(b,h){b.properties.setValue(Jc.a.rv,h)}vkj(b,h){b.properties.setValue(Jc.a.YDi,h)}BPb(b,h){b.properties.setValue(Ud.a.XE,h)}zeo(b,h){b.properties.setValue(Ud.a.gna,h)}rkc(b,h){b.properties.setValue(Ud.a.mG,h)}Zko(b,h){b.properties.setValue(Ud.a.separator,h)}}Object(m.a)(tx,"WordSectionEditor",null,[313]);class RB{get name(){return"WordEditor.OutlineLevelEditors"}wc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new tx).as("Box4.IWordSectionEditor").ha();
v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new Ew(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new ao(Cr.a.NPa,b.resolve("WordEditor.List.IFlatListReader"),b.Re("Box4.IOutlineElementEditor"),b.Re("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new ao(Cr.a.NPa,b.resolve("WordEditor.List.IFlatListReader"),b.Re("Box4.IOutlineElementEditor"),b.Re("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new Hz).as("Box4.List.ICursorMovementValidator").ha(),b.ia("Box4.Styles.WACStyleReader",()=>new PB.a(new tv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").ha(),
b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new QB(b.resolve("Box4.List.IListReader"),b.Re("WordEditor.IFlatListEditor"),b.Re("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){M.a.instance.Gc(new RB)}}Object(m.a)(RB,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var SB=c(595),jy=c(216);class jm{constructor(b,h){this.Fd=b;this.mh=h;this.uMa=null}oge(b){var h=b.propertySet.ja(Jc.a.listID,0);const u=b.propertySet.ja(Jc.a.listLevel,-1);
if(0<h&&0<=u)this.uMa=b;else{let B=1;const Q=b.listStyle;42!==Q&&0<Q&&(B=Q);this.uMa=gu.a.V_(b.listType,B,null,h,u,void 0,"")}h=new Vs.a;switch(b.e6){case 0:this.uMa.VB=h.L$e();break;case 2:this.uMa.VB=h.PJh(h.Zxh,h.Yxh);break;case 1:this.uMa.VB=h.Caf(h.fTf,h.gTf)}}wjo(b){b&&(this.uMa=b)}cLh(b){const h=Wh.a.instance.Ap(Ob.a.O$k);Yc.OutlineElementReader.Bh(b)||(r.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),Wh.a.instance.Yb("PossiblyIncorrectListCreation",
{["Reason"]:pe.a.DDb}));Lf.ListItemReader.jg(b)&&(r.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),Wh.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:pe.a.p3k}));const u=Yc.OutlineElementReader.qU(b);u&&!u.hasProperty(Jc.a.$va)&&r.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const B=this.S$k();b.xf(B,4);u&&(u.bJ=B);h.end();return B}S$k(){return Sr.a.instance.createInstance(393234)}Lda(b){const h=
Wh.a.instance.Ap(Ob.a.Lda);Yc.OutlineElementReader.Bh(b)||Wh.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:pe.a.DDb});Lf.ListItemReader.jg(b)&&(Pm.a.getInstance().Nv?this.QHa(b):this.N9i(b));h.end()}N9i(b){this.Fd.BP(b);b.vg()}Gma(b,h,u,B=!1){const Q=Wh.a.instance.Ap(Ob.a.DCk);this.qlj(b,u,B);const ca=b.hasProperty($c.a.WOi);var qa=b.ja($c.a.qYd,!1);let Qa=!1;1===u.Zr&&u.Cpa&&!u.KJ&&(Qa=!0);const rb=u.propertySet.ja(Jc.a.nv,null);rb&&rb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===u.listType?
Qa=u.Cpa&&!u.KJ:u.listType||(Qa=!u.listStyle));if(qa)Qa&&(u.w$(16,0),b.setValue($c.a.LA,16),b.setValue($c.a.BRa,0));else{qa=this.Fd.tw(h);this.Cpj(u,qa,ca,Qa)&&(Q.properties.Z("ToggledOff","true"),u.w$(16,0),this.lio(b));if(!this.N9d(b,h,u,B))return Q.end(),r.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,gxa:u};!u.listType&&b.hasProperty($c.a.P4a)&&(u.dC=b.getValue($c.a.P4a),b.removeProperty($c.a.P4a))}if(ca&&(Q.properties.Z("MultipleOESelection",
"true"),({gxa:u}=this.Vro(h,u)).returnValue))return Q.end(),r.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,gxa:u};this.tyk(h,u,b,B);nt.a.wcj();b.hasProperty(Sh.a.LQ)&&nt.a.t7k(b.getValue(Sh.a.LQ),h,this.Fd);b.setValue($c.a.qYd,!0);Q.end();return{returnValue:!0,gxa:u}}Cpj(b,h,u,B){if(B)return!0;if(h){B=b.listType===h.listType;const Q=!b.listStyle&&b.dC===nj.a.qm;let ca=b.listStyle===h.listStyle&&b.dC===h.dC;b=(!b.Cpa||this.w$f(h,b))&&!u;ca=ca&&
b;return B&&(Q||ca)}return!1}lio(b){b.setValue($c.a.LA,16);b.setValue($c.a.BRa,0)}w$f(){return!0}qlj(){}N9d(){return!0}Vro(b,h){return{returnValue:16!==h.listType&&Yc.OutlineElementReader.isEmpty(b,!0),gxa:h}}XHc(b){const h=Wh.a.instance.Ap(Ob.a.XHc);me.ParagraphReader.Wb(b)||Wh.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:pe.a.wff});const u=new vd.GraphIterator;u.set(b);u.rd();u.ot(12);gf.OutlineElementNavigator.Wd(u);this.QHa(u);h.end()}merge(b,h,u){const B=Wh.a.instance.Ap(Ob.a.k_m);
Yc.OutlineElementReader.Bh(h)||Wh.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Yc.OutlineElementReader.Bh(b)||Wh.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});Lf.ListItemReader.jg(h)&&(B.properties.Z("UseSourceListWithNonlistDestination",u.toString()),u&&Lf.ListItemReader.jg(b)&&this.Lda(b),Lf.ListItemReader.jg(b)&&!u?this.$2i(h,b):u&&(u=this.oai(h),1===u.Zr&&u.I6e(!0),this.WFc(b,u),B.properties.Z("MoveListInfoFromSrcToDestOE","true")),this.Lda(h),
B.properties.Z("RemoveListFromSrcOE","true"));B.end();return!0}$2i(){}oai(b){return this.Fd.tw(b)}EMc(b,h){h.hasProperty($c.a.LA)||(b===Ob.a.oD?h.setValue($c.a.LA,1):(b===Ob.a.JL||b===Ob.a.pda)&&h.setValue($c.a.LA,0));h.hasProperty($c.a.BRa)||h.setValue($c.a.BRa,0);return h}X2b(b,h,u,B,Q,ca,qa,Qa){const rb=Wh.a.instance.Ap(Ob.a.X2b),Lb=this.Fd.tw(h);u=gu.a.V_(0,u,void 0,void 0,void 0,qa);u.dC=B;u.LQ=ca;Lb&&u.Fxf(Lb)&&u.dC===Lb.Ou||(B=new Qg.GraphTransaction(15),B.Qt(h),Qa.Xgn(u.listType,u.listStyle,
u.dC,u.levelText,u.LQ)&&(jm.ig.Ge(Q,""),me.ParagraphReader.Wb(b)&&jy.a.mpa(b)&&(h=this.Fd.oca(b))&&jm.ig.wul(b,h)),B.dispose());rb.end()}vne(b,h,u,B=!1){if(null===u||null===b||null===h)return!1;b=this.Fd.Lx(b,h.listId,h.listLevel);if(!b)return r.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(B){if(b.hasProperty(xh.a.Uv)){b.getValue(xh.a.Uv)instanceof W.a||r.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!W.a.zq(b.getValue(xh.a.Uv),u.id))return r.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(xh.a.Uv);return!0}}else{u=u.id;u instanceof W.a||r.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(xh.a.Uv))return r.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(xh.a.Uv,
u);return!0}return!1}static get b8b(){return null!=jm.zyg?jm.zyg:jm.zyg=Ga.a.instance.Oa("Box4.IFontSlotProvider")}static get ig(){return null!=jm.svg?jm.svg:jm.svg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get vp(){return Pm.a.getInstance()}}Object(m.a)(jm,"ListEditor",null,[491]);var ky=c(819),Kt=c(318);class Xs{constructor(b,h,u,B,Q,ca){this.Ef=Q;this._pageContent=u;this.Qwb=Array(Xs.V4);this.X_b=Array(Xs.V4);this.Vfh=Array(Xs.V4);this.EPe=Array(Xs.V4);this.hch=Array(Xs.V4);
this.l3=B;this.iEc=ca;for(B=0;B<Xs.V4;B++){var qa=this.iai(b,B,u,Q);qa?(ca=qa.ja(Xe.a.O0,nj.a.qm),qa=qa.ja(Jc.a.P6c,nj.a.qm)):qa=ca=nj.a.qm;this.X_b[B]=ca!==nj.a.qm?ca:nj.a.IKc;this.EPe[B]=qa===nj.a.qm?B-1:qa-1;Xs.B9(h)&&(this.Vfh[B]=nj.a.qm,this.hch[B]=nj.a.qm);this.Qwb[B]=this.X_b[B]}}iai(b,h,u,B){B.h4(u);return Pm.a.getInstance().iVc&&this.iEc?this.Ef.Uqf(b,h,this.l3,u):this.Ef.lQc(b,h,u.Lc,u)}restart(b){this.Qwb[b]=this.X_b[b]}KPi(b){for(var h=0;h<b;h++)this.Qwb[h]===this.X_b[h]&&this.Qwb[h]++;
for(h=b+1;h<Xs.V4;h++)this.EPe[h]>=b&&this.restart(h);return this.Qwb[b]++}static B9(b){return!!b&&b.isFeatureEnabled(73)}}Xs.V4=9;Object(m.a)(Xs,"AWordList",null,[38]);class Ry{constructor(b,h,u,B){this.Sbb=new Eq.ScriptSharpLegacyMap;this.Ef=b;this.EK=h;this.l3=u;this.iEc=B}tw(b,h){this.Sbb.nb(b)||this.Sbb.Z(b,new Xs(b,h,this.EK,this.l3,this.Ef,this.iEc));return this.Sbb.J(b)}kSf(b,h,u){return this.tw(b,u).KPi(h)}}Object(m.a)(Ry,"AListNumberingMap",null,[1288]);class IA extends Xs{constructor(b,
h,u,B,Q,ca){super(b,h,u,B,Q,ca)}S5l(b,h,u,B){B.h4(u);return Pm.a.getInstance().iVc&&this.iEc?this.Ef.s1l(b,h,this.l3):this.Ef.r1l(b,h,this._pageContent.Lc)}UDj(b,h,u){var B=this.S5l(b,h,this._pageContent,this.Ef);B?(b=B.ja(Xe.a.O0,nj.a.IKc),B=B.ja(Jc.a.P6c,nj.a.qm),this.Qwb[h]=this.Vfh[h]=this.X_b[h]=b,B!==nj.a.qm&&(this.hch[h]=this.EPe[h]=B-1)):u&&(B=this.iai(b,h,this._pageContent,this.Ef),b=nj.a.IKc,B&&(b=B.ja(Xe.a.O0,nj.a.IKc)),this.Qwb[h]=this.X_b[h]=b)}}Object(m.a)(IA,"WordList",Xs,[]);class Sv extends Ry{constructor(b){super(b.Fd,
b.pageContentNode,b.BTa,b.cHj);this.Bah=new zb.a}T0l(b,h,u){let B;Pm.a.getInstance().AY?{value:B}=this.Ef.rF.Fc(b,B):{value:B}=this.Ef.L0.Fc(b,B);this.Sbb.nb(B)||this.Sbb.Z(B,new IA(b,u,this.EK,this.l3,this.Ef,this.iEc));if(!this.Bah.contains(b))for(this.Bah.add(b);h<nj.a.V4;h++)this.Sbb.J(B).UDj(b,h,!1);else if(!h)for(h+=1;h<nj.a.V4;h++)this.Sbb.J(B).UDj(b,h,!0);return this.Sbb.J(B)}kSf(b,h,u){return Xs.B9(u)?this.T0l(b,h,u).KPi(h):super.kSf(b,h,u)}}Object(m.a)(Sv,"ListNumberingMap",Ry,[]);class JA{constructor(){this.gSa=
0;this.NIj=!1}}Object(m.a)(JA,"LastNumber",null,[]);var Iz=c(841),TB=c(414),Sy=c(895);class Su{constructor(){this.startAt=this.yTa=0}}Object(m.a)(Su,"WordListRestartInfo",null,[]);class fq{constructor(b,h,u,B){this.g5d=!1;this.Xs=b;this.Uxi=u;this.rbc=B;this.Aw=this.Xs.DB(h);this.HP=new vd.GraphIterator;this.HP.jd(h)}static get Fd(){return fq.Ef||(fq.Ef=Ga.a.instance.resolve("Box4.List.IListReader"))}static set Fd(b){fq.Ef=b}static get vp(){return Pm.a.getInstance()}static eCl(b,h,u,B=!1,Q=!1){var ca=
h.currentNode;let qa=null,Qa=!1,rb=!1;h=h.GSb();const Lb=Fa.a.ap(h);Lb.moveNext();for(h=Lb.iterator;h.currentNode!==ca;){let gc=rb=Qa=!1;var Yb=fq.oql(h);if(Yc.OutlineElementReader.Bh(h)&&!Yb){Yb=!1;if(h.Fs(4))if(fq.hRi(h,u,!0,B,Q)){if(gc=!0,qa=new fq(b,h,!1,!1),Lb.moveNext(),Lb.iterator===ca&&(Qa=!0),B)break}else Yc.OutlineElementReader.isEmpty(h,!1)||(Yb=!0),rb=!0;else!Yc.OutlineElementReader.isEmpty(h,!1)&&h.rjb(12)&&(Yc.OutlineElementReader.UQ(h)||(Yb=!0));!B&&Yb&&qa&&(u.propertySet.hasProperty(Jc.a.listLevel)?
qa.Aw.level=0:qa=null)}gc||Lb.moveNext();h=Lb.iterator}qa&&(qa.rbc=Qa);if(!qa&&h.Jf(1))for(ca=!0;h.currentNode;){if(Yc.OutlineElementReader.Bh(h)){if(h.Fs(4)&&fq.hRi(h,u,!1,B,Q)){qa=new fq(b,h,!0,ca);break}if(!Yc.OutlineElementReader.isEmpty(h,!1))break}if(!h.Jf(1))break;ca=!1}qa&&(qa.g5d=rb);return qa}static oql(b){var h=b.Ub(2);if(!h)return!1;h=me.ParagraphReader.kh(b)&&fq.yPm(h);b.rc();return h}static yPm(b){return Hq.a(b,8)}static hRi(b,h,u,B=!1,Q=!1){if(!Lf.ListItemReader.jg(b)&&(r.ULS.sendTraceTag(508913603,
393,15,"Trying to call oeMatchesInfo for non list item"),Lf.ListItemReader.$l))return!1;if(Lf.ListItemReader.$l)var ca=Lf.ListItemReader.w4(b);else fq.Fd.BP(b),ca=b.currentNode,b.rc();const qa=fq.Fd.UX(ca);(b=h.Kz===qa.Kz)&&h.listStyle&&1!==h.Zr&&(b=h.listStyle===qa.listStyle);b&&(h.Cpa&&1!==h.Zr||h.o8b||Q)&&(b=fq.tNm(h,qa),h.Kz||(b=b&&h.font===qa.font));if(1===h.Zr)if(1===qa.Zr&&qa.propertySet.hasProperty(Sh.a.Ylb))b=h.e6===qa.e6;else return!1;b&&h.Kz&&h.dC!==nj.a.qm&&(b=qa.Ou,u&&(B&&1===h.dC&&1===
b||b++),b=h.dC===b);b&&(B||h.o8b)&&(h=Lf.ListItemReader.P0l(h).listId,ca=Lf.ListItemReader.RX(ca,{BOa:0}).listId,0<h&&0<ca&&(b=h===ca));return b}static tNm(b,h){h=h.JJf;b.Cpa&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.JJf.toLocaleLowerCase()}static fCl(b,h,u){var B=h.currentNode;let Q=null;const ca=new vd.GraphIterator,qa=b.Aoa(B,u);var Qa=!1;let rb=!1;ca.jd(h);ca.rc();for(ca.Ub(1);ca.currentNode!==B;)rb=Qa=!1,Yc.OutlineElementReader.Bh(ca)&&ca.Fs(4)&&(h=b.DB(ca),fq.iRi(h,
u,!0)?(Q=new fq(b,ca,!1,!1),Qa=!0):(rb=!0,h.listID===u.listID&&h.level<=qa.yTa&&(Q=null))),ca.Jf(1);Q&&(Q.rbc=Qa);if(!Q&&ca.Jf(1))for(B=!0;ca.currentNode;){if(Yc.OutlineElementReader.Bh(ca)&&ca.Fs(4)){Qa=b.DB(ca);if(Qa.listID===u.listID&&Qa.level<=qa.yTa)break;if(fq.iRi(Qa,u,!1)){Q=new fq(b,ca,!0,B);break}}if(!ca.Jf(1))break;B=!1}Q&&(Q.g5d=rb);return Q}static iRi(b,h,u){let B=b.listID===h.listID&&b.level===h.level;B&&h.Ou!==nj.a.qm&&(b=b.Ou,u&&b++,B=h.Ou===b);return B}}fq.Ef=null;Object(m.a)(fq,"JoinTargetInfo",
null,[]);class Xr{constructor(b,h){this.Aw=null;this.action=b;h&&(this.Aw=h)}static Mfc(){return new Xr(0)}static SFi(){return new Xr(1)}static LZm(b){return new Xr(3,b)}static c_m(b){return new Xr(2,b)}static OZm(b){return new Xr(4,b)}}Object(m.a)(Xr,"ApplyListInfoResult",null,[]);class ux{constructor(b,h,u){this.Olc=u;this.hvn=h;this.oaa=u-h.Ou;this.a2c=h.listID}get delta(){-1!==this.oaa&&(this.oaa=this.Olc-this.hvn.Ou);return this.oaa}set delta(b){this.oaa=b}}Object(m.a)(ux,"ListTransferInfo",
null,[]);class $o extends jm{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){super(b,u,rb);this.cE=Fc;this.zfh=!1;this.Wsc=this.Rid=this.zVb=null;this.Hie=(Sc,ld)=>ld.listID===Sc.listID&&ld.level===Sc.level;this.mwo=(Sc,ld,Hd)=>ld.listID!==Sc.listID&&ld.listID!==Hd.a2c||ld.level!==Sc.level?!1:!0;this.f9m=(Sc,ld,Hd)=>ld.listID===Sc.listID||Hd&&ld.listID===Hd.a2c?!0:!1;this.Frj=(Sc,ld,Hd,Ie,fe)=>{const de=Sc.ja(jm.vp.g2,-1);this.Erj(Sc,ld,de+Hd,Ie,fe)};this.Erj=(Sc,ld,Hd,Ie,fe)=>{Pm.a.getInstance().QB||
this.cE.qrb(Sc,Ie);ld=Lf.ListItemReader.$l?ld:Sc;Sc=this.aGb(ld);ld=vd.GraphIterator.eb(ld);ld.rd();ld.rc();this.vGl(ld,Sc,this.f9m,this.zCo,fe)};this.nwo=(Sc,ld,Hd,Ie,fe)=>{const {Aw:de,iterator:ne}=this.A6b(ld,()=>{Pm.a.getInstance().QB||this.cE.qrb(Sc,Ie);Pm.a.getInstance().Nv&&this.cE.qrb(ld,Ie);var ye=Lf.ListItemReader.$l?ld:Sc;const Vf=this.aGb(ye);ye=vd.GraphIterator.eb(ye);ye.rd();ye.rc();return{Aw:Vf,iterator:ye}});this.xOd(ne,de,this.avj,this.Lje,fe)};this.xCo=(Sc,ld,Hd,Ie,fe)=>{this.C5i(Sc,
ld,Hd,Ie,fe)};this.Lje=(Sc,ld,Hd,Ie)=>{Hd.listID=ld.listID;Ie.Ub(4);const fe=this.Zq.$Fb(Ie.currentNode);this.A6b(fe,()=>{this.XFc(Ie.currentNode,Hd,fe);Ie.rc()})};this.zCo=(Sc,ld,Hd,Ie)=>{Lf.ListItemReader.jg(Ie)&&(Sc=new vd.GraphIterator,Sc.jd(Ie),Sc.rd(),this.Fd.BP(Sc),this.Rsi(Ie.currentNode,Sc.currentNode))};this.yCo=(Sc,ld,Hd,Ie,fe)=>{Hd.listID=ld.listID;this.C5i(Sc,ld,Hd,Ie,fe);this.Lje(Sc,ld,Hd,Ie,fe)};this.$uj=(Sc,ld)=>ld.listID===Sc.listID;this.wCo=(Sc,ld)=>ld.level<=Sc.level;this.avj=(Sc,
ld,Hd)=>ld.listID===Hd.a2c;this.Zo=Q;this.Rsa=b;this.Vmd=h;this.Kc=B;this.RZf={};this.g9j=ca;this.Ud=qa;this.wq=Qa;this.od=Lb;this.nz=Yb;this.Yu=gc}get B9(){return this.Rsa.iia}get LQb(){return this.zfh}set LQb(b){this.zfh=b}get Zq(){return this.Rsa}get T5(){return this.Yu}get uc(){return this.nz}get gt(){return this.Zq.gt}get oq(){return this.Zq.oq}get qua(){return this.Zq.qua}get x9(){return this.Zq.x9}set x9(b){this.Zq.x9=b}get uRa(){return this.Zq.uRa}set uRa(b){this.Zq.uRa=b}get o$c(){return null!=
this.qFg?this.qFg:this.qFg=Ga.a.instance.Oa("Box4.List.ISingleLevelListEditor")}tyk(b,h,u,B){r.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const Q=u.ja($c.a.qYd,!1);let ca=!1,qa=-1;!Q||h.listStyle&&1!==h.Zr||(ca=!u.ja($c.a.UHf,!1),qa=u.ja($c.a.IJf,-1));b=this.WFc(b,h,{Hpi:ca,qZm:qa,FGl:B,propertySet:u});Q||u.setValue($c.a.UHf,2===b.action);3===b.action&&!u.hasProperty($c.a.IJf)&&b.Aw&&u.setValue($c.a.IJf,b.Aw.level)}merge(b,h,u,B=null){const Q=Lf.ListItemReader.jg(b)||
Lf.ListItemReader.jg(h);b=super.merge(b,h,u,B);Q&&this.i6();return b}$2i(b,h){this.jSk(b,h)}jSk(b,h){b=this.Fd.Nqf(b);const u=this.Fd.Nqf(h);-1!==b&&-1!==u&&(b-=u,0<b?this.Vmd.value.SKc(h,b):0>b&&this.Vmd.value.MSa(h,b,0))}N9i(b){this.Fd.BP(b);b.vg();uq.a.instance.J(1)&&this.i6()}DKo(b,h,u,B){var Q=vd.GraphIterator.eb(u);Q=this.DB(Q);this.EKo(Q,b,h,u,B)}DB(b){if(!Lf.ListItemReader.jg(b)&&(r.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),Lf.ListItemReader.$l))return null;
let h;Lf.ListItemReader.$l?h=Lf.ListItemReader.w4(b):(this.Fd.BP(b),h=b.currentNode,b.rc());return this.aGb(h)}Rkj(b,h){this.Fd.BP(b);const u=b.currentNode;b.rc();Pm.a.getInstance().QB||this.cE.qrb(u,h);b=Yc.OutlineElementReader.qU(b);Pm.a.getInstance().Nv&&this.cE.qrb(b,h);return this.aGb(Lf.ListItemReader.$l?b:u)}aGb(b){var h;const u=new ky.a;Lf.ListItemReader.$l&&(b&&me.ParagraphReader.Wb(b)||r.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===
(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=uq.a.instance.J(1)?Lf.ListItemReader.$l?Lf.ListItemReader.RX(b)||Lf.ListItemReader.USd(b):this.Fd.fP(b,!1,!0):Lf.ListItemReader.RX(b,{BOa:0,W5b:-1});u.listID=h.listId;u.level=h.listLevel;u.M0=Lf.ListItemReader.Exf(b);h=this.RRd(b);u.qgo(h);u.Ou=Lf.ListItemReader.fvf(b);u.ILc=Lf.ListItemReader.evf(b);return u}qge(b,h,u=!1){const B=u?null:Yc.OutlineElementReader.qU(b);b=Pm.a.getInstance().QB?null:this.cLh(b);this.XFc(b,h,
B,u);return b}XFc(b,h,u=null,B=!1){b||Wh.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!Pm.a.getInstance().Nv||B||u||Pc.b(509364259,393,15,"Apply list info called without para node");h||Wh.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});Pm.a.getInstance().Nv&&u&&!B&&this.cE.mge(u,h.listID,h.level);Pm.a.getInstance().QB||(this.cE.mge(b,h.listID,h.level),h.M0&&b.setValue(Jc.a.M0,!0),Pm.a.getInstance().Nv||null==h.levelText||b.setValue(Jc.a.nv,h.levelText))}XEj(b){this.Zq.h4(b);
b=$o.ai.ru(b);let h=b.ja(Jc.a.oq,null);h=h?Array.clone(h):[];b.setValue(Jc.a.oq,h);this.Zq.jbc()}kCo(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Z0l(b){b=b.view;if(!b.mb||!b.mb.hb)return null;b=Qo.OutlineElementGeneralizer.nha(b.mb.hb,!1);if(1!==b.length)return null;b=vd.GraphIterator.eb(b.getContext(0).node);if(!Lf.ListItemReader.jg(b))if(14===b.Qd().type){const h=Lf.ListItemReader.w8h(b.currentNode);h&&b.set(h)}else Pc.b(589177753,
393,15,"Encountered an OE of non list type."),b.rc();b.rd();return b}zal(b,h,u,B){const Q=b.uJ(),ca=new ky.a;ca.listID=this.wLh(b);this.B9?(ca.L1d=jm.vp.AY?this.xLh(b):this.nLh(b),this.E6i(b,ca.listID,ca.L1d)):this.G6i(b,ca.listID);ca.Dkj(h.propertySet,this.ZYc(u));this.RLd(b);u=this.mai(b,h);for(let Qa=0;9>Qa;Qa++){const rb=new Jv.a;Q.vd.Su(rb);this.F6i(b,this.B9?W.a.nil:rb.id,this.B9?rb.id:W.a.nil);this.lqk(rb,h.Kz,Qa);this.Nnh(rb,u,Qa);var qa=B.yKb[Qa];qa=6===qa?gu.a.V_(1,1):gu.a.V_(0,qa);qa.via&&
rb.setValue(Xe.a.a5,qa.via);h.dC!==nj.a.qm&&Qa===ca.level&&rb.setValue(Xe.a.O0,h.dC);B.LEa&&B.LEa[Qa]&&rb.setValue(Xe.a.font,B.LEa[Qa]);qa=B.aZc[Qa];r.ULS.shipAssertTag(22127636,338,!!qa);rb.setValue(Jc.a.nv,qa);rb.setValue(Jc.a.gda,B.V0d[Qa]);Kt.a.che(B.e6,rb)}return ca}xal(b,h,u){const B=b.uJ(),Q=new ky.a;Q.listID=this.wLh(b);this.B9?(Q.L1d=jm.vp.AY?this.xLh(b):this.nLh(b),this.E6i(b,Q.listID,Q.L1d)):this.G6i(b,Q.listID);Q.Dkj(h.propertySet,this.ZYc(u));if(!h.listStyle)switch(Q.level%3){case 0:h.w$(h.listType,
1);break;case 1:h.w$(h.listType,2);break;case 2:h.w$(h.listType,3)}this.RLd(b);u=this.mai(b,h);for(let ca=0;9>ca;ca++){const qa=new Jv.a;B.vd.Su(qa);this.F6i(b,this.B9?W.a.nil:qa.id,this.B9?qa.id:W.a.nil);this.kqk(qa,h.Kz,ca);this.Nnh(qa,u,ca);2===ca%3&&h.Kz?qa.setValue(Jc.a.gda,"right"):qa.setValue(Jc.a.gda,"left");ca===Q.level&&(h.via&&qa.setValue(Xe.a.a5,h.via),h.dC!==nj.a.qm&&qa.setValue(Xe.a.O0,h.dC),h.Kz?this.Hkj(h,qa,ca):($o.Ekj(h,qa),$o.Gkj(h,qa)),$o.Fkj(h,qa),h.o8b&&qa.rOa(h.propertySet,
Jc.a.listID,Jc.a.listLevel))}return Q}Hkj(b,h,u){b.Cpa?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(u+1))):b=b.UUc||b.Joa?b.levelText:"%"+(u+1)+".";r.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Jc.a.nv,b)}Cpj(b,h,u,B){if(b.UUc)return!1;if(1===b.Zr)return B;if(B)return!0;if(h){B=b.listType===h.listType;const Q=!b.listStyle&&b.dC===nj.a.qm;let ca=b.listStyle===h.listStyle&&b.dC===h.dC;b=(!b.Cpa||this.w$f(h,b))&&!u;ca=ca&&b;return B&&(Q||ca)}return!1}RLd(b){this.zVb||(this.zVb=b.ja(Jc.a.Mgl,null));
this.Rid||(this.Rid=b.ja(Jc.a.Lgl,null));this.Wsc||(this.Wsc=b.ja(Jc.a.Ngl,null))}ZYc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}JZl(b){return b?this.Zo.nU(b).Ut-this.Zo.DG(b).Ut:-1}G6i(b,h){const u=b.ja(Jc.a.gt,null),B=u?u.length:0,Q=Array(B+1);let ca=0;for(;ca<B;ca++)Q[ca]=u[ca];Q[ca]=h;b.setValue(Jc.a.gt,Q);this.Zq.jbc()}E6i(b,h,u){this.UYe(Jc.a.gt,b,h);if(jm.vp.AY){this.UYe(Ud.a.fSa,b,u);var B=this.Zq.ORd(b);B.add(h,u);b.setValue(Ud.a.rF,TB.b(SB.a.enc(B)))}else this.UYe(Jc.a.qua,
b,u),B=this.Zq.NRd(b),B.add(h,u),b.setValue(Jc.a.L0,TB.b(SB.a.enc(B)))}F6i(b,h,u){this.B9?(this.Dnh(Jc.a.oq,b,u),this.Dnh(Jc.a.U9,b,h)):(u=(u=b.ja(Jc.a.oq,null))?Array.clone(u):[],u.push(h),b.setValue(Jc.a.oq,u),this.Zq.jbc())}UYe(b,h,u){const B=h.ja(b,null),Q=B?B.length:0,ca=Array(Q+1);let qa=0;for(;qa<Q;qa++)ca[qa]=B[qa];ca[qa]=u;h.setValue(b,ca)}Dnh(b,h,u){let B=h.ja(b,null);B=B?Array.clone(B):[];B.push(u);h.setValue(b,B)}kqk(b,h,u){var B=u%3+1;const Q=h?this.Wsc:this.Rid;Q&&u<Q.length?b.setValue(Jc.a.mt,
Q[u]):b.setValue(Jc.a.mt,360);B=gu.a.V_(h?0:1,this.kCo(B),null,0,u);b.Yw(B.propertySet);b.setValue(Jc.a.M2e,h?-1:-2);h?b.setValue(Jc.a.nv,"%"+(u+1)+"."):(b.setValue(Xe.a.font,this.kTl(u)),b.setValue(Jc.a.nv,String.fromCharCode(this.$Sl(u))));Kt.a.zkc(2,b)}lqk(b,h,u){const B=h?this.Wsc:this.Rid;B&&u<B.length?b.setValue(Jc.a.mt,B[u]):b.setValue(Jc.a.mt,360);b.setValue(Jc.a.M2e,h?-1:-2);Kt.a.zkc(1,b)}$Sl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}kTl(b){switch(b%
3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}wLh(b){if(this.B9)this.x9<nj.a.oZc&&this.Zq.h4(b),this.x9=this.lbi(this.gt,this.x9,nj.a.oZc);else{if(this.x9<nj.a.oZc&&(this.Zq.h4(b),this.gt&&this.oq)){b=this.gt.length;for(let h=0;h<b;h++)this.gt[h]>=this.x9&&(this.x9=this.gt[h])}this.x9+=1}return this.x9}nLh(b){this.uRa<nj.a.Rzd&&this.Zq.h4(b);return this.uRa=this.lbi(this.qua,this.uRa,nj.a.Rzd)}xLh(b){var h;this.Zq.h4(b);do b=Math.floor(Math.random()*
($o.M9m-$o.DNi))+$o.DNi;while(null===(h=this.Zq.DLb)||void 0===h?0:h.includes(b));return b}lbi(b,h,u){if(h<u&&b){u=b.length;for(let B=0;B<u;B++)b[B]>h&&(h=b[B])}h++;return h}h1n(b,h){this.V0h(b,h,1,this.Hie,this.Frj,null,!1)}g1n(b,h,u){this.wGl(b,h,u,this.Hie,this.Erj)}SGk(){this.i6()}i6(b=null){var h,u;if(uq.a.instance.J(1)){var B=new vd.GraphIterator;if(b)if(8===b.type)B.set(b);else{r.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else B.set(Fb.App.za.jb.Yc),
$o.ai.Fmg(B),b=$o.ai.ru(B.currentNode);if(B.zb(7)||B.ld(7)){B=Fa.a.zs(B,B.origin);var Q=new Sv({Fd:this.Zq,pageContentNode:b,BTa:null,cHj:!1});for(b=new Sv({Fd:this.Zq,pageContentNode:b,BTa:null,cHj:!1});B.moveNext();){var ca=B.iterator;let Qa;if(!Pm.a.getInstance().QB){if(!ca.Fs(4)&&!ca.Fs(31))continue;this.Fd.oLb(ca);Qa=ca.currentNode;ca.rc();if(!Qa){r.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.isValid);continue}}const rb=Lf.ListItemReader.$l?
Lf.ListItemReader.w4(ca)||Lf.ListItemReader.Jdi(ca):Qa;if(!this.B9&&!Lf.ListItemReader.MFf(rb)&&this.Fd.UX(rb).listType)continue;var qa=void 0;if(Lf.ListItemReader.$l){if(!rb){r.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}qa=Lf.ListItemReader.RX(rb)}else qa=this.Fd.fP(Qa,!1,!1);if(this.B9&&qa&&this.Fd.IZd(qa.listId)){r.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",qa.listId);continue}const Lb=Lf.ListItemReader.$l?
rb:Yc.OutlineElementReader.qU(ca);Lb&&(Lb.qa?(null==Lb.qa.last&&r.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.B9&&this.Zq.h4(ca.currentNode),12===Lb.type&&(Lb.Ji&&Lb.Oz.hasProperty(Jc.a.listID)||null===(h=Lb.qa.last)||void 0===h||!h.yi)&&((ca=Lf.ListItemReader.$l?Lf.ListItemReader.USd(rb)||Lf.ListItemReader.RX(rb):this.Fd.fP(Qa,!0,!0))?this.Jkj(Qa,rb,b,jm.vp.vpc,ca):r.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",
Qa.type)),!qa||null!==(u=Lb.qa.last)&&void 0!==u&&u.Kh||!this.Jkj(Qa,rb,Q,jm.vp.g2,qa)||(qa=Qa.getValue(jm.vp.g2),this.B9&&this.Fd.UX(rb).listType||Qa.setValue(jm.vp.bsa,qa))):r.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else r.ULS.shipAssertTag(593234060,376,7===B.Ue,"Couldnt reach to page manifest node")}}Jkj(b,h,u,B,Q){B||r.ULS.shipAssertTag(571757918,393,!!B,"Prop definition is null");u=u.kSf(Q.listId,Q.listLevel,this.od);Q=-1;b.hasProperty(B)&&
(Q=b.getValue(B));return u===Q||this.B9&&!Lf.ListItemReader.MFf(h)&&this.Fd.UX(h).listType&&(B!==jm.vp.vpc||1!==this.Fd.UX(h).listType)?!1:(b.setValue(B,u),!0)}eMm(b,h){let u=!1,B=!0,Q=0;const ca=this.DB(b),qa=b.currentNode;b=b.GSb();b=Fa.a.ap(b);for(b.wo(Sy.a.sZc,null);b.moveNext();){var Qa=b.iterator.currentNode;if(Qa===qa)break;Lf.ListItemReader.jg(Qa)&&(Qa=this.DB(b.iterator),Qa.listID===ca.listID&&(Qa.level>ca.level?(u=!0,Q++):Qa.level===ca.level?(B=!1,Q=0):Qa.level<=h.yTa&&(B=!0,Q=0)))}return u&&
B&&!0}kBh(b,h){this.Fd.BP(b);const u=b.currentNode;b.rc();const B=this.DB(b);B&&this.Zq.rZc(u,B.listID,B.level)&&this.g1n(b.currentNode,B,h)}oai(b){const h=this.Fd.tw(b);h.o8b=!0;this.Fd.BP(b);const u=b.currentNode.ja(Jc.a.listID,0);h.propertySet.setValue(Jc.a.listID,u);b.ld(11);return h}GIf(b,h,u){const B=new vd.GraphIterator,Q=h.currentNode;let ca;var qa=nj.a.qm;let Qa=!1,rb=!1,Lb=!1,Yb=null;var gc=h.GSb();gc=Fa.a.ap(gc);for(gc.wo(Sy.a.sZc,null);gc.moveNext();){B.jd(gc.iterator);if(B.currentNode===
Q)break;Qa=!1;B.Fs(4)&&(ca=this.DB(B),ca.listID===b.listID&&(ca.level===b.level?(this.Fd.BP(B),qa=B.currentNode,B.rc(),qa=qa.ja(jm.vp.g2,nj.a.qm),Qa=!0,Yb=B.noc(1),rb=!0):ca.level>b.level?Lb=!0:ca.level<=u.yTa&&(qa=nj.a.qm,Lb=rb=!1)))}!rb&&Lb&&(qa=u.startAt);Qa&&(Qa=h.noc(1)===Yb);b=new JA;b.gSa=qa;b.NIj=Qa;return b}c1n(b,h){var u=Lf.ListItemReader.w4(b);if($o.QQm)this.ZUo(u,h);else{b=this.aGb(u);const ca=this.Aoa(u,b),qa=this.Zq.l2a(u,b);var B=new vd.GraphIterator;const Qa=qa.Kz;let rb=ca.startAt,
Lb=!1,Yb=!1;r.ULS.shipAssertTag(22127639,338,qa.Joa,"Info does not have a level Text.");B.set(u);if(B.rd()&&(u=B.ATa()))for(u=Fa.a.ap(u),u.wo(Sy.a.sZc,b);u.moveNext();){B=u.iterator.currentNode;if(!Lf.ListItemReader.jg(B))continue;var Q=this.DB(u.iterator);Q.listID===h&&(Q=this.Rkj(u.iterator,b.listID));if(Q.listID!==b.listID)continue;const gc=u.iterator.Ub(4);gc&&u.iterator.rc();Q.level>b.level?(this.Zq.rZc(gc,b.listID,Q.level)&&this.Rsi(B,gc),Yb=!0):(Q.level<=ca.yTa?(rb=ca.startAt,Yb=Lb=!1):(Q=
u.iterator,this.Fd.BP(Q),jm.vp.Nv||Q.currentNode.setValue(Jc.a.nv,qa.JJf),{G$n:Lb,gSa:rb}=this.f1n(Qa,Yb,Lb,Q,rb,B)),$o.UDm(u))}}}ZUo(b,h){const u=this.aGb(b),B=new vd.GraphIterator;B.set(b);if(B.rd()&&(b=B.ATa())){b=Fa.a.ap(b);for(b.wo(Sy.a.sZc,u);b.moveNext();)Lf.ListItemReader.jg(b.iterator.currentNode)&&this.DB(b.iterator).listID===h&&this.Rkj(b.iterator,u.listID);r.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Rsi(b,h){r.ULS.shipAssertTag(22819227,338,!!b&&
!!h);h.setValue(Ke.a.MFi,W.a.create().toString())}f1n(b,h,u,B,Q,ca){b?(h&&!u&&Q++,gf.OutlineElementNavigator.Wd(B),this.kBh(B,Q),Q++,u=!0,B.Ub(2),Iz.a.NEf(B.currentNode)&&B.currentNode.gl(4,!0)):(B.currentNode.removeProperty(jm.vp.g2),gf.OutlineElementNavigator.Wd(B));ca.gl(4,!0);(b=B.fo(16))&&b.gl(8,!0);return{G$n:u,gSa:Q}}Aoa(b,h){const u=Wh.a.instance.Ap(Ob.a.Aoa),B=new Su;(b=this.Zq.Lx(b,h.listID,h.level))?(B.yTa=b.ja(Jc.a.P6c,h.level-1),B.startAt=b.ja(Xe.a.O0,1)):Wh.a.instance.Yb("PossiblyIncorrectListRestartValue",
{["Reason"]:"listPropsIsNull"});u.end();return B}zcl(b){const h=Sr.a.instance.createInstance(1074135151);b.xf(h,31)}ZYn(b){b.Ub(31)&&b.vg()}EKo(b,h,u,B,Q){const ca=this.qge(h,b,!0);h=this.Zq.l2a(h.currentNode,b);h.listType||(ca.setValue(jm.vp.g2,b.Ou),ca.setValue(jm.vp.bsa,b.ILc),this.Yaj(ca,b,u?B:Q));switch(h.listType){case 0:u="Numbering";break;case 1:u="Bullet";break;default:u="Invalid List Type"}v.AFrameworkApplication.va.processAction(Ob.a.THf,2);r.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",
u);Pm.a.getInstance().QB||this.cE.mge(ca,b.listID,b.level)}H9i(b){var h=this.uc.Ro(b);h?this.uc.wg(h)===Yj.StyleReader.wordStyleIdListParagraph&&(h=this.uc.ZC(b),this.T5.YJ(h.jj(Yj.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.LQb)):r.ULS.shipAssertTag(8271188,315,!1)}gio(b){if(this.uc.wg(this.uc.Ro(b))===Yj.StyleReader.wordStyleIdNormal){const h=this.uc.ZC(b);this.T5.YJ(h.jj(Yj.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.zg(Jc.a.$d,Jc.a.gN,Jc.a.QA,Jc.a.f1,Jc.a.mt,Jc.a.Yia);
b.setValue(Jc.a.BSa,0)}$Sk(b,h){const u=b.getValue(Jc.a.listID),B=b.getValue(Jc.a.listLevel);for(let ca=0;9>ca;ca++){const qa=this.Zq.Lx(b,u,ca);if(!qa)return Wh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var Q=h.yKb[ca];Q=6===Q?gu.a.V_(1,1):gu.a.V_(0,Q);Q.via&&qa.setValue(Xe.a.a5,Q.via);qa.hasProperty(Xe.a.font)&&qa.removeProperty(Xe.a.font);h.LEa&&h.LEa[ca]&&qa.setValue(Xe.a.font,h.LEa[ca]);Q=h.aZc[ca];r.ULS.shipAssertTag(22127641,338,!!Q);qa.setValue(Jc.a.nv,
Q);qa.setValue(Jc.a.Zr,Kt.a.zfc);Kt.a.che(h.e6,qa);qa.setValue(Jc.a.gda,h.V0d[ca]);qa.zg(Jc.a.P6c,Xe.a.O0);this.XEj(b)}b=new ky.a;b.listID=u;b.level=B;return b}YSk(b,h,u,B){if(B)return this.$Sk(b,B);B=b.getValue(Jc.a.listID);const Q=b.getValue(Jc.a.listLevel),ca=this.Zq.Lx(b,B,Q);if(!ca)return Wh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&r.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,
h.listType,B,Q),null;h.o8b&&(ca instanceof Mu.APropertySet?ca.rOa(h.propertySet,Jc.a.listID,Jc.a.listLevel):r.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ca||void 0===ca?void 0:ca.constructor.name));var qa=ca.ja(Jc.a.Zr,null);qa&&qa===Kt.a.zfc&&this.XSk(b,B);if(!h.listStyle){qa=0;if(-1!==u){for(qa+=Q-u;0>qa;)qa+=3;qa%=3}switch(qa){default:u=1;break;case 1:u=2;break;case 2:u=3}h.w$(h.listType,u)}h.via&&ca.setValue(Xe.a.a5,h.via);
h.Kz?(this.Hkj(h,ca,Q),ca.hasProperty(Xe.a.font)&&ca.removeProperty(Xe.a.font)):($o.Ekj(h,ca),$o.Gkj(h,ca));$o.Fkj(h,ca);ca.zg(Jc.a.P6c,Xe.a.O0,Jc.a.QWc);this.XEj(b);b=new ky.a;b.listID=B;b.level=Q;return b}XSk(b,h){let u;for(let B=0;9>B;B++){u=this.Zq.Lx(b,h,B);if(!u){r.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,B);break}u.setValue(Jc.a.Zr,Kt.a.XVd);u.removeProperty(Sh.a.Ylb)}}pge(b,h){const u=Wh.a.instance.Ap(Ob.a.pge);this.Vmd.value||Wh.a.instance.Yb("PossibleIncorrectListIndentation",
{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.uMa?(u.properties.Z("PendingListInfo","true"),Lf.ListItemReader.jg(b)&&(u.properties.Z("RemoveCurrentListInfo","true"),this.LQb=!0,this.QHa(b),this.Vmd.value.MSa(b,-1,0),this.LQb=!1),16!==this.uMa.listType&&this.WFc(b,this.uMa,{Hpi:!0,eIl:!0}),this.uMa=null):h||(u.properties.Z("CurrentlyUnderPastedList","true"),this.QHa(b,{y9i:!0}));u.end()}mhe(b,h){var u;if(Lf.ListItemReader.jg(b))return!1;b.Ub(2);var B=bo.a.sHk;const Q=[!0,!1].map(ca=>
me.ParagraphReader.$f(b.currentNode,ca,void 0,!1));b.rc();for(let ca=0;ca<Q.length;ca++){const qa=Q[ca];if(qa&&!jy.a.mpa(qa))for(const Qa of B)if(Qa.test(qa.characterData))return B=null===(u=Qa.exec(qa.characterData))||void 0===u?void 0:u[0],this.bQn(h,ca?"nextPara":"prevPara",B),!1}return!0}bQn(b,h,u){const B=new Map;B.set("CurrentAutoListPreventedAutoListText",b);B.set("UndoAutoListPreferenceFoundIn",h);B.set("UndoAutoListPreferenceAutoListText",u);xa.Health.instance.recordKpiUsage(nj.a.xlb.zWn,
0,nj.a.xB,B)}kso(b,h){return b&&h}I9i(b){for(let h=0;h<b.count;h++){const u=vd.GraphIterator.eb(b.J(h));u.gp();this.Lda(u)}b.clear()}e1n(b){Lf.ListItemReader.jg(b)&&this.i6()}Y5i(b,h){b=new vd.GraphIterator;b.set(h);b.rd();gf.OutlineElementNavigator.Wd(b);b.qjb(h)||Wh.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.QHa(b);return b}Mho(b,h,u){this.mh.qza(b,h,u,!0)}Uho(b){b.w$(1,1)}qCd(b,h){const u=Wh.a.instance.Ap(Ob.a.qDk);if(this.uc.$ca(h.xl())){if(Lf.ListItemReader.jg(b)&&
this.QHa(b),h=this.Zq.vai(h)){u.properties.Z("EarlyReturn","False");this.Zq.l2a(b.currentNode,h);var B=fq.fCl(this,b,h);if(B)B=this.Ikj(b,B,!0);else{B=this.cLh(b);var Q=this.xOd(b,h,this.$uj,this.xCo);if(Q){const ca=this.DB(Q);if(ca.listID===h.listID&&ca.level<h.level&&this.Fd.tw(Q).Kz){const qa=this.Aoa(Q.currentNode,ca);ca.Ou===(qa.startAt===nj.a.qm?1:qa.startAt)&&(ca.ILc=ca.Ou,this.Yaj(B,ca,Q.currentNode))}}Q=this.Aoa(B,h);b=this.GIf(h,b,Q);b=b.gSa!==nj.a.qm?b.gSa+1:Q.startAt===nj.a.qm?1:Q.startAt;
Pm.a.getInstance().QB||this.XFc(B,h,null,!0);B.setValue(jm.vp.g2,b);B.setValue(jm.vp.bsa,b)}Pm.a.getInstance().QB||B.setValue(Jc.a.M0,!0);u.end()}}else Wh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}Yaj(b,h,u){this.Zq.rZc(b,h.listID,h.level)&&this.h1n(u,h)}CDk(b,h,u){if(!Lf.ListItemReader.jg(h)&&(r.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),Lf.ListItemReader.$l))return;const B=h.Ub(4);h.rc();(h=Yc.OutlineElementReader.qU(h))||
Pc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.vLh(b,u,0,null);this.XFc(B,b,h);return b}vLh(b,h,u,B=null){b=B?this.zal(b,h,u,B):this.xal(b,h,u);jm.vp.Nv||(h.Joa?(h=h.levelText,B||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(r.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}pog(b,h,u,B=null){if(Lf.ListItemReader.jg(b)){var Q=b.Ub(4);b.rc();var ca=Yc.OutlineElementReader.qU(b);
this.A6b(ca,()=>{this.XFc(Q,h.Aw,ca,u);this.tSh(Q,h,u,B)})}else r.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}Ikj(b,h,u,B=null){const Q=Yc.OutlineElementReader.qU(b);return this.A6b(Q,()=>{const ca=this.qge(b,h.Aw,u);this.tSh(ca,h,u,B);return ca})}tSh(b,h,u,B=null){if(this.Zq.l2a(b,h.Aw).Kz){const Q=new vd.GraphIterator;Q.set(b);Q.rd();Q.rc();const ca=this.zEl(Q,h,B);b=this.qEl(Q,b,h,u,B,ca);this.wEl(h,u,B,ca,b)}}zEl(b,h,u){if(h.Uxi)h=h.HP;else{let B,
Q;u?(B=this.avj,Q=this.Lje):h.rbc?(B=this.$uj,Q=this.Lje):(B=this.wCo,Q=this.yCo);h=this.xOd(b,h.Aw,B,Q,u)}!h&&u&&(u=new vd.GraphIterator,u.jd(b),u.CRc()&&Lf.ListItemReader.jg(u)&&(h=u));return h}qEl(b,h,u,B,Q,ca){B?(Q?b=Q.Olc:(ca=this.Aoa(h,u.Aw),u=this.GIf(u.Aw,b,ca),b=u.gSa!==nj.a.qm?u.gSa+1:ca.startAt===nj.a.qm?1:ca.startAt),h.setValue(jm.vp.g2,b),h.setValue(jm.vp.bsa,b)):(b=nj.a.qm,this.Nio(h,ca,u));return b}wEl(b,h,u,B,Q){if(B){var ca=!1,qa=this.DB(B),Qa=qa.level===b.Aw.level,rb=!!u&&qa.listID===
u.a2c;(qa.listID===b.Aw.listID||rb)&&Qa&&(Qa=this.Aoa(B.currentNode,qa),rb=Qa.startAt===nj.a.qm?1:Qa.startAt,qa.Ou===rb+1&&(ca=h?Q===rb:this.eMm(B,Qa)));if(!ca||u)u?(h=u.delta,Q=this.mwo,ca=this.nwo):(h=1,Q=this.Hie,ca=this.Frj),qa=new vd.GraphIterator,qa.set(B.currentNode),qa.rd(),this.Fd.BP(qa),qa.rc(),this.V0h(B.currentNode,b.Aw,h,Q,ca,u)}}Nio(b,h,u){let B=null;h&&(B=this.DB(h));if(B&&B.listID===u.Aw.listID&&B.level===u.Aw.level){const Q=this.Fd.tw(h),ca=Q.Ou;b.setValue(jm.vp.g2,ca);b.setValue(jm.vp.bsa,
ca);Q.propertySet.setValue(Jc.a.listID,B.listID);Q.propertySet.setValue(Jc.a.listLevel,B.level);if(!u.rbc||u.g5d)u.Uxi&&!u.g5d&&(this.Fd.BP(h),b=h.currentNode,gf.OutlineElementNavigator.Wd(h)),b.setValue(jm.vp.bsa,b.getValue(jm.vp.g2))}else h=u.Aw.Ou+1,b.setValue(jm.vp.g2,h),b.setValue(jm.vp.bsa,h)}WFc(b,h,{Hpi:u=!1,qZm:B=-1,FGl:Q=!1,eIl:ca=!1}={}){return h&&16!==h.listType?vd.GraphIterator.$ba(()=>{if(!Yc.OutlineElementReader.Bh(b))return r.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),
Xr.Mfc();const qa=Yc.OutlineElementReader.qU(b);return qa&&Hq.a(qa,8)?(r.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Xr.Mfc()):uq.a.instance.J(1)&&(null===qa||void 0===qa?0:qa.qa.last.Kh)?(r.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),Xr.Mfc()):this.A6b(qa,()=>{var Qa=$o.ai.ru(b.currentNode);const rb=h.VB,Lb=this.infoAtLevel(b,h);var Yb=b.Ub(4);if(Yb)return b.rc(),Qa=this.cth(Lb,Yb,B,rb),Qa.Aw=this.DB(b),Qa;this.ZYn(b);
Yb=h.propertySet.ja(Jc.a.listID,-1);const gc=this.S0l(Yb,ca),Fc=this.JZl(qa),Sc=this.H_l(h,b,Lb,ca,Q,u);this.rgo(Sc,Lb);qa&&this.gio(qa);return null==Sc||Q||Lb.Kz!==this.Fd.l2a(b.currentNode,Sc.Aw).Kz?this.nql(Lb,gc,Sc,b.currentNode)?this.sDk(b,Lb,gc,Fc,rb):this.rDk(b,Lb,Qa,Fc,rb,gc,Yb):(Lb.listStyle||(Sc.rbc=!0),this.tDk(gc,Sc,b))})}):(h||r.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.QHa(b))}sDk(b,h,u,B,Q){u=this.u1l(h,u,B);b=this.qge(b,u);return this.cth(h,
b,-1,Q)}H_l(b,h,u,B,Q,ca){var qa;Q=b.Pmb?new fq(this,vd.GraphIterator.eb(b.Pmb),!1,!0):fq.eCl(this,h,u,B,Q);if(!Q)return null;ca?(Q.Aw.level=this.VZl(h,u,B),this.cEl(h,Q)):Q.Aw&&(null===(qa=b.propertySet)||void 0===qa?0:qa.hasProperty(Jc.a.listLevel))&&(Q.Aw.level=b.propertySet.getValue(Jc.a.listLevel));return Q}S0l(b,h){return h&&0<b&&b+""in this.RZf?this.RZf[b+""]:-1}u1l(b,h,u){var B,Q;const ca=new ky.a;ca.listID=h;ca.level=null!==(Q=null===(B=b.propertySet)||void 0===B?void 0:B.rf(Jc.a.listLevel))&&
void 0!==Q?Q:this.ZYc(u);b.propertySet&&b.Joa&&!jm.vp.Nv&&(ca.levelText=b.levelText.replace("%1","%"+(ca.level+1)));return ca}cth(b,h,u,B){b=this.YSk(h,b,u,B);return Xr.LZm(b)}tDk(b,h,u){let B=null;0<b&&(B=new ux(0,h.Aw,-1),B.a2c=b,B.delta=-1);this.Ikj(u,h,!1,B);return Xr.c_m(h.Aw)}rDk(b,h,u,B,Q,ca,qa){const Qa=Yc.OutlineElementReader.t4(b);0<Qa&&(B+=Qa);u=this.vLh(u,h,B,Q);this.YUo(ca,qa,u);b=this.qge(b,u);jm.vp.QB||h.listType||(h=h.dC,h===nj.a.qm&&(h=1),b.setValue(jm.vp.g2,h),b.setValue(jm.vp.bsa,
h));return Xr.OZm(u)}QHa(b,{y9i:h=!1}={}){return vd.GraphIterator.$ba(()=>{if(!Yc.OutlineElementReader.Bh(b))return r.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),Xr.Mfc();const u=Yc.OutlineElementReader.qU(b);if(uq.a.instance.J(1)&&(null===u||void 0===u?0:u.qa.last.Kh))return r.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),Xr.Mfc();const B=b.Ub(4);return B?u?this.A6b(u,()=>{var Q;this.H9i(u);this.iYn(u);u.bJ=
null;this.Fd.IZd(Lf.ListItemReader.$l?Lf.ListItemReader.RX(u,{BOa:0}).listId:B.ja(Jc.a.listID,0))?(B.M9c=!1,b.vg(),Pm.a.getInstance().Nv&&this.cE.Lda(u)):b.rc();h||this.hfo(b);b.Ub(4)&&(B.M9c=!1,b.vg(),Pm.a.getInstance().Nv&&this.cE.Lda(u));(this.Ud.tg&&!this.LQb||!this.Ud.tg&&u.Ji)&&(!u.Ji||(null===(Q=u.Oz)||void 0===Q?0:Q.hasProperty(Jc.a.listID)))&&this.zcl(b);return Xr.SFi()}):(r.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),B.M9c=!1,b.vg(),
Xr.SFi()):Xr.Mfc()})}hfo(b){const h=$o.ai.ru(b.currentNode),u=Yc.OutlineElementReader.cFa(b),B=Yc.OutlineElementReader.DG(b),Q=Yc.OutlineElementReader.t4(b);this.RLd(h);this.mh.qza(b,1,Math.max(0,u+(Q||-1*B)-this.Wsc[0]))}A6b(b,h){let u=null;uq.a.instance.J(1)&&b&&(u=b.VD());h=h();uq.a.instance.J(1)&&!this.LQb&&(b&&u&&this.wq.sV(b,u,this.Ud.tg),this.i6());return h}iYn(b){b.hasProperty(Jc.a.$d)&&b.removeProperty(Jc.a.$d);b.hasProperty(Jc.a.QA)&&b.removeProperty(Jc.a.QA);b.hasProperty(Jc.a.mt)&&b.removeProperty(Jc.a.mt)}infoAtLevel(b,
h){if(!h)return null;const u=h.VB;if(1===h.Zr){if(h.Cpa&&!h.KJ||!h.I6e(!1))return h;b=Yc.OutlineElementReader.cFa(b);const B=this.ZYc(b),Q=u.yKb[B];b=gu.a.p8(h.propertySet,h.propertySet);6===Q?b.w$(1,1):b.w$(0,Q);b.rge("multilevel");b.levelText=u.aZc[B];u.LEa&&u.LEa[B]&&(b.font=u.LEa[B]);b.ww=u.V0d[B];b.e6=u.e6;b.M1d=h.M1d}else b=h;return b}rgo(b,h){null!==b&&void 0!==b&&b.Aw&&(h.levelText=b.Aw.levelText,h.Kz||(h.font=b.Aw.font))}VZl(b,h,u){let B=Yc.OutlineElementReader.cFa(b);const Q=Yc.OutlineElementReader.t4(b);
0<Q?B+=Q:(b=Yc.OutlineElementReader.DG(b),0<b&&(B-=b));h=h.propertySet.ja(Jc.a.listLevel,-1);return u&&0<=h?h:this.ZYc(B)}cEl(b,h){if(!this.Zq.l2a(b.currentNode,h.Aw).listType){const u=this.Aoa(b.currentNode,h.Aw);b=this.GIf(h.Aw,b,u);h.Aw.ILc=h.Aw.Ou=b.gSa===nj.a.qm?u.startAt-1:b.gSa;h.rbc=b.NIj}}YUo(b,h,u){0>=b?this.RZf[h+""]=u.listID:u.listID=b}nql(b,h,u,B){if(0>=h)return!1;const Q=(ca,qa)=>ca.length!==qa.length||ca.some((Qa,rb)=>Qa!==qa[rb]);if(u)return h=this.Fd.l2a(B,u.Aw),b.Kz!==h.Kz||Q(b.via,
h.via);u=b.propertySet.ja(Jc.a.listLevel,-1);return 0<=u&&(h=this.Zq.Lx(B,h,u))&&(h=h.ja(Xe.a.a5,null))&&b.via?Q(h,b.via):!1}hYn(b,h){var u,B;const Q=!!h&&me.ParagraphReader.Wb(h);let ca=0,qa=0;Q&&(ca=this.Zo.nU(Lf.ListItemReader.$l?h:this.Fd.Tqf(b)).Ut,qa=this.Zo.DG(h).Ut);Q&&this.H9i(h);null!==(u=Pm.a.getInstance())&&void 0!==u&&u.QB||(b.Ub(4),b.vg());(null===(B=Pm.a.getInstance())||void 0===B?0:B.Nv)&&this.cE.Lda(h);Q&&this.mh.qza(b,1,ca-qa)}Nba(b,h,u,B=-1,Q=!1,ca=null,qa=!1){r.ULS.sendTraceTag(17622211,
324,50,"'Continue Existing List' is selected from Context Menu.");const Qa=Wh.a.instance.Ap(Ob.a.Nba),rb=this.Kc.Pc(15);rb.Qt(b);let Lb=null,Yb=0;({jWm:Lb,Dgn:Yb,returnValue:B}=this.FCl(b,h,B,Lb,Yb,Q,ca));if(!Lb||qa&&(1===u||0>u-Lb.Aw.Ou||2<u-Lb.Aw.Ou))return rb.dispose(),Qa.end(),!1;for(;0<Yb;)b.CRc(),Yb--;this.UUo(b,h,B,Lb);rb.dispose();Qa.end();return!0}UUo(b,h,u,B){for(;b.CRc();){var Q=Lf.ListItemReader.w4(b);if(Q&&(Q=this.aGb(Q),Q.listID===h.listID)){h=new ux(0,h,u);Pm.a.getInstance().Nv?this.pog(b,
B,Q.M0,h):this.pog(b,B,!0,h);break}}}FCl(b,h,u,B,Q,ca=!1,qa=null){for(var Qa;b.xUd();){if(b.Fs(4)){const rb=this.DB(b),Lb=this.Fd.tw(b);if(Lb.listType!==qa.listType){Q++;continue}if(ca&&Lb.listStyle!==qa.listStyle||!ca&&h.level<rb.level){Q++;continue}-1===u&&(u=rb.Ou+1);B=null;if(h.level===rb.level||ca)null===(Qa=this.o$c)||void 0===Qa?void 0:Qa.Rzf(b),B=new fq(this,b,!1,!1);ca&&rb.level!==h.level&&b.Fs(4)&&(b.Ub(4).setValue(Jc.a.listLevel,rb.level),b.rc());break}Q++}return{returnValue:u,jWm:B,Dgn:Q}}t1l(b){b=
Lf.ListItemReader.w4(b);return this.RRd(b)}RRd(b){let h;uq.a.instance.J(1)&&(h=Lf.ListItemReader.$l?Lf.ListItemReader.RX(b)||Lf.ListItemReader.USd(b):this.Fd.fP(b,!1,!0));return this.Fd.Lx(b,h.listId,h.listLevel)}startNewList(b,h,u){r.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var B=Wh.a.instance.Ap(Ob.a.startNewList),Q=this.Kc.Pc(15);Q.Qt(b);var ca=gu.a.V_(0,h.listStyle,null,0,h.propertySet.ja(Jc.a.listLevel,-1));if(Lf.ListItemReader.$l)({listId:qa,
listLevel:Qa}=Lf.ListItemReader.YFb(b,{BOa:0,W5b:-1}));else{b.Ub(4);var qa=b.currentNode.ja(Jc.a.listID,0);var Qa=b.currentNode.ja(Jc.a.listLevel,-1);b.rc()}ca.M1d=qa;var rb=h.propertySet.ja(Jc.a.$d,0);0<rb&&ca.propertySet.setValue(Jc.a.$d,rb);-1===ca.propertySet.ja(Jc.a.listLevel,-1)&&ca.propertySet.setValue(Jc.a.listLevel,Qa);1===h.Zr&&((Qa=new Vs.a,qa=h.mii(b.currentNode,qa),qa)?1===qa&&(ca.rge(Kt.a.zfc),ca.VB=Qa.Caf(Qa.fTf,Qa.gTf),ca.e6=ca.VB.e6):(ca.rge(Kt.a.zfc),ca.VB=Qa.L$e(),ca.e6=ca.VB.e6));
h.uoa()&&1>u&&(u=1);ca.dC=u;qa=new Od.DictionaryPropertySet;qa=this.EMc(Ob.a.JL,qa);Qa=Yc.OutlineElementReader.qU(b);h=this.DB(b);if(rb=this.t1l(b))ca.levelText=rb.ja(Jc.a.nv,""),ca.KJ=42,ca.ww=rb.ja(Jc.a.gda,"left");this.hYn(b,Qa);({gxa:ca}=this.Gma(qa,b,ca,!0));b.Ub(4);22!==b.currentNode.type&&63!==b.currentNode.type&&r.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);Pm.a.getInstance().QB||this.cE.oSb(b.currentNode,h.level);Pm.a.getInstance().Nv&&this.cE.oSb(Qa,
h.level);b.rc();ca=new fq(this,b,!1,!1);u=new ux(1,h,u);this.pog(b,ca,!!Pm.a.getInstance().Nv,u);Q.dispose();B.end()}else r.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}wFf(b){if(!b)return!1;const h=b.Ub(2);h&&b.rc();return uq.a.instance.J(1)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.Kh?!0:!1}N9d(b,h,u,B){return this.g9j.N9d(b,h,u,B)}w$f(b,h){if(!b||!h)return!1;const u=b.propertySet.ja(Jc.a.nv,null);h=h.propertySet.ja(Jc.a.nv,null);if(!u||!h)return!1;const B=b.propertySet.ja(Xe.a.font,
null);b=b.propertySet.ja(Xe.a.font,null);return u===h&&B===b}qlj(b,h,u){u||h.listType||(h.dC=b.ja(Xe.a.O0,nj.a.qm))}mai(b,h){if(!h)return null;const u=Array(9),B=h.M1d;if(!this.ANm(h,b)||1>B)return null;for(h=0;9>h;h++){const Q=this.Fd.Lx(b,B,h);if(null===Q||void 0===Q?0:Q.hasProperty(Jc.a.$d))u[h]=Q.getValue(Jc.a.$d);else return null}return u}ANm(b,h){if(!b)return!1;const u=b.propertySet.ja(Jc.a.listLevel,-1);b=b.propertySet.ja(Jc.a.$d,-1);if(0>u||0>b)return!1;this.RLd(h);return b!==this.zVb[u]}Nnh(b,
h,u){b&&b.setValue(Jc.a.$d,h?h[u]:this.zVb&&u<this.zVb.length?this.zVb[u]:720*(u+1))}V0h(b,h,u,B,Q,ca=null,qa=!1){const Qa=new vd.GraphIterator,rb=this.Aoa(b,h);Qa.set(b);Qa.rd();b=bq.a.zs(Qa,Qa.GSb());b.wo(Sy.a.sZc,null);let Lb=-1;for(;b.moveNext();){if(!Lf.ListItemReader.jg(Qa))continue;const Yb=this.DB(Qa),gc=Yc.OutlineElementReader.qU(Qa);this.Fd.BP(Qa);const Fc=Qa.currentNode;Qa.rc();if(B!==this.Hie||Yb.listID===h.listID){if(qa){if(-1!==Lb&&Lb>Yb.level)break;if(-1===Lb)Lb=Yb.level;else if(Yb.level!==
Lb)continue}else{if(Yb.level<=rb.yTa)break;if(!B(h,Yb,ca))continue}Q(Fc,gc,u,h.listID,ca)}}}wGl(b,h,u,B,Q){const ca=new vd.GraphIterator,qa=this.Aoa(b,h);ca.set(b);ca.rd();if(Lf.ListItemReader.jg(ca)){b=this.DB(ca);var Qa=Yc.OutlineElementReader.qU(ca);this.Fd.BP(ca);var rb=ca.currentNode;ca.rc();b.level<=qa.yTa||B(h,b,null)&&Q(rb,Qa,u,h.listID,null)}}vGl(b,h,u,B,Q=null){const ca=new vd.GraphIterator;ca.jd(b);B(b,h,this.DB(ca),ca,0);this.xOd(b,h,u,B,Q)}xOd(b,h,u,B,Q=null){let ca=new vd.GraphIterator;
const qa=this.Aoa(b.currentNode,h);let Qa=null,rb=0;var Lb=new vd.GraphIterator;Lb.jd(b);Lb.zb(10);const Yb=Fa.a.zs(Lb,Lb.origin);for(Yb.moveNext();Yb.moveNext();)if(Qa=null,ca=Yb.iterator,1===ca.role&&(Qa=Yb.currentNode,ca.Fs(4)&&(Lb=this.DB(ca),u(h,Lb,Q))))if(Lb.level>h.level)B(b,h,Lb,ca,rb),rb++;else if(Lb.level===h.level||Lb.level<=qa.yTa)break;return Qa?ca:null}C5i(b,h,u,B,Q){b=this.Aoa(b.currentNode,u);b.yTa>=h.level&&this.kBh(B,b.startAt+Q)}static get QQm(){null==$o.eud&&(v.AFrameworkApplication.K?
(v.AFrameworkApplication.le("i75ig452;a229j208"),$o.eud=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):$o.eud=!1);return $o.eud}static get ai(){return Zo.PageNavigator.instance}static Ekj(b,h){h.setValue(Xe.a.font,b.Cpa||b.UUc||b.jSc?b.font:"Symbol")}static Gkj(b,h){b=b.Cpa||b.UUc||b.Joa?b.levelText:nj.a.sJd;r.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Jc.a.nv,b)}static Fkj(b,h){b=b.propertySet.ja(Jc.a.gda,"left");h.setValue(Jc.a.gda,
b)}static UDm(b){b=b.iterator.parentNode;const h=vd.GraphIterator.eb(b);b&&Yc.OutlineElementReader.sFf(h,null)&&b.gl(8,!0)}}$o.M9m=2147450879;$o.DNi=1;$o.eud=null;Object(m.a)($o,"FlatListEditorCssVersion",jm,[490,491]);class Jz{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){this.Zq=b;this.Jvn=h;this.Yf=u;this.Zs=B;this.RA=Q;this.HZm=ca;this.Pd=qa;this.Bj=Qa;this.VZm=rb;this.Zb=Lb;this.uc=Yb;this.qE=gc;this.cE=Fc}create(){return new $o(this.Zq,this.Jvn,this.Yf,this.Zs,this.RA,this.HZm,this.Pd,this.Bj,
this.VZm,this.Zb,this.uc,this.qE,this.cE)}}Object(m.a)(Jz,"FlatListEditorFactory",null,[]);class Kz{constructor(){this.startAt=this.listLevel=this.listId=0;this.Pmb=null}}Object(m.a)(Kz,"ListAutoCorrectionRefInfo",null,[]);class KA{constructor(b,h){this.F8j=b;this.Ef=h}N9d(b,h,u,B){if(!b.hasProperty($c.a.P4a))return!0;h=vd.GraphIterator.eb(h.currentNode);Ge.SelectionEditor.yu(h);let Q=!0;if(!u.listType&&!B){23===h.Ue&&h.zJ(1);B=b.ja($c.a.P4a,1);if(1<B){var ca=new vd.GraphIterator;ca.jd(h);ca.zb(10);
ca=Fa.a.ap(ca.origin);B=this.ECl(ca,B,u,h.currentNode);u.Pmb||(Q=!1)}b.setValue($c.a.P4a,B)}return Q}ECl(b,h,u,B){const Q=new zb.a;for(;b.moveNext()&&b.iterator.currentNode!==B;){const ca=b.iterator;if(!ca.Fs(4))continue;const qa=this.F8j.value.DB(ca),Qa=this.Ef.tw(ca);this.IIn(Q,qa);Qa.listType===u.listType&&Qa.listStyle===u.listStyle&&(0>h-qa.Ou||2<h-qa.Ou||Q.add(Object.assign(new Kz,{listId:qa.listID,listLevel:qa.level,Pmb:ca.currentNode,startAt:qa.Ou+1})))}0<Q.count&&(h=Q.J(Q.count-1).startAt,
u.Pmb=Q.J(Q.count-1).Pmb);return h}IIn(b,h){let u=0;for(;u<b.count;){const B=b.J(u);B.listId===h.listID&&B.listLevel>=h.level?b.removeAt(u):u++}}}Object(m.a)(KA,"ListAutoCorrector",null,[463]);class LA{constructor(b,h,u,B,Q){this.Z7a=(ca,qa,Qa)=>{var rb;ca=Lf.ListItemReader.$l?Lf.ListItemReader.GPc(qa):this.SJc(qa);if(!ca||this.Xs.wFf(ca))return 8;qa=this.Xs.DB(ca);if(1===qa.Ou||this.gWc(qa.level))return 8;qa=null===(rb=this.Fd)||void 0===rb?void 0:rb.tw(ca);if(!qa||this.hyi(qa))return 8;if(1===Qa)return 32;
this.Xs.startNewList(ca,qa,1);return 32};this.Y7a=(ca,qa,Qa)=>{ca=Lf.ListItemReader.$l?Lf.ListItemReader.GPc(qa):this.SJc(qa);if(!ca||this.Xs.wFf(ca))return 8;qa=this.Xs.DB(ca);if(this.gWc(qa.level))return 8;const rb=this.Fd.tw(ca);if(!rb||this.hyi(rb))return 8;if(1===Qa)return 32;this.aLc.H3l(ca.currentNode,qa.Ou,this.Fd,this.Xs,this.KUa);return 32};this.Nba=(ca,qa,Qa)=>{ca=Lf.ListItemReader.$l?Lf.ListItemReader.GPc(qa):this.SJc(qa);if(!ca||this.Xs.wFf(ca))return 8;qa=this.Xs.DB(ca);if(1!==qa.Ou||
this.gWc(qa.level))return 8;if(1===Qa)return 32;Qa=this.Fd.tw(ca);return this.Xs.Nba(ca,qa,Qa.dC,-1,!1,Qa)?32:8};this.hqb=(ca,qa,Qa,rb,Lb)=>{ca=Lf.ListItemReader.$l?Lf.ListItemReader.GPc(qa):this.SJc(qa);if(!ca)return 8;qa=this.Xs.DB(ca);if(this.gWc(qa.level))return 8;if(1===Qa)return 32;Qa=this.Fd.tw(ca);this.Xs.startNewList(ca,Qa,Lb);return 32};this.Zfb=(ca,qa,Qa,rb,Lb)=>{ca=Lf.ListItemReader.$l?Lf.ListItemReader.GPc(qa):this.SJc(qa);if(!ca)return 8;qa=this.Xs.DB(ca);return this.gWc(qa.level)?8:
1===Qa?32:this.Xs.Nba(ca,qa,qa.Ou,Lb)?32:8};this.nc=b;this.Fd=u;this.Xs=B;this.aLc=Q}gWc(b){return 0>b}Tb(){this.nc.ra(Ob.a.Z7a,vc.a.HP,this.Z7a);this.nc.ra(Ob.a.Z7a,vc.a.Tc,this.Z7a);this.nc.ra(Ob.a.Z7a,vc.a.view,this.Z7a);this.nc.Xc(Ob.a.Z7a,12);this.nc.ra(Ob.a.Y7a,vc.a.HP,this.Y7a);this.nc.ra(Ob.a.Y7a,vc.a.Tc,this.Y7a);this.nc.ra(Ob.a.Y7a,vc.a.view,this.Y7a);this.nc.Xc(Ob.a.Y7a,12);this.nc.ra(Ob.a.Nba,vc.a.HP,this.Nba);this.nc.ra(Ob.a.Nba,vc.a.Tc,this.Nba);this.nc.ra(Ob.a.Nba,vc.a.view,this.Nba);
this.nc.Xc(Ob.a.Nba,12);this.nc.ra(Ob.a.hqb,vc.a.HP,this.hqb);this.nc.ra(Ob.a.hqb,vc.a.Tc,this.hqb);this.nc.ra(Ob.a.hqb,vc.a.view,this.hqb);this.nc.Xc(Ob.a.hqb,12);this.nc.ra(Ob.a.Zfb,vc.a.HP,this.Zfb);this.nc.ra(Ob.a.Zfb,vc.a.Tc,this.Zfb);this.nc.ra(Ob.a.Zfb,vc.a.view,this.Zfb);this.nc.Xc(Ob.a.Zfb,12)}get KUa(){return Ga.a.instance.resolve("Common.IStandaloneRootController").eea}SJc(b){return this.Xs.Z0l(b)}hyi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(m.a)(LA,"ListContextMenuSectionActor",
null,[]);var bm=c(598);class Ds{static get TZm(){return Hf.a.Bz(Ds.Sm,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}Ds.Sm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(Ds,"ListSetStartValueDialogHtml",null,[]);class ru extends Hf.a{constructor(b,h,u,B,Q){super();this.xrd=this.jwe=this.Prd=this.KSe=null;this.dye=!0;this.KS=!1;this.bcb=0;this.Rsj=[Ob.a.Bcg,Ob.a.nhg,Ob.a.l3f];this.llo=(ca,qa)=>{ca=qa[gj.a.Number];this.laa=Number.isInteger(qa[gj.a.Number])&&ca>=this.bcb?ca:this.bcb};this.Fcm=(ca,qa)=>{this.laa=this.laa>=this.bcb?this.laa:this.bcb;qa[gj.a.Number]=this.laa;qa[gj.a.UnitType]=0};this.jio=(ca,qa)=>{if(1===ca){var Qa=qa.ListRadioStartNew,rb=qa.ListRadioContinue,
Lb=vd.GraphIterator.eb(this.Bf);Lb.rd();qa=this.Xs.DB(Lb);ca=this.Ef.tw(Lb);if(Qa)this.Xs.startNewList(Lb,ca,this.laa);else if(rb)if(this.dye)this.Xs.Nba(Lb,qa,this.$Le,-1,!1,ca);else{Qa=!0;for(rb=null;Lb.AJ();)if(Lf.ListItemReader.jg(Lb)){rb=new fq(this.Xs,Lb,!1,!1);break}if(!rb||this.Xs.DB(Lb).Ou>=this.laa)Qa=!1;Qa?(Lb=vd.GraphIterator.eb(this.Bf),Lb.rd(),this.Xs.Nba(Lb,qa,this.$Le,this.laa,!1,ca)):(this.dispose(),this.kIa(CommonUIStrings.l_ErrorDialogMessage,this.SZm))}}};this.SZm=()=>{new ru(this.Bf,
this.$Le,this.Ef,this.Xs,this.Gd)};this.csn=()=>{document.getElementById(ru.TFi).style.visibility="visible"};this.zkn=()=>{document.getElementById(ru.TFi).style.visibility="hidden"};this.ug="ListSetStartValueDialog";this.Yg=Ds.TZm;this.Bf=b;this.laa=h;this.Ef=u;this.$Le=h;this.S6=B;h=new vd.GraphIterator;b?(h.set(b),h.rd(),Yc.OutlineElementReader.Bh(h)||gf.OutlineElementNavigator.Wd(h),Lf.ListItemReader.jg(h)&&(h.Ub(4),b=h.currentNode,22===b.type&&(this.Ef.UX(b).uoa()?this.bcb=1:this.bcb=0))):this.bcb=
1;this.Gd=Q;this.Qh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.jio,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.dye&&(this.KSe=document.getElementById("ListRadioStartNew"),this.Prd=this.csn,this.jwe=document.getElementById("ListRadioContinue"),this.xrd=this.zkn,Me.a.addHandler(this.KSe,"click",this.Prd),Me.a.addHandler(this.jwe,"click",this.xrd));for(const ca of this.Rsj)Object(bm.a)(ca,this.llo,this.Fcm);this.Gd.Bm()}get Xs(){return this.S6}dispose(){if(!this.KS){for(const b of this.Rsj)Object(bm.b)(b);
this.dye&&(this.Prd&&Me.a.removeHandler(this.KSe,"click",this.Prd),this.xrd&&Me.a.removeHandler(this.jwe,"click",this.xrd));this.Gd.YY("ListStartSpinner");super.dispose();this.KS=!0}}mMk(){const b=zj.l("none",this.bcb+"","100","1");return zj.j(ru.UFi,Ob.a.Bcg,Ob.a.l3f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Ob.a.nhg)}OAb(b){const h=document.getElementById(ru.UFi);this.Gd.RZa("ListStartSpinner",b);b=this.Gd.vFb("ListStartSpinner","Medium");h.appendChild(b)}L9(){const b=this.mMk();this.OAb(b)}}ru.UFi=
"SetListStartSpinnerContainer";ru.TFi="ListStartAtSpinnerBox";Object(m.a)(ru,"ListSetStartValueDialog",Hf.a,[]);class uv{H3l(b,h,u,B,Q){new ru(b,h,u,B,Q)}static get instance(){return uv._instance||(uv._instance=new uv)}}uv._instance=null;Object(m.a)(uv,"ListDialogFactory",null,[461]);class qt{constructor(b,h,u){this.S6=b;this.Ef=h;this.Kc=u}Rzf(b){r.ULS.shipAssertTag(40420184,393,Yc.OutlineElementReader.Bh(b));if(Lf.ListItemReader.jg(b)){const h=this.Ef.tw(b);h.Zr||this.Gwm(b,h)}}lVk(b){for(let h=
0;h<b.length;h++){const u=new vd.GraphIterator;u.set(b.getContext(h).node);this.Rzf(u)}}Gwm(b,h){const u=Zo.PageNavigator.instance.ru(b.currentNode),B=this.S6.DB(b),Q=this.Kc.Pc(15);Q.Qt(b);h=this.S6.CDk(u,b,h);this.S6.c1n(b,B.listID);Q.dispose();this.Ef.l2a(b.currentNode,h)}}Object(m.a)(qt,"SingleLevelListEditor",null,[460]);var MA=c(309);class Lz{K2i(b,h,u,B,Q,ca){return b?v.AFrameworkApplication.va.Kf(b,h,u,!0,Q,ca):8}}Object(m.a)(Lz,"ListContextManager",null,[1278]);class Es extends Lz{constructor(b){super();
Es.jwc=b}K2i(b,h,u,B,Q,ca){if(!b||!b.length)return 8;let qa;const Qa=({Ykm:b,Xkm:qa}=Es.mq.Vkm(b)).returnValue;let rb=1;for(const Yb of Qa.keys){var Lb=b.contains(Yb);const gc=Qa.J(Yb);Es.mq.pRk(Qa.J(Yb),this.LHc(h),Lb)?Lb?(r.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.LHc(h)?"Promote":"Demote"),Lb=v.AFrameworkApplication.va.Kf(MA.a.TDa(gc),h,u,B,Q,ca)):(r.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.LHc(h)?"Promote":
"Demote"),Lb=Es.mq.Ivn(Qa.J(Yb),this.LHc(h),qa.J(Yb))):(r.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.LHc(h)?"Promote":"Demote"),Lb=8);rb=dd.ActionManager.M_c(rb,Lb)}return rb}LHc(b){return b===Ob.a.SG?!0:!1}static get mq(){return Es.jwc||(Es.jwc=Ga.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Es.jwc=null;Object(m.a)(Es,"WordEditorListContextManager",Lz,[]);class su{get name(){return"WordEditor.ListEditors"}wc(b){v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("WordEditor.ListEditors.IListAutoCorrector",()=>new KA(b.Re("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).ha(),b.ia("WordEditor.IFlatListEditor",()=>(new Jz(b.resolve("WordEditor.List.IFlatListReader"),b.Re("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new $k.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ia("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ia("Box4.List.ISingleLevelListEditor",()=>new qt(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",
()=>new Es(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new LA(v.AFrameworkApplication.va,new Yn.a,su.Fd,su.Xs,uv.instance)).Tb();const b=v.AFrameworkApplication.va;b.fb(Ob.a.l3f,vc.a.view,bm.d,96);b.fb(Ob.a.nhg,vc.a.view,bm.c,96);b.fb(Ob.a.Bcg,vc.a.view,bm.c,96)}dispose(){}static get Fd(){return null!=su.NCg?su.NCg:su.NCg=Ga.a.instance.resolve("Box4.List.IListReader")}static get Xs(){return null!=su.syg?su.syg:
su.syg=Ga.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){M.a.instance.Gc(new su)}}Object(m.a)(su,"WordEditorListEditorsPackage",null,[1,2]);var UB=c(1700),Km=c(505),qj=c(2052);class ly extends Ec.a{constructor(b,h,u,B,Q,ca){super(b,h);this.styleId=null;this.Ch=0;this.ARa=null;this.characterData=u;this.paragraphNode=B;this.listMarker=Q;this.a9=ca}}Object(m.a)(ly,"HeadingText",Ec.a,[]);var Tu=c(347);class VB{constructor(b,h,u,B,Q,ca,qa){this.CYg=!0;this.Q4g=0;this.pjh=8;this.Xia=null;
this.Hrm=Qa=>{if(Qa.Wr)return!0;Qa=Qa.role;return 1===Qa||2===Qa||4===Qa};this.z8j=b;this.iA=h;this.ue=u;this.Ef=B;this.UF=Q;this.s6=ca;this.qIe=qa}get mx(){return this.z8j.value}get Hzf(){return this.CYg}set Hzf(b){this.CYg=b}get NKb(){return this.Q4g}set NKb(b){this.Q4g=b}get vSb(){return this.pjh}set vSb(b){this.pjh=b}async sYl(){var b=this.qIe.value;if(!isNullOrUndefined(b)&&b.Iy)return b=await this.d6l(),this.Q0f(b,!0);b=this.Xia;return isNullOrUndefined(b)?null:Promise.resolve(this.Q0f(b,!0))}tYl(){return this.Q0f([],
!1)}Q0f(b,h){const u=window.performance.now(),B=this.y9h();if(!B)return null;const Q=new zb.a;let ca=0;for(;B.moveNext();){var qa=B.iterator;if(11===qa.Ue){const Qa=this.Ef.Tqf(qa),rb=gf.OutlineElementNavigator.Ce(qa,!0);h&&b[ca]&&b[ca].ParaId===me.ParagraphReader.pR(rb)&&ca++;gf.OutlineElementNavigator.Wd(qa);if(!rb||!me.ParagraphReader.Wb(rb)||rb.Dr||""===rb.characterData||"\ufffc"===rb.characterData)continue;const Lb=this.eRd(rb);Lb&&(Qa&&(Lb.listMarker=this.UF.Zlb(Qa,!1).z9,qa=this.Ef.tw(qa),
1===qa.listType&&qa.jSc&&(Lb.ARa=qa.font)),h&&(b[ca-1]&&b[ca-1].ParaId===me.ParagraphReader.pR(rb)?Lb.Ch=ca:Lb.Ch=ca+1),Q.add(Lb))}}r.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-u));return Q}d6l(){const b=new Jd.a;var h=qj.a.Jba(v.AFrameworkApplication.rootQuerySignature,null);const u=new pq.a;u.Gq=h;u.status=1;this.ack=window.performance.now();h=this.s6.sha(0,()=>{if(2!=u.statusCode||null==u.Hj||0==u.Hj.length||null==u.Hj[0]){const B=
String.format("GetPageEndsOperation Failed with status code: {0};",u.statusCode);b.setException(Error.create(B));r.ULS.sendTraceTag(543802465,3019,10,B)}else b.Ag(u.Hj[0].PageEnds),r.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.ack))});h.BH(u);h.$T();return of.b(b.task)}x9h(){const b=this.y9h();if(!b)return-1;let h=0;for(;b.moveNext();){const u=b.iterator;if(11===u.Ue){const B=gf.OutlineElementNavigator.Ce(u,!0);gf.OutlineElementNavigator.Wd(u);
B&&me.ParagraphReader.Wb(B)&&!B.Dr&&""!==B.characterData&&"\ufffc"!==B.characterData&&this.eRd(B)&&h++}}return h}y9h(){if(!this.mx)return r.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.iA.hP(this.mx);if(!b)return r.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=vd.GraphIterator.eb(b);if(!b.gp())return r.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Fa.a.zs(b,b.origin);b.wo(this.Hrm,null);return b}eRd(b){var h;return null!==
(h=this.Nim(b))&&void 0!==h?h:this.w6l(b)}Nim(b){if(!In.a.Sj)return this.Oim(b);if(!this.tVm(b))return null;var h=Object(Tu.c)(9);h=Object(Tu.a)(h);h=[...me.ParagraphReader.tjf(b,h)];if(0===h.length)return null;const u=me.ParagraphReader.voa(b)+1;return this.PGh(b,h,u)}w6l(b){var h,u,B,Q;if(!In.a.Sj)return this.nYl(b);var ca=Object(Tu.c)(9);ca=Object(Tu.a)(ca);const qa=me.ParagraphReader.TQc(b),Qa=this.ue.ZC(b),{Jrm:rb,LDl:Lb}=this.aem(qa,Qa,ca);ca=null!==(Q=null!==(u=null===(h=Lb.linkedStyle)||void 0===
h?void 0:h.a9)&&void 0!==u?u:null===(B=Lb.nw)||void 0===B?void 0:B.a9)&&void 0!==Q?Q:10;return this.bJb(ca-1)?this.PGh(b,rb,ca):null}PGh(b,h,u){var B;if(!this.bJb(u-1))return null;const {oAj:Q,nAj:ca}=this.PLo(b,h);return 0===Q.length?null:(h=null===(B=me.ParagraphReader.TTd(b,Q))||void 0===B?void 0:B.trim())&&""!=h?new ly(ca.Bd,ca.endCp,h,b,null,u):null}aem(b,h,u){const B=[];let Q={linkedStyle:null,nw:null},ca=null,qa=null;for(const Qa of b)if(ca=Qa.R3.formatting?this.pYl(h,Qa.R3):ca,b=u(Qa)){if(!qa&&
b){qa=ca;if(!qa)break;Q=ca}else if(!this.ELm(ca,qa))break;B.push(Qa)}return{Jrm:B,LDl:Q}}PLo(b,h){var u;let B=-1,Q;for(Q=0;Q<h.length;Q++){var ca=h[Q],qa=b.characterData.substring(ca.R3.cp,ca.cpEnd),Qa=null===qa||void 0===qa?void 0:qa.trimStart();if(Qa){B=ca.R3.cp+(qa.length-Qa.length);break}}if(-1===B)return{oAj:[],nAj:{Bd:-1,endCp:-1}};ca=-1;for(qa=h.length;0<qa;qa--){Qa=h[qa-1];const rb=b.characterData.substring(Qa.R3.cp,Qa.cpEnd),Lb=null===rb||void 0===rb?void 0:rb.trimEnd();if(Lb){ca=Qa.cpEnd-
(rb.length-Lb.length);break}}return{oAj:null!==(u=h.slice(Q,qa))&&void 0!==u?u:[],nAj:{Bd:B,endCp:ca}}}ELm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.a9===b.linkedStyle.a9||h.nw&&b.nw&&h.nw.zBh==b.nw.zBh?!0:!1}pYl(b,h){h=zc.FormattingReader.Eoa(h.formatting);b=this.rYl(b,h);h=this.oYl(h);return b||h?{linkedStyle:b,nw:h}:null}rYl(b,h){b=this.ue.ywa(h,b);if(!b)return null;h=b.ja(Jc.a.Ii,9);return this.G9c(h)?{Qjp:b.id,a9:h+1}:null}oYl(b){var h;
b=this.ue.wg(b);if(!b||!lk.a.E0d(b))return null;const u=null!==(h=lk.a.o9b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(u);return this.bJb(h-1)?{zBh:b,a9:h}:null}Oim(b){const h=me.ParagraphReader.voa(b);if(this.G9c(h))return new ly(0,b.characterData.length,b.characterData,b,null,h+1);if(this.bJb(h)){var u=this.ue.Ro(b);u=this.ue.wg(u);if(lk.a.KJb(u))return new ly(0,b.characterData.length,b.characterData,b,null,h+1)}return null}nYl(b){var h;let u=h=null,B=-1;var Q=-1,ca=this.ue.ZC(b);for(let Qa=0;Qa<
b.qa.length;Qa++)if(h=b.qa.J(Qa),h.formatting){var qa=zc.FormattingReader.Eoa(h.formatting);const rb=this.ue.wg(qa);if(!u&&(u=rb,Q=(Q=lk.a.o9b(u))?Number.parseInvariant(Q):0,!this.bJb(Q-1)))break;qa=(qa=this.ue.ywa(qa,ca))?qa.ja(Jc.a.Ii,9):9;B=-1===B?qa:B;if(!(this.G9c(qa)&&B===qa||lk.a.E0d(rb)&&u===rb))break}h=h.cp;ca=b.characterData.substring(0,h);return this.G9c(B)?new ly(0,h,ca,b,null,B+1):lk.a.E0d(u)?new ly(0,h,ca,b,null,Q):null}tVm(b){const h=me.ParagraphReader.voa(b);if(!this.bJb(h))return!1;
if(this.G9c(h))return!0;b=this.ue.Ro(b);b=this.ue.wg(b);return lk.a.KJb(b)?!0:!1}G9c(b){return this.Hzf&&this.bJb(b)}bJb(b){return b>=this.NKb&&b<=this.vSb}}Object(m.a)(VB,"StyleBasedDocumentHeadings",null,[398]);var dD=c(1026);class yC{constructor(){this.startTime=0}}Object(m.a)(yC,"TocCallbackData",null,[]);class rt{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.Sog=(gc,Fc,Sc)=>{const ld=Fc.node;if(!ld)return r.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==ld.type)return r.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!ld.Dr)return 2;if(1===Sc)return fc.SessionStatusManager.instance.Uj?8:32;this.od&&this.od.isFeatureEnabled(122)?this.HDc.tTo(ld).then(Hd=>{Hd||this.yGj(ld)}):this.yGj(ld);return 32};this.XXo=gc=>{gc=window.performance.now()-gc.startTime;r.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",gc));gc=Object.assign(new Ub.a,{durationMs:gc});xa.Health.instance.recordKpiSuccess(rt.fKj,
gc);rt.E8a()};this.Hri=(gc,Fc,Sc,ld,Hd)=>{if(me.ParagraphReader.Wb(Fc.node)&&Fc.node.Dr)return 2;if(1===Sc)return fc.SessionStatusManager.instance.Uj?8:32;if(Fc.contextId!==vc.a.Tc||this.Ik.n9(Fc)||!me.ParagraphReader.Wb(Fc.node))return 32;this.Ud.Us(17);(null===Hd||void 0===Hd?0:Hd.resolve)?this.HDc.$Jh(Fc,Hd.resolve):this.HDc.$Jh(Fc);return 32};this.f7f=(gc,Fc,Sc)=>{gc=Fc.node;if(!gc)return r.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==gc.type)return r.ULS.sendTraceTag(39358979,
324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!gc.Dr)return 2;if(1===Sc)return fc.SessionStatusManager.instance.Uj?8:32;Sc=null;gc.isConnected&&(Sc=dD.a.H9b(gc,!0),Sc.rnc(gc));Fc=new vd.GraphIterator;Fc.set(gc);Fc.zb(8);Fc.ld(8);const ld=this.Kc.Pc(15);ld.Qt(Fc);this.HDc.IXn(gc)?(ld.dispose(),Sc&&Sc.normalize(),rt.E8a()):(Sc&&Sc.cancel(),ld.dispose(),r.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.kgd=h;this.Zc=B;this.Kc=Q;
this.Ik=ca;this.HDc=qa;this.Ud=Qa;this.od=rb;this.nVg=Lb;this.KI=Yb}Tb(){this.ga.ra(Ob.a.rSb,vc.a.paragraph,this.Sog);this.ga.ra(Ob.a.rSb,vc.a.Jd,this.Sog);this.ga.ra(Ob.a.rSb,vc.a.Tc,this.Sog);this.ga.Xc(Ob.a.rSb,1028);this.ga.ra(Qc.a.gBf,vc.a.Tc,this.Hri);this.ga.Xc(Qc.a.gBf,1028);this.ga.ra(Qc.a.U5c,vc.a.paragraph,this.f7f);this.ga.ra(Qc.a.U5c,vc.a.Jd,this.f7f);this.ga.ra(Qc.a.U5c,vc.a.Tc,this.f7f);this.ga.Xc(Qc.a.U5c,1028)}yGj(b){xa.Health.instance.recordKpiUsage(rt.fKj,1,rt.xB,null);const h=
this.zMl(b),u=new yC;u.startTime=window.performance.now();this.kgd.Phj(h,Jc.a.Wng,this.nhm(this.t6l(b)),this.XXo,null,u);this.HDc.OTk()}oOj(b){if(null!=b&&b.Dr)if(null==this.nVg.instance)r.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.nVg.instance.zci();b=this.xCl(b);var u=!1;1===this.KI.mu&&(u=!0);0!=b&&h!=b&&(h=[Object.assign(new ha.a,{name:"TOCPageNo",string:b}),Object.assign(new ha.a,{name:"HeadingPageNo",string:h}),Object.assign(new ha.a,{name:"isMainView",
string:u})],Fe.a("TOCPageNoMismatch",!0,void 0,h))}}xCl(b){for(let h=0;h<b.qa.length;h++){const u=b.qa.J(h);if(null!=u.Vc)for(let B=0;B<u.Vc.length;B++){const Q=u.Vc.J(B);if(1===Q.Mf&&Q.nY.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(u.cp,b.characterData.length-u.cp))}}return 0}t6l(b){return b?b.ja(Jc.a.zN,null):(r.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}zMl(b){return this.Zc.qoa(b,7,7).Ub(35)}nhm(b){const h=[];h.push(b+",TOC,0");return h}static E8a(){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},rt.fEa)}}rt.fEa=5E3;rt.fKj="WordUpdateTOC";rt.xB="wwaengidc";Object(m.a)(rt,"TableOfContentsActor",null,[397]);class tu{}Object(m.a)(tu,"FieldData",null,[]);class vv extends tu{constructor(){super();this.Pqb=null}}Object(m.a)(vv,"TOCFieldData",tu,[]);class NA{constructor(b,
h,u,B,Q,ca=null){this.Lrm=b;this.zt=h;this.Ch=u;this.Tuj=B;this.listMarker=Q;this.ARa=ca}}Object(m.a)(NA,"TOCHeadingData",null,[]);class Ty{constructor(b,h){this.EWa=b;this.xn=h}async z9h(b){this.EWa.Hzf=b.Izf;this.EWa.NKb=b.NKb;this.EWa.vSb=b.vSb;return this.EWa.sYl()}jNl(b){if(b=this.iNl(b))return this.xn.owa(b)}iNl(b){const h=b.qa.length;for(let u=0;u<h;u++){const B=b.qa.J(u);if(B.hyperlink&&B.hyperlink.Oca&&B.hyperlink.url.startsWith(F.a.Teb))return B.hyperlink.url.substr(B.hyperlink.url.indexOf("_Toc"))}return null}Ace(b){(b=
this.jNl(b))&&this.xn.ETf(b.id)}bem(){return this.EWa.x9h()}O1i(b,h){const u=new vv,B=new zb.a;for(const Q of b){b=this.$dm(Q,h);if(!b)return null;B.add(b)}u.Pqb=B;return u}$dm(b,h){let u;if(h&&(u=this.J7k(b),!u))return r.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=wp.AParagraphNode.NP(b.characterData.trim());const B=this.Rfm(b.a9);return new NA(h,u,b.Ch,B,b.listMarker,b.ARa)}J7k(b){const h=String.format("{0}{1}","_Toc",qe.a.zF());return this.xn.ZEc(h,
b.Ac,b.end,b.paragraphNode,b.paragraphNode)?h:null}Rfm(b){return String.format("toc {0}",b)}}Object(m.a)(Ty,"TOCDataManager",null,[396]);class uu{dgg(){const b=Object.assign(new mg.StandardDialog,{Ht:v.AFrameworkApplication.Pca,Cd:0,xIa:!1});b.rV(1);b.Uja(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=uu.gBg?uu.gBg:uu.gBg=new uu}}Object(m.a)(uu,"TOCDialogHelper",null,[]);var OA=c(186),WB=c(496),
XB=c(256),PA=c(148);class Fw{constructor(b,h,u,B,Q,ca,qa){this.egg=b;this.Gkb=h;this.Izf=u;this.NKb=B;this.vSb=Q;this.jAb=ca;this.jcd=[];this.nY=qa}toString(){return"showPageNumber:"+this.egg+"  isHyperlink:"+this.Gkb+" includeOutlineLevels:"+this.Izf+" lowerOutlineLevel:"+this.NKb+" upperOutlineLevel:"+this.vSb+" addContentControl:"+this.jAb+" unsupportedSwitches:"+this.jcd.toString()}}Object(m.a)(Fw,"TOCSettings",null,[]);class Vi{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe,de){this.fZg=
"TOC";this.fjf=this.Xwe=this.XUe=null;this.s8a=b;this.mh=h;this.xD=u;this.Yu=B;this.nz=Q;this.Ik=ca;this.ib=qa;this.Ld=Qa;this.aih=rb;this.Be=Lb;this.VUe=Yb;this.Yo=Fc;this.MI=Sc;this.Pn=ld;this.Kc=Hd;this.Ib=Ie;this.Ig=fe;this.gb=de}static get iTo(){if(null!=Vi.Vyd)return Vi.Vyd;v.AFrameworkApplication.le("i430a979-t;a1f4j306-c");Vi.Vyd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return Vi.Vyd}get AUc(){return this.fZg}set AUc(b){this.fZg=
b}get Qqb(){this.XUe||(this.XUe=this.g7h());return this.XUe}g7h(){return new Fw(!0,!0,!0,0,8,!0,this.ODn())}async $Jh(b,h){Fe.a(Vi.tdl);const u=window.performance.now();if(this.gb.Wb(b.node))if(this.Ik.n9(b))r.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Vi.GRa("IP is in locked range");else{var B=await this.s8a.z9h(this.Qqb);if(B){var Q=new bf.a(2,1,0,()=>{this.vdl(b,B,this.Qqb.Gkb,u);h&&h()});this.Ib.Xb(Q)}else r.ULS.sendTraceTag(592233795,
3019,10,"Failed to create table of contents."),Vi.GRa("Failed to get TOC data")}else r.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Vi.GRa("Context should be paragraph")}vdl(b,h,u,B=0){let Q;try{if(0==B&&(B=window.performance.now()),this.JYh(b.node)){var ca=new vd.GraphIterator;ca.set(b.node);ca.zb(7);ca.ld(7);Q=this.Kc.Pc(15);Q.Qt(ca);var qa=this.s8a.O1i(h,u);qa||Vi.GRa("Failed to prepare TOC Field data");var Qa=qa.Pqb?qa.Pqb.count:
0;if(Qa){h=null;var rb;for(u=0;u<Qa;u++){const Fc=qa.Pqb.J(u);if(!({$Cb:rb}=this.Eri(b,h,u,Qa,Fc,Yb?Yb.toString():void 0)).returnValue){Vi.GRa("Failed to populate new TOC paragraph");return}if(0==u){var Lb=rb.currentNode;var Yb=me.ParagraphReader.pR(Lb)}h=rb}if(this.Qqb.jAb&&!this.E$e(Lb.id,h.Cn.id))Vi.GRa("Failed to add content control block");else{var gc=window.performance.now()-B;Fe.a(Vi.cbf,!0,gc)}}else if(this.VUe.dgg(),this.f9k(b)){const Fc=window.performance.now()-B;Fe.a(Vi.cbf,!0,Fc)}}else Vi.GRa("Failed to fetch style set")}catch(Fc){Vi.GRa(String.format("{0} {1}",
Fc.message,Fc.stack))}finally{Q&&Q.dispose()}}JYh(b){this.Xwe=this.nz.ZC(b);return this.Xwe?!0:(r.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static FGa(b){b=[Object.assign(new ha.a,{name:Vi.VXo,string:b})];Fe.a(Vi.Uog,!1,void 0,b)}static rMf(b){b=[Object.assign(new ha.a,{name:Vi.oZn,string:b})];Fe.a(Vi.s$i,!1,void 0,b)}static GRa(b){b=[Object.assign(new ha.a,{name:Vi.udl,string:b})];Fe.a(Vi.cbf,!1,void 0,b)}async tTo(b){const h=this.Igi(b);if(null==h)Vi.FGa("Cannot update TOC when firstTocPara = null");
else{var u=this.dem(h);if(0<u.jcd.length)return this.L5m(u.jcd),!1;Fe.a(Vi.UXo);var B=window.performance.now(),Q=await this.s8a.z9h(u);if(!Q)return r.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Vi.FGa("Failed to fetch TOC data"),!1;b=new bf.a(1,1,0,()=>{this.WXo(h,Q,u,B)});this.Ib.Xb(b);return!0}}WXo(b,h,u,B=0){let Q;try{if(null==b)Vi.FGa("Attempt to update TOC when firstTocPara = null");else{0==B&&(B=window.performance.now());var ca=new vd.GraphIterator;ca.set(b);ca.zb(7);
ca.ld(7);Q=this.Kc.Pc(15);Q.Qt(ca);var qa=this.s8a.O1i(h,u.Gkb);if(null==qa)Vi.FGa("Attempt to update TOC when tocFieldData = null");else{var Qa;if(({U5e:Qa}=this.O9i(b,u)).response){r.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",u.toString()));var rb=qa.Pqb?qa.Pqb.count:0;if(this.JYh(b)){var Lb;this.vzi(b)&&(this.r$i(b),(b=this.gb.$f(b,!1,!0))&&(Lb=b.ja(Jc.a.Wc,null).toString()));var Yb=b.ja(Jc.a.zN,null);h=Yb;Lb=null!==Lb&&void 0!==Lb?Lb:Yb;if(rb){for(var gc=
0,Fc;b.Dr&&h==Yb&&gc<rb;){const Hd=qa.Pqb.J(gc);u.Gkb&&this.s8a.Ace(b);if(!this.xXo(b,gc,rb,Hd,u)){r.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Vi.FGa("Failed to update TOC paragraph");return}b.setValue(Jc.a.zN,Lb);gc++;Fc=b;b=this.gb.$f(Fc,!1,!0);if(!b){h=null;break}this.Czi(b)&&this.q$i(b);h=b.ja(Jc.a.zN,null)}h==Yb&&this.W6f(b);var Sc;if(({HIf:Sc}=this.Fsk(qa,gc,rb,Fc,Lb)).response)if(u.jAb&&!this.E$e(Qa,Sc.id))Vi.FGa("Failed to add content control block");else{var ld=
window.performance.now()-B;Fe.a(Vi.Uog,!0,ld)}else Vi.FGa("Failed to add new paragraph")}else this.VUe.dgg(),this.RXo(b,u.jAb,Qa,u.nY,Lb)&&(gc=window.performance.now()-B,Fe.a(Vi.Uog,!0,gc))}else Vi.FGa("Failed to fetch style set")}else Vi.FGa("Failed to remove Content Control")}}}catch(Hd){Vi.FGa(String.format("{0} {1}",Hd.message,Hd.stack))}finally{Q&&Q.dispose()}}Fsk(b,h,u,B,Q){let ca=new vd.GraphIterator;for(ca.set(B);h<u;){B=b.Pqb.J(h);if(!({$Cb:B}=this.Eri(null,ca,h,u,B,Q)).returnValue)return{HIf:ca.currentNode,
response:!1};ca=B;h++}return{HIf:ca.currentNode,response:!0}}O9i(b,h){var u;let B,Q;const ca=null===(u=null===b||void 0===b?void 0:b.qa)||void 0===u?void 0:u.first.Jb;if(ca&&0<ca.length)if(b=b.qa.first.Jb.J(0),b.Gf){u=b.contentControlNode.getValue(Jc.a.Ww);B=this.Ig.Cq(b.contentControlNode.id,!0);Q=this.Ig.Cq(b.contentControlNode.id,!1);if(0!=this.Yo.rOb(u))return r.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,U5e:B,XAh:Q};h.jAb=!0}else r.ULS.sendTraceTag(528537613,
3019,15,"Content control is not block type"),h.jAb=!1;else h.jAb=!1;return{response:!0,U5e:B,XAh:Q}}RXo(b,h,u,B,Q){r.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.s8a.Ace(b);const ca=this.aQd(b);if(!this.X0i(ca,h,u,B))return Vi.FGa("Failed to populate empty TOC."),!1;if(h=this.gb.$f(b,!1,!0))u=b.ja(Jc.a.zN,null),B=h.ja(Jc.a.zN,null),u==B&&this.W6f(h);b.setValue(Jc.a.zN,Q);return!0}X0i(b,h,u,B){this.Ld.Ge(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.rOi(b);
const Q=b.qa.first;this.Be.EL(Q.formatting,!0);this.P$e(b,0,1,B);Vi.iTo&&Q.peg&&b.we.rq.Z(Q.formatting.oe,Ui.CharacterPropertiesEditor.$M);return h&&u&&!this.E$e(u,b.id)?!1:!0}aQd(b){b.qa.reset();b.YNa();const h=new OA.a(b,0);h.formatting=new PA.a(h,W.a.nil);h.Oh=!0;b.qa.add(h);return Je.a.createTextRange(b,0,b.characterData.length)}vzi(b){if(me.ParagraphReader.lP(b)){var h=b.qa.last.Vc;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).Mf;const u=1===h.J(h.length-3).Mf&&h.J(h.length-
3).nY.trim().startsWith(this.AUc),B=2===h.J(h.length-2).Mf;h=5===h.J(h.length-1).Mf;return b&&u&&B&&h}}return!1}Czi(b){if(me.ParagraphReader.lP(b)){var h=b.qa.first.Vc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).Mf,h=3===h.J(1).Mf,b&&h}return!1}r$i(b){const h=b.qa.last.Vc,u=h.J(h.length-4),B=h.J(h.length-3),Q=h.J(h.length-2),ca=h.J(h.length-1);h.remove(u);h.remove(B);h.remove(Q);h.remove(ca);b.removeProperty(Jc.a.zN)}q$i(b){const h=b.qa.first.Vc,u=h.J(0),B=h.J(1);h.remove(u);h.remove(B);
b.removeProperty(Jc.a.zN)}W6f(b){if(b){var h=b.ja(Jc.a.zN,null),u=b.ja(Jc.a.Wc,null).toString(),B=h;u==h&&this.vzi(b)&&(this.r$i(b),(b=this.gb.$f(b,!1,!0))&&(B=b.ja(Jc.a.zN,null)));u=new vd.GraphIterator;u.set(b);u.zb(8);r.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var Q;b&&b.Dr&&B==h&&Q!=b;){if(this.Czi(b)){this.q$i(b);break}this.s8a.Ace(b);this.Pn.Wd(u);B=this.Pn.$r(u,!1,!0);this.mh.Vya(b);if(!B)return null;Q=b;u.Ub(2);B=(b=u.currentNode)?b.ja(Jc.a.zN,null):null}return b}}dem(b){var h=
b.qa,u=h?h.length:0,B=null;b=new Fw(!0,!1,!1,0,8,!0,void 0);for(let Q=0;Q<u&&(B=this.cem(h.J(Q)),b.nY=B,B=this.Wam(B),B[0]!==this.AUc);Q++);h=B?B.length:0;for(u=1;u<h;u++)switch(B[u]){case "\\h":b.Gkb=!0;break;case "\\u":b.Izf=!0;break;case "\\o":this.gjo(B[u+1],b)&&u++;break;case "\\z":break;case "\\n":b.egg=!1;b.jcd.push(B[u]);break;default:b.jcd.push(B[u])}return b}gjo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.NKb=Number.parseInvariant(b[1])-1,h.vSb=Number.parseInvariant(b[2])-
1,!0):!1}IXn(b){try{Fe.a(Vi.nZn);const h=window.performance.now(),u=this.Igi(b);if(null==u){Vi.rMf("Attempt to remove TOC when firstTocPara = null");return}let B,Q,ca;const qa=this.g7h();if(!({U5e:B,XAh:Q}=this.O9i(u,qa)).response)return Vi.rMf("Failed to remove content control"),!1;if(void 0==B&&void 0==Q)ca=this.W6f(u);else{ca=u.Lc.Eb(B);const rb=new vd.GraphIterator;rb.set(ca);rb.zb(8);b=!1;let Lb;for(;!b&&ca&&Lb!=ca;){ca.id.equals(Q)&&(b=!0);ca&&ca.Dr&&this.s8a.Ace(ca);this.Pn.Wd(rb);const Yb=
this.Pn.$r(rb,!1,!0);this.mh.Vya(ca);if(!Yb){ca=null;break}rb.Ub(2);Lb=ca;ca=rb.currentNode}}ca&&this.Y_c(ca);const Qa=window.performance.now()-h;Fe.a(Vi.s$i,!0,Qa)}catch(h){Vi.rMf(String.format("{0} {1}",h.message,h.stack))}return!0}Y_c(b){b=Je.a.Oc(b,0);b=new Dh.Selection([b],!0);this.ib.Bc(b)}E$e(b,h){return this.Yo.Ama(b,h,null,Vi.KSh,!0).returnValue?(r.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}OTk(){this.s8a.bem()||this.VUe.dgg()}Igi(b){if(!b.Dr)return r.ULS.sendTraceTag(528320659,
3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ja(Jc.a.zN,null);return this.MI.D6l(b)}L5m(b){b.length&&(b=[Object.assign(new ha.a,{name:"UnsupportedSwitches",string:b.toString()})],Fe.a("UnsupportedTocInstruction",void 0,void 0,b))}cem(b){const h=(b=b.Vc)?b.length:0;for(let u=0;u<h;u++)if(1===b.J(u).Mf&&b.J(u).nY.trim().startsWith(this.AUc))return b.J(u).nY.trim();return null}Wam(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}f9k(b){b=this.yLh(b,null,!0,void 0).returnValue;
if(!b)return Vi.GRa("Failed to create paragraph"),!1;const h=Je.a.Oc(b,0);if(!this.X0i(h,!0,b.id,this.Qqb.nY))return Vi.GRa("Failed to populate empty TOC"),!1;r.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}yLh(b,h,u,B){let Q,ca;u&&b?(Q=this.v9k(b),ca=Q.currentNode,B=me.ParagraphReader.pR(ca).toString()):h&&(Q=this.J3l(h),ca=this.mh.fJ(Q));if(!ca)return r.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,$Cb:Q};
ca.setValue(Jc.a.zN,B);return{returnValue:ca,$Cb:Q}}ODn(){const b=new Sys.StringBuilder(this.AUc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}cEn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Qqb.Gkb&&h.append(" \\h");return h.toString()}J3l(b){b.rd();this.Pn.Wd(b);return this.mh.Zoa(b,!1)}v9k(b){const h=new vd.GraphIterator;h.set(b.node);h.rd();this.Pn.Wd(h);let u=this.mbi(h);const B=!b.cpBegin;if(Yc.OutlineElementReader.isEmpty(h,!0))return this.mri(u);if(B)return this.mh.Iz(u,
!0,!1),this.mh.G$(h,u,b,!1,!1,!1),b=this.mbi(u),this.mri(b);u=this.mh.Zoa(h);this.mh.G$(h,u,b,!1,!1,!0);b=this.mh.Zoa(h);this.mh.SPb(b.currentNode,!1);this.mh.fJ(b);this.Pn.Ce(b);return b}mbi(b){const h=new vd.GraphIterator;h.jd(b);h.rd();return h}mri(b){this.mh.Iz(b,!0,!0);this.mh.SPb(b.currentNode,!1);this.Pn.Ce(b);return b}rOi(b){const h=b.qa;1===h.length&&(h.first.Oh=!1,b.PLd().Oh=!0)}xXo(b,h,u,B,Q){const ca=this.aQd(b);this.Ld.Ge(ca,"");this.a1i(b,B,Q);this.P$e(b,h,u,Q.nY);return Q.Gkb&&!this.qG(b,
B.zt)?!1:!0}Eri(b,h,u,B,Q,ca){h=({$Cb:b}=this.yLh(b,h,0==u,ca)).returnValue;if(!h)return{returnValue:!1,$Cb:b};this.a1i(h,Q,this.Qqb);this.P$e(h,u,B,this.Qqb.nY);return this.Qqb.Gkb&&!this.qG(h,Q.zt)?{returnValue:!1,$Cb:b}:{returnValue:!0,$Cb:b}}a1i(b,h,u){this.nBm(b,h.Lrm,h.listMarker,h.Tuj,h.ARa);this.aih.PCm(b,b.characterData.length);u.egg&&this.gCm(b,h);this.rOi(b);this.Blo(b,h.Tuj)}h1l(b,h){if(!b)return 0;const u=Vi.Sfm();return 4<b.length?u.J(h)+.5*Math.floor(b.length/3):u.J(h)}nBm(b,h,u,B,
Q){u&&this.DBm(b,u,B);u=Je.a.Oc(b,b.characterData.length);this.Ld.Ge(u,h);Q&&(b=b.qa.zh(0),this.Be.Kja(b.formatting,Q))}DBm(b,h,u){u=this.h1l(h,u);const B=Je.a.Oc(b,0);this.Ld.Ge(B,h);this.aih.EBm(b,h.length,u)}gCm(b,h){var u=Je.a.Oc(b,b.characterData.length);this.Ld.Ge(u,h.Ch.toString());u=b.qa.zh(b.characterData.length-h.Ch.toString().length);h=this.cEn(h.zt);this.uQa(b,u,0,2,h);this.uQa(b,u,1,2,h);this.uQa(b,u,2,2,h);u=b.qa.zh(b.characterData.length);this.uQa(b,u,3,2,h)}Blo(b,h){h=this.Xwe.jj(h);
this.Yu.YJ(h,b,!0)}P$e(b,h,u,B){const Q=b.qa.first,ca=b.qa.last;h?this.uQa(b,Q,4,1,B):(this.uQa(b,Q,0,1,B),this.uQa(b,Q,1,1,B),this.uQa(b,Q,2,1,B));h===u-1?this.uQa(b,ca,3,1,B):this.uQa(b,ca,5,1,B)}uQa(b,h,u,B,Q=null){u=new WB.a(h,null,u,B,!0,!1,!1,Q);h.Vc||(h.Vc=new XB.a(h));h.Vc.add(u);b.Zl();this.$dl(u,b)}$dl(b,h){b.oe?h.we.mY(b.oe-1,2):h.we.Xoa(b.oe,2);h.we.rq.Z(b.oe,Ui.CharacterPropertiesEditor.$M);h.we.kt.Z(b.oe,Ui.CharacterPropertiesEditor.WR)}qG(b,h){b=Je.a.createTextRange(b,0,b.characterData.length);
return this.xD.qG(b,h,!1,!1,!1,!0)?!0:(r.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static Sfm(){Vi.fua||(Vi.fua=new tb.a,Vi.fua.Z("toc 1",1),Vi.fua.Z("toc 2",1.5),Vi.fua.Z("toc 3",2),Vi.fua.Z("toc 4",2.5),Vi.fua.Z("toc 5",3),Vi.fua.Z("toc 6",3.5),Vi.fua.Z("toc 7",4),Vi.fua.Z("toc 8",4.5),Vi.fua.Z("toc 9",5));return Vi.fua}}Vi.fua=null;Vi.KSh="Table of Contents";Vi.tdl="CreateTocClient";Vi.cbf="CreateTocSuccess";Vi.udl="CreateTocFailureCause";
Vi.UXo="UpdateTocClient";Vi.Uog="UpdateTocSuccess";Vi.VXo="UpdateTocFailureCause";Vi.nZn="RemoveTocClient";Vi.s$i="RemoveTocSuccess";Vi.oZn="RemoveTocFailureCause";Vi.Vyd=null;Object(m.a)(Vi,"TOCField",null,[340,341]);var Mz=c(643);class Uu{constructor(b,h){this.TAa=b;this.WJa=h}PCm(b,h){if(me.ParagraphReader.Wb(b)&&!(0>h)){var u=Pk.a.E3b(b);u=new Mz.a(u,4,1,1);this.TAa.XWd(b,u);b=Je.a.Oc(b,h);this.WJa.lXd(b)}}EBm(b,h,u){var B=im.a.DM/2;const Q=b.qa.Aib(h);B=zc.FormattingReader.Wn(Q.formatting,Xe.a.fontSize,
2*B)/2;u=new Mz.a(Of.a.Mv(B/36)*u,1,0,1);this.TAa.XWd(b,u);b=Je.a.Oc(b,h);this.WJa.lXd(b)}}Object(m.a)(Uu,"TOCTabUtility",null,[345]);class Gw{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}wc(b){this.W=b;this.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new UB.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Km.a.iR)).ha();this.W.ia("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new VB(new hg.a(()=>Fb.App.za.jb.Yc),Zo.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),
this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new Ar.a,new hg.a(()=>Fb.App.za.jb.qc))).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.W.ia("WordEditor.TableOfContents.TOCDataManager",()=>new Ty(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();this.W.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new Uu(this.W.resolve("WordEditor.ICustomTabStopUtility"),
this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.W.ia("WordEditor.TableOfContents.TOCField",()=>new Vi(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),ti.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),
this.W.resolve("Box4.IFormattingEditor"),uu.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Oa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),$k.a.instance,v.AFrameworkApplication.oc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();this.W.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new rt(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),$k.a.instance,ti.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Ta("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Tb()}dispose(){}}
Object(m.a)(Gw,"PackageManager",null,[1,2]);class yo{constructor(b,h,u,B,Q,ca,qa,Qa){this.SSa=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:rb}=this.Mpb(Lb,Yb,Fc,!0,!0)).returnValue)return rb;this.Cxd.GKh(Fc,Lb.node);return 32};this.Kya=(rb,Lb,Yb,gc,Fc)=>this.oli(Lb,Yb,gc,Fc,!0);this.gNb=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:rb}=this.Mpb(Lb,Yb,Fc,!1,!0)).returnValue)return rb;this.Cxd.jal(Fc,Lb.node);r.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Jma=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:gc}=this.Mpb(Lb,Yb,Fc,!1,
!0)).returnValue)return 2==Yb&&8==gc&&Yq.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],pe.a.kEb),gc;const Sc=Lb.node;let ld=null;(ld=rb===Ob.a.Jma?this.Cxd.USb(Fc[gg.a.SourceControlId],Sc):this.Dx.ATd(Sc,Fc))?(this.M9d(Sc,()=>{this.Azd.XPb(ld,Sc)}),this.eQ(),gc=32):(Yq.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],pe.a.kEb),gc=8);rb===Ob.a.Jma&&32===gc&&r.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");r.ULS.shipAssertTag(0,
324,32===gc);return gc};this.Gua=(rb,Lb,Yb,gc,Fc)=>this.oli(Lb,Yb,gc,Fc,!1);this.Ake=(rb,Lb,Yb,gc,Fc)=>Ap.a.xqa(rb,Lb,Yb,gc,Fc,{},14);this.RBb=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:rb}=this.Mpb(Lb,Yb,Fc,!1,!1)).returnValue)return rb;const Sc=Lb.node;this.M9d(Sc,()=>{this.Azd.yXk(Sc)});return 32};this.Dx=b;this.Cxd=h;this.ga=u;this.Azd=B;this.Kc=Q;this.dA=ca;this.K7j=Qa}Tb(){this.yic(Fb.App.JUa.iKh())}yic(b){this.ga.ra(Ob.a.SSa,vc.a.view,b);this.ga.ra(Ob.a.SSa,vc.a.table,this.SSa);this.ga.Xc(Ob.a.SSa,1127);
this.ga.ra(Ob.a.Jma,vc.a.view,this.Ake);this.ga.ra(Ob.a.Jma,vc.a.table,this.Jma);this.ga.Xc(Ob.a.Jma,1030);this.ga.ra(Ob.a.KQ,vc.a.table,this.Jma);this.ga.ra(Ob.a.Gua,vc.a.view,this.Ake);this.ga.ra(Ob.a.Gua,vc.a.table,this.Gua);this.ga.Xc(Ob.a.Gua,1038);this.ga.ra(Ob.a.Kya,vc.a.view,b);this.ga.ra(Ob.a.Kya,vc.a.table,this.Kya);this.ga.Xc(Ob.a.Kya,1127);this.ga.ra(Ob.a.gNb,vc.a.view,b);this.ga.ra(Ob.a.gNb,vc.a.table,this.gNb);this.ga.Xc(Ob.a.gNb,1126);this.ga.ra(Ob.a.RBb,vc.a.view,this.Ake);this.ga.ra(Ob.a.RBb,
vc.a.table,this.RBb);this.ga.Xc(Ob.a.RBb,1028)}eQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}oli(b,h,u,B,Q){if(!({xy:ca}=this.Mpb(b,h,B,Q,!0)).returnValue)return 2==h&&8==ca&&Yq.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],
pe.a.Yyl),ca;b=b.node;h=this.Dx.i0(b);var ca=B[gg.a.On];const qa=yo.wem(B.MenuItemId);Q?B[gg.a.On]=yo.qro(h,qa):(this.nEk(h,qa,ca,b),u.As=qa,u.MC=ca?0:1,r.ULS.shipAssertTag(0,324,!!qa));return 32}M9d(b,h){const u=this.Kc.Pc(15);try{u.Db(b),this.dA.Q6a(),h()}finally{u&&u.dispose()}}Mpb(b,h,u,B,Q){return this.CTm(b,h,u,B,Q)?{returnValue:B||2===h,xy:32}:{returnValue:!1,xy:8}}CTm(b,h,u,B,Q){if(b.contextId!==vc.a.table)return!1;if(B||2===h)if(Q&&!u||!Object(Cb.a)(ik.TableNode,b.node)||this.K7j(b.node))return!1;
return!0}nEk(b,h,u,B){const Q=(512===h||1024===h?!u:u)?b|h:b&~h;Q!==b&&this.M9d(B,()=>{this.Azd.sza(Q,B)})}static qD(){yo.Bdb[yo.FDl]=32;yo.Bdb[yo.wDl]=128;yo.Bdb[yo.CXm]=64;yo.Bdb[yo.uXm]=256;yo.Bdb[yo.RHk]=512;yo.Bdb[yo.QHk]=1024}static qro(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static wem(b){let h=0;b in yo.Bdb&&(h=yo.Bdb[b]);return h}}yo.FDl="buttonFirstRow";yo.wDl="buttonFirstColumn";yo.CXm="buttonLastRow";yo.uXm="buttonLastColumn";yo.RHk="buttonBandedRow";yo.QHk="buttonBandedColumn";
yo.Bdb={};Object(m.a)(yo,"TableStyleActor",null,[]);yo.qD();var YB=c(778),vx=c(402);class Nz extends vx.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(Nz,"TableGalleryButtonProps",vx.a,[]);class my extends Nz{constructor(){super()}get Type(){return 6}}Object(m.a)(my,"TableStyleGalleryButtonProps",Nz,[]);class QA{}QA.zfn=2147483647;Object(m.a)(QA,"TableStyleUtil",null,[]);class wq{constructor(b,h,u){this.h7e="Clear";this.hEb=null;this.Qjk=b;this.ue=h;
this.Dx=u;this.Bca=v.AFrameworkApplication.Bca;this.$s=v.AFrameworkApplication.$s}h1a(){}Sqk(b,h){this.h1a(b);const u=this.y3h(b),B=u.length;if(!(0>=B)){var Q=QA.zfn,ca=null;for(let rb=0;rb<B;rb++){var qa=u[rb],Qa=this.Dx.Lem(qa);Q!==Qa&&(Q=Object.assign(new wh.a,{Id:"msMoreTableStyles"+Qa,Title:this.Mem(Qa),ControlList:[]}),ca=Object.assign(new Ej.a,{Type:6,Id:"galleryMoreTableStyles"+Qa,ExternalGalleryId:"TableStylesGallery",Width:wq.tig,ElementDimensions:"Size64by48",GalleryItems:[]}),this.hEb&&
(ca.ExternalId=this.hEb[Qa.toString()]),Q.ControlList.push(ca),h.MenuSectionList.push(Q),Q=Qa);Qa=this.ue.qR(qa);qa=wq.Hjg+rb;Qa=Object.assign(new my,{Id:qa,ExternalId:qa,Command:Ob.a.Jma.toString(),QueryCommand:Ob.a.SSa.toString(),LabelText:Qa?F.a.vf(Qa):"",Alt:Qa,VerticalCenterAlign:"true"});Qa.TableCellStyles=this.ITd(qa,b);Qa.TableStyles=this.gRc(qa,b);ca&&ca.GalleryItems.push(Qa)}}}Rqk(b){const h=Object.assign(new wh.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),u=Object.assign(new yg.a,{Id:"fseaClearTableFormatting",Command:Ob.a.RBb.toString(),LabelText:F.a.vf(this.h7e),Alt:F.a.vf(this.h7e),Image16by16:this.$s,Image16by16Class:ze.getImageClassWithCluster(this.Bca,wq.xXk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(u);b.MenuSectionList.push(h)}GKh(b,h){this.h1a(h);const u=b[gg.a.SourceControlId];var B=this.USb(u,h);if(B){var Q=this.Dx.kF(h);Q=Q?this.ue.wg(Q):null;var ca=this.ue.qR(B);B=this.ue.wg(B);b[oh.a.Alt]=
ca;b[oh.a.On]=B===Q;h=Object.assign(new my,{Id:u,ExternalId:u,Command:Ob.a.Jma.toString(),QueryCommand:Ob.a.SSa.toString(),TableCellStyles:this.ITd(u,h),TableStyles:this.gRc(u,h),Alt:ca});b[oh.a.GalleryButtonProps]=h}else b[oh.a.InnerHTML]=null,b[oh.a.Alt]=null,b[oh.a.On]=!1,b[oh.a.GalleryButtonProps]=null}ITd(b,h){this.h1a(h);return(b=this.USb(b,h))?this.Qjk.W4h(b,h):null}gRc(b,h){this.h1a(h);return this.USb(b,h),null}jal(b,h){b.MenuItems=this.g3l(h)}g3l(b){const h=Object.assign(new Rk.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.Sqk(b,h);this.Rqk(h);return h}USb(b,h){return b?b.startsWith(wq.Hjg)?this.cvf(parseInt(b.substr(wq.Hjg.length)),h):this.O4n(parseInt(b.substr(wq.dFo.length)),h):null}}wq.Hjg="buttonTableStyleMenu";wq.dFo="buttonTableStyleRibbon";wq.tig=7;wq.xXk="ClearTableStyle_16x16x32";Object(m.a)(wq,"ATableStyleRibbonControl",null,[343]);class ny extends wq{constructor(b,h,u){super(null,h,u);this.ihh=b}GKh(b,h){this.h1a(h);const u=b[gg.a.SourceControlId];var B=this.USb(u,h);if(B){var Q=
this.Dx.kF(h);Q=Q?this.ue.wg(Q):null;var ca=this.ue.qR(B);B=this.ue.wg(B);b[oh.a.Alt]=ca;b[oh.a.On]=B===Q;h=Object.assign(new my,{Id:u,ExternalId:u,Command:Ob.a.Jma.toString(),QueryCommand:Ob.a.SSa.toString(),TableCellStyles:this.ITd(u,h),TableStyles:this.gRc(u,h),Alt:ca});b[oh.a.GalleryButtonProps]=h}else b[oh.a.InnerHTML]=null,b[oh.a.Alt]=null,b[oh.a.On]=!1,b[oh.a.GalleryButtonProps]=null}ITd(b,h){this.h1a(h);return(b=this.USb(b,h))?this.ihh.W4h(b,h,5,5):null}gRc(b,h){this.h1a(h);return this.USb(b,
h),null}}Object(m.a)(ny,"ATableStyleRibbonControlVariableSizePreviews",wq,[]);var ko=c(1469),xD=c(1113);class vu{constructor(b,h,u,B){this.ANl=(Q,ca)=>this.getBorder(Q,this.o2.KM(ca));this.zNl=(Q,ca)=>this.getBorder(Q,this.o2.bP(ca));this.nz=b;this.uy=h;this.ezb=u;this.o2=B;this.TVj=new hg.a(()=>this.yNl());this.g$a=new hg.a(()=>this.xNl())}yNl(){const b={},h=v.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}xNl(){const b={};b[Yh.a.hDa]=Yh.a.$eb;b[Yh.a.$eb]=Yh.a.$eb;b[Yh.a.r_a]=Yh.a.r_a;return b}i8k(b,h,u,B){const Q=new xD.a;Q.rowCount=u;Q.Ffb=B;Q.vUa=this.ezb.Sdm(b);Q.Ja=b.ja(Jc.a.Ja,1);Q.Ia=b.ja(Jc.a.Ia,1);Q.tableLook=h;Q.uke=1;return Q}W4h(b,h,u,B){if(!this.nz.wg(b)||!Object(Cb.a)(112,b)||!Object(Cb.a)(Pp.a,h))return null;const Q=this.uy.i0(h);u=this.i8k(b,Q,u,B);B=[];for(u.rowIndex=0;u.rowIndex<u.rowCount;u.rowIndex++)this.Xsk(b,
h,u,B);return B}gRc(){return null}Xha(){}Xsk(b,h,u,B){u.Gac=!u.rowIndex;for(u.cellIndex=0;u.cellIndex<u.Ffb;u.cellIndex++)this.upk(b,h,u,B)}upk(b,h,u,B){h=this.ezb.q1k(u,this.ezb.Tnf(u),h,b);const Q={};var ca=this.uy.Inf(b,h,Xe.a.fontColor,!0,Kl.a.cL(),"None");Q.color=ca?ca:"inherit";ca=this.uy.Inf(b,h,Xe.a.QK,!0,Kl.a.cL(),"None");Q["background-color"]=ca?ca:"inherit";this.ytk(u,b,h,Q);B.push(Q)}ytk(b,h,u,B){b=this.ezb.vPa(b);this.BAd(5,b,h,u,B);this.BAd(3,b,h,u,B);this.BAd(0,b,h,u,B);this.BAd(4,
b,h,u,B)}BAd(b,h,u,B,Q){h=this.yUl(b,h,u,B);h!==Yh.a.hG&&(Q[this.TVj.value[ko.a[b]]]=h)}yUl(b,h,u,B){let Q=Yh.a.hG;if(({Sma:Q}=this.iJa(B,b,1,h,this.zNl,Q)).returnValue)return Q;({Sma:Q}=this.iJa(u,b,3,h,this.ANl,Q));return Q}iJa(b,h,u,B,Q,ca){return this.o2.voj(u,h,B)&&(ca=Q(b,h))!==Yh.a.hG||!h&&({Sma:ca}=this.iJa(b,1,u,B,Q,ca)).returnValue||4===h&&({Sma:ca}=this.iJa(b,2,u,B,Q,ca)).returnValue?{returnValue:!0,Sma:ca}:{returnValue:ca!==Yh.a.hG,Sma:ca}}getBorder(b,h){let u="",B,Q;({borderStyle:B,borderWidth:Q}=
this.CNl(b,h));if(B===Yh.a.r_a)return u;u=String.format(Yh.a.oDd,Q,B,this.uPd(b,h));return u.trim()}uPd(b,h){if(!h)return Yh.a.D_;b=this.uy.iNc(b,h.color,zl.a.auto);return b!==zl.a.auto?zl.a.aF(b):Yh.a.D_}CNl(b,h){var u=Yh.a.Oua;let B=Yh.a.iG+Yh.a.n3b;if(!h)return{borderStyle:u,borderWidth:B};u=this.uy.iNc(b,h.style,Yh.a.r_a);b=this.uy.iNc(b,h.size,Yh.a.iG);B=this.BNl(u,b)+Yh.a.n3b;u=this.sNl(u);return{borderStyle:u,borderWidth:B}}BNl(b,h){let u=2;b===Yh.a.k3b&&h<Yh.a.Rma&&(u=1);return u}sNl(b){return this.g$a.value[b]||
Yh.a.l3b}static Pem(){return new vu(Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"),rq.a.instance,Yh.a.instance)}static get instance(){return null!=vu.pAg?vu.pAg:vu.pAg=vu.Pem()}}Object(m.a)(vu,"TableStylePreviewGenerator",null,[344]);var Hw;(function(b){b[b.scp=0]="background1";b[b.Qqp=1]="text1";b[b.tcp=2]="background2";b[b.Rqp=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.Qgp=11]="followedHyperlink";b[b.iep=12]="dark1";b[b.Jjp=13]="light1";b[b.jep=14]="dark2";b[b.Kjp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Hw||(Hw={}));Object(m.b)("ThemeColor",Hw);class Tv{constructor(b){this.OYb=b}xLl(b,h,u){let B;({y5i:h,tvh:B}=this.M9l(h));b=[];const Q=[];for(let qa=0;16>qa;qa++){if(!(Hw[qa]in u.ozb))continue;const Qa=qa,rb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[B[Qa]],this.U_l(qa));var ca=h[Qa];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;Q.push(Object.assign(new gr.a,{Color:Qa.toString(),DisplayColor:"#"+F.a.dJ(ca,6),Alt:F.a.vf(rb)}));b[b.length]=qa}return{returnValue:Q,jHo:b}}U_l(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}M9l(b){let h=null,u=null;b=this.OYb(b);if(!b)return{y5i:h,tvh:u};h=b.properties.ja(Jc.a.Kqb,null);u=b.properties.getValue(Jc.a.gle).split(" ");return{y5i:h,tvh:u}}static Rem(){return new Tv(Object(z.a)(Tv.ai,Tv.ai.ru,"navigateToPageContentNode"))}static get ai(){return Zo.PageNavigator.instance}static get instance(){return null!=
Tv.IAg?Tv.IAg:Tv.IAg=Tv.Rem()}}Object(m.a)(Tv,"TableStyleThemeHelper",null,[365]);var ZB=c(897);class RA{constructor(b,h){this.XTe={};this.ozb={};this.ue=b;this.Dx=h}Ihf(b,h){const u=this.XTe[Hw[h]];return u&&u.length?u:this.pJl(b,h)}h$h(b,h,u){if(h=this.Ihf(h,u))for(b=this.ue.wg(b),u=0;u<h.length;u++)if(this.ue.wg(h[u])===b)return u;return-1}Xha(){this.XTe={};this.ozb={}}pJl(b,h){const u=[];this.ozb={};b=this.Dx.cRc(b);this.fCd(u,this.ozb,0,h,b);this.fCd(u,this.ozb,1,h,b);this.fCd(u,this.ozb,2,h,
b);this.fCd(u,this.ozb,3,h,b);return this.XTe[Hw[h]]=u}fCd(b,h,u,B,Q){const ca=Q.BO;for(let qa=0;qa<ca;qa++){const Qa=Q.mFa(qa);if(3!==this.ue.GG(Qa))continue;const rb=this.Dx.Kem(Qa),Lb=this.Dx.OTd(Qa);h[Hw[Lb]]=!0;rb!==u||Lb!==B&&16!==Lb||this.ue.wg(Qa)===ZB.a.BLb||(b[b.length]=Qa)}}static Aim(){return new RA(Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static Tdl(){return RA.Aim()}}Object(m.a)(RA,"WACTableStyleRibbonList",null,[364]);
class Lt extends ny{constructor(b,h,u,B,Q){super(b,h,u);this.nVb=4;this.Xxd=[];this.nEm=()=>{this.k1b.Xha();this.ihh.Xha()};this.Rjk=Q;this.k1b=B;this.h7e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.TBn()}d8k(b,h){b.MenuItems=this.yIl(h)}TBn(){this.hEb={};this.hEb["0"]="CustomTableStyles";this.hEb["1"]="PlainTableStyles";this.hEb["2"]="GridTableStyles";this.hEb["3"]="ListTableStyles"}yIl(b){const h=Object.assign(new Rk.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.SSm(b))return h;
const u=Object.assign(new wh.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),B=Object.assign(new YB.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Qc.a.Deb.toString(),QueryCommand:Qc.a.WNb.toString(),Width:Lt.kHo});B.Colors=({jHo:this.Xxd}=this.Rjk.xLl(this.Xxd,b,this.k1b)).returnValue;u.ControlList.push(B);h.MenuSectionList.push(u);return h}h1a(b){if(b=this.Dx.kF(b))b=this.Dx.OTd(b),16!==b&&(this.nVb=b)}y3h(b){return this.k1b.Ihf(b,this.nVb)}cvf(b,
h){h=this.k1b.Ihf(h,this.nVb);return 0>b||b>=h.length?null:h[b]}O4n(b,h){var u=this.Dx.kF(h);u=this.k1b.h$h(u,h,this.nVb);u=-1!==u?Math.floor(u/wq.tig)*wq.tig:0;return this.cvf(u+b,h)}Mem(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}SSm(b){this.h1a(b);
return 0>=this.y3h(b).length}PXo(b,h){if(!b||!h)return null;b=parseInt(b[ka.Color]);var u=this.Dx.kF(h);const B=this.Dx.OTd(u);if(B===b)return null;if(16===B)return this.nVb=b,null;u=this.k1b.h$h(u,h,B);this.nVb=b;return this.cvf(u,h)}gll(b){b=this.Dx.kF(b);b=this.Dx.OTd(b);if(16!==b)for(let h=0;h<this.Xxd.length;h++)if(this.Xxd[h]===b)return h;return-1}qAb(b){b.rYe(this.nEm,2)}static Qem(){return new Lt(vu.instance,Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"),
RA.Tdl(),Tv.instance)}static get instance(){return null!=Lt.mBg?Lt.mBg:Lt.mBg=Lt.Qem()}}Lt.kHo=4;Object(m.a)(Lt,"TableStyleRibbonControls",ny,[342,343]);var zC=c(1567);class Mt extends yo{constructor(b,h,u,B,Q,ca,qa,Qa){super(b,h,u,B,Q,ca,qa,Qa);this.Ghc=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:rb}=this.Mpb(Lb,Yb,Fc,!1,!0)).returnValue)return rb;this.Jjg.d8k(Fc,Lb.node);return 32};this.Deb=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:rb}=this.Mpb(Lb,Yb,Fc,!1,!0)).returnValue)return 2==Yb&&8==rb&&Yq.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],pe.a.Zyl),rb;const Sc=Lb.node,ld=this.Jjg.PXo(Fc,Sc);ld&&this.M9d(Sc,()=>{this.Azd.XPb(ld,Sc)});return 32};this.WNb=(rb,Lb,Yb,gc,Fc)=>{if(!({xy:rb}=this.Mpb(Lb,Yb,Fc,!0,!0)).returnValue)return rb;Fc[ka.IndexColorSelected]=this.Jjg.gll(Lb.node);return 32}}yic(b){super.yic(b);this.ga.ra(Qc.a.Deb,vc.a.view,this.Ake);this.ga.ra(Qc.a.Deb,vc.a.table,this.Deb);this.ga.Xc(Qc.a.Deb,1030);this.ga.ra(Qc.a.Ghc,vc.a.view,b);this.ga.ra(Qc.a.Ghc,vc.a.table,this.Ghc);this.ga.Xc(Qc.a.Ghc,
1126);this.ga.ra(Qc.a.WNb,vc.a.view,b);this.ga.ra(Qc.a.WNb,vc.a.table,this.WNb);this.ga.Xc(Qc.a.WNb,1127)}get Jjg(){return this.Cxd}static Jem(){return new Mt(Ga.a.instance.resolve("WordEditor.IWACTableStyleReader"),Lt.instance,v.AFrameworkApplication.va,zC.a.instance,new $k.a,Ga.a.instance.resolve("Box4.IInsertionPointFormatting"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(ti.a.instance,ti.a.instance.mlb,"isTableNodeInLockedRange"))}static get instance(){return null!=
Mt.wAg?Mt.wAg:Mt.wAg=Mt.Jem()}}Object(m.a)(Mt,"TableStyleActor",yo,[]);class oy{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}wc(b){this.W=b;this.W.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>vu.instance).ha();this.W.ia("Box4.TableEditors.IWACTableStyleEditor",()=>zC.a.instance).ha()}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}sn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(Mt.instance.Tb(),Lt.instance.qAb(yw.a.instance),
Fb.App.za.updateCommandUI())}dispose(){}}Object(m.a)(oy,"TableStylePackage",null,[1,2]);var py=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",
Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",
PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",
Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",
MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",
attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},nk=c(1463);class AC{constructor(b,h){this.tLa=b;this.OAa=h}xUn(b){this.tLa.iBd(b)}EDa(b){this.OAa.EDa(b)}oQb(b,h){return this.OAa.oQb(b,h)}nQb(b,h){return this.OAa.nQb(b,h)}Wle(b,h,u){this.OAa.Wle(b,h,u)}}Object(m.a)(AC,
"ClientPaginationHeaderFooterBridge",null,[424]);class SA{constructor(b,h){this.gm=b;this.ga=h;this.Kaa=new Hn.a;this.Laa=new Hn.a}EDa(b){b=vd.GraphIterator.eb(b);if(b.gp()&&b.Qp()){b.Qd();do 10===b.Ue&&this.j0f(b.currentNode),b.Gt();while(8!==b.Ue)}}oQb(b,h){var u=this.yGb(h);if(!this.Kaa.nb(u))return r.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+u),!1;h=this.Kaa.J(u);r.ULS.shipAssertTag(573400389,336,this.Laa.nb(u),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
u=this.Laa.J(u);return this.Zxf(h,b,u)}nQb(b,h){var u=this.yGb(h);if(!this.Kaa.nb(u))return r.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+u),!1;h=this.Kaa.J(u);r.ULS.shipAssertTag(573400391,336,this.Laa.nb(u),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");u=this.Laa.J(u);return this.Tkf(h,b,u)}Wle(b,h,u){h=this.buf(h,u);this.ga.Rb(b?Qc.a.toe:Qc.a.qdd,
2,h)}buf(b,h){h=this.gm.EFb(h);if(!h)return r.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.gm.Kha(h);const u=1===b;b=!(b%2);return 1===h?1:2===h?u?2:1:3===h?b?3:4:u?2:b?3:4}j0f(b){if(10===b.type){var h=new Hn.a,u=this.gm.EFb(b);r.ULS.shipAssertTag(573400393,336,!!u,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var B=this.gm.Kha(u);b=this.yGb(b);this.Log(b,B);this.Kog(b,
h);u=vd.GraphIterator.eb(u);if(u.Qp()){u.Qd();do b=u.currentNode,B=this.gm.UPc(b),b=this.gm.Nmi(b),h.add(B,b),u.Gt();while(36===u.Ue)}}}Log(b,h){this.Laa.nb(b)?this.Laa.Z(b,h):this.Laa.add(b,h)}Kog(b,h){this.Kaa.nb(b)?this.Kaa.Z(b,h):this.Kaa.add(b,h)}yGb(b){r.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ja(Jc.a.Fja,0)}Zxf(b,h,u){const B=1===h;h=!(h%2);switch(u){case 2:if(B){if(b.nb(2))return b.J(2)}else if(b.nb(0))return b.J(0);
break;case 3:if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 4:if(B){if(b.nb(2))return b.J(2)}else if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 1:if(b.nb(0))return b.J(0)}return!1}Tkf(b,h,u){const B=1===h;h=!(h%2);switch(u){case 2:if(B){if(b.nb(5))return b.J(5)}else if(b.nb(3))return b.J(3);break;case 3:if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 4:if(B){if(b.nb(5))return b.J(5)}else if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);
break;case 1:if(b.nb(3))return b.J(3)}return!1}}Object(m.a)(SA,"ClientPaginationPageAdornmentContentManager",null,[423]);class Uy{constructor(b,h,u,B,Q,ca){this.l2k=qa=>{1===qa&&this.vE.BE&&(qa=this.Zc.qoa(this.vE.BE,8,8),this.gm.NQk(qa)?this.Jil(qa):this.kto())};this.LOo=qa=>{1===qa&&this.ga.Rb(Ob.a.openInClient,2,!1)};this.vE=b;this.gm=h;this.Zc=u;this.Kc=B;this.wvc=Q;this.ga=ca}zto(){const b=new mg.StandardDialog;b.Cd=1;b.xe(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.rV(0);b.pv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.l2k)}Jil(b){b.ld(8);const h=this.Kc.Pc(15);h.set(b.Cn.tj);this.wvc.JWn(b);this.vE.dismiss();h.dispose();r.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}kto(){const b=new mg.StandardDialog;b.Cd=1;b.xe(1,Box4Intl.Box4Strings.L_OpenInWord);b.xe(0,CommonUIStrings.l_Close);b.rV(0);b.pv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.LOo);r.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(m.a)(Uy,"DeleteHeaderFooterDialog",null,[]);class Vy{constructor(b,h,u,B,Q){this.gm=b;this.Zc=h;this.Kc=u;this.wvc=B;this.ga=Q}create(b){return new Uy(b,this.gm,this.Zc,this.Kc,this.wvc,this.ga)}}Object(m.a)(Vy,"DeleteHeaderFooterDialogFactory",null,[422]);class Gn{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.saa=null;this.slg=(Yb,gc,Fc,Sc,ld)=>{var Hd=this.gvf(gc);return Hd?1===Fc?32:(Fc=this.control)?
(gc=this.Kc.Pc(15),gc.Db(Hd),gc.Qj=Yb,Fc.Xba?this.ga.processAction(Qc.a.ZT,2):(Hd=this.pWh(Hd),Sc.As=Hd?1:0,Sc=Yb!==Qc.a.qdd,(Yb=this.Rpf(Yb,ld))&&Fc.nza(Yb),this.ga.Rb(Qc.a.zKd,2,Sc)),gc.dispose(),32):8:8};this.Ycf=(Yb,gc,Fc)=>{if(1===Fc)return 32;this.JZj.create(this.control).zto();return 32};this.nJn=(Yb,gc,Fc,Sc,ld)=>1===Fc?32:(Yb=this.control)?(ld[gg.a.On]=Yb.Xba,32):8;this.Dpb=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc||!this.control.Xba)return 32;gc=this.w9h(Yb,ld);Fc=Gn.Wii(this.control.BE);Sc=this.Kc.Pc(15);
Sc.Db(Fc);Sc.Qj=Yb;Yb=this.Zc.yk();Yb.set(Fc);this.uLa.Ghf(Yb.currentNode,gc);this.gm.mLb(Yb);this.wvc.bmj(Yb,gc);Sc.dispose();return 32};this.nza=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc)return 32;Yb=this.Rpf(Yb,ld);this.control.Xba&&this.control.nza(Yb);return 32};this.rfe=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc)return 32;Yb=this.lfi(Yb,ld);Sc.As=Yb;gc=this.gvf(gc);if(!gc)return 8;Sc=this.Zc.yk();Sc.set(gc);Sc.zb(8);Sc.ot(8);if(!this.Sk.Vcn(Sc,Yb))return 8;this.gm.mLb(Sc);this.control.cha(Sc.currentNode);return 32};this.k0f=
(Yb,gc,Fc,Sc,ld)=>{if(1===Fc)return 32;Yb=this.Ykk.scl(this.gvf(gc));ld.PopulationXML=Yb;return 32};this.gbe=(Yb,gc,Fc,Sc,ld)=>{Yb=this.w9h(Yb,ld);gc=this.control.BE;Fc=this.gm.Kha(gc);ld[gg.a.On]=Yb===Fc;1===Yb&&(ld[gg.a.LabelText]=this.Zji(gc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.lae=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc||!this.control.Xba)return 32;gc=this.control.BE;void 0!==gc&&null!==gc&&(gc=this.gm.Kha(gc),
Yb=this.Rpf(Yb,ld),Fc=this.control.pVb,ld[gg.a.Visible]=this.lGo(Yb,gc),ld[gg.a.On]=Yb===Fc);return 32};this.CJn=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc||!this.control.Xba)return 32;Yb=this.control.BE;void 0!==Yb&&null!==Yb&&this.nCn(Yb,ld);return 32};this.NIn=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc||!this.control.Xba)return 32;Yb=this.lfi(Yb,ld);gc=this.control.BE;Fc=0;void 0!==gc&&null!==gc&&(Fc=gc.getValue(Jc.a.Fja));ld[gg.a.On]=Yb===Fc;return 32};this.ZT=(Yb,gc,Fc)=>{if(1===Fc)return 32;this.control.dismiss();return 32};
this.CVd=()=>32;this.zKd=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc)return 32;this.control.show(ld);return 32};this.Hlb=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc)return 32;if(!ld)return 8;gc=ld.e0a;if(!gc||!gc.isConnected)return 8;Yb=this.gm.g0c(gc);if(!({isHeader:Fc,skg:gc}=this.gm.rhi(gc)).returnValue)return 8;this.control.cha(Yb);this.control.nza(gc);this.control.show(Fc,ld.qhe);return 32};this.ga=b;this.gm=h;this.wvc=u;this.uLa=B;this.Sk=Q;this.Zc=ca;this.Kc=qa;this.Ykk=Qa;this.i3j=rb;this.JZj=Lb}get control(){return this.saa}set control(b){this.saa=
b}Tb(){this.ga.ra(Qc.a.$Wd,vc.a.view,this.slg);this.ga.fb(Qc.a.i3f,vc.a.application,this.nJn,96);this.ga.ra(Qc.a.toe,vc.a.view,this.slg);this.ga.ra(Qc.a.qdd,vc.a.view,this.slg);this.ga.fb(Qc.a.CVd,vc.a.view,this.CVd,64);this.ga.ra(Qc.a.zKd,vc.a.view,this.zKd);this.ga.fb(Qc.a.ZT,vc.a.application,this.ZT,96);this.ga.fb(Qc.a.Hlb,vc.a.application,this.Hlb,96);this.ga.fb(Qc.a.qdo,vc.a.view,this.nza,96);this.ga.ra(Qc.a.oij,vc.a.view,this.nza);this.ga.ra(Qc.a.qij,vc.a.view,this.nza);this.ga.ra(Qc.a.pij,
vc.a.view,this.nza);this.ga.ra(Qc.a.rij,vc.a.view,this.nza);this.ga.fb(Qc.a.Lgo,vc.a.view,this.Dpb,100);this.ga.fb(Qc.a.$jj,vc.a.view,this.Dpb,4);this.ga.fb(Qc.a.Zjj,vc.a.view,this.Dpb,4);this.ga.fb(Qc.a.Xjj,vc.a.view,this.Dpb,4);this.ga.fb(Qc.a.Yjj,vc.a.view,this.Dpb,4);this.ga.ra(Qc.a.rfe,vc.a.view,this.rfe);this.ga.ra(Qc.a.rbg,vc.a.view,this.rfe);this.ga.fb(Qc.a.k0f,vc.a.view,this.k0f,96);this.ga.fb(Qc.a.Ycf,vc.a.view,this.Ycf,4);this.ga.fb(Qc.a.I3i,vc.a.view,this.lae,97);this.ga.fb(Qc.a.K3i,vc.a.view,
this.lae,97);this.ga.fb(Qc.a.J3i,vc.a.view,this.lae,97);this.ga.fb(Qc.a.L3i,vc.a.view,this.lae,97);this.ga.fb(Qc.a.a4i,vc.a.view,this.gbe,97);this.ga.fb(Qc.a.$3i,vc.a.view,this.gbe,97);this.ga.fb(Qc.a.Y3i,vc.a.view,this.gbe,97);this.ga.fb(Qc.a.Z3i,vc.a.view,this.gbe,97);this.ga.fb(Qc.a.hJn,vc.a.view,this.CJn,97);this.ga.fb(Qc.a.F2f,vc.a.view,this.NIn,97)}pWh(b){const h=this.gm.EFb(b),u=this.gm.Kha(h);b=this.uLa.Ghf(b,u);this.control.cha(h);return b}w9h(b,h){switch(b){case Qc.a.$jj:case Qc.a.a4i:b=
1;break;case Qc.a.Zjj:case Qc.a.$3i:b=2;break;case Qc.a.Xjj:case Qc.a.Y3i:b=3;break;case Qc.a.Yjj:case Qc.a.Z3i:b=4;break;default:b=h}return b}Rpf(b,h){switch(b){case Qc.a.oij:case Qc.a.I3i:b=1;break;case Qc.a.qij:case Qc.a.K3i:b=2;break;case Qc.a.pij:case Qc.a.J3i:b=3;break;case Qc.a.rij:case Qc.a.L3i:b=4;break;case Qc.a.toe:case Qc.a.qdd:b=h;break;case Qc.a.$Wd:b=0;break;default:b=h}return b}lfi(b,h){return b===Qc.a.rbg||b===Qc.a.F2f?parseInt(h.MenuItemId):h}gvf(b){return this.Sk.W8(b.ek)}lGo(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}nCn(b,h){const u=this.Zji(b);if(h[wj.a.Visible]=u)b=this.Sk.Xii(this.i3j(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[wj.a.LabelText]=b}Zji(b){const h=this.Zc.yk();h.set(b);h.zb(8);h.ot(8);return 1<this.Sk.zuf(h)}static Wii(b){const h=new vd.GraphIterator;h.set(b);h.zb(10);return Wq.WordSectionNavigator.f6n(h)}}Object(m.a)(Gn,
"HeaderFooterActor",null,[]);var TA=c(799),qy=c(710);class Iw{constructor(b,h,u,B,Q){this.fak=b;this.gm=h;this.Sk=u;this.Zc=B;this.ga=Q}cWh(b,h){this.gm.mLb(b);h=this.Kul(b,h);b.rc();return h}Ghf(b,h){b=this.Zc.qoa(b,8,8);let u=!1;this.Sk.iPa(b,B=>{const Q=this.Zc.yk();Q.set(B);u=(B=this.cWh(Q,h))||u;return B});return u}Kul(b,h){if(3!==this.ga.mode)return!1;let u=!1;h=qy.a.Ldf(h);for(let B=0;B<h.length;++B)u=this.fak.Jul(b,h[B])||u;return u}}Iw.mhl=1;Object(m.a)(Iw,"HeaderFooterInserter",null,[415]);
class Mj{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.reh=this.nRg=!1;this.BE=null;this.dFe=!1;this.pVb=0;this.SLb=()=>{this.dFe=!0};this.E6=b;b.bind(this);this.dWe=B;this.i_j=rb;this.$7g=Q;this.Wak=ca;this.Sab=qa;this.header=h;this.footer=u;this.header.xdl();this.E6.Pz();this.jUe=Iw.mhl;this.uLa=Qa;Mj.ga=Lb;this.NN=Yb}get Xba(){return this.nRg}show(b=!0,h=!0){this.Xba||(this.tGj(),this.vjj(!0),this.header.LRn(),this.i_j(),this.fAo(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.zpa&&
(ah.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new TA.a,{state:0,disablePopover:!0}))):r.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.reh=h)&&this.$7g(b)}dismiss(b=!1){this.Xba&&(this.Wak(b),this.vjj(!1),this.uDb(),this.pVb=0,this.oBo(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.zpa&&(ah.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new TA.a,{disablePopover:!1}))):r.ULS.sendTraceTag(509384031,
3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}vjj(b){this.nRg=b;Mj.ga.processAction(Ob.a.plf,2);this.E6.t1(b);this.header.t1(b);this.footer.t1(b);this.dWe()}cha(b){this.BE!==b&&(this.BE=b,this.header.cha(b),this.footer.cha(b),this.pVb=0,this.Dpb(this.Sab.Kha(b)))}uDb(){this.BE&&(this.header.Egb(),this.footer.Egb(),this.BE=null)}update(){this.Xba&&this.mSb()}mSb(){this.BE&&(this.Sab.kql(this.BE)&&this.Sab.vrm(this.BE)?this.tGj():this.dismiss())}tGj(){const b=this.Sab.Kha(this.BE);
b!==this.jUe&&this.Dpb(b)}Dpb(b){this.jUe=b;this.nza(this.nfm(b))}nfm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}nza(b,h=!0){this.pVb!==b&&(this.uLa.Ghf(this.BE,this.jUe),this.header.nij(b),this.header.Iuh(Zj.AppFrame.yca),this.footer.nij(b),this.footer.Iuh(Zj.AppFrame.fca),this.pVb=b,this.Xba&&this.reh&&this.svl(h))}svl(b){this.$7g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.E6.R$();this.header.dispose();this.footer.dispose()}fAo(){this.NN.rFc(this.SLb);
this.dFe=!1}oBo(){this.NN.Rce(this.SLb);this.dFe&&Mj.ga.processAction(Qc.a.CVd,2)}static onl(){Mj.ga.Rb(Za.a.zjb,2,!0);Mj.ga.processAction(Qc.a.d4,2)}}Mj.ga=null;Object(m.a)(Mj,"HeaderFooterControl",null,[452,10]);class Ni{constructor(b,h,u,B,Q){this.dWe=b;this.Sab=h;this.uLa=u;this.ga=B;this.NN=Q}create(b,h,u,B,Q){return new Mj(b,h,u,this.dWe,B,Q,this.Sab,this.uLa,Mj.onl,this.ga,this.NN)}}Object(m.a)(Ni,"Factory",null,[421]);class t{constructor(){this.saa=null}get control(){return this.saa}set control(b){this.saa=
b}amf(b){return this.bmf(this.control.BE,this.control.pVb,b.isHeader,b)}bmf(b,h,u,B){return()=>{if(!b.isConnected)return null;this.control.cha(b);this.control.nza(h);this.control.show(u);return B}}dismiss(){this.saa.Xba&&this.saa.dismiss()}}Object(m.a)(t,"HeaderFooterControlLauncher",null,[]);var C=c(1163),U=c(656),ma=c(249),Pa=c(821);class kb{constructor(b,h,u){this.jnc=null;const B=h?"Header":"Footer";this.Kr=b.ownerDocument.createElement("div");this.Kr.id=h?"HeaderPane":"FooterPane";this.Kr.classList.add(kb.yrm,
B);this.Ozb=(new Pa.a(this.Kr,"WACViewPanel_"+B)).pI;this.Kr.appendChild(this.Ozb);b.appendChild(this.Kr);h&&(this.jnc=b.ownerDocument.createElement("div"),this.jnc.classList.add(kb.Drm),this.Kr.appendChild(this.jnc));this.aKg=u.o6l(this.Kr)}bind(){}t1(b){b?this.aKg.zAk():this.aKg.BAk()}OIk(b){b.XAb(this.Ozb)}}kb.Drm="HeaderToolbarContainer";kb.yrm="HeaderFooterPane";Object(m.a)(kb,"PaneControlDom",null,[467]);class Tb{constructor(b,h,u,B,Q){this.vE=this.Qq=null;this.aVi=()=>{this.vE.dismiss(!0);
if(this.qWb){const ca=new ex.a(!0);this.qWb.IHa(ca)}return!0};this.YB=ca=>{ca.Hb.preventDefault();return!1};this.Kr=b.ownerDocument.createElement("div");this.Kr.id=Tb.XHh;this.Kr.className=Tb.XHh;this.a_=B;this.qWb=Q;this.Lmi=new kb(this.Kr,!0,h);this.gbl(this.Kr);this.L0h=new kb(this.Kr,!1,h);this.t1(!1);b.appendChild(this.Kr)}gbl(b){this.Qq=b.ownerDocument.createElement("div");this.Qq.id=Tb.Xvn;this.Qq.className=Tb.Vvn;this.Qq.tabIndex=0;this.Qq.setAttribute(af.a.oh,af.a.L3);this.Qq.setAttribute(af.a.kga,
WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Qq)}bind(b){this.vE=b}t1(b){if(!b&&this.a_){var h=new ex.a(!0);this.a_.IHa(h)}!b&&this.qWb&&(h=new ex.a(!0),this.qWb.IHa(h));this.Kr.style.display=b?"":"none";this.Lmi.t1(b);this.L0h.t1(b)}ego(){this.Qq.focus()}Pz(){Wi.a.instance.ob(Kd.a.click,this.Qq,this.aVi);vf.a.instance.ob(Kd.a.Vx,this.Kr,this.YB)}R$(){Wi.a.instance.sc(Kd.a.click,this.Qq,this.aVi);vf.a.instance.sc(Kd.a.Vx,this.Kr,this.YB)}}Tb.XHh="HeaderFooterControl";
Tb.Xvn="HeaderFooterOverlay";Tb.Vvn="EditingSurfaceOverlay HeaderFooterOverlay";Object(m.a)(Tb,"HeaderFooterControlDom",null,[451]);class yc{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.E6=null;this.sa=new Nc.a;this.vE=this.mvd=null;this.sVf=Yb=>{this.u$(Yb);this.sa.raiseEvent("OnShowEventKey")};this.rVf=Yb=>{this.zk&&(this.mvd=new C.a(this.zk));this.Vb.yKc(Zj.AppFrame.yca);this.Vb.yKc(Zj.AppFrame.fca);this.$da(Yb);this.sa.raiseEvent("OnDismissEventKey")};this.Z8d=()=>{this.mvd&&(this.mvd.dispose(),
this.mvd=null)};this.Vb=b;this.hp=h;this.N9g=u;this.K3j=B;this.Ock=Q;this.ga=ca;this.LOg=U.a.create();this.MSg=Nb.KeyInputManager.ic(Se.a.Ls,0);this.QZ=Nb.KeyInputManager.ic(Se.a.a2,0);this.Pik=Nb.KeyInputManager.ic(Se.a.zJa,0);this.fM=qa;this.Ga=Qa;this.a_=rb;this.qWb=Lb;this.zk&&this.zk.Cma(this.Z8d)}Lph(b){this.sa.addHandler("OnShowEventKey",b)}o_n(b){this.sa.removeHandler("OnShowEventKey",b)}iBd(b){this.sa.addHandler("OnDismissEventKey",b)}U$i(b){this.sa.removeHandler("OnDismissEventKey",b)}get zk(){const b=
this.fM.value;return b?b.Vi?b:(r.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(r.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.vE}get G4k(){return this.LOg}bind(b){this.vE=this.N2k(b);this.LOg.instance=this.vE}N2k(b){this.E6=new Tb(b,this.Ock.value,this.Ga,this.a_,this.qWb);b=this.N9g.value.create(this.ga,this.E6.Lmi,!0,Zj.AppFrame.yca);const h=this.N9g.value.create(this.ga,
this.E6.L0h,!1,Zj.AppFrame.fca);this.vE=this.K3j.value.create(this.E6,b,h,this.sVf,this.rVf);this.nAf();this.wT();return this.control}nAf(){var b=3===this.ga.mode?Zj.AppFrame.PD:Zj.AppFrame.tic;const h=this.Vb.ae(Zj.AppFrame.yca);h.parent=b;this.Vb.EYe(Zj.AppFrame.yca);const u=this.Vb.ae(Zj.AppFrame.fca);u.parent=b;this.Vb.EYe(Zj.AppFrame.fca);b=this.Vb.ae(ma.a.oHb);b.parent=$d.AFrame.xp;b.cga(()=>{this.E6.ego()});b.bindAction(this.MSg,Qc.a.ZT);b.bindAction(this.QZ,Qc.a.ZT);b.bindAction(this.Pik,
Qc.a.ZT);h.bindAction(this.QZ,Qc.a.ZT);u.bindAction(this.QZ,Qc.a.ZT)}wT(){this.hp.wT(Zj.AppFrame.yca);this.hp.wT(ma.a.W2a);this.hp.wT(Zj.AppFrame.fca);this.hp.wT(ma.a.oHb)}u$(b){this.hp.QI(Zj.AppFrame.yca);this.hp.QI(ma.a.W2a);this.hp.QI(Zj.AppFrame.fca);this.hp.QI(ma.a.oHb);this.hp.$w($d.AFrame.Un);this.Vb.PEc(Zj.AppFrame.yca);this.Vb.PEc(Zj.AppFrame.fca);b?this.Vb.kg(Zj.AppFrame.yca):this.Vb.kg(Zj.AppFrame.fca)}$da(b){this.hp.$w(Zj.AppFrame.yca);this.hp.$w(ma.a.W2a);this.hp.$w(Zj.AppFrame.fca);
this.hp.$w(ma.a.oHb);this.hp.QI($d.AFrame.Un);(b||this.Vb.currentScope&&(this.Vb.currentScope.name===Zj.AppFrame.yca||this.Vb.currentScope.name===ma.a.W2a||this.Vb.currentScope.name===Zj.AppFrame.fca||this.Vb.currentScope.name===ma.a.oHb))&&this.Vb.kg($d.AFrame.Un)}dispose(){const b=this.Vb.ae(ma.a.oHb);b.kr(this.MSg);b.kr(this.QZ);this.Vb.ae(Zj.AppFrame.yca).kr(this.QZ);this.Vb.ae(Zj.AppFrame.fca).kr(this.QZ);this.zk&&this.zk.Tce(this.Z8d);this.control.dispose()}}Object(m.a)(yc,"HeaderFooterControlOwner",
null,[419,420]);var Tc=c(1111);class Cd{constructor(b,h,u,B,Q,ca,qa,Qa){this.gba=b;this.Ljk=h;this.Eue=u;this.hm=B;this.pck=Q;this.iik=ca;this.z3j=qa;Cd.mh=Qa}cBm(b,h){this.Ljk(b,1,3,null,!1);this.gba.Oge(ZB.a.BLb,1696,b.currentNode);this.Eue(b,0,this.hm?3:1,h);this.Eue(b,1,2,h);this.Eue(b,2,this.hm?1:3,h);this.pck(b);this.iik(b,!1,!0,null);this.z3j(b,h)}static get qE(){return null!=Cd.dIg?Cd.dIg:Cd.dIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get il(){return null!=Cd.jEg?Cd.jEg:
Cd.jEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static neo(b,h,u){qg.moveToCellContent(b,0,h);gf.OutlineElementNavigator.Ce(b);Cd.qE.X8c(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Cd.il.lE(b.currentNode,u);h||Cd.il.mq.qza(b,1,-115);2===h&&Cd.il.mq.IPb(b.currentNode,1,-115);qg.returnToContainingTable(b)}static Jgo(b,h){gf.OutlineElementNavigator.Ce(b);Cd.qE.X8c(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);gf.OutlineElementNavigator.Wd(b)}static FOl(){return(b,
h,u)=>{Cd.neo(b,h,u)}}static XXl(){return(b,h)=>{Cd.Jgo(b,h)}}static tem(b){return(h,u,B,Q,ca)=>b.UDa(h,u,B,Q,ca)}static kcm(){return(b,h,u,B,Q)=>Cd.mh.Iz(b,h,u,B,Q)}}Cd.mh=null;Object(m.a)(Cd,"HeaderFooterDefaultTableInserter",null,[417]);class ud{constructor(b,h,u,B){this.gm=b;this.jsd=h;this.Zc=u;this.Sk=B}bmj(b,h){b.Cn.properties.setValue(Jc.a.vxf,2===h||4===h);b.zb(8);b.Tcd(8).properties.setValue(Jc.a.kVd,3===h||4===h)}JWn(b){this.Sk.iPa(b,h=>{const u=this.Zc.yk();u.set(h);this.gm.mLb(u);this.bmj(u,
1);this.KWn(u);return!0})}KWn(b){for(;b.Qd();)b.vg()}}Object(m.a)(ud,"HeaderFooterEditor",null,[416]);var Nd=c(1117);class Qe extends pt.a{constructor(b){super();this.fWe=b}get index(){return 0}run(){this.fWe()}urm(b,h){h.property===Jc.a.vxf&&this.ZJ()}rwn(b,h){h.property===Jc.a.kVd&&this.ZJ()}ZJ(){this.IY()}}Object(m.a)(Qe,"ControlUpdateNeededTracker",pt.a,[]);class Gf{constructor(b,h,u,B,Q,ca){this.D$a=null;this.L3j=u;this.Sld=h;this.YWb=b;this.Eck=B;this.pMa=ca}start(){this.YWb.bind(Fb.App.za.pD);
this.Sld.control=this.YWb.control;this.Sld.Tb();this.L3j.control=this.YWb.control;this.Eck.value.create(this.YWb.control,Object(z.a)(this.Sld,this.Sld.pWh,"ensureSectionHeaderFooterAttachedToControl")).Tb();this.Ysm()}Ysm(){this.D$a=new Qe(()=>{this.YWb.control.update()});const b=Fb.App.ni.zl;b.Te(35).Mo(Object(z.a)(this.D$a,this.D$a.urm,"headerFooterContainerNodePropertyChanged"));b.Te(8).Mo(Object(z.a)(this.D$a,this.D$a.rwn,"pageContentNodePropertyChanged"));Nd.a.nce(Object(z.a)(this.D$a,this.D$a.ZJ,
"setUpdateNeeded"));fg.GraphTransactionManager.instance.ara(this.D$a,3)}dispose(){this.YWb.dispose();this.pMa.KRh()}}Object(m.a)(Gf,"HeaderFooterManager",null,[]);class wg{constructor(b,h,u,B){this.Sk=b;this.gm=h;this.eak=u;this.qxe=B}Jul(b,h){let u=!1;const B=qy.a.xrf(h);b.Fs(B)||(this.mBm(b,h),this.qxe.bBm(b.currentNode,h),u=!0);return u}mBm(b,h){const u=this.eak.create(1074135123),B=b.currentNode.ja(Jc.a.Fja,0);u.properties.setValue(Jc.a.Fja,B);u.properties.setValue(Jc.a.bac,h);h=qy.a.xrf(h);b.xf(u,
h)}}Object(m.a)(wg,"HeaderFooterNodeLevelInserter",null,[414]);var Gg=c(226),Mg=c(387);class Ci extends Gg.a{constructor(b,h,u){super(b,h,"","");this.lxb=null;this.Wmi=Ci.JOh;this.ESc=[];this.DCe=u}get $A(){return!0}get cssClass(){return"cui-herodock"}Cm(){this.ERn();super.Cm()}ROa(){for(const b of this.ESc)b.OLd();super.ROa()}$yo(){let b,h,u;b=[];h=[];u=[];for(let B=0;B<this.ESc.length;B++){const Q=this.ESc[B];Q.visible?b.length<this.Wmi?b.push(Q):Object(Cb.a)(Mg.FlyoutAnchor,Q)?Array.addRange(h,
Q.xRl()):h.push(Q):u.push(Q)}return{oJo:b,Tvn:h,uEm:u}}fbl(b){if(!b||!b.length)return null;const h=new Wd.Menu(this.root,this.id+"OverflowMenu",null,null,null),u=new Lh.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const B of b)u.xf(B.YQ("Menu20"));h.xf(u);return h}ERn(){this.Nqa();this.Mc=ig.a.jTa(this.Mc);this.QC();var b;({oJo:u,Tvn:b,uEm:B}=this.$yo());for(var h of u){var u=h.YQ("Medium20");u.enabled=!0;this.H1b(u,this.children.count);
this.Mc.appendChild(u.Mc);u.Una()}if(b=this.fbl(b))this.lxb?this.lxb.menu=b:(h=this.id+"OverflowMenuLauncher",u={},u.Image20by20=this.DCe.OverflowMenuImage20by20,u.Image20by20Class=this.DCe.OverflowMenuImage20by20Class,u.PopulateDynamically="false",u.HideDefaultArrow="true",u.Alt=this.DCe.OverflowMenuTooltip,u.Command="798637440",u.Id=h,this.lxb=new Mg.FlyoutAnchor(this.root,h,u,b)),b=this.lxb.YQ("Small20"),b.enabled=!0,this.H1b(b,this.children.count),this.Mc.appendChild(b.Mc),b.Una();if(v.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const Q of B){var B=
Q.YQ("Medium20");this.xf(B);B.Una()}}dispose(){this.lxb&&(this.lxb.dispose(),this.lxb=null);for(const b of this.ESc)b.dispose();this.Nqa();super.dispose()}set $A(b){super.$A=b}}Ci.JOh=4;Object(m.a)(Ci,"HeroDock",Gg.a,[]);var Cm=c(605);class Sj extends Cm.a{constructor(){super();this.Vje=this.UOm=this.QAo=!1;this.x9m=v.AFrameworkApplication.XEf?1:Ci.JOh}}Object(m.a)(Sj,"ToolbarBuildOptions",Cm.a,[]);var lh=c(44),wu=c(876),Pi=c(718);class xu extends Gg.a{constructor(b,h,u){super(b,h,"","");this.kqc=
u.Alignment;this.VRg=u.ScalingDirection===lh.a.cNj}Cm(){this.cwa();this.gX(this.Mc);super.Cm()}gX(b){for(let h of this.children){h.QC();switch(this.kqc){case lh.a.Zpe:ig.a.Xf(h.Mc,"cui-toolbar-button-left");break;case lh.a.t9a:ig.a.Xf(h.Mc,"cui-toolbar-button-center");break;case lh.a.sTb:ig.a.Xf(h.Mc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.kqc);}h.visible&&b.appendChild(h.Mc);h.Una()}}VO(b){if(!Object(Cb.a)(vr.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.kqc){case lh.a.Zpe:return"cui-toolbar-buttondock alignleft";case lh.a.t9a:return"cui-toolbar-buttondock aligncenter";case lh.a.sTb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.kqc);}}get $A(){return!0}get alignment(){return this.kqc}D$b(){let b=0;if(this.alignment===lh.a.t9a)for(let h of this.children){const u=h;u.visible&&(b+=u.Mc.offsetWidth)}else b=this.Mc.offsetWidth;return b}yTd(){let b=null;if(this.alignment===lh.a.t9a)for(let h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.Mc);break}}else b=Sys.UI.DomElement.getBounds(this.Mc);return b?0===this.root.J1?b.x:b.x+b.width:0}CQd(){let b=null;if(this.alignment===lh.a.t9a){if(0<this.children.count){const h=this.children.dpf(this.children.count-1);for(;h.xmb();){const u=h.get_current();if(u.visible){b=Sys.UI.DomElement.getBounds(u.Mc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Mc);return b?0===this.root.J1?b.x+b.width:b.x:0}Ahf(){for(let b of this.children){const h=b;if(!Object(Cb.a)(vr.a,
h)||h.control.visible)h.visible=!0}}n9n(b){const h=this.children.toArray(),u=new Pi.a;let B=this.VRg?0:h.length-1;const Q=this.children.count,ca=this.root.wUa;for(;this.D$b()>=b&&!(B>=Q||0>B);){const qa=h[B];ca&&Object(Cb.a)(vr.a,qa)&&qa.control.visible&&(u.add(qa),qa.Wsh());B+=this.VRg?1:-1}for(let qa of u)qa.u9i(),qa.visible=!1}set $A(b){super.$A=b}}Object(m.a)(xu,"ButtonDock",Gg.a,[]);class Nt extends el.a{constructor(b,h,u,B,Q,ca,qa=!1){super(b,h,ca);this.Ksa=this.AZ=this.jma=null;this.iKe=!1;
this.u4a=B;this.Vje=Q;this.oyd=0;Le.c(h.Size)||(h.Size===lh.a.Zsg||u.options.UOm?this.oyd=0:h.Size===lh.a.KPj&&(this.oyd=1));this.Zkk=qa}get wUa(){return!0}xf(b){super.xf(b);Object(Cb.a)(xu,b)&&!this.iKe&&(b.alignment===lh.a.Zpe?(this.jma&&this.Jcg(),this.jma=b):b.alignment===lh.a.t9a?(this.AZ&&this.Jcg(),this.AZ=b):b.alignment===lh.a.sTb&&(this.Ksa&&this.Jcg(),this.Ksa=b))}Jcg(){this.iKe=!0;this.Ksa=this.AZ=this.jma=null}lpb(b,h){b=this.lPc(b);Le.c(b)||b.visible===h||(b.visible=h,this.refresh())}Cm(){super.Cm();
this.i7i(!0)}i7i(b){const h=this.root.nCb;Le.c(this.Mc)&&this.ydl();this.Mc=ig.a.jTa(this.Mc);this.FSc&&this.Mc.appendChild(this.FSc);for(let u of this.children)u.visible&&(u.QC(),this.Mc.appendChild(u.Mc),u.Una());this.AZ&&b&&this.gul();h&&h.bZ();this.dirty=!1}gul(){if(this.AZ.visible&&this.AZ.children.count&&(this.hth(0,0),this.jql(this.jma,this.AZ,this.Ksa))){let b=0,h=0;const u=this.jma?this.jma.D$b():0,B=this.Ksa?this.Ksa.D$b():0;if(0<B||0<u)B>u?(b=0,h=B-u):(b=u-B,h=0);this.hth(b,h)}}jql(b,h,
u){let B=!1;0===this.root.J1?(b&&(B=b.CQd()>h.yTd()),!B&&u&&(B=h.CQd()>u.yTd())):(b&&(B=b.CQd()<h.yTd()),!B&&u&&(B=h.CQd()<u.yTd()));return B}hth(b,h){0===this.J1?(this.AZ.Mc.style.marginLeft=b+"px",this.AZ.Mc.style.marginRight=h+"px"):(this.AZ.Mc.style.marginRight=b+"px",this.AZ.Mc.style.marginLeft=h+"px")}ydl(){this.QC()}vu(){this.ESh(()=>{Rs.a.prototype.vu.call(this)})}Cqa(b){b=this.lPc(b);Le.c(b)||this.ESh(Object(z.a)(b,b.Bm,"pollForStateAndUpdate"))}ESh(b){this.Bfc=this.q5a=!1;b();if(this.q5a||
this.Bfc)this.Zkk||this.refresh(),this.scale()}VO(b){if(!Object(Cb.a)(Ci,b)&&!Object(Cb.a)(xu,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Cb.a)(xu,b)&&b.alignment===lh.a.t9a)for(let h of this.children)if(h.alignment===lh.a.t9a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.oyd?(b+="cui-toolbar-onerow ",v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.t9||
(b+="UITextTranformUpperCase ")):1===this.oyd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Pva(){return"div"}get p$(){return 26}get Byj(){return this.uO}set Byj(b){this.uO=b}R7k(b){b=b[lh.a.Gw];return new xu(this.root,b.Id,b)}QC(){super.QC();this.Mc.setAttribute("role","toolbar");this.properties.Title&&this.Mc.setAttribute("title",this.properties.Title)}vJa(b){return this.root&&this.root.xic(b)?!0:!1}hgo(){this.NTa()}scale(){super.scale();if(!ig.a.Yr(this.properties.Scale)||this.iKe)return!1;
Le.c(this.jma)||(this.jma.visible=!0,this.jma.Ahf());Le.c(this.AZ)||(this.AZ.visible=!0,this.AZ.Ahf());Le.c(this.Ksa)||(this.Ksa.visible=!0,this.Ksa.Ahf());this.i7i(!1);const b=this.Mc.offsetWidth,h=Le.c(this.jma)?0:this.jma.D$b(),u=Le.c(this.AZ)?0:this.AZ.D$b(),B=Le.c(this.Ksa)?0:this.Ksa.D$b();B+u+h>=b&&(B+h>=b?(this.ani(this.AZ),B>=b?(this.ani(this.jma),this.M$f(this.Ksa,b)):this.M$f(this.jma,b-B)):this.M$f(this.AZ,b-B-h));this.q5a=!1;this.Cm();return!1}ani(b){b&&(b.visible=!1)}M$f(b,h){b&&b.n9n(h)}}
Object(m.a)(Nt,"Toolbar",el.a,[847]);class Vu extends Nt{constructor(b,h,u,B,Q=!1){super(b,h,u,!1,!1,B,Q);this.B3g=!0}get p$(){return 7}get cssClass(){return Vu.RAo+" "+super.cssClass}static get RAo(){let b="cui-statusbar";v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.t9||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(m.a)(Vu,"StatusBar",Nt,[]);var Ot=c(484);class ry extends Ot.a{constructor(){super();this.toolbar=null;this.d0d=!1}}Object(m.a)(ry,"ToolbarBuildContext",Ot.a,
[]);class Oz extends Be.Builder{constructor(b,h,u,B){super(b,h,ce.Task.o4(u),B);if(Le.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}Rdg(b){this.root=b}get Dlg(){return this.options}xNk(){const b=new ry,h=new wu.a;h.id="toolbar";h.L4c=1;h.handler=Object(z.a)(this,this.Rqn,"onReturnToolbarData");h.data=b;this.Fva.see(h)}Rqn(b){this.Rdg(this.zNk(b.e4c,b.eJc));this.toolbar.Byj=this;this.toolbar.Cm();this.placeholder.appendChild(this.toolbar.Mc);
ig.a.Xf(this.placeholder,"loaded");this.Pua.continueWith(()=>{this.Pua.result.QLb(this.toolbar)},11)}zNk(b,h){var u=lh.a.Aha(b,lh.a.xQj);Le.c(u)&&(u=lh.a.Aha(b,lh.a.RPj),h.d0d=!0);if(Le.c(u))throw Error.create("No toolbar element was present in the data");b=new lh.a(u);u=v.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.d0d?this.Rdg(new Vu(b.attributes[lh.a.id],b.attributes,this,this.Xaa,u)):this.Rdg(new Nt(b.attributes[lh.a.id],b.attributes,this,this.Dlg.QAo,this.Dlg.Vje,
this.Xaa,u));this.toolbar.Yua=this.options.Yua;this.toolbar.Sne=!0;this.toolbar.Cm();b=lh.a.uw(lh.a.Aha(b.node,lh.a.LMj));h=this.eLk(b,h);for(const B of h)this.toolbar.xf(B);return this.toolbar}eLk(b,h){const u=[];for(let B=0;B<b.length;B++)this.YQa(b[B])||Array.add(u,this.GLk(b[B],h));return u}GLk(b,h){const u=lh.a.wQc(b);let B=null;u===lh.a.iLj?B=this.nLk(b,h):u===lh.a.qNj&&(B=this.dMk(b,h));return B}dMk(b,h){var u=new lh.a(b);u=new Ci(this.root,u.attributes[lh.a.id],b[lh.a.Gw]);u.Wmi=this.Dlg.x9m;
b=lh.a.Aha(b,lh.a.Trb);b=lh.a.uw(b);const B=[];for(let ca=0;ca<b.length;ca++){var Q=b[ca];this.YQa(Q)||(Q=this.tga(Q,h),Array.add(B,Q))}u.ESc=B;return u}nLk(b,h){new lh.a(b);const u=this.toolbar.R7k(b);b=lh.a.Aha(b,lh.a.Trb);b=lh.a.uw(b);for(let B=0;B<b.length;B++){if(this.YQa(b[B]))continue;const Q=this.yNk(b[B],h);u.xf(Q)}return u}yNk(b,h){var u=new lh.a(b);const B=u.name;u=u.attributes[lh.a.kpc];let Q;Q=h.d0d?"Small14":"Small";switch(B){case lh.a.button:return b=this.tga(b,h),b.YQ(Le.b(u)?Q:u);
case lh.a.IEa:return Q=h.d0d?"Medium14":"Medium",b=this.tga(b,h),b.YQ(Le.b(u)?Q:u);case lh.a.label:return b=this.tga(b,h),b.YQ(Le.b(u)?Q:u);case lh.a.separator:return b=this.tga(b,h),b.YQ("Small");case lh.a.toggleButton:return b=this.tga(b,h),b.YQ(Le.b(u)?Q:u);default:throw Error.create("Invalid control type.");}}}Object(m.a)(Oz,"ToolbarBuilder",Be.Builder,[]);var sy=c(1477);class Uv{constructor(b,h,u,B,Q,ca){this.Wmb=()=>{this.toolbar.Bm()};this.vI=b;b=new Fm.CuiHelper(xk.a.u_a,WordEditorIntl.WordEditorStrings,
null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);B=new Sj;B.$G={};ca=3!==ca.mode;B.$G.HeaderToolbarControlsRight=ca;B.$G.HeaderToolbarButtonDockRight=ca;B.$G.HeaderToolbarButtonRemovePageNumbers=ca;Q=new Oz(B,this.vI,this,Q);Q.Fva=new sy.a(Uv.Erm,b);Q.xNk();this.tma=Q.toolbar;u.execute(qa=>{this.toolbar.CF=qa});this.toolbar.refresh();this.toolbar.Bm();this.Lh=h;h.YZa(this.Wmb)}get toolbar(){return this.tma}dispose(){this.Lh.Nic(this.Wmb);this.toolbar&&(this.toolbar.dispose(),this.tma=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.hgo()}nnl(){this.toolbar.c4()}QLb(){}}
Uv.Erm="WordEditorHeaderToolbarData";Object(m.a)(Uv,"HeaderFooterToolbar",null,[203,450]);class Jw{constructor(b,h,u,B,Q){this.Lh=b;this.Fwe=h;this.od=u;this.Xaa=B;this.ga=Q}create(b){return new Uv(b,this.Lh,this.Fwe,this.od,this.Xaa,this.ga)}}Object(m.a)(Jw,"Factory",null,[413]);class UA{constructor(b,h){this.Zc=b;this.Sk=h}scl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.rcl(b)+
"</Controls></MenuSection></Menu>"}HXl(b){const h=this.Zc.yk();h.set(b);h.zb(8);h.ld(8);return h}rcl(b){if(!b)return"";let h="";b=this.HXl(b);this.Sk.iPa(b,u=>{const B=this.Sk.Xii(u);u=u.getValue(Jc.a.Fja);h+=zj.k(u.toString(),u.toString(),Qc.a.rbg.toString(),Qc.a.F2f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,B));return!0});return h}}Object(m.a)(UA,"HeaderFooterToolbarGenerator",null,[412]);var Pz=c(123);class Qz extends sv.a{constructor(b,h,u,B,Q,
ca,qa,Qa){super(b,h,u,B);this.ht=()=>{this.ocd(this.Bb)};this.vI=b.container;this.aw=document.createElement("div");this.UG(this.aw);this.YBa=Q;this.jLa=ca;this.Do.execute(rb=>{rb.XY(this.ht)});this.CK=qa;if(this.GI=Qa)this.vI.style.backgroundColor=this.CK.N9b()}dispose(){super.dispose();this.Do.instance&&this.Do.instance.lTa(this.ht)}get Do(){return null!=this.ezg?this.ezg:this.ezg=Ga.a.instance.Ta("Common.IZoomManager")}nC(b){this.vI.classList.add("HeaderFooterViewElement");this.aw.classList.add("HeaderFooterViewContent");
this.ocd(b.currentNode)}h6(b){this.aw.parentNode&&this.aw.parentNode===this.vI||(this.vI.appendChild(this.aw),this.jLa.instance&&this.jLa.instance.Vdg(this.mc,this.vI));super.h6(b)}lSb(b){Pz.a.ge(()=>{Pz.a.prototype.lSb.call(this,b);this.IDj();this.jLa.instance&&this.jLa.instance.NCj(this.mc,this.aw.style.paddingLeft,this.aw.style.paddingTop)},"HFVE:UFO")}ocd(b){this.Do.instance&&this.Do.instance.Wdd(this.aw);this.IDj();b=this.YBa.k$b(b);this.aw.style.paddingLeft=b.U4b+"px";this.aw.style.width=b.dJc+
"px";this.jLa.instance&&this.jLa.instance.NCj(this.mc,this.aw.style.paddingLeft,this.aw.style.paddingTop)}IDj(){if(this.Do.instance){this.aw.style.paddingTop="";var b=Kn.a.zB(this.aw);b.paddingTop&&(b=kc.a.hN(b.paddingTop),this.aw.style.paddingTop=Math.round(b/this.Do.instance.ij)+"px")}}}Object(m.a)(Qz,"HeaderFooterViewElement",sv.a,[]);class Yr{constructor(b,h,u,B){this.YBa=b;this.jLa=h;this.CK=u;this.GI=B}create(b,h,u,B){return new Qz(b,h,u,B,this.YBa,this.jLa,this.CK,this.GI)}}Object(m.a)(Yr,
"Factory",null,[411]);var oi=c(348),Wu=c(196),Xu=c(985),Rz=c(583);class Wy extends oi.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe){super(h,ca,qa,Qa,rb,Wu.a.Xni,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe);this.isHeader=this.isHeader=b;this.JYa=Q;this.JYa.Dad=this;B(this);this.Mhd=u;this.cBa=document.createElement("div");this.cBa.setAttribute("Unselectable","on");this.cBa.setAttribute("hideselection","hideselection");this.cBa.setAttribute("style","outline:none;");this.cBa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.cBa.tabIndex=0;this.features.upj=!0;this.features.B5e=!0}get dEf(){return!0}Zuf(){const b=this.Mhd.amf(this);return Xu.ViewReference.hF(this,b)}Def(b){Object(Cb.a)(Wy,b)||this.Mhd.dismiss()}get cyf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}YQc(){return Rz.a.PNi}onResize(){super.onResize();this.JYa.oWh()}UE(b,h=null){this.cBa.parentNode&&this.cBa.parentNode.removeChild(this.cBa);super.UE(b,h);this.JYa.bWh(this.ed.tj)}detach(){this.JYa.nWh();super.detach();this.cBa.parentNode||
this.container.insertBefore(this.cBa,this.container.firstChild)}S8c(){this.kv?super.S8c():this.cBa.focus()}COd(){this.onResize()}}Object(m.a)(Wy,"HeaderFooterView",oi.a,[449,236,56,57,10,95,237,238,239]);class Sz{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd){this.Mhd=b;this.Nmk=h;this.Mmk=u;this.eu=B;this.kd=Q;this.uma=ca;this.ga=qa;this.iXa=Qa;this.bua=rb;this.x7=Lb;this.tnk=Yb;this.Xt=gc;this.fz=Fc;this.Nf=Sc;this.vh=ld;this.Fhd=Hd}create(b,h){return new Wy(b,h,this.Mhd,this.Nmk,this.Mmk(),
this.eu,this.kd,this.uma,this.ga,this.iXa,this.bua,this.x7,this.tnk,this.Xt,this.fz,this.Nf,this.vh,this.Fhd)}}Object(m.a)(Sz,"Factory",null,[410]);class ty{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe){this.H9g=!1;this.Kfh="SourceControlId";this.BHo=1;this.CHo=1E3;this.Iae=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;this.vld(Og[this.Kfh]);Og[oh.a.Text]=this.CMe.Jwn(this.wcb.NHb);return 32};this.mJn=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;Og[gg.a.On]=this.wcb.NHb;return 32};this.Vvm=(de,
ne,ye,Vf,Og)=>{if(1===ye)return 32;this.wcb.wUo(Og[gg.a.On]);return 32};this.S9i=(de,ne,ye)=>{if(1===ye)return 32;if(this.saa){ne=ty.ai.ru(ne.view.ed);ye=vd.GraphIterator.eb(ne);const Vf=this.Ud.p_a();try{const Og=this.Kc.Pc(15);try{Og.Db(ne),Og.Qj=de,Pk.a.instance.iPa(ye,Bl=>{this.lZb.R5c(Bl,this.vSl,this.uho);return!0})}finally{Og&&Og.dispose()}}finally{Vf&&Vf.dispose()}}return 32};this.j3c=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;Og.MenuItems=this.Gck.value;this.H9g?this.wcb.H3n():this.H9g=!0;return 32};
this.hCm=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;const Bl=this.vld(Og[this.Kfh]);if(this.saa){ne=ty.ai.ru(ne.view.ed);ye=vd.GraphIterator.eb(ne);Vf=this.Kc.Pc(15);try{Vf.Db(ne);Vf.Qj=de;let sm=null;const op=this.he.Vf("UserAction","InsertPageNumber");Pk.a.instance.iPa(ye,zv=>{this.saa.Xba||this.i0j(zv);sm=this.BMe.fCm(zv,Bl,this.wcb.NHb)||sm;return!0});op.stop();if(!sm)return 8;this.luo(sm,Bl)}finally{Vf&&Vf.dispose()}this.Ud.Us(12)}return 32};this.Iwn=()=>32;this.Tuo=(de,ne,ye,Vf,Og)=>{if(1===ye)return 32;
2===ye&&this.pMa.showCallout(Og);return 32};this.Suo=(de,ne,ye,Vf,Og,Bl)=>this.URe.create(de,ne,ye,Vf,Og,Bl);this.qnl=(de,ne,ye)=>{if(1===ye)return 32;this.pMa.KRh();return 32};this.eto=de=>{v.AFrameworkApplication.va.Eqa(null,Qc.a.Zqj,de.customData,null)};this.vSl=de=>{const ne=xf.a.instance.hb.lb;let ye=-1;for(const Vf of ne)if(Vf.node===de){ye=Vf.cpBegin;break}return{returnValue:ye,MZd:Ge.SelectionEditor.Il(ne)}};this.uho=(de,ne)=>{de=Cg.SelectionFactory.ne(de,ne);xf.a.instance.Bc(de)};this.ga=
b;this.Kc=h;this.Ib=u;this.wcb=B;this.saa=Q;this.gm=ca;this.CMe=qa;this.BMe=Qa;this.lZb=rb;this.pMa=Lb;this.ib=Yb;this.URe=gc;this.he=Fc;this.Ud=Sc;this.vld=ld;this.i0j=fe;this.Gck=new hg.a(()=>this.wcb.i6l())}Tb(){this.ga.fb(Qc.a.j3c,vc.a.view,this.j3c,100);this.ga.fb(Qc.a.iZi,vc.a.view,this.Iwn,68);this.ga.fb(Qc.a.tri,vc.a.view,this.hCm,4);this.ga.fb(Qc.a.NHb,vc.a.view,this.Vvm,4);this.ga.fb(Qc.a.R5c,vc.a.view,this.S9i,4);this.ga.fb(Qc.a.GYn,vc.a.view,this.S9i,4);this.ga.fb(Qc.a.g3f,vc.a.application,
this.mJn,97);this.ga.fb(Qc.a.Iae,vc.a.application,this.Iae,97);this.ga.fb(Qc.a.Yqj,vc.a.view,this.Tuo,4);this.ga.vT(Qc.a.Zqj,vc.a.view,this.Suo,100);this.ga.fb(Qc.a.pnl,vc.a.view,this.qnl,4)}luo(b,h){const u=b.Kb.paragraph;if(u){var B=this.gm.g0c(u);B&&this.saa.cha(B)}B=this.saa.Xba;this.saa.show(4>h);u&&this.Kgo(u)&&(this.Sko(b,u),this.Htk(b,B))}Kgo(b){let h;if(!({isHeader:h,skg:b}=this.gm.rhi(b)).returnValue)return!1;this.saa.nza(b,h);return!0}Sko(b,h){b=Cg.SelectionFactory.ne(h,b.Kb.cp);this.ib.Bc(b)}Htk(b,
h){h=new bf.a(2,1,h?this.BHo:this.CHo,this.eto);h.customData=b;this.Ib.Xb(h)}static get ai(){return Zo.PageNavigator.instance}}Object(m.a)(ty,"PageNumbersActor",null,[448]);class Xy{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){this.ga=b;this.Ib=h;this.wcb=u;this.CMe=B;this.BMe=Q;this.lZb=ca;this.pMa=qa;this.URe=Qa;this.gm=rb;this.Ud=Lb;this.vld=Yb;this.Wlk=gc;this.Wfa=Fc}create(b,h){return new ty(this.ga,new $k.a,this.Ib,this.wcb,b,this.gm,this.CMe,this.BMe,this.lZb,this.pMa,xf.a.instance,this.URe,
Fb.App.za.Iq,this.Ud,this.vld,this.Wlk,this.Wfa,h)}}Object(m.a)(Xy,"Factory",null,[409]);var Kw=c(1978),wv;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(wv||(wv={}));Object(m.b)("ModalCalloutSize",wv);var wx;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(wx||
(wx={}));Object(m.b)("BeakLocation",wx);class Yy{constructor(b,h,u){this.AHo=1;this.WOe=!1;this.x_b=null;this.kTn=()=>{this.ib.Sw(this.Fqa);this.WOe=!0;this.x_b=null};this.Fqa=(B,Q)=>{if(B=Q.pl.lb)1<B.length||!B.length?B=!0:(B=B.Pa,B=B.cpEnd-B.cpBegin,B=1<B||!B),B&&this.g_j()};this.Ib=b;this.ib=h;this.g_j=u}Pz(){this.Gtk()}R$(){this.WOe?(this.ib.ZY(this.Fqa),this.WOe=!1):this.x_b&&(this.Ib.Ze(this.x_b),this.x_b=null)}Gtk(){this.x_b=new bf.a(2,1,this.AHo,this.kTn);this.Ib.Xb(this.x_b)}}Object(m.a)(Yy,
"CalloutDismissManager",null,[]);class xx{constructor(b,h,u,B){this.dismiss=()=>{this.UH&&(this.ztc.R$(),this.T_c.dismiss())};this.T_c=b;this.Zp=B;this.ztc=new Yy(h,u,this.dismiss)}get UH(){return this.T_c.UH}show(){if(!this.UH){const b=document.createElement("div");b.classList.add(xx.Hwn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.T_c.content=b;this.T_c.show();this.Zp&&this.Zp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.ztc.Pz()}}dispose(){this.dismiss();
this.T_c.dispose()}static pal(b,h){h=Kw.a.kLh(Qd.a.getElementBounds(b.targetElement),h,Fb.App.za.pD,wv.small);h.oga=xx.unf(b);h.Ht=!1;return h}static unf(b){let h=wx.bottomCenter;Object(Cb.a)(449,b.view)&&b.view.isHeader&&(h=wx.topCenter);return h}}xx.Hwn="PageNumbersCalloutControl";Object(m.a)(xx,"PageNumbersCallOutControl",null,[447]);class Zy{constructor(b,h,u){this.iT=null;this.aT=!1;this.dismiss=()=>{this.UH&&this.iT&&mk.UISurfaces.IM().then(B=>{this.ztc.R$();B.removeNotification(this.iT);this.aT=
!1;return null},B=>{r.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null})};this.ul=b;this.ztc=new Yy(h,u,this.dismiss)}get UH(){return this.aT}show(){this.UH||mk.UISurfaces.IM().then(b=>{const h=b.callout(Object.assign(new xr.a,{target:this.ul,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),u=Object.assign(new ub.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.aT=!0},expirationOptions:Object.assign(new hc.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.iT=b.addNotification(h,u);this.ztc.Pz();return null},b=>{r.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(m.a)(Zy,"ReactPageNumbersCallOutControl",null,[447]);class Lw{constructor(b,h,u){this.ib=h;this.Ib=b;this.Zp=u}create(b,h){if(v.AFrameworkApplication.ua.Lb&&v.AFrameworkApplication.ua.Lb.eRa)return new Zy(h.targetElement,this.Ib,this.ib);b=xx.pal(h,b);return new xx(b,this.Ib,this.ib,this.Zp,v.AFrameworkApplication.ua.WP)}}
Object(m.a)(Lw,"Factory",null,[408]);class yx{constructor(b,h){this.vE=null;this.Fck=b;this.Ti=h}get control(){return this.vE}showCallout(b){this.control&&this.control.UH&&this.control.dismiss();this.vE=this.dEn(b);this.control.show()}KRh(){this.control&&(this.control.dismiss(),this.vE=null)}dEn(b){const h=this.Ti.koa();this.vE=this.Fck.value.create(h,b);return this.control}}Object(m.a)(yx,"PageNumbersCalloutControlManager",null,[407]);var Mw=c(764);class zx extends vx.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(m.a)(zx,"PageNumberGalleryButtonProps",vx.a,[]);const Cp=(b,h,u)=>{b=b.yk();b.set(u);h.mLb(b);return b};class st{constructor(b,h,u){this.NDe=!1;this.Wfa=h;this.hm=u}get NHb(){return this.NDe}i6l(){const b=Object.assign(new Rk.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.nrk());b.MenuSectionList.push(this.dsk());b.MenuSectionList.push(this.Gsk());return b}wUo(b){this.NDe=b;this.g7i()}H3n(){this.NDe=!1;const b={};b[st.mpi]="CheckboxModel";
this.Wfa(b);this.g7i()}nrk(){const b=Object.assign(new wh.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.vf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Mw.a,{Id:st.Wvm,Command:Qc.a.NHb.toString(),QueryCommand:Qc.a.g3f.toString(),LabelText:F.a.vf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.vf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}dsk(){const b=Object.assign(new wh.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Ej.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.hm){for(var u=3;1<=u;u--)h.GalleryItems.push(this.Kpf(u));for(u=6;4<=u;u--)h.GalleryItems.push(this.Kpf(u))}else for(u=
1;6>=u;u++)h.GalleryItems.push(this.Kpf(u));b.ControlList.push(h);return b}Gsk(){const b=Object.assign(new wh.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new yg.a,{Id:"btnRemovePageNumber",Command:Qc.a.R5c.toString(),LabelText:F.a.vf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.vf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:v.AFrameworkApplication.$s,Image16by16Class:ze.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}Kpf(b){const h=st.SYf+b.toString();var u=Object,B=u.assign,Q=new zx,ca=Qc.a.tri.toString(),qa=Qc.a.Iae.toString(),Qa=F.a,rb=Qa.vf;let Lb="";switch(b){case 1:Lb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Lb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Lb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Lb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Lb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Lb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return B.call(u,Q,{Id:h,Command:ca,QueryCommand:qa,Alt:rb.call(Qa,Lb)})}g7i(){const b={};for(let h=1;6>=h;h++)b[st.SYf+h.toString()]="PageNumberGalleryButtonModel";b[st.mpi]="CheckboxModel";this.Wfa(b)}static j6l(b){return b?parseInt(b.substr(st.SYf.length)):1}}st.Wvm="btnIncludePageCount";st.mpi="IncludePageCount";st.SYf="btnPageNumbersPosition";
Object(m.a)(st,"PageNumbersControl",null,[406]);class Ir{constructor(b,h,u,B,Q=null,ca=null,qa=null,Qa=null){this.iYl=(rb,Lb)=>{const Yb=new Ck.a;rb=4>rb;switch(Lb){case 1:case 2:Yb.add(rb?0:3);break;case 3:case 4:Yb.add(rb?0:3),Yb.add(rb?1:4)}return Yb};this.aRl=(rb,Lb,Yb)=>{var gc=Cp(this.Zc,this.gm,rb);this.gm.nLb(gc,Yb);let Fc=this.zYj(gc,Lb);if(Fc)this.lZb.u$i(Fc);else{gc=Cp(this.Zc,this.gm,rb);this.gm.nLb(gc,Yb);gc.Qd();if(Yc.OutlineElementReader.Bh(gc)&&(gf.OutlineElementNavigator.Ce(gc),me.ParagraphReader.kh(gc))){gc=
gc.currentNode;const Sc=this.whi(Lb);me.ParagraphReader.Kx(gc)===Sc&&this.lZb.u$i(gc)&&(Fc=gc)}Fc||(gc=Cp(this.Zc,this.gm,rb),this.gm.nLb(gc,Yb),this.xL.akb(gc,null,!0),Fc=gf.OutlineElementNavigator.Ce(gc),this.lE(Lb,Fc))}return Fc};this.bRl=(rb,Lb)=>{let Yb=null;rb.Ub(1);if(Yc.OutlineElementReader.Bh(rb)&&(rb.Ub(2),Zi.TableReader.isTable(rb))){var gc=rb.currentNode;if(3===Zi.TableReader.eh(gc)){let Fc=0;gc=Zi.TableReader.In(gc);switch(Lb){case 1:case 4:Fc=gc?2:0;break;case 2:case 5:Fc=1;break;case 3:case 6:Fc=
gc?0:2}qg.moveToCellContent(rb,0,Fc);rb.currentNode&&Yc.OutlineElementReader.Bh(rb)&&(rb=gf.OutlineElementNavigator.Ce(rb),me.ParagraphReader.Wb(rb)&&(Yb=rb))}}return Yb};this.ALm=(rb,Lb)=>{const Yb=Cp(this.Zc,this.gm,rb);rb=Yb.currentNode.ja(Jc.a.Fja,0);this.gm.nLb(Yb,Lb);Lb=Yb.currentNode.ja(Jc.a.Fja,0);return rb===Lb};this.Zc=b;this.Hck=h;this.lZb=u;this.gm=B;this.xvc=Q||this.iYl;this.AYj=ca||this.aRl;this.zYj=qa||this.bRl;this.J6j=Qa||this.ALm}get xL(){return null!=this.lDg?this.lDg:this.lDg=
Ga.a.instance.resolve("Box4.IOutlineEditor")}fCm(b,h,u){var B=Cp(this.Zc,this.gm,b).Cn;B=this.gm.Kha(B);B=this.xvc(h,B);let Q=null;for(let qa=0;qa<B.length;qa++){var ca=B.Zf(qa);this.J6j(b,ca)&&(ca=this.AYj(b,h,ca),Q=this.Hck.csk(ca,u)||Q)}return Q}lE(b,h){Ir.T5.X8c(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);Ir.il.lE(h,this.whi(b))}whi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get il(){return null!=
Ir.hEg?Ir.hEg:Ir.hEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get T5(){return null!=Ir.GFg?Ir.GFg:Ir.GFg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(m.a)(Ir,"PageNumbersInserter",null,[405]);var Nw=c(888),Tz=c(896);class $q{constructor(b,h,u=null,B=null,Q=null){this.m7k=(ca,qa)=>{ca=Je.a.Oc(ca,me.ParagraphReader.textLength(ca));const Qa=ca.node.Lc;return Qa?$q.ig.Uha(ca,rb=>{rb=Tz.a.getInstance(rb);this.YHd(rb,15,Qa,qa);this.YHd(rb,47,Qa,qa);this.YHd(rb,16,Qa);this.YHd(rb,
17,Qa);return rb}):null};this.KCm=(ca,qa)=>{ca=Je.a.Oc(ca,me.ParagraphReader.textLength(ca));$q.ig.Ge(ca,qa)};this.Kc=b;this.ksd=u||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Awe=B||this.m7k;this.yhh=Q||this.KCm}csk(b,h){const u=this.Kc.Pc(15);u.Db(b);var B=me.ParagraphReader.text(b),Q=!1;0<B.length&&" "!==B.charAt(B.length-1)&&(Q=!0);if(h){h=String.format(this.ksd,"#","$");Q&&(h=" "+h);Q=h.indexOf("#");B=h.indexOf("$");r.ULS.shipAssertTag(4256717,309,-1!==Q,"{0}",
{["PageNumberIndex"]:Q});r.ULS.shipAssertTag(4256718,309,-1!==B,"{0}",{["PageCountIndex"]:B});r.ULS.shipAssertTag(4256719,309,Q!==B,"{0}",{["PageNumberIndex"]:Q,["PageCountIndex"]:B});let Qa;let rb;if(Q<B){var ca=Q;Qa=B;var qa=Nw.a.DPc(0);rb=Nw.a.DPc(1)}else ca=B,Qa=Q,qa=Nw.a.DPc(1),rb=Nw.a.DPc(0);this.hBf(b,h,0,ca);qa=this.Awe(b,qa);this.hBf(b,h,ca+1,Qa);ca=this.Awe(b,rb);this.hBf(b,h,Qa+1,h.length);b=Q<B?qa:ca}else Q&&this.yhh(b," "),b=this.Awe(b,Nw.a.DPc(0));u.dispose();return b}YHd(b,h,u,B=null){const Q=
new Jv.a;Q.setValue(Xe.a.N$,!0);Q.setValue(Jc.a.qEb,1);Q.setValue(Jc.a.Is,h);switch(h){case 15:Q.setValue(Jc.a.iRa,!0);Q.setValue(Jc.a.HX,B);break;case 47:Q.setValue(Jc.a.HX,B);break;case 17:Q.setValue(Jc.a.AJb,!0)}h=u.Su(Q,W.a.create());this.$sk(b,h)}$sk(b,h){b.wua(h,W.a.nil,wp.AParagraphNode.PC,null)}hBf(b,h,u,B){h=h.substring(u,B);0<h.length&&this.yhh(b,h)}static get ig(){return $q.Ld||($q.Ld=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set ig(b){$q.Ld=b}}$q.Ld=null;Object(m.a)($q,
"PageNumbersNodeLevelInserter",null,[404]);class Yu{Jwn(b){return Yu.F8l(b)}static F8l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Yu.ZYi,Yu.ZYi)}}Yu.ZYi="1";Object(m.a)(Yu,"PageNumbersPositionPreviewGenerator",null,[403]);class Ax{constructor(){this.nOg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.TXj=this.nOg.length}Rqm(b){let h=
b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===me.ParagraphReader.textLength(b)?{returnValue:!0,m3c:h}:{returnValue:!1,m3c:-1}}Apm(b){let h=b.characterData.lastIndexOf(this.nOg);return-1!==h&&h+this.TXj===me.ParagraphReader.textLength(b)?{returnValue:!0,m3c:h}:{returnValue:!1,m3c:-1}}qqm(b){return Hq.a(b,9)?!0:!1}}Object(m.a)(Ax,"PageNumbersReader",null,[402]);class tt{constructor(b,h,u,B,Q,ca=null,qa=null){this.FYn=(Qa,rb,Lb,Yb)=>{Qa=Cp(this.Zc,this.gm,Qa);this.gm.nLb(Qa,rb);rb=bq.a.Np(Qa);
for(Qa=!1;rb.moveNext();){const gc=rb.currentNode;if(me.ParagraphReader.Wb(rb.currentNode)&&Hq.a(rb.currentNode,9)){Qa=!0;let Fc;const Sc=({MZd:Fc}=Lb(gc,Fc)).returnValue;let ld=Sc;ld=this.iXn(gc,ld);ld=this.$Yn(gc,ld);-1<Sc&&(ld===Sc&&Fc||Yb(gc,ld))}}Qa&&this.Ud.Us(12)};this.Zc=b;this.gm=h;this.DMe=u;this.Ud=B;this.sBc=Q;this.xvc=ca||qy.a.Ldf;this.Yek=qa||this.FYn;this.ksd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.$Ug=String.format(this.ksd,"#","$");this.a5j=this.$Ug.indexOf("#");
this.$4j=this.$Ug.indexOf("$");this.WAe=String.format(this.ksd,"\ufffc","\ufffc");this.TUg=this.WAe.length}R5c(b,h,u){var B=Cp(this.Zc,this.gm,b).Cn;B=this.gm.Kha(B);B=this.xvc(B);for(const Q of B)this.Yek(b,Q,h,u)}u$i(b){if(this.DMe.qqm(b)){let h=-1;if(({m3c:h}=this.DMe.Apm(b)).returnValue&&this.LBh(b,h)||({m3c:h}=this.DMe.Rqm(b)).returnValue&&this.xTk(b,h))return!0}return!1}$Yn(b,h){var u=b.qa.length;for(let Q=0;Q<u;Q++){var B=b.qa.J(Q);B.blob&&9===B.blob.qh&&(B=B.cp,u=Je.a.createTextRange(b,B,
B+1),this.sBc(u,""),u=b.qa.length,Q--,h=this.Bqh(h,B,1))}return h}iXn(b,h){let u=b.characterData.indexOf(this.WAe);for(;-1!==u;)this.LBh(b,u)&&(h=this.Bqh(h,u,this.TUg)),u=b.characterData.indexOf(this.WAe);return h}xTk(b,h){const u=b.qa.zh(h);return u&&u.blob&&9===u.blob.qh?(b=Je.a.createTextRange(b,h,h+1),this.sBc(b,""),!0):!1}LBh(b,h){const u=b.qa.zh(h+this.a5j),B=b.qa.zh(h+this.$4j);return u&&u.blob&&9===u.blob.qh&&B&&B.blob&&9===B.blob.qh?(b=Je.a.createTextRange(b,h,h+this.TUg),this.sBc(b,""),
!0):!1}Bqh(b,h,u){-1<b&&b>h&&(h=b-h,b=h>u?b-u:b-h);return b}}Object(m.a)(tt,"PageNumbersRemover",null,[401]);class uy{constructor(b,h){this.xsb=this.wsb=null;this.Kr=b;this.Ib=h}zAk(){this.Kr.style.display="";this.wsb||(this.xsb&&(this.Ib.Ze(this.xsb),this.xsb=null),this.wsb=new bf.a(0,1,10,()=>{this.Kr.classList.add("Displayed");this.wsb=null}),this.Ib.Xb(this.wsb))}BAk(){this.Kr.classList.remove("Displayed");this.xsb||(this.wsb&&(this.Ib.Ze(this.wsb),this.wsb=null),this.xsb=new bf.a(0,1,200,()=>
{this.Kr.style.display="none";this.xsb=null}),this.Ib.Xb(this.xsb))}}Object(m.a)(uy,"PaneControlAnimationHelper",null,[443]);class Pt{constructor(b){this.Ib=b}o6l(b){return new uy(b,this.Ib)}}Object(m.a)(Pt,"PaneControlAnimationHelperFactory",null,[400]);class Vv{constructor(b,h,u,B,Q,ca,qa,Qa,rb=!1){this.jJg=this.tma=this.Tld=null;this.xrm=()=>{this.Tw.sendNotification(this.jJg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=b;this.E6=h;this.E6.bind(this);
this.cFe=u;this.Gta=Q;this.aVe=qa;this.Vb=Qa;this.qnd=rb;this.efa=ca.value.create(u,B);this.E6.OIk(this.efa);this.QZ=Nb.KeyInputManager.ic(Se.a.a2,0)}get Tw(){return null!=this.Nug?this.Nug:this.Nug=Ga.a.instance.resolve("Common.Utils.IAriaNotifier")}t1(b){this.E6.t1(b);this.tma&&!b&&this.tma.nnl()}cha(b){this.Tld!==b&&(this.Egb(),this.Tld=b)}nij(b){if(this.Tld){var h=this.Gta.e2a(this.Tld,qy.a.hYl(b,this.cFe));this.qnd?(this.jJg=this.c3h(b,this.cFe),this.efa.EPb(af.a.BCd)):this.ZQo(b);h&&this.l2e(h)}}Iuh(b){this.qnd&&
this.Vb&&(b=this.Vb.ae(b))&&b.K7(this.xrm)}c3h(b,h){let u="";switch(b){case 1:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return u}ZQo(b){this.efa.zjj(this.c3h(b,this.cFe),af.a.BCd)}setInitialSelection(){this.efa.S8c()}l2e(b){this.Egb();this.efa.UE(b,b.tj)}Egb(){this.efa.detach()}xdl(){this.tma=
this.aVe.value.create(this.E6.jnc);this.Sno(this.tma)}Sno(b){if(this.Vb){const h=this.Vb.ae(ma.a.W2a);h.parent=$d.AFrame.xp;h.cga(()=>{b.setFocus();this.cmo()});h.bindAction(this.QZ,Qc.a.ZT)}}cmo(){if(this.Vb){var b=this.Vb.ae(ma.a.W2a);const h=new te.DOMFocusListing(()=>this.E6.jnc);h.uja=!0;h.Mm(1);this.Vb.ffb(this.E6.jnc,b,h);b=this.Vb.getRegion(ma.a.W2a);b.fTa();b.xP=!0;h.kha&&h.Zy(h.kha)}}dispose(){void 0!==this.tma&&null!==this.tma&&(this.Vb.ae(ma.a.W2a).kr(this.QZ),this.tma.dispose())}LRn(){void 0!==
this.tma&&null!==this.tma&&this.tma.refresh()}}Object(m.a)(Vv,"PaneControl",null,[362]);class lp{constructor(b,h,u,B){this.gm=b;this.N3j=h;this.aVe=u;this.Vb=B}create(b,h,u,B){return new Vv(b,h,u,B,this.gm,this.N3j,this.aVe,this.Vb,v.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(m.a)(lp,"Factory",null,[338]);var VA=c(1109);class Bx extends eq.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb){super();this.init(b);this.Ml("ShowCalloutForPageNumberOperation");this.YSj=Qa;
this.Ujb(this.YSj,h,B,Q,ca);this.jz=0;this.vcb=ca;this.pMa=qa;this.Lh=rb;1===this.behavior&&(this.qr=32,this.hra())}get Ftl(){if(null!=this.Wwg)var b=this.Wwg;else{var h;b=this.Wwg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.Lh.jb.gu;if(!this.jz){var h=qx.a.p9b(this.vcb,b);this.vcb.qSc(b,h)?this.vcb.Fwa(b,h).element&&(this.jz=1):this.Ftl&&(this.jz=2)}1===this.jz&&(h=qx.a.p9b(this.vcb,
b),h=this.vcb.Fwa(b,h),b=new VA.a(h.element,b),this.pMa.showCallout(b),this.jz=2);2===this.jz&&(this.qr=32,this.hra())}}Object(m.a)(Bx,"ShowCalloutForPageNumberOperation",eq.a,[]);class $y{constructor(b,h,u){this.pMa=b;this.ga=h;this.JTb=u}create(b,h,u,B,Q,ca){return new Bx(b,h,u,B,Q,ca,this.pMa,this.ga,this.JTb)}}Object(m.a)($y,"Factory",null,[337]);class Ih{get xL(){return null!=this.jDg?this.jDg:this.jDg=Ga.a.instance.resolve("Box4.IOutlineEditor")}wc(b){b.ia("WordEditor.HeaderFooter.HeaderFooterManager",
()=>new Gf(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Re("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new Sz(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),
nk.a.R8e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Fb.App.za.jb,nb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),b.Ta("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Ta("Common.IZoomManager"),b.Oa("Box4.IContentControlViewElementManager"),b.Oa("Box4.CpConversionManagerImpl"),b.Oa("Box4.ContentControlConfigSettings"),b.Oa("Box4.IContentControlReader"),b.Oa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Yr(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Fb.App.instance&&Fb.App.instance.cD)).as("WordEditor.IHeaderFooterViewElementFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new Jw(hk.App.hn,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),hk.App.hn,
v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new lp(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Re("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Re("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),hd.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new Ni(()=>{Fb.App.za.updateCommandUI()},
b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),v.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Xy(v.AFrameworkApplication.va,Bg.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),
b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,st.j6l,Object(z.a)(Fb.App.za,Fb.App.za.Dcd,"updateRibbonControl"),Object(z.a)(Fb.App.za,Fb.App.za.cH,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new t).ha();b.ia("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new Pt(Bg.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new yc(hd.FocusManager.instance(),Fb.App.za.ux,b.Re("WordEditor.HeaderFooter.IPaneControlFactory"),b.Re("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Re("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),v.AFrameworkApplication.va,new hg.a(()=>Fb.App.za.jb.qc),
v.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new ud(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Df.PageReader.instance,new Yn.a,Pk.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new UA(new Yn.a,Pk.a.instance));b.ia("WordEditor.HeaderFooter.HeaderFooterActor",
()=>new Gn(v.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Pk.a.instance,new Yn.a,new $k.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Gn.Wii,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Cd(zC.a.instance,Cd.tem(b.resolve("Box4.ITableEditor")),
Cd.FOl(),v.AFrameworkApplication.isRtl,gf.OutlineElementNavigator.Wd,Cd.kcm(),Cd.XXl(),b.resolve("Box4.IOutlineElementEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new Tc.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Yn.a,h=>this.xL.akb(h,null,Tc.a.Meg),v.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").SPb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),
b.resolve("Box4.Styles.IWACStyleEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new wg(Pk.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();b.ia("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new Vy(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Yn.a,new $k.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),
v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new Iw(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Pk.a.instance,new Yn.a,v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.PageNumbersControl",()=>new st(Object(z.a)(Fb.App.za,Fb.App.za.Dcd,"updateRibbonControl"),Object(z.a)(Fb.App.za,Fb.App.za.cH,"updateRibbonControls"),v.AFrameworkApplication.isRtl)).ha();b.register(Yu,
"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ia("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new $q(new $k.a,b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersInserter",()=>new Ir(new Yn.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersReader",()=>new Ax).ha();
b.ia("WordEditor.HeaderFooter.PageNumbersRemover",()=>new tt(new Yn.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(Ih.ig,Ih.ig.Ge,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new yx(b.Re("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Fb.App.za)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();
b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new Lw(Bg.a.instance,xf.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new $y(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),v.AFrameworkApplication.va,Fb.App.za)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",
()=>new SA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new AC(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get ig(){return null!=Ih.rvg?Ih.rvg:
Ih.rvg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(m.a)(Ih,"HeaderFooterComponentConfiguration",null,[2]);class Cx{constructor(){this.Vld=this.W=null}get name(){return"WordEditor.HeaderFooter"}wc(b){this.W=b;(new Ih).wc(b)}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}sn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(this.Vld=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Vld.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Vld&&
this.Vld.dispose()}static main(){M.a.instance.Gc(new Cx)}}Object(m.a)(Cx,"PackageManager",null,[1,2]);var az=c(362),mp=c(497);class vy{constructor(b,h){this.Nf=b;this.em=h}create(){return new mp.a(this.Nf.instance,this.em.instance)}}Object(m.a)(vy,"ContentControlNodeFactory",null,[349]);var bz=c(1701),Uz=c(383),Vz=c(1070);class cz{create(){return new Vz.a}}Object(m.a)(cz,"ContentControlContainerNodeFactory",null,[349]);var ls=c(187),dz=c(390),WA=c(244),BC=c(1123);const Wv=b=>b?(b=b.ja(Jc.a.oOa,null))&&
b.includes(ls.a.YOh):!1;class ez{constructor(b,h,u,B,Q,ca,qa){this.Goa=b;this.Yf=h;this.ig=u;this.Fga=B;this.Cra=Q;this.Xn=ca;this.M3k=qa;this.Qin=(Qa,rb)=>{In.a.r4a&&(Qa=rb.node,rb=vd.GraphIterator.eb(Qa),rb.zb(7)&&(rb=rb.ld(54)))&&(rb=rb.getValue(Jc.a.contentControlNode),Qa=Qa.id,1==(null===rb||void 0===rb?void 0:rb.length)&&Qa.equals(rb[0])&&(Qa=this.Goa.c7h(),this.WPh(Qa)))};this.KUf=(Qa,rb)=>{if(In.a.r4a)for(const Lb of rb.cOh)Wv(Lb.contentControlNode)||(Qa=Lb.contentControlNode.ja(Jc.a.oOa,
null),this.WPh(Qa))}}get WCf(){return v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Fga.E7i(this.KUf);this.M3k.GQ(this.Qin)}WPh(b){const h=this.Goa.RFb();h&&b&&this.Goa.QGb(h,b)&&(b=new Qg.GraphTransaction(7),b.Qt(h),h.vg(),b.dispose())}MJc(){const b=new BC.a;b.setValue(Jc.a.bkm,!0);var h=(h=yb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Jc.a.F$b,h);b.setValue(Jc.a.F3k,this.WCf);h=yb.a.create();b.setValue(Jc.a.Aji,
h);return b}WMk(b){const h=b.currentNode.getValue(Jc.a.Aji);b.xf(new dz.a,1);b.$X();b.currentNode.setValue(Jc.a.LSh,h);b.xf(this.Yf.hgb(),1);b.$X();return this.Yf.fJ(b)}wlo(b){var h=this.Goa.uqf();h.zb(7);if(h.rc()&&h.TPa(0,B=>8==B.type)){h=h.currentNode;const B=(new tv.WACStyleSet).XX(h);if(B){var u=B.jj(ls.a.I_f);if(!u&&(u=this.qsk(h),r.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!u}`),!u))return;b=Je.a.createTextRange(b,0,me.ParagraphReader.textLength(b));
this.Cra.w_(b,Q=>{this.Xn.vga(Q);this.Xn.E7a(Q,u)})}}}Bal(b){var h=this.Goa.uqf();const u=this.MJc();h.xf(u,29);h.$X();h=this.WMk(h);this.ig.Ge(Je.a.Oc(h,0),b,!1,!1);this.wlo(h);return u}pYk(b){const h=this.Goa.RFb();this.Goa.QGb(h,b);b=this.MJc();const u=this.Goa.uqf();u.xf(b,29);u.wj(b);cq.a(h.currentNode,u.currentNode,!1);return b}fWo(b,h){const {g9d:u,pmi:B}=this.Goa.wWl(b);if(u){var Q=Je.a.createTextRange(u,0,me.ParagraphReader.textLength(u));this.ig.Ge(Q,h,!1,!1);B&&this.fjl(b);this.PUo(b)}}fjl(b){const h=
this.Goa.RFb();if(h&&b&&this.Goa.QGb(h,b))for(h.Qd(),b=h.Qp(),--b;0<b;b--)h.lF(b),h.vg()}PUo(b){const h=this.Goa.RFb();this.Goa.QGb(h,b)&&h.currentNode.setValue(Xe.a.KR,new Date)}qsk(b){const h=new sx.a(new WA.a);h.setValue(xh.a.la,"Placeholder Text");h.setValue(xh.a.na,1);h.setValue(Jc.a.ma,"PlaceholderText");h.setValue(Ud.a.oa,99);h.setValue(Jc.a.pa,"Default Paragraph Font");h.setValue(Jc.a.vn,!0);h.setValue(Xe.a.fontColor,8421504);return lk.a.cFc([h],b)?h:null}}Object(m.a)(ez,"GlossaryEditor",
null,[304]);class fz{constructor(b,h,u,B,Q){this.Fga=b;this.AHh=h;this.kCb=u;this.RJ=B;this.Bj=Q;this.D3k=new cz;this.Sin=(ca,qa)=>{this.RJ.ge(()=>{if(qa){qa.Qo.selectedContentControls||(qa.Qo.selectedContentControls={});var Qa=qa.Qo.selectedContentControls,rb=qa.ITa;if(rb&&rb.length){var Lb=rb[0];rb=rb[rb.length-1];Lb=this.Fga.fof(Je.a.Oc(Lb.node,Lb.Ij),Je.a.Oc(rb.node,rb.np),!1);for(const Yb of Lb)In.a.Hx&&Yb.contentControlNode.ja(Jc.a.CU,!1)||(Qa[Yb.contentControlNode.id.toString()]=!0)}}},"CC:OnBeforeCopy")};
this.yWf=(ca,qa)=>{this.RJ.ge(()=>{if(qa){var Qa=qa.clone,rb=qa.original;try{const Lb=qa.Qo.selectedContentControls,Yb=this.Fga.onf(rb,0,rb.characterData.length,!0,!0,!1);for(const gc of Yb){const Fc=gc.ke.toString();Lb[Fc]?gc.rp&&!this.X5k(gc.contentControlNode,Qa,Lb)&&(r.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Fc)),this.v6f(Qa,gc.ke)):this.v6f(Qa,gc.ke)}}catch(Lb){r.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",
Lb.toString()),this.AHh.HWn(Qa)}}},"CC:onParagraphCopy")};this.zWf=(ca,qa)=>{this.RJ.ge(()=>{if(qa){var Qa=qa.clone,rb=qa.original;try{const Lb=this.Fga.onf(Qa,0,rb.characterData.length);qa.Qo.ccObjectIdMapping||(qa.Qo.ccObjectIdMapping={});const Yb=qa.Qo.ccObjectIdMapping;for(let gc=0;gc<Lb.count;gc++){const Fc=Lb.J(gc),Sc=Fc.ke.toString();if(this.JQm(Fc))if(Fc.Qc){const ld=rb.Ui().vd.Eb(Sc),Hd=this.D7l(Fc),Ie=this.gYk(ld,Hd.VZi,Hd.Pqi,Qa.Ui().vd);Yb[Sc]=Ie.id;this.kCb.HDj(Yb[Sc],Qa.id,null);this.Bj.Vec(Ie)}else this.kCb.HDj(Yb[Sc],
null,Qa.id);Yb[Sc]?(Fc.ke=Yb[Sc],Fc.dv=null):this.v6f(Qa,Fc.ke)}}catch(Lb){r.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Lb.toString())}}},"CC:onParagraphPaste")}}init(){hu.a.Ruk(this.Sin);hu.a.f_e(this.yWf);hu.a.jBd(this.zWf)}xPl(b){if(!b.zb(25)||!b.ld(25))return null;if(!b.Fs(25)){const h=this.D3k.create(1074135144);b.xf(h,25)}return b.Ub(25)}X5k(b,h,u){var B=b.ja(Jc.a.j8,null);const Q=vd.GraphIterator.eb(h);h=h.Ui().vd;u=B&&u[B.toString()]?h.Eb(B):this.xPl(Q);if(!u)return r.ULS.sendTraceTag(521172765,
368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;B=cq.b(b,h,!0);vd.GraphIterator.eb(u).C3(B,26,b.id);54!==u.type&&B.setValue(Jc.a.j8,u.id);In.a.Hx&&Uz.a.lBf(null,B);return B}v6f(b,h){this.AHh.sil(new zb.a([b]),h)}JQm(b){var h=b.Kb.paragraph.Lc;if(!h)return r.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.ke.toString())),!1;h=h.Eb(b.dv);if(!h)return r.ULS.sendTraceTag(520152149,
368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.ke.toString())),!1;b=h.getValue(Jc.a.Is);return 38===b||39==b}dOl(b,h){var u,B=b.qa.J(b.qa.length-1);let Q=b.characterData.length;B=(null===(u=null===B||void 0===B?void 0:B.Jb)||void 0===u?void 0:u.length)||0;b.id.equals(h.Kb.paragraph.id)&&(Q=h.Kb.cp,B=h.Kb.Jb.vJ(h.ke,h.Qc));return this.Fga.pnf(b,0,Q,0,B)}D7l(b){let h=null,u=b.Kb.paragraph;const B={};for(;u;){const Q=this.dOl(u,b);for(let ca=Q.count-1;0<=ca;ca--){const qa=
Q.J(ca);if(!qa.rp)continue;const Qa=qa.ke.toString();if(qa.Qc){if(!B[Qa])return{VZi:qa.contentControlNode,Pqi:h}}else B[Qa]=!0,h||(h=qa.contentControlNode)}u=me.ParagraphReader.$f(u,!0,!0)}return{VZi:null,Pqi:h}}gYk(b,h,u,B){let Q;h?Q=this.kCb.swa(h):(Q=this.kCb.twa(),h=Q.currentNode);B=cq.b(b,B,!0);B.Dg(Jc.a.Ww,qe.a.zF());54!==h.type&&B.setValue(Jc.a.j8,h.id);Q.QH(B,u,26);In.a.r4a&&!Wv(b)&&this.kCb.mYk(b,B);return B}}Object(m.a)(fz,"ContentControlCCP",null,[]);var Qt=c(724);class Dx{constructor(b,
h,u,B){this.Ld=b;this.Nf=h;this.gb=u;this.Ig=B}get qY(){return!!this.Nf.instance&&this.Nf.instance.qY}get BIb(){return!!this.Nf.instance&&this.Nf.instance.BIb}uua(b,h,u,B,Q,ca=ls.a.mDb,qa=ls.a.V5b,Qa=null,rb=ls.a.Hcf,Lb=-1){(b=this.AQc(b,u))?(b.Jb||(b.Jb=new az.a(b)),this.$pk(h,b.Jb,B,Q,ca,qa,Qa,rb,Lb)):r.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}GPh(b,h,u){if(b){new zb.a;for(let Q=0;Q<b.count;Q++){var B=this.bof(b.J(Q),h,!1);for(const ca of B)this.jXn(ca,
u)}}}ril(b,h){this.GPh(b,h,!0)}sil(b,h){this.GPh(b,h,!1)}Ge(b,h,u){this.Ld.Ge(b,h,u===Ob.a.T9c)}AQc(b,h){var u=Je.a.Oc(b,h);this.Ld.V7a(u);for(u=0;u<b.qa.length;u++){const B=b.qa.J(u);if(B.cp>h)break;if(B.cp===h)return B}return null}$pk(b,h,u,B,Q=ls.a.mDb,ca=ls.a.V5b,qa=null,Qa=ls.a.Hcf,rb=-1){const Lb=h.Kb.paragraph;b=new Qt.a(h.Kb,!0,!0,!0,null,b,B,u,Q,ca,qa,Qa,null,this.Ig);if(!this.qY||-1>=rb||rb>h.length)rb=h.length;h.insert(b,rb);Lb.Zl();b.oe?Lb.we.mY(b.oe-1,512):Lb.we.Xoa(b.oe,512);Lb.we.rq.Z(b.oe,
Ui.CharacterPropertiesEditor.$M);Lb.we.kt.Z(b.oe,Ui.CharacterPropertiesEditor.WR)}bof(b,h,u){const B=new zb.a;for(let Q=0;Q<b.qa.length;Q++){const ca=b.qa.J(Q);if(ca.Jb)for(let qa=0;qa<ca.Jb.length;qa++)if(ca.Jb.J(qa).ke.equals(h)&&(B.add(ca.Jb.J(qa)),u))return B}return B}lcd(b,h,u){if(this.BIb&&b){var B=b.node,Q=b.Ij,ca=b.np,qa=this.i6h(B,Q,h,!0);h=this.i6h(B,ca,h,!1);u?-1!==qa&&qa++:-1!==h&&h++;Q||-1===qa||(qa=Math.max(qa,this.gb.Lv(B)));ca===this.gb.textLength(B)&&-1!==h&&(h=Math.min(h,this.gb.ev(B)));
b.Fb=qa;b.Sb=h}}i6h(b,h,u,B){return(b=(b=b.qa.zh(h))?b.Jb:null)&&b.length?b.vJ(u,B):-1}jXn(b,h){b&&b.Kb.Jb&&(h?b.Kb.Jb.remove(b):b.Kb.Jb.Oqa(b),h=b.Kb.paragraph,0<=b.oe&&b.oe<h.we.length&&(b.Kb.cp||1!==h.we.length||(h.we.mY(0,512),h.we.rq.Z(1,Ui.CharacterPropertiesEditor.$M),h.we.kt.Z(1,Ui.CharacterPropertiesEditor.WR)),h.we.removeAt(b.oe,512)),h.Zl())}HWn(b){const h=b.qa;if(h){var u=new zb.a;for(let B=0;B<h.length;B++){const Q=h.J(B);if(Q&&Q.Jb){for(let ca=0;ca<Q.Jb.length;ca++)u.add(Q.Jb.J(ca).oe);
Q.Jb=null}}b.Mqa(u)}}nPo(b,h,u){if(!(0>h||0>u))for(this.Ld.V7a(Je.a.Oc(b,h)),this.Ld.V7a(Je.a.Oc(b,u)),h=b.qa.nca(h),u=b.qa.nca(u),--u;u>h;u--){const B=b.qa.J(u);B.tDf?b.qa.removeAt(u):B.formatting=null}}}Object(m.a)(Dx,"ContentControlChpManager",null,[474]);class wy{constructor(b,h,u,B,Q){this.gb=b;this.Io=h;this.vh=u;this.od=B;this.Ig=Q}dnf(b){if(!b||!Ge.SelectionEditor.ef(b))return null;if(!b.cpBegin){const h=this.m4h(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.gb.textLength(b.node)?
this.m4h(b.node,b.Fb-1,!1):null}aNl(b,h){b=this.XKh(b,h);return this.dnf(b)}m4h(b,h,u){return b.qa&&b.qa.length?(b=u?b.qa.first.Jb:b.qa.last.Jb)&&0<=h&&h<b.length&&b.J(h).Gf&&b.J(h).Qc===u&&this.ECf(b.J(h))?b.J(h):null:null}oqf(b){if(!b||!Ge.SelectionEditor.lv(b))return null;var h=this.Io.YPd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Gf&&this.ECf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Gf&&this.ECf(h)?null:b:null}ECf(b){if(!b)return!1;var h=this.Cci(b);if(!h)return!1;if(b.Qc)var u=b;else u=
h,h=b;var B=this.gb.textLength(b.Kb.paragraph);if(u.Kb.cp||h.Kb.cp!==B||!u.rp||u.Gxa||!h.rp||h.Gxa)return!1;u=u.Kb.Jb;h=h.Kb.Jb;for(B=0;B<u.length&&!u.J(B).ke.equals(b.ke);B++)if(!u.J(B).Qc)return!1;for(u=h.length-1;0<=u&&!h.J(u).ke.equals(b.ke);u--)if(h.J(u).Qc)return!1;return!0}Tbd(b){b=this.dnf(b);this.qHd(b,!1)}FBj(b,h){b=this.XKh(b,h);this.Tbd(b)}jJa(b){b=this.oqf(b);return this.qHd(b,!0)?b:null}qGm(b,h){b=this.dnf(b);return!!b&&b.ke.equals(h)}Cbc(b,h,u){b=this.aNl(b,h);return!!b&&b.ke.equals(u)}oEf(b,
h){b=this.oqf(b);return!!b&&b.ke.equals(h)}qHd(b,h){if(!b)return!1;const u=this.Cci(b);return this.fIh(b,h)&&(!u||this.fIh(u,h))}fIh(b,h){if(!b||b.Gf===h)return!1;var u=this.Io.wme(b.Kb.paragraph,b.Qc);const B=b.Kb.Jb;-1!==u||b.Qc||(u=B.length);const Q=h===b.Qc?1:-1;u+=h?Q:0;b=B.vJ(b.ke,b.Qc)+Q;if(u===b||0<Q!==b>u)return r.ULS.shipAssertTag(24933847,368,u!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",u,b,Q),r.ULS.shipAssertTag(24933848,
368,0<Q===b>u,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",u,b,Q),!1;for(var ca=u;ca!==b;ca+=Q){var qa=B.J(ca);B.Oqa(qa);qa.Gf=h;B.TCm(qa,ca);this.BUo(B.J(ca))}if(this.B0)for(B.Kb.paragraph.Zl(),ca=u;ca!==b;ca+=Q)qa=B.J(ca),qa.paragraph.we.rq.Z(qa.oe,Ui.CharacterPropertiesEditor.$M),qa.paragraph.we.kt.Z(qa.oe,Ui.CharacterPropertiesEditor.WR);h||this.iXo(B,u,b,Q);r.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",
Math.abs(b-u),h?"block":"inline");return!0}ISd(b){return b.Qc&&this.Ig.Cq(b.contentControlNode.id,!0).equals(b.Kb.paragraph.id)?38:!b.Qc&&this.Ig.Cq(b.contentControlNode.id,!1).equals(b.Kb.paragraph.id)?39:b.Gf&&b.Qc?40:b.Gf&&!b.Qc?41:!b.Gf&&b.Qc?38:39}BUo(b){const h=b.Kb.paragraph.Lc;if(h){var u=h.Eb(b.dv),B=b.contentControlNode;if(u){u=u.clone();u.setValue(Jc.a.WGf,b.Gf);const Q=this.ISd(b);u.setValue(Jc.a.Is,Q);h.Su(u,null);b.dv=u.id}B&&B.setValue(Jc.a.k9,b.Gf)}}Cci(b){if(b.Kb.cp&&b.Kb.cp!==this.gb.textLength(b.Kb.paragraph)||
!b.Kb.paragraph.qa||!b.Kb.paragraph.qa.length)return null;const h=b.Qc?b.Kb.paragraph.qa.last:b.Kb.paragraph.qa.first;if(!h.Jb)return null;b=h.Jb.vJ(b.ke,!b.Qc);return-1===b?null:h.Jb.J(b)}iXo(b,h,u,B){var Q=b.J(h).contentControlNode;if(Q){var ca=b.J(h).Qc;Q=this.Ig.Cq(Q.id,ca);if(!Q.equals(W.a.nil))if(b.Kb&&b.Kb.paragraph&&b.Kb.paragraph.id.equals(Q)){for(h+=B;h!==u;h+=B){const qa=b.J(h).contentControlNode;if(!qa)return;this.Ig.pE(qa.id,Q,ca)}0<=u&&u<b.length&&b.J(u).Gf&&this.KGf(b.J(u))&&(b=b.J(u).contentControlNode)&&
this.Ig.pE(b.id,Q,ca)}else r.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}KGf(b){return b.rp&&!b.Gxa}XKh(b,h){if(!b||!this.vh)return null;const u=h?Je.a.Oc(b,0):Je.a.rw(b);b=this.vh.ar(b,h);u.Sb=u.Fb=b;return u}get B0(){return this.od.isFeatureEnabled(32)}}Object(m.a)(wy,"ContentControlConverter",null,[310]);var Ow;(function(b){b[b.e7o=0]="BoundingBox";b[b.bap=1]="Tags";b[b.C8o=2]="Hidden";b[b.K9o=3]="NumberOfContentControlAppearance"})(Ow||
(Ow={}));Object(m.b)("ContentControlAppearance",Ow);var Zu=c(1630);class XA{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.vab=this.mCa=this.Sjd=this.Iwd=this.prd=null;this.Jka=this.Zj=this.nAc=this._id=0;this.PVb=this.$sd=this.Dxd=this._title=this.HAa=null;this.rod=this.qod=this.z1g=this.gud=this.Iwc=this.Ewc=this.ljd=!1;this.Q2g=null;this.Gf=!1;this.Ghd=null;this.ei=u;this.Bx=h;this.Rg=B;this.mr=Q;this.em=ca;this.w2=qa;this.dfa=Qa;this.Yfa=rb;this.Yzb=Lb;this.Ig=Yb;b?(this.prd=b.id,this.Ghd=b,this.eU(!1)):
this._id=qe.a.zF()}get nj(){return this.ei.value}get id(){this.eU();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.Ww,this._id),this.mZ())}get parentId(){this.eU();return this.nAc}set parentId(b){this.nAc=b}get title(){this.eU();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.Sfb,this._title),this.mZ(),this.ncd(h=>{h.title=this._title?this._title:ls.a.mDb}))}get tag(){this.eU();return this.Dxd}set tag(b){this.Dxd=
b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.Vfb,this.Dxd),this.mZ())}get type(){this.eU();return this.Zj}set type(b){this.Zj=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.Wfb,Zu.a[this.Zj]),this.mZ())}get appearance(){this.eU();return this.Jka}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Jka=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.Tfb,Ow[this.Jka].toLowerCase()),this.mZ(),this.ncd(h=>{h.appearance=
Ow[this.Jka].toLowerCase()}))}get color(){this.eU();return this.HAa}set color(b){if(b&&16777215>=b)this.HAa=b,this.isValid()&&(this.contentControlNode.setValue(Jc.a.ZIc,this.HAa),this.mZ(),this.ncd(h=>{h.color=this.HAa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.eU();return this.$sd}set placeholderText(b){this.$sd=b;In.a.r4a&&this.Rg.pEj(b,this.Ghd)&&(this.mZ(),this.JJ&&this.em.GAb(this,!0))}get HKd(){this.eU();return this.PVb}set HKd(b){this.PVb=
b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.jCb,this.PVb),this.mZ())}get iff(){this.eU();return this.ljd}set iff(b){b&&(this.ljd=b,this.isValid()&&(this.contentControlNode.setValue(Jc.a.bHd,this.ljd),this.mZ()))}get removeWhenEdited(){this.eU();return this.gud}set removeWhenEdited(b){if(b&&!this.$ha)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.gud=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.DHh,this.gud),
this.mZ())}get $ha(){this.eU();return this.Ewc}set $ha(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.Ewc=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.R4b,this.Ewc),this.ncd(h=>{h.ZK=this.Ewc}),this.mZ())}get isEditable(){this.eU();return this.Iwc}set isEditable(b){this.Iwc=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.lCb,this.Iwc),this.ncd(h=>{h.editable=
this.Iwc}),this.mZ())}get isSupported(){this.eU();return this.z1g}get OQm(){return this.isSupported&&11!==this.type&&10!==this.type}get YTm(){this.eU();return this.PVb&&"table of contents"===this.PVb.toLowerCase()?!0:!1}get k_d(){this.eU();return this.qod}set k_d(b){this.qod=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.GHh,this.qod),this.mZ())}get Ncc(){this.eU();return this.rod}set Ncc(b){this.rod=b;this.isValid()&&(this.contentControlNode.setValue(Jc.a.HHh,this.rod),this.mZ())}get JJ(){return this.contentControlNode.ja(Jc.a.k8,
!1)}set JJ(b){this.isValid()&&this.contentControlNode.setValue(Jc.a.k8,b)}get xu(){this.eU();return this.Iwd}set xu(b){this.Iwd=b}get Az(){this.eU();return this.Sjd}set Az(b){this.Sjd=b}get objectId(){return this.prd}set objectId(b){this.prd=b;this.Ghd=this.nj.Eb(this.prd)}get start(){this.fGj();return this.mCa}set start(b){this.mCa=b}get end(){this.fGj();return this.vab}set end(b){this.vab=b}get contentControlNode(){return this.Ghd}pyn(b){for(let h=0;3>h;++h)if(Ow[h].toLowerCase()===b)return h;return 0}mZ(){const b=
this.start.node;b&&b.setValue(Xe.a.KR,new Date)}zcd(){this._id=this.contentControlNode.ja(Jc.a.Ww,0);this.Jka=this.pyn(this.contentControlNode.ja(Jc.a.Tfb,null));this.HAa=this.contentControlNode.ja(Jc.a.ZIc,null);this._title=this.contentControlNode.ja(Jc.a.Sfb,null);this.Dxd=this.contentControlNode.ja(Jc.a.Vfb,null);this.Gf=this.contentControlNode.ja(Jc.a.k9,!1);this.Ewc=this.contentControlNode.ja(Jc.a.R4b,!1);this.Iwc=this.contentControlNode.ja(Jc.a.lCb,!1);this.z1g=this.contentControlNode.ja(Jc.a.Ega,
!1);this.PVb=this.contentControlNode.ja(Jc.a.jCb,null);this.ljd=this.contentControlNode.ja(Jc.a.bHd,!1);this.Iwd=this.Ig.Cq(this.contentControlNode.id,!0);this.Sjd=this.Ig.Cq(this.contentControlNode.id,!1);this.rod=this.contentControlNode.ja(Jc.a.HHh,!1);this.qod=this.contentControlNode.ja(Jc.a.GHh,!1);this.gud=this.contentControlNode.ja(Jc.a.DHh,!1);this.Zj=Object(Zu.b)(this.contentControlNode.ja(Jc.a.Wfb,"RichText"));let b=null;try{const h=this.contentControlNode.ja(Jc.a.j8,W.a.nil);if(W.a.zq(h,
W.a.nil))this.nAc=0;else if(b=this.nj.Eb(h))this.nAc=b.ja(Jc.a.Ww,0)}catch(h){this.nAc=0}this.eWo()}eWo(){if(this.Yzb){var b=this.contentControlNode.ja(Jc.a.oOa,"");if((b=this.dfa.Kii(b))&&0<b.length){this.$sd=this.w3h(b.Pa,b.Rc);return}}this.$sd=(b=this.Rg.twa())&&b.currentNode?b.currentNode.ja(Jc.a.$Ic,null):null}eU(b=!0){if(!b||this.isValid())b=this.contentControlNode.ja(Xe.a.lastModifiedTime,new Date(0)),this.Q2g!==b?(r.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.zcd(),this.Q2g=b):r.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}hXo(b,h){this.Iwd=b;this.Sjd=h;this.Ig.pE(this.contentControlNode.id,b,!0);this.Ig.pE(this.contentControlNode.id,h,!1)}fGj(){if(this.contentControlNode){var b=this.xu,h=this.Az;if(!b||!h||b.equals(W.a.nil)||h.equals(W.a.nil))r.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");
else if(b=this.Rg.hoa(b,!0),h=this.Rg.hoa(h,!1),b&&h)if(b.isConnected&&h.isConnected||r.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Gf)b=Je.a.create(b),this.mr.lcd(b,this.objectId,!0),this.start=b,b=Je.a.create(h),this.mr.lcd(b,this.objectId,!0),this.end=b;else{let u=h=-1;if(b.qa){for(let B=0;B<b.qa.length&&(-1===h||-1===u);B++){const Q=b.qa.J(B);if(Q.Jb)for(let ca=0;ca<Q.Jb.length&&(-1===h||-1===u);ca++){const qa=Q.Jb.J(ca);W.a.zq(qa.ke,this.objectId)&&(qa.Qc?
h=Q.cp:u=Q.cp)}}0<=h&&0<=u&&(b=Je.a.FO(h,u,!1,b),this.mr.lcd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const u=this.end;if(!h||!u)return b;this.Gf?b=this.w3h(h,u):(h=me.ParagraphReader.text(h.node).substring(h.cpBegin,u.cpEnd),b+=wp.AParagraphNode.NP(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}Uge(b){return this.Yfa?this.em.emj(this,b)?0:2:2}clear(){return this.Yfa?this.em.emj(this,"")?0:2:2}p5h(){const b=new zb.a;
var h=this.contentControlNode.ja(Jc.a.contentControlNode,[]);for(const u of h)if(!W.a.zq(u,W.a.nil)){h=this.ei.value.Eb(u);try{b.add(this.w2.yCb(h,this.Bx,this.ei,this.Rg,this.mr,this.em,this.dfa,this.Yfa,this.Yzb))}catch(B){}}return b}Bmf(){const b=new zb.a;this.n3h(this,b);return b}n3h(b,h){b=b.p5h();if(b.count)for(const u of b)h.add(u),this.n3h(u,h)}gF(b=!1){const h=new zb.a;if(this.Gf){var u=this.em.jU(this.start,this.end);for(var B of u)u=Je.a.create(B),this.mr.lcd(u,this.objectId,b),h.add(u)}else B=
this.start.clone(),this.mr.lcd(B,this.objectId,b),h.add(B);return h}ncd(b){const h=this.em.jU(this.start,this.end);for(let u=0;u<h.count;u++){const B=this.mr.bof(h.J(u),this.objectId,!1);if(B){for(let Q=0;Q<B.count;Q++)b(B.J(Q));h.J(u).fk()}}}w3h(b,h){const u=new Sys.StringBuilder;h=this.em.jU(b,h);for(const B of h)B.id.equals(b.node.id)||u.append("\r"),u.append(me.ParagraphReader.Hda(B));return u.toString()}}Object(m.a)(XA,"ContentControl",null,[339]);class $B{constructor(b){this.Ig=b}yCb(b,h,u,
B,Q,ca,qa,Qa,rb){return new XA(b,h,u,B,Q,ca,this,qa,Qa,rb,this.Ig)}}Object(m.a)($B,"ContentControlFactory",null,[308]);class YA{constructor(b,h,u,B,Q){this.ei=b;this.mr=h;this.vkk=u;this.OW=B;this.Ga=Q}CSo(b,h,u){var B,Q;if(!(In.a.v9e&&b&&h&&u))return!1;const ca=b.contentControlNode;if(!ca)return!1;var qa=ca.ja(Jc.a.mCb,W.a.nil);qa&&!qa.equals(W.a.nil)?b=this.ei.value.Eb(qa):(b=this.mr.AQc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(B=null===b||void 0===b?void 0:b.formatting)||void 0===
B?void 0:B.En,b||(b=new Qy.a,this.ei.value.Su(b,null)),ca.setValue(Jc.a.mCb,b.id));B=this.ei.value.Eb(b.id);qa="boolean"===typeof u&&u;const Qa=null===(Q=this.Ga)||void 0===Q?void 0:Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.vkk.Gpf(ca,B,h,u,Qa?null:qa);h=this.OW.hoe(h);for(const [rb,Lb]of h)b.setValue(rb,Lb);return!0}}Object(m.a)(YA,"ContentControlFormattingManager",null,[307]);var CC=c(935);class Xv{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){this.Bx=
b;this.ei=h;this.Zc=u;this.pxb=B;this.qYj=Q;this.BK=ca;this.mh=qa;this.gb=Qa;this.wsd=rb;this.ild=Lb;this.Ig=Yb;this.KBe=gc;this.dfa=Fc}get mx(){return this.Bx.value}twa(){const b=this.Zc.yk();b.set(this.mx);this.pxb.EP(b);if(b.Ub(25))return b;this.ild.instance&&this.ild.instance.ipa&&r.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");r.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}RPc(b,h,u=!1){this.n7b();const B=new zb.a;
let Q;if(b){Q=b.Ub(26);if(!Q)return B;for(;Q&&(!h(Q)||(B.add(Q),!u));){B.addRange(this.RPc(b,h));if(u&&0<B.count)break;Q=b.Jf(26)}b.rc()}return B}f6l(){const b=this.Zc.yk();b.set(this.Bx.value);this.pxb.EP(b);return b.currentNode}cRa(b,h,u){let B;B=b.equals(h);B||(B=(b=this.hoa(b,u))?b.id.equals(h):!1);return B}oPa(b,h){b=this.ou(b);if(!b)return null;let u=null;for(;55===b.type;){const B=this.Ig.Cq(b.id,h);if(B.equals(u)){b=null;break}else b=this.ou(B);u=B}return b}hoa(b,h){return(b=this.oPa(b,h))?
me.ParagraphReader.Wb(b)?b:h?this.gb.fl(b):this.gb.YD(b):null}EPh(b,h=!1){this.HRo(b);this.FPh(b,h)}HRo(b){var h=this.swa(b);h=this.swa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let u,B;u=this.ou(this.Ig.Cq(b.id,!0));for(B=this.ou(this.Ig.Cq(b.id,!1));u&&55===u.type;)u=this.ou(this.Ig.Cq(u.id,!0));for(;B&&55===B.type;)B=this.ou(this.Ig.Cq(B.id,!1));u&&B&&this.GDj(u.id,B.id,h,Q=>{Q=Q.ja(Jc.a.tX,W.a.nil);return!Q||Q.equals(W.a.nil)||b.id.equals(Q)})}FPh(b,h=!1){r.ULS.sendTraceTag(528537620,
368,50,"Attempting to delete content control node");var u=this.swa(b);const B=this.swa(u.parentNode);let Q=W.a.nil,ca=W.a.nil;var qa=B.currentNode.ja(Jc.a.contentControlNode,[]);const Qa=new zb.a;for(var rb=0;rb<qa.length;rb++)Qa.add(qa[rb]);if(h){if(54!==B.currentNode.type){Q=this.Ig.Cq(B.currentNode.id,!0);ca=this.Ig.Cq(B.currentNode.id,!1);qa=this.ou(Q);for(rb=this.ou(ca);qa&&55===qa.type;)Q=this.Ig.Cq(qa.id,!0),qa=this.ou(Q);for(;rb&&55===rb.type;)ca=this.Ig.Cq(rb.id,!1),rb=this.ou(ca)}qa=this.swa(b);
if(qa.Ub(26)){rb=new zb.a;for(rb.add(qa.currentNode);qa.Jf(26);)rb.add(qa.currentNode);for(var Lb of rb)this.FPh(Lb,h)}}else if(Q=this.Ig.Cq(b.id,!0),ca=this.Ig.Cq(b.id,!1),h=this.PZl(Qa,b.id),Lb=this.swa(b),Lb.Ub(26)){qa=this.swa(Lb.currentNode);rb=qa.currentNode;let Yb=b;for(;rb;){const gc=Lb.currentNode;Qa.insert(h++,gc.id);rb=qa.Jf(26);const Fc=this.swa(gc);54!==B.currentNode.type?gc.setValue(Jc.a.j8,B.currentNode.id):gc.removeProperty(Jc.a.j8);cq.h(Fc,B,Yb,26);Yb=Fc.currentNode;rb&&(Lb.set(rb),
Lb.T1(this.twa().currentNode))}}54!==B.currentNode.type&&(h=this.Ig.Cq(B.currentNode.id,!0),Lb=this.Ig.Cq(B.currentNode.id,!1),h.equals(b.id)&&this.Ig.pE(B.currentNode.id,Q,!0),Lb.equals(b.id)&&this.Ig.pE(B.currentNode.id,ca,!1));u.vg();r.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Qa,b.id);qa=Array(Qa.count);for(u=0;u<Qa.count;u++)qa[u]=Qa.J(u);B.currentNode.setValue(Jc.a.contentControlNode,qa);CC.a.DGa(b.id)}Zpk(b,h,u,B,Q,ca,qa=null){let Qa;if(h){var rb=this.ou(h.objectId);
Qa=this.swa(rb)}else Qa=this.twa(),rb=Qa.currentNode;const Lb=this.qYj.create(1074135145);qa&&Lb.properties.Yw(qa.properties);54!==rb.type&&Lb.setValue(Jc.a.j8,rb.id);qa?Qa.ZHb(Lb,u,26,qa.id):Qa.QH(Lb,u,26);In.a.iCb?(this.gGj(b,Lb.id,Q,!0),this.gGj(b,Lb.id,ca,!1)):(this.Ig.pE(Lb.id,Q,!0),this.Ig.pE(Lb.id,ca,!1));b.Gf&&(h&&(u=this.Ig.Cq(rb.id,!0),qa=this.Ig.Cq(rb.id,!1),u.equals(Q)&&this.Ig.pE(rb.id,Lb.id,!0),qa.equals(ca)&&this.Ig.pE(rb.id,Lb.id,!1)),this.GDj(Q,ca,Lb.id,Yb=>{Yb=Yb.ja(Jc.a.tX,W.a.nil);
const gc=h?h.objectId:null;return!Yb||Yb.equals(W.a.nil)||Yb.equals(gc)}));Q=this.swa(Lb);ca=Array(B.count);for(rb=B.count-1;0<=rb;rb--)ca[rb]=B.J(rb).objectId,u=this.ou(B.J(rb).objectId),u=this.swa(u),u.currentNode.setValue(Jc.a.j8,Lb.id),cq.h(u,Q,null,26);0<ca.length&&Lb.setValue(Jc.a.contentControlNode,ca);Xv.Zb.isFeatureEnabled(39)&&(b.HKd&&Lb.setValue(Jc.a.jCb,b.HKd),b.iff&&Lb.setValue(Jc.a.bHd,!0));return Lb}gGj(b,h,u,B){12===this.ou(u).type?this.Ig.pE(h,u,B):(this.Ig.Pog(h,u,B),this.Ig.pE(h,
B?b.start.node.id:b.end.node.id,B))}jfo(b,h,u,B,Q){b.setValue(Jc.a.k9,h);b.setValue(Jc.a.R4b,!0);b.setValue(Jc.a.lCb,!0);b.setValue(Jc.a.Ww,u);b.setValue(Jc.a.Tfb,Ow[0]);b.setValue(Jc.a.Ega,!0);b.setValue(Jc.a.Wfb,Zu.a[Q]);B&&b.setValue(Jc.a.Sqb,B);b.setValue(Jc.a.S4b,0)}HDj(b,h=null,u=null){h&&this.Ig.pE(b,h,!0);u&&this.Ig.pE(b,u,!1)}UPh(b){if(!b||!b.count||!b.J(0))return null;const h=this.qsf(b);for(let u=0;u<b.count;u++)this.mh.Vya(b.J(u));return h}qsf(b){if(!b||!b.J(0))return null;const h=this.Zc.yk();
h.set(b.J(0));h.rd();h.rc();return h.AJ()?h.currentNode:null}q7l(b){const h=this.Zc.yk();h.set(b);h.rd();h.rc();h.rc();return h}Onh(b,h,u){const B=new zb.a;for(let Q=0;Q<u;Q++){h=this.BK.akb(b,h,!0,null);if(!h||!b.Qd())return null;const ca=b.currentNode;b.rc();b.rc();B.add(ca)}return B}z$b(b){const h=this.Zc.yk();h.set(b);for(h.zb(7);h.rc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}pci(b){const h=this.Zc.yk();h.set(b);h.rd();return(b=h.ATa())?b.id:
null}vqf(b){const h=this.Zc.yk();h.set(b);return h.zb(7)?h:null}ou(b){return this.ei.value.Eb(b)}n7b(){if(!Xv.YZg){var b=this.twa();b&&this.dmg(b);Xv.YZg=!0}}mUa(b){return this.wsd.mUa(b)}yyk(b,h){const u=this.Zc.yk();u.set(b.node);const B=this.Zc.yk();B.set(h.node);u.rd();B.rd();const Q=this.Zc.yk();Q.set(u.currentNode);const ca=this.Zc.yk();ca.set(B.currentNode);const qa=qg.returnToLowestCommonTableCell(u,B);return qa?(Q.rd(),ca.rd(),{returnValue:({ml:b}=this.MBb(Q,!0,qa,b)).returnValue&&({ml:h}=
this.MBb(ca,!1,qa,h)).returnValue,M$c:b,mMc:h}):{returnValue:({ml:b}=this.MBb(u,!0,null,b)).returnValue&&({ml:h}=this.MBb(B,!1,null,h)).returnValue,M$c:b,mMc:h}}MBb(b,h,u,B){let Q=null,ca=b.ld(16);for(;ca!==u;){if(h&&Jf.TableCellReader.Gwi(b)||!h&&Jf.TableCellReader.EEf(b))Q=b.ld(14);else return{returnValue:!1,ml:B};ca=b.ld(16)}Q&&(B=Je.a.create(Q));return{returnValue:!0,ml:B}}dmg(b){if(b.Ub(26)){for(this.dmg(b);b.Jf(26);)this.dmg(b);b.rc()}}remove(b,h){for(let u=0;u<b.count;u++)if(b.J(u).toString()===
h.toString()){b.removeAt(u);break}}swa(b){const h=this.Zc.yk();h.set(b);h.T1(this.twa().currentNode);return h}PZl(b,h){for(let u=0;u<b.count;u++)if(b.J(u).equals(h))return u;return-1}GDj(b,h,u,B){b=this.JQl(b,h);for(h=0;h<b.count;h++)B(b.J(h))&&(u?b.J(h).setValue(Jc.a.tX,u):b.J(h).removeProperty(Jc.a.tX),this.ild.instance&&this.ild.instance.Nui&&b.J(h).gl(16,!0))}JQl(b,h){const u=new zb.a;var B=this.ou(b);const Q=this.ou(h);if(!B||!Q)return u;const ca=({WYc:qa}=this.iPd(B,Q)).returnValue;B=qa[ca];
if(14===B.type)u.add(B);else if(15===B.type&&1<=ca){const Qa=qa[ca-1];1===Zi.TableReader.eg(Qa)&&u.add(Qa)}var qa=vd.GraphIterator.eb(ca>=qa.length-1?B:qa[ca+1]);qa.zb(7);for(B=Fa.a.zs(qa,B);B.moveNext()&&B.currentNode!==Q;)14===B.currentNode.type&&u.add(B.currentNode);if(!W.a.zq(h,b)&&14===Q.type)for(qa=vd.GraphIterator.eb(Q),B=Fa.a.zs(qa,Q);B.moveNext();)14===B.currentNode.type&&u.add(B.currentNode);return u}iPd(b,h){b=this.fib(b);h=this.fib(h);let u=0;for(;u<b.length&&u<h.length&&b[u]===h[u];++u);
return{returnValue:0<u?u-1:u,WYc:b,X9f:h}}fib(b){const h=[];h.push(b);b=vd.GraphIterator.eb(b);for(b.zb(7);b.rc();)h.push(b.currentNode);h.reverse();return h}static get Zb(){return null!=Xv.zxg?Xv.zxg:Xv.zxg=Ga.a.instance.Oa("Box4.IFeatureHelper")}MJc(b,h,u=!1){b=this.KBe.instance.Bal(b);u?(u=ls.a.$gl,b.setValue(Jc.a.F$b,u)):u=b.ja(Jc.a.F$b,null);h.setValue(Jc.a.oOa,u)}mYk(b,h){this.D0i(b)&&(b=b.ja(Jc.a.oOa,null),b=this.KBe.instance.pYk(b).ja(Jc.a.F$b,null),h.setValue(Jc.a.oOa,b))}pEj(b,h){if(!this.D0i(h))return!1;
var u=h.ja(Jc.a.oOa,null);u?Wv(h)?this.MJc(b,h):this.KBe.instance.fWo(u,b):(u=this.dfa.c7h())?h.setValue(Jc.a.oOa,u):this.MJc(b,h,!0);return!0}D0i(b){if(!b)return!1;var h=b.getValue(Jc.a.Wfb);if(!h)return!1;h=Object(Zu.b)(h);b=b.getValue(Jc.a.jCb);return(0==h||1==h)&&b!==Vi.KSh}}Xv.YZg=!1;Object(m.a)(Xv,"ContentControlGraphManager",null,[311]);class Yv{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.Zve=Lb;this.Ika=null;this.$Om=(Yb,gc)=>{if(this.qY)return this.aPm(Yb,gc);if(!Yb||!Yb.count)return r.ULS.sendTraceTag(17356048,
368,15,"The GNC list should not be null or empty"),!1;let Fc=!0;switch(gc){case 0:gc=this.gL(Yb.J(0),Yb.J(Yb.count-1),1);if((Yb=this.gL(Yb.J(0),Yb.J(Yb.count-1),3))&&0<Yb.count){if(!Yb.J(0).isSupported||!Yb.J(0).isEditable){Fc=!1;break}for(Yb=Yb.J(0);Yb;)this.K5c(gc,Yb.id),Yb=this.getById(Yb.parentId)}if(gc)for(var Sc of gc)if(!Sc.isSupported||!Sc.isEditable){Fc=!1;break}break;case 1:if(Yb.J(0).contextId!==vc.a.Tc){r.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");
Fc=!1;break}(gc=this.gL(Yb.J(0),Yb.J(0),1))&&0<gc.count&&(Fc=!1);break;case 2:if(Yb.J(0).contextId!==vc.a.Tc){r.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Fc=!1;break}(gc=this.gL(Yb.J(0),Yb.J(0),3))&&0<gc.count&&(Fc=!1);break;case 3:case 4:gc=this.vRd(Yb.J(0),!0);Sc=this.vRd(Yb.J(Yb.count-1),!1);if(!gc||!Sc){r.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");
Fc=!1;break}if((gc=this.gL(gc,gc,3))&&0<gc.count){Fc=!1;break}if((gc=this.gL(Sc,Sc,3))&&0<gc.count){Fc=!1;break}if(gc=this.em.gL(Yb.J(0),Yb.J(Yb.count-1),1))for(const ld of gc)if(!ld.$ha){Fc=!1;break}break;default:Fc=!1}return Fc};Yv.Bx=b;Yv.ei=h;this.Rg=u;this.mr=B;this.em=Q;this.w2=ca;this.dfa=qa;this.Nf=Qa;this.Io=rb}get GQa(){return!!this.Nf.instance&&this.Nf.instance.GQa}get ipa(){return!!this.Nf.instance&&this.Nf.instance.ipa}get BYd(){return!!this.Nf.instance&&this.Nf.instance.BYd}get qY(){return!!this.Nf.instance&&
this.Nf.instance.qY}get EYd(){return!!this.Nf.instance&&this.Nf.instance.EYd}BIb(){return!!this.Nf.instance&&this.Nf.instance.BIb}Ama(b,h,u=null,B=null,Q=!1){if(!this.GQa)return{returnValue:2,id:0};b=this.Rg.hoa(b,!0);h=this.Rg.hoa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Je.a.create(b);h=Je.a.create(h);return this.Bmh(b,h,u,B,Q,0,!1)}epk(b,h,u=0,B=!1){return this.GQa&&b&&h?this.Bmh(b,h,null,null,!1,u,B):{returnValue:2,id:0}}TZa(b,h=null,u=0,B=!1){let Q=0;if(!this.GQa)return{returnValue:2,id:Q};
const ca=this.w2.yCb(h,Yv.Bx,Yv.ei,this.Rg,this.mr,this.em,this.dfa,this.GQa,this.BYd);ca.type=u;ca.start=b;ca.end=b;ca.xu=b.node.id;ca.Az=b.node.id;ca.Gf=!1;return this.em.Cnh(ca,h,B)?(Q=ca.id,{returnValue:0,id:Q}):{returnValue:2,id:Q}}Ypk(b,h=null){if(!this.GQa||!this.pLm(b))return{returnValue:2,id:0};var u=b.J(0).contextId===vc.a.Uc?b.J(1):b.J(0);const B=b.J(b.count-1);if(this.c9e(b,vc.a.paragraph)||this.c9e(b,vc.a.Uc)){b=u.node.id;let Q=B.node.id;const ca=b.equals(Q);u=this.em.gtj(u,!0);void 0!==
u&&null!==u&&(b=u,Q=ca?b:Q);this.em.gtj(B,!1);h.setValue(Jc.a.k9,!0);return this.Ama(b,Q,h)}return u!==B||u.contextId!==vc.a.Jd&&u.contextId!==vc.a.Tc?{returnValue:2,id:0}:(h.setValue(Jc.a.k9,!1),this.TZa(u,h))}getById(b){if(!this.ipa)return null;const h=this.Rg.RPc(this.Rg.twa(),u=>u.getValue(Jc.a.Ww)===b,!0);return 0<h.count?this.em.mR(h.J(0)):null}getByTitle(b){if(!this.ipa)return null;const h=this.Rg.RPc(this.Rg.twa(),B=>B.ja(Jc.a.Sfb,null)===b,!1),u=new zb.a;for(const B of h)u.add(this.em.mR(B));
return u}getByTag(b){if(!this.ipa)return null;const h=this.Rg.RPc(this.Rg.twa(),B=>B.ja(Jc.a.Vfb,null)===b,!1),u=new zb.a;for(const B of h)u.add(this.em.mR(B));return u}gL(b,h,u,B=!1){return this.ipa?this.qY?this.em.joa(b,h,u):this.em.gL(b,h,u,B):null}jU(b,h){return this.em.jU(b,h)}XKl(){if(!this.ipa)return null;const b=this.Rg.RPc(this.Rg.twa(),()=>!0,!1),h=new zb.a;for(const u of b)h.add(this.em.mR(u));return h}rOb(b){if(!this.GQa)return r.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),
2;b=this.getById(b);return this.em.Sya(b)?0:2}gil(b){if(!this.GQa)return 2;b=this.getById(b);return this.em.deleteContentControl(b)?0:2}oqk(b){this.em.E7i(b)}DIk(b){this.Ika=b;this.Ika.CUn(this.$Om)}XQl(b){if(!this.BIb())return null;let h;var u=b.gF();h=this.vRd(u.J(u.count-1),!1);u=this.mr.AQc(u.J(u.count-1).node,h.cpBegin).Jb;b=this.Zem(u,b);if(-1===b)return null;h.Fb=b;h.Sb=h.Fb;return h}aPm(b,h){if(!b||!b.count)return r.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),
!1;switch(h){case 0:return this.CJm(b);case 3:case 4:case 6:return this.ZQm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==vc.a.Tc?(r.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.Exi(b.J(0),5===h,!1);default:return!1}}CJm(b){const h=this.em.joa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var u=h.J(0);if(!u.isSupported||!u.isEditable)return!1}b=this.em.joa(b.J(0),b.J(b.count-1),
1);for(u=0;h&&u<h.count;u++)this.K5c(b,h.J(u).id);if(b)for(const B of b)if(!B.isSupported||!B.isEditable)return!1;return!0}ZQm(b,h){var u=b.J(0),B=b.J(b.count-1),Q=u.Ij,ca=B.np;if(-1===Q||-1===ca)return!1;Q=this.Io.Q8(u.node,Q,u.Fb);ca=this.Io.Q8(B.node,ca,B.Sb);var qa=-1,Qa=Math.min(Q.count,ca.count);for(--Qa;0<=Qa;Qa--){const rb=Q.J(Qa).ke,Lb=ca.J(Qa).ke;if(rb.equals(Lb)){qa=Qa;break}}if(-1<qa&&(Qa=this.em.mR(Q.J(qa).contentControlNode),!Qa.isEditable||!Qa.isSupported||Qa.JJ&&!this.eJm(Qa,b)))return!1;
u=this.em.joa(u,B,1);for(B=0;B<=qa;B++)this.K5c(u,this.em.mR(Q.J(B).contentControlNode).id);for(B=qa+1;B<Q.count;B++){Qa=this.em.mR(Q.J(B).contentControlNode);if(!Qa.isEditable||!Qa.$ha||!Qa.isSupported||Qa.JJ)return!1;this.K5c(u,Qa.id)}for(Q=qa+1;Q<ca.count;Q++){qa=this.em.mR(ca.J(Q).contentControlNode);if(!qa.isEditable||!qa.$ha||!qa.isSupported||qa.JJ)return!1;this.K5c(u,qa.id)}if(u)for(const rb of u)if(!rb.isSupported||!rb.$ha)return!1;return h&&(b=this.vRd(b.J(0),!0))?this.Exi(b,!0,!0):!0}eJm(b,
h){h=this.Io.m7l(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.ke)}Exi(b,h,u){return(b=this.em.joa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.EYd&&h&&!b.Gf||!u&&b.JJ||In.a.P_f&&h&&1===b.type)?!1:!0}vRd(b,h){if(!b)return null;let u=null;switch(b.contextId){case vc.a.paragraph:u=h?Je.a.Oc(b.node,0):Je.a.rw(b.node);break;case vc.a.Uc:u=Je.a.rw(b.node);break;case vc.a.Jd:u=h?Je.a.Oc(b.node,b.cpBegin):Je.a.Oc(b.node,b.cpEnd);break;case vc.a.Tc:u=b}u&&(u.Sb=u.Fb=h?b.Fb:
b.Sb);return u}K5c(b,h){if(b)for(const u of b)if(u.id===h){b.remove(u);break}}Zem(b,h){if(!b)return-1;let u=-1;for(let B=0;B<b.length;B++)if(b.J(B).ke.equals(h.objectId)&&!1===b.J(B).Qc){u=B;if(h.Gf&&0<B&&b.J(B-1).Gf&&!b.J(B-1).Qc)return-1;break}return u}pLm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const u=b.J(h).contextId;if(u!==vc.a.paragraph&&u!==vc.a.Uc&&u!==vc.a.Jd&&u!==vc.a.Tc||0<h&&h<b.count-1&&u===vc.a.Jd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===
vc.a.Uc&&1===b.count||this.c9e(b,vc.a.Tc)&&1<b.count?!1:!0}c9e(b,h){for(const u of b)if(u.contextId===h)return!0;return!1}Bmh(b,h,u=null,B=null,Q=!1,ca=0,qa=!1){let Qa=0;var rb=h.node;let Lb=Je.a.create(b.node);rb=Je.a.create(rb);if(In.a.iCb){if(!({M$c:Lb,mMc:rb}=this.Zve.wCh(Lb,rb)).success)return{returnValue:2,id:Qa}}else if(!({M$c:Lb,mMc:rb}=this.Rg.yyk(Lb,rb)).returnValue)return{returnValue:2,id:Qa};const Yb=this.w2.yCb(u,Yv.Bx,Yv.ei,this.Rg,this.mr,this.em,this.dfa,this.GQa,this.BYd);Yb.type=
ca;Yb.start=b;Yb.end=h;Yb.xu=Lb.node.id;Yb.Az=rb.node.id;Yb.Gf=!0;Yb.HKd=B;Yb.iff=Q;return this.em.Cnh(Yb,u,qa)?(Qa=Yb.id,{returnValue:0,id:Qa}):{returnValue:2,id:Qa}}}Yv.Bx=null;Yv.ei=null;Object(m.a)(Yv,"ContentControlManager",null,[309]);var ut=c(631),aC=c(143),Fs=c(191);class gz extends Sys.EventArgs{constructor(b){super();this.cOh=b}}Object(m.a)(gz,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var ZA=c(1497);class $A{constructor(){this.fQi=0;this.ZZi=null}}Object(m.a)($A,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",
null,[]);const Ex=b=>!(null===b||void 0===b?0:b.length),aB=b=>null==b?!1:[...b].some(h=>h.Qc),Zv=b=>null==b?!1:[...b].some(h=>!h.Qc);class Gs{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe,de,ne,ye,Vf,Og,Bl,sm){this.Bj=Bl;this.Pah=[];this.xOe=[];this.Bx=b;this.ei=h;this.Rg=u;this.mr=B;this.w2=Q;this.Be=rb;this.nz=Lb;this.ib=ca;this.JE=qa;this.SBa=Qa;this.dfa=Sc;this.Yzb=ld;this.Yfa=Yb;this.wI=gc;this.ga=Fc;this.Io=Hd;this.Nf=Ie;this.vh=fe;this.gb=de;this.Kc=ne;this.fkh=ye;this.od=Vf;
this.Ig=Og;this.wI&&(this.wI.addHandler(ut.a.qOb,Object(z.a)(this,this.JWi,"onShowingPlaceholder")),this.wI.addHandler(ut.a.Nce,Object(z.a)(this,this.RVi,"onRemoveWhenEdited")),sm.execute(op=>{this.EE=op}))}get mx(){return this.Bx.value}get nj(){return this.ei.value}get qY(){return!!this.Nf.instance&&this.Nf.instance.qY}get B0(){return!!this.od&&this.od.isFeatureEnabled(32)}dispose(){this.wI&&(this.wI.removeHandler(ut.a.qOb,Object(z.a)(this,this.JWi,"onShowingPlaceholder")),this.wI.removeHandler(ut.a.Nce,
Object(z.a)(this,this.RVi,"onRemoveWhenEdited")))}gL(b,h,u,B=!1){if(this.qY)return this.joa(b,h,u);if(!b||!h)return null;const Q=this.Rg.hoa(b.node.id,!0);var ca=this.Rg.hoa(h.node.id,!1);if(!Q||!ca)return null;b=b.contextId===vc.a.Uc?b:Je.a.Oc(Q,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===vc.a.Uc?h:Je.a.Oc(ca,-1===h.cpEnd?ca.characterData.length:h.cpEnd);ca=null;switch(u){case 0:ca=this.hVl(b,h);break;case 1:ca=this.x7l(b,h);break;case 3:ca=this.Vci(b,h,B);break;case 2:ca=this.$fm(b,h);break;case 4:ca=
this.fof(b,h,!1)}return ca}joa(b,h,u){if(!b||!h||b.contextId!==vc.a.Uc&&(b=this.gIh(b,!0),!b)||h.contextId!==vc.a.Uc&&(h=this.gIh(h,!1),!h))return null;let B=null;switch(u){case 0:B=this.iVl(b,h);break;case 1:B=this.y7l(b,h);break;case 3:B=this.Wci(b,h);break;case 2:B=this.agm(b,h);break;case 4:B=this.fof(b,h,!0)}return B}gIh(b,h){var u=this.Rg.hoa(b.node.id,h);if(!u)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?u.characterData.length:b.cpEnd,b=b.Sb);u=Je.a.Oc(u,h);u.Fb=b;u.Sb=
b;return u}hVl(b,h){const u=new zb.a;if(b.contextId===vc.a.Uc||h.contextId===vc.a.Uc||b.equals(h))return u;const B=new fp.a,Q=this.hFb(b,b),ca=this.hFb(h,h);for(let qa=0;qa<Q.count;qa++)if(Q.J(qa).Qc)for(let Qa=0;Qa<ca.count;Qa++)ca.J(Qa).Qc||Q.J(qa).ke.equals(ca.J(Qa).ke)&&(!Q.J(qa).Gf||this.Rg.cRa(Q.J(qa).ke,b.node.id,!0)&&this.Rg.cRa(ca.J(Qa).ke,h.node.id,!1))&&this.yAd(u,B,Q.J(qa).ke);return u}iVl(b,h){const u=new zb.a;if(b.contextId===vc.a.Uc||h.contextId===vc.a.Uc||b.equals(h)&&b.Fb===b.Sb||
-1===b.Fb||-1===h.Sb)return u;var B=b.node.qa.zh(b.cpBegin),Q=h.node.qa.zh(h.cpEnd);B&&B.Jb&&0<B.Jb.length&&b.Fb<=B.Jb.length&&Q&&Q.Jb&&0<Q.Jb.length&&h.Sb<=Q.Jb.length&&(b=b.Fb,h=h.Sb,b===B.Jb.length&&b--,0<h&&h--,B=B.Jb.J(b),Q=Q.Jb.J(h),B.Qc&&!Q.Qc&&W.a.zq(B.ke,Q.ke)&&B.rp&&Q.rp&&(Q=B.contentControlNode)&&u.add(this.mR(Q)));return u}x7l(b,h){const u=new zb.a,B=new fp.a,Q=this.hFb(b,h);for(let ca=0;ca<Q.count;ca++)this.yAd(u,B,Q.J(ca).ke);b=this.Vci(b,h,!1,!1);for(const ca of b)B.contains(ca.objectId)||
(u.add(ca),B.add(ca.objectId));return u}y7l(b,h){const u=new zb.a,B=new fp.a,Q=this.nnf(b,h);for(let ca=0;ca<Q.count;ca++)this.uYe(u,B,Q.J(ca));b=this.Wci(b,h);for(const ca of b)B.contains(ca.objectId)||(u.add(ca),B.add(ca.objectId));return u}Vci(b,h,u,B=!0){const Q=new zb.a;b.equals(h)&&(u=!1);const ca=new fp.a;let qa=!1;b=this.hFb(null,b,!0,u);h=this.hFb(h,null,u,!0);for(u=b.count-1;0<=u;u--){for(let Qa=0;Qa<h.count&&!(b.J(u).ke.equals(h.J(Qa).ke)&&(b.J(u),this.yAd(Q,ca,b.J(u).ke)&&(qa=!this.Rg.ou(b.J(u).ke).ja(Jc.a.j8,
null),B||qa)));Qa++);if(0<Q.count&&(B||qa))break}return Q}Wci(b,h){const u=new zb.a,B=new fp.a,Q=b.node;var ca=h.node;const qa=h.contextId===vc.a.Uc?ca.characterData.length:h.cpEnd;b=this.Io.Q8(Q,b.contextId===vc.a.Uc?Q.characterData.length:b.cpBegin,b.Fb);h=this.Io.Q8(ca,qa,h.Sb);ca=b.count>h.count?h.count:b.count;for(--ca;0<=ca;ca--)b.J(ca).ke.equals(h.J(ca).ke)&&this.uYe(u,B,b.J(ca));return u}$fm(b,h){const u=new zb.a;let B=new fp.a;const Q=this.hFb(b,h);let ca=0,qa=null;if(b.equals(h))return u;
for(b=0;b<Q.count;b++)!Q.J(b).Qc||Q.J(b).Gf&&!this.Rg.cRa(Q.J(b).ke,Q.J(b).Kb.paragraph.id,!0)?Q.J(b).Qc||Q.J(b).Gf&&!this.Rg.cRa(Q.J(b).ke,Q.J(b).Kb.paragraph.id,!1)||(ca--,0>ca?(ca=0,B=new fp.a):!ca&&qa&&Q.J(b).ke.equals(qa)&&this.yAd(u,B,qa)):(ca||(qa=Q.J(b).ke),ca++);return u}agm(b,h){const u=new zb.a;if(b.equals(h)&&b.Fb===h.Sb)return u;let B=new fp.a;b=this.nnf(b,h);h=0;let Q=null;for(let ca=0;ca<b.count;ca++){const qa=b.J(ca);!qa.Qc||qa.Gf&&!this.Rg.cRa(qa.ke,qa.Kb.paragraph.id,!0)?qa.Qc||
qa.Gf&&!this.Rg.cRa(qa.ke,qa.Kb.paragraph.id,!1)||(h--,0>h?(h=0,B=new fp.a):!h&&Q&&qa.ke.equals(Q.ke)&&this.uYe(u,B,Q)):(h||(Q=qa),h++)}return u}fof(b,h,u){const B=new zb.a;b=u?this.nnf(b,h):this.hFb(b,h);h=0;for(u=0;u<b.count;u++){var Q=b.J(u);Q.rp&&(Q.Qc?h++:(h--,0>h?h=0:(Q=this.mR(Q.contentControlNode))&&B.add(Q)))}return B}hFb(b,h,u=!0,B=!0){const Q=new zb.a,ca=this.jU(b,h);if(!ca.count)return Q;let qa,Qa,rb,Lb;for(let Yb=0;Yb<ca.count;Yb++){qa=0;Qa=ca.J(Yb).characterData.length;rb=Lb=!0;if(b&&
ca.J(Yb).id.equals(b.node.id)){if(b.contextId===vc.a.Uc)continue;0<=b.cpBegin&&(qa=b.cpBegin)}h&&ca.J(Yb).id.equals(h.node.id)&&0<=h.cpEnd&&(Qa=h.cpEnd);Yb||(rb=u);Yb!==ca.count-1||h&&h.contextId===vc.a.Uc||(Lb=B);Q.addRange(this.onf(ca.J(Yb),qa,Qa,rb,Lb))}return Q}nnf(b,h){const u=new zb.a,B=this.jU(b,h);let Q,ca,qa;for(let rb=0;rb<B.count;rb++){const Lb=B.J(rb);if(Lb.qa.length){var Qa=Lb.qa.J(Lb.qa.length-1);Q=0;ca=Lb.characterData.length;qa=0;Qa=Qa&&Qa.Jb?Qa.Jb.length:0;b&&Lb.id.equals(b.node.id)&&
(Q=b.Ij,qa=b.Fb);h&&Lb.id.equals(h.node.id)&&(ca=h.np,Qa=h.Sb);u.addRange(this.pnf(Lb,Q,ca,qa,Qa))}}return u}onf(b,h,u,B=!0,Q=!0,ca=!0){const qa=new zb.a;b=b.qa;for(let Qa=0;Qa<b.length;Qa++){if(b.J(Qa).cp<h)continue;if(b.J(Qa).cp>u)break;const rb=b.J(Qa);if(rb.Jb&&0<rb.Jb.length&&(rb.cp!==h||B)&&(rb.cp!==u||Q))for(let Lb=0;Lb<rb.Jb.length;Lb++){const Yb=rb.Jb.J(Lb);(ca||Yb.Qc)&&qa.add(Yb)}}return qa}pnf(b,h,u,B,Q){const ca=new zb.a;b=b.qa;for(let qa=0;qa<b.length;qa++){if(b.J(qa).cp<h)continue;if(b.J(qa).cp>
u)break;const Qa=b.J(qa);if(Qa.Jb&&0<Qa.Jb.length){let rb=0,Lb=Qa.Jb.length;Qa.cp===h&&-1!==B&&(rb=B);for(Qa.cp===u&&-1!==Q&&(Lb=Q);rb<Lb&&rb<Qa.Jb.length;rb++)ca.add(Qa.Jb.J(rb))}}return ca}yAd(b,h,u){let B=null;if(h.contains(u)||!(B=this.nj.Eb(u)))return!1;b.add(this.mR(B));h.add(u);return!0}uYe(b,h,u){let B=null;!h.contains(u.ke)&&(B=u.contentControlNode)&&(b.add(this.mR(B)),h.add(u.ke))}DAj(b,h){let u,B=!1;u=({R5a:h,Q5a:b,z9c:B}=this.EAj(b,h,!1,B)).returnValue||B;B&&(u=u||({R5a:h,Q5a:b,z9c:B}=
this.EAj(h,b,!0,B)).returnValue);return{returnValue:u,R5a:h,Q5a:b}}EAj(b,h,u,B){let Q,ca;if(u)return Q=ca=null,{returnValue:!1,R5a:ca,Q5a:Q,z9c:!1};let qa=!1;ca=b;Q=h;const Qa=b.cpBegin,rb=h.cpEnd;B=!1;var Lb=u?this.r3h(h):this.lLl(b);let Yb=!1,gc=!1,Fc=0,Sc=0;for(const ld of Lb)for(Lb=0;Lb<ld.qa.length;Lb++){const Hd=ld.qa.J(Lb);!gc&&ld.id.equals(h.node.id)&&(gc=!0);if(!Yb&&(ld.id.equals(h.node.id)&&-1!==rb&&Hd.cp>rb||gc&&!ld.id.equals(h.node.id)))if(Yb=!0,Fc!==Sc)qa=!0;else return{returnValue:!1,
R5a:ca,Q5a:Q,z9c:B};if((!ld.id.equals(b.node.id)||Hd.cp>=Qa||-1===Qa)&&Hd.Jb)for(let Ie=0;Ie<Hd.Jb.length;Ie++){const fe=Hd.Jb.J(Ie),de=this.nj.Eb(fe.ke);if(!de.getValue(Jc.a.k9)||(!fe.Qc||this.Rg.cRa(this.Ig.Cq(de.id,!0),ld.id,!0))&&(fe.Qc||this.Rg.cRa(this.Ig.Cq(de.id,!1),ld.id,!1))){fe.Qc?Fc++:Fc--;if(qa&&Fc===Sc)return{R5a:ca,Q5a:Q}=this.s8k(b.node,ld,b.cpBegin,Hd.cp),{returnValue:!0,R5a:ca,Q5a:Q,z9c:B};!u&&Fc<Sc&&(B=!0,Sc--)}}}return{returnValue:qa,R5a:ca,Q5a:Q,z9c:B}}s8k(b,h,u,B){let Q;h.id.equals(b.id)?
b=0<u||B<me.ParagraphReader.textLength(h)?Q=Je.a.createTextRange(h,u,B):Q=Je.a.create(h):(Q=0<u?Je.a.createTextRange(b,u,me.ParagraphReader.textLength(b)):Je.a.create(b),b=B<me.ParagraphReader.textLength(h)?Je.a.createTextRange(h,0,B):Je.a.create(h));return{R5a:Q,Q5a:b}}w3l(b){const h=b.cpBegin,u=this.r3h(b);for(let Q=u.count-1;0<=Q;Q--){const ca=u.J(Q);for(let qa=ca.qa.length-1;0<=qa;qa--){const Qa=ca.qa.J(qa);if((!ca.id.equals(b.node.id)||Qa.cp<=h||-1===h&&!Qa.cp)&&Qa.Jb){var B=Qa.Jb.length-1;for((Qa.cp===
h||-1===h&&!Qa.cp)&&this.qY&&ca.id.equals(b.node.id)&&(B=b.Fb-1);0<=B;B--){const rb=Qa.Jb.J(B),Lb=this.nj.Eb(rb.ke);if(rb.Qc){if(Lb.getValue(Jc.a.k9)&&!this.Rg.cRa(this.Ig.Cq(Lb.id,!0),ca.id,!0))continue;return null}if(!Lb.getValue(Jc.a.k9)||this.Rg.cRa(this.Ig.Cq(Lb.id,!1),ca.id,!1))return this.mR(Lb)}}}}return null}mR(b){if(!b)return null;this.Rg.n7b();return this.w2.yCb(b,this.Bx,this.ei,this.Rg,this.mr,this,this.dfa,this.Yfa,this.Yzb)}jU(b,h){b=this.q3h(b,h,Gs.QFb(12));if(!b)return null;h=new zb.a;
for(const u of b)h.add(u);return h}jLl(b,h){const u=Gs.C_l();return this.q3h(Je.a.create(b.node),Je.a.create(h.node),u)}q3h(b,h,u){if(!u||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var B=b.node;if(B&&u(B)){var Q;return Q=new zb.a,Q.add(B),Q}}B=Object.assign(new $A,{fQi:35,ZZi:u});b=b?b.node:null;h=h?h.node:null;Q=this.Jam(b,h);if(!Q)return null;h=this.Byk(h,u,Gs.qyh,B);return this.fLl(b,h,Q,u,Gs.qyh,B)}Jam(b,h){return(b=b?this.N$h(b):this.N$h(h))?b.ld(35):this.Rg.f6l()}Byk(b,
h,u,B){if(!b)return null;h(b)||(h=this.gLl(b,h,u,B),h.count&&(b=h.J(h.count-1)));return b}fLl(b,h,u,B,Q,ca){b?(b=vd.GraphIterator.eb(b),b.zb(7),u=Fa.a.zs(b,u)):u=Fa.a.ap(u);Q&&u.wo(Q,ca);for(Q=new zb.a;u.moveNext()&&(B(u.currentNode)&&Q.add(u.currentNode),!h||!u.currentNode.id.equals(h.id)););return Q}gLl(b,h,u,B){b=Fa.a.ap(b);u&&b.wo(u,B);for(u=new zb.a;b.moveNext();)h(b.currentNode)&&u.add(b.currentNode);return u}N$h(b){b=vd.GraphIterator.eb(b);return b.zb(35)?b:null}emi(b,h){b=this.jU(b,h);for(const u of b)if((b=
this.Rg.vqf(u))&&b.Nha(4))return!0;return!1}Cnh(b,h=null,u=!1){if(!b)return!1;let B=b.start;var Q=b.end;if(!Ge.SelectionEditor.lv(B)&&B.contextId!==vc.a.paragraph||!Ge.SelectionEditor.lv(Q)&&Q.contextId!==vc.a.paragraph||!this.qY&&({R5a:B,Q5a:Q}=this.DAj(b.start,b.end)).returnValue||this.qY&&!({start:B,end:Q}=this.aRk(B,Q)).returnValue)return!1;b.start=B;b.end=Q;const ca=this.KJm(B,Q);if(this.qY){var qa=this.joa(b.start,b.end,3);var Qa=this.joa(b.start,b.end,2)}else qa=this.gL(b.start,b.end,3),Qa=
this.gL(b.start,b.end,2);const rb=qa&&0<qa.count?qa.J(0):null,Lb=Qa&&0<Qa.count?Qa.J(0):null;if(u)return this.rVc(b,0,qa)?!0:!1;if(this.rVc(b,0,qa)){u=(u=Object(Na.a)(XA,this.w3l(b.start)))?this.Rg.ou(u.objectId):null;Qa=this.Rg.Zpk(b,rb,u,Qa,b.xu,b.Az,h);this.Bj.Vec(Qa);if(b.Gf)for(Q=this.jU(b.start,b.end),u=0;u<Q.count;u++)if(this.qY){qa=rb?rb.objectId:null;const Yb=this.s$h(qa,Q.J(u),!0);this.mr.uua(Q.J(u),Qa.id,0,!0,!0,void 0,void 0,void 0,void 0,Yb);qa=this.s$h(qa,Q.J(u),!1);this.mr.uua(Q.J(u),
Qa.id,Q.J(u).characterData.length,!0,!1,void 0,void 0,void 0,void 0,qa)}else this.mr.uua(Q.J(u),Qa.id,0,!0,!0),this.mr.uua(Q.J(u),Qa.id,Q.J(u).characterData.length,!0,!1);else this.qY?(u=-1===B.Fb?0:B.Fb,this.mr.uua(b.start.node,Qa.id,B.cpBegin,!1,!0,void 0,void 0,void 0,void 0,u),this.mr.uua(b.end.node,Qa.id,Q.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?u+1:Q.Sb)):(this.mr.uua(b.start.node,Qa.id,b.start.cpBegin,!1,!0),this.mr.uua(b.start.node,Qa.id,b.start.cpEnd,!1,!1));h||this.Rg.jfo(Qa,b.Gf,b.id,
this.Rg.z$b(this.Rg.ou(b.xu)),b.type);1===b.type&&this.mr.nPo(b.start.node,B.Ij,B.np);b.objectId=Qa.id;h=this.Rg.twa().currentNode;h.hasProperty(Jc.a.$Ic)||h.setValue(Jc.a.$Ic,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);In.a.r4a&&this.Rg.pEj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Qa);rb&&this.yFj(rb.contentControlNode,b);Lb&&this.yFj(Qa,Lb);ca&&this.ga.Rb(Ob.a.T9c,2,b.id);ZA.a.BHh()&&this.EE&&this.EE.fireEvent(3,{node:Qa});return!0}return!1}deleteContentControl(b){if(!this.rVc(b,
3))return r.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Bj.Qbd(b.contentControlNode))return!0;b.JJ&&(b.JJ=!1);const h=this.ib.hb.lb;b=b.gF();const u=new Dh.Selection(b.toArray(),!0);let B=!1;this.ib.fPb(()=>{this.ib.Bc(u);if(32===this.ga.processAction(Ob.a.HH,2)){if(this.fkh.instance){const Q=this.fkh.instance.abi(h,u,this.ib.hb.lb);this.ib.eRo(new aC.SelectionCollection([Q],0))}B=!0}});return B}Sya(b,h=!1,u=!1){if(this.rVc(b,2)){if(b.JJ)return r.ULS.sendTraceTag(528537615,
368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const B=In.a.sr?b.contentControlNode:this.Rg.ou(b.objectId);let Q=new zb.a;h&&(Q=b.Bmf());Q.add(b);if(u||!this.Bj.Qbd(b.contentControlNode)){B&&B.anchor&&this.Rg.EPh(B,h);for(const ca of Q)b=this.jU(ca.start,ca.end),this.mr.ril(b,ca.objectId);this.K4i(Q)}r.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}r.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");
return!1}emj(b,h){if(this.rVc(b,1)){let Qa=!1;h||(Qa=!0,{Iqo:u,returnValue:h}=this.rGb(b),u&&this.Rg.twa().currentNode.setValue(Jc.a.$Ic,h));var u=b.p5h().toArray();for(var B=0;B<u.length;B++)this.Sya(u[B],!0);u=this.Wyo(h);if(b.Gf){B=this.jU(b.start,b.end);if(!B.count)return!1;if(1===B.count&&v.AFrameworkApplication.nu)this.mr.Ge(Je.a.createTextRange(B.J(0),0,B.J(0).characterData.length),h);else{var Q=this.Rg.q7l(B.J(0));h=B.J(0).F8b();B=this.Rg.UPh(B);B=this.Rg.Onh(Q,B,u.length);for(Q=0;Q<B.count;Q++){this.mr.Ge(Je.a.createTextRange(B.J(Q),
0,0),u[Q]);for(var ca=0;ca<h.count;ca++)this.mr.uua(B.J(Q),h.J(ca),0,!0,!0),this.mr.uua(B.J(Q),h.J(h.count-ca-1),B.J(Q).characterData.length,!0,!1)}b.hXo(B.J(0).id,B.J(B.count-1).id);u=this.JE.ne(B.J(0),0);this.ib.Bc(u)}}else{Q=0;1<u.length&&r.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;B=h.node;for(var qa=0;qa<B.qa.length&&h.contextId===vc.a.Jd;qa++)if(ca=B.qa.J(qa),ca.cp===h.cpBegin&&ca.blob){Q++;for(qa+=1;qa<
B.qa.length;qa++)if(ca=B.qa.J(qa),ca.cp>h.cpBegin&&ca.cp<=h.cpEnd)if(ca.blob)Q++;else break;else if(ca.cp>h.cpEnd)break;break}if(0<Q&&Q+h.cpBegin<h.cpEnd)B=Je.a.createTextRange(h.node,h.cpBegin,h.cpBegin+Q),h=Je.a.createTextRange(h.node,h.cpBegin+Q,h.cpEnd),this.mr.Ge(h,u[0]),this.mr.Ge(B,"");else if(0<Q&&Q+h.cpBegin===h.cpEnd)for(this.mr.Ge(b.start,u[0]),u=0;u<B.qa.length;u++){if(Q=B.qa.J(u),Q.cp===h.cpBegin){Q.blob=null;break}}else v.AFrameworkApplication.nu?(u=u.join(" "),this.mr.Ge(b.start,u)):
this.mr.Ge(b.start,u[0])}this.GAb(b,Qa);let rb;this.nLn((rb=new zb.a,rb.add(b),rb));return!0}return!1}GAb(b,h){const u=this.mr.AQc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(u){const B=this.Rg.ou(b.objectId);if(h){h=this.nz.ZC(b.start.node);let Q=h.jj(ls.a.I_f);Q||(Q=h.nFa(ls.a.bBn));Q&&(this.Be.vga(u.formatting),this.Be.E7a(u.formatting,Q));B&&(b.JJ=!0)}else B&&b.JJ&&(this.o5n(b,u),b.JJ=!1)}else r.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}o5n(b,
h){b=this.Rg.ou(b.objectId);let u=null;b&&(u=b.ja(Jc.a.mCb,W.a.nil));this.Be.vga(h.formatting);u&&!u.equals(W.a.nil)&&(b=this.ei.value.Eb(u),h.formatting=b)}rGb(b){let h=!1;b=b.placeholderText;this.RSm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,Iqo:h}}oWn(b,h=!0){this.Yfa&&(h&&this.kWn(b),this.sWn(b))}pWn(b){if(this.Yfa&&(b=this.gL(b,b,4)))for(const h of b)this.Sya(h,!1)}ukn(b,h){if(h&&!b.Qc&&(this.Rg.n7b(),(b=b.Kb.paragraph.Lc.Eb(b.ke))&&b.anchor)){this.Rg.EPh(b);
b=this.w2.yCb(b,this.Bx,this.ei,this.Rg,this.mr,this,this.dfa,this.Yfa,this.Yzb);let u;this.K4i((u=new zb.a,u.add(b),u))}}RVi(b,h){this.Rg.n7b();b=this.Rg.ou(h.ke);const u=this.mR(b);if(u&&u.isValid()&&u.removeWhenEdited){const B=this.Kc.Pc(7);B.Db(b);this.Sya(u,!1);h.state=2;B.dispose()}}JWi(b,h){this.Rg.n7b();b=this.Rg.ou(h.ke);this.LHm(b)&&(b=b.ja(Jc.a.Ww,0),this.ga&&(this.ga.Rb(Ob.a.T9c,2,b),Gs.Pd.a0e()))}LHm(b){return b&&b.isConnected&&!b.ja(Jc.a.k8,!1)?In.a.sr?this.DYd(b)&&!b.Uu:this.DYd(b):
!1}DYd(b){b=this.w2.yCb(b,this.Bx,this.ei,this.Rg,this.mr,this,this.dfa,this.Yfa,this.Yzb);if(!b.isValid())return!1;if(b.Gf){if(b.xu.toString()===b.Az.toString()){var h=this.Rg.ou(b.xu);if(!h)return r.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.Oui(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return r.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),
!1;if(h.cpBegin===h.cpEnd)return h=this.Rg.ou(b.xu).qa.zh(h.cpBegin),this.Oui(h,b.objectId)}return!1}Oui(b,h){b=b?b.Jb:null;if(!b)return!1;const u=b.vJ(h,!0);return-1<u&&u+1<b.length&&b.J(u+1).ke.toString()===h.toString()}E7i(b){this.xOe.push(b)}gtj(b,h){if(void 0===b||null===b||b.contextId!==vc.a.Jd)return null;b=Je.a.Oc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<me.ParagraphReader.textLength(b.node)?this.Rg.mUa(b):null}select(b,h){if(b&&!b.equals(W.a.nil)){var u=this.Rg.ou(b);if(u&&
55===u.type){u=this.mR(u);if(u.Gf)u=this.bNl(u);else{u=u.start;In.a.Sj&&(u.contextId=vc.a.Jd);if(!u)return;u=this.JE.Tn(u)}if(u&&u.length)return this.ejj(u.Pa,b,h,!0,!0),this.ejj(u.Rc,b,h,!1,!1),this.ib.Bc(u),u}}}H$n(b,h){if(!Ge.SelectionEditor.ef(b)||b.Fb!==b.Sb)return!1;const u=b.Fb;return-1===u?!1:(b=this.Io.Q1a(b.node,b.cpBegin,u,!h))&&h===b.Qc?(h=this.mR(b.contentControlNode),this.select(b.ke,!h.isEditable),!0):!1}bNl(b){var h=this.Rg.oPa(b.xu,!0);b=this.Rg.oPa(b.Az,!1);if(!h||!b)return null;
h=this.jLl(Je.a.create(h),Je.a.create(b));if(!h||!h.count)return null;b=new zb.a;for(let u=0;u<h.count;u++){let B;if(12===h.J(u).type)B=u===h.count-1?Je.a.createTextRange(h.J(u),0,me.ParagraphReader.textLength(h.J(u))):Je.a.create(h.J(u)),this.vh&&(B.Fb=this.vh.ar(B.node,!0),B.Sb=this.vh.ar(B.node,!1));else if(15===h.J(u).type)B=Fs.TableNodeContext.create(h.J(u));else continue;b.add(B)}return new Dh.Selection(b.toArray(),!0)}Heo(b){if(b&&!b.equals(W.a.nil)&&(this.Rg.n7b(),(b=this.Rg.ou(b))&&55===
b.type&&b.isConnected)){var h=b.ja(Jc.a.k8,!1);b.setValue(Jc.a.k8,!1);h&&this.oRn(b)}}oRn(b){var h=this.Ig.Cq(b.id,!0);h.equals(W.a.nil)||(h=this.Rg.hoa(h,!0))&&(b=this.mr.bof(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Kb,h.formatting=b.jR?b.jR.yf(h):new PA.a(h,W.a.nil))}y8i(b){if(b=this.q6h(b))for(const h of b)this.Bj.leg()&&(h.JJ=!1),this.Sya(h,!1)}n6h(b){const h=new zb.a;if(b=this.q6h(b))for(const u of b)h.add(u.contentControlNode);return h}qWn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===
b.type)){var h=this.gb.fl(b),u=this.gb.YD(b);if(this.vh&&h&&u){b=this.vh.ar(h,!0);const B=this.vh.ar(u,!1);h=Je.a.create(h);u=Je.a.create(u);h.Fb=b;u.Sb=B;if(b=this.joa(h,u,4))for(const Q of b)this.Sya(Q,!1)}}}mLl(b){var h=this.Ig.Cq(b.id,!0,b.loading);b=this.Ig.Cq(b.id,!1,b.loading);if(h.equals(W.a.nil)||b.equals(W.a.nil))return new zb.a;h=this.Rg.hoa(h,!0);b=this.Rg.hoa(b,!1);return h&&b?this.jU(Je.a.create(h),Je.a.create(b))||new zb.a:new zb.a}oPa(b,h){return this.Rg.oPa(b,h)}cqf(b,h){if(b&&55===
b.type&&(b=this.mR(b),b=h?b.start:b.end)){const u=Je.a.Oc(b.node,h?b.Ij:b.np);u.Fb=u.Sb=(h?b.Fb:b.Sb)+(h?-1:1);return u}return null}UQl(b){return(b=this.mR(b))?b.start:null}ejj(b,h,u,B,Q){if((b.contextId===vc.a.Jd||b.contextId===vc.a.Tc||b.contextId===vc.a.paragraph)&&(Q=b.node.qa.zh(Q?b.Ij:b.np))&&Q.Jb)for(let ca=0;ca<Q.Jb.length;ca++){const qa=Q.Jb.J(ca);if(qa.ke.equals(h)&&qa.rp)if(B&&qa.Qc){b.Fb=u?ca:ca+1;break}else if(!B&&!qa.Qc){b.Sb=u?ca+1:ca;break}}}nLn(b){for(let h=0;h<this.Pah.length;++h)(0,this.Pah[h])(this,
new gz(b))}K4i(b){for(let h=0;h<this.xOe.length;++h)(0,this.xOe[h])(this,new gz(b))}sWn(b){b=Je.a.create(b);if(b=this.gL(b,b,4))for(const h of b)h.Gf||this.Sya(h,!1)}kWn(b){if(b=b.F8b())for(let u=0;u<b.count;u++){var h=this.Rg.ou(b.J(0));h=this.w2.yCb(h,this.Bx,this.ei,this.Rg,this.mr,this,this.dfa,this.Yfa,this.Yzb);this.Sya(h)}}lLl(b){return this.jU(b,null)}rVc(b,h,u=null){let B=!0;try{if(!b)return r.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;r.ULS.sendTraceTag(529106508,368,
50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.$ha));if(!In.a.sr&&this.SBa&&uq.a.instance.J(1)&&this.SBa.IR(this.Bx.value))return r.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.bPm(h)&&this.cPm(h)&&!this.MHm(b))return!1;if(!u){const qa=this.l7l(b);qa&&(u=new zb.a,u.add(qa))}var Q=this.Rg.pci(b.start.node);const ca=this.Rg.pci(b.end.node);if(Q&&ca&&!Q.equals(ca)||!Q&&ca||Q&&
!ca)return!1;Q=!0;if(u&&0<u.count){if(!u.J(0).isSupported)return!1;Q=u.J(0).isEditable}switch(h){case 0:B=this.kFm(b,Q);break;case 1:B=(this.B0||!this.EZd(b))&&b.isSupported&&b.isEditable&&this.Mth(b)&&this.Rui(b);v.AFrameworkApplication.nu||(B=B&&!this.emi(b.start,b.end));break;case 2:const qa=b.YTm?!0:b.isSupported;B=(this.B0||!this.EZd(b))&&qa&&b.$ha&&Q;r.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:B=b.isSupported&&b.$ha&&Q&&this.Mth(b)&&this.Rui(b)&&!this.emi(b.start,b.end)}}catch(ca){r.ULS.sendTraceTag(17413646,
368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ca),B=!1}return B}cPm(b){return!(v.AFrameworkApplication.nu&&1===b)}bPm(b){return!(this.qY&&(!b||2===b||3===b))}kFm(b,h){if(In.a.P_f)return this.lFm(b,h);let u=!0;if(!this.B0&&this.EZd(b))u=!1;else if(this.qY)this.qY?b.Gf||Ge.SelectionEditor.lv(b.start)||b.start.contextId===vc.a.Uc?b.Gf&&(b.start.contextId!==vc.a.paragraph&&b.start.contextId!==vc.a.Uc||b.end.contextId!==vc.a.paragraph&&b.end.contextId!==vc.a.Uc)&&
(u=!1):u=!1:u=h?this.eui(b):!1;else if(!(b.Gf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))u=!1;else if(b.Gf&&(b.start.contextId!==vc.a.paragraph||b.end.contextId!==vc.a.paragraph||b.start.equals(b.end)&&!me.ParagraphReader.textLength(b.start.node)))u=!1;else if(b.start.contextId===vc.a.Tc||b.end.contextId===vc.a.Tc||b.start.contextId===vc.a.Uc||b.end.contextId===vc.a.Uc)u=!1;return u}lFm(b,h){return(this.B0||!this.EZd(b))&&this.mFm(b)&&this.rLm(b)&&h&&!this.JMm(b)&&this.eui(b)?
!0:!1}rLm(b){var h;const u=b.start,B=u.contextId,Q=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.Gf?B!==vc.a.paragraph&&B!==vc.a.Uc||Q!==vc.a.paragraph&&Q!==vc.a.Uc?!1:!0:Ge.SelectionEditor.lv(u)||B===vc.a.Uc?!0:!1}q6h(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.vh&&(this.gb.nm(h)&&12===h.node.type&&(h.Fb=this.vh.ar(h.node,!0)),this.gb.nm(b)&&12===b.node.type&&(b.Sb=this.vh.ar(b.node,!1)));return this.joa(h,b,4)}Mth(b){b=b.Bmf();for(const h of b)if(!h.isSupported||
!h.$ha)return!1;return!0}MHm(b){if(this.DAj(b.start,b.end).returnValue)return!1;const h=this.gL(b.start,b.end,2);if(!h)return!0;for(const u of h)if(!u.objectId.equals(b.objectId)&&(u.Gf&&(u.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||u.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===me.ParagraphReader.textLength(u.end.node)))||!u.Gf&&(b.start.node.id.equals(u.start.node.id)&&(-1!==b.start.cpBegin?u.start.cpBegin===b.start.cpBegin:!u.start.cpBegin)||
b.end.node.id.equals(u.end.node.id)&&(-1!==b.end.cpEnd?u.end.cpEnd===b.end.cpEnd:u.end.cpEnd===me.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Rui(b){if(b.Gf){var h=this.Rg.ou(b.xu),u=this.Rg.ou(b.Az);let B=null;if(12===h.type&&12===u.type){h=this.Rg.z$b(h);h=this.Rg.ou(h);u=this.Rg.z$b(u);u=this.Rg.ou(u);if(!h||!u)return!1;16===h.type&&16===u.type&&h.id.equals(u.id)&&(B=h)}b=this.jU(b.start,b.end);if(!b.count)return!1;for(const Q of b)if(b=this.Rg.z$b(Q),b=this.Rg.ou(b),!b||!(16!==
b.type||B&&b.id.equals(B.id)))return!1}return!0}EZd(b){return b.Gf?!1:(b=b.start.node)?!b.ja(Jc.a.Dkb,!0):!0}mFm(b){return 1!==b.type?!0:b.xu.equals(b.Az)&&me.ParagraphReader.Wb(b.start.node)&&!this.Bqm(b)?!0:!1}Bqm(b){const h=b.start;var u=h.node;const B=u.qa;if(b.Gf){if(u.Gs||u.Pha||u.hasBookmark)return!0;for(var Q of B)if(this.jmi(Q))return!0;return!1}b=h.Ij;u=h.np;let ca=Q=null;for(const qa of B.yDi(b,u))if(!(qa.cp<b))if(qa.cp===b)Q=qa;else if(qa.cp===u)ca=qa;else if(this.jmi(qa))return!0;return this.Cqm(h,
Q,ca)?!0:!1}jmi(b){return Ex(b.Jb)&&Ex(b.nf)&&Ex(b.Fh)&&Ex(b.Vc)&&null==b.hyperlink&&!b.Wm&&null==b.blob?!1:!0}Cqm(b,h,u){if(null==h&&null==u)return!1;const B=b.Fb;b=b.Sb;return null!=h&&(h.Jb&&B<h.Jb.length||null!=h.blob)||null!=u&&u.Jb&&0<b||null!=h&&null!=u&&(aB(h.nf)&&Zv(u.nf)||aB(h.Fh)&&Zv(u.Fh)||!Ex(h.Vc)&&!Ex(u.Vc)&&[...h.Vc].some(Q=>0===Q.Mf)&&[...u.Vc].some(Q=>3===Q.Mf)||null!=h.hyperlink&&u.Wm)?!0:!1}JMm(b){var h,u;return(null!==(u=null===(h=this.gL(b.start,b.end,3))||void 0===h?void 0:
h.toArray())&&void 0!==u?u:[]).some(B=>1===B.type)?!0:!1}eui(b){if(!b.Gf)return!0;var h=this.Rg.ou(b.xu);b=this.Rg.ou(b.Az);if(Jf.TableCellReader.Hxa(h)||Jf.TableCellReader.Hxa(b)||Im.a.Fpa(h)||Im.a.Fpa(b))return!1;h=this.Rg.z$b(h);h=this.Rg.ou(h);b=this.Rg.z$b(b);b=this.Rg.ou(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}l7l(b){if(!b)return null;b=this.Rg.ou(b.objectId);if(!b)return null;b=b.ja(Jc.a.j8,W.a.nil);return b.equals(W.a.nil)?null:(b=this.Rg.ou(b))?this.mR(b):null}r3h(b){return this.jU(null,
b)}Wyo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}RSm(b){return b&&""!==b?!1:!0}s$h(b,h,u){h=h.qa.zh(u?0:h.characterData.length);if(!h)return r.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Jb||!h.Jb.length)return 0;if(!b)return u?0:h.Jb.length;for(let B=0;B<h.Jb.length;B++){const Q=h.Jb.J(B);if(W.a.zq(Q.ke,b)&&Q.Qc===u)return u?B+1:B}return u?0:h.Jb.length}aRk(b,h){var u=b.node,B=h.node,Q=b.contextId===vc.a.paragraph?0:b.cpBegin,ca=h.contextId===
vc.a.paragraph?me.ParagraphReader.textLength(B):h.cpEnd;u=this.Io.Q8(u,Q,b.Fb);B=this.Io.Q8(B,ca,h.Sb);ca=!u||!u.count;Q=!B||!B.count;if(ca&&Q)return{returnValue:!0,start:b,end:h};if(ca)return{returnValue:this.vme(b,B.J(B.count-1).ke,!0),start:b,end:h};if(Q)return{returnValue:this.vme(h,u.J(u.count-1).ke,!1),start:b,end:h};if(u.count===B.count)return u=u.J(u.count-1),B=B.J(B.count-1),{returnValue:u.ke.equals(B.ke),start:b,end:h};u=(ca=u.count<B.count)?B.J(B.count-1):u.J(u.count-1);return{returnValue:ca?
this.vme(b,u.ke,!0):this.vme(h,u.ke,!1),start:b,end:h}}vme(b,h,u){var B=b.node;let Q;if(u){Q=b.contextId===vc.a.paragraph?0:b.cpBegin;var ca=b.Fb}else Q=b.contextId===vc.a.paragraph?me.ParagraphReader.textLength(B):b.cpEnd,ca=b.Sb;B=B.qa.zh(Q);if(-1===ca||!B||!B.Jb||!B.Jb.length)return!1;B=B.Jb;if(u)for(u=ca;u<B.length;u++){ca=B.J(u);if(!ca.Qc)break;if(ca.ke.equals(h))return b.Fb=u+1,!0}else for(u=ca-1;0<=u;u--){ca=B.J(u);if(ca.Qc)break;if(ca.ke.equals(h))return b.Sb=u,!0}return!1}KJm(b,h){return this.eFk(b,
h)&&b.Fb===b.Sb&&(b.contextId===vc.a.Tc||b.contextId===vc.a.paragraph&&!b.node.characterData.length)}eFk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Sb===h.Sb}yFj(b,h){if(b&&h.Gf){var u=this.Ig.Cq(b.id,!0),B=this.Rg.hoa(h.xu,!0);u.equals(B?B.id:null)&&this.Ig.pE(b.id,h.objectId,!0);u=this.Ig.Cq(b.id,!1);B=this.Rg.hoa(h.Az,!1);u.equals(B?B.id:null)&&this.Ig.pE(b.id,h.objectId,!1)}}static get Pd(){return null!=Gs.eHg?Gs.eHg:Gs.eHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static QFb(b){return h=>
h.type===b}static C_l(){return b=>12===b.type||15===b.type}static qyh(b,h){return b.Ue===h.fQi||b.parentNode&&h.ZZi(b.parentNode)?!1:!0}}Object(m.a)(Gs,"ContentControlOperator",null,[305,10,306]);class Wz{constructor(b,h,u){this.Zc=b;this.Bx=h;this.pxb=u}Kii(b){const h=this.RFb();return h&&b&&this.QGb(h,b)?this.uim(h):null}QGb(b,h,u=!1){if(!b||!h)return!1;do{var B=b.currentNode;if(!B)break;B=B.ja(Jc.a.F$b,null);if(B===h||u&&B&&B.includes(h))return!0}while(b.Jf(29));return!1}uim(b){var h=b.Ub(1);b.rc();
b=b.zJ(1);if(!h||!b)return null;h=Cg.SelectionFactory.ucl(h,b);b=Ge.SelectionEditor.Fj(h,!1,!1);return In.a.r4a&&!b?null:Cg.SelectionFactory.Dy(h,b.Rc)}RFb(){const b=this.Zc.yk();b.set(this.Bx.value);this.pxb.EP(b);return b.Ub(28)&&b.Ub(29)?b:null}uqf(){const b=this.Zc.yk();b.set(this.Bx.value);this.pxb.EP(b);return b.Ub(28)?b:null}wWl(b){var h=this.RFb();if(!h||!b||!this.QGb(h,b,!1))return null;h.Qd();b=1<h.Qp();h.Qd();h.Qd();h=h.currentNode;return me.ParagraphReader.Wb(h)?{g9d:h,pmi:b}:{g9d:null,
pmi:b}}c7h(){const b=this.RFb();return this.QGb(b,ls.a.YOh,!0)?b.currentNode.getValue(Jc.a.F$b):null}}Object(m.a)(Wz,"GlossaryNavigator",null,[303]);class hz{constructor(b,h,u,B,Q,ca){this.mr=b;this.Rg=h;this.em=u;this.gb=B;this.nh=Q;this.Yfa=ca}v8c(b,h,u){if(!this.Yfa)return 1;if(!({tableNode:Q}=this.YGf(b)).returnValue||!this.nh.MBi(Q,h)||this.v8i(b,h))return 2;var B=this.nh.s3h(h);var Q=B.J(0).F8b();Q&&Q.count||(Q=new zb.a,Q.add(b.objectId));b=this.Rg.UPh(B);u=u.split("\n");h=Object(Na.a)(vd.GraphIterator,
this.Rg.vqf(h));h=this.Rg.Onh(h,b,u.length);for(b=0;b<h.count;++b){B=h.J(b);this.mr.Ge(Je.a.createTextRange(B,0,0),u[b]);for(let ca=0;ca<Q.count;++ca)this.mr.uua(B,Q.J(ca),0,!0,!0),this.mr.uua(B,Q.J(Q.count-ca-1),B.characterData.length,!0,!1)}return 0}v8i(b,h){if(!this.Yfa)return 1;let u;if(!({tableNode:u}=this.YGf(b)).returnValue||!this.nh.MBi(u,h))return 2;h=this.nh.s3h(h);if(0<h.count&&(h=this.em.gL(Je.a.create(h.J(0)),Je.a.create(h.J(h.count-1)),2)))for(const B of h)if(B.id!==b.id&&!this.em.Sya(B,
!0))return 2;return 0}udc(b){if(!this.Yfa||!({tableNode:u}=this.YGf(b)).returnValue)return!1;b=b.Bmf();for(var h of b)if(!h.$ha||!h.isSupported)return!1;if(this.nh.CHm(u))return!1;var u=Object(Na.a)(vd.GraphIterator,this.Rg.vqf(u));h=new zb.a;this.gb.Qib(u,!0,!1,h);for(const B of h)if(0<B.ja(Jc.a.qEb,0)||this.gb.u2a(B).Sx)return!1;return!0}YGf(b){let h=null;return b&&b.xu.toString()===b.Az.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.Rg.ou(b.xu))&&14===h.type?{returnValue:!0,tableNode:h}:
{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(m.a)(hz,"TableContentControlEditor",null,[302]);class Xz{CHm(b){let h=!1;const u=new vd.GraphIterator;u.set(b);qg.forEachCellInTable(u,B=>{if(!Jf.TableCellReader.fg(B)){let Q=uf.OutlineNavigator.I9(B);for(;Q;){if(Yc.OutlineElementReader.$$b(B))return h=!0,!1;Q=B.Ni(1)}}return!0});return h}MBi(b,h){const u=new vd.GraphIterator;u.set(h);return Jf.TableCellReader.Hxa(h)&&u.zb(14)&&u.ld(14).id===b.id?!0:!1}s3h(b){const h=new zb.a,u=
new vd.GraphIterator;u.set(b);b=new zb.a;me.ParagraphReader.Qib(u,!0,!1,b);for(const B of b)h.add(B);return h}}Object(m.a)(Xz,"TableReader",null,[301]);class Rt{constructor(){this.em=null}get name(){return"WordEditor.ContentControl"}init(){v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(az.a.cTa(Object(z.a)(Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").ukn,"onContentControlRangeChanged")),
this.em=Ga.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Ga.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.em&&(this.em.dispose(),this.em=null)}wc(b){b.ia("WordEditor.ContentControl.Perf.IPerfLogger",()=>new bz.a(Qd.a.We)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new $B(Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();
b.ia("WordEditor.ContentControlNodeFactory",()=>new vy(Ga.a.instance.Ta("Box4.ContentControlConfigSettings"),Ga.a.instance.Ta("Box4.ContentControl.IContentControlOperator"))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new Xv(new hg.a(()=>Fb.App.za.jb.Yc),new hg.a(()=>Fb.App.za.jb.Yc.vd),new Yn.a,Zo.PageNavigator.instance,Ga.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ga.a.instance.resolve("Box4.IOutlineEditor"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),
Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Ga.a.instance.Ta("Box4.ContentControlConfigSettings"),Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ga.a.instance.Ta("WordEditor.ContentControl.GlossaryEditor"),Ga.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ia("WordEditor.ContentControl.GlossaryNavigator",()=>new Wz(new Yn.a,new hg.a(()=>
Fb.App.za.jb.Yc),Zo.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").ha();b.ia("WordEditor.ContentControl.ContentControlOperator",()=>new Gs(new hg.a(()=>Fb.App.za.jb.Yc),new hg.a(()=>Fb.App.za.jb.Yc.vd),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),xf.a.instance,Ga.a.instance.resolve("Box4.ISelectionFactory"),
Df.PageReader.instance,Ga.a.instance.resolve("Box4.IFormattingEditor"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ga.a.instance.Oa("Box4.IContentControlDataChangedManager"),v.AFrameworkApplication.va,Ga.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ga.a.instance.resolve("Box4.IContentControlChpHelper"),Ga.a.instance.Ta("Box4.ContentControlConfigSettings"),
Ga.a.instance.Oa("Box4.IContentControlReader"),Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ga.a.instance.Ta("Box4.Actors.IVirtualSelectionMerger"),Ga.a.instance.resolve("Box4.IFeatureHelper"),Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Ga.a.instance.Ta("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new Yv(new hg.a(()=>Fb.App.za.jb.Yc),new hg.a(()=>Fb.App.za.jb.Yc.vd),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ga.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ga.a.instance.Ta("Box4.ContentControlConfigSettings"),Ga.a.instance.resolve("Box4.IContentControlChpHelper"),Ga.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ia("WordEditor.ContentControl.ContentControlChpManager",()=>new Dx(Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.Ta("Box4.ContentControlConfigSettings"),Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ia("WordEditor.ContentControl.GlossaryEditor",()=>new ez(Ga.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Ga.a.instance.resolve("Box4.IOutlineElementEditor"),Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("Box4.TextFormattingHelper"),Ga.a.instance.resolve("Box4.IFormattingEditor"),Fb.App.ni.zl.Te(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",
()=>new hz(Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.resolve("Box4.IParagraphReader"),new Xz,v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();v.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ia("Box4.ContentControlConverter",()=>new wy(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ia("WordEditor.ContentControl.ContentControlCCP",()=>new fz(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new YA(new hg.a(()=>Fb.App.za.jb.Yc.vd),Ga.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ga.a.instance.resolve("Box4.Actors.TextFormattingActor"),Ga.a.instance.resolve("Box4.TextFormattingHelper"),v.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){M.a.instance.Gc(new Rt)}}
Object(m.a)(Rt,"ContentControlPackage",null,[1,2]);var yu=c(1416),bB=c(506),Yz=c(1771),zu=c(785);class Zr{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(m.a)(Zr,"UxManagerMenuActionTelemetryData",null,[]);class Zz extends Sys.EventArgs{constructor(b,h,u){super();this.definition=b;this.source=h;this.X0k=u}}Object(m.a)(Zz,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class cB extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(m.a)(cB,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class yD{constructor(b,h,u,B,Q,ca,qa=!1,Qa=null,rb=null,Lb=null,Yb=!1,gc=null,Fc=!1,Sc=!0,ld=null,Hd=!1,Ie=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.n1c=this.a1c=this.PXh=this.onScroll=this.onResize=this.$0=this.eya=this.lHa=this.documentElement=this.gS=this.editingElement=null;this.isFocused=!1;this.sKd=null;this.b_f=this.zDf=!1;this.Hne=null;this.u$d=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=u;this.definition=
B;this.nok=Q;this.sRa=ca;this.GOa=qa;this.Spj=Qa;this.Gna=rb;this.hostServices=Lb;this.Cto=Yb;this.LYi=gc;this.eqj=Fc;this.mnl=Sc;this.PXh=ld;this.showDictationCommandUx=Hd;this.source=Ie}}Object(m.a)(yD,"UxManagerState",null,[]);var iz=c(1631);class ap{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.Vb=b;this.ib=h;this.Zz=u;this.kd=B;this.ee=Q;this.Ib=ca;this.Ti=qa;this.qk=Qa;this.NI=rb;this.yUb=Lb;this.WRe=!1;this._state=this.z0g=null;this.shouldIgnoreFocusEvent=Yb=>{var gc;return this.kd.zd.Iy&&!this.kd.zd.FU&&
Yb===(null===(gc=this.kd.ve)||void 0===gc?void 0:gc.editingElement)};this.sa=new Nc.a;this.mwd=new tb.a;this.fBd((Yb,gc)=>{ap.Q3m(u,gc.definition,gc.source)});this.aph((Yb,gc)=>{ap.P3m(u,gc.definition,gc.source,gc.X0k)});this.Vb.ae(ap.gOd).$H=!0;v.AFrameworkApplication.va.ra(Qc.a.nLc,vc.a.view,this.nLc.bind(this))}fBd(b){this.sa.addHandler(ap.aOf,b)}o7f(b){this.sa.removeHandler(ap.aOf,b)}NLn(b,h){this.sa.raiseEvent(ap.aOf,new cB(b,h))}aph(b){this.sa.addHandler(ap.$Nf,b)}KZn(b){this.sa.removeHandler(ap.$Nf,
b)}MLn(b,h,u){this.sa.raiseEvent(ap.$Nf,new Zz(b,h,u))}GXo(b){var h;if(!b.isDismissed&&b.gS){var u=iz.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(u&&u.length){u=iz.b(u);var B=Qd.a.getElementBounds(b.gS);u.width||u.height?u.x+u.width<B.x||u.x>B.x+B.width||u.y+u.height<B.y||u.y>B.y+B.height?this.dismiss():(B=b.target,B.style.left=u.x+"px",B.style.top=u.y+"px",B.style.width=u.width+"px",B.style.height=u.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||r.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(r.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else r.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}C4i(b){b.isDismissed||b.Hne||(b.Hne=new bf.a(2,1,1,()=>{b.Hne=null;this.GXo(b)},147),this.Ib.Xb(b.Hne))}lHa(b,h){!b.isDismissed&&b.mnl&&0<h.XJ.length&&(this.dismiss(),r.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}Vzk(b){return!!b&&
b.id===ap.qok}eya(b,h){if(b.isDismissed||!h||!h.Hb)return!1;h=h.Hb;const u=h.keyCode,B=!b.isFocused&&!!b.menu,Q=h.altKey||h.ctrlKey||h.shiftKey;let ca=!1;u===Se.a.a2?(this.dismiss(),r.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):u!==Se.a.Ls&&u!==Se.a.Fw||!B||Q||!this.Vzk(b.definition)?u!==Se.a.yrb&&u!==Se.a.xoc||!B||Q||(this.D2f(b),b.menu?(b.menu.focus(),ca=!0,r.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):r.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),r.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(h.preventDefault(),h.stopPropagation());return ca}a1c(b,h){if(b.isDismissed||!b.menu)return r.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);r.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}n1c(b,h){if(b.isDismissed||!b.menu)return r.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);r.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}$0(b,h){if(b.isDismissed||!h||!h.Hb||!b.menu)return r.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Hb),!b.menu),!1;const u=b.target;b=b.menu.getElementBounds();var B=h.Hb;h=B.clientX;B=B.clientY;u&&ap.G0i(h,B,Qd.a.getElementBounds(u),16)||b&&ap.G0i(h,B,ap.sKk(b),4)||this.dismiss();return!1}zno(b){var h=iz.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=iz.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=ap.GJc();b.target=h;b.editingElement=this.kd.ve.editingElement;b.gS=this.kd.zd.container;b.documentElement=document.documentElement;b.lHa=(u,B)=>{this.lHa(b,B)};b.eya=
u=>this.eya(b,u);b.$0=u=>this.$0(b,u);b.onScroll=()=>{this.C4i(b)};b.onResize=()=>{this.C4i(b)};b.showDictationCommandUx&&(b.a1c=u=>this.a1c(b,u),b.n1c=u=>this.n1c(b,u),this.yUb&&this.yUb.execute(u=>{u.Tio(b.a1c);u.Vio(b.n1c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.Sw(b.lHa);this.Ti.u_(b.onResize);this.ee.ob(Kd.a.eG,b.editingElement,b.eya);b.GOa&&this.qk.ob(Kd.a.nda,b.documentElement,b.$0);Me.a.addHandler(b.gS,"scroll",b.onScroll);b.sRa||this.D2f(b);return!0}WGb(b,
h){const u=!!b.menu;this.MLn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Vb.currentScope.name===ap.gOd&&this.Vb.dS(ap.gOd);b.lHa&&this.ib.ZY(b.lHa);b.eya&&b.editingElement&&this.ee.sc(Kd.a.eG,b.editingElement,b.eya);this.yUb&&this.yUb.execute(B=>{b.showDictationCommandUx&&(B.R3n(),B.S3n());B.skj(!1,b.showDictationCommandUx)});b.$0&&b.documentElement&&b.GOa&&this.qk.sc(Kd.a.nda,b.documentElement,b.$0);
b.onScroll&&b.gS&&Me.a.removeHandler(b.gS,"scroll",b.onScroll);b.onResize&&this.Ti.Oda(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.gS=null;b.lHa=null;b.eya=null;b.$0=null;b.onScroll=null;b.onResize=null;b.a1c=null;b.n1c=null;u&&b.Gna&&(b.zDf?b.b_f=!0:b.Gna(b.sKd))}N2a(b,h){var u;if(!h)return!1;switch(h.actionType){case Mi.b.Toggle:if(h.objectFulfillment===ap.KIo)return this.WRe=!this.WRe,this.sog(),this.jLc(b),!0;if(h.objectFulfillment===
ap.OIo)return{value:u}=this.mwd.Fc(h.suggestionGroup.type,!1),this.mwd.Z(h.suggestionGroup.type,!u),this.jLc(b),!0;break;case Mi.b.GiveFeedback:if(Yz.a.SIm(null===(u=h.suggestionGroup)||void 0===u?void 0:u.type)||zu.a.YSm(h.objectName))break;this.focus();this.sog();this.jLc(b);return!0;case Mi.b.RevealSuggestions:this.jLc(b)}b.zDf=!0;h=b.nok.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.zDf=!1;h&&this.jLc(b);b.b_f&&(b.b_f=!1,b.Gna(b.sKd),b.sKd=null);return h}jLc(b){b.$0&&b.documentElement&&
b.GOa&&(this.qk.sc(Kd.a.nda,b.documentElement,b.$0),b.GOa=!1)}vro(b,h){return b.id===bB.a.geb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}yBj(b){var h;if(this.zno(b)){var u=1;v.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(u=3);var B=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(B=b.definition.suggestionGroups[0].type,B=this.mwd.nb(B)?this.mwd.J(B):b.Cto);h=!1;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);u={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:Q=>this.N2a(b,Q),onDismiss:Q=>{this.WGb(b,Q)},keepCurrentFocus:b.sRa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.WRe,showDescription:B,showEditorButton:b.eqj,showEditorBranding:this.vro(b.definition,b.eqj),hostServices:b.hostServices,maxSuggestionGroupNumber:u,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.PXh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.LYi&&b.LYi(u);this.Zz.createContextualUi(u).then(Q=>{this.NLn(b.definition,b.source);b.menu=Q;r.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.Spj&&b.Spj();this.yUb&&9!==b.source&&this.yUb.execute(ca=>ca.skj(!0,b.showDictationCommandUx))}).catch(Q=>{this.WGb(b,{Kbp:yu.a.Unknown});r.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",Q)});0<b.u$d&&r.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.u$d)}else 5<
++b.u$d?(r.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Ib.Xb(new bf.a(2,1,Math.pow(3,b.u$d),()=>{b.isDismissed||this.yBj(b)},146))}get aE(){return!!this._state&&!this._state.isDismissed}set gge(b){this.z0g=b}get TNm(){return this.z0g}Lng(b,h){this.aE&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.aE?this._state.definition:null}set definition(b){this.aE&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.aE&&this._state.menu&&(this._state.isFocused||this.D2f(this._state),this._state.menu.focus())}sog(){this.aE&&this._state.menu&&this._state.menu.updatePosition()}D2f(b){this.Vb.zL(ap.gOd,!1);b.isFocused=!0}Vja(b,h,u,B,Q,ca=null,qa=null,Qa=null,rb=!1,Lb=null,Yb=!1,gc=!0,Fc=null,Sc=!1,ld=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Hd,Ie;if(!({paragraphNode:Ie,start:b,end:Hd}=ap.jMo(b)).returnValue)return!1;this._state=new yD(Ie,b,Hd,h,
u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld);this.yBj(this._state);return!0}DPb(b){this._state&&(this._state.sKd=b)}nLc(b,h,u){if(1===u)return this.aE?32:0;this.aE&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static Q3m(b,h,u){u=new Zr(u);b.logAction({actionType:Mi.b.SessionStart,engagement:Mi.a.Try,objectName:ap.Pwj,objectId:h.id,data:u});if(h.suggestionGroups)for(const B of h.suggestionGroups)b.logAction({actionType:Mi.b.Presented,
engagement:Mi.a.See,objectName:B.type,objectId:B.id,data:u})}static P3m(b,h,u,B){u=new Zr(u);b.logAction({actionType:Mi.b.SessionEnd,engagement:Mi.a.None,objectName:ap.Pwj,objectId:h.id,data:u},B)}static GJc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static sKk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static G0i(b,h,u,B){const Q=u.y-B,ca=u.x+u.width+B,qa=u.y+u.height+B;return u.x-B<=b&&b<=ca&&Q<=h&&h<=qa}static jMo(b){let h,u;if(!b||!me.ParagraphReader.Wb(b.node)||
b.contextId!==vc.a.Tc&&b.contextId!==vc.a.Jd&&b.contextId!==vc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};u=b.node;b.contextId!==vc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=u.characterData.length);return{returnValue:!0,paragraphNode:u,start:h,end:b}}Iec(){this.NI&&this.NI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}ap.qok="ActionSet";ap.Pwj="IntentGroup";ap.gOd="CanvasContextualUxReact";ap.KIo="Context";ap.OIo="Description";ap.aOf="MenuDidOpen";ap.$Nf="MenuDidClose";
Object(m.a)(ap,"UxManager",null,[]);class eD{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}sn(){v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=v.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(64)||Jp.a.OQa()||v.AFrameworkApplication.K.$("RewriteIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").aA.loadScript("canvasContextual")).then(()=>{this.W.ia("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:v.AFrameworkApplication.uiCulture,dataCulture:v.AFrameworkApplication.dataCulture,isRightToLeft:v.AFrameworkApplication.isRtl,ulsLogger:new hm.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Ta("Common.IInProductMessagingUIManager").execute(u=>{u.iGi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async u=>{this.W.Ta("Common.ISystemInitiatedFeedback").execute(B=>B.logActivity(u,null))}})).ha();this.W.ia("WordEditor.CanvasContextualProvider.UxManager",()=>new ap(hd.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),nb.InteractiveViewManager.instance,Nb.KeyInputManager.instance,v.AFrameworkApplication.oc,
v.AFrameworkApplication.ua,v.AFrameworkApplication.ua.M1,this.W.Ta("Common.ISystemInitiatedFeedback"),this.W.Ta("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ia("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new hm.a})).ha(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),
this.W.ia("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new hm.a})).ha(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ia("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new hm.a})).ha(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(u=>{r.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",
u)})}dispose(){}static main(){M.a.instance.Gc(new eD)}}Object(m.a)(eD,"PackageManager",null,[1,2]);class fD{constructor(b,h,u,B){this.zBm=(Q,ca,qa)=>{Q=null;ca.view.qe&&(Q=ca.view);if(!Q||!Q.mb)return 8;if(!this.FI.tEf())return 2;if(1===qa)return 32;this.jdk.O8k();return 32};this.JLi=(Q,ca,qa)=>{let Qa=null;ca.view.qe&&(Qa=ca.view);if(!Qa||!Qa.mb)return 8;if(!this.FI.tEf())return 2;if(1===qa)return 32;if(1!==this.FI.j$b(this.ib.hb,!0).count)return 2;ca=new Qg.GraphTransaction(15);try{if(ca.Db(Qa.ed),
!this.FI.mNo(Q===Qc.a.ANf))return 8}finally{ca&&ca.dispose()}return 32};this.ga=b;this.ib=h;this.FI=u;this.jdk=B}Tb(){this.ga.ra(Qc.a.cXd,vc.a.view,this.zBm);this.ga.ra(Qc.a.ANf,vc.a.view,this.JLi);this.ga.ra(Qc.a.KLi,vc.a.view,this.JLi)}}Object(m.a)(fD,"IntelligentPlaceholderActor",null,[]);class gD{constructor(){this.Nqc=new tb.a;this.lhd=new tb.a}ipk(b,h){let u;({value:u}=this.Nqc.Fc(b,u)).returnValue||this.Nqc.Z(b,u=new Ca.a);u.add(h)}Opk(b,h){this.lhd.nb(b)&&r.ULS.sendTraceTag(50954435,323,15,
"Comment ID already exists for bookmark");this.lhd.Z(b,h)}gpk(b,h,u){this.ipk(b,h);this.Opk(h,u)}kNl(b){let h;return({value:h}=this.Nqc.Fc(b,h)).returnValue?h:null}fQl(b){let h;return({value:h}=this.lhd.Fc(b,h)).returnValue?h:null}uZn(b){let h;if(({value:h}=this.Nqc.Fc(b,h)).returnValue){for(const u of h)this.lhd.remove(u);this.Nqc.remove(b)}else r.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(m.a)(gD,"IntelligentPlaceholderAtMentionManager",null,[299]);var DC=c(1682);
class EC extends DC.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Xw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}vpj(b){return!b.ja(Jc.a.LG,!1)}tib(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(m.a)(EC,"IntelligentPlaceholderDetailsProvider",DC.a,[]);var dB=c(1828),$z=c(2046),e=c(1832);class w{constructor(){this.KAa=""}Jca(b){this.KAa+=b}dBf(b){this.KAa+=b}HAf(b){this.KAa+=b}insertImage(b){this.KAa+=b}eri(b){this.KAa+=b}}Object(m.a)(w,
"PlainTextFormatCreator",null,[875]);var E=c(1622),X=c(2045);c(361);var ja=c(1681),Ha=c(1518);class gb{constructor(){this.ttc=new tb.a}contains(b){return this.ttc.nb(gb.iIf(b))}add(b){this.ttc.Z(gb.iIf(b),b)}remove(b){this.ttc.remove(gb.iIf(b))}oPo(b){for(const h of b.ttc)this.add(h.value)}KXh(){const b=new zb.a;for(const h of this.ttc)b.add(h.value.$j);return b}static iIf(b){return b.$j.toString()}}Object(m.a)(gb,"CommentRangeSet",null,[]);class wb extends Sys.EventArgs{constructor(b){super();this.commentNode=
b}}Object(m.a)(wb,"OnFollowUpEventArgs",Sys.EventArgs,[]);class Rb extends wb{constructor(b,h){super(b);this.$An=h}}Object(m.a)(Rb,"OnCreateEventArgs",wb,[]);class pc extends wb{constructor(b,h){super(b);this.RQm=h}}Object(m.a)(pc,"OnResolveEventArgs",wb,[]);var Rc=c(219);class nd{}nd.eqe="MentionExperienceDegraded";Object(m.a)(nd,"AtMentionsConstants",null,[]);class ae{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.F_c=b;this.hGk=h;this.Nad=u;this.oEd=B;this.mb=Q;this.lm=ca;this.wXd=qa;this.isi=Qa;this.Tw=
rb;this.Q2b=Lb;this.GSa=null;this.Fqn=(Yb,gc,Fc)=>{r.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Yb=this.wXd.t3a(Yb,Fc.displayName,Fc.email,Fc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,gc),!0);Yb?r.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Q2b.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:nd.eqe,isInternal:!0})};this.rpn=(Yb,gc)=>{r.ULS.sendTraceTag(50954434,
323,50,"Permissions received for entity");gc&&this.Q2b.Sv(Qc.a.cSk);this.wXd.Jnm(Yb.id,gc)};this.kln=()=>{this.lm.zd.Iy&&!this.lm.zd.FU&&this.lm.ve.Wff?this.AAh=!0:(this.F_c.reset(),r.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.Rrn=()=>{r.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.ksk()};this.qpn=(Yb,gc,Fc,Sc=new Map)=>{Sc=Object.assign(new Ub.a,{extendedProperties:Sc});this.Q2b.logKpiFailure("LPPWordEditorKPI",Yb,{isIntentional:gc,isInternal:Fc,
additionalValues:Sc},{name:nd.eqe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:gc,isInternal:Fc,additionalValues:Sc})};(b=Ga.a.instance.Oa("Box4.IEditStateEventManager"))&&b.addHandler(Rc.a.zua,this.r5n.bind(this))}v_d(){return!!this.GSa}r5n(){this.v_d()&&this.AAh&&(this.GSa.updateInputText(this.wYc,!1),this.AAh=!1)}ariaNotify(b,h){this.Tw.sendNotification(b,h)}ksk(){const b=this.lm.ve.editingElement;if(b){var h=b.getAttribute(af.a.gGc);b.setAttribute(af.a.gGc,h?h.toString()+" PeoplePickerAutomationID":
"PeoplePickerAutomationID")}else r.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}MYn(){const b=this.lm.ve.editingElement;if(b){var h=b.getAttribute(af.a.gGc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(af.a.gGc,h.join(" ")):b.removeAttribute(af.a.gGc)):r.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else r.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}SVk(){this.MYn();this.GSa&&this.GSa.updateInputText("a",
!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.GSa=null;this.isi.Bjj(!0)}mce(){this.F_c.W5f(()=>{this.SVk()});this.F_c.N5f((b,h)=>{this.wYc=b;if(this.GSa)1<this.wYc.length&&"@"===this.wYc.trimEnd()?(this.Q2b.Sv(Qc.a.bSk),this.F_c.reset()):this.GSa.updateInputText(this.wYc,!1);else if(this.Q2b.logKpiUsage("LPPWordEditorKPI",0),this.Q2b.Sv(Qc.a.bun),(b=this.aZl(h))&&b.height){h=b.y;const u=b.height,B=document.createElement("div");B.id="PeoplePicker";B.style.position=
"absolute";B.style.top=h-5+"px";B.style.left=b.x+"px";B.style.height=u+10+"px";document.body.appendChild(B);this.hGk.createPeoplePicker({editingElementId:this.lm.ve.editingElement.id,containerElement:B,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.Fqn,onPermissionsReceivedCallback:this.rpn,onDismiss:this.kln,onShow:this.Rrn,onFailure:this.qpn}).then(Q=>{Q.updateInputText(this.wYc,!1);this.GSa=Q;this.isi.Bjj(!1)})}});this.F_c.O5f(b=>{if(this.GSa)this.GSa.onKeyDown(b.Hb.rawEvent)})}aZl(b){var h=
this.mb.hb;if(!h)return null;h=h.lb;if(!h)return null;h=h.Pa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Na.a)(134,h);if(!h)return null;h=Object(Na.a)(196,h.vj(this.lm.zd.$b));if(!h)return null;h=Object(Na.a)(105,h);if(!h)return null;let u=null;try{u=this.Nad.E_(this.oEd.I8b(2,b),h,!1,!1,!1,!1)}catch(B){r.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",B)}return u}}Object(m.a)(ae,"WordEditorAtMentionsHandler",null,[425]);var ue=c(1509);
class Ce{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld){this.ga=b;this.Zc=h;this.sMa=u;this.ib=B;this.gq=Q;this.Ld=ca;this.xD=qa;this.gnd=Qa;this.Ud=rb;this.wq=Lb;this.LUj=gc;this.ei=Fc;this.Kc=Yb;this.sa=new Nc.a;this.Mg=Sc;this.GKg=ld;Ha.a.YZe((Hd,Ie)=>{this.LG(Ie.commentNode,!0)&&this.sa.raiseEvent(Ce.g1c)})}qph(b){this.sa.addHandler(Ce.QSi,b)}Bwk(b){this.sa.addHandler(Ce.ZVi,b)}hwk(b){this.sa.addHandler(Ce.fon,b)}YZe(b){this.sa.addHandler(Ce.g1c,b)}LG(b,h){let u=b.ja(Jc.a.LG,!1);h&&(u=u&&
!b.ja(Jc.a.Gba,!1));return u}Fcc(b){return this.gq.Fcc(b)}Q4l(b){for(const h of b)for(const u of h)if(Ce.xHf(u.contextId))return u.node.Lc;return null}dbm(b,h,u){const B=new gb,Q=b.Lc;for(let ca=0;ca<b.qa.length;ca++){const qa=b.qa.J(ca);if(qa.cp>=h)break;if(qa.nf&&qa.nf.length)for(let Qa=0;Qa<qa.nf.length;Qa++){const rb=qa.nf.J(Qa);this.LG(Q.Eb(rb.$j),u)&&(rb.Qc?B.add(rb):B.remove(rb))}}return B}ebm(b,h,u,B){const Q=new gb,ca=b.Lc;for(let qa=0;qa<b.qa.length;qa++){const Qa=b.qa.J(qa);if(Qa.cp>u)break;
if(Qa.nf&&Qa.nf.length)for(let rb=0;rb<Qa.nf.length;rb++){const Lb=Qa.nf.J(rb);this.LG(ca.Eb(Lb.$j),B)&&(Lb.Qc?Qa.cp<u&&Q.add(Lb):Qa.cp<=h&&Q.remove(Lb))}}return Q}pfi(b,h){let u;const B=b.node;b.contextId!==vc.a.paragraph?(u=b.cpBegin,b=b.cpEnd):(u=0,b=B.characterData.length);return u===b?this.dbm(B,u,h):this.ebm(B,u,b,h)}$Qc(b,h){return Ce.xHf(b.contextId)?this.pfi(b,h).KXh():new zb.a}j$b(b,h){const u=new gb;for(const B of b)for(const Q of B)Ce.xHf(Q.contextId)&&u.oPo(this.pfi(Q,h));return u.KXh()}tEf(){var b=
this.ib.hb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Pa.node;return me.ParagraphReader.Wb(b)&&!me.ParagraphReader.jva(b)&&this.gq.tkb(this.ga,!0)?!0:!1}gri(b,h){if(!this.tEf())return null;if(this.gq.Hpm())return r.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let u=!1;var B=this.ib.hb.J(0).Pa;B.contextId===vc.a.Tc?(b=b?Ge.SelectionEditor.c0(B,!1):null)&&b.Vw&&b.Pa.contextId===vc.a.Jd?this.ib.Bc(b):(this.Ld.Ge(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+
" ",!0),this.ib.Bc(Cg.SelectionFactory.gJ(B.node,B.cpBegin,B.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):u=!0;this.Mg.oDb||dB.a.instance.bUc();b=this.gq.JCb(this.ib.hb.lb);if(!b)return null;this.Fcc(b)&&this.GKg.Sv(Za.a.SGa,{succeeded:!0,J8a:29});var Q=this.Zc.Tf(b);const ca=Q.Ub(1);if(!ca||393229!==ca.Nc)return null;Q=Q.Ub(2);if(!Q||393230!==Q.Nc)return null;this.Hng(b.Lc,b.id);this.sa.raiseEvent(Ce.QSi,new Rb(b,h));u&&(h=B.node,B=B.contextId!==vc.a.paragraph?
B.cpEnd:h.characterData.length,this.ib.Bc(Cg.SelectionFactory.gJ(h,B,B)));return b}cXd(b){return!!this.gri(!0,b)}oUc(b,h,u,B,Q,ca){if(0>h)return!1;B="@"+B;const qa=B+" ",Qa=new Qg.GraphTransaction(15);try{Qa.Db(b);this.Ld.Ge(Je.a.createTextRange(b,h,u),qa);this.Ud.tg&&(this.wq.k7e(b,h,h+B.length),this.wq.kra(b,h+B.length,h+qa.length,1));const rb=this.xD.qG(Je.a.createTextRange(b,h,h+B.length),"mailto:"+Q,!1,!0,!1);if(!rb)return!1;const Lb=rb.kw;if(!Lb)return r.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),
!1;this.ib.Bc(Cg.SelectionFactory.gJ(b,h,h+B.length));const Yb=this.gri(!1,2);if(!Yb)return!1;ca&&this.gnd.gpk(ca,Lb,Yb.id);this.ib.Bc(Cg.SelectionFactory.ne(b,h+qa.length))}finally{Qa&&Qa.dispose()}return!0}t3a(b,h,u,B){const Q=this.ib.ng;return Ge.SelectionEditor.ef(Q)?this.oUc(Q.node,Q.cpBegin-b,Q.cpBegin,h,u,B):!1}e8l(b){if(1===b.length&&b.J(0).Vw&&(b=b.J(0).Pa,b.contextId===vc.a.Tc&&me.ParagraphReader.Wb(b.node))){const h=b.node;for(let u=0;u<h.qa.length;u++){const B=h.qa.J(u);if(B.cp===b.cpBegin){b=
B.PSd(!0,!0);if(0<b.length)return b[0].$j;break}}}return null}uCb(b,h,u){return this.gq.zJc(b,h,u).returnValue}kPd(b,h,u,B,Q){let ca=!1;const qa=b.characterData;if(h>=qa.length||u>qa.length||u<h)return{returnValue:!1,lPa:ca};let Qa=h,rb=null;for(let Yb=0;Yb<b.qa.length;Yb++){const gc=b.qa.J(Yb),Fc=gc.cp;if(!(Fc<h)){if(gc.Wm&&rb)try{const Sc=qa.substring(Qa,Fc),ld=new $z.a;ld.fullName=Sc.startsWith("@")?Sc.substr(1):Sc;ja.a(rb,ld);const Hd=new e.a;ja.b(rb,Hd);Q&&(Hd.contentId=this.LUj.Vlf());B.HAf(Sc,
ld,Hd);ca=!0;rb=null;Qa=Fc}catch(Sc){var Lb=Object.assign(new Ub.a,{extendedProperties:new Map});Lb.extendedProperties.set("exception",Sc.message);this.GKg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Lb},{name:nd.eqe,isInternal:!0,additionalValues:Lb})}Fc<=u&&!rb&&(Lb=Math.min(Fc,u),Lb>Qa&&B.Jca(qa.substring(Qa,Lb)),Qa=Fc);gc.hyperlink&&gc.hyperlink.JG&&(rb=gc.hyperlink);if(Fc>=u)break}}return{returnValue:!0,lPa:ca}}D3h(b,h,u,B,Q=-1){var ca=!1,qa=b.Eb(h),
Qa=b.Eb(ue.k(qa));qa=b.Eb(ue.h(qa));Q=0<Q?Q:Number.MAX_VALUE;b=this.uCb(Qa,h,!0);h=this.uCb(qa,h,!1);if(-1===b||-1===h)return{returnValue:!1,lPa:ca};if(Qa===qa)return this.kPd(Qa,b,h,u,B);const rb=this.sMa.tna(Qa,!1,!1);if(!rb)return{returnValue:!1,lPa:ca};Qa=new zb.a;let Lb=0;do Qa.add(rb.Zw),Lb+=rb.Zw.characterData.length;while(rb.Zw!==qa&&rb.X8()&&Lb<Q);for(Q=0;Q<Qa.count;Q++)if(ca=Qa.J(Q),qa=ca.characterData,Q)if(Q===Qa.count-1){if(!({lPa:ca}=this.kPd(ca,0,h,u,B)).returnValue)return{returnValue:!1,
lPa:ca}}else{if(!({lPa:ca}=this.kPd(ca,0,qa.length,u,B)).returnValue)return{returnValue:!1,lPa:ca};u.Jca("\n")}else{if(!({lPa:ca}=this.kPd(ca,b,qa.length,u,B)).returnValue)return{returnValue:!1,lPa:ca};u.Jca("\n")}return{returnValue:!0,lPa:ca}}jPd(b,h){const u=new w;return this.D3h(b,h,u,!1,-1).returnValue?u.KAa:null}JMd(b,h){var u=b.Eb(h);if(!u)return null;b=b.Eb(ue.h(u));if(!b)return null;h=this.uCb(b,h,!1);if(-1===h)return null;u=b.characterData;if(h>=u.length||!F.a.ada(u.charAt(h))){u=this.Kc.Pc(15);
try{u.Db(b),this.Ld.Ge(Je.a.Oc(b,h)," ")}finally{u&&u.dispose()}}return Cg.SelectionFactory.ne(b,h+1)}Hng(b,h){const u=b.Eb(h),B=new E.a;this.D3h(b,h,B,!0).returnValue&&(B.Jca("\n"),this.gq.xDj(u,B.oaa),this.sa.raiseEvent(Ce.htn))}yao(b,h){for(const u of b){if(u.contains(h))return!0;for(const B of u)for(const Q of h)if(B.node===Q.node&&B.Ij>=Q.Ij)return!0}return!1}DPh(b,h,u,B,Q){const ca=this.ib.hb.clone(),qa=new ju.a(Fb.App.za.jb.qc);b=Cg.SelectionFactory.ne(b,h);u=Je.a.Oc(u,B);b=Cg.SelectionFactory.Dy(b,
u);this.ib.Bc(b);u=!this.yao(ca,b);return 32===this.ga.Kf(qa,Ob.a.HH,2,!0,null,null)?(u?this.ib.dZ(ca):Q!==W.a.nil&&(Q=this.JMd(this.ei.value,Q),this.ib.Bc(Q)),!0):!1}qXn(b,h){var u=b.Eb(h);const B=b.Eb(ue.k(u));b=b.Eb(ue.h(u));if(B===b){u=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var Q=B.characterData.indexOf(u);-1!==Q&&this.DPh(B,Q,b,Q+u.length,h)}}NPh(b,h,u){var B=b.Eb(h);if(!B)return!1;const Q=b.Eb(ue.k(B));b=b.Eb(ue.h(B));B=this.uCb(Q,h,!0);const ca=this.uCb(b,
h,!1);if(-1===B||-1===ca||!this.DPh(Q,B,b,ca,W.a.nil))return!1;u&&this.XPh(h);return!0}XPh(b){this.gq.S6f(b,!0)}mNo(b){var h=this.Q4l(this.ib.hb);if(!h)return!1;const u=this.j$b(this.ib.hb,!0);if(1!==u.count)return!1;const B=h.Eb(u.J(0));if(b)h=this.NPh(h,u.J(0),!1);else{const Q=ue.k(B),ca=ue.h(B);W.a.zq(Q,ca)||r.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.q5k(u.J(0));h.Eb(Q).gl(16,!0);h=!0}h&&(B.setValue(Jc.a.Gba,!0),this.sa.raiseEvent(Ce.ZVi,
new pc(B,b)));return h}yvh(b,h){b=this.j$b(this.ib.hb,!1);h.Qo[Ce.xRh]=!!b.count}hUi(b,h){if(h.Qo[Ce.xRh]&&me.ParagraphReader.Wb(h.clone)&&(h=h.clone,b=h.Lc)&&(h=Je.a.createTextRange(h,0,h.characterData.length),h=this.$Qc(h,!1),h.count))for(const u of h)(h=b.Eb(u))&&h.setValue(Jc.a.LG,!1)}QRl(b,h,u){let B;const Q=({QHc:rb}=this.gq.zJc(h,u,!0)).returnValue;u=({QHc:B}=this.gq.zJc(h,u,!1)).returnValue;let ca=null,qa=-1,Qa=-1;for(;rb<B;rb++){const Lb=h.qa.J(rb);if(Lb.hyperlink&&Lb.hyperlink.JG&&Lb.hyperlink.kw===
b){ca=Lb.hyperlink;qa=Lb.cp;break}}if(!ca||qa<Q)return{returnValue:!1,sJh:qa,rJh:Qa};for(b=rb;b<h.qa.length;b++){var rb=h.qa.J(b);if(rb.cp>u)break;if(rb.xU){Qa=rb.cp;break}}return{returnValue:-1!==Qa,sJh:qa,rJh:Qa}}rYn(b){var h=this.gnd.fQl(b);if(h){var u=null;Fb.App.za&&(u=Fb.App.za.jb.Yc.vd);if(u){var B=u.Eb(h);h=u.Eb(ue.k(B));var Q=u.Eb(ue.h(B));if(h!==Q)r.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({sJh:b,rJh:Q}=this.QRl(b,h,B.id)).returnValue){var ca=
new Qg.GraphTransaction(7);try{ca.Db(h);const qa=Je.a.createTextRange(h,b,Q);this.Ld.Ge(qa,"");this.Hng(u,B.id)}finally{ca&&ca.dispose()}this.ib.hb&&0<this.ib.hb.length?(u=this.ib.hb.J(0).Pa,u.node===h?r.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",u.cpBegin,b):r.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):r.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.Bc(Cg.SelectionFactory.ne(h,b))}else r.ULS.sendTraceTag(50954440,
323,15,"Unable to compute hyperlink CPs for bookmark")}else r.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else r.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}Jnm(b,h){if(!h){h=this.gnd.kNl(b);if(!h){r.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const u of h)this.rYn(u)}this.gnd.uZn(b)}bLl(){dB.a.instance.bUc();const b=new zb.a;for(const u of this.gq.f0e)if(u.Xq!==X.a.beingCreated){var h=W.a.Ff(u.objectId);
h=this.ei.value.Eb(h);this.LG(h,!0)&&b.add(h)}return b}Y$n(b){b=this.gq.etf(b);this.ib.Bc(b)}q5k(b){b?this.ei.value.Eb(b).setValue(Jc.a.LG,!1):r.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static xHf(b){return b===vc.a.Jd||b===vc.a.Tc||b===vc.a.paragraph}}Ce.xRh="DisableNestedIntelligentPlaceholder";Ce.QSi="CreateIntelligentPlaceholder";Ce.ZVi="ResolveIntelligentPlaceholder";Ce.htn="UpdateIntelligentPlaceholder";Ce.g1c="DeleteIntelligentPlaceholder";Ce.fon=
"MentionAddedToFollowUpEventKey";Object(m.a)(Ce,"IntelligentPlaceholderEditor",null,[296,297,298]);class Ff{constructor(b,h,u,B){this.gta=!1;this.Qs=!0;this.ee=null;this.JNa=Q=>{if(!this.Qs||!this.VQk(Q,this.ib.hb))return!1;Q.Hb.preventDefault();Q.Hb.stopPropagation();this.kd.zd&&this.kd.zd.zMc(!1);Q=this.JMd(this.ib.hb);if(!Q)return!1;this.ib.Bc(Q);return!0};this.kd=b;this.ei=h;this.ib=u;this.c7=B}Peb(b,h){this.gta||(b.mxa?(this.Qeb(h),this.gta=!0):b.fga(()=>{this.gta||(this.Qeb(h),this.gta=!0)}))}dispose(){this.ee&&
this.ee.sc(Kd.a.eG,this.kd.ve.editingElement,this.JNa)}Qeb(b){this.ee=b;this.kd.zd.Vi&&this.ee.ob(Kd.a.eG,this.kd.ve.editingElement,this.JNa)}VQk(b,h){if(b.Hb.keyCode!==Se.a.Fw&&b.Hb.keyCode!==Se.a.Ls||1!==h.length||!h.J(0).Vw)return!1;var u=this.c7.j$b(h,!0);if(1!==u.count)return!1;const B=h.J(0).Pa.node;if(!me.ParagraphReader.Wb(B))return!1;b=this.c7.uCb(B,u.J(0),!0);u=this.c7.uCb(B,u.J(0),!1);return h.J(0).Pa.cpBegin<b||h.J(0).Pa.cpEnd>u?!1:!0}JMd(b){b=this.c7.j$b(b,!0);if(1!==b.count)return null;
b=b.J(0);return this.c7.JMd(this.ei.value,b)}Bjj(b){this.Qs=b}}Object(m.a)(Ff,"IntelligentPlaceholderKeyboardListener",null,[295,10]);class bg{constructor(b,h){this.rDm=u=>{1===u&&this.ga.processAction(Za.a.SGa,2);2===u&&(this.hdh.instance?this.hdh.instance.Knc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.DR("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):r.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));
u=[Object.assign(new ha.a,{name:"DialogResult",int64:u})];Fe.d(Qc.a.v0h,void 0,void 0,void 0,void 0,void 0,u)};this.ga=b;this.hdh=h}O8k(){const b=new mg.StandardDialog;b.Cd=11;b.xe(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.xe(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.pv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.rDm);Fe.a("FollowUpsPhaseOutDialogShown")}}Object(m.a)(bg,"IntelligentPlaceholderPhaseOutDialogManager",
null,[]);var Rg=c(1487);class yd{constructor(b,h,u,B,Q,ca){this.r7=this.tNe=null;this.j5=()=>{this.r7||(this.r7=new bf.a(3,1,0,()=>{this.r7=null;this.aVd(this.ib.hb)},130),this.Ib.Xb(this.r7))};this.Kc=b;this.FI=h;this.ib=u;this.Ib=B;this.PVe=Q;this.ei=ca;this.M2=new wd.a;this.Mq=new Rg.a;this.Z9g=new wc.a(this.M2);this.FI.qph((qa,Qa)=>{this.rsk(Qa.commentNode)})}rsk(b){b=b.id;const h=this.qdi(this.ei.value,b);h&&this.Mq.Z(b,h)}qdi(b,h){const u=b.Eb(h);return!u||this.FI.Fcc(u)?null:this.FI.jPd(b,
h)}oLk(b){const h=new Rg.a;var u=this.FI.j$b(b,!0);if(!u)return h;b=this.ei.value;for(const B of u)(u=this.qdi(b,B))&&h.Z(B,u);return h}S6f(b){if(this.tNe){const h=this.Kc.Pc(15);try{h.Db(this.PVe()),this.FI.XPh(this.tNe)}finally{h&&h.dispose()}}this.tNe=b?this.FI.e8l(b):null}kom(b){const h=this.ei.value;if(b=b?this.oLk(b):new Rg.a){var u=new wc.a(this.M2),B=new wc.a(this.M2);yd.VUl(this.Mq,b,u,B);for(var Q of u)this.Mq.Z(Q,b.J(Q));for(const ca of B)if(u=this.Mq.J(ca),B=this.FI.jPd(h,ca),this.Mq.remove(ca),
B&&(b=Q=!1,Ra.a.zRc().equals(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,u=!1):u=-1<B.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?Q=!0:!Ra.a.zRc().equals(u,B),u||Q||b)){B=this.Kc.Pc(15);try{B.Db(this.PVe()),b?this.FI.NPh(h,ca,!0):(Q&&this.FI.qXn(h,ca),u&&this.FI.Hng(h,ca))}finally{B&&B.dispose()}}}}c7l(b){const h=new wc.a(this.M2);for(const u of b)for(const B of u)b=B.node,me.ParagraphReader.Wb(b)&&h.add(b.id);return h}Dmm(b){var h=
this.ei.value;const u=b?this.c7l(b):new wc.a(this.M2);if(u){b=new zb.a;for(const ca of this.Z9g)if(!u.contains(ca)){var B=h.Eb(ca);if(B){B=B.qa;for(let qa=0;qa<B.length;qa++){const Qa=B.J(qa).nf;if(Qa)for(let rb=0;rb<Qa.length;rb++){var Q=Qa.J(rb);Q.Qc&&(Q=h.Eb(Q.$j))&&Q.ja(Jc.a.GCi,!1)&&W.a.zq(ca,ue.h(Q))&&this.FI.Fcc(Q)&&b.add(Q)}}}}this.Z9g=u;if(b.count){h=this.Kc.Pc(7);try{h.Db(this.PVe());for(const ca of b)ca.zg(Jc.a.GCi)}finally{h&&h.dispose()}}}}aVd(b){this.S6f(b);this.kom(b);this.Dmm(b)}pAh(){this.r7&&
(this.Ib.Ze(this.r7),this.r7=null)}NLb(){if(this.r7||this.ei.Vxf)this.pAh(),this.aVd(null)}cC(){this.ib.Sw(this.j5);v.AFrameworkApplication.lI(()=>{this.NLb()})}dispose(){this.ib.ZY(this.j5);this.pAh()}static VUl(b,h,u,B){for(const Q of h){const ca=Q.key;b.nb(ca)||u.add(ca)}for(const Q of b)b=Q.key,h.nb(b)||B.add(b)}}Object(m.a)(yd,"IntelligentPlaceholderSelectionCache",null,[10]);var Ae;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.Uqp=3]=
"textGesture";b[b.paste=4]="paste";b[b.D5o=5]="workItemIntent";b[b.jdp=6]="characterTrigger"})(Ae||(Ae={}));Object(m.b)("IntelligentPlaceholderCreation",Ae);class Gh{constructor(b,h,u,B){this.aBa=b;this.Lm=h;this.vUb=u;this.Bx=B}yhe(b){return b&&b.Lc&&b.Lc.id.equals(this.Bx.value.vd.id)?!0:!1}Noj(b){return this.yhe(b)&&b.ja(Jc.a.LG,!1)?!0:!1}m4m(){this.vUb.execute(b=>{b.logAction({actionType:Mi.b.SessionStart,engagement:Mi.a.Offer,objectName:Gh.Emc})})}p2d(b,h){const u=2==h&&this.yhe(b);if(this.Noj(b)||
u){var B=b.getValue(Jc.a.cF);this.vUb.execute(Q=>{Q.logAction({actionType:Mi.b.Created,engagement:Mi.a.None,objectName:Gh.Emc,objectId:B.toString(),objectFulfillment:Ae[h]})})}}h2m(b){if(this.Noj(b)){var h=b.getValue(Jc.a.cF);this.vUb.execute(u=>{u.logAction({actionType:Mi.b.Deleted,engagement:Mi.a.None,objectName:Gh.Emc,objectId:h.toString()})})}}N4m(b,h){if(this.yhe(b)){var u=b.getValue(Jc.a.cF);this.vUb.execute(B=>{B.logAction({actionType:Mi.b.Resolved,engagement:Mi.a.None,objectName:Gh.Emc,objectId:u.toString(),
objectFulfillment:h?"RemoveText":"KeepText"})})}}G5m(b){b===Qc.a.cXd&&this.vUb.execute(h=>{h.logAction({actionType:Mi.b.Deleted,engagement:Mi.a.None,objectName:Gh.Emc,objectFulfillment:Gh.fGo})})}O3m(b){if(this.yhe(b)){var h=b.getValue(Jc.a.cF);this.vUb.execute(u=>{u.logAction({actionType:Mi.b.Modified,engagement:Mi.a.None,objectName:Gh.Emc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}mIk(){this.m4m();this.aBa.qph((b,h)=>{this.p2d(h.commentNode,h.$An)});this.aBa.Bwk((b,h)=>{this.N4m(h.commentNode,
h.RQm)});this.aBa.hwk((b,h)=>{this.O3m(h.commentNode)});this.Lm.f2b((b,h)=>{this.G5m(h.actionId)});Ha.a.YZe((b,h)=>{this.h2m(h.commentNode)})}}Gh.Emc="IntelligentPlaceholder";Gh.fGo="Undo";Object(m.a)(Gh,"IntelligentPlaceholderTelemetry",null,[]);class bj{constructor(){this.c7=this.$od=this.Cvd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}wc(b){this.W=b;b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new bg(v.AFrameworkApplication.va,b.Ta("Common.App.SafeLinks.ISafeLinksManager"))).ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new gD).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Ce(v.AFrameworkApplication.va,new Yn.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),
b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new hg.a(()=>Fb.App.za.jb.Yc.vd),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new fD(v.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new yd(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),v.AFrameworkApplication.oc,()=>Fb.App.za.jb.qc.ed,new hg.a(()=>Fb.App.za.jb.Yc.vd))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new Ff(nb.InteractiveViewManager.instance,new hg.a(()=>Fb.App.za.jb.Yc.vd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new Gh(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Ta("CanvasContextual.ICanvasContextualController"),new hg.a(()=>Fb.App.za.jb.Yc))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}sn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Ta("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Tb();this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").mIk();
this.c7=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");hu.a.Tuk(Object(z.a)(this.c7,this.c7.yvh,"beforeIntelligentPlaceholderPaste"));hu.a.jBd(Object(z.a)(this.c7,this.c7.hUi,"onIntelligentPlaceholderPaste"));this.Cvd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(99)||this.Cvd.cC();this.$od=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");this.$od.Peb(Fb.App.za.jb,
Nb.KeyInputManager.instance);this.ZTn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.Cvd&&this.Cvd.dispose();this.$od&&this.$od.dispose();this.c7&&(hu.a.BZn(Object(z.a)(this.c7,this.c7.yvh,"beforeIntelligentPlaceholderPaste")),hu.a.j_n(Object(z.a)(this.c7,this.c7.hUi,"onIntelligentPlaceholderPaste")))}ZTn(b,h,u){b&&b.execute(B=>{B.t5(new EC(h,u))})}static main(){M.a.instance.Gc(new bj)}}
Object(m.a)(bj,"PackageManager",null,[1,2]);var uh=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},
{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},
{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},yh=c(2096),Sk=c(1973),pk=c(2053);class uj{}uj.Ryo="Search_16x16x32";uj.Jyo="ClosePaneGlyph_16x16x32";Object(m.a)(uj,"SearchBoxIcons",null,[]);var Gi=c(2056),
Lj=c(2057),kj=c(2055);class vj{constructor(){this.aUg=null}get key(){return"FIND_HIT"}get Xw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.aUg=b.node.GPa()}gJa(b){let h=null;for(const u of this.aUg)if(u.Ac<=b&&b<u.end)return h=Object.assign(new nw.a,{TG:this.key,contentObject:u}),{returnValue:!0,aG:h};return{returnValue:!1,aG:h}}}Object(m.a)(vj,"FindHitDetailsProvider",null,[335,336]);var ck=c(1654),vh=c(1591),iq=c(1634);class Yd{constructor(b,h,u,B,Q,ca,qa,Qa=null,
rb=null){this.jm=null;this.find=(Lb,Yb,gc,Fc,Sc)=>1===gc?32:void 0===Sc||null===Sc?8:Sc.length?this.Jhg(Sc):(this.H5e(pk.a.initial),32);this.findInDocument=(Lb,Yb,gc,Fc,Sc)=>this.arj(Qc.a.Tpb,Lb,Yb,gc,Fc,Sc);this.lBl=(Lb,Yb,gc,Fc,Sc)=>this.arj(Qc.a.Vpb,Lb,Yb,gc,Fc,Sc);this.UZh=(Lb,Yb,gc)=>1===gc?32:this.Jhg(this.zo.DPa());this.f4c=(Lb,Yb,gc,Fc,Sc)=>{Lb=!this.zo.sG;Sc[ji.a.Image16by16Class]=Lb?ze.getImageClass(uj.Ryo):ze.getImageClass(uj.Jyo);Sc[ji.a.LabelText]=Lb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Sc[ji.a.ApplyLabelTextToControlOnly]=!0;Sc[ji.a.EnsureControlRoleIsButton]=!0;Sc[ji.a.On]=!1;return 32};this.qCl=(Lb,Yb,gc)=>{if(1===gc)return 32;this.Lji(!1);return 32};this.BCl=(Lb,Yb,gc)=>{if(1===gc)return 32;this.Lji(!0);return 32};this.o3f=(Lb,Yb,gc,Fc,Sc)=>{Sc[xm.a.Visible]=this.zo.hrj;return 32};this.y3f=(Lb,Yb,gc,Fc,Sc)=>{Sc[xm.a.Visible]=this.zo.hrj;return 32};this.uUd=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return 32;this.eB.S6c.Rji(Sc);
return 32};this.cancelSearch=(Lb,Yb,gc)=>{if(1===gc)return 32;this.H5e(pk.a.initial);return 32};this.kIc=(Lb,Yb,gc)=>{if(1===gc)return 32;this.H5e(pk.a.initial);this.zo.hC(!1);return 32};this.clearSearch=(Lb,Yb,gc)=>{if(1===gc)return this.$Gm(Lb===Za.a.BDh);this.zo.clearSearch();return 32};this.kne=(Lb,Yb,gc)=>{if(1===gc)return 32;switch(Lb){case Za.a.Fjf:this.zo.matchCase=!this.zo.matchCase;break;case Za.a.Xjf:this.zo.matchWholeWord=!this.zo.matchWholeWord}return this.Jhg(this.zo.DPa())};this.rae=
(Lb,Yb,gc,Fc,Sc)=>{Sc[gg.a.On]=this.zo.matchCase;return 32};this.tae=(Lb,Yb,gc,Fc,Sc)=>{Sc[gg.a.On]=this.zo.matchWholeWord;return 32};this.$2f=(Lb,Yb,gc,Fc,Sc)=>{Lb=this.zo.matchCase;Yb=this.zo.matchWholeWord;gc="";Lb&&Yb?gc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Lb?gc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Yb&&(gc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Sc[Dq.a.Value]=gc;Sc[Dq.a.Visible]=Lb||Yb;return 32};this.fic=(Lb,Yb,gc,Fc,Sc)=>{Lb=this.zo.W2;Yb="";switch(this.zo.sG){case pk.a.startSearch:Yb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case pk.a.searching:Yb=Lb?this.Isf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case pk.a.searchComplete:Yb=
this.Isf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case pk.a.tooManyResults:Yb=this.Isf(this.zo.iGa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case pk.a.noMatchesFound:Yb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case pk.a.replaceAllInProgress:Yb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case pk.a.replaceAllComplete:Yb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Sc[Dq.a.Value]=
Yb;return 32};this.sae=(Lb,Yb,gc,Fc,Sc)=>{Sc&&(Sc.CommandValueId=this.zo.DPa());return 32};this.replace=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return this.cGf()?32:8;if(!this.cGf())return 8;Lb=this.zo.uGb();"string"===typeof Sc&&Sc&&(Lb=Sc);r.ULS.sendTraceTag(6033813,312,50,"Replace Called");Fe.a("NavigationPaneReplace");Sc=this.kyb.replace(Lb);this.zo.Mdo(Sc);return 32};this.replaceAll=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return this.YQm()?32:8;Lb=this.zo.uGb();"string"===typeof Sc&&Sc&&(Lb=Sc);Fe.a("NavigationPaneReplace");
this.jm=this.he.Vf("UserAction","ReplaceAll");this.zo.b8(pk.a.replaceAllInProgress);r.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");iq.a.n1n(this.zo.DPa(),this.zo.uGb());this.kyb.replaceAll(Lb,this.Dqn);return 32};this.Dqn=(Lb,Yb)=>{this.jm&&(this.jm.stop(),this.jm=null);r.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Lb,["TotalCount"]:Yb});iq.a.k1n(Lb,Yb);this.zo.b8(pk.a.replaceAllComplete)};this.V3i=(Lb,Yb,gc,Fc,Sc)=>{Yb=!1;if(!Sc)return 8;
this.zo.gj.isVisible&&(Yb=Lb===Qc.a.z4c===this.zo.VQc());Lb!==Qc.a.z4c||this.e1g||(Yb=!1);Sc[gg.a.On]=Yb;return 32};this.a3f=(Lb,Yb,gc,Fc,Sc)=>{if(!Sc||!this.zo.gj.isVisible)return 32;Sc[gg.a.On]=this.zo.iGa;return 32};this.c3f=(Lb,Yb,gc,Fc,Sc)=>{if(!Sc)return 32;Sc.currentFindReplaceViewType=this.zo.sG;return 32};this.tJn=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return 32;Lb=Sc[gg.a.On];Sc&&(Sc[gg.a.On]=this.zo.gj.isVisible);Lb&&!Sc[gg.a.On]&&(Yd.Tzj(),Fe.a("NavigationPaneCrossClick"));return 32};this.t8a=(Lb,
Yb,gc,Fc,Sc)=>{const ld=this.zo.gj.isVisible;r.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",ld);return ld?this.kIc(Lb,Yb,gc,Fc,Sc):this.olc(Lb,Yb,gc,Fc,Sc)};this.olc=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return fc.SessionStatusManager.instance.WH?32:8;if(2===gc){v.AFrameworkApplication.Spa("AutoDetectedHeadingsIsEnabled");Yd.Tzj();this.u5();ck.FindReplaceUIManager.EOk(Lb,Sc,this.zo.gj.isVisible);Yb=!0;Lb===Qc.a.slc&&void 0!==Sc&&null!==Sc&&(Yb=Sc);this.zo.hC(!0,Yb);Sc=kj.a.initial;switch(Lb){case Qc.a.plc:r.ULS.sendTraceTag(42501022,
367,50,"");Sc=kj.a.headings;break;case Qc.a.Tpb:Sc=kj.a.find;break;case Qc.a.Vpb:Sc=kj.a.replace;break;case Qc.a.slc:Sc=kj.a.intelligentPlaceholder;break;case Qc.a.t8a:Sc=this.zo.N5b,Sc||(r.ULS.sendTraceTag(42501023,367,50,""),Sc=kj.a.headings)}this.zo.Fio(Sc,Yb);return 32}return 8};this.WGa=()=>{this.zo.sG&&!this.zo.iGa&&r.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.zo=h;this.eB=u;this.kyb=B;this.e1g=Q;this.he=qa;rb&&rb(1,this.WGa,null);this.iLa=Qa}u5(){}Tb(){this.ga.fb(Qc.a.O3f,
vc.a.view,this.tJn,96);this.ga.ra(Qc.a.t8a,vc.a.view,this.t8a);this.ga.ra(Qc.a.plc,vc.a.view,this.olc);this.ga.ra(Qc.a.Tpb,vc.a.view,this.olc);this.ga.ra(Ob.a.Kjf,vc.a.view,this.find);this.ga.ra(Za.a.findInDocument,vc.a.view,this.findInDocument);this.ga.ra(Ob.a.Jjf,vc.a.view,this.UZh);this.ga.fb(Za.a.UIn,vc.a.view,this.f4c,97);this.ga.ra(Ob.a.iSf,vc.a.view,this.qCl);this.ga.ra(Ob.a.g1f,vc.a.view,this.BCl);this.ga.fb(Ob.a.o3f,vc.a.view,this.o3f,97);this.ga.fb(Ob.a.y3f,vc.a.view,this.y3f,97);this.ga.ra(Qc.a.uUd,
vc.a.view,this.uUd);this.ga.ra(Ob.a.M3b,vc.a.view,this.cancelSearch);this.ga.ra(Za.a.clearSearch,vc.a.view,this.clearSearch);this.ga.ra(Za.a.BDh,vc.a.application,this.clearSearch);this.ga.ra(Qc.a.kIc,vc.a.view,this.kIc);this.ga.ra(Za.a.Fjf,vc.a.view,this.kne);this.ga.ra(Za.a.Xjf,vc.a.view,this.kne);this.ga.fb(Za.a.rae,vc.a.view,this.rae,97);this.ga.fb(Za.a.tae,vc.a.view,this.tae,97);this.ga.fb(Qc.a.$2f,vc.a.view,this.$2f,97);this.ga.fb(Qc.a.fic,vc.a.view,this.fic,97);this.ga.fb(Qc.a.a3f,vc.a.view,
this.a3f,97);this.ga.fb(Qc.a.c3f,vc.a.view,this.c3f,97);this.ga.fb(Qc.a.b3f,vc.a.view,this.V3i,97);Object(vh.b)()&&this.ga.fb(Qc.a.sae,vc.a.view,this.sae,96);this.e1g&&(this.ga.fb(Qc.a.Vpb,vc.a.view,this.olc,1028),this.ga.fb(Qc.a.z4c,vc.a.view,this.V3i,97),this.ga.fb(Qc.a.replace,vc.a.view,this.replace,1028),this.ga.fb(Qc.a.replaceAll,vc.a.view,this.replaceAll,1028),v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.fb(Za.a.Rjf,vc.a.view,this.lBl,1028));this.ga.ra(Qc.a.slc,vc.a.view,this.olc)}A5f(){this.iLa&&this.iLa.execute(b=>{b.t5(new vj)})}arj(b,h,u,B,Q,ca){if(1===B)return fc.SessionStatusManager.instance.WH?32:8;if(void 0===ca||null===ca)return 8;this.olc(b,u,2,Q,ca);b=this.zo;b.acg(ca.CommandValueId);Object(vh.b)()&&("MatchCase"in ca&&(b.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(b.matchWholeWord=ca.MatchWholeWord));return this.UZh(h,u,B,Q,ca)}Jhg(b){if(void 0===b||null===b||!b.length)return 32;
b=Gi.a.createQuery(b,this.ZIn);if(void 0===b||null===b)return r.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.eB.find(b);return 32}get ZIn(){let b=Lj.a.none;this.zo.matchCase&&(b|=Lj.a.matchCase);this.zo.matchWholeWord&&(b|=Lj.a.wholeWordOnly);return b}Lji(b){this.zo.N5b!==kj.a.headings&&this.zo.W2&&(b?this.eB.S6c.fkm():this.eB.S6c.Nji())}H5e(b){this.zo.sG&&(this.zo.iGa||r.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.eB.G_a(),this.zo.b8(b))}$Gm(b){return this.zo.sG===
pk.a.replaceAllInProgress||b&&!this.zo.sG?8:32}Isf(b){return String.format(b,this.zo.kid,this.zo.W2)}cGf(){return this.zo.VQc()&&0<this.zo.W2}YQm(){return this.cGf()&&this.zo.iGa}static Tzj(){null!=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Yd.fEa)}static XVl(b,h,u,B){return new Yd(v.AFrameworkApplication.va,
b,h,u,B,hd.FocusManager.instance(),Fb.App.za.Iq,Ga.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(v.AFrameworkApplication.ua.WP,v.AFrameworkApplication.ua.WP.ob,"registerHandler"))}static WVl(b,h,u,B){return Yd.XVl(b,h,u,B)}}Yd.fEa=5E3;Object(m.a)(Yd,"FindReplaceActor",null,[]);var d=c(906),n=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.uK},set:function(h){this.uK=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"last",{get:function(){return this.xXa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,u){this.removeItem(h);u={key:h,dV:this.xXa,next:void 0,data:u};this.first||(this.first=u);this.xXa&&(this.xXa.next=u);this.xXa=u;this._map.set(h,u)};b.prototype.insertAfter=function(h,u,B){h=this._map.get(h);if(!h)return!1;B={key:u,dV:h,next:h.next,data:B};var Q=h.next;Q&&(Q.dV=B);h.next=B;this._map.set(u,
B);return!0};b.prototype.insertBefore=function(h,u,B){h=this._map.get(h);if(!h)return!1;B={key:u,dV:h.dV,next:h,data:B};var Q=h.dV;Q&&(Q.next=B);h.dV=B;this._map.set(u,B);return!0};b.prototype.removeItem=function(h){var u=this._map.get(h);u&&(this.first===u&&(this.first=u.next),this.xXa===u&&(this.xXa=u.dV),u.dV&&(u.dV.next=u.next),u.next&&(u.next.dV=u.dV),this._map.delete(h))};return b}();class A{constructor(){this.type="heading"}}Object(m.a)(A,"NavPaneHeadingItem",null,[]);class S{constructor(){this.type=
"bookmark"}}Object(m.a)(S,"NavPaneBookmarkItem",null,[]);class da{constructor(b,h,u,B,Q,ca,qa){this.gb=b;this.ib=h;this.Vb=u;this.xn=B;this.$U=Q;this.UF=ca;this.O3j=qa;this.yYa=0;this.jrd=new Map;this.aXg=!1;this.yAa=new Map}get headingsReady(){return this.aXg}set headingsReady(b){this.aXg=b}get DNb(){return this.yYa}get X9(){this.pZb&&0!=this.pZb.length()||(this.pZb=this.XDn());return this.pZb}set X9(b){this.pZb=b}get Sjc(){return this.Bgk}set Sjc(b){this.Sjc&&(this.Sjc.isSelected=!1);b.isSelected=
!0;this.Bgk=b}lrf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}XDn(){const b=new n;if(!this.$U)return b;this.jrd=new Map;let h;const u=[];for(const B of this.$U.paragraphs()){const Q=this.jbi(B,u);null===Q||void 0===Q?void 0:Q.forEach(ca=>{(h=this.$ci(ca,u))&&"heading"===h.type&&h.indentLevel<ca.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ca.isHidden=!1):(h.isCollapsed=!0,ca.isHidden=!0));b.insert(this.lrf(ca,B),ca)})}return b}$ci(b,h){return"heading"===b.type?1<h.length?h[h.length-
2]:void 0:0<h.length?h[h.length-1]:void 0}uog(b){var h;let u=me.ParagraphReader.voa(b),B=!1;9===u&&this.yAa.has(b.id.toString())&&(u=this.yAa.get(b.id.toString()),B=!0);const Q=null===(h=this.X9.get(b.id.toString()))||void 0===h?void 0:h.data;if(Q){if(Q.indentLevel===u){h=wp.AParagraphNode.NP(b.characterData.trim());b=this.xn.value.nZf(b);if(h!==Q.text||Q.hasBookmark!==b)return Q.text=h,Q.hasBookmark=b,!0;!B&&Q.isPurelyADH&&(Q.isPurelyADH=!1,--this.yYa);return!1}this.s3c();return!0}if(9===u)return this.LFm(b)?
(this.s3c(),!0):!1;this.s3c();return!0}LFm(b){var h;const u=this.xn.value.r4h(b);b=null!==(h=this.jrd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==u.length)return!0;for(h=0;h<b;++h)if(!this.X9.get(u[h].sPa()))return!0;return!1}Oil(b){if(this.X9.get(b.id.toString())||this.xn.value.nZf(b))return this.s3c(),!0;this.yAa.has(b.id.toString())&&(this.yAa.delete(b.id.toString()),--this.yYa);return!1}s3c(){const b=new n;this.yYa=0;if(this.$U){this.jrd=new Map;var h=[],u,B;for(const Q of this.$U.paragraphs()){const ca=
this.jbi(Q,h);null===ca||void 0===ca?void 0:ca.forEach(qa=>{var Qa=this.lrf(qa,Q);B=this.$ci(qa,h);this.E5n(Qa,qa,B);b.insert(Qa,qa);"heading"===(null===u||void 0===u?void 0:u.type)&&(Qa=u,Qa.indentLevel>=qa.indentLevel&&(Qa.isCollapsed=void 0));u=qa})}}this.X9=b}E5n(b,h,u){var B,Q;if(b=null===(B=this.pZb.get(b))||void 0===B?void 0:B.data)b.isSelected&&(h.isSelected=!0,this.Sjc=h),h.isHidden=b.isHidden;if(u){if(B=null===(Q=this.pZb.get(this.lrf(u,u.paragraphNode)))||void 0===Q?void 0:Q.data)u.isCollapsed=
B.isCollapsed;u.isCollapsed?h.isHidden=!0:u.isHidden?(u.isCollapsed=!0,h.isHidden=!0):(u.isCollapsed=!1,h.isHidden=!1)}}jbi(b,h){var u=me.ParagraphReader.voa(b),B=!this.eEf(b);const Q=this.DLm(u)&&B?!0:!1;B=this.yAa.has(b.id.toString())&&B;const ca=[];if(Q)ca.push(this.LKh(b,u,!1,h));else if(B)this.yYa+=1,this.UMc&&(u=this.yAa.get(b.id.toString()),ca.push(this.LKh(b,u,!0,h)));else{let qa=0;this.xn.value.r4h(b).forEach(Qa=>{const rb=new S;rb.text=Qa.sPa();rb.isSelected=!1;rb.bookmarkManager=this.xn;
rb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;qa+=1;ca.push(rb)});this.jrd.set(b.id.toString(),qa)}return ca}LKh(b,h,u,B){var Q,ca;const qa=new A;qa.text=wp.AParagraphNode.NP(b.characterData.trim());qa.indentLevel=h;qa.paragraphNode=b;qa.isSelected=!1;qa.isPurelyADH=u;qa.listMarker=this.Brf(b);qa.hasBookmark=this.xn.value.nZf(b);for(b=null===(Q=B[B.length-1])||void 0===Q?void 0:Q.indentLevel;b&&b>=h;)B.pop(),b=null===(ca=B[B.length-1])||void 0===ca?void 0:ca.indentLevel;(!b||b<h)&&B.push(qa);
return qa}eEf(b){return this.gb.Wb(b)&&0===this.gb.textLength(b,9)}wxl(b){(b=this.X9.get(b))&&(1==b.data.isCollapsed?this.mrj(b):this.psm(b))}onClickHeading(b){var h;this.Sjc=b=null===(h=this.X9.get(b))||void 0===h?void 0:h.data;h=Cg.SelectionFactory.ne(b.paragraphNode,0);this.ib.Bc(h);this.Vb.kg($d.AFrame.Un)}onClickBookmark(b){var h;this.Sjc=b=null===(h=this.X9.get(b))||void 0===h?void 0:h.data;this.xn.value.Dji(b.text);this.Vb.kg($d.AFrame.Un)}onShareHeadingClick(b){var h;v.AFrameworkApplication.le("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");
Fe.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.X9.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Jc.a.Wc),this.O3j.value.MKh(h)}Cng(b,h){const u=b.id.toString(),B=this.yAa.has(u);if(!B||this.yAa.get(u)!==h){this.yAa.set(u,h);if(this.UMc)return this.uog(b);B||this.X9.get(u)||(this.yYa+=1)}return!1}eil(b){const h=b.id.toString(),u=this.yAa.has(h);if(u){this.yAa.delete(h);if(this.UMc)return this.uog(b);u&&!this.X9.get(h)&&--this.yYa}return!1}FIo(b){this.UMc=b;this.s3c()}cog(b){var h;
const u=null===(h=this.X9.get(b.id.toString()))||void 0===h?void 0:h.data;if(!u)return!1;b=this.Brf(b);if(u.listMarker===b)return!1;this.hRo();return!0}PJd(b){var h;b=null===(h=this.X9.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}mrj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let u;for(;b&&b.data.indentLevel>h;)u=b,b=u.next,u.data.isHidden=!1,"heading"==u.data.type&&(b=u.data.isCollapsed?this.$wo(u):
this.mrj(u));return b}psm(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let u;for(;b&&b.data.indentLevel>h;)u=b,b=u.next,u.data.isHidden=!0}$wo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}DLm(b){return 0<=b&&8>=b}hRo(){let b=this.X9.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.Brf(h.paragraphNode)}b=b.next}}Brf(b){var h;if(b.bJ instanceof d.a)return this.Thm(null===(h=this.UF.Zlb(b.bJ))||void 0===h?void 0:h.z9)}Thm(b){for(let h=
0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(m.a)(da,"NavPaneHeadingsManager",null,[]);var Ea=c(1592);class jb{constructor(){this.kyb=this.eB=this.Kuc=this.zkd=this.W=null}get name(){return"WordEditor.FindReplace"}wc(b){this.W=b;const h=new da(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),hd.FocusManager.instance(),b.Re("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),
b.Re("WordEditor.Actors.HeadingsActor"));this.W.ia("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){jb.Zb.lq.continueWith(()=>{this.sn()})}sn(){if(Fb.App.Tqg){const b=Fb.App.Toe;this.Kuc=ck.FindReplaceUIManager.getInstance(b);this.eB=Sk.FindManager.createInstance(this.Kuc,yh.a.instance,Ea.a.instance,!0);this.kyb=this.eB.COb;this.zkd=Yd.WVl(this.Kuc,this.eB,this.kyb,b);this.zkd.Tb();this.zkd.u5();this.zkd.A5f();Fb.App.za.updateCommandUI()}}dispose(){this.Kuc&&
this.Kuc.dispose()}static get Zb(){return null!=jb.uxg?jb.uxg:jb.uxg=Ga.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(jb,"FindReplacePackageManager",null,[1,2]);class Sb{constructor(){}Vlf(){return"_@_"+yb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}aUo(b,h,u,B){h.Odo(b,B);h.Yl(b,Xe.a.N$,!0);h.Yl(b,Jc.a.iRa,!0);h.Yl(b,Jc.a.HX,Sb.NYh(u));h.Yl(b,Jc.a.Is,15)}nyk(b,h,u,B){const Q=b.XHd(B);h.Yl(Q,Xe.a.N$,!0);h.Yl(Q,Jc.a.Is,47);h.Yl(Q,Jc.a.HX,Sb.NYh(u));b=b.XHd(B);h.Yl(b,
Xe.a.N$,!0);h.Yl(b,Jc.a.Is,16);return[Q.Tj,b.Tj]}MIl(b,h,u){b=b.XHd(u);h.Yl(b,Xe.a.N$,!0);h.Yl(b,Jc.a.AJb,!0);return b.Tj}static NYh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(m.a)(Sb,"AtMentionHyperlinkConfigurator",null,[431]);class uc{constructor(b,h,u){this.DBa=b;this.ib=h;this.xli=this.Tti=this.mFe=!1;this.dMb=this.dMb.bind(this);this.eMb=this.eMb.bind(this);this.nMb=this.nMb.bind(this);u&&u.execute(B=>{this.eWa=B});qs.a.PCd.yof.then(B=>{this.xli=!0;this.Tti=B.isSuccess})}mce(){this.DBa.N5f(this.dMb);
this.DBa.O5f(this.eMb);this.DBa.W5f(this.nMb)}v_d(){return!1}dMb(b,h,u){var B,Q;h=Date.now();if(this.eWa)if(this.xli&&!this.Tti)r.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ca=null===(Q=null===(B=this.ib.hb)||void 0===B?void 0:B.lb)||void 0===Q?void 0:Q.Rc;ca?(B=ca.node,me.ParagraphReader.Wb(B)?(Q=me.ParagraphReader.text(B),0>u||u>Q.length?r.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):
1<b.length&&"@"===b.trimEnd()?(Fe.c(Qc.a.o4k,!0,void 0,void 0,void 0,void 0),this.DBa.reset()):(this.mFe?this.eWa.EUo():(this.mFe=!0,this.eWa.awo(ca)),this.eWa.Lng(u,u+b.length),b=Q.substring(0,u)+b,this.eWa.hmf(B,b,u,h))):r.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):r.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else r.ULS.sendTraceTag(537776153,
3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}eMb(b){if(this.eWa)this.eWa.onKeyDown(b)}nMb(){this.mFe=!1;this.eWa&&this.eWa.jEh()}}Object(m.a)(uc,"ContextIQUserInitHandler",null,[425]);var Mc=c(1664);class jd{constructor(){this.Zz=null}get name(){return"WordEditor.AtMentions"}wc(b){this.W=b;b.ia("Box4.IAtMentionHyperlinkConfigurator",()=>new Sb(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:jd.uLj,featureName:jd.bNj,topLevelKpiName:jd.yQj,
vetoPillar:7};b.ia("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new hw.a(xa.Health.instance,new ev.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()})}dispose(){}sn(){this.W.Ta("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{v.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&v.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));
(h||Mc.a.qed())&&this.H_m()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}H_m(){(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").aA.loadScript("canvasAtMentions")).then(()=>{v.AFrameworkApplication.K.Hn(()=>{this.uSn()})})}uSn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:v.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},
useLPP:!0,isTestEnv:this.MTm()};this.Zz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(u=>{u&&Mc.a.sed()||!u&&Mc.a.qed()?(Mc.a.ACf=!u,this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new uc(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Ta("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):
this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new ae(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.Zz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),nb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),
this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").mce()})})}MTm(){var b,h;const u=null!==(b=v.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=v.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return u===jd.hLj&&b===jd.gLj}}jd.hLj="-4";jd.gLj="DC2";jd.uLj="webasynccollabeng";jd.bNj="AtMentions";jd.yQj="AtMentionsFeatureUsage";Object(m.a)(jd,
"PackageManager",null,[1,2]);var Bd=c(1697),be=c(1401);class ke{constructor(b,h,u,B){this.ga=b;this.Oe=h;this._augLoopRuntimeManager=u;this.enk=B;this.eua=0;this.Qzd=this.I_b=!1;this.AMg=this.Ubh=this.HJe=this.Vbh=0;this.jtb=null;this.F_j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.rZj=[{id:`${iu.Thc}_${1}`},{id:`${iu.Thc}_${2}`},{id:`${iu.Thc}_${3}`},{id:be.a.jJd},{id:be.a.FHd},{id:be.a.G9d},
{id:be.a.D9d}];this.zTj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.ihd=new Map;this.Q5j=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.e$j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.KWj=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Oe.ob(this,Bd.SearchSuggestionAnnotation.getTypeName());(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.ihd.set("InsertLink","InsertLinkFlyout");this.ihd.set("GraphicsEditor","");this.bDj();this.Tb(this.ga)}iGn(b,h){const u=Date.now();this.HJe&&1250>u-this.HJe||this.kxb||(this.HJe=u,this.jtb=b,this.Fwd=this.Qcm(h),this.u4n(),
this.I2n())}GB(b,h){if(b.annotationType===Bd.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===hp.a.getTypeName()&&(h=Date.now(),b=b.content,this.kxb&&this.kxb===b.correlationId)){window.clearTimeout(this.eua);this.kxb=void 0;var u=this.I_b,B=this.n2l(b),Q=B&&0<B.length;Q&&(this.rVo(B),this.Qzd&&(u=!1));u&&this.Saj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.Ubh,["canvasContextRetrievalTime"]:this.AMg,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.Vbh,["containsZTM"]:Q,["shouldFallBack"]:this.I_b,["fallBack"]:u};r.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}n2l(b){const h=this.getSuggestions(b.intentSuggestions,Bd.IntentIds.ZeroTermMenu,Bd.ObjectSemantic.GenericSuggestions,Bd.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,u,B){return Array.isArray(b)?b.filter(Q=>Q.intent===
h&&Q.result.semantic===u&&Q.result.type===B).map(Q=>Q.result.value):[]}Tb(b){b.fb(Za.a.HIi,vc.a.application,this.J2n.bind(this),96)}Qcm(b){const h=[],u=new Map,B=Date.now();for(const Q of b){if(!Q)continue;b=[];const ca={itemsMetadata:new tb.a};for(let qa=0;qa<Q.ControlList.length;qa++){const Qa=Q.ControlList[qa];if(Qa&&!Qa.ExternalId)continue;b.push(Qa.ExternalId);const rb={timeStamp:B,source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Qa.ExternalId]=rb;u.set(Qa.ExternalId,rb)}h.push(appChrome.api.menuSection(b,
Q.Title,Q.Lang,Q.Id,ca))}return{sections:h,commands:u}}xzj(b){return this.ihd.has(b)?this.ihd.get(b):b}sJa(b){const h={};for(const u of b)b=this.xzj(u.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Fb.App.za.FOd(h)}pHm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.F_j.has(b)?this.Fwd.commands.has(b):!0}WMh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.jtb})}bib(b=
!1){b=b?Tl.a.instance.Huc:Tl.a.instance.bib();const h=[],u=Date.now();for(const B of b)B.commandId&&h.push({Id:B.commandId,TimeElapsedSinceClick:(u-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Qx});return h}dPc(){const b=Tl.a.instance.dPc(),h=[],u=Date.now();for(const B of b)B.controlId&&h.push({Id:B.controlId,TimeElapsedSinceClick:(u-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Qx});return h}wnf(){const b={semantic:Bd.ObjectSemantic.CanvasContext,
type:Bd.ObjectSchemaType.WordCanvasContext,value:{contentType:this.jtb}};if(this.KWj){const h=Date.now(),u=this.enk.wnf(xf.a.instance.hb.lb);u&&u.value.contentType&&(b.value=u.value);this.AMg=Date.now()-h}return b}x6h(){const b=this.dPc(),h=this.bib(),u=this.bib(!0),B=[];B.push({semantic:Bd.ObjectSemantic.ControlIdHistory,type:Bd.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Bd.SequenceType.ControlId,Sequence:b}});B.push({semantic:Bd.ObjectSemantic.CommandIdHistory,type:Bd.ObjectSchemaType.CommandExecutionSequence,
value:{SequenceType:Bd.SequenceType.CommandId,Sequence:h}});B.push({semantic:Bd.ObjectSemantic.FilteredCommandIdHistory,type:Bd.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Bd.SequenceType.CommandId,Sequence:u}});B.push(this.wnf());return B}bDj(){this._augLoopRuntimeManager.getSession().then(b=>this.fgd=b).catch(()=>{this.fgd=void 0})}I2n(){const b=Date.now(),h=this.x6h(),u=[Bd.IntentIds.ZeroTermMenu,Bd.IntentIds.Logging];this.Ubh=Date.now()-b;this.dvj(u,h,"ContextualMenu")}J2n(b,
h,u){2===u&&(b=this.x6h(),this.dvj([Bd.IntentIds.Logging],b,"Floatie"));return 32}dvj(b,h,u){if(0===b.length||0===h.length)r.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var B=new Bd.SearchSuggestionSignal({correlationId:this.dQd("ACM"),intents:b,contextObjects:h,entryPoint:u});this.I_b=0<=b.indexOf(Bd.IntentIds.ZeroTermMenu);this.Vbh=Date.now();this.kxb=B.correlationId;this.eua=window.setTimeout(()=>{this.Iqn(B.correlationId)},750);h=new hp.l({parentPath:["Signal",
Bd.SearchSuggestionSignal.getTypeName()],items:[{id:yb.a.create().toString(),body:B}]});this.fgd&&!this.fgd.isClosed?this.fgd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.bDj());r.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:B.correlationId,["shouldFallBack"]:this.I_b,["intents"]:b}))}}dQd(b){const h=yb.a.create().toString();appChrome.api.setOfeCorrelationId(b,
h);return h}Iqn(b){this.kxb&&this.kxb===b&&(this.kxb=void 0,this.I_b&&this.Saj(),r.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.I_b})))}Saj(){const b=this.WMh(this.Fwd.sections);appChrome.api.dispatch(b);this.$Fh()}$Fh(){this.Qzd=!0}zXn(b){var h,u;const B=[],Q=new Map;if(!b||0===b.length)return B;for(const ca of b){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;b={controlIds:[],
id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new tb.a}};const qa="CommandsZTM"===ca.id;for(const Qa of ca.controlIds){if(Q.has(Qa))continue;if(qa&&b.controlIds.length>=this.e$j)break;const rb=null===(u=null===(h=ca.data)||void 0===h?void 0:h.itemsMetadata)||void 0===u?void 0:u[Qa];Q.set(Qa,rb);b.controlIds.push(Qa);rb&&(b.data.itemsMetadata[Qa]=rb)}0<b.controlIds.length&&B.push(b)}return B}u4n(){this.Qzd=!1;if(this.Q5j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",
!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}rVo(b){this.Qzd||(b=this.JJl(b),0<b.length&&appChrome.api.dispatch(b))}JJl(b){const h=[];let u=[];var B=this.z7l();B&&0<B.length&&u.push(...B);(B=this.EIl())&&u.push(B);Array.isArray(b)&&0<b.length&&(b=this.tva(b))&&(b.id="CommandsZTM",u.push(b));(b=this.uIl())&&u.push(b);u=this.zXn(u);if(0===u.length)return[];h.push(this.WMh(u));this.$Fh();return h}z7l(){var b,h;const u=null===(b=this.Fwd)||
void 0===b?void 0:b.sections.filter(B=>{var Q;return null===(Q=B.id)||void 0===Q?void 0:Q.startsWith(iu.iUh)});for(const B of u)if(null===(h=B.data)||void 0===h?0:h.itemsMetadata)for(const Q in B.data.itemsMetadata)B.data.itemsMetadata[Q].source="PassThroughZeroTermMenu";return u}EIl(){const b=this.v2h(this.rZj,"DefaultZeroTermMenu");return this.tva(b)}uIl(){const b=this.v2h(this.zTj,"AdvertizedZeroTermMenu");return this.tva(b)}v2h(b,h){const u=[];for(const B of b)B&&this.Aro(B)&&this.Fwd.commands.has(B.id)&&
u.push({suggestion:B.id,rankingScore:-1,suggestionSource:h});return u}Aro(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}tva(b){const h=[],u={itemsMetadata:new tb.a},B=Date.now();this.sJa(b);for(const Q of b)b=this.xzj(Q.suggestion),this.pHm(b)&&(h.push(b),u.itemsMetadata[b]={timeStamp:B,source:Q.suggestionSource,confidenceScore:Q.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,u):null}}Object(m.a)(ke,"AugLoopSearchSuggestionManager",
null,[292,293]);class He{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}wc(b){this.W=b;this.W.ia("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new ke(v.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>
{qs.a.Uk().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){M.a.instance.Gc(new He)}}Object(m.a)(He,"PackageManager",null,[1,2]);var df=c(436),Ne=c(955);class Lg extends Ne.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(m.a)(Lg,"BootMessage",Ne.a,[]);var di=c(1066);class ll{constructor(){this.FQ=null;this.mon=b=>{if(b.target===this.FQ)if(void 0===b.data||null===b.data)r.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=G.a(b.data);this.Sje(h.api)?this.Rfd.J(h.api).U3d(h.method,h):r.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){r.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.Rfd=new Vd.a}LHf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let u=!1;try{this.FQ=new Worker(b);this.FQ.onmessage=this.mon;const B=Object.assign(new Lg,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(B);this.LHf()&&di.a.gSj(this.FQ);u=!0}catch(B){r.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",B)}return u}postMessage(b){try{const h=G.c(b);this.FQ.postMessage(h)}catch(h){r.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}Sje(b){return this.Rfd.nb(b)}Mok(b,
h){this.Sje(b)&&r.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.Rfd.Z(b,h)}$Ll(b){return this.Sje(b)?this.Rfd.J(b):null}}Object(m.a)(ll,"WebWorker",null,[63]);class Zl{constructor(){this.jrg=[]}Wdl(b,h){if(h){var u=v.AFrameworkApplication.Rz(b.Yfj,7),B=[];for(let Q=0;Q<b.YQb.length;Q++){let ca;switch(b.YQb[Q].format){case 5:case 6:ca=df.a.xGb(b.YQb[Q].name);break;default:ca=b.YQb[Q].name}B.push(v.AFrameworkApplication.Rz(ca,
b.YQb[Q].format))}try{const Q=URL.createObjectURL(new Blob(["importScripts('"+u+"');"],{type:"application/javascript"})),ca=new ll;if(ca.create(Q,B))for(this.jrg.push(ca),u=0;u<b.Rje.length;u++){const qa=h.w7k(ca,b.Rje[u]);qa&&ca.Mok(b.Rje[u],qa)}}catch(Q){r.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",Q.message)}}else r.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(m.a)(Zl,"WebWorkerCollection",null,
[]);class Nm{constructor(b,h){this.uXe=new Zl;if(b){b=b.create();for(let u=0;u<b.length;u++)this.uXe.Wdl(b[u],h)}else r.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...u){let B=!1;for(let ca=0;ca<this.uXe.jrg.length;ca++){var Q=this.uXe.jrg[ca];Q.Sje(b)&&((Q=Q.$Ll(b))?B=Q.callMethod(h,u)||B:r.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}B||r.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(m.a)(Nm,"WebWorkerRouter",null,[22]);class Jn extends Ne.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(m.a)(Jn,"SettingsMessage",
Ne.a,[]);class np{constructor(b){this.FQ=b}}Object(m.a)(np,"WebWorkerApiMain",null,[]);class rm extends np{constructor(b){super(b)}LHf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return r.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.nQk(h);r.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}U3d(b,h){switch(b){case 14:this.Vmm(h);break;default:r.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}nQk(b){if(2!==b.length)return r.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return r.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new Jn,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:v.AFrameworkApplication.userSessionId,LocalCobaltSessionId:ui.a.instance.wP,LocalCobaltMachineId:ui.a.instance.$lb,LocalCobaltClusterId:ui.a.instance.BKb,LocalCobaltSessionHasBackup:ui.a.instance.Rpa,WaciiEnabledRequests:ui.a.instance.Aka,SettingsRoutedToServer:ui.a.instance.Udg,WacClusterId:v.AFrameworkApplication.He.oZ});this.FQ.postMessage(b);return!0}Vmm(b){this.LHf()&&
b&&b.result&&(r.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.wZo())}async wZo(){try{const b=await new di.a.hSj.WorkerUtilsTestClass(10);await b.Ah(5);15==await b.counter?r.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):r.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){r.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(m.a)(rm,"InitializeWorkerApiMain",np,[]);class il extends Ne.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(m.a)(il,"CatchUpNetworkRequestWorkerRequestMessage",Ne.a,[]);class Nl extends np{constructor(b,h){super(b);this.tHc=h}callMethod(b,h){if(4===b)return b=Object.assign(new il,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.FQ.postMessage(b),!0;r.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}U3d(b,h){switch(b){case 5:r.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.tHc.ieo(h);break;default:r.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(m.a)(Nl,"CatchUpNetworkRequestWorkerExternalApi",np,[]);class vk extends Ne.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(m.a)(vk,"LocalInferenceMessage",Ne.a,[]);class dk{constructor(){this.prediction=this.context=null}}Object(m.a)(dk,"LocalInferenceOutput",null,[]);class Nj{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(m.a)(Nj,"TextPredictionConfig",null,[]);class Ro{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(m.a)(Ro,"TextPredictionSettings",null,[]);class ms{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(m.a)(ms,
"TextPredictionDynamicPayload",null,[]);class FC extends np{constructor(b,h){super(b);this.mnk=h}callMethod(b,h){if(!h)return r.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.tQk(h);case 7:return this.oQk(h);case 9:return this.sQk(h);case 10:return this.pQk(h);case 13:return this.qQk(h);case 14:return this.rQk(h);default:return r.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}U3d(b,h){switch(b){case 9:this.aom(h);break;default:r.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}aom(b){b&&b.prediction&&(b=Object.assign(new dk,{prediction:b.prediction,context:b.context}),this.mnk.Uuh().tGn(b))}oQk(b){if(1>b.length)return r.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new vk,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.FQ.postMessage(b);return!0}tQk(b){if(1>b.length)return r.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new vk,{api:4,method:8,paragraphContent:b});this.FQ.postMessage(b);
return!0}sQk(b){if(2>b.length)return r.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new vk,{api:4,method:9,paragraphContent:b,context:h});this.FQ.postMessage(h);return!0}pQk(b){if(1>b.length)return r.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new vk,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.FQ.postMessage(b);return!0}qQk(b){if(1>b.length)return r.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new vk,{api:4,method:13,textPredictionConfig:this.F7h(b)});this.FQ.postMessage(b);return!0}rQk(b){if(1>
b.length)return r.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Cb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new vk,{api:4,method:14,textPredictionConfig:this.F7h(b)});this.FQ.postMessage(b);return!0}getConfig(b=null){return Object.assign(new Nj,{scriptDirectory:v.AFrameworkApplication.R5+"/intelligence/",settings:Object.assign(new Ro,{extendedRankLimit:0}),modelFilesUrl:b})}F7h(b=
null){return Object.assign(new Nj,{scriptDirectory:v.AFrameworkApplication.R5+"/intelligence/",settings:Object.assign(new Ro,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(m.a)(FC,"LocalInferenceWorkerApiMain",np,[]);class bC extends np{constructor(b){super(b);v.AFrameworkApplication.lI(()=>{this.NLb()})}callMethod(b){r.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}U3d(b){r.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}NLb(){const b=Object.assign(new Ne.a,{api:3,method:6});this.FQ.postMessage(b)}}Object(m.a)(bC,"ShutdownWorkerApiMain",np,[]);class xy{constructor(b){this.container=b}w7k(b,h){let u=null;switch(h){case 0:u=new rm(b);break;case 2:u=new Nl(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:u=new bC(b);break;case 4:u=new FC(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:r.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return u}}Object(m.a)(xy,"WordWebWorkerApiFactory",null,[294]);var GC=c(322);class jz{constructor(b,h){this.name=b;this.format=h}}Object(m.a)(jz,"ImportedScript",null,[]);class aA{constructor(){this.Rje=this.YQb=this.Yfj=null}}Object(m.a)(aA,"WebWorkerConfig",null,[]);var WF=c(1456);class xv{constructor(b){this.Kgh=[];this.U6j=b;if(v.AFrameworkApplication.K){b=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
v.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const u=v.AFrameworkApplication.K.kb("ContentBaseUrl")?6:5;var h=v.AFrameworkApplication.K.kb("AppScriptBaseName");const B=b?"":".";if(h){const Q=b?"":"{0}";h+=`${B}${Q}worker.js`;this.Kgh.push(new jz(`MicrosoftAjax${b?"":"DS"}.${Q}js`,u),new jz(h,u))}else r.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else r.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new aA,{Yfj:"workerboot",YQb:this.Kgh,Rje:[0,2,3,4]});this.U6j&&this.vJm()&&h.YQb.push(new jz("intelligence/edge-inference-web.js",5));b.push(h);return b}vJm(){return(new GC.a("arrowFunction",()=>{try{Object(WF.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(m.a)(xv,"WordWebWorkerConfigFactory",null,[291]);class zD{constructor(){this.Ga=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ga.appSettings,v.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}wc(b){this.W=b;this.Ga=this.W.resolve("Common.IAppSettingsManager");const h=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new Nm(new xv(h),new xy(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){M.a.instance.Gc(new zD)}}Object(m.a)(zD,"WordEditorWorkersPackage",null,[1,2]);var XF=c(1183);class AD{constructor(){this.Aud=
[]}Iei(b,h){let u=-1,B=null;B=Q=>{Q?h(this.Aud[u]):(++u,u<this.Aud.length?this.Aud[u].I3b(b,B):h(null))};B(!1)}I3b(b,h){this.Iei(b,u=>{h(!!u)})}ajc(b,h,u){this.Iei(b,B=>{if(!B)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");B.ajc(b,h,u)})}aoh(b){this.Aud.push(b)}}Object(m.a)(AD,"CompositeExternalContentURLResolver",null,[543,228]);var BD=c(1451);class hD extends BD.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(m.a)(hD,"ExternalContentEmbedResponse",BD.a,[]);var CD=c(1466),kE=c(1858),bA=c(1857),cA=c(1370),Sn=c(717),cC=c(501),eB=c(164),DD=c(868),yy;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.Mfp=3]="externalContentFloatieConversion"})(yy||(yy={}));Object(m.b)("ExternalContentConversionContext",yy);class jh{constructor(){this.dKb=this.cKb=null;
this.Iif=new cA.ExternalContentEmbedRetriever;this.yCc=!0;this.uuc=this.so=this.doi=this.coi=this.Sl=this.Ip=null;this.picturePasteRequestSucceeded=()=>{r.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.vhc=()=>{r.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=jh.Yna&&jh.Yna.z6h()}get iQb(){return this.yCc}set iQb(b){this.yCc=b}u5e(b,h){let u=!1;if(b){switch(b.contextId){case vc.a.Tc:u=!h;break;case vc.a.Jd:u=
!0}u&&!DD.a(b.node)&&(u=!1)}return u}cVm(b){const h=b.startsWith(ok.a.Vhc),u=b.startsWith(ok.a.W3c),B=b.startsWith(ok.a.hae);return(h||u||B)&&ok.a.y4a(b)}B5i(){this.so=W.a.create();jh.pf.KCb(this.so,4);jh.pf.s5(this.so,0,jh.pf.qo());this.bIb(this.cKb,3,this.dKb,!0)}tQa(b,h,u){this.so=W.a.create();jh.pf.KCb(this.so,u?0:2);jh.pf.s5(this.so,0,jh.pf.qo());this.uuc();this.bIb(b,u?0:2,h)}F9d(b,h){this.so=W.a.create();jh.pf.KCb(this.so,1);jh.pf.s5(this.so,0,jh.pf.qo());this.bIb(b,1,h)}bXd(b,h,u,B){if(!b||
!b.isConnected||!Dd.ImageReader.Jt(b))return null;const Q=new Sn.a;Q.setValue(xh.a.vac,u);Q.setValue(xh.a.nQa,h);Q.d0a=this.coi;Q.Xw=this.doi;Q.providerName=B;Q.A4a=1===u;vd.GraphIterator.eb(b).xf(Q,2);this.m_c(Q);return Q}v7i(b){this.uuc=b}Rqe(b,h){const u=jh.B1.l6b(h)||0;h=jh.B1.K0a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=u,b.Height=u/B):(b.Height=h,b.Width=h/B)}Hsg(b,h,u){if(null!=b&&null!=h&&!F.a.Xe(u)){var B=jh.L0c.M9b(u);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.ora=!1:B.ora=!0;B.hideFloatie=!0;this.Rqe(b,h.node);this.Zac(b,h,!1,!1,B,u)}}Xib(b){return b?b.Qe:0}Mpg(b,h,u){let B=null;const Q=b.node;if(!me.ParagraphReader.Wb(Q)||!Q.isConnected)return{returnValue:!1,Qra:B};if(u)return{returnValue:!0,Qra:b};u=b.cpBegin;const ca=b.cpEnd,qa=me.ParagraphReader.text(Q);if(0<=u&&ca<=qa.length&&qa.substring(u,ca)===h)return{returnValue:!0,Qra:b};const Qa=qa.indexOf(h);return 0<=Qa?(B=Je.a.createTextRange(Q,Qa,Qa+h.length),{returnValue:!0,Qra:B}):0<=u&&ca<=qa.length&&
this.Z$b(b)?{returnValue:!0,Qra:b}:{returnValue:!1,Qra:B}}Z$b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Je.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ok.a.EA(h,!1);if(1===h.length){h=h[0];const u=me.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==u)return!0}return!1}BHf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}E8a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&
window.setTimeout(()=>{const u=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");u&&u.execute(B=>{B.logActivity(b,h)})},jh.fEa)}hpf(b,h){const u=!F.a.e8(h);switch(b){case 1:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}bIb(b,
h,u,B=!1){if(this.cVm(u)){var Q=jh.L0c.M9b(u);if(Q)if(this.BHf(Q)){r.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Na.a)(Je.a,b);var ca=!h;this.u5e(b,ca)?this.LVc(u)?(h=1===h,B=this.LWl(b),Q.hideFloatie=!0,this.Zac(B,b,ca,h,Q,u)):this.O0f(b,h,Q,u,B):jh.pf.fR(this.so,2,"URL inserted in Non-Embedable context",jh.pf.qo())}else r.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),jh.pf.fR(this.so,2,"Size provided is not valid for OEmbed",
jh.pf.qo())}else r.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),jh.pf.fR(this.so,2,"URL inserted is not valid for ExternalContent",jh.pf.qo())}LWl(b){const h=new hD;h.Width=jh.B1.l6b(b.node)||0;h.Height=jh.B1.K0a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}LVc(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=jh.D9&&jh.D9.GBi(b)}O0f(b,h,u,B,Q){const ca=
!h,qa=1===h,Qa=jh.B1.l6b(b.node)||0,rb=jh.B1.K0a(b.node)||0,Lb=CD.a.Z8e(u.fpg,!0,Qa,rb);this.MZc(b,B,h,!0);this.Iif.KBh(Lb,Yb=>{jh.pf.s5(this.so,4,jh.pf.qo());jh.pf.C8c(this.so,this.Xib(Yb.data));if(Yb=this.U0f(Yb)){r.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var gc=eB.q(Yb.MediaType);jh.pf.Zbe(this.so,7,gc);gc=b;({Qra:gc}=this.Mpg(b,B,qa)).returnValue?(this.MZc(gc,B,h,!1),null==u.width?0<Qa&&Yb.Width>Qa&&(r.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Yb.Width=Qa):(r.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Yb.Width=this.hdd(u.width,Yb.Width,Qa)),null==u.height?0<rb&&Yb.Height>rb&&(r.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Yb.Height=rb):(r.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Yb.Height=this.hdd(u.height,Yb.Height,rb)),jh.Yna.E$a||Q?this.Zac(Yb,gc,ca,qa,u,B):(this.cKb=b,this.dKb=B,this.KJc(B))):(r.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),jh.pf.fR(this.so,2,"No conversion as the context is no longer valid for the external content conversion",jh.pf.qo()));qa&&this.Q_a(gc.node)}else qa&&this.Q_a(b.node),jh.pf.fR(this.so,1,"URL not oEmbedable",jh.pf.qo())},Yb=>{jh.pf.s5(this.so,
4,jh.pf.qo());jh.pf.C8c(this.so,this.Xib(Yb.data));qa&&this.Q_a(b.node);r.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Yb.data.se);jh.pf.fR(this.so,2,"ExternalContentEmbedRequest failed",jh.pf.qo())},Yb=>{qa&&this.Q_a(b.node);r.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Yb)},this.so)}hdd(b,h,u){!b&&0<u&&h>u||b>u?(r.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=u):b>u?h=u:b&&b<u&&(h=b);return h}Zac(b,h,u,B,Q,ca){this.Sl=yb.a.create();b.Width=b.Width/b.Height*(b.Height-(cC.a.DSc+cC.a.Q3))+2*cC.a.Q3;const qa=new Qg.GraphTransaction(15);qa.Db(h.node);qa.Qj=Qc.a.tQa;const Qa=this.Z$b(h);null!=Q.ora&&!Q.ora||B||Qa||(b.Title=""===Q.title||Q.title?Q.title:b.Title,!b.Title&&""!==b.Title)||(h=this.iBf(h,qa,b.Title,ca,u));if(h){B&&(h=this.cdf(h));var rb=this.nId(h,B);if(rb){u=eB.q(b.MediaType);var Lb=this.$Sd(b,u);this.coi=b.IFrameHtml;this.doi=b.Title;if(rb=this.QAf(rb,
Lb,qa,B,ca,u,b.ProviderName))qa.HGa(this.Sl,1),qa.dispose(),this.cKb=h,this.dKb=ca,this.CYf(Q,b,rb),this.C0f(ca,B||Q.hideFloatie,Qa,u,b.Title)}else qa.dispose(),r.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),jh.pf.fR(this.so,2,"Could not create IP context on splitting the paragraph",jh.pf.qo())}else jh.pf.fR(this.so,2,"GraphNodeContext is null",jh.pf.qo())}$Sd(b,h){const u=new Od.DictionaryPropertySet;jh.nP.z$d(u,b.Width,
b.Height);b=this.gpf(h,b.Title);u.setValue(Xe.a.imageAltText,b);u.setValue(Jc.a.yU,qe.a.zF());u.setValue(Jc.a.imageType,0);return u}QAf(b,h,u,B,Q,ca,qa){if(!b)return null;b=jh.nP.gXd(b,h);if(!b)return u.dispose(),r.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),jh.pf.fR(this.so,2,"The anchored image could not be inserted",jh.pf.qo()),null;u=b.node;Q=this.bXd(u,Q,ca,qa);jh.pf.iog(this.so,Q.id);B||this.Tbg(u);return u}CYf(b,h,u){F.a.e8(b.thumbnailUrl)||
(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(jh.pf.s5(this.so,8,jh.pf.qo()),r.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.FKd(u,h.Thumbnail))}C0f(b,h,u,B,Q){h||this.KJc(b);this.E8a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.E8d("IsHyperlinkWithNonURLDisplayText",u);this.ariaNotify(B,Q);jh.pf.s5(this.so,5,jh.pf.qo())}E8d(b,h){r.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");
ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ha.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.iQb&&jh.Tw&&(b=this.hpf(b,h),jh.Tw.sendNotification(b,!0))}iBf(b,h,u,B,Q){if(Q){if((Q=ok.a.EA(b,!1))&&1!==Q.length)return h.dispose(),r.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;jh.Sp.fS(Q[0].paragraph,Q[0].hyperlink)}return this.d8f(b,
u,B)}cdf(b){const h=b.node,u=me.ParagraphReader.text(h);return 0<u.length&&!u.trim().length?(b=Je.a.createTextRange(h,0,u.length),jh.ig.Ge(b,""),Je.a.Oc(h,0)):b}nId(b,h){return h?b:this.bqf(b)}bqf(b){const h=me.ParagraphReader.text(b.node),u=vd.GraphIterator.eb(b.node);if(u.rd()){b=Je.a.Oc(b.node,b.cpEnd);gf.OutlineElementNavigator.Wd(u);const B=jh.Yf.Zoa(u);jh.mh.G$(u,B,b,!0,!0,!0,!0);""!=h&&jh.mh.Iz(u,!1,!0);u.Qd();return Je.a.Oc(u.currentNode,0)}return null}U0f(b){if(!({group:b}=If.a.S1(b.data.se)).returnValue)return null;
b=b.Responses[0];return b.StatusCode?null:b}d8f(b,h,u){const B=b.cpBegin+h.length;jh.ig.Ge(b,h);b=Je.a.createTextRange(b.node,b.cpBegin,B);jh.Sp.qG(b,u,!1);return b}gpf(b,h){const u=!F.a.e8(h);switch(b){case 1:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}FKd(b,h){b.Ui().contentReplicator.forceOutbound(()=>{this.S0f(h,b)},()=>{r.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}m_c(b){b=vd.GraphIterator.eb(b);b.zb(12);b.ld(12);b.Cn.UQ=!0}Q_a(b){b.qhc=null}Tbg(b){b=vd.GraphIterator.eb(b);b.zb(11)&&(b.ld(11),b.rd()&&b.Kj()&&b.Qd()&&me.ParagraphReader.Wb(b.currentNode)&&(b=Cg.SelectionFactory.ne(b.currentNode,
0),xf.a.instance.Bc(b)))}MZc(b,h,u,B){const Q=b.cpBegin,ca=b.cpEnd;b=me.ParagraphReader.text(b.node).trim();Q||b!==h&&""!==b?Q?ca===b.length?r.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yy[u],B):0<Q&&ca<b.length&&r.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
yy[u],B):r.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yy[u],B):r.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yy[u],B)}KJc(b){this.t6b();const h=new fx.a(1,v.AFrameworkApplication.isRtl);h.R2c=b;jh.uhb.W4c(h)}t6b(){const b=
new ex.a(!0);jh.Y9.IHa(b)}S0f(b,h){if(b=this.esf(b,h))h=Array(1),h[0]=b,b=kE.a.construct(h,!1,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ip.vr:null),h=this.dbf(),this.fpb(h,b)}esf(b,h){if(!h)return r.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Ip=h.Ui();(new vd.GraphIterator).set(h);if(!h.anchor||!h.anchor.Pp||!h.anchor.Pp.hs)return r.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var u=h.anchor.Pp.hs.node;if(!u)return r.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;u=u.ja(Sh.a.MJ,gk.a.Nt);const B=h.getValue(Xe.a.XK),Q=kf.a.jf(Dd.ImageReader.WC(h.properties),0),ca=kf.a.jf(Dd.ImageReader.NH(h.properties),1);return bA.a.construct(h.id.toString(),b,h.ja(Xe.a.imageAltText,""),Q,ca,h.ja(Jc.a.kY,""),u,h.ja(Jc.a.yU,0),h.ja(Jc.a.fia,!1),h.ja(Sh.a.Wga,-1),h.ja(Jc.a.amb,Box4Intl.Box4Strings.l_Picture),h.ja(Xe.a.yxa,
!1),B,h.ja(Jc.a.runId,1),h.ja(Jc.a.Wc,0))}fpb(b,h){v.AFrameworkApplication.He.sj(b,2,G.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.vhc,null,void 0,void 0,void 0,void 0,"26");r.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}dbf(){let b=fa.a.w8b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=fa.a.Rn(b,fj.a.fileId,this.Ip.vr));b=fa.a.Rn(b,fj.a.cellId,this.Ip.Am.toString());this.Sl||
(this.Sl=yb.a.create(),r.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=fa.a.Rn(b,fj.a.yX,this.Sl.toString());b=fa.a.Rn(b,fj.a.classId,(393233).toString());this.Ip.KH&&(b=fa.a.Rn(b,fj.a.KH,this.Ip.KH));b=fa.a.Rn(b,fj.a.Grb,"1");b=fa.a.Rn(b,fh.a.imageType,"0");b=ui.a.instance.CZe(b);this.Ip.contentReplicator&&this.Ip.contentReplicator.JJb&&(b=fa.a.Rn(b,fj.a.k3e,"1"));b=fa.a.Rn(b,fj.a.Nua,this.Ip.contentReplicator.Lt.toString());b=fa.a.Rn(b,fj.a.ohc,
"0");return b=fa.a.Rn(b,fj.a.JSb,"1")}static get uhb(){return null!=jh.dxg?jh.dxg:jh.dxg=Ga.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Yna(){jh.eBa||(jh.eBa=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return jh.eBa}static get Y9(){return null!=jh.uEg?jh.uEg:jh.uEg=Ga.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Tw(){return null!=jh.Pug?jh.Pug:jh.Pug=Ga.a.instance.resolve("Common.Utils.IAriaNotifier")}static get B1(){return null!=
jh.vFg?jh.vFg:jh.vFg=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get nP(){return null!=jh.Pzg?jh.Pzg:jh.Pzg=Ga.a.instance.resolve("WordEditor.IImageEditor")}static get Yf(){return jh.mh||(jh.mh=Ga.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Sp(){return null!=jh.Hzg?jh.Hzg:jh.Hzg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get ig(){return null!=jh.zvg?jh.zvg:jh.zvg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get pf(){return null!=
jh.mxg?jh.mxg:jh.mxg=Ga.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get L0c(){return null!=jh.gDg?jh.gDg:jh.gDg=Ga.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get D9(){return null!=jh.$Cg?jh.$Cg:jh.$Cg=Ga.a.instance.resolve("Fluid.Host.LoopComponentManager")}}jh.mh=null;jh.fEa=5E3;jh.eBa=null;Object(m.a)(jh,"ExternalContentEditor",null,[212]);var HC=c(262),WE=c(1220);class XE{constructor(b,h){this.E$a=!0;this.K5a=u=>{if(null!=u.result)return u.result.Value;
r.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.E$a};this.dHa=u=>{u.Eo||u.Ei?r.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.Ayh(u.result),r.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.E$a};this.Ev=b;this.IK=h}z6h(){const b=
new Jd.a;this.KAi()&&this.IK?this.IK.D6a(HC.a.jJc).CWRCo(this.K5a,0).CWRCo(this.dHa,8):b.Ag(this.E$a)}Y1(b){this.IK&&this.IK.Y1(HC.a.jJc,new WE.a(HC.a.jJc,b))}J8n(b){this.KAi()&&(this.Ev.Rja("saveConvertExternalContentIsEnabled",b.toString()),r.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.Ayh(b),this.Y1(b))}KAi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)r.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}Ayh(b){this.E$a=b}}Object(m.a)(XE,"ExternalContentSettingInfo",null,[546]);var YE=c(1154);class Au{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(m.a)(Au,"FluidComponentProperties",null,[]);class ZE{constructor(){this.loopType=this.Xw=this.d0a=this.url=null;this.mediaType=0;this.gKi=null}}Object(m.a)(ZE,"IFrameProps",null,[]);class Al{static get B1(){return null!=
Al.tFg?Al.tFg:Al.tFg=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get nP(){return Al.Rj||(Al.Rj=Ga.a.instance.resolve("WordEditor.IImageEditor"))}static get Tw(){return null!=Al.Oug?Al.Oug:Al.Oug=Ga.a.instance.resolve("Common.Utils.IAriaNotifier")}static get Sp(){return null!=Al.Bzg?Al.Bzg:Al.Bzg=Ga.a.instance.resolve("Box4.IHyperlinkEditor")}static get Yf(){return null!=Al.ADg?Al.ADg:Al.ADg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}static get ig(){return null!=
Al.xvg?Al.xvg:Al.xvg=Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static y4a(b){const h=b.startsWith(ok.a.Vhc),u=b.startsWith(ok.a.W3c),B=b.startsWith(ok.a.hae);return(h||u||B)&&ok.a.y4a(b)}static u5e(b,h){let u=!1;if(b){switch(b.contextId){case vc.a.Tc:u=!h;break;case vc.a.Jd:u=!0}u&&!DD.a(b.node)&&(u=!1)}return u}static Z$b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Je.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ok.a.EA(h,!1);if(1===h.length){h=h[0];const u=me.ParagraphReader.text(b.node).substring(h.cpBegin,
h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==u)return!0}return!1}static gpf(b,h){const u=!F.a.e8(h);switch(b){case 1:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static m_c(b){b=
vd.GraphIterator.eb(b);b.zb(12);b.ld(12);b.Cn.UQ=!0}static $Sd(b,h,u,B){const Q=new Od.DictionaryPropertySet;Al.nP.z$d(Q,h,b);b=Al.gpf(B,u);Q.setValue(Xe.a.imageAltText,b);Q.setValue(Jc.a.yU,qe.a.zF());Q.setValue(Jc.a.imageType,0);return Q}static bXd(b,h,u){if(!b||!b.isConnected||!Dd.ImageReader.Jt(b))return null;const B=new Sn.a;B.setValue(xh.a.vac,h.mediaType);B.setValue(xh.a.nQa,h.url);B.setValue($c.a.loopComponentType,h.loopType);B.d0a=h.d0a;B.Xw=h.Xw;B.providerName=u;B.A4a=1===h.mediaType;B.createMode=
h.gKi;vd.GraphIterator.eb(b).xf(B,2);Al.m_c(B);return B}static nId(b,h){return h?b:Al.bqf(b)}static bqf(b){const h=me.ParagraphReader.text(b.node),u=vd.GraphIterator.eb(b.node);if(u.rd()){b=Je.a.Oc(b.node,b.cpEnd);gf.OutlineElementNavigator.Wd(u);const B=Al.Yf.Zoa(u);Al.Yf.G$(u,B,b,!0,!0,!0,!0);""!=h&&Al.Yf.Iz(u,!1,!0);u.Qd();return Je.a.Oc(u.currentNode,0)}return null}static Tbg(b){b=vd.GraphIterator.eb(b);b.zb(11)&&(b.ld(11),b.rd()&&b.Kj()&&b.Qd()&&me.ParagraphReader.Wb(b.currentNode)&&(b=Cg.SelectionFactory.ne(b.currentNode,
0),xf.a.instance.Bc(b)))}static hpf(b,h){const u=!F.a.e8(h);switch(b){case 1:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,
h){Al.Tw&&(b=Al.hpf(b,h),Al.Tw.sendNotification(b,!0))}static E8d(b,h,u){r.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:u,dataFields:[Object.assign(new ha.a,{name:b,bool:h})]}))}}Object(m.a)(Al,"ExternalContentHelper",null,[]);var qr=c(739);class Jr{constructor(){this.Sl=this.Ip=null}FKd(b,h,u){b.Ui().contentReplicator.forceOutbound(()=>{this.S0f(h,b,u)},()=>{r.ULS.sendTraceTag(592996173,324,
15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}S0f(b,h,u){if(b=this.esf(b,h))h=Array(1),h[0]=b,u=kE.a.construct(h,u,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ip.vr:null),b=this.dbf(),this.fpb(b,u)}esf(b,h){if(!h)return r.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Ip=h.Ui();(new vd.GraphIterator).set(h);if(!h.anchor||!h.anchor.Pp||!h.anchor.Pp.hs)return r.ULS.sendTraceTag(592996171,
324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var u=h.anchor.Pp.hs.node;if(!u)return r.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;u=u.ja(Sh.a.MJ,gk.a.Nt);const B=h.getValue(Xe.a.XK),Q=kf.a.jf(Dd.ImageReader.WC(h.properties),0),ca=kf.a.jf(Dd.ImageReader.NH(h.properties),1);return bA.a.construct(h.id.toString(),b,h.ja(Xe.a.imageAltText,""),Q,ca,h.ja(Jc.a.kY,""),u,h.ja(Jc.a.yU,
0),h.ja(Jc.a.fia,!1),h.ja(Sh.a.Wga,-1),h.ja(Jc.a.amb,Box4Intl.Box4Strings.l_Picture),h.ja(Xe.a.yxa,!1),B,h.ja(Jc.a.runId,1),h.ja(Jc.a.Wc,0))}fpb(b,h){v.AFrameworkApplication.He.sj(b,2,G.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.vhc.bind(this),null,void 0,void 0,void 0,void 0,"26");r.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){r.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}vhc(){r.ULS.sendTraceTag(592996168,
324,10,"Picture paste request for External Content failed.")}dbf(){let b=fa.a.w8b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=fa.a.Rn(b,fj.a.fileId,this.Ip.vr));b=fa.a.Rn(b,fj.a.cellId,this.Ip.Am.toString());this.Sl||(this.Sl=yb.a.create(),r.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=fa.a.Rn(b,fj.a.yX,this.Sl.toString());b=fa.a.Rn(b,fj.a.classId,(393233).toString());
this.Ip.KH&&(b=fa.a.Rn(b,fj.a.KH,this.Ip.KH));b=fa.a.Rn(b,fj.a.Grb,"1");b=fa.a.Rn(b,fh.a.imageType,"0");b=ui.a.instance.CZe(b);this.Ip.contentReplicator&&this.Ip.contentReplicator.JJb&&(b=fa.a.Rn(b,fj.a.k3e,"1"));b=fa.a.Rn(b,fj.a.Nua,this.Ip.contentReplicator.Lt.toString());b=fa.a.Rn(b,fj.a.ohc,"0");return b=fa.a.Rn(b,fj.a.JSb,"1")}}Object(m.a)(Jr,"ExternalContentThumbnailHelper",null,[]);class St extends Jr{constructor(){super(...arguments);this.so=null}static get pf(){return null!=St.lxg?St.lxg:
St.lxg=Ga.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}fIj(b,h,u){return Al.y4a(h)?Al.u5e(b,u)?!0:(St.pf.fR(this.so,2,"URL inserted in Non-Embedable context",St.pf.qo()),!1):(r.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),St.pf.fR(this.so,2,"URL inserted is not valid for ExternalContent",St.pf.qo()),!1)}}Object(m.a)(St,"AbstractExternalContentEditor",Jr,[212]);var $v=c(1181),Dp=c(1184);class Tt extends St{constructor(b){super();
Tt.LXa=b;this.eLf()}eLf(){this.vpg&&Dp.a.eLf(Tt.LXa.f7h())}static get il(){return null!=Tt.ZDg?Tt.ZDg:Tt.ZDg=Ga.a.instance.resolve("Box4.IParagraphEditor")}y9k(b,h){h=this.Kai(b,h);this.cri(h,b,5)}tQa(b,h,u){if(this.fIj(b,h,u)){var B=this.Kai(b,null);B.url=h;this.cri(B,b,u?0:2)}}F9d(b,h){this.tQa(b,h,!1)}cri(b,h,u){this.Sl=yb.a.create();const B=new Qg.GraphTransaction(15);B.Db(h.node);B.Qj=Qc.a.jBm;const Q=Al.Z$b(h),ca=eB.q(b.mediaType),qa=Al.$Sd(b.height,b.width,b.title,ca);h=this.STo(h,1==u);(h=
Al.Rj.gXd(h,qa))?(h=h.node,Al.bXd(h,{url:b.url,mediaType:ca,Xw:b.title,loopType:b.type,gKi:u},void 0)||r.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),B.HGa(this.Sl,1),B.dispose(),this.FKd(h,b.thumbnail,!1),this.UCn(Q,ca,b.type)):r.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}STo(b,h){Al.ig.Ge(b,"");return Al.nId(b,h)}UCn(b,h,u){Al.E8d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");
Al.ariaNotify(h,this.pMl(u))}pMl(b){switch(b){case qr.a.CheckList:return"Checklist Component";case qr.a.TaskAssignment:return"Task List Component";case qr.a.Poll:return"Poll Component";default:return"Fluid Component"}}Kai(b,h){const u=new Au;u.width=Al.B1.l6b(b.node)||0;eB.j()?u.height=null!=Tt.LXa&&Tt.LXa.d7h(h)||Al.B1.K0a(b.node)||0:u.height=null!=Tt.LXa&&Tt.LXa.d7h(h)+2*cC.a.Q3||Al.B1.K0a(b.node)||0;u.title="Fluid Component";u.mediaType="fluid";u.type=h;u.thumbnail=this.MWl();u.url=null!=Tt.LXa&&
"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return u}MWl(){return Tt.LXa.f7h()}get vpg(){return null!=this.QHg?this.QHg:this.QHg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static LVc(b){v.AFrameworkApplication.le("2cejb611;b0jjh576");return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=
Tt.LXa&&Tt.LXa.GBi(b)&&$v.a.oVk(b)}}Object(m.a)(Tt,"FluidComponentEditor",St,[]);class $E{get cyl(){return null!=this.cxg?this.cxg:this.cxg=Ga.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get aOd(){return null!=this.uyg?this.uyg:this.uyg=Ga.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}OCn(b,h){b&&(Tt.LVc(h)?this.aOd.tQa(b,h,!0):this.cyl.tQa(b,h,!0))}}Object(m.a)($E,"PostHyperlinkAutoCorrectStrategy",null,[544]);class IC{I3b(b,h){h(IC.ZCn.test(b))}ajc(b,
h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new hD,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:IC.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}IC.ZCn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$",
"i");IC.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(m.a)(IC,"PowerBIURLResolver",null,[543,228]);class JC{constructor(b){this.tjh=b}I3b(b,h){let u=!1;try{if(JC.fTm(b)){const B=this.tjh.M9b(b);u=null!=B.width&&null!=B.height&&!!B.thumbnailUrl&&!!B.title&&null!=B.ora}}catch(B){}h(u)}ajc(b,h){var u=this.tjh.M9b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
u.width,u.height,b);u=Object.assign(new hD,{Height:u.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:u.thumbnailUrl,Title:u.title,Width:u.width});h(u)}static fTm(b){for(const h of JC.$Co)if(b.startsWith(h))return!0;return!1}static n8(){return new JC(Ga.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}JC.$Co=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(m.a)(JC,"WedgeComponentExperimentsURLResolver",null,[543,
228]);var aF=c(882);let lE=!1;class $u{static Pqj(b){$u.iyi||$u.addEventListener();const h=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(u=>{u.logActivity(b,null)})}static addEventListener(){window.addEventListener($u.HDo,$u.GDo,!0);$u.iyi=!0}static OXk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();lE=!0}}$u.QFo="LoopsTeachingCalloutOnInsertTabActivity";$u.u6m="LoopHomeTabFlightActivity";$u.HDo="switchToInsertTabAndClickLoopButtonEvent";
$u.iyi=!1;$u.GDo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const u=null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.lc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new bf.a(0,1,u,()=>{$u.OXk()});null===(h=v.AFrameworkApplication.oc)||void 0===h?void 0:h.Xb(b)};Object(m.a)($u,"FluidComponentsTUIHelper",null,[]);class fB{constructor(b,h,u){this.ga=b;this.y1j=h;this.Ik=u;this.t0g=!1;this.N4g=1E3;this.O4g=15E3;this.$Re=this.RRe=!0;this.$Re=!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.N4g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.O4g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Tb(){this.ga.fb(Qc.a.iri,vc.a.Tc,this.GBm.bind(this),1028);this.ga.fb(Qc.a.k$d,vc.a.Tc,
this.k$d.bind(this),1028);this.ga.fb(Qc.a.uUc,vc.a.Tc,this.UAf.bind(this),1028);this.ga.fb(Qc.a.hUc,vc.a.Tc,this.UAf.bind(this),1028);this.ga.fb(Qc.a.kXd,vc.a.Tc,this.UAf.bind(this),1028);this.ga.fb(Qc.a.iFi,vc.a.Tc,this.$Nj.bind(this),1028)}GBm(){return 32}k$d(b,h,u){if(2!==u)return 32;this.$Re&&(this.k$i(),this.qLo());return 32}UAf(b,h,u){var B,Q,ca;if(1===u){if(!this.gZd(b)||!aF.a.Nwi())return r.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(B=
v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&$u.Pqj($u.QFo);if(!h.Vk||!Ge.SelectionEditor.ef(h)||(null===(Q=this.Ik)||void 0===Q?0:Q.R_(h))||(null===(ca=this.Ik)||void 0===ca?0:ca.hia(h)))return 2;if(h&&h.node&&DD.a(h.node))return 32}else if(2===u)return this.y1j.y9k(h,fB.KWl(b)),this.k$i(),32;return 2}qLo(){if(null!=$a.a.instance.getItem("LoopComponentSurveyShowed")||lE)this.RRe=!1;if(this.RRe){let b=this.Jai();window.setTimeout(()=>
{b&&"hidden"!==b.visibility&&(this.t0g=!0)},this.N4g);this.Wek=window.setTimeout(()=>{const h=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");this.t0g&&h&&h.execute(u=>{(b=this.Jai())&&"hidden"===b.visibility&&!lE&&(r.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),u.AIa("WordLoopFeedbackSurvey",null),this.RRe=!1,$a.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.O4g)}}Jai(){var b,h;let u=null;try{const B=document.getElementById("Ribbon-LoopComponentDropdown");
B&&(u=Kn.a.zB(null===(h=null===(b=B.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(B){r.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=B?B.toString():""))}return u}k$i(){this.$Re&&window.clearTimeout(this.Wek)}gZd(b){return b===Qc.a.hUc||b===Qc.a.uUc?$v.a.gZd():!0}$Nj(b,h,u){2===u&&F.a.DR("https://go.microsoft.com/fwlink/?linkid=2194838")&&Fb.App.u$f.Knc("https://go.microsoft.com/fwlink/?linkid=2194838");
return 32}static KWl(b){switch(b){case Qc.a.uUc:return qr.a.TaskAssignment;case Qc.a.hUc:return qr.a.CheckList;case Qc.a.kXd:return qr.a.Poll;default:return null}}}Object(m.a)(fB,"FluidComponentsActor",null,[]);class pi extends St{constructor(){super();this.dKb=this.cKb=null;this.Iif=new cA.ExternalContentEmbedRetriever;this.uuc=null;null!=pi.Yna&&pi.Yna.z6h()}B5i(){this.so=W.a.create();pi.pf.KCb(this.so,4);pi.pf.s5(this.so,0,pi.pf.qo());this.bIb(this.cKb,3,this.dKb,!0)}tQa(b,h,u){this.so=W.a.create();
pi.pf.KCb(this.so,u?0:2);pi.pf.s5(this.so,0,pi.pf.qo());this.uuc();this.bIb(b,u?0:2,h)}F9d(b,h){this.so=W.a.create();pi.pf.KCb(this.so,1);pi.pf.s5(this.so,0,pi.pf.qo());this.bIb(b,1,h)}v7i(b){this.uuc=b}Rqe(b,h){const u=pi.B1.l6b(h)||0;h=pi.B1.K0a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=u,b.Height=u/B):(b.Height=h,b.Width=h/B)}Hsg(b,h,u){if(null!=b&&null!=h&&!F.a.Xe(u)){var B=pi.L0c.M9b(u);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.ora=!1:B.ora=!0;B.hideFloatie=!0;this.Rqe(b,h.node);this.Zac(b,h,!1,!1,B,u)}}Xib(b){return b?b.Qe:0}Mpg(b,h,u){let B=null;const Q=b.node;if(!me.ParagraphReader.Wb(Q)||!Q.isConnected)return{returnValue:!1,Qra:B};if(u)return{returnValue:!0,Qra:b};u=b.cpBegin;const ca=b.cpEnd,qa=me.ParagraphReader.text(Q);if(0<=u&&ca<=qa.length&&qa.substring(u,ca)===h)return{returnValue:!0,Qra:b};const Qa=qa.indexOf(h);return 0<=Qa?(B=Je.a.createTextRange(Q,Qa,Qa+h.length),{returnValue:!0,Qra:B}):0<=u&&ca<=qa.length&&
Al.Z$b(b)?{returnValue:!0,Qra:b}:{returnValue:!1,Qra:B}}BHf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}E8a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const u=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");u&&u.execute(B=>{B.logActivity(b,h)})},pi.fEa)}bIb(b,h,u,B=!1){if(this.fIj(b,u,!h)){var Q=pi.L0c.M9b(u);Q&&(this.BHf(Q)?(r.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),
this.O0f(b,h,Q,u,B)):(r.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),pi.pf.fR(this.so,2,"Size provided is not valid for OEmbed",pi.pf.qo())))}}O0f(b,h,u,B,Q){const ca=!h,qa=1===h,Qa=pi.B1.l6b(b.node)||0,rb=pi.B1.K0a(b.node)||0,Lb=CD.a.Z8e(u.fpg,!0,Qa,rb);this.MZc(b,B,h,!0);this.Iif.KBh(Lb,Yb=>{pi.pf.s5(this.so,4,pi.pf.qo());pi.pf.C8c(this.so,this.Xib(Yb.data));if(Yb=this.U0f(Yb)){r.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var gc=eB.q(Yb.MediaType);pi.pf.Zbe(this.so,7,gc);gc=b;({Qra:gc}=this.Mpg(b,B,qa)).returnValue?(this.MZc(gc,B,h,!1),null==u.width?0<Qa&&Yb.Width>Qa&&(r.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Yb.Width=Qa):(r.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Yb.Width=this.hdd(u.width,Yb.Width,Qa)),null==u.height?0<rb&&Yb.Height>rb&&(r.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Yb.Height=rb):(r.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Yb.Height=this.hdd(u.height,Yb.Height,rb)),pi.Yna.E$a||Q?this.Zac(Yb,gc,ca,qa,u,B):(this.cKb=b,this.dKb=B,this.KJc(B))):(r.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
pi.pf.fR(this.so,2,"No conversion as the context is no longer valid for the external content conversion",pi.pf.qo()));qa&&this.Q_a(gc.node)}else qa&&this.Q_a(b.node),pi.pf.fR(this.so,1,"URL not oEmbedable",pi.pf.qo())},Yb=>{pi.pf.s5(this.so,4,pi.pf.qo());pi.pf.C8c(this.so,this.Xib(Yb.data));qa&&this.Q_a(b.node);r.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Yb.data.se);pi.pf.fR(this.so,2,"ExternalContentEmbedRequest failed",pi.pf.qo())},Yb=>{qa&&this.Q_a(b.node);
r.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Yb)},this.so)}hdd(b,h,u){!b&&0<u&&h>u||b>u?(r.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=u):b>u?h=u:b&&b<u&&(h=b);return h}Zac(b,h,u,B,Q,ca){this.Sl=yb.a.create();b.Width=b.Width/b.Height*(b.Height-(cC.a.DSc+cC.a.Q3))+2*cC.a.Q3;const qa=new Qg.GraphTransaction(15);qa.Db(h.node);qa.Qj=Qc.a.tQa;const Qa=Al.Z$b(h);null!=Q.ora&&!Q.ora||
B||Qa||(b.Title=""===Q.title||Q.title?Q.title:b.Title,!b.Title&&""!==b.Title)||(h=this.iBf(h,qa,b.Title,ca,u));if(h){B&&(h=this.cdf(h));var rb=Al.nId(h,B);if(rb){u=eB.q(b.MediaType);var Lb=Al.$Sd(b.Height,b.Width,b.Title,u);(rb=this.QAf(rb,Lb,B,{url:ca,d0a:b.IFrameHtml,Xw:b.Title,mediaType:u},b.ProviderName))?(qa.HGa(this.Sl,1),qa.dispose(),this.cKb=h,this.dKb=ca,this.CYf(Q,b,rb),this.C0f(ca,B||Q.hideFloatie,Qa,u,b.Title)):qa.dispose()}else qa.dispose(),r.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
pi.pf.fR(this.so,2,"Could not create IP context on splitting the paragraph",pi.pf.qo())}else pi.pf.fR(this.so,2,"GraphNodeContext is null",pi.pf.qo())}QAf(b,h,u,B,Q){if(!b)return null;b=pi.nP.gXd(b,h);if(!b)return r.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),pi.pf.fR(this.so,2,"The anchored image could not be inserted",pi.pf.qo()),null;b=b.node;B=Al.bXd(b,B,Q);pi.pf.iog(this.so,B.id);u||Al.Tbg(b);return b}CYf(b,h,u){F.a.e8(b.thumbnailUrl)||
(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(pi.pf.s5(this.so,8,pi.pf.qo()),r.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.FKd(u,h.Thumbnail,!1))}C0f(b,h,u,B,Q){h||this.KJc(b);this.E8a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Al.E8d("IsHyperlinkWithNonURLDisplayText",u,"Office.Word.Online.ExternalContent.OEmbedInsertions");Al.ariaNotify(B,Q);pi.pf.s5(this.so,5,pi.pf.qo())}iBf(b,h,u,
B,Q){if(Q){if((Q=ok.a.EA(b,!1))&&1!==Q.length)return h.dispose(),r.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Al.Sp.fS(Q[0].paragraph,Q[0].hyperlink)}return this.d8f(b,u,B)}cdf(b){const h=b.node,u=me.ParagraphReader.text(h);return 0<u.length&&!u.trim().length?(b=Je.a.createTextRange(h,0,u.length),Al.ig.Ge(b,""),Je.a.Oc(h,0)):b}U0f(b){if(!({group:b}=If.a.S1(b.data.se)).returnValue)return null;b=b.Responses[0];
return b.StatusCode?null:b}d8f(b,h,u){const B=b.cpBegin+h.length;Al.ig.Ge(b,h);b=Je.a.createTextRange(b.node,b.cpBegin,B);Al.Sp.qG(b,u,!1);return b}Q_a(b){b.qhc=null}MZc(b,h,u,B){const Q=b.cpBegin,ca=b.cpEnd;b=me.ParagraphReader.text(b.node).trim();Q||b!==h&&""!==b?Q?ca===b.length?r.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yy[u],B):0<Q&&ca<b.length&&r.ULS.sendTraceTag(590958602,
324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yy[u],B):r.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",yy[u],B):r.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
yy[u],B)}KJc(b){this.t6b();const h=new fx.a(1,v.AFrameworkApplication.isRtl);h.R2c=b;pi.uhb.W4c(h)}t6b(){const b=new ex.a(!0);pi.Y9.IHa(b)}static get uhb(){return null!=pi.exg?pi.exg:pi.exg=Ga.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Yna(){pi.eBa||(pi.eBa=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return pi.eBa}static get Y9(){return null!=pi.vEg?pi.vEg:pi.vEg=Ga.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get B1(){return null!=
pi.uFg?pi.uFg:pi.uFg=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get nP(){return null!=pi.Ozg?pi.Ozg:pi.Ozg=Ga.a.instance.resolve("WordEditor.IImageEditor")}static get L0c(){return null!=pi.fDg?pi.fDg:pi.fDg=Ga.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}pi.fEa=5E3;pi.eBa=null;Object(m.a)(pi,"ExternalContentEditorV2",St,[]);class mE{constructor(){this.od=this.W=null}get name(){return"WordEditor.ExternalContent"}get Zb(){return this.od?
this.od:this.od=this.W.resolve("Box4.IFeatureHelper")}wc(b){var h;this.W=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new XF.a(Pk.a.instance,Wq.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new $E).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new XE(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new pi).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ia("WordEditor.ExternalContent.FluidComponentEditor",()=>new Tt(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ia("WordEditor.ExternalContent.FluidComponentsActor",
()=>new fB(v.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),ti.a.instance)).ha(),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&$u.Pqj($u.u6m)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new jh).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.Zb.lq.continueWith(()=>{this.sn()});v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Tb()}dispose(){}p9k(){const b=new AD;this.bVh()&&b.aoh(JC.n8());b.aoh(new IC);return b}sn(){null==v.AFrameworkApplication.K||v.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new YE.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();this.bVh()&&(this.W.ia("WordEditor.ExternalContent.IWordExternalContentURLResolver",
()=>this.p9k()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}bVh(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){M.a.instance.Gc(new mE)}}Object(m.a)(mE,"ExternalContentPackage",null,[1,2]);var gB;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";
b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.ucp=7]="bar";b[b.gSa=8]="num"})(gB||(gB={}));Object(m.b)("TabStopValues",gB);class Ep{}Ep.VOh=8;Ep.rhl=1;Ep.I8="wwaengidc";Ep.kpiName="WordRuler";Ep.precision=.0625;Ep.LEo=1;Ep.OZo="ShowHideRuler";Object(m.a)(Ep,"Constants",null,[]);var KC=c(763);class Hs{static f$b(b,h){if(!Hs.iXc)return null;switch(b){case "Left":return u=>{const B=u.rulerCanvasProps;u=u.indents;return{oKb:0,YOb:B.scale-(B.margins[1].value+
u[2].value+Math.max(u[0].value,u[1].value)+8*B.precision)}};case "Right":return u=>{const B=u.rulerCanvasProps;u=u.indents;return{oKb:0,YOb:B.scale-(u[2].value+(B.margins[0].value+Math.max(u[0].value,u[1].value))+8*B.precision)}};case "MoveTableColumn":return()=>{let u=0,B=0;if(0===h){var Q={};32===Hs.nc.Rb(Ob.a.hic,2,Q)&&(u=Of.a.Wz(Q.MinIndent),B=Of.a.Wz(Q.MaxIndent))}else Q={Bo:h-1},32===Hs.nc.Rb(Ob.a.gic,2,Q)&&(u=Of.a.Wz(Q.MinResize),B=Of.a.Wz(Q.MaxResize));return{oKb:u,YOb:B}};case "Top":return u=>
{u=u.rulerCanvasProps;return{oKb:0,YOb:u.scale-(u.margins[1].value+8*u.precision)}};case "Bottom":return u=>{u=u.rulerCanvasProps;return{oKb:0,YOb:u.scale-(u.margins[0].value+8*u.precision)}}}return null}static mTd(b){if(!Hs.iXc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var u=h.rulerCanvasProps,B=h.indents,Q=h.ipContextIndex;h=u.margins;var ca=u.scale;u=u.precision;if("MoveTableColumn"!==h[0].type){Q=h[0].value;h=h[1].value+B[2].value;var qa=Q;
"LeftIndent"===b&&(qa+=Math.max(B[0].value,B[1].value));B=-1*Q;u=ca-(qa+h+8*u)}else{ca=0;for(qa=0;qa<=Q;qa++)ca+=h[qa].value;qa=0;if("LeftIndent"===b){qa=B[0].value;const Qa=B[1].value;ca+=Math.max(qa,Qa);qa=Math.max(qa,Qa)}h=h[Q+1].value;qa+=B[2].value;B=-1*ca;u=h-qa-u}return{oKb:B,YOb:u}};case "RightIndent":return h=>{var u=h.rulerCanvasProps,B=h.indents,Q=h.ipContextIndex,ca=u.margins;h=u.scale;u=u.precision;if("MoveTableColumn"!==ca[0].type){var qa=ca[0].value;ca=ca[1].value;Q=B[0].value;var Qa=
B[1].value;B=-1*ca;h-=qa+ca+Math.max(Q,Qa)+8*u}else{qa=0;for(Qa=0;Qa<=Q;Qa++)qa+=ca[Qa].value;ca=ca[Q+1].value;Q=B[0].value;Qa=B[1].value;B=-1*(h-qa-ca);h=ca-Math.max(Q,Qa)-u}return{oKb:B,YOb:h}}}return null}static Aam(){return b=>{var h=b.rulerCanvasProps,u=b.indents,B=b.ipContextIndex,Q=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==Q[0].type?(B=Q[0].value,Q=Q[1].value+u[2].value,u=Math.min(u[0].value,u[1].value)+b,b=h-(B+Q+b)):(h=u[2].value,Q=Q[B+1].value,u=Math.min(u[0].value,u[1].value)+
b,b=Q-(h+b));return{oKb:u,YOb:b}}}static get nc(){return null!=Hs.Hug?Hs.Hug:Hs.Hug=v.AFrameworkApplication.va}static get iXc(){null==this.Ebb&&(v.AFrameworkApplication.zia("WoRul910;WoRul910cf"),this.Ebb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.Ebb}}Hs.Ebb=null;Object(m.a)(Hs,"RulerPropertyBoundaryHelper",null,[]);var bF=c(931),YF=c(1485),ED=c(1065),hB=c(1246),iB=c(1247);class ns{constructor(b,
h,u,B,Q,ca){this.Cvn="OutlineContainer";this.Qlk="UpdateCustomTabFailed";this.cyb="ReadRulerPropertiesFailed";this.Ulk="UpdateIndentFailed";this.ijh="UpdateMarginFailed";this.z7d=qa=>{qa.button===Sys.UI.MouseButton.rightButton&&this.nQe.show(new Sys.UI.Point(qa.clientX,qa.clientY),2)};this.VFj=()=>{this.cVa()};this.fn=b;this.SYb=h;this.ga=u;this.nQe=B;this.mz=Q;this.hT=ca;this.aWb=null;this.Mw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.qL;this.$Ui=this.k7d.bind(this);this.JXi=this.ht.bind(this);
this.UFj=this.cVa.bind(this)}cC(){this.nZe();this.goh();this.SYb.zl.Te(10).Mo(this.$Ui);Me.a.addHandler(this.VWe,Kd.a.scroll,this.VFj);this.fn.execute(h=>{h.XY(this.JXi)});const b=[this.Srf(),document.getElementById(Zj.AppFrame.sdd),document.getElementById("PageContentContainer")];this.aWb?this.aWb.register(b,this.UFj):ED.a(YF.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.aWb=h.createResizeObserver();this.aWb.register(b,this.UFj);return null})});Fb.App.za.VI.registerBoundingWindowRectsChanged("documentPanel",
(h,u)=>{"undefined"!==u&&this.V8a([1,0])})}Srf(){return 1===this.hT.mu?this.Mck:this.jck}get VWe(){return document.getElementById(Zj.AppFrame.qVa)}get jck(){const b=document.getElementsByClassName(this.Cvn);return b&&0<b.length?b[0]:null}get Mck(){var b=this.mz.zEb;if(!b)return null;b=this.r$n(me.ParagraphReader.pR(b));return bF.a.Aci(b)}r$n(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get RN(){return this.fn&&this.fn.instance?this.fn.instance.ij:Ep.rhl}w9b(){const b=
{};return 32!==this.ga.Rb(Ob.a.EHa,2,b)?(r.ULS.sendTraceTag(529065947,hB.a.msoulscat_Wac_WordRuler,iB.a.warning,"Unable to read page properties for Ruler"),Tg.recordQosError(this.cyb,[Tg.Lfa],"Unable to read page properties for Ruler"),null):b}dispose(){this.Zmi();this.SYb.zl.Te(10).jV(this.$Ui);Me.a.removeHandler(this.VWe,Kd.a.scroll,this.VFj);this.fn.execute(b=>{b.lTa(this.JXi)});this.aWb&&this.aWb.dispose();Fb.App.za.VI.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==
h&&this.V8a([1,0])})}get Iyi(){null==ns.BFe&&(ns.BFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&v.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return ns.BFe}}ns.BFe=null;Object(m.a)(ns,"ARuler",null,[358]);var LC=c(292);class Is extends ns{constructor(b,h,u,B,Q,ca,qa){super(b,h,u,Q,ca,qa);this.vP="HorizontalRuler";this.hMj="CustomTabModificationFromRuler";
this.INj="IndentModificationFromRuler";this.dqe="MarginModificationFromRuler";this.wXg=this.vXg=this._tabStops=null;this.Mkn=(Qa,rb,Lb)=>{if(!(Qa>=this._tabStops.length)){Qa=this._tabStops[Qa];var Yb="Modify"===Lb?this.ga.Rb(Qc.a.sfc,2,{["tabStop"]:Qa,["value"]:Of.a.Mv(rb)}):this.ga.Rb(Qc.a.G6a,2,Qa);if(32===Yb){rb=1;var gc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Lb,gB[Qa.mea]);r.ULS.sendTraceTag(591213271,3014,50,gc)}else rb=0,gc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",
Lb,gB[Qa.mea]),r.ULS.sendTraceTag(591213272,3014,15,gc),Tg.recordQosError(this.Qlk,[Tg.Lfa],"Unable to modify custom tab using ruler");Fe.a(this.hMj,32===Yb,void 0,[Object.assign(new ha.a,{name:"Operation",string:Lb}),Object.assign(new ha.a,{name:"TabType",int64:gB[Qa.mea]})]);Lb=new Map;Lb.set("Command","OnCustomTabChange");Lb.set("Source",this.vP);Lb.set("Response",gc);xa.Health.instance.recordKpiUsage(Ep.kpiName,rb,Ep.I8,Lb)}};this.ann=(Qa,rb)=>{var Lb=new KC.a;Lb.unit=1;Lb.value=Of.a.Mv(rb);rb=
8;switch(Qa){case "FirstLineIndent":rb=this.ga.Rb(Ob.a.U8c,2,Lb);break;case "HangingIndent":rb=this.ga.Rb(Ob.a.V8c,2,Lb);break;case "LeftIndent":rb=this.ga.Rb(Ob.a.j3a,2,Lb);break;case "RightIndent":rb=this.ga.Rb(Ob.a.i3a,2,Lb)}let Yb;32===rb?(Lb=1,Yb=String.format("Indents set using Ruler. Indent: {0}",Qa),r.ULS.sendTraceTag(592517017,3014,50,Yb)):(Lb=0,Yb=String.format("Unable to set indent using Ruler. Indent: {0}",Qa),r.ULS.sendTraceTag(592496523,3014,15,Yb,Qa),Tg.recordQosError(this.Ulk,[Tg.Lfa],
"Unable to set indent using Ruler."));Fe.a(this.INj,32===rb,void 0,[Object.assign(new ha.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnIndentChange");Qa.set("Source",this.vP);Qa.set("Response",Yb);xa.Health.instance.recordKpiUsage(Ep.kpiName,Lb,Ep.I8,Qa)};this.bWf=(Qa,rb,Lb)=>{let Yb;Yb="Left"===Qa?this.ga.Rb(Ob.a.Lja,2,Of.a.Mv(rb)):"Right"===Qa?this.ga.Rb(Ob.a.x7a,2,Of.a.Mv(rb)):Lb?this.ga.Rb(Ob.a.ske,2,{["columnIndex"]:Lb-1,["width"]:Of.a.Mv(rb)}):this.ga.Rb(Ob.a.Kkc,2,Of.a.Mv(rb));
32===Yb?(rb=1,Lb=String.format("Margins set using Ruler. Margin: {0}",Qa),r.ULS.sendTraceTag(592517018,3014,50,Lb)):(rb=0,Lb=String.format("Unable to set margins using Ruler. Margin: {0}",Qa),r.ULS.sendTraceTag(592496524,3014,15,Lb),Tg.recordQosError(this.ijh,[Tg.Lfa],"Unable to set margins using Ruler."));Fe.a(this.dqe,32===Yb,void 0,[Object.assign(new ha.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnMarginChange");Qa.set("Source",this.vP);Qa.set("Response",Lb);xa.Health.instance.recordKpiUsage(Ep.kpiName,
rb,Ep.I8,Qa)};this.PMa=B;this.pr={}}get wU(){return this.vXg}get wFa(){return this.wXg}renderRuler(){this.wU.classList.remove("HideWACHorizontalRulerContainer");this.wU.classList.add("ShowWACHorizontalRulerContainer");var b=this.w9b();if(b){var h=this.bWf,u=this.ann,B=this.Mkn,Q=this.Jbd(),ca=this.vAj(),qa=this.uAj();Q&&ca&&qa||(this.pr.disabled=!0);this.pr.onIndentChange=u;this.pr.onMarginChange=h;this.pr.onTabChange=B;this.cVa();b=kf.a.Ki(b.Go,0);this.wFa.style.width=(b*this.RN).toString()+"px";
return this.PMa().then(Qa=>{Qa.renderRuler(this.wFa,this.pr)})}}uAj(){const b=[];var h={};if(32!==this.ga.Rb(Qc.a.HNb,2,h))return r.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Tg.recordQosError(this.cyb,[Tg.Lfa],"Unable to read paragraph tabs for Ruler"),!1;var u=h.customTabs;if(!u||0>=u.length)return this.pr.tabs=b,!0;this._tabStops=u;h="";for(const B of u){switch(B.mea){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";
break;case 7:h="BarTab"}u=kf.a.d6a(B.KIa,0);b.push({["type"]:h,["value"]:u,["getRulerPropertyBoundary"]:Hs.Aam()})}this.pr.tabs=b;return!0}V8a(b){var h;if(this.wU){this.wU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.pr&&delete this.pr.disabled;for(const u of b)switch(u){case 0:b=this.vAj();const B=this.uAj();b&&B||(this.pr.disabled=!0);break;case 1:this.Jbd()||(this.pr.disabled=!0)}if(null===(h=this.mz.lb)||void 0===h?0:h.KVc)this.pr.disabled=!0;this.PMa().then(u=>{u.renderRuler(this.wFa,
this.pr);return null})}}Jbd(){const b={};var h=this.w9b();if(!h)return!1;b.scale=Of.a.Wz(h.Go);b.precision=Ep.precision;b.rulerType="Horizontal";if(!this.Ttn())return this.pr.ipContextIndex=0,this.pr.permittedUnits=Ep.VOh,h=[{["type"]:"Left",["value"]:Of.a.Wz(h.marginLeft),["getRulerPropertyBoundary"]:Hs.f$b("Left",0)},{["type"]:"Right",["value"]:Of.a.Wz(h.marginRight),["getRulerPropertyBoundary"]:Hs.f$b("Right",1)}],b.margins=h,this.pr.rulerCanvasProps=b,!0;var u={};h={};var B=this.ga.Rb(Ob.a.G4c,
2,u);const Q=this.ga.Rb(Ob.a.UNb,2,h);if(32!==B||32!==Q)return r.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Tg.recordQosError(this.cyb,[Tg.Lfa],"Unable to read table properties for Ruler"),!1;u=u.ColumnWidths;B=h.TablePosition;if(!B||!u||0>=u.length)return r.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Tg.recordQosError(this.cyb,[Tg.Lfa],"Cannot show table properties on the ruler as they are null"),!1;h=Array(u.length+
1);h[0]={["type"]:"MoveTableColumn",["value"]:Of.a.Wz(B.x/this.RN),["getRulerPropertyBoundary"]:Hs.f$b("MoveTableColumn",0)};for(B=0;B<u.length;B+=1)h[B+1]={["type"]:"MoveTableColumn",["value"]:Of.a.Wz(u[B]),["getRulerPropertyBoundary"]:Hs.f$b("MoveTableColumn",B+1)};this.pr.ipContextIndex=this.qem();this.pr.permittedUnits=Ep.LEo;b.margins=h;this.pr.rulerCanvasProps=b;return!0}vAj(){var b={};if(32!==this.ga.Rb(Ob.a.u6a,2,b))return r.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),
Tg.recordQosError(this.cyb,[Tg.Lfa],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Hs.mTd("FirstLineIndent");const u={type:"HangingIndent"};u.getRulerPropertyBoundary=Hs.mTd("HangingIndent");const B={type:"RightIndent"};B.getRulerPropertyBoundary=Hs.mTd("RightIndent");const Q={type:"LeftIndent"};Q.getRulerPropertyBoundary=Hs.mTd("LeftIndent");this.pr.rtl=b.isRtl;b=b.It;h.value=1===b.specialIndentType?Of.a.Wz(b.hea+b.KB):2===b.specialIndentType?
Of.a.Wz(b.KB-b.hea):Of.a.Wz(b.KB);u.value=Of.a.Wz(b.KB);Q.value=Of.a.Wz(b.KB);B.value=Of.a.Wz(b.Voa);this.pr.indents=[h,u,B,Q];return!0}goh(){Me.a.addHandler(this.wU,Kd.a.Vx,this.z7d)}Zmi(){this.wU&&(this.wU.classList.remove("ShowWACHorizontalRulerContainer"),this.wU.classList.add("HideWACHorizontalRulerContainer"),Me.a.removeHandler(this.wU,Kd.a.Vx,this.z7d));this.PMa().then(b=>{b.dispose(this.wFa);return null})}ht(){this.XFj();this.cVa();this.V8a([1,0])}k7d(b,h){b=h.property;if(b===Jc.a.Go||b===
Jc.a.marginLeft||b===Jc.a.marginRight)this.XFj(),this.cVa(),this.V8a([1])}XFj(){var b=this.w9b();b&&(b=kf.a.Ki(b.Go,0),this.wFa.style.width=Math.round(b*this.RN).toString()+"px")}cVa(){window.requestAnimationFrame(()=>{var b=this.Srf();b&&(b=Qd.a.getElementBounds(b),v.AFrameworkApplication.isRtl?this.wFa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.wFa.style.marginLeft=b.x.toString()+"px")})}qem(){const b=vd.GraphIterator.eb(this.mz.zEb);if(b.zb(14))return b.ld(16),
Lu.a(b,!0);r.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Tg.recordQosError(this.cyb,[Tg.Lfa],"Unable to read table column index for Ruler");return 0}Ttn(){let b=!0;const h=this.mz.lb.HO();if(null===h)return r.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Tg.recordQosError(this.cyb,[Tg.Lfa],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const u=vd.GraphIterator.eb(h.current.node);u.rd();b=b&&Zi.TableReader.hx(u)}return b}nZe(){if(!this.wFa&&
!this.wU){this.vXg=document.createElement("div");this.wU.id=Is.$3j;this.wU.className=Is.Z3j;this.wU.setAttribute(af.a.kga,WordEditorIntl.WordEditorStrings.L_Ruler);this.wU.setAttribute(af.a.oh,af.a.muh);this.wU.classList.add("HideWACHorizontalRulerContainer");if(this.Iyi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");ac.a.ica(b,!h)&&this.wU.classList.add(Is.x$j)}this.wXg=document.createElement("div");
this.wFa.className=Is.Y3j;this.wFa.id=Is.a4j;this.wU.appendChild(this.wFa);b=null;this.Mw&&((b=Object(LC.a)("EditorBars"))&&b.appendChild(this.wU),this.wU.classList.add("regionComposer"));b||(b=document.getElementById(Zj.AppFrame.sdd),b.insertBefore(this.wU,b.firstChild))}}static bF(){return new Is(Ga.a.instance.Ta("Common.IZoomManager"),Fb.App.ni,v.AFrameworkApplication.va,mk.UISurfaces.efi,Ga.a.instance.resolve("WordEditor.IRulerContextMenu"),Hr.a.instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Is.jBg?Is.jBg:Is.jBg=Is.bF()}}Is.$3j="WACHorizontalRulerContainer";Is.Z3j="WACHorizontalRulerContainer";Is.a4j="WACHorizontalRuler";Is.Y3j="WACHorizontalRuler";Is.x$j="ModernUxWACHorizontalRulerContainer";Object(m.a)(Is,"HorizontalRuler",ns,[]);var zy=c(956);class $r extends ns{constructor(b,h,u,B,Q,ca,qa){super(b,h,u,Q,ca,qa);this.vP="VerticalRuler";this.dqe="MarginModificationFromRuler";this.$jh=this.Zjh=null;this.bWf=(Qa,rb)=>{let Lb=8;"Top"===Qa?Lb=this.ga.Rb(Ob.a.y7a,2,Of.a.Mv(rb)):"Bottom"===
Qa&&(Lb=this.ga.Rb(Ob.a.w7a,2,Of.a.Mv(rb)));let Yb;32===Lb?(rb=1,Yb=String.format("Margins set using Ruler. Margin: {0}",Qa),r.ULS.sendTraceTag(529065945,3014,50,Yb)):(rb=0,Yb=String.format("Unable to set margins using Ruler. Margin: {0}",Qa),r.ULS.sendTraceTag(529065946,3014,15,Yb),Tg.recordQosError(this.ijh,[Tg.Lfa],"Unable to set margins using Ruler."));Fe.a(this.dqe,32===Lb,void 0,[Object.assign(new ha.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnMarginChange");Qa.set("Source",
this.vP);Qa.set("Response",Yb);xa.Health.instance.recordKpiUsage(Ep.kpiName,rb,Ep.I8,Qa)};this.PMa=B;this.pr={}}get e2(){return this.Zjh}get EJa(){return this.$jh}renderRuler(){this.e2.classList.remove("HideWACVerticalRulerContainer");this.e2.classList.add("ShowWACVerticalRulerContainer");var b=this.w9b();if(b){var h=this.bWf;this.Jbd()||(this.pr.disabled=!0);this.pr.onMarginChange=h;this.cVa();b=kf.a.Ki(b.rv,1);this.EJa.style.height=(b*this.RN).toString()+"px";this.PMa().then(u=>{u.renderRuler(this.EJa,
this.pr);return null})}}V8a(b){var h;if(this.e2){this.e2.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.pr&&delete this.pr.disabled;for(const u of b)switch(u){case 1:this.Jbd()?this.cVa():this.pr.disabled=!0}if(null===(h=this.mz.lb)||void 0===h?0:h.KVc)this.pr.disabled=!0;this.PMa().then(u=>{u.renderRuler(this.EJa,this.pr);return null})}}Jbd(){const b={},h=this.w9b();if(!h)return!1;b.scale=Of.a.Wz(h.rv);b.precision=Ep.precision;b.rulerType="Vertical";this.pr.ipContextIndex=0;this.pr.permittedUnits=
Ep.VOh;b.margins=[{["type"]:"Top",["value"]:Of.a.Wz(h.marginTop),["getRulerPropertyBoundary"]:Hs.f$b("Top",0)},{["type"]:"Bottom",["value"]:Of.a.Wz(h.marginBottom),["getRulerPropertyBoundary"]:Hs.f$b("Bottom",1)}];this.pr.rulerCanvasProps=b;return!0}goh(){this.nZe();Me.a.addHandler(this.e2,Kd.a.Vx,this.z7d)}Zmi(){this.e2&&(this.e2.classList.remove("ShowWACVerticalRulerContainer"),this.e2.classList.add("HideWACVerticalRulerContainer"),Me.a.removeHandler(this.e2,Kd.a.Vx,this.z7d));this.PMa().then(b=>
{b.dispose(this.EJa);return null})}ht(){this.TFj();this.cVa();this.V8a([1])}k7d(b,h){b=h.property;if(b===Jc.a.rv||b===Jc.a.marginTop||b===Jc.a.marginBottom)this.TFj(),this.cVa(),this.V8a([1])}TFj(){var b=this.w9b();b&&(b=kf.a.Ki(b.rv,1),this.EJa.style.height=Math.round(b*this.RN).toString()+"px")}cVa(){window.requestAnimationFrame(()=>{var b=this.Srf();if(b){const h=Qd.a.getElementBounds(b);this.EJa.style.height=h.height.toString()+"px";b=this.egm(b);this.EJa.style.marginTop=b+"px"}})}egm(b){b=b.getBoundingClientRect().y;
const h=this.VWe.getBoundingClientRect().y;return b-h}nZe(){if(!this.EJa&&!this.e2){this.Zjh=document.createElement("div");this.e2.id=$r.Hmk;this.e2.className=$r.Gmk;this.e2.setAttribute(af.a.kga,WordEditorIntl.WordEditorStrings.L_Ruler);this.e2.setAttribute(af.a.oh,af.a.muh);this.e2.classList.add("HideWACVerticalRulerContainer");if(this.Iyi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");ac.a.ica(b,
!h)&&Sys.UI.DomElement.addCssClass(this.e2,$r.y$j)}this.$jh=document.createElement("div");this.EJa.className=$r.Fmk;this.EJa.id=$r.Imk;this.e2.appendChild(this.EJa);b=document.getElementById(Zj.AppFrame.sdd);b.insertBefore(this.e2,b.firstChild)}}static bF(){return new $r(Ga.a.instance.Ta("Common.IZoomManager"),Fb.App.ni,v.AFrameworkApplication.va,mk.UISurfaces.efi,Ga.a.instance.resolve("WordEditor.IRulerContextMenu"),Hr.a.instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
$r.iBg?$r.iBg:$r.iBg=$r.bF()}}$r.Hmk="WACVerticalRulerContainer";$r.Gmk="WACVerticalRulerContainer";$r.Imk="WACVerticalRuler";$r.Fmk="WACVerticalRuler";$r.y$j="ModernUxWACVerticalRulerContainer";Object(m.a)($r,"VerticalRuler",ns,[]);class Tg{constructor(b,h,u,B,Q,ca,qa,Qa,rb){this.HCe=this.eFe=!1;this.vP="RulerActor";this.adh=null;this.wpa=!1;this.aXj="ClearAllTabStopsFailed";this.lfh="ShowHideRulerFailed";this.PGe=null;this.gFd=(Lb,Yb,gc)=>{if(1===gc)return 32;Lb=this.ga.processAction(Qc.a.sOb,2,
null);32===Lb?(gc=1,Yb=String.format("Clear all tab stops from ruler"),r.ULS.sendTraceTag(591213266,3014,50,Yb)):(gc=0,Yb=String.format("Unable to clear all tab stop from ruler"),r.ULS.sendTraceTag(591213267,3014,15,Yb),Tg.recordQosError(this.aXj,[Tg.Lfa],Yb));const Fc=new Map;Fc.set("Command","ClearAllTabStops");Fc.set("Source",this.vP);Fc.set("Response",Yb);xa.Health.instance.recordKpiUsage(Ep.kpiName,gc,Ep.I8,Fc);return Lb};this.kUc=(Lb,Yb,gc)=>{if(1===gc)switch(Lb){case Qc.a.K2e:case Qc.a.Acf:return 2;
default:return 32}Yb=this.nQe.i$l();switch(Lb){case Qc.a.FJf:var Fc=1;break;case Qc.a.Y9f:Fc=4;break;case Qc.a.b6e:Fc=3;break;default:return r.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Lb=new Mz.a(Yb,Fc,0,1);Lb=this.ga.Rb(Qc.a.u8c,2,Lb);32===Lb?(gc=1,Yb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",gB[Fc],Yb.toString()),r.ULS.sendTraceTag(591213269,3014,50,Yb)):(gc=0,Yb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",
gB[Fc],Yb.toString()),r.ULS.sendTraceTag(591213270,3014,15,Yb));Fc=new Map;Fc.set("Command","InsertCustomTabStopRuler");Fc.set("Source",this.vP);Fc.set("Response",Yb);xa.Health.instance.recordKpiUsage(Ep.kpiName,gc,Ep.I8,Fc);return Lb};this.EQb=(Lb,Yb,gc,Fc,Sc)=>this.eFe||1===gc&&Hi.a.eia(Yb.ek)?8:this.wpa?this.HSc(Lb,Yb,gc,Fc,Sc):this.qvo(Yb,gc);this.B7n=()=>{this.wpa?r.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),
32!==this.ga.processAction(Ob.a.EQb,2)?(r.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Tg.recordQosError(this.lfh,[Tg.Lfa],"Ruler could not be enabled")):r.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.HSc=(Lb,Yb,gc)=>{if(1===gc||!this.wpa)return 32;this.wpa=!1;this.oQe.qfj(!1);this.cbb.dispose();this.K0d()&&this.Vef();this.WFj();r.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Lb=new Map;Lb.set("Command","HideRuler");Lb.set("Source",
this.vP);Lb.set("Response","");xa.Health.instance.recordKpiUsage(Ep.kpiName,1,Ep.I8,Lb);return 32};this.Xae=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return 32;Sc&&(Sc[gg.a.On]=this.wpa);return 32};this.txm=Lb=>{this.wpa=Lb.result};this.nHb=()=>{this.eFe=!1};this.Omi=()=>{this.eFe=!0};this.ga=b;this.cbb=h;this.IWe=u;this.JTb=B;this.nQe=Q;this.oQe=ca;Tg.Sk=Qa;this.tLa=qa;this.hT=rb;this.tLa.Lph(this.Omi);this.tLa.iBd(this.nHb)}initialize(){this.Tb();this.adh=this.B7n;window.addEventListener("TurnRulerOnAction",
this.adh,!0);return this.oQe.zam().continueWith(this.txm,8)}Tb(){this.ga.ra(Ob.a.EQb,vc.a.view,this.EQb);this.ga.fb(Ob.a.Xae,vc.a.view,this.Xae,96);this.ga.ra(Qc.a.K2e,vc.a.view,this.kUc);this.ga.ra(Qc.a.b6e,vc.a.view,this.kUc);this.ga.ra(Qc.a.gFd,vc.a.view,this.gFd);this.ga.ra(Qc.a.Acf,vc.a.view,this.kUc);this.ga.ra(Qc.a.HSc,vc.a.view,this.HSc);this.ga.ra(Qc.a.FJf,vc.a.view,this.kUc);this.ga.ra(Qc.a.Y9f,vc.a.view,this.kUc);zy.a.hd.addHandler(zy.a.c7d,this.Q1c.bind(this));this.hT.vAb(this.PXf)}uqi(){this.wpa&&
(this.cbb.cC(),this.cbb.renderRuler(),this.K0d()&&this.Qaj())}Qaj(){this.IWe.cC();this.IWe.renderRuler()}Vef(){this.IWe.dispose()}K0d(){return this.eDi()&&this.isPaginatedView()}eDi(){null==this.PGe&&null!=v.AFrameworkApplication.K&&(this.PGe=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.PGe}UUa(){this.wpa||Ga.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}oX(){this.tLa.o_n(this.Omi);
this.tLa.U$i(this.nHb);this.wpa&&(this.cbb.dispose(),this.K0d()&&this.Vef())}WFj(){if(this.JTb){const b={};b[Ep.OZo]="ToggleButtonModel";this.JTb.cH(b)}}qvo(b,h){if(!Tg.Sk.W8(b.ek))return r.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Tg.recordQosError(this.lfh,[Tg.Lfa],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.wpa=!0;this.oQe.qfj(!0);this.uqi();this.WFj();r.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;
b.set("Command","ShowRuler");b.set("Source",this.vP);b.set("Response","");xa.Health.instance.recordKpiUsage(Ep.kpiName,1,Ep.I8,b);return 32}isPaginatedView(){return 1===this.hT.mu}Q1c(b,h){switch(h.documentMode){case "View":this.wpa&&(this.ga.processAction(Ob.a.EQb,2),this.HCe=!0);break;case "Edit":this.HCe&&(this.ga.processAction(Ob.a.EQb,2),this.HCe=!1)}}PXf(b,h){if(Tg.instance.wpa&&Tg.instance.eDi())switch(h.Emb){case 1:Tg.instance.Qaj();break;case 0:Tg.instance.Vef()}}static recordQosError(b,
h,u){const B=Object.assign(new Ub.a,{extendedProperties:new Map});u&&B.extendedProperties.set("exception",u);xa.Health.instance.recordQosError(b,h,!1,!0,!1,!1,B)}static bF(){return new Tg(v.AFrameworkApplication.va,Is.instance,$r.instance,Fb.App.za,Ga.a.instance.resolve("WordEditor.IRulerContextMenu"),Ga.a.instance.Oa("WordEditor.Ruler.IRulerSettingInfo"),Ga.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Pk.a.instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Tg.kAg?Tg.kAg:Tg.kAg=Tg.bF()}}Tg.Sk=null;Tg.Lfa="RulerInteractionFailed";Object(m.a)(Tg,"RulerActor",null,[]);class cF{constructor(b,h){this.NBc=null;this.K5a=u=>u.result?u.result.Value.toString():"";this.dHa=u=>{u.Eo||u.Ei?(r.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.NBc=!1):(u=u.result,""===u&&v.AFrameworkApplication.K&&(u=v.AFrameworkApplication.K.kb("RulerDefaultOn")),this.NBc="true"===u.toLowerCase(),r.ULS.sendTraceTag(591541279,
3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.NBc};this.Ev=b;this.IK=h}zam(){const b=new Jd.a;if(null==this.NBc){if(this.OAi())return this.IK.D6a(HC.a.s7c).CWRCo(this.K5a,0).CWRCo(this.dHa,8);b.Ag(!1)}else b.Ag(this.NBc);return b.task}Y1(b){this.IK.Y1(HC.a.s7c,new WE.a(HC.a.s7c,b))}qfj(b){this.OAi()&&(this.Ev.Rja("saveRulerIsEnabled",b.toString()),r.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));
this.Y1(b)}OAi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)r.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(m.a)(cF,"RulerSettingInfo",null,[329]);class dF{constructor(){this.RYg=this.W=null}get name(){return"WordEditor.Ruler"}wc(b){this.W=b;r.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ia("WordEditor.Ruler.RulerSettingInfo",()=>new cF(this.W.resolve("Box4.IRoamingServiceRequestManager"),
this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.W.resolve("Box4.IFeatureHelper").lq.continueWith(()=>{this.sn()});this.RYg=Tg.instance.initialize();r.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}sn(){this.RYg.continueWith(()=>{Tg.instance.uqi();Tg.instance.UUa()});r.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Tg.instance.oX();r.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}
Object(m.a)(dF,"PackageManager",null,[1,2]);class nE{constructor(){this.Kac=this.q2b=null}}Object(m.a)(nE,"CreatePickerCustomizationDictionaryOptions",null,[918]);class oE{}oE.Yg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(oE,"InsertMediaM365DialogHtml",null,[]);class iD{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,
gc,Fc,Sc,ld,Hd,Ie){this.JO=Ie;this.H$a=null;this.DDf=this.Sod=!1;this.Vqj=fe=>{if(fe.rawEvent&&(fe=fe.rawEvent.data))try{const de=Sys.Serialization.JavaScriptSerializer.deserialize(fe,!0),ne=de.MessageId?de.MessageId.toString():null;de&&ne&&(ne===L.a.insertImage||ne===L.a.MAf)&&this.Jzc.start(ne===L.a.insertImage?this.rbb:this.bZg)}catch(de){}};this.kTo=(fe,de,ne,ye,Vf)=>{if(1===ne)return 32;this.O0g?fe=CommonUIStrings.l_OneDriveName:""!==this.fmd?fe=this.fmd:(fe=CommonUIStrings.l_HostGeneric,r.ULS.sendTraceTag(20509841,
352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Vf[xm.a.LabelText]=fe;return 32};this.nTo=(fe,de,ne,ye,Vf)=>{if(1===ne)return 32;if(!v.AFrameworkApplication.rEf())return Vf[xm.a.Visible]=!1,32;this.O0g?fe=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.fmd?fe=String.format(CommonUIStrings.l_ChangePictureFromHost,this.fmd):(fe=CommonUIStrings.l_ChangePictureFromHostGeneric,r.ULS.sendTraceTag(577835747,
352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Vf[xm.a.LabelText]=fe;return 32};this.lTo=(fe,de,ne,ye,Vf)=>{if(1===ne)return 32;v.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Vf[xm.a.Visible]=!1);return 32};this.mTo=(fe,de,ne,ye,Vf)=>{if(1===ne)return 32;v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Vf[xm.a.Visible]=!1);return 32};this.jie=(fe,de,ne)=>{var ye;de=this.fwc.value.uga(de);
if(1===ne)return de&&this.qbb.CMm?32:8;if(2!==ne||!de)return 8;(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("PictureBing");this.H$a=yb.a.create();r.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");fe=this.k_l(fe,this.H$a);fe=this.yYe(fe);fe=this.$md.dQc(fe);fe.correlationId=this.H$a;fe.cBf=this.cZg;fe.$pa=1;return this.hie(fe,CommonUIStrings.L_PictureInsertTitle,
this.rbb)};this.xuo=(fe,de,ne)=>{fe=32===this.ga.Kf(de,Ob.a.insertHyperlink,1,!1,null,null);if(1===ne)return fe&&this.qbb.Cxi?32:8;if(2!==ne||!fe)return 8;r.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.hie(this.aZg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.bZg)};this.Gqj=(fe,de,ne)=>{fe=this.fwc.value.uga(de);if(1===ne)return fe&&this.qbb.qEf?32:8;if(2!==ne||!fe)return 8;r.ULS.sendTraceTag(17838539,
352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.hie(this.aZg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.rbb)};this.fie=(fe,de,ne)=>{var ye;de=this.fwc.value.uga(de);if(1===ne)return de&&this.qbb.EMm?32:8;if(2!==ne||!de)return 8;r.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",
!1))&&pv.a.instance.I6a("PictureStock");this.H$a=yb.a.create();ne=v.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.tI.isFreemiumUpsellEnabled();ne=this.Sod?1:ne?0:-1;fe=this.Y1l(fe,this.H$a,ne);fe=this.$md.dQc(fe);fe.Yg=oE.Yg;fe.correlationId=this.H$a;fe.$pa=2;fe.cBf=this.cZg;fe.qba=this.tI;fe.tHj=ne;return this.hie(fe,CommonUIStrings.L_PictureInsertTitle,this.rbb)};this.kie=(fe,de,ne)=>{var ye;de=this.fwc.value.uga(de);fe=Ga.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===ne)return de&&!this.qbb.qEf&&fe&&fe.zGf()?32:8;if(2!==ne||!de||!fe)return 8;r.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("PictureOneDrive");this.H$a=yb.a.create();ne=iD.Ujh;ye=!1;v.AFrameworkApplication.sEf()&&(ye=this.ZJl());de=new nE;de.q2b=ye;de.Kac=!0;ne=fe.Y$e(CommonUIStrings.L_ImageUploadButtonText,
"Select Images",!0,!1,!0,ne,"Insert Media",1,de);fe.KQd(ne).then(Vf=>{if(null!=Vf&&0<Vf.length){const Og=[];for(let Bl=0;Bl<Vf.length;Bl++){const sm=Vf[Bl][H.a.x0i],op=Vf[Bl][H.a.w0i],zv={};zv.Extension=sm;zv.OriginalUrl=op;zv.caption=sm;Og.push(zv)}this.rbb.vQa=Ob.a.F_;this.rbb.s3a(Og)}});return 32};this.iie=(fe,de,ne)=>{var ye;const Vf=this.fwc.value.uga(de);de=Ga.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ne)return Vf&&de&&de.zGf()?32:8;if(2!==ne||!Vf||!de)return 8;ne=
Ga.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");null!=ne&&ne.Rzl(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));r.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("PictureMobile");this.H$a=yb.a.create();
ye=iD.Ujh;ne=new nE;ne.q2b=!0;ne.Kac=!0;ye=de.Y$e(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,ye,"InsertPictureFromMobile",3,ne);de.KQd(ye).then(Og=>{if(null!=Og&&0<Og.length){var Bl=[];const sm=fe===Ob.a.hXd;let op=!1;const zv=v.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");for(let XC=0;XC<Og.length;XC++){const oB=Og[XC][H.a.x0i],WD=Og[XC][H.a.w0i],lz={};lz.Extension=oB;lz.OriginalUrl=WD;lz.caption=oB;Bl.push(lz);op||(op=-1!==lz.OriginalUrl.indexOf(zv))}this.rbb.vQa=
Ob.a.F_;this.rbb.s3a(Bl);Bl={};Bl.InsertImageCount=Og.length;op&&Fe.c(sm?Ob.a.HBm:Ob.a.ZSk,void 0,void 0,void 0,void 0,void 0,Bl)}});return 32};this.Jzc=B;this.Srd=Q;this.$md=qa;this.aZg=Qa;this.a3=rb;this.ga=b;this.fwc=ca;this.O0g=Fc;this.fmd=ld;this.qbb=u;this.rbb=Lb;this.bZg=Yb;this.cZg=Hd;(this.tI=gc)&&this.tI.isFeatureEnabled("MsoPremiumStockImages",!1).catch(fe=>r.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
fe)).then(fe=>{(this.Sod=fe)||this.tI.Rya("MsoPremiumStockImages",()=>{this.Sod=!0;r.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Tb(){(this.qbb.qEf||this.qbb.Cxi)&&this.qbb.DMm&&this.aEn();this.YTn();this.XTn();this.ga.fb(Ob.a.rBh,vc.a.view,this.Gqj,1284);this.ga.fb(Ob.a.P3i,vc.a.view,this.nTo,1124);this.ga.fb(Ob.a.XAf,vc.a.view,this.Gqj,1284);this.ga.fb(Ob.a.j3f,vc.a.view,this.kTo,1124);this.ga.fb(Ob.a.PBm,vc.a.view,this.xuo,
1284)}YTn(){this.ga.fb(Ob.a.insertOnlinePicture,vc.a.view,this.jie,1284);this.ga.fb(Ob.a.dXd,vc.a.view,this.fie,1284);this.ga.vja("word_insertOnlinePictures",Ob.a.insertOnlinePicture,vc.a.view,this.jie,b=>{Fb.App.za.eoc(b,Object(z.a)(new be.a,(new be.a).jFb,"getCommandById"))});this.ga.vja("word_insertOnlinePictures",Ob.a.dXd,vc.a.view,this.fie,b=>{Fb.App.za.eoc(b,Object(z.a)(new be.a,(new be.a).jFb,"getCommandById"))});this.ga.fb(Ob.a.k6e,vc.a.view,this.jie,1284);this.ga.fb(Ob.a.m6e,vc.a.view,this.kie,
1284);this.ga.vja("word_insertOnlinePictures",Ob.a.m6e,vc.a.view,this.kie);this.ga.fb(Ob.a.n6e,vc.a.view,this.fie,1284);this.ga.fb(Ob.a.N3i,vc.a.view,this.lTo,1284);this.ga.fb(Ob.a.O3i,vc.a.view,this.mTo,1284);this.ga.vja("word_insertOnlinePictures",Ob.a.k6e,vc.a.view,this.jie);this.ga.vja("word_insertOnlinePictures",Ob.a.n6e,vc.a.view,this.fie);this.ga.fb(Ob.a.ZAf,vc.a.view,this.kie,1284);this.ga.vja("word_insertOnlinePictures",Ob.a.ZAf,vc.a.view,this.kie,b=>{Fb.App.za.eoc(b,Object(z.a)(new be.a,
(new be.a).jFb,"getCommandById"))})}XTn(){v.AFrameworkApplication.sEf()&&(this.ga.fb(Ob.a.hXd,vc.a.view,this.iie,1284),this.ga.fb(Ob.a.l6e,vc.a.view,this.iie,1284),this.ga.vja("mso_insertMobileDevicePictures",Ob.a.hXd,vc.a.view,this.iie,b=>{Fb.App.za.eoc(b,Object(z.a)(new be.a,(new be.a).jFb,"getCommandById"))}),this.ga.vja("mso_insertMobileDevicePictures",Ob.a.l6e,vc.a.view,this.iie,b=>{Fb.App.za.eoc(b,Object(z.a)(new be.a,(new be.a).jFb,"getCommandById"))}))}aEn(){v.AFrameworkApplication.ua.get_element().appendChild(this.Srd.p1a);
Me.a.addHandler(this.Srd.p1a.contentWindow,"message",this.Vqj);this.DDf=!0}k_l(b,h){let u=0;v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb&&5===v.AFrameworkApplication.ua.Lb.Nk&&(u=12);const B=Jj.a.qg(v.AFrameworkApplication.lcid);return String.format(v.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Ob.a.insertOnlinePicture?1:0,v.AFrameworkApplication.lcid,B?B.name:"en-us",v.AFrameworkApplication.buildVersion,h,u,v.AFrameworkApplication.K.kb("UserId"))}hie(b,h,
u){try{return b.gie(h,u,void 0),r.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(B){return r.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",B.toString()),this.zp(kl.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}Y1l(b,h,u){if(Ob.a.dXd===b)return b=this.a3.Axh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),
h.toString(),1,u),this.yYe(b);b=this.a3.Axh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),0,u);return this.yYe(b)}zp(b,h,u){const B=new mg.StandardDialog(!0);B.Ht=v.AFrameworkApplication.Pca;B.Cd=0;B.xe(1,CommonUIStrings.l_DialogClose);B.rx(b,h,u,()=>{})}ZJl(){const b=Ga.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.gOl():!1}dispose(){this.DDf&&this.Srd.p1a.contentWindow&&(Me.a.removeHandler(this.Srd.p1a.contentWindow,"message",this.Vqj),this.DDf=
!1)}yYe(b){return this.JO&&this.JO.hJ?(b=new bb.QueryStringBuilder(b),b.ye("theme","4"),b.toString()):b}}iD.Ujh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(iD,"InsertMediaActor",null,[10]);var MC=c(970);class eF extends MC.a{constructor(b,h){super(b,fa.a.getOrigin(h))}Fq(b,h){this.isEnabled()&&this.oba(this.m8a)&&(this.Fv(b),this.bC(b,h))}}Object(m.a)(eF,"InsertMediaCrossDocumentMessenger",MC.a,[465,65,10]);class fF{getInstance(b,h){return new eF(b,h)}}Object(m.a)(fF,"InsertMediaCrossDocumentMessengerFactory",
null,[444]);var ZF=c(771);class NC{}NC.Yg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(NC,"InsertMediaDialogHtml",null,[]);var jD;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(jD||(jD={}));Object(m.b)("HubbleAction",jD);var dC;(function(b){b[b.unknown=0]="unknown";b[b.zcp=1]=
"bing";b[b.l9o=2]="M365";b[b.xip=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.uac=5]="hubble"})(dC||(dC={}));Object(m.b)("InsertMediaProviders",dC);class FD extends Hf.a{constructor(b,h,u,B=null,Q=!1){super(!1,!1,Q);this.kz=null;this.wuc=!1;this.c_c=this.R0=null;this.V4e="KeepFocusDiv";this.NDd="KeepFocusStartDiv";this.correlationId=null;this.$pa=0;this.qba=this.cBf=null;this.tHj=0;this.xIe=null;this.mnn=()=>{this.R0&&(this.R0.style.visibility="visible",window.setTimeout(()=>{if(this.ej){const ca=this.ej.getElementById(this.NDd);
ca&&ca.focus()}},0))};this.cda=ca=>{ca.keyCode===Sys.UI.Key.tab&&(ca.target.id!==this.V4e||ca.shiftKey?ca.target.id===this.NDd&&ca.shiftKey&&(ca.preventDefault(),this.ej.getElementById(this.V4e).focus()):(ca.preventDefault(),this.ej.getElementById(this.NDd).focus()))};this.vSi=()=>{r.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.bEb(this.w_a);this.gpb(1)};this.lVf=()=>{this.kz&&(r.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.kz.sendMessage(L.a.ojj,
{["CustomHeaders"]:""}))};this.MTi=()=>{this.kz&&(r.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.kz.sendMessage(L.a.blo,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.JTi=()=>{this.kz&&(r.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.kz.sendMessage(L.a.heo,{["CID"]:""}))};this.Knn=()=>{this.qba&&(r.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.qba.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.bnd=b;this.FVb="";this.a3=u;this.Lta=[];this.dtd=h;this.Yg=B||NC.Yg;this.ug="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async gie(b,h){this.FVb=b;this.wuc=!1;this.showDialog(this.FVb,null);this.R0=this.a9b(this.mj("insertmediaframe"));if(!this.R0)throw this.bEb(this.w_a),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.NDd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.R0.parentNode.insertBefore(b,this.R0.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.V4e);b.setAttribute("tabindex","0");this.R0.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.Mdf,
"keydown",this.cda);this.R0.src=this.bnd;this.R0.style.width="100%";this.R0.style.height="100%";this.R0.frameBorder="0";v.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&Z.a.lj?(this.R0.style.visibility="hidden",this.c_c=this.mnn,Me.a.addHandler(this.R0,"load",this.c_c)):this.R0.style.visibility="visible";this.a9b(this.mj("WACDialogButtonPanel")).style.display="none";this.a9b(this.mj("WACDialogTitleText")).style.display="none";2===this.$pa&&(this.a9b(this.mj("WACDialogTitlePanel")).style.display=
"none",this.a9b(this.mj("WACDialogBodyPanel")).style.padding="0");hd.FocusManager.instance().Ys().scope.$H=!0;this.kz=this.dtd.getInstance(this.R0.contentWindow,this.bnd);this.kz.oba("https://osiziwuspersimmon002.blob.core.windows.net");this.kz.oba("https://osizewuspersimmon001.blob.core.windows.net");this.kz.oba("https://osizpscuspersimmon000.blob.core.windows.net");this.kz.oba("https://cdn.hubblecontent.msit.osi.office.net");this.kz.oba("https://cdn.hubblecontent.osi.office.net");this.kz.Fq(L.a.rnh,
u=>{this.LRi(u,Object(z.a)(h,h.s3a,"insertMediaCallback"))});this.kz.Fq(L.a.insert,u=>{this.O6d(u,Object(z.a)(h,h.s3a,"insertMediaCallback"))});this.kz.Fq(L.a.$rk,u=>{this.Ron(u)});this.kz.Fq(L.a.X6h,this.lVf);this.kz.Fq(L.a.getSessionId,this.MTi);this.kz.Fq(L.a.G4h,this.JTi);this.kz.Fq(L.a.hEd,this.vSi);2!==this.$pa||this.tHj||(this.kz.Fq(L.a.rYm,this.Knn),this.xIe=this.qba.Rya("MsoPremiumStockImages",u=>{r.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");
this.kz.sendMessage(L.a.vYo,{["LicenseTier"]:u.toString()})}));this.gpb(3)}dispose(){this.qba&&this.xIe&&this.qba.Fic("MsoPremiumStockImages",this.xIe);this.kz&&(this.kz.dispose(),this.kz=null);this.c_c&&(Me.a.removeHandler(this.R0,"load",this.c_c),this.c_c=null);super.dispose()}LRi(b,h){r.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(b=this.a3.Eyn(b))this.Lta.push(b),this.wuc&&(h(this.Lta),this.wuc=!1)}zp(){const b=new mg.StandardDialog(!0);b.Ht=v.AFrameworkApplication.Pca;b.Cd=
0;b.xe(1,CommonUIStrings.l_DialogOk);b.pv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}gpb(b){if(2===this.$pa){const u=v.AFrameworkApplication.K.kb("InsertMediaDialogAriaTenantNameSpace");if(u&&""!==u){var h=[];h.push(Object.assign(new ha.a,{name:"InsertedFiles",int64:this.Lta.length}));h.push(Object.assign(new ha.a,{name:"MediaDetails",string:JSON.stringify(this.Lta)}));h.push(Object.assign(new ha.a,{name:"DialogResult",string:jD[b]}));h.push(Object.assign(new ha.a,
{name:"DialogMode",string:this.Tai()}));h.push(Object.assign(new ha.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ha.a,{name:"Provider",string:dC[this.$pa]||"Unknown"}));ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:String.format("{0}.{1}",u,this.telemetryEventName),dataFields:h}))}}}Tai(){return 3===this.$pa?"Icons":5===this.$pa?"ExternalContent":"Images"}a9b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",
b));return h}O6d(b,h){r.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.bEb(this.w_a);h?this.Lta&&50<this.Lta.length?(this.zp(),this.gpb(0),r.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Lta.length,dC[this.$pa])):this.Lta&&0<this.Lta.length?(h(this.Lta),this.gpb(0),r.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Lta.length,dC[this.$pa])):(r.ULS.sendTraceTag(23078422,352,15,"Empty search result."),
this.wuc=!0,h(this.Lta),this.gpb(2)):this.gpb(2)}Ron(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,r.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ea.a.sendOtelEvent(Object.assign(new ZF.a,{otelEvent:b})))}}Object(m.a)(FD,"InsertMediaDialog",Hf.a,[436,10]);class pE{constructor(b,h){this.aEe=b;this.a3=h}dQc(b,h=!1){return new FD(b,this.aEe,this.a3,NC.Yg,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(pE,"InsertMediaDialogFactory",
null,[435]);class gF{constructor(b,h,u){this.mui=!1;this.correlationId=null;this.$pa=0;this.cBf=null;this.e4j=b;this.aEc=[];this.gmd=h;this.Igh=u.split(";")}async gie(b,h){Array.clear(this.aEc);b=this.e4j.value;b.oba(this.gmd);b.Fv(h.SSc);this.mui||(b.bC(h.SSc,u=>{this.O6d(u,h)}),this.mui=!0);r.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.eNh,{["FileExtensionFilterList"]:this.Igh})}huk(b){Array.contains(this.aEc,b)||
this.aEc.push(b)}O6d(b,h){r.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.d_i(b);const u=[];for(let B=0;B<b.length;B++){const Q=b[B];h.$Yd(Q,this.Igh)?u.push(Q):this.huk(h.Jei(Q))}u&&u.length?h.s3a(u):r.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.aEc.length&&(h=this.aEc.join(", "),r.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),
this.Yvo(h))}Yvo(b){const h=new mg.StandardDialog;h.Cd=0;h.uV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(m.a)(gF,"InsertMediaFromHostManager",null,[436,10]);class Ay{constructor(b){this.n5j=b}dQc(){throw Error.notImplemented();}getInstance(){return this.n5j}}Object(m.a)(Ay,"InsertMediaFromHostManagerFactory",null,[434,435]);class Bu{constructor(){this.p1a=document.createElement("iframe");this.p1a.src="about:blank";
this.p1a.style.visibility="hidden";this.p1a.style.position="absolute";this.p1a.style.zIndex="-100"}}Object(m.a)(Bu,"InsertMediaFromHostOneDriveHostFrame",null,[433]);class ek extends MC.a{constructor(b,h){super(b,"*"===h?h:fa.a.getOrigin(h));this.umh(L.a.insertImage);this.umh(L.a.MAf)}qde(){}}Object(m.a)(ek,"InsertMediaFromOneDriveCrossDocumentMessenger",MC.a,[430,65,10]);class GD{}Object(m.a)(GD,"OnlineMediaSearchResult",null,[]);class OC{Axh(b,h,u,B){const Q=Jj.a.qg(v.AFrameworkApplication.lcid).name,
ca=v.AFrameworkApplication.buildVersion,qa=F.a.NQ(v.AFrameworkApplication.K.kb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Qa=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;v.AFrameworkApplication.le("ShIns226;ShIns226cf");return String.format(b,v.AFrameworkApplication.lcid,Q,ca,h,OC.bre,qa,B,u,Qa)}return String.format(b,v.AFrameworkApplication.lcid,Q,ca,h,OC.bre,qa,B,u)}Eyn(b){if(!b||!b.Values)return null;b=b.Values;
if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new GD,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}Fyn(b){const h=[];if(!b||
!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let B=0;B<b.length;B++){var u=b[B];u&&(u=Object.assign(new GD,{Type:u.Extension||"",OriginalUrl:u.SourceUrl||"",Caption:u.caption,Height:u.Height||0,Width:u.Width||0}),h.push(u))}return h}KZf(b){const h=[];for(let B=0;B<b.data.files.length;B++){var u=b.data.files[B];u&&(u=Object.assign(new GD,{ContentType:u.itemType||"",Type:u.extension||"",OriginalUrl:u.urls&&u.urls.open?u.urls.open:"",Height:u.photo?u.photo.height:0,Width:u.photo?u.photo.width:
0}),h.push(u))}return h}$Yd(b,h){if(!b)return!1;for(let u=0;u<h.length;u++)if(0<=b.toLowerCase().indexOf(h[u]))return!0;return!1}WDn(b){let h="";if(b)for(let u=0;u<b.length;u++){const B=b[u];B&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',B.OriginalUrl,B.Width,B.Height))}return h}}OC.bre=0;Object(m.a)(OC,"InsertMediaHelper",null,[432]);class hF{constructor(b,h,u,B,Q){this.CMm=b;this.qEf=h;this.Cxi=u;this.DMm=B;this.EMm=Q}}Object(m.a)(hF,"InsertMediaSettingsManager",null,[]);
class qE{constructor(b){this.qwc=Ob.a.insertHyperlink;this.ga=b}get vQa(){return this.qwc}set vQa(b){this.qwc=b}s3a(b){try{r.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Rb(this.vQa,2,b[h]);r.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){r.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",
h.toString())}}}Object(m.a)(qE,"InsertOneDriveFileHandler",null,[331]);class iF extends qE{constructor(b){super(b)}get eNh(){return L.a.MAf}get SSc(){return L.a.hBm}d_i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}Jei(){Pc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}$Yd(){return!0}c3i(b,h,u){b=u(b);b.length&&(u={},u.Items=b,h.sendMessage(this.SSc,u))}f_i(b){const h=[];for(let u=0;u<b.data.files.length;u++){const B=
b.data.files[u];if(B){const Q={};Q.DisplayText=String.format("{0}{1}",B.name,B.extension);Q.Url=this.ODl([B.urls.viewInBrowser,B.urls.open,B.urls.download]);h.push(Q)}}return h}ODl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];r.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(m.a)(iF,"InsertOneDriveFileHelper",qE,[330,331]);class kD{constructor(b,h,u){this.qwc=Ob.a.F_;this.Zp=null;this.ga=b;this.a3=h;this.Sfa=u}get nc(){return this.ga}get Tw(){return this.Zp||
(this.Zp=Ga.a.instance.resolve("Common.Utils.IAriaNotifier"))}get vQa(){return this.qwc}set vQa(b){this.qwc=b}s3a(b){try{r.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.a3.WDn(b);let u=2;if(h&&0<h.length){const B=new Od.DictionaryPropertySet;B.setValue($c.a.IP,h);B.setValue($c.a.F4,!0);if(this.Sfa){const Q=this.Sfa.N$c();Q.G2b("insertOnlineImage");B.setValue($c.a.Zua,Q)}u=this.ga.Rb(this.vQa,2,B)}r.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===u,""===h)}catch(h){r.ULS.VA(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(m.a)(kD,"InsertOnlineImageHandler",null,[331]);class HD extends kD{constructor(b,h,u=null){super(b,h,u)}get eNh(){return L.a.insertImage}get SSc(){return L.a.vBm}d_i(b){return this.a3.Fyn(b)}Jei(b){return b.Type}$Yd(b,h){return this.a3.$Yd(b.Type,h)}f_i(b){return this.a3.KZf(b)}c3i(b,
h,u){u=u(b);if(u.length){b=[];for(let B=0;B<u.length;B++){const Q=u[B],ca={};ca.Extension=Q.Type;ca.SourceUrl=Q.OriginalUrl;ca.caption=Q.Type;ca.SourceUrl=Q.OriginalUrl;ca.Width=Q.Width;ca.Height=Q.Height;b.push(ca)}u={};u.Items=b;h.sendMessage(this.SSc,u)}}}Object(m.a)(HD,"InsertOnlineImageHelper",kD,[330,331]);class jF{constructor(b,h){this.uub=b;this.dtd=h}start(b){this.uub.start({mode:"open",select:"multi",lightbox:"white"},(h,u)=>{this.processResponse(h,u,b)})}processResponse(b,h,u){r.ULS.sendTraceTag(22090009,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.dtd.getInstance(window.frames[0].parent,window.document.URL),u.c3i(h,b,B=>u.f_i(B))):r.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(m.a)(jF,"OneDriveFilePickerHelperV5",null,[328]);class kF{constructor(){this.Zmd=this.W=null}get name(){return"Box4.Media"}wc(b){this.W=
b;b.ia("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new Bu).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new hF(Boolean.parse(v.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),v.AFrameworkApplication.rEf(),!1,v.AFrameworkApplication.sfg(),v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new jF(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();
b.ia("Box4.Media.InsertMediaActor",()=>new iD(v.AFrameworkApplication.va,v.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new hg.a(()=>Ga.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),
b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.vJb,v.AFrameworkApplication.Ppa,v.AFrameworkApplication.ltm,v.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new pE(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",
()=>new Ay(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManager",()=>new gF(new hg.a(()=>{if(v.AFrameworkApplication.sfg()){var u=Ga.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").p1a;u=new ek(u.contentWindow,"*")}else u=v.AFrameworkApplication.hY;return u}),v.AFrameworkApplication.sfg()?fa.a.getOrigin(window.document.URL):fa.a.getOrigin(v.AFrameworkApplication.kNb),v.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).ha();
b.register(fF,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();b.register(OC,"Box4.Media.InsertMediaHelper").ha();b.ia("Box4.Media.InsertOnlineImageHelper",()=>new HD(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Media.InsertOneDriveFileHelper",()=>new iF(v.AFrameworkApplication.va)).ha()}init(){this.Zmd=this.W.resolve("Box4.Media.InsertMediaActor");
this.Zmd.Tb()}dispose(){this.Zmd&&this.Zmd.dispose()}}Object(m.a)(kF,"MediaPackage",null,[1,2]);var lF=c(344);class kz{constructor(){this.V6n="getAddinShortcutsPreference";this.W6n="saveAddinShortcutsPreference";this.X6n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.DKl=6E4;this.$4d=this.Ana=this.D$=null}Rei(b){return String.format(this.X6n,v.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,v.AFrameworkApplication.km)}executeRequest(b,h,u,B,Q=null){return kz.PQ.W1b(b,
h,Q,null,u,B,!1,null,this.DKl)}saveSetting(b,h,u,B,Q){return this.rfj(b,h,u,null,B,Q)}startBatchUpdateScope(){this.$4d=[]}saveShortcutInfoArrayBatch(b,h,u){this.Y8n(u,b,h)}Y8n(b,h,u){const B={action:"",addinId:"",ownerType:0};B.timestamp=(new Date).toUTCString();const Q=this.getShortcutInfoArray(h.toString(),u.toString());b?(B.shortcutInfoArray=b,this.xYe(h,u,b)):Q&&(B.shortcutInfoArray=Q);b={};b[h.toString()]=B;h=new lF.a(u.toString(),b);this.$4d.push(h)}commitBatchUpdateScope(){return this.P9c()?
this.$8n().then(()=>{this.u3b();return Promise.resolve(!0)}):this.b9n().then(()=>{this.u3b();return Promise.resolve(!0)})}$8n(){return this.getSetting().then(b=>{let h=null;if(b&&!({Hu:h}=G.d(b)).returnValue)return r.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const u of this.$4d){(b=h[u.key])||(b={});const B=u.value;for(const Q of mb.a.eP(B))b[Q]=B[Q];h[u.key]=b}this.D$=h;try{return localStorage.setItem("AddinShortcutPreferenceData",
G.c(h)),Promise.resolve(!0)}catch(u){return r.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",u),Promise.resolve(!1)}})}b9n(){return this.Sco().then(b=>this.Cee(b))}Sco(){return this.ktf().then(b=>{let h=null;b&&(({Hu:h}=G.d(b)).returnValue||r.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const u of this.$4d){(b=h[u.key])||(b={});const B=u.value;for(const Q of mb.a.eP(B))b[Q]=
B[Q];h[u.key]=b}this.D$=h;return G.c(h)})}saveShortcutInfoArray(b,h,u){return this.rfj(0,"","",u,b,h)}rfj(b,h,u,B,Q,ca){const qa=this.P9c(),Qa={};Qa.action=u;Qa.addinId=h;Qa.ownerType=b;Qa.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(Q.toString(),ca.toString());0===b&&B?(Qa.shortcutInfoArray=B,this.xYe(Q,ca,B)):h&&(Qa.shortcutInfoArray=h);b={};b[Q.toString()]=Qa;Q=new lF.a(ca.toString(),b);return qa?this.Z8n(Q):this.a9n(Q)}Z8n(b){return this.getSetting().then(h=>{let u=null;if(h&&
!({Hu:u}=G.d(h)).returnValue)return r.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);u||(u={});u[b.key]=b.value;this.D$=u;try{return localStorage.setItem("AddinShortcutPreferenceData",G.c(u)),Promise.resolve(!0)}catch(B){return r.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",B),Promise.resolve(!1)}})}a9n(b){return this.Rco(b).then(h=>this.Cee(h))}Rco(b){return this.ktf().then(h=>{let u=null;h&&
(({Hu:u}=G.d(h)).returnValue||r.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));u||(u={});u[b.key]=b.value;this.D$=u;return G.c(u)})}saveSettings(b){this.D$=G.a(b);this.u3b();return this.P9c()?this.ufj(b):this.Cee(b)}ufj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return r.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}Cee(b){const h=
{};h.Wac=b;const u=G.c(h);return new Promise(B=>{try{if(void 0===u||null===u||!u.length||1E6<=u.length)B(!1);else{var Q=this.executeRequest(this.Rei(this.W6n),2,"SaveAddinShortcutsPreferenceRequest","38",u);Q.continueWith(()=>{if(Q.Eo||Q.Ei)r.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),B(!1);else{var ca=Q.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Qe===oa.a.$y?B(!0):B(!1)}})}}catch(ca){r.ULS.sendTraceTag(522739860,
0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),B(!1)}})}getSetting(){const b=this.P9c();return this.D$?Promise.resolve(G.c(this.D$)):b?this.Vbm():this.ktf()}P9c(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser"),h=v.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}Vbm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return r.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),
Promise.resolve("")}}ktf(){return new Promise((b,h)=>{try{const u=this.executeRequest(this.Rei(this.V6n),1,"GetSettingRequest","37");u.continueWith(()=>{if(u.Eo||u.Ei)r.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let Q="";var B=u.result;B&&B.args&&B.args.data?B.args.data.Qe!==oa.a.$y?r.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",B.args.data.Qe):B.args.data.se?(B=G.a(B.args.data.se),B.Wac&&(Q=B.Wac)):r.ULS.sendTraceTag(522739865,
0,10,"GetSettingFromRoaming : ResponseData is null"):r.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(Q)}})}catch(u){r.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",u.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.P9c(),u=this;return this.getSetting().then(B=>{let Q=null;B&&(Q=G.a(B));if(!Q)return r.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const ca of mb.a.eP(Q)){B=Q[ca.toString()];for(const qa of mb.a.eP(B)){const Qa=B[qa];if(Qa.addinId===b)delete B[qa.toString()];else if(0===Qa.ownerType&&Qa.shortcutInfoArray){const rb=Qa.shortcutInfoArray,Lb=new zb.a;for(let Yb=0;Yb<rb.length;++Yb)rb[Yb].addinId!==b&&Lb.add(rb[Yb]);Qa.shortcutInfoArray=Lb.toArray()}}mb.a.count(B)||delete B[ca]}u.D$=Q;u.nXn(b);return h?u.ufj(G.c(Q)):u.Cee(G.c(Q))})}u3b(){if(this.D$){this.Ana=null;const u=this.D$;for(let B in u){var b=B;const Q=
u[B];for(let ca in Q){var h=ca;const qa=Q[ca];qa.shortcutInfoArray&&this.xYe(parseInt(h),parseInt(b),qa.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({Hu:h}=G.d(b)).returnValue)return r.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.D$=h;this.u3b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,u){return this.D$&&
(u=this.D$[u])&&(h=u[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.D$&&(h=this.D$[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,u){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),u)}setShortcutInfoArray(b,h,u){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),u).then(()=>{this.u3b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Ana)return Promise.resolve(!0);var u=this.Ana[b];if(!u)return Promise.resolve(!0);
var B=u[h];u=B.modifiers;B=B.keyCode;const Q=this.getShortcutInfoArray(u.toString(),B.toString());if(!Q||!Q.length)return Promise.resolve(!0);let ca=0;for(const qa of Q){if(qa.addinId===b&&qa.action===h)break;++ca}if(ca>=Q.length)return Promise.resolve(!0);Q.splice(ca,1);return this.saveShortcutInfoArray(u,B,Q).then(()=>{this.u3b();return Promise.resolve(!0)})}xYe(b,h,u){this.Ana||(this.Ana={});for(const B of u){u=B.addinId;const Q=B.action;let ca=this.Ana[u];ca||(ca={});const qa={};qa.modifiers=
b;qa.keyCode=h;ca[Q]=qa;this.Ana[u]=ca}}nXn(b){b in this.Ana&&delete this.Ana[b]}isActionCustomized(b,h){return this.Ana&&(b=this.Ana[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Ana&&(b=this.Ana[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.D$}static instance(){kz.A_e||(r.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),kz.A_e=new kz,kz.PQ=v.AFrameworkApplication.He);return kz.A_e}}kz.A_e=null;kz.PQ=null;Object(m.a)(kz,"AddinShortcutsPreferenceSettingHelper",
null,[]);class ID{constructor(b,h){this.bid=null;new zb.a;this.V_g=!0;this.yld=b;this.$Vg=h}OZe(b){this.$Vg.addHandler("GoalChangedEvent",b)}dgn(){this.$Vg.raiseEvent("GoalChangedEvent")}QCf(b,h){return this.bid&&this.V_g?b in this.bid?this.bid[b]:"Formality"===h&&this.yld.atf().formality?!1:!0:!0}Oeo(b,h){h===this.yld.atf().formality&&(this.bid=b,this.dgn())}QTo(b){this.V_g=b}}Object(m.a)(ID,"GoalChangeSource",null,[481,482,483]);var lD=c(996),rE=c(927),$F=c(704);class JD{constructor(b,h,u,B,Q,ca){this.nLa=
h;this.lBa=u;this.Oe=b;this.oA=B;this.Bg=Q;this.o3j=ca;this.lBa.LIb()&&this.initialize()}initialize(){return this.oA.Uk().then(()=>{this.Oe.ob(this,lD.a.getTypeName());this.Oe.addHandler(this,rE.a.getTypeName())}).catch(b=>{this.Bg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}GB(b,h){if(h===ak.a.getTypeName()||h===$F.a.getTypeName())if(!b||!b.content)this.Bg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(Wl.a.getTypeNameFor(b.content)===
lD.a.getTypeName()||Wl.a.getTypeNameFor(b.content)===rE.a.getTypeName())if(Wl.a.getTypeNameFor(b.content)===lD.a.getTypeName()){var u=b.content;this.Bg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",u.critiqueConfiguration.formalityGoal);this.nLa.Oeo(u.critiqueConfiguration.mapping,u.critiqueConfiguration.formalityGoal)}else if(Wl.a.getTypeNameFor(b.content)===rE.a.getTypeName())if(b=b.content,b.features){for(u of b.features)if("Goals"===u.featureName){this.o3j.QTo(!!u.supportType);
return}this.Bg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Bg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(m.a)(JD,"GoalsAnnotationHandler",null,[292]);class mF{constructor(b){this.Ga=b}LIb(){return this.Ga.$("EditorGoalsEnabled")}}Object(m.a)(mF,"GoalsGate",null,[479]);var PC=c(1187),KD=c(1188),eC=c(879);class Js{}Js.tJd=0;Js.yJd="1.0";Js.settingType="Goals";Object(m.a)(Js,"GoalsConstants",null,[]);var jB=
c(1079);class fC{constructor(b,h,u,B,Q){this.vZb=null;this.bxi=!1;this.z$g=b;this.Ald=h;this.Bg=u;this.lBa=B;this.LBe=Q;this.lBa.LIb()?this.ANn():this.lBa.LIb()&&this.Sag(Js.tJd,Js.yJd)}ANn(){new Promise(b=>{this.z$g.gdi(Js.settingType,h=>{this.BNn(h)?(this.Sag(this.vZb.formality,this.vZb.version),b(this.vZb)):(this.Sag(Js.tJd,Js.yJd),b(null))})})}BNn(b){this.bxi=!0;if(!b||!b.Jpb)return this.Bg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Jpb.properties;var h=b.getValue(Jc.a.Tri);
h=parseInt(h);b=b.getValue(Jc.a.Vri);if(!this.Ald.Vpg(b))return this.Bg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.vZb=b=Object.assign(new jB.a,{formality:h,version:b});this.Bg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}Sag(b,h){b=Object.assign(new eC.a,{formality:b,version:h});this.LBe.Rhj(b)}U5o(b){if(this.Ald.Vpg(b.version)){var h=
PC.a.T9k(b.version,b.formality.toString());this.z$g.Rnh(Object.assign(new KD.a,{Jpb:h,settingType:Js.settingType}))?this.vZb=b:this.Bg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Bg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}Y$h(){this.bxi||this.Bg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.vZb}}Object(m.a)(fC,"GoalsPersistenceHandler",null,[478]);
class dA{constructor(b,h,u,B){this.Bg=b;this.MBe=h;this.Ald=u;this.lBa=B;this.zld=Object.assign(new jB.a,{formality:Js.tJd,version:Js.yJd});this.LRe=this.lBa.LIb()}atf(){this.LRe&&(this.LRe=!1,this.MBe.Y$h()&&(this.zld=this.MBe.Y$h()));return this.zld}Iko(b){this.LRe=!1;this.Ald.Vpg(b.version)?(this.lBa.LIb()&&this.MBe.U5o(b),this.zld=b):(this.Bg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.zld=Object.assign(new jB.a,{formality:Js.tJd,version:Js.yJd}))}}
Object(m.a)(dA,"GoalsProvider",null,[476,477]);class LD{constructor(b,h,u,B){this.Oe=b;this.oA=h;this.PV=u;this.Bg=B}Rhj(b){b=Object.assign(new ak.a,{parentPath:["Signal",eC.a.getTypeName()],items:[Object.assign(new Hm.a,{body:b})]});this.MLd(b)}MLd(b){this.oA.Uk().then(()=>{this.UXe(b)}).catch(h=>{this.Bg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}UXe(b){this.Oe.activateAnnotation(lD.a.getTypeName(),LD.w2b).then(()=>{this.PV.getAugLoopRuntimeManager().submitOperation(Object.assign(new gp.a,
{operation:b}))}).catch(h=>{this.Bg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}LD.w2b="GoalSelected";Object(m.a)(LD,"GoalsSignalSender",null,[475]);class aw{constructor(){aw.HWe=new RegExp(aw.Dmk)}Vpg(b){return!!b.match(aw.HWe)&&1===b.match(aw.HWe).length}}aw.Dmk="[0-9]+[.]?[0-9]*";aw.HWe=null;Object(m.a)(aw,"GoalsValidator",null,[300]);class Zs{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}wc(b){this.W=
b;this.W.ia("WordEditor.Goals.GoalsValidator",()=>new aw).as("WordEditor.Goals.IGoalsValidator").ha();this.W.ia("WordEditor.Goals.IGoalsGate",()=>new mF(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.Goals.GoalsProvider",()=>new dA(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();
this.W.ia("WordEditor.Goals.GoalChangeSource",()=>new ID(this.W.resolve("WordEditor.Goals.IGoalReader"),new Nc.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.W.ia("WordEditor.Goals.GoalsPersistenceHandler",()=>new fC(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),
this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.W.ia("WordEditor.Goals.GoalsAnnotationHandler",()=>new JD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();
this.W.ia("WordEditor.Goals.GoalsSignalSender",()=>new LD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){M.a.instance.Gc(new Zs)}}Object(m.a)(Zs,"WordEditorGoalsPackage",null,[1,2]);var Ak=c(754),MD=c(409);class ND{constructor(){this.annotation=null;this.languages=new wc.a(Ra.a.jh())}}
Object(m.a)(ND,"CritiqueCountWrapper",null,[]);class eA{constructor(){this.xsa=new tb.a}eQd(){return this.xsa}qpi(b,h,u,B){if(this.xsa.nb(u)){this.xsa.J(u).annotation.count+=h;u=this.xsa.J(u).languages;for(var Q of B)u.add(Q)}else Q=W.a.create().toString(),b=Object.assign(new MD.a,{id:Q,categoryName:b,count:h}),this.xsa.add(u,Object.assign(new ND,{annotation:b,languages:B}))}}eA.Fi=389;Object(m.a)(eA,"BaseCritiquesByTypeCounter",null,[284]);class nF extends eA{constructor(b){super();this.hyb=new Ca.a;
this.wwe=new Ca.a;this.zzd=b}wlm(b){const h=b.annotation;if(h&&Ak.a(Wl.a.getTypeNameFor(h.content))){const u=h.content;if(b.opType===ak.a.getTypeName()){this.zzd.wZn(h.parentPath,u);b=u.M_.state;if(60!==b&&70!==b)return this.hyb.contains(h.id)&&this.hyb.remove(h.id),this.gwm(h.id,u),!0;this.hyb.add(h.id)}else if(b.opType===Iu.a.getTypeName())if(this.hyb.contains(h.id))this.hyb.remove(h.id);else return this.mOh(u.typeId,h.id)}return!1}vlm(b){if((b=b.annotation)&&Ak.a(Wl.a.getTypeNameFor(b.content))){const h=
b.content,u=h.M_.state;if((60===u||70===u)&&!this.hyb.contains(b.id))return this.hyb.add(b.id),this.mOh(h.typeId,b.id)}return!1}gwm(b,h){this.wwe.add(b);b=new wc.a(Ra.a.jh());h.language&&b.add(h.language);this.qpi(h.categoryName,1,h.typeId,b)}mOh(b,h){if(!this.wwe.contains(h))return!1;if(!this.xsa.nb(b))return r.ULS.sendTraceTag(589866503,eA.Fi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.xsa.J(b).annotation.count)return r.ULS.sendTraceTag(589866504,
eA.Fi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.wwe.remove(h);this.xsa.J(b).annotation.count--;return!0}}Object(m.a)(nF,"AlCritiquesByTypeCounter",eA,[289,284]);var aG=c(1017);class oF extends pt.a{constructor(b,h,u,B,Q,ca,qa,Qa,rb){var Lb;super();this.Oe=b;this.zzd=h;this.jse=u;this.YQg=B;this.nLa=Q;this.Bta=ca;this.oi=qa;this.Daa=this.qPg=!1;this.bLe=new tb.a;this.Fln=(Yb,gc)=>{this.zzd.ymm(gc)&&(this.Daa=!0,
this.IY())};this.Bin=(Yb,gc)=>{this.jse.wlm(gc)&&this.uPb()};this.cTi=()=>{this.uPb()};this.NTf=(Yb,gc)=>{this.jse.vlm(gc)&&this.uPb()};this.$mb=()=>{this.uPb()};this.uPb=()=>{let Yb=!1;this.oi.ge(()=>{var gc=this.VRl();const Fc=new zb.a;for(const Sc of gc)gc=Object.assign(new aG.a,{id:Sc.id,parentPath:qs.a.ADb,content:Sc,annotationType:Wl.a.getTypeNameFor(Sc)}),Fc.add(gc),Yb||(Yb=0<Sc.count);this.Oe.Neo(Fc)},"CC:SATH");!this.qPg&&Yb&&(ea.a.sendTelemetryEvent({...(new la.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),
this.qPg=!0)};this.iIm=(Yb,gc,Fc)=>{const Sc=!this.nLa||this.nLa.QCf(Yb,Fc);Yb=this.Bta&&this.Bta.instance?this.Bta.instance.PCf(Yb,Fc,gc.substr(1,gc.length-2)):!0;return Sc&&Yb};null===Qa||void 0===Qa?void 0:Qa.OZe(this.$mb);rb.ara(this,7);null===(Lb=this.Bta)||void 0===Lb?void 0:Lb.execute(Yb=>{Yb.m_e(this.uPb)})}get index(){return 3}run(){this.Daa&&(this.uPb(),this.Daa=!1)}CVi(){this.uPb()}I6k(b){let h=0;if(({value:h}=this.bLe.Fc(b.categoryName,0)).returnValue)if(h!==b.count)this.bLe.Z(b.categoryName,
b.count);else return!1;else this.bLe.add(b.categoryName,b.count);return!0}VRl(){const b=new tb.a;var h=this.zzd.eQd();const u=this.jse.eQd();this.Mng(b,h);this.Mng(b,u);this.YQg&&(h=this.YQg.eQd(),this.Mng(b,h));h=new zb.a;for(const B of b.values)this.I6k(B)&&h.add(B);return h}Mng(b,h){for(const Q of h){h=Q.value.annotation;const ca=Q.key;var u=this.Qco(Q.value.languages);if(!b.nb(h.categoryName)){var B=W.a.create().toString();B=Object.assign(new MD.a,{id:B,categoryName:h.categoryName,count:0,countsByTypeId:{}});
b.add(h.categoryName,B)}this.iIm(ca,u,h.categoryName)&&(u=b.J(h.categoryName),u.count+=h.count,u.countsByTypeId[ca]=(u.countsByTypeId[ca]?u.countsByTypeId[ca]:0)+h.count)}}Qco(b){const h=[];let u=0;for(const B of b)h[u++]=B;return G.c(h)}}Object(m.a)(oF,"CritiquesCounter",pt.a,[287,288]);class pF{constructor(b){this.D2=b}eQd(){const b=new tb.a,h=new wc.a(Ra.a.jh()),u=Object.assign(new MD.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.D2.nsc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",
Object.assign(new ND,{annotation:u,languages:h}));return b}}Object(m.a)(pF,"DictationCritiquesByTypeCounter",null,[283,284]);class OD extends eA{constructor(b){super();this.m$a=new tb.a;this.Oe=b}ymm(b){const h=qs.a.DSd(b.nodeId);if(!qs.a.Xe(h)){if(b.nhb&&b.nhb.length){let u=null;for(const B of b.nhb)B.errorDetails.$3a()||(b=this.K6h(B),qs.a.Xe(b)||(u||(u=new tb.a),u.nb(b)||u.add(b,new zb.a),u.J(b).add(B)));this.nOh(h);u?this.Jio(h,u):this.m$a.remove(h)}else{if(!this.m$a.nb(h))return!1;this.nOh(h);
this.m$a.remove(h)}return!0}return!1}wZn(b,h){var u;if(({value:u}=this.m$a.Fc(b,u)).returnValue)for(const Q of u)if(b=Q.value,0<b.count&&this.pof(b.J(0))===h.categoryName)for(u=b.count-1;0<=u;u--){var B=b.J(u).end-b.J(u).Ac;b.J(u).Ac===h.range.start&&B===h.range.length&&(B=this.K6h(b.J(u)),this.xsa.nb(B)&&(B=this.xsa.J(B).annotation,B.count=Math.max(0,B.count-1)),b.removeAt(u))}}nOh(b){if(this.m$a.nb(b))for(const u of this.m$a.J(b)){var h=u.key;b=u.value;this.xsa.nb(h)&&(h=this.xsa.J(h).annotation,
h.count=Math.max(0,h.count-b.count))}}Jio(b,h){const u=new tb.a,B=new tb.a;for(const Q of h){h=Q.key;B.add(h,new wc.a(Ra.a.jh()));for(const ca of Q.value){const qa=ca.end-ca.Ac,Qa=this.pof(ca);this.ZTk(b,Qa,ca.Ac,qa)?r.ULS.sendTraceTag(589866513,eA.Fi,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,ca.Ac,qa):(u.nb(h)||u.add(h,new zb.a),u.J(h).add(ca),B.J(h).add(this.XRl(ca)))}}this.m$a.Z(b,u);for(const Q of this.m$a.J(b))0<
Q.value.count&&(b=this.pof(Q.value.J(0)),this.qpi(b,Q.value.count,Q.key,B.J(Q.key)))}K6h(b){let h=null;b&&(b=Object(Na.a)(285,b.errorDetails))&&b.Bt&&(h=b.Bt.TypeId);return h}pof(b){let h=null;b&&(b=Object(Na.a)(285,b.errorDetails))&&b.Bt&&(h=b.Bt.CategoryTitle);return h}XRl(b){let h="";b&&b.errorDetails&&(h=Jj.a.qg(b.errorDetails.lcid).name);return h}ZTk(b,h,u,B){if((b=this.Oe.Nmf(b))&&0<b.count)for(const Q of b)if(b=Wl.a.getTypeNameFor(Q.content),Q&&Ak.a(b)&&(b=Q.content,b.categoryName===h&&b.range.start===
u&&b.range.length===B))return!0;return!1}}Object(m.a)(OD,"WacCritiquesByTypeCounter",eA,[286,284]);class mD{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}wc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ia("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new OD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.W.ia("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>
new nF(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ia("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new pF(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.W.ia("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new oF(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),
this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Oa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Ta("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),nr.a.instance,this.W.Oa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).ha();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").wph(b.Fln);
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").uvk(b.Bin);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").iph(b.NTf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.Roh(b.cTi),h.Soh(b.cTi))}}dispose(){}static main(){M.a.instance.Gc(new mD)}}Object(m.a)(mD,"WordEditorCritiqueCountsPackage",null,[1,2]);class sE{get name(){return"WordEditor.GraphicsEditor"}wc(){}init(){}dispose(){}static main(){M.a.instance.Gc(new sE)}}Object(m.a)(sE,"PackageManager",
null,[1,2]);var bG=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",
attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",
Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",
Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",
QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class qF{constructor(b){this.Y_j={};this.Vb=b;this.ryb=new Jh.a}XOa(b,h){const u=this.Vb.Phc,B=parseInt(b);return b&&B!==dd.ActionManager.Egf?this.ryb.nb(u)?(b=this.ryb.J(u).L$b(B,h,2),32===b||1===b):!1:!1}nGa(b){const h=parseInt(b),u=this.Vb.Phc;return b&&h!==dd.ActionManager.Egf?this.ryb.nb(u)?32===this.ryb.J(u).L$b(h,
this.Y_j,1):!1:!0}h8i(b,h){this.ryb.Z(b,h)}Doj(b){b=parseInt(b);const h=this.Vb.Phc;return!!h&&!!this.ryb.J(h)&&this.ryb.J(h).oHm(b)}}Object(m.a)(qF,"NonCanvasCuiUser",null,[882,279]);var av=c(1213),zo=c(47),QC;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=
6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(QC||(QC={}));Object(m.b)("GalleryType",QC);class yv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(yv,"CommonGalleryButtonProps",null,[]);class PD extends yv{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(PD,"AdditionalTableStyleGalleryButtonProps",yv,[]);class rF extends PD{constructor(){super()}}Object(m.a)(rF,
"AdditionalChangeColorsGalleryButtonProps",PD,[]);class gC extends yv{constructor(){super();this.character=null}}Object(m.a)(gC,"AdditionalCharacterCodeGalleryButtonProps",yv,[]);class rr extends yv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(rr,"AdditionalFontStyleGalleryButtonProps",yv,[]);class tE{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(tE,
"AdditionalGalleryProperties",null,[]);class uE extends yv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(uE,"AdditionalIconButtonProperties",yv,[]);class sF extends yv{constructor(){super();this.styleDisplayName=null}}Object(m.a)(sF,"AdditionalInkThicknessGalleryButtonProps",yv,[]);class tF extends yv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(tF,"AdditionalListGallerButtonProps",
yv,[]);class hC extends yv{constructor(){super();this.text=null}}Object(m.a)(hC,"AdditionalPageNumberGalleryButtonProps",yv,[]);var By=c(1143);const Pw=(b,h)=>{var u=appChrome.selectors.getActiveControlStates();if(u=Object(Na.a)(Object,u[b])){if((b=Object(Na.a)(String,u.value))&&b===h)return!1;b=Object(Na.a)(String,u.selectedKey);if(!h&&!b)return!1;if(b){u=Array.isArray(u.options)?u.options:null;let B=null;for(let Q=0;Q<u.length;Q++){const ca=Object(Na.a)(Object,u[Q]);if(Object(Na.a)(String,ca.key)===
b){B=ca;break}}if(B&&Object(Na.a)(String,B.text)===h)return!1}}return!0},Cu=(b,h,u,B)=>{if(0<(B&2)){B=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":B.push(as(b,u[gg.a.On]));break;case "CheckboxModel":B.push(appChrome.actions.toggleCheckbox(b,u[gg.a.On]));break;case "ComboBoxModel":if(v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!Pw(b,u[Zh.a.Value]))break;(h=u[Zh.a.Key])?B.push(appChrome.actions.updateComboBoxKey(b,h,u[Zh.a.Value])):B.push(appChrome.actions.updateComboBoxValue(b,u[Zh.a.Value]));break;case "FontPickerModel":B.push(appChrome.actions.updateFontPickerSelectedFont(b,u[By.a.SelectedFont]));break;case "SplitButtonModel":B.push(as(b,u[ji.a.On]));break;case "SpinButtonModel":B.push(appChrome.actions.updateSpinButton(b,u[gj.a.Number],Of.a.h0a(u[gj.a.UnitType]),u[gj.a.Text],u[gj.a.MaxValue],u[gj.a.Alt]));break;
case "ColorPickerModel":B.push(appChrome.actions.updateColorPickerSelectedColor(b,u[ka.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":B.push(appChrome.actions.updatePageNumberGalleryButtonText(b,u[oh.a.Text]));break;case "CompoundButtonModel":u[gg.a.Description]&&B.push(appChrome.actions.updateCompoundButtonDescription(b,u[gg.a.Description]));gg.a.On in u&&B.push(as(b,u[gg.a.On]));break;case "SliderModel":u.snapToStep?B.push(appChrome.actions.updateSliderSelectedValue(b,u[dn.Value])):
B.push(appChrome.actions.updateSliderValue(b,u[dn.Value],u[dn.MinValue]||0,u[dn.MaxValue],u[dn.Text]));break;case "FlyoutAnchorModel":wj.a.ImageIsVisible in u&&B.push(appChrome.actions.hideFlyoutAnchorIcon(b,!u[wj.a.ImageIsVisible]));gg.a.On in u&&B.push(as(b,u[gg.a.On]));break;case "InputBoxModel":B.push(appChrome.actions.updateInputBoxValue(b,u[cj.a.Text]))}h=B;var Q=Object(Na.a)(String,u[Th.a.iconColor]);void 0!==Q&&null!==Q&&h.push(appChrome.actions.updateIconColor(b,Q));iC(b,u,B);h=B;(Q=Object(Na.a)(Object,
u[Th.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,Q));h=B;Q=Object(Na.a)(String,u[Th.a.customTooltip]);void 0!==Q&&null!==Q&&h.push(appChrome.actions.setControlCustomTooltip(b,Q));b=B;(u=Array.isArray(u[Th.a.j5f])?u[Th.a.j5f]:null)&&b.push.apply(b,u);return B}return null},kB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),as=(b,h)=>appChrome.actions.toggleButton(b,h),iC=(b,h,u)=>{h=Object(Na.a)(String,h[Th.a.Icon]);void 0!==h&&null!==h&&u.push(appChrome.actions.setControlIcon(b,
h))};class nD{constructor(b,h,u,B){this.Cl=B;this.Jta=b;this.jA=h;this.d_b=u;this.nxc={}}YBn(b,h,u,B,Q=null){const ca=b.ExternalGalleryId||b.ExternalId;var qa=b.ExternalId;B.push(ca);if(appChrome.selectors.isControlDefined(ca))b.GalleryStyle&&ah.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ca,b.GalleryStyle));else{if(4!==b.Type)return;u.push(appChrome.api.createGalleryModel(ca,Object.assign(new tE,{columns:b.Width,sections:[appChrome.api.gallerySection([],qa)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}u=0;B=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(ah.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){qa=[];const rb=[],Lb=[],Yb={};for(var Qa of b.GallerySections){qa.push(appChrome.api.gallerySection([],Qa.SectionId,Qa.Title));0===u&&Qa.GalleryButtons&&0<Qa.GalleryButtons.length&&
(u=Qa.GalleryButtons[0].Type);B&&this.vdi(Qa.GalleryButtons,Q,Yb);const gc=this.HYe(rb,Qa.GalleryButtons,Yb);rb.push.apply(rb,this.ksf(gc,ca,Qa.SectionId,!1,u,Q,!0,Yb));Lb.push.apply(Lb,gc)}h.push(appChrome.actions.setGallerySections(ca,qa));h.push.apply(h,rb);h.push.apply(h,this.Lpf(ca,QC[u],Lb,null,5===b.Type,!0,null,Yb))}else b.GalleryItems&&0<b.GalleryItems.length&&(u=b.GalleryItems[0].Type),Qa=B?this.vdi(b.GalleryItems,Q,null):null,h.push.apply(h,this.ksf(this.HYe(h,b.GalleryItems,Qa),ca,qa,
!1,u,Q,!1,Qa))}E8l(b,h){const u=[];let B=null,Q=!1;if(!b)return null;const ca=this.Jta.b3c(this.jA,b.commandId,h);u.push(kB(b.externalUxCommand,!ca));if(b.previewControlIds){const rb=[];for(let Lb=0;Lb<b.previewControlIds.length;Lb++){var qa={},Qa=b.previewControlIds[Lb];qa.SourceControlId=Qa;const Yb=this.Cl.getCommandByExternalUxId(Qa);this.RSd(Yb||b,qa);qa[oh.a.On]&&(B=qa.SourceControlId,qa[oh.a.HighlightOn]&&(Q=!0));iC(Qa,qa,u);if(qa=Object(Na.a)(vx.a,qa[oh.a.GalleryButtonProps]))rb.push(qa),
ca&&(Qa=this.Jta.b3c(this.jA,qa.Command,h),qa.IsDisabled=!Qa)}0<rb.length&&u.push.apply(u,this.ksf(this.HYe(u,rb),b.externalUxCommand,b.externalUxCommand,!0,rb[0].Type));u.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,B));Q&&(r.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",B),u.push(appChrome.actions.highlightSelectedFontStyle(B)))}return u}HYe(b,h,u=null){const B=[],Q=[];for(let qa=0;qa<h.length;qa++){const Qa=h[qa],rb=Le.b(Qa.ExternalId)?
Qa.Id:Qa.ExternalId;B.push(rb);const Lb=u&&u[rb]?u[rb].result:-1;switch(Qa.Type){case 1:var ca=Qa;Q.push(appChrome.api.createCharacterCodeGalleryButtonModel(rb,Object.assign(new gC,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,character:ca.Character,style:ca.Style,title:ca.Alt})));break;case 2:ca=Qa;Q.push(appChrome.api.createFontStylesGalleryButtonModel(rb,Object.assign(new rr,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt,previewStyleLabel:ca.PreviewStyleLabel})));
break;case 3:ca=Qa;Q.push(appChrome.api.createInkThicknessGalleryButtonModel(rb,Object.assign(new sF,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt})));break;case 4:ca=Qa;Q.push(appChrome.api.createIconGalleryButtonModel(rb,Object.assign(new uE,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,icon:[ca.Icon],fullIconStyle:ca.FullIconStyle,previewIconStyle:ca.PreviewIconStyle,largePreviewIconStyle:ca.LargePreviewIconStyle,label:ca.LabelText,title:ca.Alt})));
break;case 5:ca=Qa;Q.push(appChrome.api.createListGalleryButtonModel(rb,Object.assign(new tF,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,infoAtLevel:ca.LevelInfo,ariaLabel:ca.Alt})));break;case 6:ca=Qa;Q.push(appChrome.api.createTableStyleGalleryButtonModel(rb,Object.assign(new PD,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt,columns:ca.columns})));break;case 8:ca=Qa;Q.push(appChrome.api.createChangeColorsGalleryButtonModel(rb,Object.assign(new rF,
{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt})));break;case 7:ca=Qa,Q.push(appChrome.api.createPageNumberGalleryButtonModel(rb,Object.assign(new hC,{disabled:-1!==Lb?1>(Lb&1):ca.IsDisabled,text:ca.Text,title:ca.Alt})))}this.Cl.addCommandToMaps(Object.assign(new zo.a(rb,Qa.Command),{queryCommandId:Qa.QueryCommand,menuItemId:Qa.MenuItemId}))}b.push(appChrome.actions.addControls(Q));return B}ksf(b,h,u,B,Q,ca=null,qa=!1,Qa=null){const rb=
[];B?rb.push(appChrome.actions.populateGalleryItems(h,b)):(this.nxc[h]=!1,qa||(B=!0,appChrome.selectors.isControlDefined(h)&&(B=appChrome.selectors.getGalleryState(h),B=B.disableIndividualButtons?B.disableIndividualButtons:!0),rb.push.apply(rb,this.Lpf(h,QC[Q],b,null,5===Q,B,ca,Qa))),rb.push(appChrome.actions.updateGallerySectionItems(h,u,b)));return rb}CXl(b){return this.Lpf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}Lpf(b,
h,u,B,Q,ca=!0,qa=null,Qa=null){const rb=[];if(b in this.nxc){if(this.nxc[b])return delete this.nxc[b],rb;this.nxc[b]=!0}let Lb=null,Yb=-1;if(u)({b2h:Yb,returnValue:Lb}=this.jnh(h,u,rb,ca,qa,Qa));else if(B)for(const gc of B)(u=({b2h:Yb}=this.jnh(h,gc.galleryButtons,rb,ca,null,Qa)).returnValue)&&(Lb=u);rb.push(appChrome.actions.updateGallerySelectedId(b,Lb));ca&&rb.push(kB(b,!1));Q&&0<Yb&&rb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Yb));return rb}udi(b,h=null){const u={},B={};B.SourceControlId=
b;B.Location=h;b=this.Cl.getCommandByExternalUxId(b);if(!b)return u.result=-1,u.props=B,u;b=this.RSd(b,B);u.result=b;u.props=B;return u}vdi(b,h=null,u=null){u||(u={});for(const B of b)b=Le.b(B.ExternalId)?B.Id:B.ExternalId,u[b]=this.udi(b,h);return u}jnh(b,h,u,B,Q=null,ca=null){let qa,Qa=null;qa=-1;let rb=!1;for(const Yb of h){var Lb=this.zXl(b);h=ca&&ca[Yb]&&-1!==ca[Yb].result?ca[Yb]:this.udi(Yb,Q);const gc=h.result;h=h.props;B&&u.push(kB(Yb,1>(gc&1)));(Lb=Cu(Yb,Lb,h,gc))&&u.push.apply(u,Lb);h[oh.a.On]&&
(Qa=Yb,h[oh.a.HighlightOn]&&h[oh.a.HighlightOn]&&(rb=!0));void 0!==h[Th.a.labelText]&&null!==h[Th.a.labelText]&&(Lb=this.Cl.getCommandByExternalUxId(Yb),u.push(appChrome.actions.setControlLabel(Lb.externalUxCommand,h[Th.a.labelText])));h[oh.a.IsRtl]&&0>qa&&(qa=h[oh.a.IsRtl])}rb&&(r.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Qa),u.push(appChrome.actions.highlightSelectedFontStyle(Qa)));return{returnValue:Qa,b2h:qa}}zXl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}RSd(b,h){h.MenuItemId=b.menuItemId;return this.Jta.Bqa(this.jA,this.d_b,
b.commandId,b.queryCommandId,h)}}Object(m.a)(nD,"ReactGalleryPoller",null,[]);var oD=c(698),vE=c(663),lB=c(1706),wE=c(765),Qw=c(1707);class RC{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(RC,"PopulateFontPickerDataProps",null,[]);var bw=c(284),wt=c(1874);class Du{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(m.a)(Du,"CommonOptionalButtonProperties",null,[]);class ar extends Du{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(ar,"OptionalButtonProperties",Du,[]);class QD extends Du{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(QD,"OptionalCompoundButtonProperties",Du,[]);class xE extends Du{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(m.a)(xE,"OptionalErrorViewProperties",Du,[]);class jC extends Du{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(jC,"OptionalFlyoutAnchorProperties",Du,[]);class SC extends Du{constructor(){super();this.isBanner=null}}Object(m.a)(SC,"OptionalLabelProperties",
Du,[]);class Uf extends Du{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(Uf,"OptionalMultipActionButtonProperties",Du,[]);class RD extends ar{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(RD,"OptionalPersonaButtonProperties",ar,[]);class fA extends Du{constructor(){super();this.toggled=
!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(fA,"OptionalToggleButtonProperties",Du,[]);var uF=c(1709),yE=c(1708),kC=c(477);class SD{constructor(){this.dFh=this.actions=null;this.RIj=!1}}Object(m.a)(SD,"PopulateActions",null,[]);class pD{kgi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.w9l(b);case "InkButtonModel":return this.v9l(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}w9l(b){const h={};h[gg.a.On]=appChrome.selectors.getButtonToggleState(b);return h}v9l(b){const h={};h[gg.a.On]=ah.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(m.a)(pD,"ReactStatePropsSelector",null,[]);class ai{constructor(b,h,u,B,Q){this.Jta=b;this.jA=h;this.d_b=u;this.Cl=B;this.pTe={};this.Gek=new pD;this.byb=Q}isj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.pTe}X9l(b,h,u=null){const B=[],Q={};if(!this.isj(b)){const ca=b.populationProps.populateQueryCommandId,qa={};qa.MenuId=b.externalUxCommand;qa.IsShadowMenuOpen=this.isShadowMenuOpen(u);if(0<(this.Jta.Bqa(this.jA,this.d_b,ca,ca,qa,this.i_l(u))&1))if("FontPickerModel"===h)this.pTe[ca]=!0,B.push(ai.k8l(b,qa)),Q[b.externalUxCommand]="FontPickerModel";else if(qa.MenuItems)switch(this.pTe[ca]=!0,h){case "ComboBoxModel":B.push(ai.i8l(b,qa));Q[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":B.push.apply(B,this.rii(b.externalUxCommand,h,qa.MenuItems,Q,u&&"location"in u?u.location:null))}}return Object.assign(new SD,{actions:B,dFh:Q,RIj:this.isShadowMenuOpen(u)})}Vai(b,h,u,B,Q,ca,qa,Qa,rb=null){let Lb=null;const Yb=[];Le.c(b.Title)||(Lb=b.Title);for(let gc=0;gc<b.ControlList.length;gc++){const Fc=Object(Na.a)(Yp.a,b.ControlList[gc]);
if(!Fc||Fc.ExternalId)ca&&this.XPl(Fc,ca),h.push.apply(h,this.j8l(Fc,qa,Yb,Q,u,B,rb))}return Qa?appChrome.api.menuSection(Yb,Lb,b.Lang):null}rii(b,h,u,B,Q=null){const ca=[],qa=[],Qa=[],rb=[];for(var Lb=0;Lb<u.MenuSectionList.length;Lb++){var Yb=Object(Na.a)(wh.a,u.MenuSectionList[Lb]);Yb&&(Yb=this.Vai(Yb,ca,b,h,rb,B,qa,u.UpdateDynamically,Q),u.UpdateDynamically&&Qa.push(Yb))}Lb=null;u.MenuFooterSection&&(Lb=this.Vai(u.MenuFooterSection,ca,b,h,rb,B,qa,u.UpdateDynamically,Q));u.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(b,
Qa,u.Title,u.AriaLabel,u.ShouldAutoOpen,u.AriaRoleDescription,u.MenuTargetDescriptor,Lb));0<qa.length&&ca.splice(0,0,appChrome.actions.addControls(qa));0<rb.length&&ah.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,rb));return ca}XPl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";
break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Na.a)(YB.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}j8l(b,h,u,B,Q,ca,qa=null){const Qa=[];switch(b.ControlType){case 14:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(B=Object(Na.a)(wE.a,b),null!=B.IsBanner&&B.IsBanner&&this.GBn(Object(Na.a)(wE.a,b),Qa,h,u));break;case 1:case 3:b=Object(Na.a)(yg.a,b);this.IBn(b,Qa,h,u);
b.MenuItemsStatefulData&&ah.d("setStatefulSplitButtonMenuItemsStatefulData")&&Qa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(Q,b.MenuItemsStatefulData));break;case 2:this.sCn(Object(Na.a)(kC.a,b),Qa,h,u);break;case 6:this.JBn(Object(Na.a)(Mw.a,b),Qa,h,u);break;case 4:this.lCn(Object(Na.a)(So,b),Qa,h,u);break;case 7:this.LBn(Object(Na.a)(YB.a,b),Qa,h,u);break;case 12:this.SBn(Object(Na.a)(lB.a,b),Qa,h,u);break;case 13:this.iCn(Object(Na.a)(Qw.a,b),Qa,h,u);break;case 9:b=Object(Na.a)(ee.a,
b);this.UBn(b,Qa,h,u);"StatefulSplitButtonModel"===ca&&B.push(b.ExternalId);break;case 8:this.byb.YBn(Object(Na.a)(Ej.a,b),Qa,h,u,qa)}return Qa}GBn(b,h,u,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new wt.a(b.IconName)),u.push(appChrome.api.createLabelModel(b.ExternalId,
b.LabelText,b.Id,Object.assign(new SC,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}IBn(b,h,u,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.LBd()&&((u=this.IPa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new wt.a(u)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Cb.a)(EA,b)?u.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new QD,{iconSet:(new wt.a(this.IPa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(B=b.DismissHostingSurfaceOnExecute,u.push(appChrome.api.createButtonModel(b.ExternalId,
b.LabelText,Object.assign(new ar,{iconSet:(new wt.a(this.IPa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==B&&null!==B?B:!0})))),this.Cl.addCommandToMaps(Object.assign(new zo.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&ah.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}JBn(b,h,u,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.LBd()&&((u=this.IPa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new wt.a(u)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(u.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new fA,{iconSet:(new wt.a(this.IPa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Cl.addCommandToMaps(Object.assign(new zo.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}SBn(b,h,u,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new wt.a(b.IconName)),u.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new xE,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}iCn(b,h,u,B){B.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(u={},b.Label&&(u.label=b.Label),b.SecondaryLabel&&(u.secondaryLabel=b.SecondaryLabel),b.Details&&(u.details=b.Details),b.Description&&(u.description=b.Description),b.iconSet&&(u.iconSet=b.iconSet),b.Links&&(u.links=b.Links),b.CommandValueId&&(u.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(u.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(u.actionCommandId=b.ActionCommandId),b.CommandId&&(u.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
u))):u.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new Uf,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId})))}sCn(b,h,u,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&
h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.LBd()&&((u=this.IPa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new wt.a(u)).iconSet)),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
u.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new fA,{iconSet:(new wt.a(this.IPa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):u.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new fA,{iconSet:(new wt.a(this.IPa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),
this.Cl.addCommandToMaps(Object.assign(new zo.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}lCn(b,h,u,B){B.push(b.ExternalId);B=this.L7l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,B,b.LabelText)):ah.a("createPersonaButtonModel")&&u.push(appChrome.api.createPersonaButtonModel(b.ExternalId,B,b.LabelText,Object.assign(new RD,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}UBn(b,h,u,B){B.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.LBd()&&((u=this.IPa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new wt.a(u)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&
h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{B=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const Q=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;u.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new jC,{iconSet:(new wt.a(this.IPa(b))).iconSet,keytip:b.KeyTip,hideIcon:B,toggled:Q,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Cl.addCommandToMaps(Object.assign(new zo.a(b.ExternalId,
b.Command),{queryCommandId:b.QueryCommand,populationProps:new oD.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.rii(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}LBn(b,h,u,B){b.McuLayout&&B.push(b.McuExternalId);B.push(b.ExternalId);B=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(B=this.Gek.kgi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(u.push(appChrome.api.createColorPickerModel(b.McuExternalId,
b.Width)),this.Cl.addCommandToMaps(Object.assign(new zo.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),B=b.Width),u.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Cl.addCommandToMaps(Object.assign(new zo.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));u=[];const Q=[];for(let ca=0;ca<b.Colors.length;ca++){const qa=b.Colors[ca];ca<B?u.push(appChrome.api.colorPickerCell(qa.Color,
qa.DisplayColor,qa.Alt)):Q.push(appChrome.api.colorPickerCell(qa.Color,qa.DisplayColor,qa.Alt))}0<u.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,u));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,Q));b.SelectedColorId&&(0<u.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}IPa(b){return b.Image32by32Class?this.Cl.b8h(b.Image32by32Class):
b.Image16by16Class?this.Cl.b8h(b.Image16by16Class):b.ExternalImageId}L7l(b){return b?Object.assign(new yE.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new uF.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}i_l(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}LBd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static k8l(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((u,B)=>{Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Q=>{Q.isFeatureEnabled(bw.a.qKb,!1).then(ca=>{let qa=h.fonts;ca||Q.isFreemiumUpsellEnabled()||(qa=Cl.a.Iqg(qa,Qa=>Qa.fontType!==bw.a.L0f));ca=Object.assign(new RC,{commandId:b.externalUxCommand,fonts:qa,isSubscriber:ca,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
u(ca)}).catch(B)})}))}static i8l(b,h){const u=[];for(let B=0;B<h.MenuItems.MenuSectionList.length;B++){const Q=h.MenuItems.MenuSectionList[B];Q.Title&&u.push(appChrome.api.comboBoxHeader("Header-"+B.toString(),Q.Title));for(let ca=0;ca<Q.ControlList.length;ca++){const qa=Object(Na.a)(vE.a,Q.ControlList[ca]);qa&&u.push(appChrome.api.comboBoxItem(qa.MenuItemId,qa.LabelText,qa.Styles,qa.CommandValueId,qa.AriaLabel,qa.Data,qa.Disabled))}B<h.MenuItems.MenuSectionList.length-1&&u.push(appChrome.api.comboBoxDivider("Divider-"+
B.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,u)}}Object(m.a)(ai,"ReactPopulateQueryCommandPoller",null,[]);class TD{constructor(b,h,u,B,Q){this.Cl=u;this.Jta=b;this.jA=h;this.d_b=B;this.byb=Q}W9l(b,h,u){const B=[];if(this.EHm(h))b=this.Wcm(b,h,u),void 0!==b&&null!==b&&B.push.apply(B,b);else if(b){var Q=this.RSd(b,u);Th.a.visible in u&&B.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!u[Th.a.visible]));B.push(kB(b.externalUxCommand,1>(Q&1)));
void 0!==u[Th.a.labelText]&&null!==u[Th.a.labelText]&&B.push(appChrome.actions.setControlLabel(b.externalUxCommand,u[Th.a.labelText]));void 0!==h&&null!==h&&(Q=Cu(b.externalUxCommand,h,u,Q),void 0!==Q&&null!==Q&&B.push.apply(B,Q),"PeopleWell"===h&&this.lsk(b.externalUxCommand,u,B))}return B}NUl(b,h,u){const B=[];switch(h){case "FlyoutAnchorModel":var Q=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(b);if(ca=this.Cl.getCommandByExternalUxId(ca.command))u=
this.Jta.b3c(this.jA,ca.commandId,u),B.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!u)),B.push(kB(b,!1));return B;default:return null}h=!1;for(ca in Q)if(Q=this.Cl.getCommandByExternalUxId(ca),Le.c(Q))h=!0;else if(u.SourceControlId=Q.externalUxCommand,this.Jta.b3c(this.jA,Q.commandId,u))return B.push(kB(b,!1)),B;B.push(kB(b,!h));return B}Wcm(b,h,u){switch(h){case "PreviewGalleryModel":return this.byb.E8l(b,u);case "GalleryModel":return this.byb.CXl(u)}return null}EHm(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}RSd(b,h){h.MenuItemId=b.menuItemId;return this.Jta.Bqa(this.jA,this.d_b,b.commandId,b.queryCommandId,h)}lsk(b,h,u){const B=h[wj.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[wj.a.LabelText];B&&0<B.length&&(h=String.format.apply(null,[h].concat(B)));u.push(this.mhm(b,h))}mhm(b,h){return appChrome.actions.updatePeopleWell(this.EPl(b),h)}EPl(b){const h=[];var u={};b=this.Cl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Jta.Bqa(this.jA,this.d_b,
"1285265560",b,u);u=u.MenuItems;if(!u)return h;u=u.MenuSectionList[0];for(b=0;b<u.ControlList.length;b++){const B=u.ControlList[b],Q={};Q.name=B.Alt;Q.id=B.MenuItemId;Q.description=B.Description;Q.color=B.ImageBackColor;Q.joinTime=B.JoinTimeInMS;Q.imageUrl=B.ImageUrl;Q.activeStatus=B.ActiveStatus;Q.isAnonymous=B.IsAnonymous;Q.canJump=B.CanJump;Q.upn=B.Upn;h.push(Q)}return h}}Object(m.a)(TD,"ReactQueryCommandPoller",null,[]);var vF=c(1130);class Tj{constructor(b,h,u){this.Cl=b;this.jA=h;b=new vF.a;
this.Zik=new pD;this.byb=new nD(b,this.jA,u,this.Cl);this.Xah=new ai(b,this.jA,u,this.Cl,this.byb);this.Mah=new TD(b,this.jA,this.Cl,u,this.byb)}jFa(){const b=[];if(!ah.c())return b;b.push.apply(b,this.khm());var h=this.NTl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const u=this.OTl();for(const B of u)b.push(appChrome.actions.updateControlEnabledDisabledState(B,!0)),delete h[B];b.push.apply(b,this.hUd(h))}return b}c3c(b,h){ah.c()&&
(b=this.hUd(b,h),appChrome.api.dispatch(b))}f0f(b,h,u=null){if(!Le.c(b)&&b.populationProps&&!this.Xah.isj(b)){b=this.Xah.X9l(b,h,u);if(!b.RIj){let B;(B=b.actions).push.apply(B,this.hUd(b.dFh,ah.g(u)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}hUd(b,h=0){const u=[],B={};if(ah.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var Q of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(Q))B[ca]=
!0;for(let qa in b)Q=qa,ca=b[qa],0===h&&B[Q]&&(h=2),u.push.apply(u,this.jhm(Q,ca,h));return u}jhm(b,h,u=0){const B=[],Q=this.Cl.getCommandByExternalUxId(b);let ca={};appChrome.selectors.isControlDefined(b)&&(ca=this.Zik.kgi(b,h));ca[av.a.J8a]=u;Le.c(Q)?(ca.ExternalUxId=b,(b=this.Mah.NUl(b,h,ca))&&0<b.length&&B.push.apply(B,b)):(ca.MenuItemId=Q.menuItemId,ca.SourceControlId=b);B.push.apply(B,this.Mah.W9l(Q,h,ca));return B}khm(){const b=[],h=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),u=appChrome.selectors.getContextualTabIds();let B=[];h&&(B=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<u.length;ca++){var Q=this.Cl.Otf(u[ca]);if(Q){Q=this.jA.nGa(Q);let qa=!0;h&&(qa=0<=Array.indexOf(B,u[ca]));h&&qa===Q||b.push(appChrome.actions.activateDeactivateContextualTab(u[ca],Q))}}return b}NTl(){var b=appChrome.selectors.getSelectedTabId();const h=[],u=this.Cl.Otf(b);
u&&(this.jA.nGa(u)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}OTl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const u of b)if(b=this.Cl.UXl(u))for(const B of b)this.jA.nGa(B.commandId)||((b=B.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(B.externalUxGroupId)),h.push.apply(h,b));return h}}Object(m.a)(Tj,"ReactRibbonRootPoller",null,[867]);class UD{constructor(b,h,u=null){this.jA=this.ABa=this.Pcb=null;this.LZb=
h;b.vNa(this);this.CF=u}get Mpa(){this.ABa||(this.ABa=new Date,this.ABa.setTime(0));return this.ABa}set Mpa(b){this.ABa=b}get p$(){return 2}get CF(){return this.jA}set CF(b){this.jA=b}get ric(){this.Pcb||(this.Pcb=new Tj(this.LZb,this.CF,this.p$));return this.Pcb}Kfb(){const b=document.activeElement;kc.a.isEditable(b)&&b.blur()}executeCommand(b,h,u,B,Q,ca,qa,Qa=2){Le.c(this.CF)||(Q=new ur.a,Q.CommandLocation=Qa,Q.InvocationMethod=B,Q.CommandTabName=u,h[av.a.J8a]=Qa,this.CF.XOa(b,h,Q,ca,qa),this.R1m(b,
h))}jFa(){return Le.c(this.CF)?[]:this.ric.jFa()}Bm(){const b=this.jFa();0<b.length&&(this.Mpa=new Date,appChrome.api.dispatch(b))}xcd(){ah.c()&&this.ric.c3c({PeopleWell:"PeopleWell"},18)}pcd(){}R1m(b,h){try{const u=Ga.a.instance.Oa("Common.ISystemInitiatedFeedback");if(u&&h){const B=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let Q=(B?"_"+B:"")+(h.SqmControlId?"_"+h.SqmControlId:"");Q=Q.length?Q:"_"+b;u.yLf("Ribbon"+Q)}}catch(u){r.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(u?u.toString():""))}}}Object(m.a)(UD,"ReactRibbonRoot",null,[672,866]);var qD=c(1636);class VD{constructor(b){this.WWe=this.jCe=!1;this.C$a=null;this.uMg=!1;this.fQ=null;this.fta=!1;this.DOe=b;vf.a.instance.ob(Kd.a.Vx,this.kPc(),Object(z.a)(this,this.ykn,"onContextualUIMouseDown"));(b=Ga.a.instance.Ta("Common.IActionContextProvider"))&&b.execute(h=>{this.fQ=h});v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ua.Lb.IJ?Yk.a.get_instance().lk(16,
()=>{this.P4?this.initializeContextualUI(this.kPc()):Yk.a.get_instance().lk(7,()=>{this.initializeContextualUI(this.kPc())})}):Yk.a.get_instance().lk(7,()=>{this.initializeContextualUI(this.kPc())})}get C0(){return this.fta}get P4(){return v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ua.Lb.IJ?Yk.a.get_instance().isCompleted(16)&&Yk.a.get_instance().isCompleted(7):Yk.a.get_instance().isCompleted(7)}ZQk(){if(this.uMg)return!0;try{return Promise.resolve(null),
this.uMg=!0}catch(b){return!1}}$mg(b){if(!this.P4||this.WWe)return this.uMf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.ZQk())return this.uMf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(v.AFrameworkApplication.IKd||""!==v.AFrameworkApplication.nu)if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===v.AFrameworkApplication.nu||"ContentAssemblyView"===v.AFrameworkApplication.nu)return this.uMf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),
!0;this.WWe=!0;let h=Za.a.Gg;switch(b){case 1:h=Za.a.showContextMenu;break;case 0:h=Za.a.showFloatie;break;case 2:h=Za.a.klc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.WWe=!1;Fe.c(h)},0)});return!1}Lii(b){return mk.UISurfaces.R1a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const u=[];for(const B of b)Array.contains(h,B)||u.push(B);return u}return b})}showFloatie(b,h,u,B=null){this.$mg(0)||this.Lii(h).then(Q=>
{if(0>=Q.length)return null;this.Xdg(Q).then(()=>{const ca={};ca.target=b;mk.UISurfaces.R1a().then(qa=>{appChrome.api.dispatch(qa.showFloatie(ca,u,void 0,this.arf(),B));this.fta=!0;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&v.AFrameworkApplication.va&&v.AFrameworkApplication.va.processAction(Za.a.HIi,2);return null})});return null})}showContextMenu(b,h,u=null,B=null){this.$mg(1)||this.aqj(b,h,u,B)}aqj(b,h,u=null,B=null){this.Xdg(null).then(()=>
{const Q={};Q.target=b;B&&(Q.directionalHint=B);mk.UISurfaces.R1a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(Q,h,u,void 0,this.arf()));return null})})}jlc(b,h,u,B=null){this.$mg(2)||this.Lii(h).then(Q=>{0>=Q.length?this.aqj(b,u,B):this.Xdg(Q).then(()=>{const ca={};ca.target=b;const qa={};qa.target=b;mk.UISurfaces.R1a().then(Qa=>{appChrome.api.dispatch(Qa.showContextualUI(ca,qa,u,void 0,B,this.arf()));this.fta=!0;return null})});return null})}uMf(b){r.ULS.sendTraceTag(561394519,340,15,b)}oLc(){this.P4&&
mk.UISurfaces.isLoaded()&&mk.UISurfaces.R1a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.P4&&mk.UISurfaces.isLoaded()&&mk.UISurfaces.R1a().then(b=>{this.fta=!1;appChrome.api.dispatch(b.hideFloatie());return null})}s6b(){this.P4&&mk.UISurfaces.isLoaded()&&mk.UISurfaces.R1a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.fta=!1;return null})}initializeContextualUI(b){return mk.UISurfaces.R1a().then(h=>{this.jCe||(h.initializeContextualUI(b),
this.jCe=!0);return null})}Xdg(b){if(!this.jCe)return this.initializeContextualUI(this.kPc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var u=[];mk.UISurfaces.R1a().then(B=>{u.push.apply(u,this.DOe.ric.hUd(B.selectors.getFloatieOnlyControlsMap(),9));0<u.length&&appChrome.api.dispatch(u);return null})}}kPc(){if(this.C$a)return this.C$a;
this.C$a=qD.a("div");this.C$a.id="ReactContextualUIDiv";this.C$a.style.position="absolute";this.C$a.style.zIndex="1001";document.body.insertBefore(this.C$a,document.body.firstChild);return this.C$a}ykn(b){b.Hb&&b.Hb.target&&"input"===b.Hb.target.tagName.toLowerCase()&&hd.FocusManager.instance().iD("ribbon");return!1}arf(){return this.fQ?this.fQ.contentType:"Unknown"}}Object(m.a)(VD,"ReactContextualUILauncher",null,[868]);class wF extends Cm.a{constructor(){super()}}Object(m.a)(wF,"FloatieBuildOptions",
Cm.a,[]);class xF extends Ot.a{constructor(){super()}}Object(m.a)(xF,"FloatieBuildContext",Ot.a,[]);var cG=c(652);class yF extends Be.Builder{constructor(b,h,u){super(b,h,u,null);if(Le.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}Wmo(b){this.root=b}NLk(){const b=new xF,h=new wu.a;h.L4c=1;h.handler=Object(z.a)(this,this.Oqn,"onReturnFloatieData");h.data=b;this.Fva.see(h)}Oqn(b){this.OLk(b.e4c,b.eJc);this.floatie.S_h=this;this.floatie.Cm();
this.floatie.Mc.style.display="none";this.placeholder.appendChild(this.floatie.Mc);this.Pua.continueWith(()=>{this.Pua.result.QLb(this.floatie)},11);Hh.a.instance.ob(Kd.a.pointerDown,this.floatie.Mc,Object(z.a)(this.floatie,this.floatie.eD,"onPointerDown"))}OLk(b,h){b=lh.a.Aha(b,lh.a.dNj);if(Le.c(b))throw Error.create("No floatie element was present in the data");b=new lh.a(b);this.Wmo(new Fv(b.attributes[lh.a.id],b.attributes));b=lh.a.Aha(b.node,lh.a.Ppe);this.q4e(b,h)}q4e(b,h){b=lh.a.uw(b);for(let u=
0;u<b.length;u++){if(this.YQa(b[u]))continue;const B=this.x4e(b[u],h);this.floatie.xf(B)}}x4e(b,h){var u=new lh.a(b);b=new cG.Group(this.floatie,u.attributes[lh.a.id],u.attributes[lh.a.FVa],u.attributes[lh.a.jpc],u.attributes[lh.a.AVa],!1,u.name===lh.a.zQj,!1,u.attributes);u=lh.a.uw(u.node);for(let B=0;B<u.length;B++)b.xf(this.GDd(u[B],h));return b}GDd(b,h){b=new lh.a(b);var u=b.attributes[lh.a.id];b=lh.a.uw(b.node);var B=2;2===b.length&&(B=3);u=new wl.a(this.floatie,u,B,2,1);for(B=0;B<b.length;B++){const ca=
new lh.a(b[B]);var Q=lh.a.Aha(ca.node,lh.a.Trb);Q=lh.a.uw(Q);this.D4e(u.jTd(B+1),Q,ca.attributes[lh.a.id],h)}return u}D4e(b,h,u,B){for(u=0;u<h.length;u++){if(this.YQa(h[u]))continue;const Q=new lh.a(h[u]),ca=this.tga(h[u],B);ca&&b.xf(ca.YQ(Q.attributes[lh.a.kpc]))}}}Object(m.a)(yF,"FloatieBuilder",Be.Builder,[]);class TC{constructor(b,h){this.Av=null;this.y_k=b;this.Fwe=h;this.Uln=this.x6d.bind(this)}get floatie(){return this.Av}Mfb(b,h,u){h=new Fm.CuiHelper(xk.a.u_a,Box4Intl.Box4Strings,null,null,
h);const B=new wF;B.$G=u||{};B.$G.floatieshadingColor=!1;const Q=new yF(B,document.body,this.y_k.hej);Q.Fva=new sy.a(b,h);Q.NLk();this.Fwe.execute(ca=>{Q.floatie.CF=ca});Q.floatie.vUn(this.Uln);Q.floatie.JTn(()=>[]);this.Av=Q.floatie;return this.floatie}}Object(m.a)(TC,"AFloatieInitializer",null,[]);class zF extends TC{constructor(b,h,u,B){super(h,u);this.X_f=()=>{this.floatie.Bm()};this.Lh=b;this.DI=B}Mfb(b,h,u){if(b=super.Mfb(b,h,u))b.Nhc=!0,b.E$d=!0,b.preventDismissOnScroll=!0;this.Lh.YZa(this.X_f);
return b}WTc(b,h,u=null){this.DI.Fvh(()=>this.Mfb(b,h,u))}x6d(){this.floatie.Nhc=!0}}Object(m.a)(zF,"PasteFloatieInitializer",TC,[]);var AF=c(818);class Fx{tza(b,h){this.BRk&&this.uto(b,h,Fx.dOf,Fx.lb)}uto(b,h,u,B){switch(u){case 1:case 6:case 2:case 3:case 4:Fx.cgf.show(B,b,h)}}OMi(){switch(Fx.dOf){case 5:case 1:return!0;default:return!1}}ffl(){return Fx.dOf}get BRk(){return 1!==Fb.App.za.state}static get cgf(){return null!=Fx.Twg?Fx.Twg:Fx.Twg=Ga.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static o2l(b){if(!b)return 0;
if(2===Fb.App.za.mode){const h=b.Pa.node,u=vd.GraphIterator.eb(h);u.gp();return Ii.e(u.currentNode)?2:v.AFrameworkApplication.MSb||!sl.isEmbeddedFileNode(h)||sl.isInvalid(h)?Hi.a.ULm(b.Pa)||Hi.a.LDf(b.Pa)?6:1:3}return 4}static get lb(){return xf.a.instance.hb.lb}static get dOf(){return Fx.o2l(Fx.lb)}}Object(m.a)(Fx,"SelectionContextMenuProvider",null,[1177]);var rD=c(1854);class UC{constructor(b,h){this.E$d=this.Nhc=!1;this.uSc=!0;this.YL=b;this.Cl=h}get isVisible(){return this.YL.C0}get controls(){return null}dismissFloatie(){this.YL.dismissFloatie();
return!0}ohf(){}M7a(b,h,u,B,Q=null){this.YL.showFloatie(Object.assign(new rD.a,{x:b.x,y:b.y}),this.umf(u),u,Q)}DFb(){return new Sys.UI.Bounds(0,0,0,0)}c4(){return this.dismissFloatie()}umf(){return[]}}Object(m.a)(UC,"ReactFloatie",null,[326,327]);class VC{constructor(b){this.jid=null;this.YL=b}dispose(){}c4(){this.YL.s6b();return!0}showContextMenu(b,h){this.Rpb(b,h.clientPoint,h.hg)}Rpb(b,h,u){this.K7a(b,new Sys.UI.Bounds(h.x,h.y,0,0),u);r.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}K7a(b,h,u,B=null){this.jid?this.YL.jlc(Object.assign(new rD.a,{x:h.x,y:h.y}),this.jid.umf(u),u,b):this.YL.showContextMenu(Object.assign(new rD.a,{x:h.x,y:h.y}),u,b,B);this.jid=null}klc(b,h,u,B){this.jid=Object(Na.a)(UC,u);B.tza(b,h);return!0}e5b(){}}Object(m.a)(VC,"ReactContextMenuController",null,[538,10]);var zE=c(464);class WC{constructor(){this.Cja=this.text=this.epa=null}}Object(m.a)(WC,"BusinessBarButtonData",null,[]);class AE{constructor(){this.text=this.epa=null}}Object(m.a)(AE,"BusinessBarLinkData",
null,[]);var BF=c(245);class BE{constructor(b,h,u,B){this.KTg=this.ZQg=this.fab=this.$Og=null;this.tt=b;this.CAa=h;this.ga=u;this.Ga=B}s_f(){this.EHc();this.FHc();this.c4b()}FHc(){}EHc(){const b=Fb.App.za.jb.Yc;b&&(this.$Og=this.X8a(this.$Og,1,2===Fb.App.za.mode&&b.LCf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}fVm(){return v.AFrameworkApplication.ua&&1===v.AFrameworkApplication.ua.mode}c4b(){let b=null;const h=Fb.App.za.jb.activeSection;if(h){const u=h.c2c;BF.a.iYd(u)?22===u?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===u||20===u?b=Z.a.ri?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===u?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===u?b=Z.a.ri?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===u&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):BF.a.Bmi(h.KZa)||Fb.App.ym||this.fVm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.KTg=this.X8a(this.KTg,5,!!b,b)}uqj(b,h,u,
B){b=this.CAa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.MAd(h,()=>{Qd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+u)});B&&(b.xga=B);this.tt.qA(b,!0)}huo(b,h,u){this.uqj(b,h,u,null)}tuo(b){b=this.CAa.create(null,b,null);b.closeable=!0;b.id=20;this.tt.qA(b)}Eto(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.fab||(this.fab=this.CAa.create(b,h,null),this.fab.closeable=!0,this.fab.id=27,this.tt.qA(this.fab))}Zrm(){this.fab&&
(this.fab=this.X8a(this.fab,27,!1,""))}Jfg(b){this.ZQg=this.X8a(this.ZQg,30,!0,b)}X8a(b,h,u,B,Q=!1,ca="",qa=null,Qa=null,rb=null){u?b?b.message=B:(b=this.CAa.create(ca,B,null),b.id=h,b.closeable=Q,qa&&b.addButton(qa.text,qa.epa,qa.Cja),Qa&&b.MAd(Qa.text,Qa.epa),rb&&(b.xga=rb),this.tt.qA(b,!1)):b&&(this.tt.removeEntry(b),b=null);return b}qYe(b){this.tt.qA(b,void 0)}}Object(m.a)(BE,"BusinessBarController",null,[226]);class mB extends BE{constructor(b,h,u,B){super(b,h,u,B);this.kta=null}wqf(b,h,u=null,
B=null,Q=null,ca=2){if(this.kta)return null;this.kta=this.CAa.create(h,u||"",null);this.kta.id=6;this.kta.image=ca;this.kta.d_d=!1;b&&(this.kta.errorCode=b);this.kta.closeable=!1;h=v.AFrameworkApplication.FF&&this.Ga.$("ShowFeedbackButtonOnKickoutBusinessBar");B?(this.kta.addButton(B,Q,""),h&&this.kta.koh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.vji(b)})):h&&this.kta.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.vji(b)},"");this.tt.qA(this.kta,void 0,null,null,null);return this.kta}vji(b){r.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Rb(Za.a.giveFeedback,2,{["ErrorCode"]:b})}static get wi(){return Df.PageReader.instance}}Object(m.a)(mB,"BusinessBarController",BE,[225,226]);class nB{static get fRi(){const b=F.a.Dj(Jj.a.qg(v.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(m.a)(nB,"OdtUtils",null,[]);class CF extends mB{constructor(b,h,u,B){super(b,h,u,B);this.Usb=this.ovc=
this.X4g=this.oNa=this.c5g=this.wfh=null;this.b9j="https://go.microsoft.com/fwlink/?linkid=2134357"}s_f(){super.s_f();this.SUk()}FHc(){const b=Fb.App.za.jb.Yc;if(b){var h=Fb.App.H0;if(Fb.App.ys||Fb.App.ym||h&&v.AFrameworkApplication.mv)this.wfh=this.X8a(this.wfh,4,mB.wi.s4a(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.c5g=this.X8a(this.c5g,3,mB.wi.j4a(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.X4g=this.X8a(this.X4g,8,mB.wi.r3k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),mB.wi.NJb(b)?this.oNa||(this.oNa=this.CAa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.oNa.id=14,this.oNa.closeable=!0,this.oNa.image=3,this.oNa.addButton(Box4Intl.Box4Strings.L_LearnMore,Zj.AppFrame.YYm,""),this.tt.qA(this.oNa,!1)):this.oNa&&(this.tt.removeEntry(this.oNa),this.oNa=null)}}SUk(){if(hk.App.BWc){const b=nB.fRi,h=this.CAa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.trk(b);this.tt.qA(h,!0)}}iuo(b,h){if(Fb.App.za.jb.Yc){const u=new WC;u.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;u.epa=()=>{b()};const B=new AE;B.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;B.epa=()=>{Qd.a.openWindow(4,v.AFrameworkApplication.privacyUrl)};this.ovc=this.X8a(this.ovc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
u,B,()=>{h()})}}gsm(){this.ovc&&(this.ovc=this.X8a(this.ovc,25,!1,""))}mto(){if(Fb.App.za.jb.Yc){const b=new AE;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.epa=()=>{Qd.a.openWindow(4,this.b9j)};this.Usb||(this.Usb=this.CAa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Usb.id=32,this.Usb.closeable=!0,this.Usb.image=3,this.Usb.MAd(b.text,b.epa),this.tt.qA(this.Usb,!1))}}uY(b){return this.tt.uY(b)}qA(b,
h){this.tt.qA(b,h)}}Object(m.a)(CF,"BusinessBarController",mB,[551,225,226]);class CE{constructor(){this.menuTargetType=null}}Object(m.a)(CE,"MenuTargetDescriptor",null,[]);var Gx=c(576);class Oj extends Gx.a{constructor(b,h,u,B=!1,Q,ca=null,qa){super();this.e$d=(Qa,rb,Lb,Yb,gc)=>{if(1===Lb)return 32;Qa=gc.Qx;gc=gc.Ad;rb=Object.assign(new Rk.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.kal(rb,Qa,gc.IsShadowMenuOpen);gc.MenuItems=rb;return 32};this.NHn=h;this.zn=u;this.qdb=
ca;this.KFe=B;this.Tb(b);this.Y9a=qa;Oj.ZYa[1]=Ob.a.eje;Oj.ZYa[2]=Ob.a.zUd;Oj.ZYa[3]=Ob.a.Hje}get Drl(){return be.a.jJd}get Crl(){return be.a.FHd}get Erl(){return be.a.G9d}get agf(){return be.a.n_i}Tb(b){b.fb(Ob.a.i0f,vc.a.application,this.e$d,96);b.fb(Ob.a.V0i,vc.a.application,this.e$d,96)}show(b,h,u){let B=null,Q=new Sys.UI.Bounds(0,0,0,0);const ca=this.h9l(b);if(ca&&(b=b.Pa.node)&&(b=b.pe(nb.InteractiveViewManager.instance.zd.$b))){Q=dj.a.Tq(b,ca.end);if(v.AFrameworkApplication.isRtl&&Q.x>h.x||
!v.AFrameworkApplication.isRtl&&Q.x+Q.width<h.x||Q.y+Q.height<h.y)Q=dj.a.Tq(b,ca.end-1);h.x=Q.x+(v.AFrameworkApplication.isRtl?0:Q.width);h.y=Q.y+Q.height;B=6}Gx.a.K7a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,Q.width,Q.height),u,B)}n0(b,h){return this.g$c(b)||Oj.CHc(Ob.a.mergeCells)||Oj.CHc(Ob.a.FIa)||this.ugg(b)||this.Wpj(b,h)||Oj.Lqj()||Oj.zqj(b).returnValue}g$c(b){return 2===Fb.App.za.mode&&this.sWc(b)}bKc(b,h,u=null){if(mt.LB()&&2===Fb.App.za.mode){h=this.Y9a.mIh(b.Pa);if(!h||!this.kRm()&&!this.ISm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.g$c(b))return;h=this.Udi(b)}var B=Jj.a.qg(h.lcid);const Q=B?B.name:"UNKNOWN";B=Object(Cb.a)(Il.a,h)?h.typeId:"";r.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,B,Q);if(b=this.NHn.s5b(b,h))u.push.apply(u,b),this.p5m(h,B)}ISm(b){return b&&(1===b.proofingType||2===b.proofingType)}kRm(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}p5m(b,h){const u=Oj.ZYa[b.proofingType];u&&(v.AFrameworkApplication.va.processAction(u,2),r.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",u,h,b.proofingType,mt.LB()))}Udi(b){return this.zn.noa(b.Pa).errorDetails}sWc(b){return this.zn.afe(b)}b9b(){return null}eId(){}h9l(b){return this.sWc(b)?this.zn.noa(b.Pa):(b=this.b9b(b))?new Ec.a(b.Mp,b.cpEnd):null}ugg(b){if(2!==Fb.App.za.mode||!b)return!1;b=MA.a.TDa(b.toArray());
return!!Oj.Xg.HT(b,14)}prj(b,h){return 2===h||3===h&&!this.sWc(b)}Wpj(b,h){return 3!==h||this.sWc(b)}T7k(){const b=[];b.push(Object.assign(new yg.a,{ExternalId:this.Drl}));b.push(Object.assign(new yg.a,{ExternalId:this.Crl}));b.push(Object.assign(new yg.a,{ExternalId:this.Erl}));return b}qbl(){const b=[];this.KFe&&b.push(Object.assign(new yg.a,{ExternalId:this.agf}));return b}static get Fd(){return null!=Oj.MCg?Oj.MCg:Oj.MCg=Ga.a.instance.resolve("Box4.List.IListReader")}static get Xg(){return On.ContextSetEditor.instance}static get TLm(){null==
Oj.gFe&&(Oj.gFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Oj.gFe}static get d0c(){null==Oj.dsb&&(Oj.dsb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Oj.dsb}static get vua(){null==Oj.V$&&(Oj.V$=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Oj.V$}static CHc(b){return 32===v.AFrameworkApplication.va.processAction(b,
1)}static Lqj(){return 2===Fb.App.za.mode&&!!Fb.App.Gv.$I&&Fb.App.Gv.$I.hXc(Ob.a.q8d.toString())}static Nqj(b){if(1!==b.length||!b.Pa.Vk)return!1;b=vd.GraphIterator.eb(b.Pa.node);b.zb(11);b.rc();return b.Fs(4)&&!Oj.Fd.tw(b).listType?!0:!1}static zqj(b){let h=!1,u=!1;if(!b)return{returnValue:!1,ujb:h,cTc:u};if(Oj.d0c)return Oj.suo(b,u);if(!(b.Vw||Oj.TLm&&2===b.length&&b.Rc.contextId===vc.a.Uc))return{returnValue:!1,ujb:h,cTc:u};b=b.Pa.clone();h=32===v.AFrameworkApplication.va.Kf(b,Ob.a.O5a,1,!0,null,
null);u=32===v.AFrameworkApplication.va.Kf(b,Ob.a.insertHyperlink,1,!0,null,null);return{returnValue:h||u,ujb:h,cTc:u}}static suo(b,h){let u;h=b.Pa.clone();u=Oj.vua&&Hq.l(h);let B=!u&&32===v.AFrameworkApplication.va.Kf(h,Ob.a.O5a,1,!0,null,null);if(b.Vw||2===b.length&&b.Rc.contextId===vc.a.Uc)h=!u&&32===v.AFrameworkApplication.va.Kf(h,Ob.a.insertHyperlink,1,!0,null,null);else{h=!0;const Q=b.length;for(let ca=0;ca<Q;ca++){const qa=b.J(ca).clone();if(qa.contextId===vc.a.paragraph||qa.contextId===vc.a.Jd)(u=
Oj.vua&&Hq.l(qa))||(h=32===v.AFrameworkApplication.va.Kf(qa,Ob.a.insertHyperlink,1,!0,null,null)&&h);else if(qa.contextId!==vc.a.Uc)return h=B=!1,{returnValue:!1,ujb:B,cTc:h}}}return{returnValue:B||h,ujb:B,cTc:h}}static $Rd(b){const h=Object.assign(new wh.a,{ControlList:[]});for(const u of b)h.ControlList.push(Object.assign(new yg.a,{ExternalId:u}));return h}static AG(b){const h=[];for(const u of b)h.push(Object.assign(new yg.a,{ExternalId:u}));return h}}Oj.gFe=null;Oj.dsb=null;Oj.V$=null;Oj.ZYa=
[];Object(m.a)(Oj,"AEditSurfaceContextMenu",Gx.a,[]);var vt=c(599),Ys=c(867),cM=c(1780);class dG{static s8l(b,h,u){h=[];u.rEn.s5b(u.nLl(b),h);return h}static GTl(b,h,u){const B=[];if(u.g$c(b))return B;Jp.a.OQa()&&!Z.a.Kt||u.Tdf.eId(b,null,h,B);return B}static Ecm(b,h,u){const B=[];u.bKc(b,h,B);return B}}Object(m.a)(dG,"ContextMenuSectionHelper",null,[]);class br{static tTl(b,h,u){h=[];u.Nkl(b)&&h.push(Object.assign(new yg.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:u.G$l(b)}));return h}static x2l(){return Oj.CHc(Ob.a.mergeCells)?
Oj.AG(["MergeCells"]):Oj.CHc(Ob.a.jje)?Oj.AG(["SplitCells"]):[]}static ogm(b,h,u){h=[];if(!u.Dh.cHh(b))return h;b=u.Dh.$hi(b);h.push(Object.assign(new yg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new yg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,
b)}));return h}static tOl(b,h,u){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Pa&&b.Pa.node&&u.Hc&&u.Hc.cQi(b.Pa.node)?Oj.AG(["ShowCatchUpActivitiesForParagraph"]):[]}static nUl(b){return pp.Ito(b)?Oj.AG(["Draw"]):pp.Dqj(b)?Oj.AG(["EditIllustration"]):[]}static kjm(b){return pp.fwo(b)?[Object.assign(new ee.a,{ExternalId:"WrapTextMenu"})]:[]}static aTd(b,h,u){return u.ell(b)?Oj.AG(["CreatePullQuote"]):[]}static getContentControls(b,h,u){return u.Mkl()?Oj.AG(["RemoveContentControl"]):
[]}static cQl(){return Oj.AG(["NewComment"])}static NOl(b){const h=[];!pp.tgg(b)&&pp.Wfg(b)&&fc.SessionStatusManager.instance.WH&&b.VH&&h.push(Object.assign(new ee.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static o_l(b,h,u){h=[];!pp.tgg(b)&&pp.Wfg(b)&&fc.SessionStatusManager.instance.WH&&(r.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.VH&&!v.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?h.push(...Oj.AG(["ChangePicture"])):
h.push(...u.s$k().ControlList),(b=pp.u$h())&&0<b.length&&(u=u.$cl(b),null!=u&&h.push(...u.ControlList)));return h}static e9l(){return Oj.Lqj()?Oj.AG(["SetProofingLanguage"]):[]}static Q$l(b,h,u){return u.jRm&&u.ovo(b)?Oj.AG(["Rewrite"]):[]}static Y0l(b){return Oj.Nqj(b)?Oj.AG(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static V6l(){return pp.brj()?Oj.AG(["ParagraphOptions"]):[]}static hZl(b){return pp.Dqj(b)?Oj.AG(["EditIllustration"]):[]}static vcm(b){return pp.tgg(b)?Oj.AG(["ShowSmartLookupPane"]):
[]}static zgm(b){return pp.Rqj(b)?Oj.AG(["ModernTranslatorSplitButton"]):[]}static qYl(b,h,u){h=[];if(b.Vw){const B=b.Pa;if(B.contextId===vc.a.paragraph||B.contextId===vc.a.Tc||B.contextId===vc.a.Jd){b=b.Pa.node;if(!u.aj.Wb(b)||b.Dr||""===b.characterData)return h;u.nff.eRd(b)&&h.push(...Oj.AG(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,u){h=[];if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Vw){const B=b.Pa;(Ge.SelectionEditor.ef(B)||
Ge.SelectionEditor.E3a(B))&&u.KJk.BQd(b.Pa.node,b.Pa.cpBegin)&&(h.push(...Oj.AG(["DeleteBookmarkContextMenu"])),h.push(...Oj.AG(["EditBookmarkNameContextMenu"])))}return h}static Dha(b){let h=!1,u=!1;const B=[];({ujb:h,cTc:u}=Oj.zqj(b)).returnValue&&(h?u?B.push(...Oj.AG(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):B.push(...Oj.AG(["OpenHyperlink"])):u&&(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost")?
B.push(...Oj.AG(["InsertLinkFlyout"])):B.push(...Oj.AG(["InsertLink"]))));return B}static yPl(b,h,u){const B=[];if(!u.Wpj(b,h))return B;2===Fb.App.za.mode?(B.push(...u.T7k()),B.push(...u.qbl()),3===h&&u.sWc(b)&&B.push(Object.assign(new yg.a,{ExternalId:"Delete"}))):(!v.AFrameworkApplication.UY&&!v.AFrameworkApplication.xF||v.AFrameworkApplication.RDb)&&B.push(Object.assign(new yg.a,{ExternalId:"Copy"}));return B}static Hmf(b,h,u){return u.ugg(b)&&u.prj(b,h)?Oj.AG(["EditTableAltText"]):[]}static y$h(b,
h,u){return u.Xkl(b)?Oj.AG(["ShowIntentSuggestion"]):[]}static vem(b,h,u){const B=[];u.ugg(b)&&!u.prj(b,h)&&(B.push(Object.assign(new ee.a,{ExternalId:"InsertTableMenu"})),B.push(Object.assign(new ee.a,{ExternalId:"DeleteTableMenu"})),B.push(Object.assign(new ee.a,{ExternalId:"SelectTableMenu"})));return B}static Bem(b,h,u){return u.Hvo(b)?Oj.AG(["UpdateTableOfContents"]):[]}static ZUl(b){return pp.Oto(b)?Oj.AG(["ShowHideEquationToolsPane"]):[]}}Object(m.a)(br,"ContextMenuSectionItemHelper",null,
[]);class pp extends Oj{get aj(){return this.gb}get nff(){return this.EWa}constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd,Ie,fe,de=!1,ne=null,ye=null,Vf,Og,Bl,sm){super(b,h,u,de,void 0,ne,Vf);this.cKd=sm;this.LNe=this.fQ=null;this.UWg=!1;this.Nee=new Map;this.kE={};this.mmb={};this.ga=b;this.K=B;this.Dh=Q;this.EW=Qa;this.HI=rb;this.Nn=Lb;this.jmk=!!ne;this.Tdf=Yb;this.rEn=gc;this.IQg=Hd;this.Yka=Ie;this.KJk=fe;this.EWa=Bl;this.gb=Og;ld&&ld.execute(op=>{this.tdh=op});Fc&&Fc.execute(op=>{this.LNe=
op});this.Hc=qa;this.Xu=Sc;ye&&ye.execute(op=>{this.fQ=op});this.kxm();this.pCn();this.Tzl();this.oCn()}get agf(){return this.jmk?be.a.D9d:super.agf}Mro(){const b=hk.App.hn.jb.qc.mb.hb.lb;return this.g$c(b)&&2!==this.Udi(b).errorType}n0(b,h){return super.n0(b,h)||pp.brj()||Oj.Nqj(b)||pp.Wfg(b)||pp.Rqj(b)}kal(b,h,u){const B=[];let Q=null;try{Q=hk.App.hn.jb.qc.mb.hb.lb}catch(ca){r.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.dCn(Q,
h,B,this.nRl(Q));b.MenuSectionList.push(...B);this.vio(b);!u&&this.tdh&&this.tdh.iGn(b.MenuTargetDescriptor.menuTargetType,B)}nRl(b){return Oj.CHc(Ob.a.mergeCells)?Rw.Rtg:b.KVc?Rw.psg:b.VH?Rw.gtg:b.jdc()?Rw.ksg:pp.jDf&&b.M3a?Rw.esg:Rw.usg}t$k(b){b=pp.H$k(b);return Object.assign(new yg.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}adl(b){return(b=pp.eMj(b))?Object.assign(new yg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}s$k(){const b=Object.assign(new wh.a,{ControlList:[]}),h=pp.u$h();
b.ControlList.push(this.t$k(h));return b}$cl(b){const h=Object.assign(new wh.a,{ControlList:[]});if(b&&0<b.length){b=this.adl(b);if(null==b)return null;h.ControlList.push(b)}return h}Edc(b){return b.VH||2<b.length||!b.length||2===b.length&&!Ge.SelectionEditor.Fk(b.Rc)||1===b.length&&Ge.SelectionEditor.Fk(b.Rc)?!1:this.AHf(b.Pa)}AHf(b){return me.ParagraphReader.Wb(b.node)?""!==me.ParagraphReader.text(b.node).trim():!1}Hvo(b){var h=vd.GraphIterator.eb(b.Pa.node);h=Object(Na.a)(vt.a,h.currentNode);return b.VH?
!1:!!h&&h.Dr}Tzl(){v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Xu.execute(b=>{b.isFeatureEnabled(Ys.a.oPi,!1).then(h=>{h||r.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.UWg=h;return null})}):r.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get jRm(){v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");
return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.UWg:!1}ovo(b){if(!this.Edc(b)||b.M3a||b.jdc())return!1;b=b.Pa;if(me.ParagraphReader.nm(b)||Ge.SelectionEditor.ef(b)||Ge.SelectionEditor.nl(b)){b=this.HI.eFa(b);b||(b=v.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Xkl(b){if(1!==
b.length||Z.a.Kt)return!1;const h=Jp.a.OQa();if(h&&this.Mro()||mt.LB()&&!this.Y9a.mIh(b.Pa))return!1;const u=pp.Zb.isFeatureEnabled(64);return b.J(0).contextId===vc.a.Tc&&(h||u)&&0<this.Nn.eQc(b.J(0),0).count||h&&this.b9b(b)?!0:!1}Nkl(b){return 1===b.length&&this.IQg.FA(b.Pa.node).gia}G$l(b){var h,u;const B=null===(h=this.cKd)||void 0===h?void 0:h.sU(null===(u=null===b||void 0===b?void 0:b.Pa)||void 0===u?void 0:u.node);return cM.a.Uhi(B)}get Kv(){return null!=this.Ewg?this.Ewg:this.Ewg=Ga.a.instance.Oa("WordEditor.Designer.IDesignerTaskPane")}ell(b){if(!this.Yka.yvi()||
!this.Kv||this.Kv.isVisible||!(1===b.length||2===b.length&&Ge.SelectionEditor.Fk(b.Rc))||b.slb||!Ge.SelectionEditor.nl(b.Pa)&&b.Pa.contextId!==vc.a.paragraph||b.YAi()||this.IQg.FA(b.Pa.node).gia)return!1;const h=me.ParagraphReader.text(b.Pa.node),u=b.Pa.contextId===vc.a.paragraph?0:b.Pa.cpBegin,B=b.Pa.contextId===vc.a.paragraph?h.length:b.Pa.cpEnd-u;return 1>B||1500<B||F.a.Xe(F.a.Uya(h.substr(u,B)))||1!=Xq.a.rib(b.Pa.node)?!1:!0}Mkl(){return 32==this.ga.processAction(Ob.a.J5c,1)}b9b(b){return this.Tdf.b9b(b)}eId(b,
h,u,B=null){this.g$c(b)||this.Tdf.eId(b,h,u,B)}nLl(b){return this.LNe?this.LNe.oLl(b):[]}vio(b){const h=this.fQ?this.fQ.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new CE,{menuTargetType:h})}static get Zb(){return null!=pp.Sxg?pp.Sxg:pp.Sxg=Ga.a.instance.resolve("Box4.IFeatureHelper")}static get jDf(){if(null!=pp.PBg)var b=pp.PBg;else{var h;b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);
b=pp.PBg=b}return b}static Wfg(b){return v.AFrameworkApplication.u0&&!b.M3a&&Ga.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").LUm()}static bTd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Jz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static H$k(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=pp.bTd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static eMj(b){b=
pp.bTd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static u$h(){const b=(new Am.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static Dqj(b){const h=pp.Zb.isFeatureEnabled(51);return!b.YIc&&h&&!Z.a.Kt&&(b.M3a||h&&!pp.jDf&&b.VH)}static Ito(b){const h=pp.Zb.isFeatureEnabled(51);return!b.YIc&&h&&!Z.a.Kt&&pp.jDf&&b.VH}static tgg(b){return v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&
!b.jdc()}static Rqj(b){return v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.M3a&&!b.jdc()}static Oto(b){return b.ZAi()&&v.AFrameworkApplication.ua.Lb.$Wc}static brj(){return 2===hk.App.hn.mode}static fwo(b){return b.VH}dCn(b,h,u,B){this.mmb[B].forEach(Q=>{const ca=Object.assign(new wh.a,{ControlList:[]}),qa=ca.ControlList;Q.forEach(Qa=>{Qa instanceof Eu?u.push(...this.Nee.get(Qa)(b,h,this)):qa.push(...this.kE[Qa](b,h,this))});(null===qa||void 0===qa?0:qa.length)&&u.push(ca)})}oCn(){this.Nee.set(Eu.oTb,
dG.s8l);this.Nee.set(Eu.Jpe,dG.GTl);this.Nee.set(Eu.yqe,dG.Ecm)}pCn(){this.kE[Uh.Urb]=br.yPl;this.kE[Uh.Cqe]=br.vem;this.kE[Uh.Dqe]=br.Bem;this.kE[Uh.Ipe]=br.tTl;this.kE[Uh.cqe]=br.x2l;this.kE[Uh.upe]=br.Hmf;this.kE[Uh.Vpe]=br.o_l;this.kE[Uh.Bed]=br.y$h;this.kE[Uh.Upe]=br.hZl;this.kE[Uh.xqe]=br.vcm;this.kE[Uh.Fqe]=br.zgm;this.kE[Uh.jqe]=br.e9l;this.kE[Uh.mqe]=br.Q$l;this.kE[Uh.Ded]=br.Y0l;this.kE[Uh.Ged]=br.V6l;this.kE[Uh.kqe]=br.aTd;this.kE[Uh.med]=br.getContentControls;this.kE[Uh.are]=br.kjm;this.kE[Uh.Kpe]=
br.nUl;this.kE[Uh.Bpe]=br.NOl;this.kE[Uh.Eqe]=br.ogm;this.kE[Uh.Ape]=br.tOl;this.kE[Uh.ked]=br.getBookmark;this.kE[Uh.Qpe]=br.qYl;this.kE[Uh.Spe]=br.Dha;this.kE[Uh.Srb]=br.cQl;this.kE[Uh.Bed]=br.y$h;this.kE[Uh.Lpe]=br.ZUl}kxm(){const b=[Uh.cqe,Uh.upe,Uh.Cqe];this.mmb[Rw.Rtg]=[[Uh.Urb],b,[Uh.Srb],[Eu.oTb],[Uh.med]];this.mmb[Rw.gtg]=[[Uh.Urb],[Uh.Bpe,Uh.Kpe,Uh.are],b,[Uh.Srb],[Eu.oTb]];this.mmb[Rw.ksg]=[[Uh.Lpe],[Uh.Ded,Uh.Ged],[Uh.ked,Uh.Srb],[Eu.oTb]];this.mmb[Rw.usg]=[[Uh.Bed],[Uh.Ipe],[Eu.yqe],
[Eu.Jpe],[Uh.Urb],[Uh.Vpe,Uh.Upe,Uh.xqe,Uh.Fqe],[Uh.jqe,Uh.mqe,Uh.Ged],[Uh.Ded],b,[Uh.med],[Uh.Spe,Uh.ked,Uh.Qpe,Uh.Srb],[Uh.kqe],[Uh.Eqe],[Uh.Ape],[Uh.Dqe],[Eu.oTb]];this.mmb[Rw.psg]=[[Uh.Urb],[Uh.Srb]];this.mmb[Rw.esg]=[[Uh.Urb],[Uh.Upe]];this.mmb[Rw.YNj]=[[Uh.Bed],[Uh.Ipe],[Eu.yqe],[Eu.Jpe],[Uh.Urb],[Uh.Bpe],[Uh.Kpe],[Uh.are],[Uh.Vpe],[Uh.xqe],[Uh.Fqe],[Uh.jqe],[Uh.mqe],[Uh.Lpe],[Uh.Ded],[Uh.Ged],[Uh.Spe],[Uh.cqe],[Uh.upe],[Uh.Cqe],[Uh.ked],[Uh.Qpe],[Uh.Srb],[Uh.kqe],[Uh.med],[Uh.Eqe],[Uh.Ape],
[Uh.Dqe],[Eu.oTb]]}}Object(m.a)(pp,"EditSurfaceContextMenu",Oj,[]);var Rw;(function(b){b[b.Rtg=1]="TABLE_MULTI_CELL";b[b.usg=2]="GENERIC";b[b.gtg=3]="PICTURE";b[b.ksg=4]="EQUATION";b[b.YNj=5]="LEGACY";b[b.psg=6]="FLUID";b[b.esg=7]="DRAWING"})(Rw||(Rw={}));Object(m.b)("Scenarios",Rw);class Eu{}Eu.oTb=new Eu;Eu.Jpe=new Eu;Eu.yqe=new Eu;Object(m.a)(Eu,"Sections",null,[]);var Uh;(function(b){b[b.Bed=1]="INTENT_SUGGESTION";b[b.Urb=2]="ESSENTIALS";b[b.Vpe=3]="INSIGHT";b[b.Upe=4]="ILLUSTRATION";b[b.xqe=
5]="SMART_LOOKUP";b[b.Fqe=6]="TRANSLATE";b[b.jqe=7]="PROOFING";b[b.mqe=8]="REWRITE_SUGGESTIONS";b[b.Ded=9]="LISTS";b[b.Ged=10]="PARAGRAPH_OPTIONS";b[b.cqe=11]="MERGE_SPLIT_CELLS";b[b.upe=12]="ALT_TEXT";b[b.Spe=13]="HYPERLINK";b[b.ked=14]="BOOKMARK";b[b.Qpe=15]="HEADING_LINK";b[b.Srb=16]="COMMENT";b[b.kqe=17]="PULL_QUOTE";b[b.are=18]="WRAP_TEXT";b[b.Kpe=19]="DRAW";b[b.Eqe=20]="TRACK_CHANGE";b[b.Ape=21]="CATCHUP_ACTIVITIES";b[b.Dqe=22]="TABLE_OF_CONTENTS";b[b.Ipe=23]="DESIGNER_REVIEW";b[b.Cqe=24]="TABLE_ITEMS";
b[b.Bpe=25]="CHANGE_PICTURE";b[b.Lpe=26]="EQUATION_TOOLS";b[b.med=27]="CONTENT_CONTROL"})(Uh||(Uh={}));Object(m.b)("SectionItem",Uh);class YC extends Gx.a{constructor(b,h,u){super();this.ul=null;this.n$d=(B,Q,ca,qa,Qa)=>{if(1===ca)return 32;B=[];Q=[];this.Nro()&&Q.push("InsertTabStopMenuSplitButton");this.xro()&&Q.push("ClearAllTabStops");Q.push("HideRuler");B.push(YC.$Rd(Q));Q=Object.assign(new Rk.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});Q.MenuSectionList.push(...B);
Qa.MenuItems=Q;return 32};this.ga=b;this.fn=h;this.mz=u;this.Tb()}get cbb(){return document.getElementById("WACHorizontalRuler")}get RN(){return this.fn&&this.fn.instance?this.fn.instance.ij:1}get target(){return this.ul}show(b,h){this.ul=b;Gx.a.Rpb("RulerContextMenu",b,h);r.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",YC.vP);b.set("Response","Ruler Context menu invoked.");xa.Health.instance.recordKpiUsage(YC.kpiName,1,YC.I8,b)}i$l(){var b=
0,h=(this.target.x-Qd.a.knf(this.cbb))/this.RN;h=kf.a.Sy(h,0);var u={},B=this.mz.zEb,Q=vd.GraphIterator.eb(B);Q.rd();if(!Zi.TableReader.hx(Q))return 32===this.ga.Rb(Ob.a.EHa,2,u)&&(b=u.marginLeft),h-b;b={};Q={};u=this.ga.Rb(Ob.a.G4c,2,b);var ca=this.ga.Rb(Ob.a.UNb,2,Q);if(32!==u||32!==ca)return r.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ca=Q.TablePosition;if(!ca||!b||0>=b.length)return r.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),
h;u=0;Q=vd.GraphIterator.eb(B);Q.zb(14)&&(Q.ld(16),u=Lu.a(Q,!0));B=ca.x/this.RN;for(Q=0;Q<u;Q++)B+=b[Q];return h-B}Tb(){this.ga.fb(Qc.a.n$d,vc.a.application,this.n$d,96)}Nro(){var b={},h={},u=this.ga.Rb(Ob.a.EHa,2,b),B=this.ga.Rb(Ob.a.u6a,2,h);if(32===u&&32===B){B=h.It;u=kf.a.Ki(B.Voa,0);B=1===B.specialIndentType?kf.a.Ki(B.KB,0):kf.a.Ki(B.KB-B.hea,0);const Q=kf.a.Ki(b.marginLeft,0);b=kf.a.Ki(b.marginRight,0);const ca=Qd.a.knf(this.cbb),qa=Qd.a.x4h(this.cbb);h.isRtl?(h=ca+this.RN*Math.max(b,b+u),u=
qa-this.RN*Math.max(Q,Q+B)):(h=ca+this.RN*Math.max(Q,Q+B),u=qa-this.RN*Math.max(b,b+u));if(this.target.x>=h&&this.target.x<=u)return!0}return!1}xro(){var b={};if(32!==this.ga.Rb(Qc.a.HNb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static $Rd(b){const h=Object.assign(new wh.a,{ControlList:[]});for(const u of b)h.ControlList.push(Object.assign(new yg.a,{ExternalId:u}));return h}}YC.I8="wwaengidc";YC.kpiName="WordRuler";YC.vP="RulerContextMenu";Object(m.a)(YC,"RulerContextMenu",Gx.a,
[549]);let pB;class Jq{static get uc(){return null!=Jq.mIg?Jq.mIg:Jq.mIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get qE(){return null!=Jq.eIg?Jq.eIg:Jq.eIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get xj(){return null!=Jq.Xzg?Jq.Xzg:Jq.Xzg=Ga.a.instance.resolve("Box4.IInsertionPointFormatting")}static p3i(b,h,u){if(1===h)return(b?Jq.sRk(u):Jq.QQk(u))?32:8;(b=Jq.ydm(b,u))&&Jq.FDk(b,u);return 32}static FDk(b,h){const u=new Qg.GraphTransaction(15);u.Db(h);Jq.xj.Q6a();
Jq.qE.YJ(b,h,!1);u.dispose()}static sRk(b){b=Jq.uc.Ro(b);return!!b&&Jq.uc.wg(b)!==Yj.StyleReader.wordStyleIdHeading1}static QQk(b){b=Jq.uc.Ro(b);return!!b&&Jq.uc.wg(b)!==Yj.StyleReader.eTb}static ydm(b,h){const u=Jq.uc.Ro(h);return u?Jq.uc.ZC(h).jj(Jq.wdm(b,Jq.uc.wg(u))):null}static wdm(b,h){h=Jq.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<Jq.headingsList.count?Jq.headingsList.J(b):null}}Jq.headingsList=(pB=new zb.a,pB.add(Yj.StyleReader.wordStyleIdHeading1),pB.add(Yj.StyleReader.wordStyleIdHeading2),
pB.add(Yj.StyleReader.wordStyleIdHeading3),pB.add(Yj.StyleReader.bTb),pB.add(Yj.StyleReader.cTb),pB.add(Yj.StyleReader.dTb),pB.add(Yj.StyleReader.Roc),pB.add(Yj.StyleReader.Soc),pB.add(Yj.StyleReader.eTb),pB);Object(m.a)(Jq,"NavigationPaneEditor",null,[]);class DF extends Gx.a{constructor(){super();this.Z3=null;this.e$d=(b,h,u,B,Q)=>{if(1===u)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');
b.append(Gx.a.m2h("promoteHeading",Qc.a.U$d,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Gx.a.m2h("demoteHeading",Qc.a.YJd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");Q.PopulationXML=b.toString();return 32};this.U$d=(b,h,u)=>Jq.p3i(!0,u,this.Z3.Bb);this.YJd=(b,h,u)=>Jq.p3i(!1,u,this.Z3.Bb)}show(b){DF.Xh||(this.e5b(),DF.Xh=!0);Gx.a.showContextMenu("mnuNavPaneWordEditor",b)}e5b(){const b=
{PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Qc.a.c1i;b.Command=""+Za.a.Dma;Gx.a.p8k(b);v.AFrameworkApplication.va.ra(Qc.a.c1i,vc.a.application,this.e$d);v.AFrameworkApplication.va.ra(Qc.a.U$d,vc.a.view,this.U$d);v.AFrameworkApplication.va.ra(Qc.a.YJd,vc.a.view,this.YJd)}}DF.Xh=!1;Object(m.a)(DF,"WordEditorNavigationPaneContextMenu",Gx.a,[550]);var Hx=c(281),lC=c(1479),dM=c(452),eM=c(752),eG=c(1198),TG=c(1705),UG=c(1013);class fG{constructor(){this.j9=this.vxi=!1;
this.zRb=2;this.ww=0;this.o9a=1}}Object(m.a)(fG,"WrapTextPropertiesData",null,[]);class Ol extends eG.a{constructor(b=null){super(b);this.zdh=new TG.a;this.Wkh=new fG;this.$gh=new UG.a;this.gCe=!1;this.soi=h=>{const u=new Hx.a;u.AEa=!0;u.oM=h;return u};this.s1=()=>{const h=new Hx.a;h.kHb=!1;h.oM=Ob.a.EHa;h.Ad=this.zdh;h.Xcc=!0;h.kia=!0;return h};this.n4i=()=>{const h=new Hx.a;h.kHb=this.gCe;this.gCe=!0;h.oM=Ob.a.v6a;h.Ad=this.$gh;h.Xcc=!0;h.kia=!0;return h};this.Pdd=()=>{const h=new Hx.a;h.kHb=!1;
h.oM=Qc.a.lic;h.Ad=this.Wkh;h.Xcc=!0;h.kia=!0;return h};this.iWd=(h,u)=>{const B=new Hx.a;B.Ad=new Od.DictionaryPropertySet;switch(h){case Qc.a.tTc:B.Ad.setValue($c.a.Ojb,u[gj.a.Number]);break;case Qc.a.mTc:B.Ad.setValue($c.a.Ljb,u[gj.a.Number]);break;case Qc.a.nTc:B.Ad.setValue($c.a.Mjb,u[gj.a.Number]);break;case Qc.a.oTc:B.Ad.setValue($c.a.Njb,u[gj.a.Number])}return B};this.jJn=()=>{const h=new Hx.a;h.Ad=new Od.DictionaryPropertySet;h.kia=!0;return h}}initialize(){super.initialize();this.nd.Z(Qc.a.VIf,
lC.a.Yjb);this.nd.Z(Qc.a.$If,lC.a.Yjb);this.nd.Z(Qc.a.bJf,lC.a.Yjb);this.nd.Z(Qc.a.i3f,Ol.PSa);this.nd.Z(Qc.a.z4c,Ol.PSa);this.nd.Z(Qc.a.b3f,Ol.PSa);this.nd.Z(Za.a.XNb,Ol.PSa);this.nd.Z(Ob.a.Fae,this.s1);this.nd.Z(Ob.a.Eae,this.s1);this.nd.Z(Ob.a.Dae,this.s1);this.nd.Z(Ob.a.Hae,this.s1);this.nd.Z(Ob.a.Gae,this.s1);this.nd.Z(Ob.a.Cae,this.s1);this.nd.Z(Ob.a.Oae,this.s1);this.nd.Z(Ob.a.Nae,this.s1);this.nd.Z(Ob.a.Mae,this.s1);this.nd.Z(Ob.a.Jae,this.s1);this.nd.Z(Ob.a.Kae,this.s1);this.nd.Z(Ob.a.Lae,
this.s1);this.nd.Z(Ob.a.v3f,this.s1);this.nd.Z(Ob.a.u3f,this.s1);this.nd.Z(Ob.a.L2f,this.s1);this.nd.Z(Ob.a.N2f,this.s1);this.nd.Z(Ob.a.M2f,this.s1);this.nd.Z(Ob.a.K2f,this.s1);this.nd.Z(Ob.a.z7a,Ol.i8m);this.nd.Z(Ob.a.UTa,Ol.Pwn);this.nd.Z(Ob.a.kpb,Ol.g_k);this.nd.Z(Ob.a.Jma,Ol.PSa);this.nd.Z(Ob.a.gNb,Ol.PSa);this.nd.Z(Ob.a.SSa,Ol.PSa);this.nd.Z(Ob.a.Gua,Ol.PSa);this.nd.Z(Ob.a.Kya,Ol.PSa);this.nd.Z(Qc.a.j3c,Ol.PSa);this.nd.Z(Qc.a.qOd,lC.a.Pkf);this.nd.Z(Qc.a.rOd,this.V2h);this.Um.Z(Qc.a.h3c,lC.a.FOa);
this.Um.Z(Qc.a.i3c,lC.a.FOa);this.nd.Z(Ob.a.VPb,lC.a.n1a);this.nd.Z(Ob.a.UPb,lC.a.n1a);this.nd.Z(Ob.a.zpb,lC.a.n1a);this.nd.Z(Ob.a.H3f,this.yF);this.nd.Z(Ob.a.F3f,this.yF);this.nd.Z(Ob.a.G3f,this.yF);this.nd.Z(Ob.a.GL,Ol.DHn);this.Um.Z(Qc.a.pbe,Ol.E5c);this.Um.Z(Qc.a.qbe,Ol.E5c);this.Um.Z(Qc.a.rbe,Ol.E5c);this.Um.Z(Qc.a.nbe,Ol.E5c);this.Um.Z(Qc.a.obe,Ol.E5c);this.nd.Z(Qc.a.pbe,this.Pdd);this.nd.Z(Qc.a.qbe,this.Pdd);this.nd.Z(Qc.a.rbe,this.Pdd);this.nd.Z(Qc.a.nbe,this.Pdd);this.nd.Z(Qc.a.obe,this.Pdd);
this.nd.Z(Qc.a.gpe,Ol.$oc);this.nd.Z(Qc.a.hpe,Ol.$oc);this.nd.Z(Qc.a.ipe,Ol.$oc);this.nd.Z(Qc.a.jpe,Ol.$oc);this.nd.Z(Qc.a.kpe,Ol.$oc);this.nd.Z(Qc.a.lpe,Ol.$oc);this.nd.Z(Qc.a.wIa,Ol.l8b);this.nd.Z(Qc.a.sqj,Ol.l8b);this.nd.Z(Qc.a.tqj,Ol.l8b);this.nd.Z(Qc.a.cie,Ol.l8b);this.nd.Z(Qc.a.die,Ol.l8b);this.nd.Z(Qc.a.V9c,Ol.l8b);this.nd.Z(Qc.a.lob,this.jJn);this.nd.Z(Qc.a.j4c,Ol.$Od);this.nd.Z(Qc.a.vae,Ol.$Od);this.nd.Z(Qc.a.wae,Ol.$Od);this.nd.Z(Qc.a.xae,Ol.$Od);this.nd.Z(Qc.a.tTc,this.iWd);this.nd.Z(Qc.a.mTc,
this.iWd);this.nd.Z(Qc.a.nTc,this.iWd);this.nd.Z(Qc.a.oTc,this.iWd);this.nd.Z(Ob.a.Noa,this.soi);this.nd.Z(Ob.a.yDb,this.soi);this.nd.Z(Qc.a.job,Ol.job);this.nd.Z(Qc.a.lie,lC.a.n1a);this.nd.Z(Ob.a.L3f,this.n4i);this.nd.Z(Ob.a.M3f,this.n4i)}clearCache(){super.clearCache();this.gCe=!1;this.zdh=new TG.a;this.Wkh=new fG;this.$gh=new UG.a}vof(){const b=super.vof();b.YCa=Ol.YCa;b.j_a=Ol.j_a;return b}static get nwn(){return null!=Ol.KDg?Ol.KDg:Ol.KDg=Ga.a.instance.Oa("WordEditor.IPageCommandStringBuilder")}static get Uz(){Ol.Yta||
(Ol.Yta=Ga.a.instance.Oa("WordEditor.ITableBorderManager"));return Ol.Yta}static PSa(b,h){b=new Hx.a;b.Ad=h;return b}static I8c(b,h,u){h[gg.a.Description]=b?b.f8m(u):null}static YCa(b,h){const u=Object(Na.a)(TG.a,b.Ad),B=Object(Na.a)(dM.a,b.Ad),Q=Object(Na.a)(fG,b.Ad),ca=Object(Na.a)(UG.a,b.Ad);let qa=!0;const Qa=Ol.nwn;switch(b.znb){default:qa=eG.a.YCa(b,h);break;case Ob.a.Fae:h[Th.a.Icon]=u.wxa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[gg.a.On]=!u.WKb;Ol.I8c(Qa,h,0);break;
case Ob.a.Eae:h[Th.a.Icon]=u.wxa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[gg.a.On]=1===u.WKb;Ol.I8c(Qa,h,1);break;case Ob.a.Dae:h[Th.a.Icon]=u.wxa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[gg.a.On]=2===u.WKb;Ol.I8c(Qa,h,2);break;case Ob.a.Hae:h[Th.a.Icon]=u.wxa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[gg.a.On]=3===u.WKb;Ol.I8c(Qa,h,3);break;case Ob.a.Gae:h[Th.a.Icon]=u.wxa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";
h[gg.a.On]=4===u.WKb;Ol.I8c(Qa,h,4);break;case Ob.a.Cae:h[Th.a.Icon]=u.wxa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[gg.a.On]=5===u.WKb;break;case Ob.a.Oae:h[gg.a.On]=!u.CMb;h[gg.a.Description]=Qa?Qa.p2c(0):null;break;case Ob.a.Nae:h[gg.a.On]=1===u.CMb;h[gg.a.Description]=Qa?Qa.p2c(1):null;break;case Ob.a.Mae:h[gg.a.On]=2===u.CMb;h[gg.a.Description]=Qa?Qa.p2c(2):null;break;case Ob.a.Jae:h[gg.a.On]=3===u.CMb;h[gg.a.Description]=Qa?Qa.p2c(3):null;break;case Ob.a.Kae:h[gg.a.On]=
4===u.CMb;h[gg.a.Description]=Qa?Qa.p2c(4):null;break;case Ob.a.Lae:h[gg.a.On]=5===u.CMb;break;case Ob.a.v3f:h[gg.a.On]=!u.wxa;break;case Ob.a.u3f:h[gg.a.On]=u.wxa;break;case Ob.a.L2f:h[gg.a.On]=1===u.uIc;break;case Ob.a.N2f:h[gg.a.On]=2===u.uIc;break;case Ob.a.M2f:h[gg.a.On]=3===u.uIc;break;case Ob.a.K2f:h[gg.a.On]=0===u.uIc;break;case Ob.a.H3f:h[gg.a.On]=B.It?!B.It.specialIndentType:!1;break;case Ob.a.F3f:h[gg.a.On]=B.It?1===B.It.specialIndentType:!1;h[xm.a.Image16by16Class]=B.isRtl?ze.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):
ze.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Ob.a.G3f:h[gg.a.On]=B.It?2===B.It.specialIndentType:!1;h[xm.a.Image16by16Class]=B.isRtl?ze.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):ze.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Qc.a.pbe:h[gg.a.On]=1===Q.o9a;break;case Qc.a.qbe:h[gg.a.On]=8===Q.o9a;break;case Qc.a.rbe:h[gg.a.On]=9===Q.o9a;break;case Qc.a.nbe:h[gg.a.On]=3===Q.o9a;break;case Qc.a.obe:h[gg.a.On]=4===Q.o9a;break;case Qc.a.lob:h[gg.a.On]=
b.Ad.ja($c.a.sxa,!1);break;case Qc.a.job:h[Zh.a.IsFreeForm]=!0;h[Zh.a.Value]=b.Ad[Dq.a.Value];break;case Ob.a.L3f:h[oh.a.On]=Ol.Uz.u4h(h.MenuItemId)===ca.lineStyle;break;case Ob.a.M3f:h[oh.a.On]=Ol.Uz.v4h(h.MenuItemId)===ca.iZc}return qa}static i8m(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Hx.a;h.Ad=b;return h}static Pwn(b,
h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Hx.a;h.Ad=b;return h}static g_k(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Hx.a;h.Ad=b;return h}static job(){const b=new Hx.a;b.oM=Qc.a.job;b.Ad={};b.kia=!0;b.Xcc=!0;return b}static $oc(b,h){const u=new Hx.a;u.Ad=new Od.DictionaryPropertySet;
let B=1;switch(b){case Qc.a.jpe:B=1;break;case Qc.a.kpe:B=8;break;case Qc.a.lpe:B=9;break;case Qc.a.hpe:B=3;break;case Qc.a.ipe:B=4}u.Ad.setValue($c.a.o9a,B);u.Ad.setValue($c.a.DIa,h[gg.a.SourceControlId]);return u}static l8b(b,h,u){b=new Hx.a;b.Ad=u.InvocationMethod;return b}static DHn(b,h){b=new Hx.a;b.Ad=h;return b}static E5c(){const b=new eM.a;b.oM=Qc.a.lic;return b}static $Od(){const b=new Hx.a;b.Ad=new Od.DictionaryPropertySet;b.YWc=!0;return b}static j_a(b,h){let u=!0;switch(b.znb){case Qc.a.j4c:b=
b.Ad.ja($c.a.Ojb,0);h[gj.a.Number]=b;h[gj.a.UnitType]=7;break;case Qc.a.vae:b=b.Ad.ja($c.a.Ljb,0);h[gj.a.Number]=b;h[gj.a.UnitType]=7;break;case Qc.a.wae:b=b.Ad.ja($c.a.Mjb,0);h[gj.a.Number]=b;h[gj.a.UnitType]=7;break;case Qc.a.xae:b=b.Ad.ja($c.a.Njb,0);h[gj.a.Number]=b;h[gj.a.UnitType]=7;break;default:u=eG.a.j_a(b,h)}return u}}Ol.Yta=null;Object(m.a)(Ol,"CuiActionBridge",eG.a,[]);class VG extends Hf.a{constructor(b){super();this.B_k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.Aoo=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;
this.fKd=this.Ayb=this.K6=this.QXa=this.BRe=null;this.Vb=b;this.Yg="<div id='AccessibilityHelpDialogBody'></div>";this.ug="AAccessibilityHelpDialog";this.Cd=6;this.xe(0,CommonUIStrings.l_DialogClose)}get Sdf(){return null}get khe(){this.BRe||(this.BRe=this.zym());return this.BRe}get CEo(){return 300}get $Ni(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get ZNi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get x0a(){return this.Vb.Ys()}MTa(b){super.MTa(b);this.PBn()}fUa(){this.showDialog(this.dialogTitle,
Object(z.a)(this,this.Lnk,"accHelpDialogResultHandler"));this.LHa();this.setFocus()}setFocus(){this.K6?(this.Ayb=this.K6.tBodies[0].firstChild,this.u1(this.Ayb)):this.gH&&"none"!==this.gH.style.display?this.u1(this.gH):this.u1(this.Yz)}Pma(){this.ee.ob(Kd.a.$h,this.fKd,Object(z.a)(this,this.qlh,"accHelpDialogKeydownHandler"));if(this.K6){this.ee.ob(Kd.a.sh,this.K6,Object(z.a)(this,this.qwj,"tableOnKeyUpHandler"));const b=this.K6.tBodies[0].children;for(let h=0;h<b.length;h++)if(Me.a.addHandler(b[h],
Kd.a.focus,Object(z.a)(this,this.wej,"rowOnFocusHandler")),Me.a.addHandler(b[h],Kd.a.blur,Object(z.a)(this,this.vej,"rowOnBlurHandler")),Z.a.Kt){const u=b[h].children;for(let B=0;B<u.length;B++)Me.a.addHandler(u[B],Kd.a.focus,Object(z.a)(this,this.cBh,"cellOnFocusHandler"))}}super.Pma()}Dgb(){this.ee&&(this.ee.sc(Kd.a.$h,this.fKd,Object(z.a)(this,this.qlh,"accHelpDialogKeydownHandler")),this.K6&&this.ee.sc(Kd.a.sh,this.K6,Object(z.a)(this,this.qwj,"tableOnKeyUpHandler")));if(this.K6){const b=this.K6.tBodies[0].children;
for(let h=0;h<b.length;h++)if(Me.a.removeHandler(b[h],Kd.a.focus,Object(z.a)(this,this.wej,"rowOnFocusHandler")),Me.a.removeHandler(b[h],Kd.a.blur,Object(z.a)(this,this.vej,"rowOnBlurHandler")),Z.a.Kt){const u=b[h].children;for(let B=0;B<u.length;B++)Me.a.removeHandler(u[B],Kd.a.focus,Object(z.a)(this,this.cBh,"cellOnFocusHandler"))}}super.Dgb()}LHa(){this.x0a.scope.kr(this.Vb.LW);this.x0a.scope.kr(this.Vb.MW);this.x0a.scope.bindAction(this.Vb.LW,Za.a.LEc);this.x0a.scope.bindAction(this.Vb.MW,Za.a.KEc)}Aom(b){if(!this.x0a.ak||
!this.x0a.ak.Z3)return 2;var h=this.x0a.ak.Z3;if(this.K6&&(h===this.Yz&&b===Za.a.LEc||h===this.QXa&&b===Za.a.KEc))this.u1(this.Ayb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Za.a.LEc?h=this.QXa:b===Za.a.KEc&&(h=this.Yz),h&&this.u1(h);else if(b===Za.a.LEc)this.x0a.vfc();else if(b===Za.a.KEc)this.x0a.tfc();else return 2;return 32}wej(b){b.target.setAttribute(af.a.Heb,af.a.pp);Sys.UI.DomElement.removeCssClass(this.Ayb,"inactiveRowSelection");this.Ayb=b.target}vej(b){b.target.removeAttribute(af.a.Heb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}cBh(b){(b=b.target.parentNode)&&b!==this.Ayb&&this.u1(b)}qwj(b){return b.Hb.keyCode===Se.a.Ls?(b.Hb.stopPropagation(),!0):!1}qlh(b){if(!b.Hb)return!1;const h=b.Hb.keyCode;if(b.eventName===Kd.a.$h){b=this.SZl(this.Ayb);let u=-1;const B=mb.a.count(this.khe)-1;h===Sys.UI.Key.down?u=b<B?b+1:0:h===Sys.UI.Key.up?u=0<b?b-1:B:h===Sys.UI.Key.home?u=0:h===Sys.UI.Key.end&&(u=B);-1!==u&&this.u1(this.K6.tBodies[0].children[u])}return!0}Lnk(){}PBn(){this.fKd=
document.getElementById("AccessibilityHelpDialogBody")||this.$p;this.Xcl();this.Bcl();this.ral()}Xcl(){if(this.Sdf){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.Sdf;b.appendChild(h);this.bla.appendChild(b)}}Bcl(){if(this.khe&&!mb.a.isEmpty(this.khe)){this.K6=document.createElement("table");this.K6.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(af.a.oh,
af.a.kGc);b.appendChild(h);var u=kc.a.IJc(14,this.B_k);h.appendChild(u);u=kc.a.IJc(14,this.Aoo);h.appendChild(u);this.K6.appendChild(b);b=document.createElement("tbody");h=0;u=this.khe;for(let ca in u){var B=ca,Q=u[ca];const qa=document.createElement("tr");qa.tabIndex=0;qa.setAttribute(af.a.oh,af.a.kGc);qa.id="SelectableTableRow"+h++;B=kc.a.IJc(15,B);qa.appendChild(B);Q=kc.a.IJc(15,Q);qa.appendChild(Q);b.appendChild(qa)}b.style.maxHeight=this.CEo+"px";this.K6.appendChild(b);this.fKd.appendChild(this.K6)}}ral(){if(this.ZNi&&
this.$Ni){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.QXa=document.createElement("a");this.QXa.innerText=this.ZNi;this.QXa.href=this.$Ni;this.QXa.target="_blank";this.QXa.id=this.mj("AccessibilityHelpDialogLink");this.QXa.className=$d.AFrame.h0e;b.appendChild(this.QXa);this.Jc.insertBefore(b,this.Jc.lastChild)}}SZl(b){return Number.parseInvariant(b.id.substr(18))}q_(b,h,u,B=null){b&&h&&u&&(u=B?String.format(u,B):u,b[h]=u)}agi(b,h){return Z.a.Wk?h:b}}Object(m.a)(VG,
"AAccessibilityHelpDialog",Hf.a,[959]);class XD extends VG{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get Sdf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}zym(){const b=this.agi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.agi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),u={};this.q_(u,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.q_(u,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.q_(u,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.q_(u,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.q_(u,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.q_(u,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.q_(u,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(XD.Zb&&XD.Zb.isFeatureEnabled(64)||Jp.a.OQa())&&this.q_(u,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return u}static get Zb(){return null!=XD.Mxg?
XD.Mxg:XD.Mxg=Ga.a.instance.Oa("Box4.IFeatureHelper")}}Object(m.a)(XD,"AccessibilityHelpDialog",VG,[]);var XH=c(329);class gG{static get Yg(){return Hf.a.Bz(gG.Sm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}gG.Sm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(m.a)(gG,"ApplyStylesDialogHtml",null,[]);class DE extends Hf.a{constructor(b,h){super();this.uH=null;this.iDc=!1;this.Lzb=this.Z9a=this.Ezc=this.Hzc=this.yDc=null;this.kEk=(u,B)=>{if(this.lh.kv){if(u){u=B.styleList;B=B.styleText;if(-1===u||F.a.Zg(B)!==F.a.Zg(this.uH[u]))u=this.ugi(B);B=this.uH[u];u=this.uc.yr();B=this.uc.wg(u.nFa(B));v.AFrameworkApplication.va.Kf(this._context,Ob.a.KQ,2,!1,new XH.a,B)}this.lh.U5()}};this.zsn=u=>{this.iDc?(this.iDc=!1,this.validate()):"value"===u.rawEvent.propertyName&&
(this.iDc=!0,this.i_.value!==this.yDc&&(this.yDc=this.i_.value,this.evh()))};this.Qnn=()=>{-1!==this.lma.selectedIndex&&(Z.a.L4&&(this.iDc=!0),this.yDc=this.uH[this.lma.selectedIndex],this.i_.value=this.uH[this.lma.selectedIndex],this.validate())};this.onKeyDown=u=>{Z.a.bK?u.keyCode!==Se.a.oC&&u.keyCode!==Se.a.Z1||this.Z9a||this.Lzb||(this.Lzb=new bf.a(0,1,1,this.I_o),v.AFrameworkApplication.oc.Xb(this.Lzb)):Z.a.L4&&u.keyCode===Se.a.oC&&(this.iDc=!0)};this.PG=()=>{this.Z9a||(this.Z9a=new bf.a(0,1,
1,this.MGk),v.AFrameworkApplication.oc.Xb(this.Z9a));this.Lzb&&(v.AFrameworkApplication.oc.Ze(this.Lzb),this.Lzb=null)};this.MGk=()=>{this.Z9a=null;this.evh()};this.I_o=()=>{this.Lzb=null;this.validate()};this._context=b;this.od=h;this.ug="ApplyStylesDialog";this.lh=this._context.view;this.Ctf();b=this.nCo();h="";this.uH.length>b&&(h=this.uH[b]);h={["styleText"]:h,["styleList"]:b};this.Yg=gG.Yg;this.Qh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.kEk,h);this.lma=document.getElementById("styleList");
this.u0f();this.lma.selectedIndex=b;this.i_=document.getElementById("styleText");this.i_.focus();this.i_.select();this.Hrd=this.Qnn;Me.a.addHandler(this.lma,"change",this.Hrd);this.Grd=this.onKeyDown;Me.a.addHandler(this.i_,"keydown",this.Grd);Z.a.L4?(this.Hzc=this.zsn,Me.a.addHandler(this.i_,"propertychange",this.Hzc),this.yDc=this.uH[b]):(this.Ezc=this.PG,Me.a.addHandler(this.i_,"keypress",this.Ezc))}get uc(){return null!=this.nIg?this.nIg:this.nIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}nCo(){var b=
this.lh.mb;if(!b||!b.hb)return Pc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.hb.lb;if(!b)return Pc.b(579216409,3018,15,"CurrentSelection is null"),0;me.ParagraphReader.nm(b.Pa)&&(b=Ge.SelectionEditor.Fj(b,!0,!1));b=b.Pa;if(!b||!Ge.SelectionEditor.lv(b))return Pc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=zc.FormattingReader.Vr(b);(h=zc.FormattingReader.Eoa(h))||(h=this.uc.Ro(b.node));if(!h)return 0;b=this.uc.qR(h);b=Array.indexOf(this.uH,
b);0>b&&(b=0);return b}u0f(){const b=this.uH.length;for(let h=0;h<b;h++){const u=document.createElement("OPTION");u.value=h.toString();u.text=this.uH[h];this.lma.add(u,null)}}Ctf(){var b=lk.a.xr();if(b){b=(new tv.WACStyleSet).XX(b);var h=b.BO,u=this.od.isFeatureEnabled(112)&&!!this.uc.Eg;this.uH=[];for(let B=0;B<h;B++){const Q=b.mFa(B);if(this.uc.isHidden(Q))continue;const ca=this.uc.GG(Q);if(!u){if(3===ca)continue}else if(3===ca&&this.uc.wg(Q)===ZB.a.BLb)continue;Array.add(this.uH,this.uc.qR(Q))}this.uH.sort(DE.l1k)}else Pc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.Hzc&&Me.a.removeHandler(this.i_,"propertychange",this.Hzc);this.Grd&&Me.a.removeHandler(this.i_,"keydown",this.Grd);this.Hrd&&Me.a.removeHandler(this.lma,"change",this.Hrd);this.Ezc&&Me.a.removeHandler(this.i_,"keypress",this.Ezc);this.Z9a&&v.AFrameworkApplication.oc.Ze(this.Z9a);this.Z9a=this.Ezc=this.lma=this.i_=this.Grd=this.Hzc=this.Hrd=null;super.dispose()}evh(){var b=this.i_.value,h=this.rwm(b);const u=-1===h?b:this.uH[h];b=b.length;const B=
u.length;this.yDc=u;this.i_.value=u;this.lma.selectedIndex=h;B>b&&(Z.a.bK?this.i_.setSelectionRange(b,B):Z.a.L4&&(h=this.i_.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",B-b),h.select()));this.validate();this.i_.focus()}rwm(b){let h=0,u=this.uH.length,B=-1;for(b=F.a.Zg(b);h<u;){const Q=Math.floor((h+u)/2),ca=DE.z8e(b,this.uH[Q]);if(!ca){B=Q;break}0<ca?h=Q+1:u=Q}if(B>h)for(;!DE.z8e(b,this.uH[B-1])&&(B--,B!==h););return B}validate(){const b=-1===this.ugi(this.i_.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}ugi(b){b=F.a.Zg(b);const h=this.uH.length;for(let u=0;u<h;u++)if(b===F.a.Zg(this.uH[u]))return u;return-1}static z8e(b,h){const u=Math.min(b.length,h.length);b=F.a.Zg(b);h=F.a.Zg(h);for(let B=0;B<u;B++){const Q=F.a.charCodeAt(b,B),ca=F.a.charCodeAt(h,B);if(Q!==ca)return Q-ca}return b.length<=h.length?0:1}static l1k(b,
h){return DE.z8e(b,h)}}Object(m.a)(DE,"ApplyStylesDialog",Hf.a,[]);var EE=c(317);class YH extends mg.StandardDialog{constructor(b){super();this.Ev=b;this.Ato()}Ato(){this.Cd=1;this.rV(1);this.xe(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.pv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.ldf.bind(this))}ldf(b){1===b&&this.Ev.Rja("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Ei?Pc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.q4n(),Pc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}q4n(){EE.a.wrb="{}"}}Object(m.a)(YH,"DeleteSavedStylesConfirmationDialog",mg.StandardDialog,[]);class ZH extends mg.StandardDialog{constructor(b,h){super();this.ldf=Q=>{if(1===Q){Q=new Map;Q.set("Source","DeleteStyleConfirmationDialog");Q.set("Action","DeleteStyle");xa.Health.instance.recordKpiUsage(Qp.a.mAa,0,Qp.a.xB,Q);var ca=
lk.a.xr();Q=new Qg.GraphTransaction(15);Q.Db(ca);Q.Qj=Ob.a.pDb;this.qE.IPh(this.rgh)?Pc.b(578359694,3018,50,"User deleted a style via UI."):(ca=new Map,ca.set("Source","DeleteStyleConfirmationDialog"),ca.set("Action","DeleteStyle"),ca=Object.assign(new Ub.a,{extendedProperties:ca}),xa.Health.instance.recordKpiFailure(Qp.a.mAa,"DeleteStyleFailed",!1,!0,ca),Pc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));Q.dispose()}};h||Pc.b(590128417,3018,10,"styleId is null");
let u=null,B=null;if(this.lh=b.view)B=this.lh.mb;B&&(u=B.hb.lb.Pa);u?(b=u.node)?(this.EK=this.ai.ru(b))?(this.rgh=new zb.a,this.rgh.add(h),this.Bto(h)):Pc.b(590128448,3018,10,"_pageContenNode is null."):Pc.b(590128419,3018,10,"node is null."):Pc.b(590128418,3018,10,"nodeContext is null.")}get qE(){return null!=this.cIg?this.cIg:this.cIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get uc(){return null!=this.uIg?this.uIg:this.uIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get ai(){return null!=
this.YDg?this.YDg:this.YDg=Zo.PageNavigator.instance}Bto(b){const h=(new tv.WACStyleSet).XX(this.EK);h?((b=h.jj(b))||Pc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.uc.qR(b),this.Cd=4,this.rV(2),this.pv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.ldf)):Pc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(m.a)(ZH,"DeleteStyleConfirmationDialog",mg.StandardDialog,
[]);class hG{static get Yg(){return Hf.a.Bz(hG.Sm)}}hG.Sm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(m.a)(hG,"DeleteStyleDialogHtml",null,[]);class $H extends Hf.a{constructor(b){super();this.EK=this.uH=null;this.ijl=(h,u)=>{this.lh.kv&&(h?(h=u.styleList,-1!==h&&(h=this.uH[h],u=this.uc.yr(),h=this.uc.wg(u.nFa(h)),this.aLc.hjl(this._context,h),this.lh.U5())):this.lh.U5())};this._context=b;this.ug="DeleteStyleDialog";this.Cd=
1;this.xe(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.lh=this._context.view;this.Ctf();this.Yg=hG.Yg;this.Qh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.ijl,{["styleList"]:0});this.lma=document.getElementById("styleList");this.u0f();this.lma.selectedIndex=0;this.lma.focus()}get uc(){return null!=this.pIg?this.pIg:this.pIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get aLc(){return null!=this.Gwg?this.Gwg:this.Gwg=Ga.a.instance.resolve("WordEditor.UI.IDialogFactory")}u0f(){const b=
this.uH.length;for(let h=0;h<b;h++){const u=document.createElement("OPTION");u.value=h.toString();u.text=this.uH[h];this.lma.add(u,null)}}Ctf(){if(this.EK=lk.a.xr()){var b=(new tv.WACStyleSet).XX(this.EK),h=b.BO;this.uH=[];for(let B=0;B<h;B++){const Q=b.mFa(B);if(!this.uc.isHidden(Q)&&this.uc.je(Q,b)){var u=this.uc.GG(Q);if(2===u||1===u)Q.hasProperty(Jc.a.linkedStyle)&&2!==u||(u=Q.ja(Jc.a.SK,null))&&0<u.length||this.uH.push(this.uc.qR(Q))}}this.uH.sort()}else Pc.b(578650370,3018,15,"PageContentNode is null")}}
Object(m.a)($H,"DeleteStyleDialog",Hf.a,[]);var fM=c(776);class aI{constructor(b){this.customData=null;this.XO=b}}Object(m.a)(aI,"PropertySetChangedState",null,[]);class bI{static WFn(b,h,u){if(b&&h){var B=new aI(h),Q=(ca,qa,Qa)=>{u.VFn(ca,qa,Qa,B)};b=new fM.a(h,b);b.qBd=Q;b.JEd=Q;b.Wce=Q;b.Qhc()}}}Object(m.a)(bI,"PropertySetChangedManager",null,[]);class cI{constructor(b){this.DMa=b}VFn(b,h,u,B){const Q=this.DMa[b.id.toString()];Q&&Q(b,h,u,B)}}Object(m.a)(cI,"PropertyChangedProcessor",null,[]);const iG=
(b,h,u)=>{const B=Hr.a.instance.zEb;if(B){const Q=new Qg.GraphTransaction(15);Q.Db(B);bI.WFn(b,h,new cI(u));Q.dispose()}};class jG{static get Yg(){return Hf.a.Bz(jG.Sm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}jG.Sm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(m.a)(jG,"MarginsDialogHtml",null,[]);class sr{static get m5(){return null!=sr.LDg?sr.LDg:sr.LDg=Ga.a.instance.Oa("WordEditor.IPageCommands")}static e8m(b,h,u){sr.m5&&null!==u&&sr.m5.sge(0,u)}static a8m(b,h,u){sr.m5&&null!==u&&sr.m5.sge(3,u)}static c8m(b,h,u){sr.m5&&null!==u&&sr.m5.sge(1,u)}static d8m(b,h,u){sr.m5&&null!==u&&sr.m5.sge(2,u)}static Zwn(b,h,u){sr.m5&&null!==u&&sr.m5.UTa(0,u)}static zwn(b,h,u){sr.m5&&null!==u&&sr.m5.UTa(1,u)}static h_k(b,h,u){sr.m5&&null!==u&&(b==Ud.a.XE?sr.m5.Bfe(0,
u):b==Ud.a.mG?sr.m5.Bfe(1,u):b==Ud.a.gna?sr.m5.Bfe(2,u):b==Ud.a.separator&&sr.m5.Bfe(3,u))}}Object(m.a)(sr,"PageLevelPropertyChangedHandlers",null,[]);const dI=[Qc.a.T1c,Qc.a.S1c,Qc.a.r8d,Qc.a.s8d,Qc.a.Bae,Qc.a.yae,Qc.a.zae,Qc.a.Aae];class gA extends Hf.a{constructor(b,h,u,B,Q){super();this.yOc=(ca,qa)=>{var Qa=gA.T3c(ca);ca=Fb.App.xia;this.Gp.hasProperty(Qa)?(Qa=this.Gp.getValue(Qa),qa[gj.a.Number]=Of.a.h9a(Qa,ca)):qa[gj.a.Number]=0;qa[gj.a.UnitType]=ca};this.o8c=(ca,qa)=>{this.Gp.setValue(gA.T3c(ca),
Of.a.mJa(qa[gj.a.Number],qa[gj.a.UnitType]));this.Eu.Bm()};this.g8m=ca=>{let qa=!1;1===ca&&(Math.abs(this.Gp.getValue(Jc.a.marginTop))+Math.abs(this.Gp.getValue(Jc.a.marginBottom))+Fb.App.lAa<=this.kua.getValue(Jc.a.rv)&&this.Gp.getValue(Jc.a.marginLeft)+this.Gp.getValue(Jc.a.marginRight)+Fb.App.lAa<=this.kua.getValue(Jc.a.Go)?iG(this.tBa,this.Gp,gA.Z9b()):qa=!0);this.dispose();qa&&this.kIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.b8m)};this.b8m=()=>{Ga.a.instance.resolve("WordEditor.UI.IDialogFactory").hLh(this.tBa,
this.kua,this.e7)};this.ug="MarginsDialog";this.kua=h.clone();this.tBa=b.clone();this.Gp=b.clone();this.e7=u;this.eW=!1;this.Eu=Q;this.Yg=jG.Yg;u&&(this.Osc=hs.a.LRb);this.Qh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.g8m,null);this.aUc();this.USe=document.getElementById("DialogMarginTopSpinner");this.u1(this.USe)}L9(){this.EDd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Qc.a.T1c,Qc.a.Bae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.EDd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Qc.a.S1c,Qc.a.yae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.EDd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Qc.a.r8d,Qc.a.zae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.EDd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Qc.a.s8d,Qc.a.Aae,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}aUc(){for(const b of dI)Object(bm.a)(b,this.o8c,this.yOc);this.Eu.Cqa("DialogMarginTopSpinner");
this.Eu.Cqa("DialogMarginBottomSpinner");this.Eu.Cqa("DialogMarginLeftSpinner");this.Eu.Cqa("DialogMarginRightSpinner")}dispose(){for(const b of dI)Object(bm.b)(b);this.Eu.YY("DialogMarginTopSpinner");this.Eu.YY("DialogMarginBottomSpinner");this.Eu.YY("DialogMarginLeftSpinner");this.Eu.YY("DialogMarginRightSpinner");super.dispose()}EDd(b,h,u,B,Q){u=gA.nMk(h,u,B,Q);this.OAb(u,b,h)}OAb(b,h,u){h=document.getElementById(h);this.Eu.RZa(u,b);b=this.Eu.vFb(u,"Medium");h.appendChild(b)}static Z9b(){return gA.DMa||
(gA.DMa=gA.r5b())}static r5b(){const b={};b[Jc.a.marginTop.id.toString()]=sr.e8m;b[Jc.a.marginBottom.id.toString()]=sr.a8m;b[Jc.a.marginLeft.id.toString()]=sr.c8m;b[Jc.a.marginRight.id.toString()]=sr.d8m;return b}static nMk(b,h,u,B){let Q=!0;if(h===Qc.a.T1c||h===Qc.a.S1c)Q=!1;return zj.j(b,h,u,B,[gA.pMk(Q),gA.oMk(Q)])}static pMk(b){return zj.l("inch",b?"0":"-22","22",".1")}static oMk(b){return zj.l("centimeter",b?"0":"-55.8","55.8","1")}static T3c(b){let h=null;switch(b){case Qc.a.T1c:case Qc.a.Bae:h=
Jc.a.marginTop;break;case Qc.a.S1c:case Qc.a.yae:h=Jc.a.marginBottom;break;case Qc.a.r8d:case Qc.a.zae:h=Jc.a.marginLeft;break;case Qc.a.s8d:case Qc.a.Aae:h=Jc.a.marginRight}return h}}gA.DMa=null;Object(m.a)(gA,"MarginsDialog",Hf.a,[]);class kG{static get Yg(){return Hf.a.Bz(kG.Sm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}kG.Sm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(kG,"PaperSizeDialogHtml",null,[]);const eI=[Qc.a.v8d,Qc.a.u8d,Qc.a.Qae,Qc.a.Pae];class Ut extends Hf.a{constructor(b,h,u,B,Q){super();this.yOc=(ca,qa)=>{var Qa=this.T3c(ca);ca=Fb.App.xia;this.Gp.hasProperty(Qa)?(Qa=this.Gp.getValue(Qa),qa[gj.a.Number]=Of.a.h9a(Qa,ca)):qa[gj.a.Number]=0;qa[gj.a.UnitType]=ca};this.o8c=(ca,qa)=>{this.Gp.setValue(this.T3c(ca),Of.a.mJa(qa[gj.a.Number],qa[gj.a.UnitType]));this.Eu.Bm()};this.mxn=ca=>{let qa=!1;1===ca&&(this.Gp.getValue(Jc.a.rv)>=Fb.App.lAa+this.kua.getValue(Jc.a.marginTop)+
this.kua.getValue(Jc.a.marginBottom)&&this.Gp.getValue(Jc.a.Go)>=Fb.App.lAa+this.kua.getValue(Jc.a.marginLeft)+this.kua.getValue(Jc.a.marginRight)?iG(this.tBa,this.Gp,Ut.Z9b()):qa=!0);this.dispose();qa&&this.kIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.lxn)};this.lxn=()=>{Ga.a.instance.resolve("WordEditor.UI.IDialogFactory").NLh(this.tBa,this.kua,this.e7)};this.ug="PaperSizeDialog";this.kua=h.clone();this.tBa=b.clone();this.Gp=b.clone();this.e7=u;this.eW=!1;this.Eu=Q;this.Yg=kG.Yg;
u&&(this.Osc=hs.a.LRb);this.Qh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.mxn,null);this.aUc();this.USe=document.getElementById("DialogWidthSpinner");this.u1(this.USe)}L9(){this.Hxh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Qc.a.v8d,Qc.a.Qae,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Hxh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Qc.a.u8d,Qc.a.Pae,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}aUc(){for(const b of eI)Object(bm.a)(b,
this.o8c,this.yOc);this.Eu.Cqa("DialogWidthSpinner");this.Eu.Cqa("DialogHeightSpinner")}dispose(){for(const b of eI)Object(bm.b)(b);this.Eu.YY("DialogWidthSpinner");this.Eu.YY("DialogHeightSpinner");super.dispose()}Hxh(b,h,u,B,Q){u=Ut.EMk(h,u,B,Q);this.OAb(u,b,h)}OAb(b,h,u){h=document.getElementById(h);this.Eu.RZa(u,b);b=this.Eu.vFb(u,"Medium");h.appendChild(b)}T3c(b){let h=null;switch(b){case Qc.a.u8d:case Qc.a.Pae:h=Jc.a.rv;break;case Qc.a.v8d:case Qc.a.Qae:h=Jc.a.Go}return h}static Z9b(){return Ut.DMa||
(Ut.DMa=Ut.r5b())}static r5b(){const b={};b[Jc.a.Go.id.toString()]=sr.Zwn;b[Jc.a.rv.id.toString()]=sr.zwn;return b}static EMk(b,h,u,B){return zj.j(b,h,u,B,[Ut.GMk(),Ut.FMk()])}static GMk(){return zj.l("inch",Ut.tsj,Ut.qXm,Ut.txo)}static FMk(){return zj.l("centimeter",Ut.tsj,Ut.pXm,Ut.sxo)}}Ut.tsj="0";Ut.qXm="22";Ut.txo=".1";Ut.sxo="1";Ut.pXm="55.8";Ut.DMa=null;Object(m.a)(Ut,"PaperSizeDialog",Hf.a,[]);const gM=RegExp("[{|}|;|\\\\]"),fI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
u=b.BO;let B;for(B=1;B<=u;B++){const Q=h+B;if(!(b.rgi(Q)||b.BTd(Q)||b.rgi(Q+"Char")||b.BTd(Q+"Char")))break}return h+B};class gI extends Hf.a{constructor(b,h,u,B,Q){var ca,qa,Qa,rb;super(!1,!1,!0);this.context=b;this.nc=h;this.M8=u;this.uc=B;this.ai=Q;this.pMd=null;this.F5i=(Lb,Yb)=>{if(this.ie.kv){if(0!==Lb){Lb="string"===typeof Yb.styleText?Yb.styleText:null;Yb=this.X$c;var gc=Lb;const Fc=F.a.Uya(gc);let Sc=null;if(0===Fc.length)Sc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<gc.length)Sc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(gM.test(gc))Sc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Yb.pdm(gc)||Yb.BTd(Fc))Sc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Yb=Sc)?(this.pMd=Yb,Yb=fI(this.X$c),Lb=this.uFb(Lb,Yb),this.pMd=null,this.eW=!1,this.hide(),this.Qh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.F5i,Lb),this.eW=!0):(this.hide(),Yb=new Map,Yb.set("Source","ReactCreateNewStyleDialog"),Yb.set("Action","CreateStyle"),
xa.Health.instance.recordKpiUsage(Qp.a.mAa,0,Qp.a.xB,Yb),this.QYe(Lb)||(Lb=new Map,Lb.set("Source","ReactCreateNewStyleDialog"),Lb.set("Action","CreateStyle"),Lb=Object.assign(new Ub.a,{extendedProperties:Lb}),xa.Health.instance.recordKpiFailure(Qp.a.mAa,"CreateStyleFailed",!1,!0,Lb)))}else this.hide();this.ie.U5()}};this.ug="CreateNewStyleDialog";this.ie=b.view;(b=null===(rb=null===(Qa=null===(qa=null===(ca=this.ie)||void 0===ca?void 0:ca.mb)||void 0===qa?void 0:qa.hb)||void 0===Qa?void 0:Qa.lb)||
void 0===rb?void 0:rb.Pa)?(ca=b.node)?(this.pageContentNode=this.ai.ru(ca))?(this.X$c=(new tv.WACStyleSet).y7h(this.pageContentNode),(this.xLb=this.M8.jNd(b))?(ca=this.xLb.ja(Xe.a.fontSize,22),16>ca?Pc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ca?Pc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ca?Pc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Pc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.g7f(this.xLb),this.pageContentNode&&this.xLb&&(this.taa=!1,ca=fI(this.X$c),ca=this.uFb(ca,ca),this.Qh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.F5i,ca))):Pc.b(592737758,3018,10,"_newStyleProperties is null.")):Pc.b(592737757,3018,10,"_pageContenNode is null."):Pc.b(592725466,3018,10,"node is null."):Pc.b(556917206,3018,10,"nodeContext is null.")}g7f(b){b.zg(xh.a.Uv,xh.a.nw,...Qp.a.wca())}uFb(b,h){const u=52<=this.xLb.ja(Xe.a.fontSize,
im.a.DM),B=jx.a.uof(this.xLb,"97%",26,!1,!0,u);B["padding-left"]="5px";u||(B["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>B};this.pMd&&(b.errorMessage=this.pMd);return{["id"]:this.ug,["bodyControls"]:b}}QYe(b){const h=new Qg.GraphTransaction(15);h.Db(this.pageContentNode);h.Qj=Ob.a.LCb;
const u=lk.a.QYe(b,lk.a.Ydi(this.xLb),null,this.pageContentNode);u&&(Pc.b(593078046,3018,50,"User created linked style"),this.X$c=(new tv.WACStyleSet).y7h(this.pageContentNode),b=F.a.Uya(F.a.jY(b)),b=this.X$c.BTd(b),this.nc.Kf(this.context,Ob.a.KQ,2,!1,new XH.a,this.uc.wg(b)));h.dispose();return u}}Object(m.a)(gI,"ReactCreateNewStyleDialog",Hf.a,[]);class sD extends Hf.a{constructor(b,h=!1,u){super(!1,!1,h);let B=h=this.vK=null;this.ug=sD.id;this.lh=b.view;this.xn=u;this.lh&&(B=this.lh.mb);B&&B.hb&&
B.hb.lb&&(h=B.hb.lb.Pa);h?(b=h.node)?(this.EK=sD.ai.ru(b))||r.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):r.ULS.sendTraceTag(539762889,3029,10,"node is null"):r.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}s_o(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),u=this.UKl();const B=""===F.a.Uya(b),Q=b.length>sD.o9m;u=u.includes(b);h=h.test(b);b=b.startsWith("_");let ca=null;if(B||Q||u||b||!h)ca=B?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
Q?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}vGm(b,h){return b?b===h:!1}static get ai(){return Zo.PageNavigator.instance}UKl(){const b=this.xn.hPd(!1),h=[];for(let u=0;u<b.count;u++){const B=b.J(u).ja(Jc.a.zt,"");h.push(B)}return h}}sD.id="BookmarkEditDialog";sD.o9m=40;Object(m.a)(sD,
"AEditBookmarkDialog",Hf.a,[]);class hI extends sD{constructor(b,h,u){super(b,!0,u);this.Gze=null;this.SWa="wwaengidc";this.rxc="ReactCreateEditBookmarkNameDialog";this.h2g="EditBookmarkName";this.lta="EditBookmarkNameDialog";this.Ete=h;this.xn=u;this.EK&&(this.taa=!1,b=this.uFb(h.properties.ja(Jc.a.zt,null)),this.Qh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.H5i.bind(this),b))}H5i(b,h){if(this.lh.kv){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var u;this.Ete.hasProperty(Jc.a.zt)?
u=this.Ete.getValue(Jc.a.zt):r.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.s_o(b);this.vGm(b,u)?(r.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.Gze=h,u=this.uFb(b),this.Gze=null,this.eW=!1,this.hide(),this.Qh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.H5i.bind(this),u),this.eW=!0):(this.hide(),u=new Map,u.set("Source",this.rxc),u.set("Action",this.h2g),xa.Health.instance.recordKpiUsage(this.lta,
0,this.SWa,u),this.QSk(b)||(u=new Map,u.set("Source",this.rxc),u.set("Action",this.h2g),u=Object.assign(new Ub.a,{extendedProperties:u}),xa.Health.instance.recordKpiFailure(this.lta,"Unable to edit bookmark",!1,!0,u)))}else this.hide();this.lh.U5()}}QSk(b){b=F.a.Uya(F.a.jY(b));try{const h=this.xn.ARo(this.Ete,b);if(h)r.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return r.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return r.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}uFb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.Gze;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.ug,["bodyControls"]:h}}}Object(m.a)(hI,"ReactEditBookmarkNameDialog",sD,[]);var hM=c(412);const lG=(b,h,u)=>{const B=[];if(b.length!==h.length||u&&u.length!==h.length)return B;for(let Q=0;Q<b.length;Q++){const ca=
{};ca.key=h[Q];ca.text=b[Q];ca.type="AppComboBoxItem";u&&(ca.ariaLabel=u[Q]);B[Q]=ca}return B},mC=(b,h,u,B,Q)=>({["unitType"]:b,["unitPlaceholder"]:F.a.V9d(h),["minValue"]:u,["maxValue"]:B,["step"]:Q}),WG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),iI=(b,h,u)=>{let B=!1;b.hasProperty(h)&&b.hasProperty(u)?(u=b.getValue(u),1===u?(b=Number.NaN,h=5,B=!0):(b=b.getValue(h),h=2===u?
4:5)):(b=Number.NaN,h=Fb.App.gGa?4:5);return{Hlc:b,L8a:h,wbc:B}};class jI{constructor(){this.Msj=this.CZi=this.AZi=this.rxn=this.kZf=!1}}Object(m.a)(jI,"Box4PropertySetChangedState",null,[]);class Dm{static get Qac(){return null!=Dm.Szg?Dm.Szg:Dm.Szg=Ga.a.instance.Oa("Box4.IIndentationCommands")}static get IDi(){return null!=Dm.jCg?Dm.jCg:Dm.jCg=Ga.a.instance.Oa("Box4.IJustificationCommands")}static get N5(){return null!=Dm.zFg?Dm.zFg:Dm.zFg=Ga.a.instance.Oa("Box4.ISpacingCommands")}static sWm(b,
h,u){Dm.IDi&&u&&(null===h||11!==u||10!==h&&9!==h)&&Dm.IDi.lE(u)}static BZm(b,h,u){Dm.N5&&u&&Dm.N5.jD(u)}static u4k(b,h,u){h!=u&&Dm.N5.tkc(u)}static DWm(b,h,u){h!=u&&Dm.N5.H8c(u)}static T1o(b,h,u){h!=u&&Dm.N5.h9c(u)}static BWm(b,h,u){h!=u&&Dm.N5.G8c(u)}static HZi(b,h,u,B){Dm.N5&&void 0!==u&&null!==u&&(b=Dm.QOc(B),!b.kZf&&B.XO.hasProperty($c.a.dhc)&&B.XO.hasProperty($c.a.ehc)&&(h=B.XO.getValue($c.a.ehc),B=B.XO.getValue($c.a.dhc),b.kZf=!0,Dm.N5.bea(1,h,B)))}static GZi(b,h,u,B){Dm.N5&&void 0!==u&&null!==
u&&(b=Dm.QOc(B),!b.rxn&&B.XO.hasProperty($c.a.bhc)&&B.XO.hasProperty($c.a.chc)&&(h=B.XO.getValue($c.a.chc),B=B.XO.getValue($c.a.bhc),b.kZf=!0,Dm.N5.bea(0,h,B)))}static zZi(b,h,u,B){Dm.Qac&&void 0!==u&&null!==u&&(b=Dm.QOc(B),!b.AZi&&B.XO.hasProperty($c.a.sHa)&&B.XO.hasProperty($c.a.tHa)&&(h=B.XO.getValue($c.a.tHa),B=B.XO.getValue($c.a.sHa),b.AZi=!0,Dm.Qac.clj(1,h,B)))}static BZi(b,h,u,B){Dm.Qac&&void 0!==u&&null!==u&&(b=Dm.QOc(B),!b.CZi&&B.XO.hasProperty($c.a.Jnb)&&B.XO.hasProperty($c.a.Knb)&&(h=B.XO.getValue($c.a.Knb),
B=B.XO.getValue($c.a.Jnb),b.CZi=!0,Dm.Qac.clj(0,h,B)))}static ehg(b,h,u,B){Dm.Qac&&void 0!==u&&null!==u&&(b=Dm.QOc(B),!b.Msj&&B.XO.hasProperty($c.a.kUa)&&B.XO.hasProperty($c.a.lUa)&&(h=0,B.XO.hasProperty($c.a.O5)&&(h=B.XO.getValue($c.a.O5)),u=B.XO.getValue($c.a.lUa),B=B.XO.getValue($c.a.kUa),b.Msj=!0,Dm.Qac.Mge(h,u,B)))}static QOc(b){b.customData||(b.customData=new jI);return b.customData}}Object(m.a)(Dm,"ParagraphLevelPropertyChangedHandlers",null,[]);class tD{constructor(){this.DMa=null}E6l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var u=mC("Point",5,0,1584,1),B=mC("Line",4,0,327,1),Q=[u,B];B=WG();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];u=[""];({Hlc:Qa,L8a:qa,wbc:rb}=iI(b,$c.a.ehc,$c.a.dhc));var qa={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:Of.a.h0a(qa),["validUnits"]:Q,["numberFormatInfo"]:B,["validReservedValues"]:ca};rb?qa.reservedValue=ca[0]:qa.value=isNaN(Qa)?"":Qa;h.beforeSpacingSpinButtonProps=qa;({Hlc:Qa,L8a:qa,wbc:rb}=iI(b,$c.a.chc,$c.a.bhc));Q={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Of.a.h0a(qa),["validUnits"]:Q,["numberFormatInfo"]:B,["validReservedValues"]:ca};
rb?Q.reservedValue=ca[0]:Q.value=isNaN(Qa)?"":Qa;h.afterSpacingSpinButtonProps=Q;if(ca=Q=b.hasProperty($c.a.xa))ca=tD.xGa.XFb(b),ca=b.hasProperty($c.a.xa)&&b.hasProperty($c.a.N4a)&&2===b.getValue($c.a.N4a)?!qe.a.pxa(ca,1)&&!qe.a.pxa(ca,1.5)&&!qe.a.pxa(ca,2):!1;if(Q){var Qa=tD.xGa.XFb(b);Q=0;var rb=!1;b.hasProperty($c.a.xa)&&b.hasProperty($c.a.N4a)||(rb=!0);rb||(2!==b.getValue($c.a.N4a)&&(rb=!0),Q=Qa,1>Q&&(rb=!0));rb?Q="":(Qa="multiple",ca||(qe.a.pxa(Q,1)?Qa="1.00":qe.a.pxa(Q,1.5)?Qa="1.50":qe.a.pxa(Q,
2)&&(Qa="2.00")),Q=Qa)}else Q=null;Qa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:lG([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};Q?Qa.selectedKey=Q:Qa.defaultSelectedKey="";h.lineSpacingComboBoxProps=Qa;Q=0;Qa=!1;b.hasProperty($c.a.xa)&&b.hasProperty($c.a.N4a)&&2===b.getValue($c.a.N4a)&&ca&&(Q=tD.xGa.XFb(b),Qa=!0,1>Q&&(Q=Number.NaN));b=[mC("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:B,["validReservedValues"]:u};Qa?b.value=Q:b.reservedValue=u[0];h.atSpinButtonProps=b;return h}Z9b(){return this.DMa||(this.DMa=this.r5b())}r5b(){const b={};b[$c.a.xa.id.toString()]=Dm.BZm;b[$c.a.chc.id.toString()]=Dm.GZi;b[$c.a.bhc.id.toString()]=Dm.GZi;b[$c.a.ehc.id.toString()]=Dm.HZi;b[$c.a.dhc.id.toString()]=Dm.HZi;return b}static get xGa(){return null!=tD.sCg?tD.sCg:tD.sCg=Ga.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(m.a)(tD,"ReactParagraphDialog",null,[]);const kI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,XG=(b,h,u,B)=>{let Q=Fb.App.xia;b.hasProperty(h)&&b.hasProperty(u)&&!B?(h=b.getValue(h),b=b.getValue(u),h?2===b?Q=2:h=Of.a.h9a(h,Q):Fb.App.gGa&&(Q=2)):(h=Number.NaN,Fb.App.gGa&&(Q=2));return{Hlc:h,L8a:Q}},iM=b=>{let h="0";b.hasProperty($c.a.O5)&&(b=b.getValue($c.a.O5),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},lI=(b,h)=>{if(h.hasProperty($c.a.O5)&&2===h.getValue($c.a.O5)&&h.hasProperty($c.a.lUa)&&h.hasProperty($c.a.kUa)&&
b.hasProperty($c.a.tHa)&&b.hasProperty($c.a.sHa)){var u=b.getValue($c.a.tHa),B=b.getValue($c.a.sHa);u=(new qm.a(B,u)).Ut;B=h.getValue($c.a.lUa);h=h.getValue($c.a.kUa);h=(new qm.a(h,B)).Ut;b.setValue($c.a.tHa,u+h);b.setValue($c.a.sHa,1)}},mI=b=>{const h=b.getValue($c.a.tHa);b=b.getValue($c.a.sHa);return(new qm.a(b,h)).Ut},nI=b=>{const h=b.getValue($c.a.Knb);b=b.getValue($c.a.Jnb);return(new qm.a(b,h)).Ut},oI=(b,h)=>h.hasProperty($c.a.tHa)&&h.hasProperty($c.a.sHa)&&h.hasProperty($c.a.Knb)&&h.hasProperty($c.a.Jnb)&&
b.hasProperty(Jc.a.marginLeft)&&b.hasProperty(Jc.a.marginRight)&&b.hasProperty(Jc.a.Go),jM=b=>b.hasProperty($c.a.w2c)?b.getValue($c.a.w2c):!1,kM=b=>b.hasProperty(Ud.a.keepWithNext)?b.getValue(Ud.a.keepWithNext):!1,lM=b=>b.hasProperty(Ud.a.widowControl)?b.getValue(Ud.a.widowControl):!1,mM=b=>b.hasProperty(Ud.a.keepTogether)?b.getValue(Ud.a.keepTogether):!1;class pI extends Hf.a{constructor(b,h,u,B){super(!1,!1,!0);this.Vkh=null;this.zxn=()=>{Ga.a.instance.resolve("Box4.UI.IBox4DialogFactory").wId(this.tBa,
this.kua,this.e7)};this.Bxn=(rb,Lb)=>{if(Lb&&(1===rb||2===rb)){if(Lb.alignmentComboBoxProps){var Yb=parseInt(Lb.alignmentComboBoxProps.selectedKey);isNaN(Yb)||kI(Yb)&&this.Gp.setValue($c.a.ww,Yb)}var gc=Lb.bySpinButtonProps;Yb=!!gc&&""!==gc.value;var Fc=Lb.didChangeSpecialIndentationComboBoxValue;if(Lb.specialIndentationComboBoxProps){var Sc=parseInt(Lb.specialIndentationComboBoxProps.selectedKey);1!==Sc&&2!==Sc&&Sc||!(Sc||Fc||Yb)||this.Gp.setValue($c.a.O5,Sc)}if(gc){Sc=gc.value;gc=Of.a.pOa(gc.unitType.toLowerCase());
let ld;0<=Sc||(Sc=0);2===gc?ld=2:(ld=1,Sc=Of.a.mJa(Sc,gc));if(Yb||Fc)this.Gp.setValue($c.a.lUa,Sc),this.Gp.setValue($c.a.kUa,ld)}Lb.beforeTextSpinButtonProps&&(Fc=Lb.beforeTextSpinButtonProps,Yb=Of.a.pOa(Fc.unitType.toLowerCase()),Fc=""===Fc.value?Number.NaN:Fc.value,isNaN(Fc)||(Sc=Fc,2===Yb?gc=2:(gc=1,Sc=Of.a.mJa(Fc,Yb)),this.Gp.setValue($c.a.tHa,Sc),this.Gp.setValue($c.a.sHa,gc)));Lb.afterTextSpinButtonProps&&(Fc=Lb.afterTextSpinButtonProps,Yb=Of.a.pOa(Fc.unitType.toLowerCase()),Fc=""===Fc.value?
Number.NaN:Fc.value,isNaN(Fc)||(Sc=Fc,2===Yb?gc=2:(gc=1,Sc=Of.a.mJa(Fc,Yb)),this.Gp.setValue($c.a.Knb,Sc),this.Gp.setValue($c.a.Jnb,gc)));Lb.beforeSpacingSpinButtonProps&&(Yb=Lb.beforeSpacingSpinButtonProps,Fc=Of.a.pOa(Yb.unitType.toLowerCase()),Sc=Yb.reservedValue,""!==Yb.value&&(Sc===Box4Intl.Box4Strings.L_SpinnerAuto?(Fc=1,Yb=0):(Fc=4===Fc?2:4,Yb=Yb.value),this.Gp.setValue($c.a.ehc,Yb),this.Gp.setValue($c.a.dhc,Fc)));Lb.afterSpacingSpinButtonProps&&(Yb=Lb.afterSpacingSpinButtonProps,Fc=Of.a.pOa(Yb.unitType.toLowerCase()),
Sc=Yb.reservedValue,""!==Yb.value&&(Sc===Box4Intl.Box4Strings.L_SpinnerAuto?(Fc=1,Yb=0):(Fc=4===Fc?2:4,Yb=Yb.value),this.Gp.setValue($c.a.chc,Yb),this.Gp.setValue($c.a.bhc,Fc)));if(Lb.atSpinButtonProps||Lb.lineSpacingComboBoxProps)if(Yb=Lb.atSpinButtonProps.value,1<Yb)this.Gp.setValue($c.a.xa,Yb),this.Gp.setValue($c.a.N4a,2);else if(Yb=Lb.lineSpacingComboBoxProps.selectedKey)Yb="1.00"===Yb?1:"1.50"===Yb?1.5:"2.00"===Yb?2:0,Yb=1<=Yb?Yb:1,this.Gp.setValue($c.a.xa,Yb),this.Gp.setValue($c.a.N4a,2);Lb.contextualSpacingCheckboxProps&&
this.Gp.setValue($c.a.w2c,Lb.contextualSpacingCheckboxProps.checked);Lb.keepWithNextCheckboxProps&&this.Gp.setValue(Ud.a.keepWithNext,Lb.keepWithNextCheckboxProps.checked);Lb.widowOrphanCheckboxProps&&this.Gp.setValue(Ud.a.widowControl,Lb.widowOrphanCheckboxProps.checked);Lb.keepTogetherCheckboxProps&&this.Gp.setValue(Ud.a.keepTogether,Lb.keepTogetherCheckboxProps.checked);lI(this.tBa,this.tBa);lI(this.Gp,this.tBa);Lb="";Yb=this.kua;Fc=this.Gp;if(Sc=oI(Yb,Fc))Sc=Fc.hasProperty($c.a.lUa)&&Fc.hasProperty($c.a.kUa);
Sc?(Sc=Fc.getValue($c.a.lUa),gc=Fc.getValue($c.a.kUa),Sc=(new qm.a(gc,Sc)).Ut,Yb=mI(Fc)+nI(Fc)+Yb.getValue(Jc.a.marginRight)+Yb.getValue(Jc.a.marginLeft)+Sc+Fb.App.lAa<=Yb.getValue(Jc.a.Go)):Yb=oI(Yb,Fc)?mI(Fc)+nI(Fc)+Yb.getValue(Jc.a.marginRight)+Yb.getValue(Jc.a.marginLeft)+Fb.App.lAa<=Yb.getValue(Jc.a.Go):!0;Yb?iG(this.tBa,this.Gp,this.cjm(this.xRe?this.xRe.r5b():{})):Lb=""!==Lb?Lb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Lb?this.kIa(Lb,this.zxn):2===rb&&(Fe.c(Qc.a.llc,
!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Rb(Qc.a.llc,2,null))}};this.tBa=b.clone();this.Gp=b.clone();this.kua=h.clone();this.e7=u;this.ga=B;this.xRe=new tD;b=this.xRe.E6l(this.Gp);h=mC("Inch",3,-11,22,.1);u=mC("Inch",3,0,22,.1);var Q=mC("Centimeter",1,-27.94,55.88,1);B=mC("Centimeter",1,0,55.88,1);var ca=mC("Character",2,-316.8,316.8,.5),qa=mC("Character",2,0,316.8,.5);h=[h,Q,ca];B=[u,B,qa];u=WG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};Q=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ca=["1","2","3","6","7"];let Qa=5;qa=this.Gp.hasProperty($c.a.ww)?this.Gp.getValue($c.a.ww):0;if(10===qa||9===qa)qa=11;if(v.AFrameworkApplication.lcid===Jj.a.qg("AR-SA").LCID||11===qa)b.isKashidaSupported=!0,Q[Qa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
ca[Qa]="11",Qa=6;if(v.AFrameworkApplication.lcid===Jj.a.qg("TH-TH").LCID||13===qa)b.isThaiSupported=!0,Q[Qa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ca[Qa]="13";Q={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:lG(Q,ca),["allowFreeForm"]:!1};kI(qa)?Q.selectedKey=qa.toString():Q.defaultSelectedKey="";b.alignmentComboBoxProps=
Q;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};qa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:kM(this.Gp)};b.keepWithNextCheckboxProps=qa;qa={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:lM(this.Gp)};
b.widowOrphanCheckboxProps=qa;qa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:mM(this.Gp)};b.keepTogetherCheckboxProps=qa;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};Q=iM(this.Gp);qa="0"===Q;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:lG([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:Q,["allowFreeForm"]:!1};ca=Fb.App.xia;Q=0;({Hlc:Q,L8a:ca}=XG(this.Gp,$c.a.lUa,$c.a.kUa,qa));B={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Of.a.h0a(ca),["validUnits"]:B,["numberFormatInfo"]:u};B=this.dQb(Q,B);b.bySpinButtonProps=B;qa=Fb.App.xia;B=0;({Hlc:B,L8a:qa}=XG(this.Gp,$c.a.tHa,$c.a.sHa,!1));qa={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Of.a.h0a(qa),["validUnits"]:h,["numberFormatInfo"]:u};
qa=this.dQb(B,qa);b.beforeTextSpinButtonProps=qa;qa=Fb.App.xia;B=0;({Hlc:B,L8a:qa}=XG(this.Gp,$c.a.Knb,$c.a.Jnb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Of.a.h0a(qa),["validUnits"]:h,["numberFormatInfo"]:u};h=this.dQb(B,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};u={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:jM(this.Gp)};b.contextualSpacingCheckboxProps=u;h.dialogButtonsOption=9;b=hM.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?
void 0:"left",["margin-left"]:"0"}}};this.Qh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.Bxn,h)}cjm(b){return this.Vkh||(this.Vkh=this.gbf(b))}gbf(b){b[$c.a.ww.id.toString()]=Dm.sWm;b[$c.a.sHa.id.toString()]=Dm.zZi;b[$c.a.tHa.id.toString()]=Dm.zZi;b[$c.a.Jnb.id.toString()]=Dm.BZi;b[$c.a.Knb.id.toString()]=Dm.BZi;b[$c.a.O5.id.toString()]=Dm.ehg;b[$c.a.kUa.id.toString()]=Dm.ehg;b[$c.a.lUa.id.toString()]=Dm.ehg;b[$c.a.w2c.id.toString()]=Dm.u4k;b[Ud.a.keepWithNext.id.toString()]=Dm.DWm;b[Ud.a.widowControl.id.toString()]=
Dm.T1o;b[Ud.a.keepTogether.id.toString()]=Dm.BWm;return b}dQb(b,h){h.value=isNaN(b)?"":b;return h}}Object(m.a)(pI,"WordReactParagraphDialog",Hf.a,[]);class Sw extends Hf.a{constructor(b,h,u,B){super(!1,!1,!0);this.e_k=()=>{this.aLc.XJh(this.Zpi,this.koe,this.MXc)};this.f_k=(Q,ca)=>{ca&&1===Q&&(ca.columnsCountSpinButtonProps&&this.CY.setValue(Ud.a.XE,ca.columnsCountSpinButtonProps.value),ca.columnsWidthSpinButtonProps&&(Q=ca.columnsWidthSpinButtonProps,this.CY.setValue(Ud.a.mG,[Of.a.mJa(Q.value,Of.a.pOa(Q.unitType.toLowerCase()))])),
ca.columnsSpacingSpinButtonProps&&(Q=ca.columnsSpacingSpinButtonProps,this.CY.setValue(Ud.a.gna,Of.a.mJa(Q.value,Of.a.pOa(Q.unitType.toLowerCase())))),ca.columnsLineBetweenCheckboxProps&&this.CY.setValue(Ud.a.separator,ca.columnsLineBetweenCheckboxProps.checked),this.i_k()&&(ca=Sw.jDd,this.iFk()?iG(this.Zpi,this.CY,this.Z9b):ca=ca!==Sw.jDd?ca:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ca!==Sw.jDd&&this.kIa(ca,this.e_k)))};this.i_k=()=>this.CY.hasProperty(Ud.a.XE)&&this.CY.hasProperty(Ud.a.mG)&&
this.CY.hasProperty(Ud.a.gna)&&this.CY.hasProperty(Ud.a.separator);this.xPd=(Q,ca,qa)=>Math.floor((Q-(ca-1)*qa)/ca);this.tnf=(Q,ca,qa)=>1==ca?0:Math.floor((Q-ca*qa)/(ca-1));this.Uyk=(Q,ca,qa,Qa)=>{const rb=Q/ca;qa<Sw.Glc?(qa=Sw.Glc,Qa=this.tnf(Q,ca,qa)):qa>rb&&(qa=rb,Qa=this.tnf(Q,ca,qa));return[qa,Qa]};this.Qyk=(Q,ca,qa,Qa)=>{const rb=(Q-Sw.Glc*ca)/(ca-1);0>Qa?(Qa=0,qa=this.xPd(Q,ca,Qa)):Qa>rb&&(Qa=rb,qa=this.xPd(Q,ca,Qa));return[qa,Qa]};this.mJa=(Q,ca)=>Of.a.mJa(Q,Of.a.pOa(ca));this.eKc=(Q,ca,qa,
Qa,rb)=>({["unitType"]:Q,["unitPlaceholder"]:F.a.V9d(ca),["minValue"]:qa,["maxValue"]:Qa,["step"]:rb});this.Zpi=b.clone();this.CY=b.clone();this.koe=h.clone();this.Fnb=this.koe.getValue(Jc.a.Go)-this.koe.getValue(Jc.a.marginLeft)-this.koe.getValue(Jc.a.marginRight);this.bLb=Math.floor(this.Fnb/Sw.Glc);this.MXc=u;this.aLc=B;this.ug=Sw.id;b={};b.getUnitValue=3==Fb.App.xia?Of.a.Wz:Of.a.VUa;b.getCalculatedWidthValue=this.xPd;b.getCalculatedSpacingValue=this.tnf;b.twipsFromValueAndUnits=this.mJa;b.adjustWidthForLimits=
this.Uyk;b.adjustSpacingForLimits=this.Qyk;b.pageContentWidth=this.Fnb;b.maxColumnCount=this.bLb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.OPl();b.columnsWidthSpinButtonProps=this.SPl();b.columnsSpacingSpinButtonProps=this.QPl();b.columnsLineBetweenCheckboxProps=this.PPl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Qh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,
this.f_k.bind(this),b)}OPl(){var b=[this.eKc("None",0,1,this.bLb,1)];const h=this.stf(Ud.a.XE);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Of.a.h0a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};
return b=this.dQb(h,b)}SPl(){var b=[this.eKc("Inch",3,.5,Of.a.Wz(this.Fnb),.1),this.eKc("Centimeter",1,1.27,Of.a.VUa(this.Fnb),1)];const h=Fb.App.xia,u=this.stf(Ud.a.mG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Of.a.h0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.dQb(u,b)}QPl(){var b=[this.eKc("Inch",3,0,Of.a.Wz(this.Fnb-2*Sw.Glc),.1),this.eKc("Centimeter",1,0,Of.a.VUa(this.Fnb-2*Sw.Glc),1)];const h=Fb.App.xia,u=this.stf(Ud.a.gna);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Of.a.h0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.dQb(u,b)}PPl(){const b=this.CY.getValue(Ud.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get Z9b(){return null!=this.lzg?this.lzg:this.lzg=(()=>this.gbf())()}gbf(){const b=
{};b[Ud.a.XE.id.toString()]=b[Ud.a.mG.id.toString()]=b[Ud.a.gna.id.toString()]=b[Ud.a.separator.id.toString()]=sr.h_k;return b}iFk(){const b=this.CY.getValue(Ud.a.mG),h=this.CY.getValue(Ud.a.XE),u=this.CY.getValue(Ud.a.gna);let B=0;for(let Q=0;Q<h;Q++)B+=b[0];if(h<=this.bLb&&(h-1)*u+B<=this.Fnb)return!0;r.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],u);return!1}stf(b){if(this.CY.hasProperty(b)){if(b==
Ud.a.XE)return this.CY.getValue(b);if(b==Ud.a.mG){var h=Fb.App.xia;b=this.CY.getValue(Ud.a.gna);const u=this.CY.getValue(Ud.a.XE);return Of.a.h9a(this.xPd(this.Fnb,u,b),h)}if(b==Ud.a.gna){if(1==this.CY.getValue(Ud.a.XE))return 0;h=Fb.App.xia;b=this.CY.getValue(b);return Of.a.h9a(b,h)}}return 0}dQb(b,h){h.value=isNaN(b)?Sw.jDd:b;return h}}Sw.id="ColumnsDialog";Sw.jDd="";Sw.Glc=720;Object(m.a)(Sw,"WordReactColumnsDialog",Hf.a,[]);class qI{B7k(b){new DE(b,Ga.a.instance.resolve("Box4.IFeatureHelper"))}Eal(b,
h){new gI(b,h,Ga.a.instance.resolve("Box4.IFormattingReader"),Ga.a.instance.resolve("Box4.Styles.IWACStyleReader"),Zo.PageNavigator.instance)}xrl(b,h,u){new hI(b,h,u)}hLh(b,h,u){new gA(b,h,u,Ga.a.instance.resolve("WordEditor.IPageCommands"),Ga.a.instance.resolve("Common.IStandaloneRootController").eea)}NLh(b,h,u){new Ut(b,h,u,Ga.a.instance.resolve("WordEditor.IPageCommands"),Ga.a.instance.resolve("Common.IStandaloneRootController").eea)}XJh(b,h,u){new Sw(b,h,u,Ga.a.instance.resolve("WordEditor.UI.IDialogFactory"))}W6k(b){return new XD(b)}wId(b,
h,u){new pI(b,h,u,v.AFrameworkApplication.va)}cjl(){const b=Ga.a.instance.Oa("Box4.IRoamingServiceRequestManager");null==b?Pc.b(524834398,3018,10,"Roaming service not resolved."):new YH(b)}hjl(b,h){new ZH(b,h)}mdf(b){return new $H(b)}}Object(m.a)(qI,"DialogFactory",null,[547,548]);class EF extends Hf.a{constructor(b,h){super(!1,!1,!0);this.zSh="DoNotCheckSpellingCheckbox";this.OSh="DocumentChoiceGroup";this.lid=0;this.ZDi="LanguageList";this.documentContext="DocumentContext";this.gr="RangeContext";
this.Cho=(u,B)=>{const Q=Wh.a.instance.Ap(Ob.a.wkj);if(1!==u)Q.properties.Z("canceled","true");else{u=B[this.ZDi].replace(EF.ntg,"");var ca=parseInt(u),qa=Boolean.parse(B[this.zSh]);B=B[this.OSh];B===this.documentContext?this.dpd.rfo(ca,qa):this.dpd.Hko(ca,qa);Q.properties.Z("PreviousLCID",this.lid.toString());Q.properties.Z("ChangedLCID",ca.toString());Q.properties.Z("NoProof",qa.toString());this.l2g.Bho(ca,this.lid);Fe.d(Ob.a.wkj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"SelectedLcid",
string:u}),Object.assign(new ha.a,{name:"NoProof",string:qa.toString()}),Object.assign(new ha.a,{name:"Context",string:B})]);Fb.App.za.updateCommandUI(!0)}Q.end()};this.l2g=h;this.dpd=b}Yfg(){const b=Array(2);b[0]={["key"]:this.gr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps=
{["id"]:this.OSh,["defaultSelectedKey"]:this.gTl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.lid=({RHn:this.bZj}=this.dpd.$am()).returnValue;h.languageListPropsProvider=this.Y_l();h.spellingCheckboxProps={["id"]:this.zSh,["checked"]:!this.bZj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Qh(Box4Intl.Box4Strings.l_Language,this.Cho,{["id"]:"LanguageDialog",["bodyControls"]:h})}gTl(){return this.dpd.ef()?this.documentContext:
this.gr}Y_l(){return()=>{let b,h;const u=({selectedIndex:b,htj:h}=this.l2g.X_l(this.lid)).returnValue;for(let B=0;B<u.length&&B<h;B++)u[B].value=EF.ntg+u[B].value;return{["id"]:this.ZDi,["items"]:u,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}EF.ntg="recent-";Object(m.a)(EF,"ReactLanguageDialog",Hf.a,[290]);class rI extends TC{constructor(b,h,u,B){super(h,u);this.X_f=()=>{this.floatie.Bm()};this.Lh=b;this.DI=B}Mfb(b,h,u){if(b=super.Mfb(b,h,u))b.Nhc=!0,b.E$d=!0,b.preventDismissOnScroll=!0;
this.Lh.YZa(this.X_f);return b}WTc(b,h,u=null){this.DI.Fvh(()=>this.Mfb(b,h,u))}x6d(){this.floatie.Nhc=!0}}Object(m.a)(rI,"ExternalContentFloatieInitializer",TC,[]);class sI{bNb(){Tg.instance.wpa&&(Is.instance.V8a([1,0]),Tg.instance.K0d()&&$r.instance.V8a([1]))}}Object(m.a)(sI,"RulerUser",null,[281]);class tI{constructor(){this.whitelistedControlIds=null}}Object(m.a)(tI,"StatusBarProps",null,[]);class FF{constructor(b,h,u=!0){this.sa=new Nc.a;this.Qtd=!1;this.FOe=null;this.Wfa=h.cH;this.XSe=h.duj;
u?Yk.a.get_instance().lk(7,()=>{this.Kxh(b,h)}):this.Kxh(b,h)}Kxh(b,h){window.setTimeout(()=>{nr.a.instance.ge(()=>{mk.UISurfaces.$cm().then(u=>{const B=Object.assign(new tI,{whitelistedControlIds:h.whitelistedControlIds});u.initializeNewStatusBar(b,B,this.XSe);this.FOe=u;this.Qtd=!0;window.setTimeout(()=>{nr.a.instance.ge(()=>{const Q=[];if(h.$G){const ca=h.$G;for(let qa in ca)Q.push(appChrome.actions.updateControlHiddenState(qa,ca[qa]));appChrome.api.dispatch(Q)}this.bNb()},"RSB:I2")},0);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&
this.eMn();return null}).catch(()=>{r.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.vra&&b){FF.GWg||(v.AFrameworkApplication.va.ra(Za.a.fuj,Ad.a.frame,Object(z.a)(this,this.guj,"statusBarTabAction")),v.AFrameworkApplication.va.ra(Za.a.euj,Ad.a.frame,Object(z.a)(this,this.guj,"statusBarTabAction")),FF.GWg=!0);const u=hs.a.OWd(h.vra,h.Ljj,b,!1);u.$H=!0;this.uic(u,Za.a.fuj,Za.a.euj)}},0)}bNb(){this.Qtd&&this.Wfa&&window.setTimeout(()=>{this.Wfa(this.FOe.selectors.getStatusBarControlsMap(this.XSe),
7)},0)}lpb(b,h){this.Qtd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}bV(b){this.Qtd&&this.Wfa&&window.setTimeout(()=>{const h=this.FOe.selectors.getStatusBarControlsMap(this.XSe);if(h[b]){const u={};u[b]=h[b];this.Wfa(u,7)}},0)}uic(b,h,u){const B=Nb.KeyInputManager.ic(Se.a.Fw,0),Q=Nb.KeyInputManager.ic(Se.a.Fw,4);b.kr(B);b.kr(Q);b.bindAction(B,h);b.bindAction(Q,u)}guj(){return 4}eMn(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=
null)}}FF.GWg=!1;Object(m.a)(FF,"ReactStatusBar",null,[]);class uI{constructor(){this.whitelistedControlIds=this.$G=this.cH=null;this.eVm=!1;this.Ljj=this.vra=this.duj=null}}Object(m.a)(uI,"ReactStatusBarInitOptions",null,[]);var YD=c(444);class vI{constructor(b,h,u,B,Q){this.LZb=this.EMa=this.Ga=null;this.YAo=()=>{const ca=Fb.App.za.Dp.getRegion(Zj.AppFrame.vra);ca&&ca.XOf()};this.$om=(ca,qa,Qa,rb,Lb)=>{if(!Lb)return r.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),
8;if(1===Qa)return 32;Lb&&2===Lb.length&&this.EMa&&this.EMa.lpb(Lb[0],Lb[0]);return 32};this.Hcd=ca=>{Fb.App.za.cH(ca)};this.ga=B;nr.a.instance.ge(()=>{this.Ga=Q;this.LZb=this.EMa=null;const ca={};v.AFrameworkApplication.irj||(ca[YD.a.u7n]=!0);ca.GiveFeedback=!v.AFrameworkApplication.FF;this.Ga.$("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[YD.a.YYi]=!0;this.Ga.$("WPMPackageIsEnabled")&&this.Ga.$("WPMStatusBarLabelIsEnabled")||(ca[YD.a.mrg]=!0);this.Ga.$("AddInCommandsIsEnabled")||
(ca[YD.a.jrk]=!0);this.Ga.$("WordEditorShowOcsConnectionStatus")||(ca[YD.a.nTf]=!0);ca[YD.a.A2o]=!0;this.Ga.$("ReadingTimeIsEnabled")||(ca[YD.a.V5i]=!0);window.setTimeout(()=>{this.Dzm(b,ca)},0)},"SBU:I")}Tb(){this.ga.fb(Ob.a.zje,vc.a.application,this.$om,96)}Dzm(b,h){this.LZb=Ga.a.instance.Oa("WordEditor.WordEditorReactCommandDefinitionMapping");const u={};for(const Q in h){var B=h[Q];u[this.vsf(Q)]=B}this.EMa=new FF(b,Object.assign(new uI,{$G:u,cH:this.Hcd,eVm:!1,duj:"WordEditorStatusBar",vra:Zj.AppFrame.vra,
Ljj:this.YAo}))}vsf(b){let h="";if(this.LZb){const u=this.LZb.ipf(b);u&&0<u.count&&(h=u.J(0))}return h&&""!==h?h:b}bNb(){this.EMa&&this.EMa.bNb()}lpb(b,h){this.EMa&&this.EMa.lpb(this.vsf(b),h)}bV(b){this.EMa&&this.EMa.bV(this.vsf(b))}dispose(){}}Object(m.a)(vI,"StatusBarUser",null,[282,10]);var wI=c(1075);class YG{constructor(b){this.ga=b;this.ga.ra(Za.a.v6c,Ad.a.frame,Object(z.a)(this,this.v6c,"reportFileMenuPageSwitch"));this.ga.ra(Za.a.ubj,Ad.a.frame,dd.ActionManager.Lf)}v6c(b,h,u,B,Q){this.ga.processAction(this.NVl(Q[wI.a.U8d]),
2);return 32}}Object(m.a)(YG,"FileMenuSQMInformation",null,[909]);class xI extends YG{constructor(b){super(b);this.VSn()}VSn(){this.ga.ra(Za.a.q8f,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.obj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.r8f,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.pbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.qbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.s8f,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.rbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.sbj,
Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.tbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.Ubj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.Vbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.xbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.ybj,Ad.a.frame,dd.ActionManager.Lf)}NVl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Za.a.q8f;case "tabHome":case "FileHomePage":return v.AFrameworkApplication.le("1ba3i132;45gid285"),Za.a.obj;case "menuJewelInfo":case "FileInfoPage":return Za.a.r8f;
case "menuJewelNew":case "FileNewPage":return Za.a.pbj;case "menuJewelOpen":case "FileOpenPage":return Za.a.qbj;case "menuJewelPrint":case "FilePrintPage":return Za.a.s8f;case "menuJewelSaveAs":case "FileSaveAsPage":return Za.a.rbj;case "menuJewelShare":case "FileSharePage":return Za.a.sbj;case "menuJewelTransform":case "FileTransformPage":return Za.a.tbj}return Za.a.ubj}}Object(m.a)(xI,"WordEditorFileMenuSQMInformation",YG,[]);var yI=c(1073);class ZG{constructor(b){this.ga=b;this.ga.ra(Za.a.w6c,
Ad.a.frame,Object(z.a)(this,this.w6c,"reportTabSwitch"));this.ga.ra(Za.a.Pbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.Rbj,Ad.a.frame,dd.ActionManager.Lf)}w6c(b,h,u,B,Q){this.ga.processAction(this.T$l(Q[yI.a.kjg]),2);return 32}}Object(m.a)(ZG,"RibbonSQMInformation",null,[862]);class zI extends ZG{constructor(b){super(b);this.mVn()}mVn(){this.ga.ra(Za.a.Gbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.Ibj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.u8f,Ad.a.frame,dd.ActionManager.Lf);
this.ga.ra(Za.a.Jbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.Kbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.Lbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.Mbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.Nbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.Obj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.v8f,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.Qbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Za.a.Sbj,Ad.a.frame,dd.ActionManager.Lf);this.ga.ra(Qc.a.Tbj,Ad.a.frame,dd.ActionManager.Lf);
this.ga.ra(Qc.a.Hbj,Ad.a.frame,dd.ActionManager.Lf)}T$l(b){switch(b){case "tabAddins":case "Addins":return Za.a.Gbj;case "tabHome":case "Home":return Za.a.Jbj;case "tabInsert":case "Insert":return Za.a.Kbj;case "tabDeveloper":case "Developer":return Za.a.Ibj;case "tabPageLayout":case "Layout":return Qc.a.Lbj;case "tabReferences":case "References":return Qc.a.Obj;case "tabReview":case "Review":return Qc.a.v8f;case "tabView":case "View":return Za.a.Sbj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Qc.a.Qbj;
case "tabMailings":case "Mailings":return Qc.a.Mbj;case "tabWordDesign":case "Design":return Qc.a.Tbj;case "tabHelp":case "Help":return Qc.a.u8f;case "ctabPictureTools":case "Picture":return Qc.a.Nbj;case "Copilot":return Qc.a.Hbj}return Za.a.Rbj}}Object(m.a)(zI,"WordEditorRibbonSQMInformation",ZG,[]);class AI{constructor(b=null,h=null,u=null){this.$G=b||{};this.lAj=h||[];this.pAj=u||{}}}Object(m.a)(AI,"RibbonTrimmingProperties",null,[]);class BI{constructor(b,h,u){this.Fva=b;this.$G=h;this.SHf=u}}
Object(m.a)(BI,"ReactRibbonJewelProperties",null,[]);class CI{constructor(){v.AFrameworkApplication.va.ra(Za.a.yRa,Ad.a.frame,Object(z.a)(this,this.cNn,"reactFileMenuOpenFromTellMe"))}cNn(b,h,u,B,Q){if(1===u)return 32;v.AFrameworkApplication.zia("54hi9858;4f638686");if(!Q)return 32;b=Q.SourceControlId;17!==Q.UILocation||"New"!==b&&"Open"!==b||(Q=[],ah.d("setFileMenuSelectedPage")&&("New"===b&&v.AFrameworkApplication.ua?2===v.AFrameworkApplication.ua.Lb.Nk?Q.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
Q.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&v.AFrameworkApplication.ua&&(2===v.AFrameworkApplication.ua.Lb.Nk?Q.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):Q.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),Q.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(Q));return 32}PEi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}aTa(){return!1}M0i(){}gSh(){}}Object(m.a)(CI,"ReactFileMenu",
null,[359]);class DI{Q$e(){const b=new CI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(m.a)(DI,"ReactFileMenuFactory",null,[325]);class FE{constructor(b,h,u,B=!1){this.Qmc=b;this.S_g=this.Qmc.V3a;this.F5d=Ga.a.instance.Oa("Common.IOfficeTrialExperience");this.UKb=Ga.a.instance.Oa("Common.IMacOfficeOffer");FE.oue=!1;this.IPm=B;this.ga=h;this.Vb=u}get nc(){return this.ga}get focusManager(){return this.Vb}J1e(){return this.S_g&&
!!this.F5d&&!!this.UKb}sVa(b,h){this.Qmc.Hn(()=>{r.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.S_g=!0;this.kif(b,h)});Ga.a.instance.Ta("Common.IOfficeTrialExperience").execute(u=>{r.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.F5d=u;this.kif(b,h)});Ga.a.instance.Ta("Common.IMacOfficeOffer").execute(u=>{r.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.UKb=u;this.kif(b,h)})}kif(b,h){FE.oue||(this.J1e()?(r.ULS.sendTraceTag(5878051,
340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),FE.oue=!0):r.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}FE.oue=!1;Object(m.a)(FE,"RibbonDependencies",null,[751]);class $G{constructor(b,h,u){this.Lub=b;this.ga=h;this.Vb=u}}Object(m.a)($G,"WoncaRibbonUserFactory",null,[96]);class EI{constructor(b,h){this.Cve=b;this.r1b=h}Fpb(b){this.Cve.Fpb(b);this.r1b&&this.r1b.Fpb(b)}F8c(b){this.Cve.F8c(b);this.r1b&&this.r1b.F8c(b)}Kcd(b){this.Cve.Kcd(b);this.r1b&&this.r1b.Kcd(b)}}
Object(m.a)(EI,"RibbonCommandTrimmer",null,[97]);var nM=c(1245),oM=c(1161);class FI{constructor(b,h){this.Ga=b;this.ZZb=h}Fpb(b){Z.a.ri&&6>Z.a.b3a&&(b.fseaInsertPicture=!0);this.Ga.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ga.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ga.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);aF.a.azi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ga.$("InsertOnlinePictureEnabled"),u=v.AFrameworkApplication.rEf();h||(b.fseaInsertOnlinePicture=
!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);u?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);u&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;v.AFrameworkApplication.sEf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);v.AFrameworkApplication.znc&&(b.btnOpenInClient=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")&&
this.Anc(b)}F8c(b){b.menuJewel=!0;v.AFrameworkApplication.FF||(b.jbtnGiveFeedback=!0)}Anc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Kcd(b){delete b.menuJewel;v.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);v.AFrameworkApplication.t6c||(b.jbtnReportAbuse=!0);v.AFrameworkApplication.Tke||(b.jbtnTermsOfUse=!0);v.AFrameworkApplication.qNd||(b.jbtnFileSharing=
!0);v.AFrameworkApplication.Fob||(b.jbtnShareRWC=!0);v.AFrameworkApplication.sjf||v.AFrameworkApplication.npg||(b.jbtnVersion=!0);this.ZZb.F5d&&this.ZZb.F5d.khn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.ZZb.UKb&&this.ZZb.UKb.zqo||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);v.AFrameworkApplication.znc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Fb.App.ys?"btnjOpenInClient":"btnjEditInClient"]=!0;v.AFrameworkApplication.KLo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=
!0,b.jbtnDownloadAsOdt=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?this.Anc(b):v.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;v.AFrameworkApplication.xF&&(this.Anc(b),b.faShare=!0);if(v.AFrameworkApplication.UY||Z.a.jRa||!v.AFrameworkApplication.TSc&&!v.AFrameworkApplication.jjf&&!v.AFrameworkApplication.lpg)b.jbtnFileEmbed=!0;nM.a.Tvm()||(b.btnjClose=!0);v.AFrameworkApplication.vJb?(b.jbtnVersion=
!0,r.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):v.AFrameworkApplication.J0d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);v.AFrameworkApplication.t4f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ga.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&
b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pAi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(v.AFrameworkApplication.$K||".ODT"===Fb.App.nNc.toUpperCase()||!v.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!oM.a.MBd||v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(m.a)(FI,"WoncaCommandTrimmer",null,[97]);var pM=c(1016);c(437);var qM=c(1074),rM=c(1160);class GI{constructor(b,h){this.L2=this.wK=null;this._clientId=b;this.Xaa=h}Hvl(){if(!Le.c(this.L2))return this.L2;this.xhf();this.L2.style.display="block";this.Xaa&&this.Xaa.u_(Object(z.a)(this,this.onResize,"onResize"));return this.L2}onResize(){this.gza()}gza(){this.dhf()?(document.getElementById("application").style.minWidth="0px",(new rM.a(this.L2,null,v.AFrameworkApplication.isRtl)).q9n(this.L2)):
v.AFrameworkApplication.ua.Lb.IJ||qM.a.r9n(this.L2,v.AFrameworkApplication.isRtl)}dhf(){return v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}xhf(){if(Le.c(this.wK)){var b;({ASc:b}=hs.a.Lbd(!v.AFrameworkApplication.fY)).returnValue?(this.wK=qD.a("div"),this.wK.className=hs.a.eyl,this.wK.id=Fm.CuiHelper.OMd,b.appendChild(this.wK),this.qhf(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.s9&&!v.AFrameworkApplication.fY&&this.rhf(),this.Gvl()):v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&r.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}Gvl(){Le.c(this.L2)&&(this.L2=qD.a("div"),this.L2.className=hs.a.Glg,this.L2.style.display="none",this.wK.appendChild(this.L2))}qhf(){Sys.UI.DomElement.addCssClass(this.wK,hs.a.fyl);v.AFrameworkApplication.isRtl&&qD.b(this.wK,"cui-rtl")}rhf(){Sys.UI.DomElement.addCssClass(this.wK,"FlexBoxLayout")}}Object(m.a)(GI,"HeaderSkeleton",
null,[]);var GE=c(624);class aH{constructor(){this.Ppc=null}KNo(){this.Ppc||(this.Ppc=Ga.a.instance.Oa("Common.App.AccountSwitching.IAccountSwitching"))||r.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}$Jl(){this.KNo();return this.Ppc?this.Ppc.getCustomAuthConfig():null}static qIm(){return v.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(m.a)(aH,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class bH{constructor(){this.WJb=this.cultureName=null}}
Object(m.a)(bH,"HeaderCultureInfo",null,[]);var mG=c(1637);class HI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(HI,"SearchInitializationSettings",null,[]);var HE=c(293);class II{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(II,"DocumentTitleAppProps",null,[]);class JI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(JI,"DocumentTitleCalloutAppProps",null,[]);class KI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(KI,"HeaderAppProps",null,[]);class LI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(LI,"HeaderControls",null,[]);class MI{constructor(){this.command=
this.label=null}}Object(m.a)(MI,"WorkflowButtonAppProps",null,[]);var nG;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(nG||(nG={}));Object(m.b)("RenameDisableReason",nG);class NI{constructor(b=""){this.cag=this.documentTitleAppProps=this.krg=null;this.$ik=""!==b?b:Pd.a.Q5}N9l(b){const h=Ga.a.instance.Oa("Common.IExternalUICommandDefinitionMapping").jFb(b);
if(h&&0<h.length)return h[0].externalUxCommand;r.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}hvf(){if(!this.krg){const b=GE.a();if(b){const h=this.N9l(b.command);h&&(this.krg=Object.assign(new MI,{command:h,label:b.label}))}}return this.krg}wRl(){return Object.assign(new LI,{workflowButton:this.hvf()})}pln(){Yk.a.get_instance().iI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;v.AFrameworkApplication.va.Rb(Za.a.lLb,
2,b)}m$l(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}XTl(){let b=null,h=null;var u=Ga.a.instance.Oa("Common.IRenameProps");u?(u=u.zei(),0!==u&&(b=this.m$l(u),h=nG[u])):r.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new JI,{breadcrumbBrandName:v.AFrameworkApplication.Cs.breadcrumbBrandName,
breadcrumbBrandUrl:v.AFrameworkApplication.Cs.breadcrumbBrandUrl,breadcrumbFolderName:v.AFrameworkApplication.Cs.breadcrumbFolderName,breadcrumbFolderUrl:v.AFrameworkApplication.Cs.breadcrumbFolderUrl,hideDocumentTitleInput:v.AFrameworkApplication.ua.Lb.csm,isVersionHistoryEnabled:this.Pro(),documentExtension:F.a.zha(v.AFrameworkApplication.fileName),isMoveEnabled:32===v.AFrameworkApplication.va.processAction(Za.a.lLb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:v.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}B7h(){if(!this.documentTitleAppProps){const b=v.AFrameworkApplication.Cs.uz;this.documentTitleAppProps=Object.assign(new II,{documentTitle:v.AFrameworkApplication.KKd?b:F.a.tJ(b),onFirstRender:Object(z.a)(this,this.pln,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.XTl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Pro(){return!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.mBi}ypo(){return!!v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Lb.lBi}wro(){const b=!GE.b()&&!v.AFrameworkApplication.hideHeader&&!v.AFrameworkApplication.gyf&&(v.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||v.AFrameworkApplication.K.$("TeamsChatIsEnabled"));r.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}B4k(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});r.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}iSn(b=!1){appChrome.getHeaderApi().then(h=>
{const u=Ga.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",B=>{u.onFlexPaneOpen(B)});h.setHeaderCommandHandler("OnFlexPaneClose",B=>{u.onFlexPaneClose(B)});h.setHeaderCommandHandler("SetCookie",B=>ac.a.set(B.cookieName,B.value));h.setHeaderCommandHandler("GetCookie",B=>this.yRl(B));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(z.a)(this,this.hvf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.B7h,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.qln();return null}));mG.a.P_d()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.jfi,"getSearchInitializationSettings"))})}qln(){Ga.a.instance.Ta("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.rrb(!1,v.AFrameworkApplication.va.mode)})}yRl(b){b=
ac.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}Ndm(){return HE.AppChromeOverrideUtilities.isEnabled?HE.AppChromeOverrideUtilities.FSd("suiteux-shell",!1):this.$ik+v.AFrameworkApplication.Dja+"suiteux-shell"}onFirstRender(){Ga.a.instance.Ta("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.soo.continueWith(Object(z.a)(this,this.B4k,"continueShellServiceDataAsync"),3)});Yk.a.get_instance().iI(15)}onFullyLoaded(){Yk.a.get_instance().iI(16)}Iha(b=!1){a:{try{var h=
Jj.a.qg(v.AFrameworkApplication.lcid);if(h){var u=Object.assign(new bH,{cultureName:h.name,WJb:h.WJb});break a}}catch(B){r.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+v.AFrameworkApplication.lcid.toString())}u=Object.assign(new bH,{cultureName:"en-us",WJb:"en"})}h=Ga.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");u=Object.assign(new KI,{appName:CommonUIStrings.l_AppNameShort,culture:u.cultureName,language:u.WJb,isConsumer:!v.AFrameworkApplication.qpg,
showAppLauncher:GE.h(),showMeControl:GE.g(),hideUserName:v.AFrameworkApplication.HVd,defaultDocumentTitleToLeft:v.AFrameworkApplication.GOh,assetsContainerOverride:this.Ndm(),controls:this.wRl(),documentTitleAppProps:b?null:this.B7h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.hvf(),showChatControl:this.wro(),showGoPremiumControl:GE.i(),showDiscoverPremiumButton:GE.f(),enableSearchControl:mG.a.GRm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.ypo(),testTraffic:v.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:v.AFrameworkApplication.zpo()});!v.AFrameworkApplication.MSb||v.AFrameworkApplication.Egg?(u.userDisplayName=v.AFrameworkApplication.userName,u.emailAddress=v.AFrameworkApplication.K.kb("UserPrincipalName"),
u.userID=v.AFrameworkApplication.K.kb("Puid")||"",u.signOutLink=v.AFrameworkApplication.Egg):v.AFrameworkApplication.signInUrl&&(u.signInLink=v.AFrameworkApplication.signInUrl);mG.a.P_d()&&(h=this.jfi(),u.loadTellMeResources=h.loadTellMeResources,u.getTokenRequestDictionary=h.getTokenRequestDictionary,u.enableVanillaSearchBox=v.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),u.userRing=h.userRing);aH.qIm()&&(h=new aH,u.shellAuthProviderConfigPromise=Object(z.a)(h,h.$Jl,"getAccountSwitchingConfig"));
this.iSn(b);v.AFrameworkApplication.le("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return u}jfi(){if(!this.cag){const b=new mG.a;let h=v.AFrameworkApplication.K.kb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.cag=Object.assign(new HI,{loadTellMeResources:b.C0m(),getTokenRequestDictionary:Object(z.a)(b,b.Xfm,"getTokenRequestDict"),userRing:h})}return this.cag}}Object(m.a)(NI,"ReactSharedHeaderPropsHelper",null,[1073]);class cH{constructor(){this.label=
this.value=null}}Object(m.a)(cH,"TextInfoSectionField",null,[]);var GF=c(946),sM=c(1223);class dH{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(dH,"CommandDefinition",null,[]);class OI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(OI,"CommandDefinitionMapping",null,[]);const tM=b=>Object.assign(new OI,{getCommandByExternalUxId:h=>{const u=b.getCommandByExternalUxId(h);return u?
Object.assign(new dH,{commandId:parseInt(u.commandId),externalUxCommand:u.externalUxCommand}):Object.assign(new dH,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(Za.a.Gg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var uM=c(1395);class PI{}Object(m.a)(PI,"RibbonInitState",null,[]);var QI=c(413),vM=c(1332);class RI{constructor(){}flatten(b){const h=
[];for(const u of b)h.push.apply(h,u);return h}}Object(m.a)(RI,"ReactAsyncDispatcher",null,[]);var wM=c(1676);class SI{constructor(b,h){this.uik=b;this.AXj=h}}Object(m.a)(SI,"ReactExecuteCommandContext",null,[]);class Cy{}Cy.Trigger="FontTrigger";Cy.Name="FontName";Cy.Action="FontAction";Cy.Level="FontLevel";Cy.IsPinned="FontIsPinned";Object(m.a)(Cy,"FontPickerLogProperties",null,[]);class TI{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb=null,Yb=null){this.YZ=null;this.Meh=!1;this.xze=[];this.hid=-1;this.Nxd=
!1;this.Fjk=0;this.Orc=null;this.wah=!1;this.Lhd=null;this.G4g=!1;this.Jfa=b;this.Pcb=h;this.aQe=Object(Na.a)(866,b);this.Cl=u;this.Vb=B;Q&&(this.YZ=new wM.a(Q,B));this.Wfk=ca;this.V0j=qa;this.eq=Lb;this.ga=Qa;this.bwb={};this.Ga=rb;this.zug=Yb;rb&&(rb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||rb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&cl.a.instance.YBd.CWR(()=>this.Meh=!0);rb&&(b=this.Ga.kb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&
({Hu:this.Orc}=G.d(b));this.Orc||(this.Orc={})}get cfe(){return!!window.appChrome&&!!appChrome.selectors}Ufj(){-1!==this.hid&&window.clearTimeout(this.hid);this.hid=window.setTimeout(()=>{for(this.hid=-1;0<this.xze.length;){if(Bg.a.instance.Qv){this.Ufj();break}const b=this.xze.shift();b&&this.executeCommand(b.uik,b.AXj)}},0)}executeCommand(b,h){if(Bg.a.instance.Qv){if(this.Meh){this.xze.push(new SI(b,h));this.Ufj();return}r.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
b,h.modelType,mb.a.toJSON(h.payload));if(this.Ga.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const u=this.Cl.getCommandByExternalUxId(b),B=h.modelType;this.zug&&this.zug.T1m(b,h);u?this.Owl(b,u,B,h):this.Pwl(b,B,h);this.VTk(h);this.wLo(h);this.N7m(b,h)}}Pwl(b,h,u){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.lXh(u,b);break;case "ButtonModel":this.Jwl(u,b)}}$Vo(b,h,u,B,Q){if(u.payload)switch(u.payload.type){case "CoauthorMenuPayload":b.MenuItemId=u.payload.coauthorId;
break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=u.payload.commandValueId;b.TerminalParentControlId=u.payload.terminalParentControlId;this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(h=!0,Le.c(u.payload.dismissHostingSurfaceOnExecute)||(h=u.payload.dismissHostingSurfaceOnExecute),h&&this.S3()):this.S3();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=u.payload.commandValueId;Q=h.commandPreviewId;break;
case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=u.payload.commandValueId;Q=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=B;return Q}aWo(b,h,u){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Cl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Cl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":u.CommandId=
h.payload.executedControl;u.ControlId=h.payload.executedControl;u.ParentControlId=h.payload.parentControl;u.CloseAllMenus=!0;this.S3();break;case "TellMeSearchResultChangePayload":u.Value=h.payload.searchText;break;case "SmartLookupPayload":u.CommandValueId=h.payload.selectionContextJson}return b}Owl(b,h,u,B){var Q=this.OBn(B,u),ca=h.commandId;const qa={},Qa={};switch(u){case "SplitButtonModel":if(this.WRc(B.payload,Object(z.a)(this,this.fXo,"updateSplitButtonMenuState"),Q))return;qa.MenuItemId=h.menuItemId;
this.wdg(B,qa);break;case "StatefulSplitButtonModel":if(this.WRc(B.payload,Object(z.a)(this,this.lXo,"updateStatefulSplitButtonMenuState"),Q))return;u=B.payload.statefulData;Q=B.payload.statefulMode;"color"===Q?qa.Color=u:"icon"===Q&&(u=this.Cl.getCommandByExternalUxId(u))&&(qa.MenuItemId=u.menuItemId);break;case "FileMenu":qa.MenuItemId=h.menuItemId;qa.SourceControlId=b;B.payload&&"FileMenuPageSwitchPayload"===B.payload.type&&this.Hmm(ca,B.payload,b);break;case "TellMe":ca=this.aWo(ca,B,qa);qa.SourceControlId=
b;qa.Location=B.payload.location;break;case "ButtonModel":B.payload&&"TabSwitchPayload"===B.payload.type?this.Dom(qa,B):ca=this.$Vo(qa,h,B,b,ca);break;case "CompoundButtonModel":qa.MenuItemId=h.menuItemId;qa.CommandValueId=B.payload.commandValueId;qa.SourceControlId=b;this.wdg(B,qa);this.S3();break;case "ToggleButtonModel":case "InkButtonModel":qa.MenuItemId=h.menuItemId;qa.SourceControlId=b;this.wdg(B,qa);this.S3();break;case "FontPickerModel":switch(B.payload.type){case "MenuOpenPayload":ca=this.Cl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;
qa[By.a.FontPickerId]=B.payload.launcherId;break;case "MenuClosePayload":ca=this.Cl.getCommandByExternalUxId("FontPickerMenuClose").commandId;qa[By.a.FontPickerId]=B.payload.launcherId;break;case "FontPickerFontSelectedPayload":u=B.payload.font;Q=null;"string"===typeof u?(Q=kp.FontUtils.dSa(u),qa.CommandValueId=Q,Q=kp.FontUtils.tId(Q)):(u.data?(qa.CommandValueId=u.data.fontToApply,qa.MenuItemId=u.data.themeIndex,qa[By.a.Formatting]=u.data):qa.CommandValueId=u.name,Q=u);qa.SourceControlId=b;qa[By.a.RequestUpdateMru]=
Q;Qa[Cy.Name]=B.payload.nameToLog?B.payload.nameToLog:"string"===typeof u?kp.FontUtils.xYd(u)?"*"+u:kp.FontUtils.rDf(u)?"[EF]":"[MF]":"";Qa[Cy.IsPinned]=B.payload.isPinned;Qa[Cy.Level]=B.payload.level;this.PLf();break;case "FontPickerFontInfoRequestedPayload":qa.CommandValueId=B.payload.font.name;qa[By.a.Trigger]=B.payload.trigger;Qa[Cy.Trigger]=B.payload.trigger;Qa[Cy.Name]=B.payload.nameToLog;this.PLf();break;case "FontPickerFontPinningPayload":u=B.payload.isPinned;qa.CommandValueId=B.payload.fontKey;
qa[By.a.IsPinned]=u;Qa[Cy.Name]=B.payload.nameToLog;Qa[Cy.Action]=u?"pin":"unpin";Qa[Cy.Level]=B.payload.level;this.PLf();break;default:return}break;case "ComboBoxModel":var rb=B.payload.type;switch(rb){case "MenuOpenPayload":case "MenuPopulatePayload":this.$kc(B.payload.launcherId,Q)&&(ca={},ca[B.payload.launcherId]=u,this.Pcb.c3c(ca,ah.g(B.payload)),this.bwb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":u=B.payload.newValue;if(!u)return;
u.value?(qa[Zh.a.Value]=u.value,qa[Zh.a.IsFreeForm]=!0):(qa[Zh.a.Value]=u.text,qa.MenuItemId=u.key,qa.CommandValueId=u.commandValueId);"ComboBoxPreviewPayload"===rb&&(ca=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(B.payload.type){case "ZeroTermContextMenuClosePayload":u=mb.a.eP(B.payload);for(rb of u)qa[rb]=B.payload[rb];break;default:this.WRc(B.payload,Object(z.a)(this,this.xTo,"updateFlyoutAnchorMenuState"),
Q),qa.launcherId=B.payload.launcherId}break;case "InkFlyoutAnchorModel":this.WRc(B.payload,Object(z.a)(this,this.AUo,"updateInkFlyoutAnchorMenuState"),Q);qa.launcherId=B.payload.launcherId;break;case "ColorPickerModel":switch(B.payload.type){case "ColorPickerPayload":qa[ka.Color]=B.payload.selectedColorId;qa.colorRGB=B.payload.color;break;case "ColorPickerPreviewPayload":ca=h.commandPreviewId;qa[ka.Color]=B.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ca=h.commandRevertId;
break;default:return}break;case "SpinButtonModel":qa[gj.a.Number]=B.payload.value;qa[gj.a.UnitType]=Of.a.pOa(B.payload.unitType.toLowerCase());qa[gj.a.Text]=B.payload.reservedValue;break;case "SliderModel":qa[dn.Value]=B.payload.value;break;case "InsertTableModel":qa[ym.a.Rows]=B.payload.rows;qa[ym.a.Columns]=B.payload.columns;break;case "CheckboxModel":qa[gg.a.On]=B.payload.checked;qa.MenuItemId=h.menuItemId;qa.TerminalParentControlId=B.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.WRc(B.payload,
Object(z.a)(this,this.mWo,"updatePreviewGalleryMenuState"),Q)){qa.launcherId=B.payload.launcherId;break}this.lXh(B,b);return;case "DocumentTitleModel":switch(B.payload.type){case "DocumentTitleRenamePayload":qa.getNewDocumentTitle=B.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[B.payload.launcherId]=u;this.Pcb.c3c(ca,ah.g(B.payload));this.bwb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":qa.MenuItemId=B.payload.url;this.K2m(B.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":qa.MenuItemId=B.payload.assetId;qa.SourceControlId=b;v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(qa.IsPremium=B.payload.isPremium||!1);this.L2m(B.payload.pageId);break;case "CoauthorGallery":qa.RenderTime=B.triggerTime;break;case "PeopleWell":qa.RenderTime=B.triggerTime;break;case "SyncStatus":qa.SourceControlId=b;break;case "InputBoxModel":qa.Text=B.payload.newValue;break;case "PersonaButtonModel":qa.CommandValueId=
B.payload.commandValueId;this.Lnm(B.payload);break;case "MultiActionButtonModel":qa.CommandValueId=B.payload.commandValueId;qa.Href=B.payload.href;qa.Type=B.payload.type;qa.TerminalParentControlId=B.payload.terminalParentControlId;this.S3();break;default:return}ca&&!this.isShadowMenuOpen(B.payload)&&(qa.CommandValueId||(qa.CommandValueId=qa.MenuItemId),h.legacyControlId&&(qa.LegacyId=h.legacyControlId),qa.SourceControlId||(qa.SqmControlId=b),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&qa.launcherId&&(h=this.Cl.getCommandByExternalUxId(qa.launcherId))&&(qa.launcherCommandId=parseInt(h.commandId)),B.payload&&!Le.c(B.payload.PRIReadinessCheck)&&(qa.PRIReadinessCheck=B.payload.PRIReadinessCheck,this.wah=!0),B.payload&&!Le.c(B.payload.shouldTakeFocus)&&(qa[av.a.cUa]=B.payload.shouldTakeFocus),h=this.OYe(B,qa),Le.c(B.triggerTime)||(Qa.TriggerTime=B.triggerTime),B.payload&&!Le.c(B.payload.userActionKey)&&(Qa.userActionKey=B.payload.userActionKey),this.Obg(Qa,B,b,ca),this.aQe.executeCommand(ca,
qa,this.getSelectedTabId(),h,!0,()=>{this.UOf(qa,b)},Qa,ah.g(B.payload)))}Obg(b,h,u,B){if(this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&u&&B&&h.payload){const Q=!Le.c(h.payload.launcherId);u=this.cfj(this.C4l(Q?h.payload.launcherId:u,B),B,!1);b.ControlId=u;const ca=h.payload.inputMethod,qa=h.payload.location;Le.c(ca)||Le.c(qa)||this.a2m(1===ca,2===ca||3===ca||4===ca,Q||"TabSwitchPayload"===h.payload.type,u,qa)}this.Ga&&this.Ga.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&
h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.cfj(h.payload.terminalParentControlId,B,!0))}a2m(b,h,u,B,Q){this.Lhd||(this.Lhd={});const ca=[];Q=ol.a.S8("UILocation",Q,2);Array.add(ca,Q);if(Q=this.getSelectedTabId())Q=ol.a.S8("Tab",Q,2),Array.add(ca,Q);this.Lhd[B]||(this.Lhd[B]=1,h?u?this.Hec("DistinctUserInitiatedNavigationalCommand",ca):this.Hec("DistinctUserInitiatedTerminalCommand",ca):b&&this.Hec("DistinctUserInitiatedKeyboardCommand",ca));h?u?this.Hec("UserInitiatedNavigationalCommand",
ca):this.Hec("UserInitiatedTerminalCommand",ca):b&&this.Hec("UserInitiatedKeyboardCommand",ca)}Hec(b,h){Fe.b(b,null,0,!0,0,h)}cfj(b,h,u){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;r.ULS.sendTraceTag(510247689,207,15,u?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}C4l(b,h){h=parseInt(h);h=dd.ActionManager.$7e(h)||dd.ActionManager.mba(h)||"";return!Le.c(h)&&
h in this.Orc?this.Orc[h]:100<b.length?"":b}PLf(){this.eq&&this.eq.execute(b=>{b.yLf("ModernFontPickerExperience")})}OYe(b,h){let u=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(u=b.payload.inputMethod,h[av.a.Qx]=u);return u}UOf(b,h){const u=Object(Na.a)($d.AFrame,v.AFrameworkApplication.ua);if(this.Vb&&this.Toj(b)){if(!this.Vb.currentScope&&u){let B="null";if(b){const Q=b.Value;delete b.Value;B=mb.a.toJSON(b);Le.c(Q)||(b.Value=Q)}r.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
h,B,u.Z6a)}this.Vb.Hkf()}(this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name!==$d.AFrame.Iqa&&u&&this.Vb.currentScope.name!==u.Z6a||this.Toj(b))&&this.uZk(b)}Toj(b){return!!b&&!Le.c(b[av.a.cUa])&&b[av.a.cUa]}uZk(b){av.a.Qx in b&&1===b[av.a.Qx]&&GF.ShyRibbon.sfb(1,0)}Dom(b,h){ah.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.S3();this.Jfa.Bm();if(this.Wfk&&this.ga){const u={};u[yI.a.kjg]=h.payload.tabId;this.ga.Rb(Za.a.w6c,
2,u,this.YX(h));Le.c(h.payload.inputMethod)||(this.ga.processAction(Za.a.Pbj,2),this.Nxd||this.Kvo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Cl.Otf(h);r.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.eq&&h){const u=h+"TabSwitchActivity";this.eq.execute(B=>{B.yLf(u)})}}WRc(b,h,u){const B=b.type;return"MenuClosePayload"===B?!0:"MenuOpenPayload"===B?(h(b,u),!0):!1}Lnm(b){b=b.type;"MenuOpenPayload"===b?v.AFrameworkApplication.lad=!0:"MenuClosePayload"===
b&&(v.AFrameworkApplication.lad=!1)}OBn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const u=b.payload.launcherId,B=this.Cl.getCommandByExternalUxId(u);return B&&B.populationProps?((b=this.Pcb.f0f(B,h,b.payload))&&u in this.bwb&&delete this.bwb[u],b):!1}xTo(b,h){const u=b.launcherId;this.$kc(u,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(u),this.doc(h,u,ah.g(b)))}AUo(b,h){const u=b.launcherId;this.$kc(u,h)&&(h=
ah.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(u):appChrome.selectors.getFlyoutAnchorMenuItems(u),this.doc(h,u,ah.g(b)))}mWo(b,h){const u=b.launcherId;this.$kc(u,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(u),this.doc(h,u,ah.g(b)))}fXo(b,h){const u=b.launcherId;this.$kc(u,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(u),this.doc(h,u,ah.g(b)))}lXo(b,h){const u=b.launcherId;this.$kc(u,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(u),this.doc(h,
u,ah.g(b)))}getSelectedTabId(){return this.cfe?appChrome.selectors.getSelectedTabId():null}doc(b,h,u){this.Pcb.c3c(b,u);this.bwb[h]=new Date}$kc(b,h){let u=!0;b in this.bwb&&(u=this.bwb[b].getTime()<this.Jfa.Mpa.getTime());return u&&!h&&this.cfe}lXh(b,h){const u={};var B=b.payload.selectedGalleryId;const Q=this.Cl.getCommandByExternalUxId(B);if(Q){u.SourceControlId=B;u.MenuItemId=Q.menuItemId;u.SqmControlId=h;Q.legacyControlId&&(u.LegacyId=Q.legacyControlId);b.payload&&!Le.c(b.payload.shouldTakeFocus)&&
(u[av.a.cUa]=b.payload.shouldTakeFocus);this.h7l(b.payload,u);(B=this.YX(b))||(B={});this.Obg(B,b,h,Q.commandId);const ca=this.OYe(b,u);this.aQe.executeCommand(Q.commandId,u,this.getSelectedTabId(),ca,!0,()=>{this.UOf(u,h)},B,ah.g(b.payload))}}Jwl(b,h){const u=this.Cl.getCommandByExternalUxId(h);if(u){const B={};B.SourceControlId=h;B.MenuItemId=h;B.SqmControlId=h;b.payload&&!Le.c(b.payload.shouldTakeFocus)&&(B[av.a.cUa]=b.payload.shouldTakeFocus);let Q=this.YX(b);Q||(Q={});this.Obg(Q,b,h,u.commandId);
const ca=this.OYe(b,B);this.aQe.executeCommand(u.commandId,B,this.getSelectedTabId(),ca,!1,()=>{this.UOf(B,h)},Q,ah.g(b.payload))}}h7l(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}wdg(b,h){b.payload&&"toggled"in b.payload&&(h[gg.a.On]=b.payload.toggled)}N7m(b,h){if("MenuOpen"===b){if(this.YZ&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.YZ.onMenuOpen()}else if("MenuClose"===b&&this.YZ)this.YZ.onMenuClose()}S3(){this.YZ&&this.YZ.tUf()}YX(b){let h=null;
Le.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}Hmm(b,h,u){if(this.V0j&&this.ga){const B={};B[wI.a.U8d]=u;this.ga.Rb(Za.a.v6c,2,B)}this.doc(h.pageControlIdMap,b,ah.g(h))}L2m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Za.a.Ubj,2);break;case "FileNewPage":this.ga.processAction(Za.a.Vbj,2)}}K2m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Za.a.xbj,2);break;case "FileOpenPage":this.ga.processAction(Za.a.ybj,2)}}isShadowMenuOpen(b){return!!b&&
"MenuOpenPayload"===b.type&&b.isShadowRendering}Kvo(b){if(v.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.eq.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Nxd=!0;else{if(v.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.eq.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.Fjk)){this.Nxd=!0;return}v.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Za.a.HQb,
2)&&(this.Nxd=!0)}}VTk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.wah&&appChrome.PRIToastManager.dismissToast()}wLo(b){!this.G4g&&this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",!1)&&(b=ah.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(u=>{u.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},
0)}),this.G4g=!0)}}Object(m.a)(TI,"ReactExecuteCommandHandler",null,[]);class UI{constructor(){this.fileMenu=null}get srb(){return 0}get Z4a(){return 0}get PGa(){return!1}gza(){}qyj(){}Z_(){return!1}Njj(){}c4(){return!1}vJa(b){return this.fileMenu&&this.fileMenu.aTa(b)?!0:!1}get bka(){return!1}lpb(){}IYd(){return!1}get nHd(){return null}set nHd(b){}pga(){}Yba(){}Suf(){return null}ROa(){}refresh(){}get controls(){return null}xic(){return!1}Kfb(){}Bm(){}get CF(){return null}set CF(b){}pcd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(m.a)(UI,"ReactRibbonExternal",null,[671,611,672]);class VI{constructor(b,h,u,B){this.Vb=b;this.ga=h;this.okh=u;this.$Zb=B}initialize(){this.ga.ra(Za.a.b7c,Ad.a.frame,Object(z.a)(this,this.Sdj,"ribbonMoveForwardAction"));this.ga.ra(Za.a.a7c,Ad.a.frame,Object(z.a)(this,this.Rdj,"ribbonMoveBackwardAction"));this.ga.ra(Za.a.Yde,Ad.a.frame,Object(z.a)(this,this.Odj,"ribbonEscAction"));var b=hs.a.OWd(this.$Zb,null,this.okh,!1);b.$H=!0;this.uic(b,Za.a.b7c,Za.a.a7c);b.bindAction(Nb.KeyInputManager.ic(Se.a.yJa,
0),Za.a.Yde);b=this.Vb.ae($d.AFrame.Iqa);b.$H=!0;this.uic(b,Za.a.T0a,Za.a.T0a);vf.a.instance.ob(Kd.a.Vx,this.okh,Object(z.a)(this,this.Uqn,"onRibbonMouseDown"));b=Um.a.instance;ah.a("enterKeytipMode")&&b.Yio(this.$Zb,()=>{appChrome.api.enterKeytipMode(!1)});ah.a("exitKeytipMode")&&b.Uio(this.$Zb,()=>{appChrome.api.exitKeytipMode();GF.ShyRibbon.sfb(1,0)});v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.zpa&&(b=Object(Na.a)(hd.FocusManager,this.Vb))&&b.Tvk(Object(z.a)(this,this.Yln,"onFocusScopeChanged"))}Yln(b,
h){if((b=Object(Na.a)($d.AFrame,v.AFrameworkApplication.ua))&&h.LPi&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.zpa){const u=appChrome.selectors.getShyState();u.isActive&&h.LPi.name===b.Z6a&&GF.ShyRibbon.sfb(u.state,1)}}Sdj(){return 4}Rdj(){return 4}Odj(){ah.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.zpa&&appChrome.selectors.getShyState().isActive&&GF.ShyRibbon.sfb(1,0),this.Vb.kg($d.AFrame.Un));return 4}uic(b,h,u){const B=
Nb.KeyInputManager.ic(Se.a.Fw,0),Q=Nb.KeyInputManager.ic(Se.a.Fw,4);b.kr(B);b.kr(Q);b.bindAction(B,h);b.bindAction(Q,u)}Uqn(b){b.Hb&&b.Hb.target&&"input"!==b.Hb.target.tagName.toLowerCase()&&b.Hb.preventDefault();return!1}dispose(){this.ga.Vv(Za.a.b7c,Ad.a.frame,Object(z.a)(this,this.Sdj,"ribbonMoveForwardAction"));this.ga.Vv(Za.a.a7c,Ad.a.frame,Object(z.a)(this,this.Rdj,"ribbonMoveBackwardAction"));this.ga.Vv(Za.a.Yde,Ad.a.frame,Object(z.a)(this,this.Odj,"ribbonEscAction"))}}Object(m.a)(VI,"ReactRibbonFocusManager",
null,[10]);class nC{constructor(b,h,u,B,Q,ca,qa,Qa=null,rb=!0,Lb=null,Yb=null){this.Eab=this.Myd=this.zve=this.Jfa=null;this.neh=[];this.Nud=null;this.KMa=b;this.UJe=h;this.$Zb=u;this.Vb=B;this.ga=Q;this.Cl=ca;this.Jfa=Lb?Lb:new UD(Ru.instance,this.Cl);this.lxc=qa;this.Dch=new UI;this.LMa=Qa;this.MRe=rb;new RI;this.PTg=Yb;Yk.a.get_instance().lk(7,Object(z.a)(this,this.nko,"setRibbonPostInteractiveReady"));Yk.a.get_instance().lk(7,Object(z.a)(this,this.S4m,"logRibbonLoadedActivity"));Yk.a.get_instance().lk(19,
Object(z.a)(this,this.y1m,"logAppLoadedActivity"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&Yk.a.get_instance().lk(7,Object(z.a)(this,this.AVn,"registerSubComponentReporting"));Yk.a.get_instance().lk(7,Object(z.a)(this,this.LKn,"queueSettingsDependentActions"))}initialize(b,h,u=null){this.MRe||this.iI(5);u?u.then(()=>{this.Kaj()}).catch(()=>r.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
QI.a.Rad(QI.a.Rad(ce.Task.WAA(this.rGi(b),this.qGi(nC.QXj)),()=>this.qGi(nC.iUj)),()=>this.rGi(h)).continueWith(()=>{this.Kaj()},11)}dispose(){this.QOo();this.Eab&&this.Eab.gSh();this.Nud&&this.Nud.dispose();for(const b of this.neh)Yk.a.get_instance().mWk(b);v.AFrameworkApplication.va.Vv(Za.a.t2n,Ad.a.frame,dd.ActionManager.Lf)}qGi(b){return Ga.a.instance.resolve("Common.ISharedDependencyLoader").Aec(v.AFrameworkApplication.Rz(b,2))}rGi(b){return""===b?ce.Task.o4(!0):Ga.a.instance.resolve("Common.ISharedDependencyLoader").Aec(v.AFrameworkApplication.Rz(b,
3))}Gzm(){(this.LMa||this.lxc)&&appChrome.api.dispatch(this.kii());this.omo();ah.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(v.AFrameworkApplication.R5);this.Jfa.Bm()}Kaj(){this.Gzm();this.MRe&&(appChrome.renderAppChrome(this.KMa,ah.e()),this.iI(10));this.ymh();this.r4e();this.MRe&&this.iI(5);this.nqi()}nqi(){this.Vb&&this.ga&&this.$Zb&&(this.Nud=new VI(this.Vb,this.ga,this.KMa,this.$Zb),this.Nud.initialize())}get $6c(){return this.Dch}setCommandDefinitionMapping(){if(ah.a("setCommandDefinitionMapping")){const b=
tM(this.Cl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.zpa&&ah.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.Ehc()})}ymh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Na.a)(UD,this.Jfa);this.zve=new TI(this.Jfa,b.ric,this.Cl,this.Vb,this.UJe,Ga.a.instance.Oa("Common.IRibbonSQMInformation"),Ga.a.instance.Oa("Common.IFileMenuSQMInformation"),
v.AFrameworkApplication.va,v.AFrameworkApplication.K,Ga.a.instance.Ta("Common.ISystemInitiatedFeedback"),null);this.KIk();this.Dlm()}KIk(){this.Myd=appChrome.api.bindCommandHandler((b,h)=>{this.zve.executeCommand(b,h)})}QOo(){this.Myd&&(this.Myd(),this.Myd=null)}omo(){appChrome.api.initializeLogger(new hm.a)}jFa(){return this.Jfa?this.Jfa.jFa():[]}Ehc(){nr.a.instance.ge(()=>{let b=null;nr.a.instance.ge(()=>{b=this.jFa()},"RB:GA");b&&0<b.length&&(this.Jfa.Mpa=new Date,nr.a.instance.ge(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.Eab&&nr.a.instance.ge(()=>{this.Eab.M0i()},"RB:J")},"RB:PFSU")}xcd(){this.Jfa.xcd()}QLb(){}sok(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}kii(){var b=v.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>
{u.isFeatureEnabled("ConnectedServices",!0).then(B=>{B&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.n8h());b=new uM.a(this.Cl);this.LMa.$G&&(vM.a.NLo(this.LMa.$G),h.push.apply(h,b.cPd(this.LMa.$G)));if(this.LMa.lAj)for(const u of this.LMa.lAj)h.push(appChrome.actions.updateGallerySectionHiddenState(u.a2h,u.Dop,u.srp));h.push.apply(h,b.d3h(this.LMa.pAj));
return h}n8h(){const b=[];if(this.lxc&&this.lxc.$G){const u=this.lxc.$G;for(let B in u){var h=u[B];const Q=this.Cl.ipf(B);if(Q)for(let ca of Q)b.push(appChrome.actions.updateControlHiddenState(ca,h))}}return b}sJa(b){b&&this.Jfa.ric.c3c(b,0)}f0f(b){this.Jfa.ric.f0f(this.Cl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}Hnl(){const b=v.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=v.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.aXo(b,
"Shared"===(h.SharingStatus||"")))}LKn(){v.AFrameworkApplication.K.Hn(()=>{this.Hnl()})}aXo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}iI(b){Yk.a.get_instance().iI(b);this.neh.push(b)}nko(){ah.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new PI,{postRibbonInteractiveReady:!0})))}r4e(){this.lxc&&this.PTg&&(this.Eab=this.PTg.Q$e(),this.Dch.fileMenu=this.Eab)}pYm(b,h){this.Eab&&this.Eab.PEi(b,h)}U9f(b,
h,u){if(1===u)return 32;this.slj(!0);this.Ehc();v.AFrameworkApplication.ua.updateCommandUI();return 32}V9f(b,h,u){if(1===u)return 32;this.slj(!1);this.zko();this.Ehc();v.AFrameworkApplication.ua.updateCommandUI();return 32}hmg(b,h,u){if(1===u)return 32;(b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&b.execute(B=>{B.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}zko(){ac.a.aUa(v.AFrameworkApplication.K.kb("IsSimplifiedRibbonOnCookieName"),"true",ac.a.SRa)}slj(b){ac.a.aUa(v.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),ac.a.SRa)}S4m(){if(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.Er){const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),v.AFrameworkApplication.Spa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),v.AFrameworkApplication.Spa("69a7h198;dfd7j584"));
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFreemiumUpsellEnabled()&&v.AFrameworkApplication.Spa("5fjej882;e0jjh200")})}}$fg(){const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("SingleLineToolBarOptOut",null)});return 32}y1m(){this.ga.ra(Za.a.hmg,Ad.a.frame,Object(z.a)(this,this.hmg,"triggerModeSwitcherTUI"));
this.ga.fb(Za.a.$fg,Ad.a.frame,Object(z.a)(this,this.$fg,"showMultilineRibbonFromToolbar"),96);const b=ac.a.ica(v.AFrameworkApplication.K.kb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const h=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&(v.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(u=>{u.logActivity("VNextStylesOn",null)}),h.execute(u=>{u.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):v.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&
b&&h.execute(u=>{u.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}AVn(){Yk.a.get_instance().lk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let u in b){var h=u;const B=b[u];if(B)for(const Q of B)v.AFrameworkApplication.va.e0(Q)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):v.AFrameworkApplication.va.Rio(Q,this.Sal(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}Sal(b){return()=>
{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Dlm(){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ah.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&v.AFrameworkApplication.rhc.XXe){const b=v.AFrameworkApplication.rhc.XXe,h=v.AFrameworkApplication.rhc.Ylh;h.payload||(h.payload={});const u=h.payload.launcherId?h.payload.launcherId:
b;nC.Udj.nb(u)?nC.Udj.J(u)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.zve.executeCommand(b,h))}}}nC.QXj="common";nC.iUj="appChrome";nC.Udj=new sM.a(Ra.a.zRc());Object(m.a)(nC,"ReactRibbonUser",null,[210,203,10]);class eH extends nC{constructor(b,h,u,B,Q,ca,qa,Qa,rb=null,Lb=!0,Yb=null,gc=null){super(b,h,B,Q,ca,qa,Qa,rb,Lb,Yb,gc);this.nld=null;this.Lub=u;this.Lub.execute(Fc=>{this.nld=Fc});this.Lub.execute(Fc=>{this.Jfa.CF=
Fc})}jFa(){return this.nld?(this.nld.clearCache(),super.jFa()):[]}QLb(b){if(!b)throw Error.argumentNull();this.Lub.execute(h=>{b.CF=h})}}Object(m.a)(eH,"ReactRibbonUser",nC,[]);var xM=c(1010);class HF extends eH{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb=!0,Yb=null,gc=null){super(h,b.e4,B,Zj.AppFrame.Vqa,Q.focusManager,Q.nc,qa,Qa,rb,Lb,Yb,gc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.UCe=b;this.Xaa=ca;Q.sVa(()=>{this.IWo();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",
!1)?Yk.a.get_instance().lk(7,()=>{this.eqi()}):this.eqi()},null)}get YCf(){return!!v.AFrameworkApplication.K.appSettings.BootActivityNavigationId}eqi(){this.X9k();this.Q$e();this.kSn()}IWo(){this.KMa.classList.add("FlexBoxLayout");this.UCe.koa().classList.add("cui-exth");this.UCe.koa().classList.add("FlexBoxLayout");this.UCe.koa().classList.add("ScrollableRibbon")}X9k(){v.AFrameworkApplication.fY||this.Zcl()}Zcl(){if(!v.AFrameworkApplication.fY){var b=(new GI(HF.Ufk,this.Xaa)).Hvl(),h=hs.a.OWd(Zj.AppFrame.fQa,
null,b,!0);h.$H=!0;this.uic(h,Za.a.b7c,Za.a.a7c);h.bindAction(Nb.KeyInputManager.ic(Se.a.yJa,0),Za.a.Yde);ED.a(1,()=>{this.I0n(b)})}}I0n(b){const h=new NI;appChrome.renderSharedHeader(b,h.Iha()).then(this.Bef.bind(this))}r9i(){v.AFrameworkApplication.ua.Lb.kBi?appChrome.getHeaderApi().then(b=>{document.getElementById(v.AFrameworkApplication.whb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new xM.a).Bef()}Bef(){this.YCf&&v.AFrameworkApplication.Spa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");
this.YCf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(Yk.a.get_instance().lk(12,this.r9i.bind(this),11),r.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.r9i()}uic(b,h,u){const B=Nb.KeyInputManager.ic(Se.a.Fw,0),Q=Nb.KeyInputManager.ic(Se.a.Fw,4);b.kr(B);b.kr(Q);b.bindAction(B,h);b.bindAction(Q,u)}Q$e(){const b=!!this.LMa&&"FileMenu"in this.LMa.pAj;v.AFrameworkApplication.ua.Lb.dRa&&!b&&ED.a(1,this.g0n.bind(this))}g0n(){const b=
[];if(v.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new cH,{label:CommonUIStrings.L_DiagnosticsSessionId,value:v.AFrameworkApplication.userSessionId}),Object.assign(new cH,{label:CommonUIStrings.L_DiagnosticsBuild,value:v.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.n8h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}kSn(){this.ga.ra(Za.a.AUa,
vc.a.view,this.AUa.bind(this));this.ga.ra(Za.a.U9f,vc.a.view,this.U9f.bind(this));this.ga.ra(Za.a.V9f,vc.a.view,this.V9f.bind(this))}activateRibbonTab(b){this.sok(b)}Ehc(){Yk.a.get_instance().isCompleted(7)&&this.nld&&(Gj.a.mark(4893),jx.a.lWo(),super.Ehc(),Gj.a.mark(4894))}AUa(b,h,u,B,Q){if(2===Q[av.a.Qx]){if(u=Object(Na.a)(ju.a,h))B=Object(Na.a)(oi.a,u.view);else return r.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",
Object.getTypeName(h),b,mb.a.join(Q," ",":")),8;if(B&&""!==B.pJ)Hi.a.eia(h)&&Hi.a.bcc()||(this.Vb.kg(B.pJ),appChrome.selectors.getShyState().isActive&&GF.ShyRibbon.sfb(0,1));else return r.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(u.view),b,mb.a.join(Q," ",":"),this.w_l(u.view)),8}return 32}w_l(b){return b?"is ContentEditableView: "+b.Vj+" is Editing View: "+b.oxa+
" is HtmlView: "+b.Y3a+" is InteractiveView: "+b.qe+" is NavigationPaneView: "+b.lOm+" is PageView: "+b.Vi+" is WordNavigationPaneHeadingsView "+b.Q0d:"null view"}}HF.Ufk="WACRibbon";Object(m.a)(HF,"ReactRibbonUser",eH,[209,210,203,10]);class WI extends HF{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc=null,ld,Hd){super(b,h,u,B,Q,ca,qa,Qa,rb,!1,Lb,Sc);this.rAk=()=>{this.eq&&this.eq.execute(Ie=>{Ie.logActivity("WordShyRibbon",null)});return 32};this.Uym=()=>{ei.a.instance.lf(Qh.a.fAm,(new Date).getTime());
appChrome.getLazyRibbonInitializationActions().then(Ie=>{var fe;this.LMa&&Ie.push.apply(Ie,this.kii());(this.afh||this.bfh)&&this.qdb&&Ie.push.apply(Ie,this.wOl());Ie.push(appChrome.actions.setControlCustomTooltip(be.a.XYm,CommonUIStrings.l_LoopsLearnMoreTooltip));var de=null===(fe=v.AFrameworkApplication.K)||void 0===fe?void 0:fe.kb("ReactShyRibbonPreferenceCookieName");fe=ac.a.get(de);this.Kno(fe);v.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&
v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.IJ&&""===fe&&v.AFrameworkApplication.le("66h8i182;1ha8c781");Ie.push.apply(Ie,this.jFa());Ie.push(appChrome.actions.setControlBehaviorAttached(!0));const ne=Ga.a.instance.resolve("WordEditor.IModeSwitcherControl");fe=ne.$Zl();v.AFrameworkApplication.le("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(de=appChrome.selectors.getModeSwitcherMode())&&
de!==fe.activeMode&&r.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${fe.activeMode}, Actual: ${de}`);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(de=hs.a.OWd(ma.a.Xrj,null,document.getElementById("WACToolbarContainer"),!1),de.$H=!0,this.VNn(de,Za.a.b7c,Za.a.a7c));"Suggest"===fe.activeMode||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",
!1)&&"View"===fe.activeMode?appChrome.getUpdateAppModeAndTabsActions(fe,!0).then(ye=>{appChrome.api.dispatch(Ie.concat(ye));ne.xMi();this.sqi()}):(Ie.push(appChrome.actions.updateModeSwitcher(fe)),appChrome.api.dispatch(Ie),ne.xMi(),this.sqi())})};this.qdb=Yb;this.afh=gc;this.bfh=Fc;this.eq=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");this.Ib=ld;this.hBe=Hd}eAm(){r.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Yk.a.get_instance().iI(5);const b=this.YCf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?
12:10;Yk.a.get_instance().lk(b,this.Uym,11);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.jsk()}jsk(){this.Ib.Xb(new bf.a(5,1,0,()=>{this.hBe.execute(b=>{b.vjo()})}))}wOl(){const b=[];this.afh&&(b.push(appChrome.actions.setButtonSecondaryText(be.a.jJd,this.qdb.Osm)),b.push(appChrome.actions.setButtonSecondaryText(be.a.FHd,this.qdb.Nsm)),b.push(appChrome.actions.setButtonSecondaryText(be.a.G9d,this.qdb.Psm)));this.bfh&&b.push(appChrome.actions.setButtonSecondaryText(be.a.D9d,
this.qdb.Qsm));return b}Kno(b){var h;b&&(null===(h=v.AFrameworkApplication.ua)||void 0===h?0:h.Lb.zpa)?this.eq.execute(u=>{u.logActivity("OptInShyRibbonNormalScreenActivity",null)}):appChrome.api.isSmallDevice()&&!b&&this.eq.execute(u=>{u.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});v.AFrameworkApplication.va.fb(Za.a.irh,Ad.a.frame,this.rAk,96)}VNn(b,h,u){const B=Nb.KeyInputManager.ic(Se.a.Fw,0),Q=Nb.KeyInputManager.ic(Se.a.Fw,4);b.kr(B);b.kr(Q);b.bindAction(B,h);b.bindAction(Q,u)}sqi(){v.AFrameworkApplication.rhc.POo();
this.ymh();this.r4e();this.nqi();Yk.a.get_instance().iI(7);ei.a.instance.bga(Qh.a.NFc,Qh.a.H6n,(new Date).getTime())}sJa(b){if(b){const h=this.o9h();try{super.sJa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}jFa(){const b=this.o9h();try{return super.jFa()}finally{null===b||void 0===b?void 0:b.dispose()}}o9h(){var b;let h=void 0;const u=null===(b=Fb.App.ni)||void 0===b?void 0:b.zl;u&&(h=new Qg.GraphTransaction(Fb.App.$vi()&&Fb.App.jEf?0:2),h.set(u));return h}}Object(m.a)(WI,"ReactRibbonUser",
HF,[]);class XI extends $G{constructor(b,h,u,B,Q,ca,qa,Qa){super(b,h,u);this.KFe=v.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&Z.a.I4;this.Cl=Q;this.DOe=ca;this.Ib=qa;this.hBe=Qa}icl(b,h){const u=new FE(v.AFrameworkApplication.K,this.ga,this.Vb,this.KFe),B=new pM.a(u);return this.Fcl(b,h,B,u)}Fcl(b,h,u,B){var Q=new EI(new FI(v.AFrameworkApplication.K,B),u);u=this.Czm(Q);const ca={};Q.Fpb(ca);Q=!Z.a.I4;const qa=Z.a.Cr||Z.a.lj;var Qa=Z.a.Wk;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&
(Qa=Z.a.ri||Qa);Qa=new AF.a(Qa);b=new WI(b,h,WordEditorIntl.WordEditorStrings,this.Lub,B,b,this.Cl,u,new AI(ca),this.DOe,Qa,Q,qa,new DI,this.Ib,this.hBe);b.eAm();return b}Czm(b){const h={};b.F8c(h);b.Kcd(h);return new BI(null,h,"jewelWordEditor")}}Object(m.a)(XI,"WordEditorRibbonUserFactory",$G,[]);class fH{constructor(b,h){this.jA=b;this.crd=h}XOa(b,h,u,B=null,Q=null){return this.crd.Doj(b)?this.crd.XOa(b,h,u,B,Q):this.jA.XOa(b,h,u,B,Q)}nGa(b,h=null){return this.crd.Doj(b)?this.crd.nGa(b):this.jA.nGa(b,
h)}}Object(m.a)(fH,"RootCuiUser",null,[279]);class YI extends fH{constructor(b,h){super(b,h)}clearCache(){this.jA.clearCache()}}Object(m.a)(YI,"WordGeneralCuiUser",fH,[278,279]);var yM=c(1467);class oG{static getSelectedText(){const b=(new Am.a).btf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static bTd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Jz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(m.a)(oG,"SearchUtils",null,[]);class cw extends UC{constructor(b,
h,u){super(b,u);this.uI=h}umf(b){const h=[];var u=xf.a.instance.hb.lb;const B=!!this.uI&&this.uI.hXc(Ob.a.e6e.toString()),Q=!!this.uI&&this.uI.hXc(Ob.a.VNb.toString()),ca=!B&&!u.M3a&&cw.l7a.OMi(),qa=!(v.AFrameworkApplication.nu&&cw.Dxi)&&(!!this.uI&&this.uI.hXc(Za.a.SGa.toString())||!!dB.a.instance&&(3===dB.a.instance.mode||2===dB.a.instance.mode)),Qa=u.ZAi()&&v.AFrameworkApplication.ua.Lb.$Wc;var rb=!1;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1)){rb=!!u&&(u.Vw||2===u.length&&Ge.SelectionEditor.Fk(u.Rc));var Lb=oG.getSelectedText();rb=rb&&0<Lb.length&&60>Lb.length}b=(Lb=3===b||Z.a.ri||v.AFrameworkApplication.llf)&&cw.cgf.n0(u,b);u=cw.Dxi&&u&&1===u.length&&u.J(0).contextId===vc.a.Tc;Lb&&h.push(this.Cl.xwa("ClipboardGroup")[0].externalUxGroupId);ca&&(h.push(this.Cl.xwa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Cl.xwa("StylesGroup")[0].externalUxGroupId));rb&&h.push(this.Cl.xwa("DefineGroup")[0].externalUxGroupId);B&&h.push(this.Cl.xwa("PictureToolsGroup")[0].externalUxGroupId);
Q&&h.push(this.Cl.xwa("TableToolsGroup")[0].externalUxGroupId);Qa&&h.push(this.Cl.xwa("EquationToolsGroup")[0].externalUxGroupId);qa&&h.push(this.Cl.xwa("CommentGroup")[0].externalUxGroupId);u&&h.push(this.Cl.xwa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.Cl.xwa("ContextMenuGroup")[0].externalUxGroupId);yM.a.Lui&&cw.RIm&&h.push(this.Cl.xwa("DesignerGroup")[0].externalUxGroupId);return h}static get cgf(){return null!=cw.Swg?cw.Swg:cw.Swg=Ga.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get l7a(){return null!=
cw.dFg?cw.dFg:cw.dFg=Ga.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static WTc(b,h,u,B){b.GIk(()=>cw.Mfb(h,u,B))}static Mfb(b,h,u){return new cw(b,h,u)}static get RIm(){null===this.IEe&&(v.AFrameworkApplication.le("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.IEe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.IEe}static get Dxi(){null!==
this.oFe||"Templatization"!==v.AFrameworkApplication.nu&&"ContentAssemblyEdit"!==v.AFrameworkApplication.nu||(v.AFrameworkApplication.le("insertSnippetTreatment;insertSnippetControl"),this.oFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",!1):!1);return this.oFe}}cw.IEe=null;cw.oFe=null;Object(m.a)(cw,"WordReactFloatie",UC,[]);class gH{constructor(){this.Sea=this.ZCc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;
this.W.resolve("WordEditor.UI.BusinessBarController").s_f();const h=Fb.App.Gv.$I,u=Fb.App.za;cw.WTc(u,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.Sea=this.W.Oa("Box4.IContextMenuController");const B=new zF(u,h,this.W.Ta("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),Q={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===
(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:Q["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:Q["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:Q["floatie.gbUseSmartPasteButton"]=!1}B.WTc("PasteFloatieData",null,Q);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new rI(u,h,this.W.Ta("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).WTc("ExternalContentFloatieData",
[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");Yk.a.get_instance().lk(7,()=>{this.ZCc=this.W.resolve("WordEditor.UI.StatusBarUser");this.ZCc.Tb()})}dispose(){this.ZCc&&(this.ZCc.dispose(),this.ZCc=null);this.Sea&&(this.Sea.dispose(),this.Sea=null)}wc(b){this.W=b;b.ia("WordEditor.UI.BusinessBarController",()=>new CF(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),v.AFrameworkApplication.va,v.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();
let h=Z.a.Wk;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=Z.a.ri||h);b.ia("Box4.UI.ShortcutHintMapping",()=>new AF.a(h));const u=Z.a.Cr||Z.a.lj,B=v.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(Z.a.I4||u),Q=v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ia("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new mt(Ga.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ga.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Nc.a)).ha();
b.ia("WordEditor.UI.EditSurfaceContextMenu",()=>new pp(v.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Q?b.Ta("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Oa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Ta("Box4.IPresenceDataManager"),b.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Ta("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
B,u?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ga.a.instance.Ta("Common.IActionContextProvider"),Ga.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Oa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ia("Box4.ISelectionContextMenuProvider",()=>new Fx).ha();b.ia("WordEditor.UI.CuiActionBridge",()=>new Ol(v.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").ha();
b.ia("WordEditor.UI.DialogFactory",()=>new qI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ia("Common.NonCanvasCuiUser",()=>new qF(hd.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ia("WordEditor.UI.WordGeneralCuiUser",()=>new YI(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.StatusBarUser",()=>new vI(Fb.App.za.Thg,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),
v.AFrameworkApplication.va,v.AFrameworkApplication.K,Fb.App.za)).as("WordEditor.IStatusBarUser").ha();b.ia("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new DF).ha();const ca=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("CommandUI.ReactRibbonRoot",()=>new UD(Ru.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).ha();const qa=b.Ta("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new XI(qa,v.AFrameworkApplication.va,hd.FocusManager.instance(),
b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),v.AFrameworkApplication.oc,b.Ta("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();b.ia("WordEditor.UI.ReactLanguageDialog",()=>new EF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>
new zI(v.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new xI(v.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ia("WordEditor.UI.RulerUser",()=>new sI).as("WordEditor.IRulerUser");b.ia("WordEditor.UI.RulerContextMenu",()=>new YC(v.AFrameworkApplication.va,Ga.a.instance.Ta("Common.IZoomManager"),Hr.a.instance)).as("WordEditor.IRulerContextMenu").ha();b.ia("Common.IReactContextualUILauncher",()=>new VD(b.resolve("CommandUI.ReactRibbonRoot"),
b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Box4.IContextMenuController",()=>new VC(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){v.AFrameworkApplication.le("5b6i5792;30d4f535");zm.instance.cVh();zm.instance.Mgf();M.a.instance.Gc(new gH,6)}}Object(m.a)(gH,"WordEditorUIPackage",null,[1,2]);var zM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",
Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",
LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},uD={};uD.fpc=function(){function b(){return qa()&&(ld()||3<=(gc()?Hd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function u(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}
function B(Bf){Bf=(new RegExp(Bf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ji=-1;null!=Bf&&2<=Bf.length&&(Ji=parseFloat(Bf[1]),isNaN(Ji)&&(Ji=-1));return Ji}function Q(){ZI||(ZI=!0,$I=B("Windows Phone"));return 8<=$I}function ca(){return"function"==typeof navigator.msLaunchUri&&!u()&&!Sc()&&!Qa()}function qa(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Qa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function rb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||
0<=window.navigator.userAgent.indexOf("Trident/")}function Lb(){return rb()?8==window.document.documentMode:!1}function Yb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function gc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Fc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Sc(){var Bf=window.navigator.userAgent.toLowerCase();return 0<=Bf.indexOf("android")&&0<=Bf.indexOf("chrome")}function ld(){return 3<=(Yb()?Hd("firefox/"):
0)}function Hd(Bf){var Ji=window.navigator.userAgent.toLowerCase(),Pj=Ji.indexOf(Bf);return 0<=Pj?parseInt(Ji.substring(Pj+Bf.length,Ji.length)):0}function Ie(Bf,Ji,Pj,Jk,bp){if(Jk&&null!=Ji)Ji();else if(ca())navigator.msLaunchUri(Bf,Ji,Pj);else if(!(Fc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&qa())||Qa())de(Bf,Ji,Pj);else if(Fc()&&bp)a:{try{window.open(Bf,"_self")}catch(Ks){null!=Pj&&Pj();break a}null!=Ji&&Ji()}else fe(Bf,
Ji,Pj)}function fe(Bf,Ji,Pj){var Jk=document.getElementById("OICLinkTag");null==Jk&&(Jk=document.createElement("a"),Jk.id="OICLinkTag",Jk.style.visibility="hidden",Jk.href="",0==(Kq.Options&Dy.SupportsTopTargetNavigation)||Kq.NoBrowserModalDialogs?Jk.target="_blank":Jk.target="_top",document.body.appendChild(Jk),null!=Jk.addEventListener&&Jk.addEventListener("click",function(bp){null!=bp.stopPropagation&&bp.stopPropagation()},!1));try{Jk.href=Bf,Jk.dispatchEvent(new MouseEvent("click"))}catch(bp){null!=
Pj&&Pj();return}null!=Ji&&Ji()}function de(Bf,Ji,Pj){var Jk=document.getElementById("OICFrame");null==Jk&&(Jk=document.createElement("iframe"),Jk.className="ObjectInDialog",Jk.style.visibility="hidden",Jk.src="about:blank",document.body.appendChild(Jk),Jk.id="OICFrame");try{Jk.contentWindow.location.href=Bf}catch(bp){null!=Pj&&Pj();return}null!=Ji&&Ji()}function ne(Bf){return 0!=(Bf.Options&Dy.SkipProtocolHandler)||Lb()}function ye(Bf){return Bf===vD.ReadOnly||Bf===vD.ReadWrite}function Vf(Bf,Ji,
Pj,Jk){var bp;try{var Ks=new ActiveXObject("SharePoint.OpenDocuments.4");return(bp=Ks.ViewDocument3(window.self,Bf,Ji,Jk))?(IE(oC.O14ActiveX),Tp.None):Tp.Failed}catch(bs){}if(Dy.O14Only===(Pj&Dy.O14Only))return Kq.DescriptiveUnattemptedEnums?Tp.O14AttemptFailure:Tp.Unattempted;try{return Ks=new ActiveXObject("SharePoint.OpenDocuments.3"),(bp=Ks.ViewDocument3(window.self,Bf,Ji,Jk))?(IE(oC.O12ActiveX),Tp.None):Tp.Failed}catch(bs){}if(Dy.O12UpOnly===(Pj&Dy.O12UpOnly))return Kq.DescriptiveUnattemptedEnums?
Tp.O12UpOnlyFail:Tp.Unattempted;try{return Ks=new ActiveXObject("SharePoint.OpenDocuments.2"),(bp=ye(Ji)?Ks.ViewDocument2(window.self,Bf,Jk):Ks.EditDocument2(window.self,Bf,Jk))?(IE(oC.O11ActiveX),Tp.None):Tp.Failed}catch(bs){}return Kq.DescriptiveUnattemptedEnums?Tp.ActiveXUnattempted:Tp.Unattempted}function Og(Bf,Ji,Pj,Jk,bp){Bf==Kr.Visio&&Pj==vD.ReadWrite&&(Pj=vD.WriteOnly);Jk=Jk||u()&&!Q();if(!Jk){Jk="";if(Bf==Kr.PowerPoint){Bf=Jk;Jk=Kq.DocumentExtension;Pj=ye(Pj);var Ks=new Set([".pot",".potm",
".potx"]),bs=new Set([".pps",".ppsm",".ppsx"]);Pj=Pj&&Ks.has(Jk)?"nft|ofc|":Pj&&bs.has(Jk)?"ofv|ofs|t|":!Pj&&bs.has(Jk)?"ofe|ofs|t|":Pj?"ofv|ofc|":"ofe|";Pj=Bf+Pj}else Pj=ye(Pj)?Jk+"ofv|ofc|":Jk+"ofe|";Jk=Pj;Kq.NewTelemetryDataIsEnabled&&(Pj=Kq.SessionOrigin?"or|"+Kq.SessionOrigin+"|":"",Pj+=Kq.ClickTime?"ct|"+Kq.ClickTime+"|":"",Pj+=Kq.CorrelationId?"cid|"+Kq.CorrelationId+"|":"",Jk+=sm(Pj));bp+=sm(Jk+"u|")}bp+=sm(Ji);Ji=window.location.href;Pj=Ji.toLowerCase().indexOf("&wdlor=");-1!=Pj?(Pj+=7,Bf=
Ji.indexOf("&",Pj),Ji=-1==Bf?Ji.substr(Pj):Ji.substring(Pj,Bf)):Ji=void 0;if(null!=Ji&&"undefined"!=typeof Ji){Pj="";try{Pj=decodeURIComponent(Ji)}catch(JE){}0<Pj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Pj)&&(bp=bp+"|f|"+Pj)}return bp}function Bl(Bf,Ji,Pj,Jk,bp,Ks){var bs=aJ(Bf);if(null==bs)return ZD(Kq.DescriptiveUnattemptedEnums?Tp.ProtocolHandlerIsNull:Tp.Unattempted,Kq.Application),!1;Bf=Og(Bf,Ji,Pj,Jk,bs);Ie(Bf,op,zv,bp,Ks);return!0}function sm(Bf){if(qa()&&
Fc()){var Ji="";try{Ji=decodeURI(Bf)}catch(Pj){}if(Ji==Bf)return encodeURI(Bf)}return Bf}function op(){IE(oC.ProtocolHandler)}function zv(){Kq.Options|=Dy.SkipProtocolHandler;bJ(Kq,KE,LE)}function XC(){null!=hH&&hH(oC.RoamingProtocolHandler)}function oB(){null!=iH&&iH(Tp.ControlNeeded)}function WD(){var Bf=document.getElementById("npSharePointPlugin");if(null==Bf){Bf="application/x-sharepoint";qa()&&3<=(gc()?Hd("version/"):0)&&lz("application/x-sharepoint-webkit",!0)&&(Bf="application/x-sharepoint-webkit");
if(!lz(Bf,!0))if(qa()&&lz("application/officelive",!0))Bf="application/officelive";else return null;var Ji=document.createElement("object");Ji.id="npSharePointPlugin";Ji.type=Bf;Ji.style.width="0px";Ji.style.height="0px";Ji.style.setProperty("visibility","hidden","");document.body.appendChild(Ji);Bf=document.getElementById("npSharePointPlugin")}return Bf}function lz(Bf,Ji){var Pj=window.navigator.mimeTypes;if(null==Pj)return!1;Bf=Pj[Bf];return!Bf||Ji&&!Bf.enabledPlugin?!1:!0}function pG(Bf){try{if(null!=
new ActiveXObject(Bf))return!0}catch(Ji){}return!1}function jH(Bf){switch(Bf){case Kr.OneNote:return"OneNote.Notebook";default:return""}}function aJ(Bf){if(Bf!=Kr.OneNote&&u()&&!Q())return"office:";switch(Bf){case Kr.Excel:return"ms-excel:";case Kr.OneNote:return"onenote:";case Kr.PowerPoint:return"ms-powerpoint:";case Kr.Visio:return"ms-visio:";case Kr.Word:return"ms-word:";case Kr.Project:return"ms-project:";case Kr.Publisher:return"ms-publisher:";case Kr.Infopath:return"ms-infopath:";case Kr.Access:return"ms-access:";
default:return""}}function AM(Bf){switch(Bf){case Kr.Excel:return"root\\office15\\excel.exe";case Kr.PowerPoint:return"root\\office15\\powerpnt.exe";case Kr.Visio:return"root\\office15\\visio.exe";case Kr.Word:return"root\\office15\\winword.exe";case Kr.Project:return"root\\office15\\winproj.exe";case Kr.Publisher:return"root\\office15\\mspub.exe";case Kr.Infopath:return"root\\office15\\infopath.exe";case Kr.Access:return"root\\office15\\msaccess.exe";default:return null}}function bJ(Bf,Ji,Pj){Kq=
Bf;KE=Ji;LE=Pj;if(Bf.DocumentUrl){var Jk=Pj=Ji=Bf.DocumentUrl;try{Jk=decodeURIComponent(Bf.DocumentUrl)}catch(ME){}try{Pj=encodeURI(Bf.DocumentUrl)}catch(ME){}Ji=Ji+""+Bf.CorrelationIdForWinClient;Jk+=Bf.CorrelationIdForWinClient;Pj+=Bf.CorrelationIdForWinClient;Bf.Mode===vD.ReadWrite&&Dy.CheckoutRequired===(Bf.Options&Dy.CheckoutRequired)&&(Bf.Mode=vD.ForceCheckout);Dy.HostIsEditOnly===(Bf.Options&Dy.HostIsEditOnly)&&(Bf.Mode=vD.WriteOnly);if(ne(Bf)?0:qa()&&(Bf.Application==Kr.OneNote||lz("application/x-sharepoint-protocolhandler",
!1)||lz("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||Sc()||!(b()||ld()||"ActiveXObject"in window&&!u()||Fc())||15<=qG())Bl(Bf.Application,Bf.EncodeUrl?Pj:Ji,Bf.Mode,Bf.Application==Kr.OneNote,Bf.SilentExternalHandler,Bf.NavigateUsingWindowOpen);else{var bp;if(bp=Lb())a:{var Ks=Bf.EncodeUrl?Ji:Jk,bs=Bf.Mode,JE=jH(Bf.Application);try{bp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Ks,bs,JE);break a}catch(ME){}bp=!1}if(bp)IE(oC.O15ActiveX);else{if(b()||
ld()){var Vt=Bf.EncodeUrl?Ji:Jk;Jk=Bf.Mode;bp=jH(Bf.Application);Ks=WD();if(null==Ks)Vt=Kq.DescriptiveUnattemptedEnums?Tp.PluginIsNull:Tp.Unattempted;else{bs=!1;try{bs=Ks.ViewDocument3(window.self,Vt,Jk,bp)}catch(ME){}if(!bs)try{bs=ye(Jk)?Ks.ViewDocument2(window.self,Vt,bp):Ks.EditDocument2(window.self,Vt,bp)}catch(ME){}bs?(IE(oC.NpapiPlugin),Vt=Tp.None):Vt=Tp.Failed}}else{try{Vt=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Vt&&Vt.SaveSSOCreds()}catch(ME){}Vt=Vf(Bf.EncodeUrl?Ji:Jk,Bf.Mode,Bf.Options,
jH(Bf.Application))}if(Vt!=Tp.None){if(Jk=Bf.CouldUseRoamingApps)cJ||(cJ=!0,dJ=B("Windows NT")),Jk=6.1<=dJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(rb()||ld()||Fc());if(Jk&&Bf.Application!=Kr.OneNote){if(!uD.fpc.j7o()){ZD(Tp.ControlNeeded,Kq.Application);return}if(Bf.RoamingAppsLauncher){"undefined"==typeof Bf.RoamingAppsLauncher||null==Bf.RoamingAppsLauncher?ZD(Kq.DescriptiveUnattemptedEnums?Tp.RoamingLauncherIsNull:Tp.Unattempted,Kq.Application):"undefined"==typeof Bf.RoamingBitsUrl||
null==Bf.RoamingBitsUrl?uD.fpc.f9o(Bf.DocumentUrl,Bf.RoamingAppsLauncher,Bf.Application,Bf.ApplicationParameters,KE,LE):uD.fpc.ZNj(Bf.DocumentUrl,Bf.RoamingAppsLauncher,Bf.RoamingApplicationExe,Bf.ApplicationParameters,Bf.RoamingPlatform,Bf.RoamingBitsUrl,KE,LE);return}if(!Bf.ContinueIfLauncherIsNull){ZD(Tp.LauncherNeeded,Kq.Application);return}}Dy.NoProtocolHandlerFallback==(Bf.Options&Dy.NoProtocolHandlerFallback)||ne(Bf)||rb()||qa()&&!(Kq.DescriptiveUnattemptedEnums?Vt>=Tp.O14Unattempted&&Vt<=
Tp.DocumentUrlIsNull:Vt==Tp.Unattempted)?ZD(Vt,Kq.Application):Bl(Bf.Application,Bf.EncodeUrl?Pj:Ji,Bf.Mode,Bf.Application==Kr.OneNote,Bf.SilentExternalHandler,Bf.NavigateUsingWindowOpen)}}}}else ZD(Kq.DescriptiveUnattemptedEnums?Tp.DocumentUrlIsNull:Tp.Unattempted,Kq.Application)}function IE(Bf){null!=KE&&KE(Bf)}function ZD(Bf,Ji){"undefined"==typeof Ji&&(Ji=null);null!=LE&&LE(Bf,Ji)}function qG(){var Bf=0;if(b()||ld()||Fc()){var Ji=WD();try{null!=Ji&&(Bf=Ji.GetOfficeVersion())}catch(Pj){}}else pG("SharePoint.OpenDocuments.5")?
Bf=15:pG("SharePoint.OpenDocuments.4")?Bf=14:pG("SharePoint.OpenDocuments.3")?Bf=12:pG("SharePoint.OpenDocuments.2")&&(Bf=11);return Bf}function eJ(){return qa()&&(lz("application/x-sharepoint",!0)||lz("application/x-sharepoint-webkit",!0))}var fJ="",gJ="",hJ="",KE,LE,hH,iH,Kq,cJ,dJ,ZI,$I,vD={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Dy={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
Tp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},oC={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Kr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:vD,OpenDocumentOptions:Dy,OpenDocumentFailureType:Tp,OpenDocumentControl:oC,OfficeApplication:Kr,EditDocumentInClient:bJ,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Kr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:qG,IsO14MacPluginInstalled:eJ,OfferOfficeInDialog:function(){return h()&&11>=qG()},OfferOfficeNoIntrusive:function(){return h()&&15>qG()},OfferMacOffice:function(){return qa()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!eJ()},InstallRoamingControl:function(){Yb()?window.InstallTrigger.install({Office:{URL:gJ}}):de(hJ,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(Fc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Yb()){var Bf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Bf);var Ji=document.createEvent("Events");Ji.initEvent("RoamingOfficeInstalled",!0,!1);Bf.dispatchEvent(Ji);
return!!Bf.getAttribute("installed")}if(rb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Pj){}return!1},InitUrls:function(Bf,Ji,Pj){fJ=Bf;gJ=Pj;hJ=Ji},LaunchRoamingApps:function(Bf,Ji,Pj,Jk,bp,Ks){uD.fpc.ZNj(Bf,Ji,AM(Pj),Jk,"x86",fJ,bp,Ks)},LaunchRoamingApps2:function(Bf,Ji,Pj,Jk,bp,Ks,bs,JE){var Vt="";null!=Jk&&(Vt+=" "+Jk);null!=Bf&&(Vt+=' "'+Bf+'"');if(ca()||Fc())hH=bs,iH=JE,bs='office: "'+(Ks+'" "')+(Pj+'" "ROAMING"'),bs+=' "'+Ji+'"',bs+=' "'+bp+'"',bs+=
" "+Vt,Ie(bs,XC,oB,!1,!1);else if(Yb())Bf=document.createElement("RoamingExtensionElement"),Bf.setAttribute("cabUrl",Ks),Bf.setAttribute("app",Pj),Bf.setAttribute("licensingEntitlements",Ji),Bf.setAttribute("platform",bp),Bf.setAttribute("args",Vt),document.documentElement.appendChild(Bf),Ji=document.createEvent("Events"),Ji.initEvent("RoamingOfficeLaunch",!0,!1),Bf.dispatchEvent(Ji),null!=bs&&bs(oC.RoamingFFExtension);else if(rb()){if(Bf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Bf)try{Bf.HrConfigureSingle(Ks,Pj,Ji,bp,Vt),null!=bs&&bs(oC.RoamingActiveX)}catch(ME){}}else null!=JE&&JE(Tp.Failed)},ShouldShowDialog:function(){return!u()},NavigateToUrlUsingClickingOnATag:fe,OpenDocumentWithProtocolHandler:Bl,OpenDocumentWithProtocolHandlerNoCallBack:function(Bf,Ji,Pj,Jk){var bp=aJ(Bf);if(null==bp)return ZD(Kq.DescriptiveUnattemptedEnums?Tp.ProtocolHandlerNoCallbackIsNull:Tp.Unattempted,Kq.Application),!1;Bf=Og(Bf,Ji,Pj,Jk,bp);Ie(Bf,null,null,!1,!1);return!0}}}();uD.ClientUtils=
uD.fpc;var BM=c(1489);class rG{constructor(b,h,u){this.ga=b;this.X6j=h;this.f7=u}Tb(){this.ga.ra(Za.a.tryMacOffice,Ad.a.frame,Object(z.a)(this,this.dtn,"onTryMacOffice"));this.ga.ra(Za.a.fBj,Ad.a.frame,Object(z.a)(this,this.vXi,"onTryMacOfficeFromViewer"));this.ga.ra(Za.a.eBj,Ad.a.frame,Object(z.a)(this,this.vXi,"onTryMacOfficeFromViewer"))}dtn(b,h,u,B,Q){if(1===u)return 32;Q?(b=Q.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Qd.a.om(fa.a.d2a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):
"PptJewel.About.TryMacOffice"===b&&Qd.a.om(fa.a.d2a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.SEi();return 32}vXi(b,h,u){if(1===u)return 32;switch(b){case Za.a.fBj:Qd.a.om(fa.a.d2a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Za.a.eBj:Qd.a.om(fa.a.d2a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}SEi(){Qd.a.om(rG.f7m,"_blank",void 0,"LaunchMacTrialWindow")}get D9c(){return this.X6j&&Z.a.Wk&&!Z.a.HFf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get zqo(){const b=
this.D9c;b||v.AFrameworkApplication.Ql.aeo();return b}get yqo(){return this.D9c}static get f7m(){return fa.a.U8("522401")}}Object(m.a)(rG,"MacOfficeOffer",null,[977]);class sG{constructor(b,h,u){this.ga=b;this.b7j=h;this.tI=null;(this.dzd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{this.tI=B});this.f7=u}Tb(){this.ga.ra(Za.a.tryOffice,
Ad.a.frame,Object(z.a)(this,this.etn,"onTryOffice"));this.ga.ra(Za.a.Hmg,Ad.a.frame,Object(z.a)(this,this.Hmg,"tryOfficeThroughTellMe"));this.ga.ra(Za.a.kBj,Ad.a.frame,Object(z.a)(this,this.lBj,"tryOfficeThroughViewer"));this.ga.ra(Za.a.jBj,Ad.a.frame,Object(z.a)(this,this.lBj,"tryOfficeThroughViewer"))}etn(b,h,u,B,Q){if(this.dzd&&1===u)return this.isFreemiumUpsellEnabled&&this.E9c?32:8;2===u&&(Q?(b=Q.SourceControlId,"btnjTryOfficeForWordEditor"===b?Qd.a.om(fa.a.d2a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===b?Qd.a.om(fa.a.d2a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.aJf()):this.aJf());return 32}Hmg(b,h,u,B,Q){if(this.dzd&&1===u)return this.isFreemiumUpsellEnabled&&this.E9c?32:8;2===u&&(Q?(b=Q.SourceControlId,Qd.a.om(fa.a.U8("862405")+this.f7l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Qd.a.om(fa.a.U8("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}lBj(b,h,u){if(this.dzd&&1===u)return this.isFreemiumUpsellEnabled&&
this.E9c?32:8;if(2===u)switch(b){case Za.a.kBj:Qd.a.om(fa.a.d2a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Za.a.jBj:Qd.a.om(fa.a.d2a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get khn(){return this.E9c}get jhn(){return this.E9c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get E9c(){return this.b7j&&!Z.a.Wk}get isFreemiumUpsellEnabled(){let b=!1;this.tI&&(b=this.tI.isFreemiumUpsellEnabled());return b}aJf(b=null){let h=0;b&&(h=b);Qd.a.om(sG.I0l(h),"_blank",void 0,"LaunchOfficeOffer")}f7l(b){let h=
0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static I0l(b){if(Z.a.ri)switch(b){case 1:return fa.a.U8("393806");case 2:return fa.a.U8("393810");case 3:return fa.a.U8("393809");case 5:return fa.a.U8("393805")}else if(Z.a.TH)switch(b){case 1:return fa.a.U8("521979");case 3:return fa.a.U8("521980");case 5:return fa.a.U8("521978");case 2:return fa.a.U8("522490")}else{if(2===b)return fa.a.U8("517778");
if(1===b)return fa.a.d2a(30)}return fa.a.U8("522402")}}Object(m.a)(sG,"OfficeTrialExperience",null,[976]);class iJ{wc(b){b.register(sG,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().Sd(()=>new sG(v.AFrameworkApplication.va,v.AFrameworkApplication.mFf,v.AFrameworkApplication.lcid));b.register(rG,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().Sd(()=>new rG(v.AFrameworkApplication.va,v.AFrameworkApplication.wyi,v.AFrameworkApplication.lcid))}}
Object(m.a)(iJ,"OpenInClientConfiguration",null,[2]);class jJ{constructor(b=!1,h=!1,u=!1,B=!1,Q=!0,ca=!1,qa=!0,Qa=!0,rb=!0,Lb=!1,Yb=!1,gc=!1,Fc=!1,Sc=!1,ld=!1,Hd=!1,Ie=!1,fe=!1,de=null,ne=null,ye=null,Vf=null,Og=null,Bl=null,sm=null,op=null,zv=null){this.Nbc=!1;this.Xck=b;this.bdk=h;this.shk=u;this.qhk=B;this.lhk=Q;this.mhk=ca;this.ohk=qa;this.phk=Qa;this.nhk=rb;this.Dhk=Lb;this.Yhk=Yb;this.Chk=gc;this.sjk=Fc;this.whk=Sc;this.l5j=ld;this.Rhk=Hd;this.Zhk=Ie;this.MWj=fe;this.uhk=de;this.Bhk=ne;this.rhk=
Og;this.zhk=ye;this.thk=Vf;this.yhk=Bl;this.Ahk=sm;this.vhk=op;this.xhk=zv}get o_i(){return this.Xck}get pzn(){return this.bdk}get zoj(){return this.shk}get yoj(){return this.qhk}get Lpo(){return this.lhk}get Mpo(){return this.mhk}get Opo(){return this.ohk}get Ppo(){return this.phk}get Npo(){return this.nhk}get Opb(){return this.whk}get vAm(){return this.l5j}get fpj(){return this.Rhk}get Ipj(){return this.Zhk}get dSk(){return this.MWj}get Coj(){return this.Dhk}get Tro(){return this.Yhk}get Ypo(){return this.Chk}get ovj(){return this.sjk}get Aoj(){return this.uhk||
Object(z.a)(this,this.jjc,"returnFalse")}get Xpo(){return this.Bhk||Object(z.a)(this,this.jjc,"returnFalse")}get Wpo(){return this.zhk||Object(z.a)(this,this.F9f,"returnTrue")}get Rpo(){return this.thk||Object(z.a)(this,this.F9f,"returnTrue")}get Qpo(){return this.rhk||Object(z.a)(this,this.jjc,"returnFalse")}get Vpo(){return this.yhk||Object(z.a)(this,this.F9f,"returnTrue")}get Boj(){return this.Ahk||Object(z.a)(this,this.jjc,"returnFalse")}get Spo(){return this.vhk||Object(z.a)(this,this.jjc,"returnFalse")}get Upo(){return this.xhk||
Object(z.a)(this,this.jjc,"returnFalse")}F9f(){return!0}jjc(){return!1}}Object(m.a)(jJ,"HtmlTranslatorSettings",null,[182]);class qB{constructor(b,h,u,B,Q,ca,qa){this.Uf=b;this.ig=h;this.hX=u;this.Nif=B;this.Bj=Q;this.Pd=ca;this.sR=qa}BBm(b,h){var u;b=h.view;h=h.ek;if(!h||!this.Uf.mwi(h,!0)||this.Nif&&this.Nif.instance&&this.Nif.instance.EU(h))return 2;var B=qB.W7a?!qB.q0.vxa(h):!0;this.hX&&B&&this.hX.Mnc(h.node,Se.a.Ls,h.cpBegin);B=h.node;(null===(u=this.sR)||void 0===u?0:u.replaceText)&&this.sR.Ucc(B)?
(u=B.qa.V0a(h.cpBegin),this.sR.replaceText(B,u,u,mw.a.dZc)):this.ig.Uha(h,Q=>new mw.a(Q));if(this.Pd.tg){u=new Qg.GraphTransaction(15);try{u.Db(h.node),this.Bj.kra(h.node,h.cpBegin,h.cpBegin+1,1)}finally{u&&u.dispose()}}B=h.node;u=h.cpEnd+1;" "===me.ParagraphReader.text(B).charAt(u)&&(B=Je.a.createTextRange(B,u,u+1),this.ig.Ge(B,"\u00a0"));h=Je.a.Oc(h.node,u);b.mb.Bc(Cg.SelectionFactory.Tn(h));return 32}static get q0(){return null!=qB.Izg?qB.Izg:qB.Izg=Ga.a.instance.resolve("Box4.IHyperlinkStrategy")}static get W7a(){null==
qB.hma&&(qB.hma=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return qB.hma}}qB.hma=null;Object(m.a)(qB,"InsertLineBreakStrategy",null,[]);class dw{static get Yf(){return null!=dw.sDg?dw.sDg:dw.sDg=Ga.a.instance.resolve("Box4.IOutlineElementEditor")}static get Xg(){return On.ContextSetEditor.instance}static get Bj(){return null!=dw.NGg?dw.NGg:dw.NGg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Pd(){return null!=
dw.qHg?dw.qHg:dw.qHg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static ZBm(b,h,u,B,Q){if(Q&&Q.hasProperty($c.a.targetObject)){var ca=h.view.ed.Lc.Eb(Q.getValue($c.a.targetObject));ca=Je.a.create(ca)}else ca=dw.Xg.HT(h.ek,11);if(!ca)return 8;b=v.AFrameworkApplication.va.Kf(ca,b,u,!0,B,Q);if(32===b&&2===u){if(!h.view.qe)return 2;h=h.view;B=h.mb.ng;if(B=dw.Xg.HT(B,11)){u=new sk.a;u.set(B.node);u.rd();if(Q&&Q.hasProperty($c.a.targetObject))for(Q=Q.rf($c.a.targetObject);!u.currentNode.id.equals(Q)&&
u.rc()&&(gf.OutlineElementNavigator.Wd(u),11===u.Ue););gf.OutlineElementNavigator.X0(u,!1,!1);Q=Ge.SelectionEditor.DEa(u,!0);Q=me.ParagraphReader.At(Q)?Cg.SelectionFactory.ne(Q,0):Cg.SelectionFactory.Aq(Q);h.mb.Bc(Q)}}return b}static eXd(b,h,u,B,Q){b=b===Ob.a.rUc;h=h.node;if(Q&&Q.hasProperty($c.a.targetObject)&&!h.id.equals(Q.rf($c.a.targetObject)))return 2;if(1===u)return 32;u=new vd.GraphIterator;u.set(h);u.zb(10);dw.Yf.Iz(u,b,!0);dw.Pd.tg&&(u=gf.OutlineElementNavigator.Ce(u),dw.Bj.bQb(u,1));return 32}}
Object(m.a)(dw,"InsertOutlineElementStrategy",null,[]);class tG{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.rri=(gc,Fc,Sc)=>{var ld,Hd;if(null===(ld=this.raa)||void 0===ld?0:ld.eqb)return this.raa.eqb(Sc,Fc.cpBegin,{Fb:Fc.Fb,Sb:Fc.Sb});ld=!Fc.cpBegin;Sc=Fc.cpBegin===me.ParagraphReader.textLength(Sc);const Ie=!(null===(Hd=Fb.App.xd)||void 0===Hd||!Hd.So);let fe=!0;Ie&&ld&&!Sc?(fe=!1,Hd=new vd.GraphIterator,Hd.jd(gc),Hd.rd(),this.mh.Iz(Hd,!0,!1)):Hd=this.mh.Zoa(gc);this.mh.G$(gc,Hd,Fc,!1,!0,fe,!1,
!0);!Ie||ld||Sc||(gc=On.ContextSetEditor.instance.VPd(Fc),Fb.App.xd.Yp.$F(gc));return Hd};this.uZ=h;this.j0j=b;this.dA=ca;this.k9j=Q;this.mh=u;this.cZj=B;this.Ik=qa;this.ib=Qa;this.JE=rb;this.jsc=Lb;this.raa=Yb}ken(b,h,u,B,Q){if(!h.view.qe)return 2;h=h.view;let ca=null;h.Vi&&(ca=h);const qa=h.mb.ng;var Qa=!0;let rb=!1,Lb=null;if(!qa)return 2;const Yb=new Qg.GraphTransaction(15);Yb.Db(h.ed);let gc=null;2===u&&(gc=new sk.a,gc.set(qa.node),gc.rd(),Lb=new mA.a(gc),gf.OutlineElementNavigator.Wd(gc),Qa=
Yc.OutlineElementReader.isEmpty(gc,!1),{Roj:Qa,jJj:rb}=this.cZj.Soj(gc,Qa,Cr.a.jGb,-1,qa));b=v.AFrameworkApplication.va.Kf(qa,b,u,!1,B,Q);Qa&&32===b&&2===u&&(rb||gf.OutlineElementNavigator.QGa(gc,!1,!Ge.SelectionEditor.ef(qa),!1),rb&&Lb&&Lb.restore(gc),this.dA.freeze(),(u=Cg.SelectionFactory.oo(gc.currentNode,!0))||r.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.mb.Bc(u),this.dA.TIa(),this.j0j.Qg.nF());ca&&(Qa||ca.z5(),ca.ve&&ca.FU&&(ca.ve.kI=!0));sq.GrippersManager.instance.uSb(1);
Yb.dispose();return b}newLine(b,h,u){b=!1;if(Dd.ImageReader.G4(h)||Dd.ImageReader.B3a(h))h=this.p5k(h),b=!0;const B=h;if((h=Ge.SelectionEditor.ef(h))&&this.Ik.fh&&!this.Ik.rOm(B))return 2;if(1===u)return 32;const Q=B.node,ca=new vd.GraphIterator;ca.set(Q);ca.rd();gf.OutlineElementNavigator.Wd(ca);u=new Qg.GraphTransaction(15);u.Qt(ca);h?(this.jsc.instance&&this.jsc.instance.jJa(B),me.ParagraphReader.Wb(Q)&&B.cpBegin===me.ParagraphReader.textLength(Q)&&Hq.m(B)&&9===me.ParagraphReader.voa(Q)&&this.dA.m6k(B),
Lf.ListItemReader.jg(ca)?this.k9j.execute(ca,B,Q,this.rri):this.rri(ca,B,Q),this.uZ&&this.uZ.Mnc(Q,Se.a.Ls,B.cpBegin),b&&(gf.OutlineElementNavigator.$r(ca,!1,!1),b=ca.Ub(2),(b=this.JE.ne(b,0))&&this.ib.Bc(b))):this.mh.Iz(ca,!0,!0);u.dispose();Fb.App.za&&Fb.App.za.updateCommandUI();return 32}p5k(b){if(Dd.ImageReader.G4(b))var h=Je.a.Oc(b.node,b.cpBegin);else{h=me.ParagraphReader.TQ(b.node);var u=h.properties.rf(Jc.a.rq);b=b.node.properties.getValue(Jc.a.runId);u=tG.nof(b,u,h.qa);h=Je.a.Oc(h,u)}return h}static Tjf(b,
h){let u=0;for(;u<h.length&&!(b<h[u]);)u++;return u}static nof(b,h,u){let B=0;b=tG.Tjf(b,h);let Q=0;if(b===h.length)Q=u.length-1;else for(;Q<u.length;){h=u.J(Q);if(h.formatting&&h.formatting.oe===b)break;Q++}Q<u.length&&(B=u.J(Q).cp);return B}}Object(m.a)(tG,"NewLineStrategy",null,[]);class $D{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld,Hd){this.Lm=null;this.uma=b;this.Wjd=qa;this.Wqd=new tG(this,h,u,B,Q,ca,Qa,Yb,gc,ld,Hd);this.$Yg=new qB(Qa,rb,h,Lb,Fc,Sc,Hd)}get Qg(){return this.Lm||(this.Lm=
this.uma())}Tb(){const b=v.AFrameworkApplication.va,h=Object(z.a)(this.Wqd,this.Wqd.newLine,"newLine");b.fb(Ob.a.enter,vc.a.view,Object(z.a)(this.Wjd.value,this.Wjd.value.Tvl,"enterView"),1124);b.fb(Ob.a.Ynj,vc.a.view,Object(z.a)(this.Wjd.value,this.Wjd.value.xoo,"shiftEnterView"),1124);b.ra(Ob.a.newLine,vc.a.view,Object(z.a)(this.Wqd,this.Wqd.ken,"newLineView"));b.ra(Ob.a.newLine,vc.a.Tc,h);b.ra(Ob.a.newLine,vc.a.image,h);b.ra(Ob.a.newLine,vc.a.Jd,h);b.ra(Ob.a.newLine,vc.a.M7,h);b.ra(Ob.a.newLine,
vc.a.chb,h);b.ra(Ob.a.newLine,vc.a.ink,h);b.ra(Ob.a.newLine,vc.a.paragraph,h);b.ra(Ob.a.newLine,vc.a.iFrame,h);b.ra(Ob.a.newLine,vc.a.unsupportedObject,h);b.Xc(Ob.a.newLine,1124);b.fb(Ob.a.nUc,vc.a.view,Object(z.a)(this.$Yg,this.$Yg.BBm,"insertLineBreakView"),1028);b.ra(Ob.a.rUc,vc.a.view,dw.ZBm);b.ra(Ob.a.rUc,vc.a.HP,dw.eXd);b.Xc(Ob.a.rUc,1092)}static get instance(){return null!=$D.LAg?$D.LAg:$D.LAg=$D.Wl()}static Wl(){return new $D(()=>Ga.a.instance.resolve("Box4.IUndoManager"),Ga.a.instance.Oa("Box4.IAutoCorrectScheduler"),
Ga.a.instance.resolve("Box4.IOutlineElementEditor"),Ga.a.instance.resolve("Box4.List.ICursorMovementValidator"),Ga.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ga.a.instance.resolve("Box4.IInsertionPointFormatting"),Ga.a.instance.Re("Box4.Actors.IEnterViewStrategy"),ti.a.instance,Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.Ta("Box4.IExternalSelectionManager"),xf.a.instance,Ga.a.instance.resolve("Box4.ISelectionFactory"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.Ta("Box4.IContentControlConverter"),Ga.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(m.a)($D,"EnterActor",null,[]);var kH=c(1398),lH=c(886);class Bk{static get il(){return null!=Bk.$Dg?Bk.$Dg:Bk.$Dg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get N5(){return null!=Bk.yFg?Bk.yFg:Bk.yFg=Ga.a.instance.Oa("Box4.ISpacingCommands")}static get tUa(){return null!=Bk.JFg?Bk.JFg:Bk.JFg=Ga.a.instance.Oa("Box4.Styles.IWACStyleReader")}static get xGa(){return null!=
Bk.uCg?Bk.uCg:Bk.uCg=Ga.a.instance.Oa("Box4.ILineSpacingHelper")}static get Bj(){return null!=Bk.VGg?Bk.VGg:Bk.VGg=Ga.a.instance.Oa("Box4.TrackChange.ITrackChangeEditor")}static get Pd(){return null!=Bk.vHg?Bk.vHg:Bk.vHg=Ga.a.instance.Oa("Box4.TrackChange.ITrackChangeManager")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.NJf,vc.a.view,ng.a.jw);b.Xc(Ob.a.NJf,1028);b.ra(Ob.a.jD,vc.a.view,ng.a.jw);b.ra(Ob.a.jD,vc.a.paragraph,Bk.vCd);b.Xc(Ob.a.jD,1036);b.ra(Ob.a.tkc,vc.a.paragraph,Bk.JCk);
b.ra(Ob.a.tkc,vc.a.view,ng.a.jw);b.Xc(Ob.a.tkc,1036);b.ra(Ob.a.H8c,vc.a.paragraph,Bk.e1e);b.ra(Ob.a.H8c,vc.a.view,ng.a.jw);b.ra(Ob.a.h9c,vc.a.paragraph,Bk.A1e);b.ra(Ob.a.h9c,vc.a.view,ng.a.jw);b.ra(Ob.a.G8c,vc.a.paragraph,Bk.d1e);b.ra(Ob.a.G8c,vc.a.view,ng.a.jw);b.ra(Ob.a.sZe,vc.a.view,Bk.iyk);b.Xc(Ob.a.sZe,1036);b.ra(Ob.a.c7f,vc.a.view,Bk.R_n);b.Xc(Ob.a.c7f,1036);b.ra(Ob.a.rZe,vc.a.view,Bk.hyk);b.Xc(Ob.a.rZe,1036);b.ra(Ob.a.b7f,vc.a.view,Bk.Q_n);b.Xc(Ob.a.b7f,1036);b.ra(Ob.a.XTa,vc.a.view,ng.a.jw);
b.ra(Ob.a.XTa,vc.a.paragraph,Bk.vCd);b.Xc(Ob.a.XTa,1036);b.ra(Ob.a.WTa,vc.a.view,ng.a.jw);b.ra(Ob.a.WTa,vc.a.paragraph,Bk.vCd);b.Xc(Ob.a.WTa,1036);b.ra(Ob.a.ije,vc.a.view,Bk.hje);b.ra(Ob.a.ije,vc.a.paragraph,Bk.hje);b.Xc(Ob.a.ije,1028);b.ra(Ob.a.ohg,vc.a.view,Bk.hje);b.ra(Ob.a.ohg,vc.a.paragraph,Bk.hje);b.Xc(Ob.a.ohg,1028);b.ra(Ob.a.$ie,vc.a.view,ng.a.jw);b.ra(Ob.a.$ie,vc.a.paragraph,Bk.uth);b.Xc(Ob.a.$ie,1028);b.ra(Ob.a.Zie,vc.a.view,ng.a.jw);b.ra(Ob.a.Zie,vc.a.paragraph,Bk.uth);b.Xc(Ob.a.Zie,1028)}static uth(b,
h,u,B,Q){if(1===u)return 32;b===Ob.a.$ie?b=Ob.a.XTa:b===Ob.a.Zie&&(b=Ob.a.WTa);return Bk.vCd(b,h,u,B,Bk.Nyn(Q))}static Nyn(b){var h=b.indexOf(",");const u=b.substring(0,h);b=b.substring(h+1,b.length);h=new kH.a;h.value=parseFloat(u);h.unit=parseInt(b);return h}static hje(b,h,u,B,Q){if(2===u){h=Q[gj.a.Text];u=Q[gj.a.Number];Q=Q.Increment;B=new kH.a;let ca=!1;""===h||Q&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(B.value=0,B.unit=Fb.App.gGa?2:4,ca=!0):u||Q||(B.value=0,B.unit=1,ca=!0);ca&&(v.AFrameworkApplication.va.Rb(b===
Ob.a.ije?Ob.a.XTa:Ob.a.WTa,2,B),Fb.App.za.updateCommandUI())}return 32}static vCd(b,h,u,B,Q){if(!({xy:u}=ng.a.Eeg(u,h)).returnValue)return u;h=h.node;switch(b){case Ob.a.jD:Bk.il.jD(h,new lH.a(2,Q));break;case Ob.a.XTa:b=new lH.a(Q.unit,Q.value);Bk.il.jpb(h,b);break;case Ob.a.WTa:b=new lH.a(Q.unit,Q.value),Bk.il.ipb(h,b)}B&&Xq.a.Gqb&&(B.As|=Xq.a.rib(h));return 32}static iyk(b,h,u){if(1===u)return 32;r.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Bk.sgi(h);if(!b)return r.ULS.sendTraceTag(588367186,
3018,10,"No style applied on the paragraph"),8;b=(b=b.ja(Jc.a.Pi,240)/20)?b:Bk.jhl;Bk.N5.bea(1,b,4);return 32}static R_n(b,h,u){if(1===u)return 32;r.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Bk.N5.bea(1,0,4);return 32}static hyk(b,h,u){if(1===u)return 32;r.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Bk.sgi(h);if(!b)return r.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ja(Jc.a.ta,240)/
20;Bk.N5.bea(0,b?b:12,4);return 32}static Q_n(b,h,u){if(1===u)return 32;r.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Bk.N5.bea(0,0,4);return 32}static e1e(b,h,u,B,Q){if(2==u){if("boolean"!==typeof Q)return 16;b=h.node;h=null;uq.a.instance.J(1)&&(h=b.VD());Bk.il.e1e(b,Q);h&&Bk.Bj.sV(b,h,Bk.Pd.tg)}return 32}static A1e(b,h,u,B,Q){if(2==u){if("boolean"!==typeof Q)return 16;b=h.node;h=null;uq.a.instance.J(1)&&(h=b.VD());Bk.il.A1e(b,Q);h&&Bk.Bj.sV(b,h,Bk.Pd.tg)}return 32}static d1e(b,
h,u,B,Q){if(2==u){if("boolean"!==typeof Q)return 16;b=h.node;h=null;uq.a.instance.J(1)&&(h=b.VD());Bk.il.d1e(b,Q);h&&Bk.Bj.sV(b,h,Bk.Pd.tg)}return 32}static JCk(b,h,u,B,Q){if(2==u){if("boolean"!==typeof Q)return 16;b=new Map;b.set("Value",Q.toString());xa.Health.instance.recordKpiUsage(nj.a.xlb.LIo,0,nj.a.xB,b);h=h.node;b=null;uq.a.instance.J(1)&&(b=h.VD());h.hasProperty(Jc.a.qw)&&h.removeProperty(Jc.a.qw);Bk.xGa.bQd(h)!==Q&&h.setValue(Jc.a.qw,Q);(Q=Bk.xGa.C9b(h,!0))&&Q.gl(4,!0);(Q=Bk.xGa.C9b(h,!1))&&
Q.gl(4,!0);b&&Bk.Bj.sV(h,b,Bk.Pd.tg)}return 32}static sgi(b){b=b.view;return b.qe&&(b=b.mb)&&b.hb.lb?Bk.tUa.Ro(b.hb.lb.Pa.node):null}}Bk.jhl=12;Object(m.a)(Bk,"SpacingActor",null,[]);class kJ{process(){}}Object(m.a)(kJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[35]);class lJ{constructor(b){this.Be=b}Bgo(b,h){this.Be.Kja(b,h.cache.zG);this.Be.WA(b,h.cache.fontSize)}XFb(){return null}hFa(){return null}n$b(){return null}nU(){return null}}Object(m.a)(lJ,"FormattingStewardBridge",null,[39]);
class mJ{wc(b){b.ia("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new kJ).ha();b.ia("Box4.Actors.IFormattingStewardBridge",()=>new lJ(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(m.a)(mJ,"WoncaActorsConfiguration",null,[2]);class nJ{constructor(b,h,u,B,Q,ca,qa,Qa){this.ga=b;this.cWj=h;this.bWj=u;this.LLg=B;this.$ck=Q;this.Esd=ca;this.ddk=qa;this.edk=Qa}get nc(){return this.ga}HKk(b){this.nc.Eqa(b,this.cWj,null,null)}FKk(b){this.nc.Eqa(b,this.bWj,null,null)}F_(b,h,u){u?this.nc.Eqa(b,
this.LLg,h,null):this.nc.Rb(this.LLg,2,h)}rzn(b,h){this.nc.Eqa(b,this.Esd,h,null)}Z9(b,h){this.nc.Eqa(b,this.ddk,h,null)}Snb(b,h){this.nc.Eqa(b,this.edk,h,null)}OZf(b,h=!1){const u=new Od.DictionaryPropertySet;u.setValue($c.a.IP,b);u.setValue($c.a.J_i,!0);u.setValue($c.a.P3a,h);this.nc.Rb(this.$ck,2,u)}}Object(m.a)(nJ,"ClipboardCommands",null,[1357]);class oJ{}Object(m.a)(oJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1250]);class pJ{constructor(b){this.ga=b}get nc(){return this.ga}clj(b,
h,u){let B=0;b?1===b&&(B=Ob.a.j3a):B=Ob.a.i3a;b=new KC.a;b.unit=u;b.value=h;this.nc.Rb(B,2,b)}Mge(b,h,u){let B=0;1===b?B=Ob.a.UPb:2===b?B=Ob.a.zpb:b||(B=Ob.a.VPb);b=new KC.a;b.unit=u;b.value=h;this.nc.Rb(B,2,b)}}Object(m.a)(pJ,"IndentationCommands",null,[1295]);var uG;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.Iip=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.Sep=7]="distribute";b[b.margin=8]="margin";
b[b.iip=9]="highKashida";b[b.Zjp=10]="lowKashida";b[b.jkp=11]="mediumKashida";b[b.jlp=12]="numTab";b[b.$qp=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(uG||(uG={}));Object(m.b)("Justification",uG);class qJ{constructor(b){this.MLa={};this.ga=b;this.gxm()}get nc(){return this.ga}lE(b){b=this.MLa[uG[b]];void 0!==b&&null!==b&&this.nc.processAction(b,2)}gxm(){this.MLa.left=Ob.a.y9;this.MLa.center=Ob.a.Aba;this.MLa.right=Ob.a.o$;this.MLa.both=Ob.a.NEa;this.MLa.lowKashida=Ob.a.UJb;this.MLa.mediumKashida=
Ob.a.UJb;this.MLa.highKashida=Ob.a.UJb;this.MLa.distribute=Ob.a.uLc;this.MLa.thaiDistribute=Ob.a.$8c}}Object(m.a)(qJ,"JustificationCommands",null,[1282]);class rJ{constructor(b){this.ga=b}jD(b){this.ga.Rb(Ob.a.jD,2,b)}tkc(b){this.ga.Rb(Ob.a.tkc,2,b)}H8c(b){this.ga.Rb(Ob.a.H8c,2,b)}h9c(b){this.ga.Rb(Ob.a.h9c,2,b)}G8c(b){this.ga.Rb(Ob.a.G8c,2,b)}bea(b,h,u){this.ga.Rb(b?Ob.a.XTa:Ob.a.WTa,2,Object.assign(new kH.a,{value:h,unit:u}))}}Object(m.a)(rJ,"SpacingCommands",null,[1172]);class sJ{constructor(b,
h,u){this.nc=b;this.XLc=h;this.$rl=u;this.hun=(B,Q,ca)=>{if(1===ca)return this.XLc.y_?32:8;this.XLc.q0m();this.$rl().Jto(this.XLc.wUl());return 32}}Tb(){this.nc.fb(Ob.a.xnb,vc.a.application,this.hun,1028)}}Object(m.a)(sJ,"EditorSettingsUIActor",null,[]);class tJ extends Hf.a{constructor(b,h){super(!1,!1,!0);this.bsl=b;this.zRa=h;this.asl=u=>{1!==u?r.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.bsl.lRo(),r.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async Jto(b){const h=
await this.zRa.rKb;b={["id"]:"SettingsDialog",["uiLanguage"]:v.AFrameworkApplication.uiCulture,["selectedLanguage"]:Jj.a.qg(v.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.YXc,["editorSettings"]:b};this.Qh(Box4Intl.Box4Strings.l_EditorSettings,this.asl,b);r.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(m.a)(tJ,"EditorSettingsDialog",Hf.a,[]);class uJ{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld){this.xxb=this.mAc=this.vrc=null;this.sSe=
0;this.uEe=!1;this.sa=new Nc.a;this.mZd=!1;this.Yu=b;this.dA=h;this.Be=u;this.Ts=B;this.gb=Q;this.Ef=qa;this.Ld=Qa;this.Ik=rb;this.od=Lb;this.Ud=Yb;this.wq=gc;this.OW=Fc;this.nz=Sc;this.Io=ld}get Dtl(){return this.od?this.od.isFeatureEnabled(43):!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get qlf(){return null!=this.Iyg?this.Iyg:this.Iyg=Ga.a.instance.resolve("Box4.IFormatPainterStrategy")}get AR(){return this.uEe}set AR(b){this.uEe!==b&&(this.uEe=
this.mZd=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Vuk(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}v0i(b){const h=b.Pa;r.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var u=h.node;b=this.Nyi(b);if(this.qlf.Fqo(h.contextId,b))try{this.xxb=this.gb.u2a(u)}catch(B){throw r.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",B.message),B;}this.mAc=this.nz.Ro(u);u=zc.FormattingReader.Vr(h);u.En&&(this.vrc=
Object(Na.a)(Qy.a,u.En.clone()));this.sSe=b?vc.a.paragraph:h.contextId}Rsh(b){if(b){const u=this.Nyi(b);for(let B=0;B<b.length;B++){const Q=b.J(B);if(null===Q||void 0===Q?0:Q.Vk)this.EAb(Q,u);else if(0==(null===Q||void 0===Q?void 0:Q.length))r.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",Q);else if(Q)for(let ca=0;ca<Q.length;ca++){var h=Q.getContext(ca);if(null===h||void 0===h?0:h.gx){if(h)for(let qa=0;qa<h.length;qa++)Q.addContext(h.getContext(qa))}else(null===
h||void 0===h?0:h.Vk)?this.EAb(h,u):r.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}Ush(b,h){if(h){var u=b.node,B=u.qa.last,Q=this.Ld.i1a(u),ca=Q.yf(Q.Kb);this.Vsh(Q,h,null);uq.a.instance.J(1)&&this.wq.FPb(u,B,b.cpBegin,b.cpEnd,ca,Q,this.Ud.tg)}}YCk(b,h,u){if(h||u)0<Hq.g(b).length&&r.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.OW.w_(b,B=>{this.Vsh(B,h,u)})}Vsh(b,h,u){this.Be.vga(b);b.En&&b.En.removeProperty(Xe.a.highlight);
this.Be.X6e(b);u&&(u=u.clone(),u.zg(...Qp.a.wca()),this.Yw(b,u.xl()));this.Yw(b,h)}Yw(b,h){if(h){var u=b.paragraph.Lc;if(u){var B=b.En;B=B?Object(Na.a)(Jv.a,B.clone()):Qy.a.mOa(1179725);for(const ca of h.Jl())if(ca!==Jc.a.kw&&ca!==Jc.a.HX&&ca!==Xe.a.OB&&ca!==Xe.a.J4&&ca!==Jc.a.I3a&&ca!==Xe.a.rL&&ca!==Jc.a.G4a&&ca!==Jc.a.noProof){if(ca===xh.a.nw){var Q=h.ja(xh.a.nw,W.a.nil);if(Q!==W.a.nil)if(Q=u.Eb(Q)){if(Q=new sx.a(Q),Q=this.nz.qR(Q),Q===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(Q=this.nz.ZC(b.paragraph).nFa(Q)){B.rOa(Q.xl(),
...Qp.a.wca());continue}else r.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else r.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}B.setValue(ca,h.rf(ca))}B.pGa?h=u.fV(B,!0):(u.Su(B),h=B);b.Tj=h.id}}}Nyi(b){return!b.Vw&&b.Rc.contextId!==vc.a.Uc}reset(){this.xxb=this.mAc=this.vrc=null;this.sSe=vc.a.none}EAb(b,h){if(b.contextId===vc.a.Tc||b.contextId===vc.a.Jd)var u=this.Ik.n9(b);else if(b.contextId===
vc.a.paragraph)u=this.Ik.s_d(b);else if(b.contextId===vc.a.Uc)u=this.Ik.XYd(b);else{r.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}r.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(u)r.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{u=Object(Na.a)(wp.AParagraphNode,b.node);var B=!1;u&&(B=b.contextId===vc.a.Jd&&!!u&&!b.cpBegin&&b.cpEnd===this.gb.textLength(u));if(h=this.qlf.Joo(this.sSe,
b.contextId,h,B))try{me.ParagraphReader.Wb(u)?(this.mAc&&this.Yu.YJ(this.mAc,u,!0),this.Ts.lth(u,this.xxb)):r.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(Q){throw r.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",Q.message),Q;}B=b;b.contextId===vc.a.paragraph?B=Je.a.createTextRange(u,0,me.ParagraphReader.textLength(u)):b.contextId===vc.a.Tc&&(B=this.dA.ftf(b),B=xf.a.ICb(B));if(B&&B.contextId===
vc.a.Jd){if(In.a.dHd){const Q=this.Io.KSd(B);Q&&(B=Q)}try{this.YCk(B,this.vrc,h?null:this.mAc)}catch(Q){throw r.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",Q.message),Q;}}if(b.contextId===vc.a.paragraph||b.contextId===vc.a.Uc)h=new vd.GraphIterator,h.set(u),h.rd(),h.ld(11),B=Lf.ListItemReader.jg(h),u=!me.ParagraphReader.textLength(u),r.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",B,u),B?(this.Ef.BP(h),this.Ef.Uca(h.currentNode)&&
this.Ush(b,this.vrc)):this.Dtl&&this.Ush(b,this.vrc)}}}Object(m.a)(uJ,"FormatPainter",null,[1324]);var CM=c(109);class aE{constructor(b,h,u,B,Q,ca,qa,Qa=!1,rb,Lb,Yb){this.Aod=!1;this.VAe=new Ls.a;this.Lmm=()=>{this.WS.AR=!1;return 32};this.Mmm=(gc,Fc,Sc)=>{gc=!1;if(Fc=this.mz.k4){switch(Fc.contextId){case vc.a.Jd:case vc.a.paragraph:case vc.a.Uc:case vc.a.Tc:gc=!0}gc&&Ge.SelectionEditor.nl(Fc)&&Hq.b(Fc)&&(this.yd.Yb(pd.a.rn,{["Reason"]:pe.a.WIc}),gc=!1);gc&&me.ParagraphReader.AU(Fc)&&(this.yd.Yb(pd.a.rn,
{["Reason"]:pe.a.yO}),gc=!1)}if(1===Sc||!gc)return gc?32:8;6!==this.ga.KC?(this.WS.AR?r.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(r.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.WS.v0i(this.mz.lb),this.Aod||(this.Lh.XZa(this.RDj),(Sc=this.Lh.jb.gu)&&Sc.Vi&&Sc.Voh(this.QDj),this.Aod=!0)),this.WS.AR=!this.WS.AR):(r.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.WS.v0i(this.mz.lb),this.WS.AR=
!1);return 32};this.Kmm=(gc,Fc,Sc,ld,Hd)=>{if(6===this.ga.KC||this.WS.AR){r.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.KC);gc=this.Lh.Iq.Vf("UserAction","FormatPainterApply");if(aE.Zb&&aE.Zb.NB(117)){Hd=Hd?Hd.KeepBrushActive:!1;Sc=null;this.mz.lb&&2===this.mz.lb.trigger&&(Hd=Hd||this.WS.mZd,this.WS.mZd&&Ge.SelectionEditor.Il(this.mz.lb)&&(Sc=Ge.SelectionEditor.c0(this.mz.lb.Pa,!1)))&&(Sc.trigger=2);this.WS.mZd=!1;if(Hd||2!==this.mz.lb.trigger)Fc=
new Qg.GraphTransaction(15),Sc&&Sc.Pa?(Fc.set(Sc.Pa.node.tj),this.ib.Bc(Sc)):Fc.set(this.mz.zEb.tj),Sc=Cg.SelectionFactory.Tn(this.ib.ng),this.WS.Rsh(Sc),Fc.dispose();this.WS.AR=Hd}else Hd=new Qg.GraphTransaction(15),Hd.set(this.mz.zEb.tj),Fc=Cg.SelectionFactory.Tn(this.ib.ng),this.WS.Rsh(Fc),this.WS.AR=!1,Hd.dispose();gc.stop()}return 32};this.RDj=()=>{this.f8d(this.WS.AR)};this.QDj=()=>{this.f8d(this.WS.AR)};this.Lh=b;this.Vb=h;this.ga=u;this.yd=B;this.mz=Q;this.WS=ca;this.ib=qa;this.r6j=Qa;this.iy=
rb;this.yx=Lb;this.kZj=Yb}get SUg(){return Z.a.pu||Z.a.L_d?"url("+this.T8h()+"), pointer":'url("'+this.T8h()+'"), pointer'}T8h(){return this.yx?this.iy.uwa(xk.a.sg("FormatPainterText.cur"),xk.a.sg("FormatPainterTextDarkMode.cur"),new CM.a(Kl.a.cL())):xk.a.sg("FormatPainterText.cur")}Tb(){const b=this.Vb.ae(Zj.AppFrame.PD);b.bindAction(Nb.KeyInputManager.ic(Se.a.yJa,0),Ob.a.plf);b.bindAction(Nb.KeyInputManager.ic(Se.a.Zrb,6),Ob.a.HOd);this.r6j||b.bindAction(Nb.KeyInputManager.ic(Se.a.csb,6),Ob.a.D1a);
this.ga.fb(Ob.a.HOd,vc.a.view,this.Mmm,1028);this.ga.fb(Ob.a.D1a,vc.a.view,this.Kmm,1028);this.ga.fb(Ob.a.plf,vc.a.view,this.Lmm,1028);this.WS.Vuk(()=>{this.Vog(this.WS.AR)});this.yx&&this.kZj.hBd(()=>{this.f8d(this.WS.AR)})}Vog(b){const h=this.Lh.Iq.Vf("UserAction","FormatPainterUpdateCursor");this.f8d(b);this.Lh.updateCommandUI();h.stop()}PDj(b,h){for(let u=0;u<b.length;u++)this.ODj(b[u],h);(b=this.Lh.jb.gu)&&b.qe&&this.ODj(b.rh.editingElement,h)}ODj(b,h){b.style.cursor=h?this.SUg:""}f8d(b){const h=
document.querySelectorAll(".OutlineElement");if(1<h.length){const u=h[h.length-2].style.cursor===this.SUg;if(this.Lh.jb.isEditingAllowed||this.Lh.jb.Ky){if(b&&!u||!b&&u)this.PDj(h,b),this.nEj(b);b||!this.Aod||this.VAe.count||(this.Lh.J$i(this.RDj),(b=this.Lh.jb.gu)&&b.Vi&&b.HZn(this.QDj),this.Aod=!1)}else u&&(this.PDj(h,!1),this.nEj(!1))}}nEj(b){const h=this.Lh.jb.gu;h&&(b?this.VAe.add(h.ed.Bl):this.VAe.remove(h.ed.Bl))}static get Zb(){return null!=aE.Exg?aE.Exg:aE.Exg=Ga.a.instance.Oa("Box4.IFeatureHelper")}}
Object(m.a)(aE,"FormatPainterActor",null,[]);class hA{constructor(b,h,u){this.Zm=u}Tvl(b,h,u,B,Q){var ca;if(!({ie:u,selected:ca,xy:rb,jWc:Qa}=this.apj(h,u,!1)).returnValue)return rb;Gj.a.mark(5013);var qa=hA.Xg.tO(ca);for(let Lb=0;Lb<qa.length;++Lb){if(!qa[Lb].isValid)continue;const Yb=qa[Lb].iterator;Yb.gp();if(Rj.OutlineReader.ix(Yb))return this.AWh(u,Yb)}var Qa=In.a.eHd&&Qa?Ob.a.nUc:this.UUl();if(ca.gx||Ge.SelectionEditor.nl(ca)||me.ParagraphReader.nm(ca)&&!Ge.SelectionEditor.l9(ca)){if(hA.Zb&&
hA.Zb.isFeatureEnabled(26)&&On.ContextSetEditor.instance.ygg(ca).returnValue)return 8;var rb=this.BWh(h,u,b,B,Q,Qa)}else if(Ge.SelectionEditor.Fk(ca))rb=this.zWh(h,u,b,B,Q,Qa);else if(Ge.SelectionEditor.ef(ca)){rb=new vd.GraphIterator;rb.set(ca.node);rb.zb(10);qa=ok.a.EA(ca,!1);if(0<qa.length){if(!qa[0].hyperlink)return r.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",qa[0].cpBegin,qa[0].cpEnd),8;Fb.App.Phb(qa[0].hyperlink.url);return 32}Jf.TableCellReader.F0(rb)&&
(qg.returnToContainingCell(rb),Jf.TableCellReader.dia(rb)&&(qa=new vd.GraphIterator,qa.jd(rb),qg.returnToContainingRow(qa),Rj.OutlineReader.JA(rb,ca,!1)&&Im.a.Hwi(qa)&&0>=ca.Fb&&(Qa=Ob.a.rUc,qg.returnToContainingTable(rb),gf.OutlineElementNavigator.Wd(rb),Q||(Q=new Od.DictionaryPropertySet),Q.Dg($c.a.targetObject,rb.currentNode.id))));rb=this.CWh(h,u,b,B,Q,Qa)}else Ge.SelectionEditor.l9(ca)&&(rb=v.AFrameworkApplication.va.Kf(h,Ob.a.newLine,2,!1,B,Q));Gj.a.mark(5014);return rb}apj(b,h,u){let B=null,
Q=null,ca=!1;if(1===h)return{returnValue:!1,ie:B,selected:Q,xy:32,jWc:ca};if(!b.view.qe)return{returnValue:!1,ie:B,selected:Q,xy:2,jWc:ca};B=b.view;Q=B.mb.ng;return!Q||!hA.Uf.mwi(Q,u)||In.a.eHd&&hA.Uf.hia(Q,qa=>ca=qa)&&!ca?{returnValue:!1,ie:B,selected:Q,xy:2,jWc:ca}:this.Zm&&this.Zm.instance&&this.Zm.instance.EU(Q)?{returnValue:!1,ie:B,selected:Q,xy:4,jWc:ca}:{returnValue:!0,ie:B,selected:Q,xy:2,jWc:ca}}xoo(b,h,u,B,Q){let ca,qa;if(!({ie:u,selected:ca,xy:qa}=this.apj(h,u,!0)).returnValue)return qa;
const Qa=hA.Xg.tO(ca);for(let rb=0;rb<Qa.length;++rb){if(!Qa[rb].isValid)continue;const Lb=Qa[rb].iterator;Lb.gp();if(Rj.OutlineReader.ix(Lb))return this.AWh(u,Lb)}ca.gx||Ge.SelectionEditor.nl(ca)?qa=this.BWh(h,u,b,B,Q,Ob.a.nUc):Ge.SelectionEditor.Fk(ca)?qa=this.zWh(h,u,b,B,Q,Ob.a.nUc):Ge.SelectionEditor.ef(ca)?qa=this.CWh(h,u,b,B,Q,Ob.a.nUc):Ge.SelectionEditor.l9(ca)&&(qa=v.AFrameworkApplication.va.Kf(h,Ob.a.newLine,2,!1,B,Q));return qa}AWh(b,h){b.mb.Bc(Cg.SelectionFactory.oo(h.currentNode,!1));
return 32}BWh(b,h,u,B,Q,ca){const qa=new Qg.GraphTransaction(15);qa.Qj=u;qa.Db(h.ed);h=new Od.DictionaryPropertySet;h.setValue($c.a.zLc,!0);h=v.AFrameworkApplication.va.Kf(b,Ob.a.HH,2,!0,B,h);32===h&&(h=v.AFrameworkApplication.va.Kf(b,ca,2,!1,B,Q));qa.dispose();return h}zWh(b,h,u,B,Q,ca){const qa=new Qg.GraphTransaction(15);qa.Qj=u;qa.Db(h.ed);h.mb.Bc(Ge.SelectionEditor.Fj(h.mb.hb.J(0),!1,!1));b=v.AFrameworkApplication.va.Kf(b,ca,2,!1,B,Q);qa.dispose();return b}CWh(b,h,u,B,Q,ca){const qa=new Qg.GraphTransaction(15,
u);qa.Qj=u;qa.Db(h.ed);b=v.AFrameworkApplication.va.Kf(b,ca,2,!1,B,Q);qa.dispose();return b}static get Xg(){return On.ContextSetEditor.instance}static get Uf(){return ti.a.instance}static get Zb(){return null!=hA.Axg?hA.Axg:hA.Axg=Ga.a.instance.Oa("Box4.IFeatureHelper")}}Object(m.a)(hA,"AEnterViewStrategy",null,[1359]);class vJ extends hA{constructor(b,h,u){super(b,h,u)}UUl(){return Ob.a.newLine}}Object(m.a)(vJ,"EnterViewStrategy",hA,[]);class mH{constructor(b){this.pl=this.transaction=null;this.ie=
b;this.gJc=this.xo=0}}Object(m.a)(mH,"SelectAllArguments",null,[]);class ZC{constructor(b,h,u){this.twn=b;this.RYm=h;this.Zs=u;this.Hxl=(B,Q,ca)=>Q.view.Vi?this.rhb(Q,ca,this.Itj):this.K$n(Q,ca);this.L3c=(B,Q)=>Q.xo?1===Q.xo?(Q.ie.mb.T8c(Q.pl,B),Q.xo=2,!0):2===Q.xo?(Q.ie.mb.hb.w0a=Q.pl.w0a,this.Qg.nF(),Q.transaction.iIa(B),Q.xo=3,Q.transaction.dispose(),Gj.a.mark(5799),!0):!1:(Q.transaction=this.Zs.Pc(2),Q.transaction.Db(Q.ie.ed),Q.xo=1,!0);this.K$n=(B,Q)=>{if(1===Q)return 32;if(!B.view.qe)return 2;
B=B.view;return B.mb&&B.mb.hb&&B.mb.hb.lb?this.Itj(B).inProgress?1:32:8};this.Itj=B=>{v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");B.Vi&&r.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");B=new Yt.a(null,this.YGn,new mH(B));B.Ml("SelectAllInOutline");B.run();return B};this.YGn=(B,Q)=>{if(!Q.xo)return Q.pl=Cg.SelectionFactory.L$n(Q.ie.mb.hb.lb),Q.transaction=this.Zs.Pc(2),Q.transaction.Db(Q.ie.ed),Q.xo=1,!0;if(1===Q.xo){if(!Q.gJc)return Q.ie.mb.Bc(Q.pl.J(0),
B),++Q.gJc,!0;if(Q.gJc<Q.pl.length)return Q.ie.mb.ftk(Q.pl.J(Q.gJc),B),++Q.gJc,!0;Q.xo=2}return 2===Q.xo?(Q.ie.mb.hb.w0a=Q.pl.w0a,this.Qg.nF(),Q.transaction.iIa(B),Q.xo=3,Q.transaction.dispose(),!0):!1}}get Qg(){return this.RYm.value}Tb(){const b=v.AFrameworkApplication.va;b.ra(Ob.a.tza,Ad.a.frame,ZC.$pj);b.ra(Ob.a.ieg,Ad.a.frame,ZC.$pj);b.fb(Ob.a.rhb,vc.a.view,this.Hxl,2);b.fb(Ob.a.TCa,vc.a.view,$d.AFrame.Gg,100);b.fb(Ob.a.ZOf,vc.a.view,ZC.ZOf,4)}rhb(b,h,u){if(1===h)return 32;if(!b.view.qe)return 2;
h=b.view;if(!h.mb)return 8;const B=h.mb.hb;if(!B||!B.length)return 8;Gj.a.mark(5798);Fb.App.za.jb.isEditingAllowed||Fb.App.za.jb.Ky||h.Vi?b=Ge.SelectionEditor.wrf(B):(hd.FocusManager.instance().iD($d.AFrame.Un),b=Cg.SelectionFactory.vgj(h.ed));if(!b)return 8;B.w0a||r.ULS.sendTraceTag(39098305,324,50,"Progress selection start");u&&this.twn.cJb(Ge.SelectionEditor.U6h(b))?u=u(h):(u=new mH(h),u.pl=b,u=new Yt.a(null,this.L3c,u),u.Ml("ExpandSelection"),u.run());return u.inProgress?1:32}static get l7a(){return null!=
ZC.cFg?ZC.cFg:ZC.cFg=Ga.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static ZOf(b,h,u){if(1===u)return 32;if(!h.view.qe)return 8;b=h.view;h=Cg.SelectionFactory.oo(b.root.graphNode,!0);if(!h)return 8;b.mb.Bc(h);return 32}static $pj(){var b=Fb.App.za.jb.gu;if(!b.qe)return 2;if(b.qe&&1!==Fb.App.za.state){Gj.a.mark(4668);var h=b.mb.hb.lb;if(!h&&v.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Ge.SelectionEditor.lX(h);let u=h.x,B=h.y+h.height;if(!b.container)return 8;
b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)u=b.x,B=b.y;ZC.l7a.tza(new Sys.UI.Point(u,B),1);Gj.a.mark(4669)}return 32}}Object(m.a)(ZC,"SelectAllHandlers",null,[1179]);class wJ{Tfe(){}}Object(m.a)(wJ,"FontNameFormattingStrategyNoop",null,[1325]);var xJ=c(873);class vG{constructor(b,h,u,B,Q,ca){this.fwh=this.iwh=null;this.es=b;this.ewh=h;this.wJk=u;this.FJk=B;this.iwh=Q;this.fwh=ca}}Object(m.a)(vG,"BookmarkHighlightContext",null,[]);class yJ extends wf.a{constructor(){super()}get Aca(){return!0}get Djb(){return 5}get a3a(){if(null!=
this.V2)return this.V2;this.V2=[];this.V2.push(new rg.a(Fo.a.lDd,Fo.a.lDd));this.V2.push(new rg.a(Fo.a.w3e,Fo.a.w3e));this.V2.push(new rg.a(Fo.a.HGc,Fo.a.HGc));return this.V2}jHa(b,h){this.Aca&&nr.a.instance.ge(()=>{const u=this.zr.VDa;var B=this.zr.DYc;if(u)if(5===u.type){B=u.GA;if(u.SJ&&u.SJ.es.includes(b))for(const Q of h.FHa("*"))this.zr.gTa(Q);B&&B.es.includes(b)&&this.tpb(h,u.action,B,b)}else B&&5===B.type&&3===u.action&&B.GA.es.includes(b)&&this.tpb(h,0,B.GA,b)},"BHA:OPHC")}lRa(b){return Object(Cb.a)(vG,
b)}v2a(b,h){if(b)for(const u of b.es)h.add(u)}tpb(b,h,u,B){0===h&&b.htmlElement&&nr.a.instance.ge(()=>{const Q=b.FHa("*"),ca=Q.length,qa=Fo.a.lDd;var Qa=B.id===u.iwh,rb=B.id===u.fwh;let Lb=!1;var Yb=0,gc=[];const Fc=Array(ca);for(let Hd=0;Hd<ca;Hd++){var Sc=Q[Hd];const Ie=Ye.a(Sc);Fc[Hd]=Ie;const fe=Sc.classList;if(0!=Fc[Hd]){const de=!fe.contains(Fo.a.yG),ne=ed.a.Eb(Sc,Fo.a.$Ab);ne&&gc.push(...ne);if(Qa){let ye;if((ye=ed.a.Eb(Sc,Fo.a.nDd))&&ne&&1===ye.length&&1===ne.length&&ye[0].equals(ne[0]))continue;
ye&&(Yb+=ye.length,1===Ie?fe.add(Fo.a.w3e):fe.add(qa));if(ne)for(const Vf of ne)this.kYd(u,Vf)&&(Yb--,Lb&&fe.add(Fo.a.HGc));0!==Yb&&de&&fe.add(qa)}if(!Qa&&!rb&&u.FJk.has(B.id))if((Sc=ed.a.Eb(Sc,Fo.a.$Ab))&&Lb){fe.add(qa);for(const ye of Sc)if(this.kYd(u,ye)){fe.add(Fo.a.HGc);break}}else de&&fe.add(qa)}Lb=!fe.contains(Fo.a.c1a)}if(rb&&!Qa){Qa=new Set;for(var ld of gc)this.kYd(u,ld)&&Qa.add(ld);Lb=!1;for(gc=0;0!==Qa.size&&gc<ca;gc++){Yb=Q[gc];ld=Yb.classList;if(0!=Fc[gc])if(rb=!1,Yb=ed.a.Eb(Yb,Fo.a.$Ab)){for(const Hd of Yb)this.kYd(u,
Hd)&&(Qa.delete(Hd),rb=!0);0!==Qa.size&&ld.add(qa);Lb&&rb&&ld.add(Fo.a.HGc)}else ld.contains(Fo.a.yG)||ld.add(qa);Lb=!ld.contains(Fo.a.c1a)}}},"BHA:SPH")}kYd(b,h){for(const u of b.wJk)if(h.equals(u))return!0;return!1}}Object(m.a)(yJ,"BookmarkHighlightActor",wf.a,[577]);var wG=c(1877),zJ=c(1659);class xG{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){var Yb;this.uui=!1;this.Wf=b;this.iA=h;this.gb=Q;this.TV=ca;this.Rj=qa;this.he=Qa;this.od=Lb;this.Ga=rb;this.uui=null!==(Yb=null===rb||void 0===rb?void 0:rb.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",
!1))&&void 0!==Yb?Yb:!1}Kag(b,h,u,B){const Q=b.Klh(h);if(Q){var ca=Object(Cb.a)(zJ.a,b),qa=this.he.Vf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,u)),Qa=h.ek.node,rb=()=>{u||this.removeImage(h.ek,Q.getId())};ca=xG.xxh();B=this.Uxh(Q.getId().toString(),Qa,B,u);try{b.ash(B,h)}catch(Lb){r.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+
Lb.message);this.zp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Wf.sj(ca,2,B.toString(),{},!0,0,Lb=>{r.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.xgc(Lb,Q,()=>{this.zp(b.gTd())},rb,Qa,h,qa)},Lb=>{const Yb=415===Lb.data.Qe;let gc="";Lb&&Lb.data&&Lb.data.Aj&&"X-CorrelationId"in Lb.data.Aj&&Lb.data.Aj["X-CorrelationId"]&&(gc=Lb.data.Aj["X-CorrelationId"]);b.lqa(`Graphics editor request failed. HttpStatus [${Lb.data.Qe}], ResponseData [${Lb.data.se}], CorrelationId [${gc}]`,
Q,Qa,rb,()=>{this.zp(Yb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.gTd())},qa,Yb)},null)}else this.zp(b.gTd())}qbo(b,h,u){return new Promise((B,Q)=>{var ca=b.ek,qa=null;qa=this.uui&&Kf.a.aFf(ca)?ca.getContext(0).node:ca.node;ca=xG.xxh();qa=this.Uxh(h.toString(),qa,u,!1);qa.ye(wG.a.Q9e,"2");this.Wf.sj(ca,2,qa.toString(),{},!0,0,Qa=>{r.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");B(Qa.data.se)},
Qa=>{r.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Qa.data.Qe}, ResponseData ${Qa.data.se}`);this.zp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);Q(null)},null)})}Uxh(b,h,u,B){const Q=h.Ui(),ca=new bb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.aga(ca);ca.ye(wG.a.strict,this.qMm(h)?"true":"false");ca.ye(fj.a.nodeId,b);ca.ye(fj.a.cellId,Q.Am.toString());ca.ye(fj.a.fileId,
Q.vr);ca.ye(fj.a.yX,u.toString());ca.ye(wG.a.qxl,B?"true":"false");if(b=!!this.od&&this.od.isFeatureEnabled(51)){ca.ye(fh.a.z0i,b.toString());if(b=this.od.isFeatureEnabled(91))ca.ye(fh.a.GAn,b.toString()),ca.ye(fh.a.wum,"true");this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ca.ye(fh.a.PAn,"true")}ca.ye(fh.a.qvh,"true");ui.a.instance.rAb(ca);return ca}qMm(b){if(!this.iA)return!1;b=this.iA.ru(b);return!!b&&b.rf(Jc.a.MGf)}removeImage(b,h){b.cpBegin===b.cpEnd-1&&
this.Rj.Hic(b.node,h,this.gb,this.TV)}zp(b){const h=new mg.StandardDialog;h.Cd=0;h.rx(kl.a.Pff,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Fb.App.za.updateCommandUI()}static xxh(){const b=new bb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.aga(b);return b.toString()}}Object(m.a)(xG,"GraphicsEditorRequestManager",null,[574]);class AJ extends HD{constructor(b,h,u){super(b,h);this.vQa=
Ob.a.insertHyperlink;this.Y7j=u}s3a(b){null!=b&&0<b.length&&this.nc.Rb(this.vQa,2,b[0])}nLj(b,h,u){const B=Jj.a.qg(v.AFrameworkApplication.lcid).name;b=String.format(b,v.AFrameworkApplication.lcid,B,v.AFrameworkApplication.buildVersion,h,OC.bre,u);b+="&flipgrid=1&ted=1";this.Y7j&&(b+="&resize_picker=1");v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new bb.QueryStringBuilder(b),b.WI("stream2","1"),v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&
b.WI("enablegetcustomheader","1"),b=b.toString());return b}}Object(m.a)(AJ,"InsertHubbleMediaHelper",HD,[]);class BJ{constructor(b,h,u,B,Q,ca,qa){this.ga=b;this.Ga=h;this.$md=u;this.a3=B;this.hkd=Q;this.Ik=ca;this.cVj=qa}Tb(){this.ga.fb(Qc.a.fYi,vc.a.Tc,this.Jun.bind(this),1028);this.ga.fb(Qc.a.ori,vc.a.Tc,this.RBm.bind(this),1028)}RBm(b,h,u,B,Q){if(1!==u){if(null==Q)return 16;if(!h.Vk||!Ge.SelectionEditor.ef(h))return 2;b=this.IUl(Q);Q=Q.OriginalUrl;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.hkd.Hsg(b,h,Q)}return 32}PQj(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}IUl(b){const h=new hD;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}Jun(b,h,u){var B,
Q;if(1!==u)h=F.a.NQ(this.Ga.kb("UserId")).toString(),h=this.a3.nLj(this.Ga.appSettings.InsertVideoHubbleEndpoint,yb.a.create().toString(),h),this.a3.vQa=Qc.a.ori,h=this.$md.dQc(h,!0),h.correlationId=yb.a.create(),h.$pa=5,h.gie(null,this.a3,this.cVj),ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ha.a,{name:"ActionId",int64:b})]})),this.PQj();else if(!(h&&h.node&&DD.a(h.node))||(null===(B=this.Ik)||void 0===B?0:B.R_(h))||(null===
(Q=this.Ik)||void 0===Q?0:Q.hia(h)))return 2;return 32}}Object(m.a)(BJ,"OnlineMediaActor",null,[]);const DM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};
class $C extends FD{constructor(b,h,u,B=null,Q=!1){super(b,h,u,B,Q);this.Avc=null;this.lVf=()=>{this.kz&&(r.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!$C.uCa} time: ${(new Date).getTime()-this.fi}`),this.kz.sendMessage(L.a.ojj,{["CustomHeaders"]:$C.uCa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}dFb(){const b={};b.insertMediaServiceEndpoint=this.bnd;b.iFrameId="mediaiframe";return b}async gie(b,h,u){u&&(this.fi=(new Date).getTime(),
Date.now()>$C.cih&&await this.refreshToken(u));this.FVb=b;this.Avc=h;this.wuc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.dFb(),["componentIsVisibleCallback"]:this.$Oj.bind(this)};this.Qh(this.FVb,null,b)}$Oj(){this.R0=this.a9b(this.mj("mediaiframe"));let b=this.bnd;if(v.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),u=DM[h.protocol+"//"+h.host];u?b=u:r.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.kz=this.dtd.getInstance(this.R0.contentWindow,
b);this.kz.Fq(L.a.rnh,h=>{this.LRi(h,this.Avc.s3a.bind(this.Avc))});this.kz.Fq(L.a.insert,h=>{this.O6d(h,this.Avc.s3a.bind(this.Avc))});this.kz.Fq(L.a.X6h,this.lVf.bind(this));this.kz.Fq(L.a.getSessionId,this.MTi.bind(this));this.kz.Fq(L.a.G4h,this.JTi.bind(this));this.kz.Fq(L.a.hEd,this.vSi.bind(this));this.gpb(3)}gpb(b){const h=[];h.push(Object.assign(new ha.a,{name:"DialogResult",string:jD[b]}));h.push(Object.assign(new ha.a,{name:"DialogMode",string:this.Tai()}));h.push(Object.assign(new ha.a,
{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ha.a,{name:"Provider",string:dC[this.$pa]||"Unknown"}));ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.EV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&($C.cih=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,$C.uCa=h.Token);r.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!$C.uCa} time: ${(new Date).getTime()-
this.fi}`)}catch(h){r.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.fi} error: ${h} `)}}}$C.cih=0;Object(m.a)($C,"OnlineMediaDialog",FD,[]);class CJ{constructor(b,h){this.aEe=b;this.a3=h}dQc(b,h=!1){return new $C(b,this.aEe,this.a3,null,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(CJ,"OnlineMediaDialogFactory",null,[575]);class DJ extends Gv{constructor(){super(1,3);this.YL=Ga.a.instance.resolve("Common.IReactContextualUILauncher");
this.Zwj=!1}M7a(){v.AFrameworkApplication.va.processAction(Qc.a.nlc,2)}XLd(){this.U_h&&!this.Av&&(this.Av=this.dLa())}LMd(){if(this.Av&&this.Av.isVisible){var b=Object(Na.a)(qo.Control,this.Av.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.ax(b.wib(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)r.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();
0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(af.a.CCd)||"",af.a.uM===h&&b.click())}}C0(){return this.YL.C0}}Object(m.a)(DJ,"ExternalContentFloatieManager",Gv,[]);class os{constructor(){os.szm()}get uc(){return null!=this.tIg?this.tIg:this.tIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Xw(){return null}Hnc(b){var h=null;if(!me.ParagraphReader.kh(b))return{returnValue:!1,nna:h};if((b=this.uc.Ro(b.currentNode))&&2===this.uc.GG(b)){const u=
this.uc.wg(b);os.DQ.contains(u)&&(h=this.uc.qR(b),h=Object.assign(new Gy.a,{TG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,nna:h}}sFb(b,h){let u=null;h&&b.contentId.equals(h.contentId)||(u=b.contentObject);return u}static szm(){os.DQ=new fp.a;os.DQ.add(Yj.StyleReader.styleIdHeading1);os.DQ.add(Yj.StyleReader.styleIdHeading2);os.DQ.add(Yj.StyleReader.styleIdHeading3);os.DQ.add(Yj.StyleReader.UQb);os.DQ.add(Yj.StyleReader.Y$c);os.DQ.add(Yj.StyleReader.Z$c);os.DQ.add(Yj.StyleReader.Jje);
os.DQ.add(Yj.StyleReader.Ije);os.DQ.add(Yj.StyleReader.wordStyleIdHeading1);os.DQ.add(Yj.StyleReader.wordStyleIdHeading2);os.DQ.add(Yj.StyleReader.wordStyleIdHeading3);os.DQ.add(Yj.StyleReader.bTb);os.DQ.add(Yj.StyleReader.cTb);os.DQ.add(Yj.StyleReader.dTb);os.DQ.add(Yj.StyleReader.Roc);os.DQ.add(Yj.StyleReader.Soc);os.DQ.add(Yj.StyleReader.eTb);os.DQ.add(Yj.StyleReader.Lrb);os.DQ.add(Yj.StyleReader.Odd)}}os.DQ=null;Object(m.a)(os,"ParagraphStyleDetailsProvider",null,[534,336]);class EJ{constructor(b,
h,u,B){this.iLa=b;this.O8j=h;this.X8j=u;this.Y8j=B}B5f(){this.iLa.execute(b=>{b.Bic(this.O8j.value);b.Bic(new os);b.Bic(this.Y8j.value);b.t5(this.X8j.value)})}}Object(m.a)(EJ,"AccessibilityActor",null,[]);class FJ{constructor(b,h,u){this.Yh=null;this.R9c=(B,Q,ca)=>{if(1===ca)return 32;this.Yh=this.qtc.value.W6k(this.Vb);if(!this.Yh)return r.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.Yh.fUa();return 32};this.rlh=B=>this.Yh?this.Yh.Aom(B):2;this.ga=b;this.qtc=
h;this.Vb=u}Tb(){if(v.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Nb.KeyInputManager.ic(Se.a.Yrb,5);this.Vb.ae($d.AFrame.Un).kr(b);this.Vb.ae($d.AFrame.xp).bindAction(b,Za.a.R9c);this.ga.ra(Za.a.R9c,Ad.a.frame,this.R9c);this.ga.ra(Za.a.LEc,Ad.a.frame,this.rlh);this.ga.ra(Za.a.KEc,Ad.a.frame,this.rlh)}}}Object(m.a)(FJ,"AccessibilityHelpDialogActor",null,[]);var EM=c(1055),FM=c(1409);class GJ{constructor(b,h){this.D3j=b.lc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.WSj=
EM.a.hF(26,5,new FM.a)}WY(){this.ga.WY(this)}f5(){}d5(b){const h=+b.endTime-+b.startTime;if(h>this.D3j){let u="";switch(b.behavior){case 1:u="E";break;case 2:u="X";break;case 3:u="A"}(b=dd.ActionManager.mba(b.actionId))&&b.length||(b="UnknownAction");this.WSj.track(h,b+"_"+u)}}}Object(m.a)(GJ,"ActionHangDetector",null,[27]);var HJ=c(1492);class IJ extends Te{constructor(b,h=null){super(b,void 0,v.AFrameworkApplication.L0a,new Sf(b,!1),void 0,void 0,h)}get l5a(){return this.KYd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:
this.WYd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get sec(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get lZc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get iKc(){return v.AFrameworkApplication.L0a?"UIFontDialogTextLarge":null}get KYd(){return"VersionHistory"===this.l5e?!1:1===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",
0)}get WYd(){return"VersionHistory"===this.l5e?!1:2===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}q2d(){r.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");v.AFrameworkApplication.zia("t1shrdnl;t2shrdnl;c-shrdnl")}ILf(){r.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}HZc(){r.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");v.AFrameworkApplication.va.processAction(Za.a.wTh,2)}}
Object(m.a)(IJ,"DownloadACopyDialog",Te,[]);var yG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(yG||(yG={}));Object(m.b)("OfficeApplication",yG);var IF;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";
b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(IF||(IF={}));Object(m.b)("OpenDocumentMode",IF);class JJ extends Hf.a{constructor(){super(!1,!1,!0)}wMb(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};
h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Qh("Send feedback to Microsoft",this.$io.bind(this),b);return new Promise(u=>{this.oLe=u})}$io(b,
h){1===b&&this.aK(h.selectedReason)}dispose(){super.dispose();this.oLe()}aK(b){const h={},u={},B={},Q={},ca={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=yb.a.create().toString();ca.reason=b;const qa={},Qa={numberOfOptions:5};Qa.selectedRating=b;qa.rating=[Qa];Q.surveySpecificData=JSON.stringify(qa);B.extendedManifestData=JSON.stringify(Q);h.application=B;ca.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ca;
h.telemetry=this.x_a();h.web=this.kBb();u["Content-Type"]="application/json";this.nja(JSON.stringify(h),u)}rM(b,h,u,B){h&&b&&B&&u&&B in h&&(b[u]=h[B])}x_a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.rM(h,b,"audienceGroup","AudienceGroup");this.rM(h,b,"osBuild","OsVersion");this.rM(h,b,"platform","Platform");this.rM(h,b,"processSessionId","WACSessionID");return h}kBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,
h={};this.rM(h,b,"browser","Browser");this.rM(h,b,"browserVersion","BrowserVersion");this.rM(h,b,"dataCenter","WACDatacenter");return h}nja(b,h,u=0){let B=0;3<u||(1===u?B=200:1<u&&(B=200+500*(u-1)),v.AFrameworkApplication.oc.Xb(new bf.a(2,1,B,()=>{v.AFrameworkApplication.He.sj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{r.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.nja(b,h,u+1);r.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",
u)},null)})))}}Object(m.a)(JJ,"WordOpenInClientFeedbackDialog",Hf.a,[]);var KJ=c(1774);const NE=b=>{for(let h=0;h<b.children.length;h++){const u=b.children[h];u.style.position="relative";u.style.top=(u.parentNode.offsetHeight-u.offsetHeight)/2+"px"}},zG=b=>b.Hb.keyCode===Se.a.Ls||b.Hb.keyCode===Se.a.zJa?(b.uf.click(),!0):!1,JF=(b,h,u,B,Q,ca,qa)=>{const Qa=document.createElement("a");Qa.className="ProtocolLaunchingDialogButtonAnchor";Qa.className+=" OICDialog";Qa.id=b;Qa.setAttribute(af.a.oh,af.a.L3);
Qa.style.padding="0";Qa.style.margin="0";B&&LJ(Q,h,u,B,Qa);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=Q;Qa.appendChild(b);Qa.tabIndex=0;ca&&Wi.a.instance.ob(Kd.a.click,Qa,ca);qa&&Nb.KeyInputManager.instance.ob(Kd.a.sh,Qa,qa);return Qa},LJ=(b,h,u,B,Q)=>{var ca=document.createElement("img");ca.alt=b;ca.className=ze.getImageClassWithCluster(u,B);ca.src=h;ca.setAttribute(af.a.oh,af.a.rz);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";
b.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(b);Q.appendChild(ca)};class AG{static get Yg(){return Hf.a.Bz(AG.Sm,CommonUIStrings.l_OICLaunchDialogTitle)}}AG.Sm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(AG,"OICLaunchDialogHtml",null,[]);class MJ extends Hf.a{constructor(b){super();this.nUb=this.Ksb=null;this.KS=!1;this.Hp=b;this.Yg=AG.Yg;this.Cd=5;this.ug="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.yhn,"oicLaunchDialogResultHandler"));this.ukj();this.C5("ProtocolLaunchingDialogTitle");4!==v.AFrameworkApplication.ua.Lb.JOa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.u1(this.Ksb);r.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}L9(){this.Ksb=JF("BtnRichClient",this.Hp.wLc,this.Hp.ETc,this.Hp.uzf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.iWi,"onRichClientButtonClick"),zG);document.getElementById("OICLaunchRichClient").appendChild(this.Ksb);NE(this.Ksb);this.nUb=JF("BtnReturn",this.Hp.wLc,this.Hp.ETc,this.Hp.Voi,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.cWi,"onReturnButtonClick"),
zG);document.getElementById("OICReturnToApp").appendChild(this.nUb);NE(this.nUb)}cWi(){this.hide();this.Hp.bjc();return!0}iWi(){r.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();v.AFrameworkApplication.va.processAction(Za.a.TOb,2);return!0}yhn(){this.Hp.bjc()}dispose(){this.KS||(this.Ksb&&(Wi.a.instance.sc(Kd.a.click,this.Ksb,Object(z.a)(this,this.iWi,"onRichClientButtonClick")),Nb.KeyInputManager.instance.sc(Kd.a.sh,this.Ksb,zG)),this.nUb&&(Wi.a.instance.sc(Kd.a.click,
this.nUb,Object(z.a)(this,this.cWi,"onReturnButtonClick")),Nb.KeyInputManager.instance.sc(Kd.a.sh,this.nUb,zG)),super.dispose(),this.KS=!0)}}Object(m.a)(MJ,"OICLaunchDialog",Hf.a,[]);class BG{static get Yg(){return Hf.a.Bz(BG.Sm,CommonUIStrings.l_OICDialogTitle)}}BG.Sm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(BG,"ProtocolLaunchingDialogV2Html",null,[]);class NJ extends Hf.a{constructor(b){super();this.mUb=this.NVa=null;this.KS=!1;this.h$a=null;this.Hp=b;this.Yg=BG.Yg;this.Cd=5;this.ug="ProtocolLaunchingDialog";this.Osc="OICRetryDialog";v.AFrameworkApplication.oc.iHb&&v.AFrameworkApplication.oc.restart();v.AFrameworkApplication.oc.Xb(new bf.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.z2f,"protocolLaunchingDialogResultHandler"));this.ukj();this.C5("Issues");
this.l0h();r.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}L9(){const b=document.getElementById("Issues");if(b){LJ("",this.Hp.wLc,this.Hp.ETc,this.Hp.uzf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Hp.TXi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);NE(b);b.style.display="none"}v.AFrameworkApplication.ua.Lb.xji?
(this.mUb=JF("GiveFeedback",this.Hp.wLc,this.Hp.ETc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.A6d,"onGiveFeedbackClick"),Object(z.a)(this,this.OTi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.mUb),NE(this.mUb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===v.AFrameworkApplication.ua.Lb.JOa||v.AFrameworkApplication.tml?document.getElementById("ButtonEdit").style.display="none":(this.NVa=
JF("Edit",this.Hp.wLc,this.Hp.ETc,"",2===v.AFrameworkApplication.ua.Lb.Nk?4===v.AFrameworkApplication.ua.Lb.JOa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===v.AFrameworkApplication.ua.Lb.JOa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.pTi,"onEditClick"),Object(z.a)(this,this.sTi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.NVa),NE(this.NVa));0===v.AFrameworkApplication.ua.Lb.JOa&&
!v.AFrameworkApplication.mFf&&b&&(b.style.display="none")}m0h(){return this.h$a?(this.u1(this.h$a),!0):!1}l0h(){return this.NVa?(this.u1(this.NVa),!0):!1}sTi(b){return this.kUf(b,0)}OTi(b){return this.kUf(b,2)}bWi(b){return this.kUf(b,1)}kUf(b,h){let u=!1;if(b.Hb.keyCode===Se.a.Ls||b.Hb.keyCode===Se.a.zJa)b.uf.click(),u=!0;else if(b.Hb.keyCode===Sys.UI.Key.down||b.Hb.keyCode===Sys.UI.Key.up)switch(h){case 1:u=this.l0h();break;case 0:u=this.m0h()}return u}pTi(){this.hide();4===v.AFrameworkApplication.ua.Lb.JOa?
(r.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Hp.bjc()):(r.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Hp.RRc());return!0}A6d(){r.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}VVf(){zE.Redirect.showHelp("OICFailure");return!0}y7d(){r.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";v.AFrameworkApplication.va.processAction(Za.a.TOb,2);return!0}z2f(){this.Hp.bjc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.h$a=JF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.y7d,"onRetryOICClick"),Object(z.a)(this,this.bWi,"onRetryOICKeyUp")),b.appendChild(this.h$a),NE(this.h$a),this.NVa||this.m0h())}}dispose(){this.KS||(this.NVa&&
(Wi.a.instance.sc(Kd.a.click,this.NVa,Object(z.a)(this,this.pTi,"onEditClick")),Nb.KeyInputManager.instance.sc(Kd.a.sh,this.NVa,Object(z.a)(this,this.sTi,"onEditKeyUp"))),this.mUb&&(Wi.a.instance.sc(Kd.a.click,this.mUb,Object(z.a)(this,this.A6d,"onGiveFeedbackClick")),Nb.KeyInputManager.instance.sc(Kd.a.sh,this.mUb,Object(z.a)(this,this.OTi,"onGiveFeedbackKeyUp"))),this.h$a&&(Wi.a.instance.sc(Kd.a.click,this.h$a,Object(z.a)(this,this.y7d,"onRetryOICClick")),Nb.KeyInputManager.instance.sc(Kd.a.sh,
this.h$a,Object(z.a)(this,this.bWi,"onRetryOICKeyUp"))),super.dispose(),this.KS=!0)}}Object(m.a)(NJ,"ProtocolLaunchingDialog",Hf.a,[]);class CG extends mg.StandardDialog{constructor(b){super();this.Hp=b;this.ug="ProtocolLaunchingDialog";v.AFrameworkApplication.oc.iHb&&v.AFrameworkApplication.oc.restart();v.AFrameworkApplication.ua.Lb.xji&&this.Jqk(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.A6d,"onGiveFeedbackClick"));CG.Bli?(this.Cd=12,this.xe(1,CommonUIStrings.l_CloseFile),
this.xe(2,CommonUIStrings.l_OICDialogContinueHere),this.xe(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Cd=4,this.xe(1,CommonUIStrings.l_OICDialogContinueHere),this.xe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.pmb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Hp.TXi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.z2f,"protocolLaunchingDialogResultHandler"),null)}A6d(b){r.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.yTi(b)}y7d(){r.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");v.AFrameworkApplication.va.processAction(Za.a.TOb,2)}z2f(b){CG.Bli?3===b?this.sdj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.sdj():(1===b||0===b)&&this.continueEditing()}closeDocument(){r.ULS.sendTraceTag(577783557,211,50,"Closing the document");v.AFrameworkApplication.va.Rb(Za.a.close,2,sh.a)}sdj(){r.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.y7d,
"onRetryOICClick"),0)}continueEditing(){4===v.AFrameworkApplication.ua.Lb.JOa||v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===v.AFrameworkApplication.ua.mode?(r.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Hp.bjc()):(r.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Hp.RRc())}static get Bli(){return v.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===v.AFrameworkApplication.va.processAction(Za.a.close,
1)}}Object(m.a)(CG,"StandardProtocolLaunchingDialog",mg.StandardDialog,[]);class OJ{}Object(m.a)(OJ,"EditDocumentInClientParams",null,[]);class nH{static $Th(b,h,u,B,Q,ca,qa=!1,Qa=!1,rb="",Lb=!1,Yb=!1,gc=!1,Fc="",Sc="",ld="",Hd=!1,Ie=""){const fe=new OJ;fe.DocumentUrl=b;fe.DocumentExtension=Ie;fe.Mode=h;fe.Options=u;fe.Application=B;fe.SilentExternalHandler=qa;fe.EncodeUrl=Qa;fe.CorrelationIdForWinClient=rb;fe.NavigateUsingWindowOpen=Lb;fe.DescriptiveUnattemptedEnums=Yb;fe.NoBrowserModalDialogs=gc;
fe.SessionOrigin=Fc;fe.CorrelationId=Sc;fe.ClickTime=ld;fe.NewTelemetryDataIsEnabled=Hd;MSOJS.ClientUtils.EditDocumentInClient(fe,Q,ca)}}Object(m.a)(nH,"ClientUtils",null,[]);var GM=c(545),PJ=c(952);class bE{constructor(b){this.nYa=this.Otc=this.Frc=null;this.Xuc=!1;this.uye=this.gJe=this.F7g=null;this.Sgd=this.gz=this.Mvd="";this.application=this.iz=0;this.oDo=this.Xig=!1;this.hZo=b&&v.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");v.AFrameworkApplication.va.e0(Za.a.TOb)||v.AFrameworkApplication.va.ra(Za.a.TOb,
Ad.a.frame,Object(z.a)(this,this.W5n,"retryOpenInClientAction"));this.Krj=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("SilentExternalHandler")}get TXi(){return this.iz}Rlo(b,h="",u=""){this.gz=u||yb.a.create().toString();this.Mvd=h||GM.a.Kbi();this.Sgd=b}W5n(b,h,u){return h.contextId!==Ad.a.frame?2:1===u?32:this.TOb()}get options(){let b=0;v.AFrameworkApplication.c3n&&(b|=1);v.AFrameworkApplication.ZXi&&(b|=4);this.hDo()&&(b|=64);return b}hDo(){return!(2===this.application&&v.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get wLc(){return v.AFrameworkApplication.$s}get ETc(){return v.AFrameworkApplication.Bca}get Voi(){return""}get uzf(){return""}get nDo(){return v.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get YGo(){return this.F7g||
(this.F7g=Ga.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.Xig||this.Lwl()}bjc(){this.oDo||this.wXh()}X5i(b){return this.hZo&&Z.a.ri?(new MJ(this),32):this.YFh(b)}YFh(b){const h=({$qb:b}=this.XXm(b)).returnValue;r.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Ac(b,h,u,B,Q,ca,qa=""){this.Frc=b;this.uye=qa;this.Otc=h;this.nYa=ca;this.application=u;this.iz=B;return v.AFrameworkApplication.DTh?(this.MEi(),32):v.AFrameworkApplication.Ppa&&
!v.AFrameworkApplication.zni?(v.AFrameworkApplication.ngg(),8):this.wvh(Q)}get xhn(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}TOb(){this.xhn&&this.A1m();return this.YFh(this.Xuc)}Hhj(){const b=new PJ.a(L.a.openInClient);b.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();b.Values[MC.a.DNh]=v.AFrameworkApplication.userSessionId;return this.nYa.value.send(b)?32:8}A1m(){xa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Ub.a,{inStaging:!0}))}ico(b){const h=new PJ.a(L.a.d1o);h.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();h.Values[MC.a.DNh]=v.AFrameworkApplication.userSessionId;h.Values[H.a.c1o]=b;this.nYa.value.send(h)}XXm(b){this.Xuc=b;this.ico(5===this.iz?bE.qun:bE.yun);return 5===this.iz?this.WXm():this.$Xm()}WXm(){this.WEi();return{returnValue:32,$qb:"HostEditUrl,"}}$Xm(){let b;var h=b="";v.AFrameworkApplication.moh&&(h="|f|"+v.AFrameworkApplication.userSessionId);
const u=v.AFrameworkApplication.K.$("IsAssignmentMode")&&v.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||v.AFrameworkApplication.SXc||Z.a.jRa,B=v.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),Q=v.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(v.AFrameworkApplication.va.Z4d){var ca=v.AFrameworkApplication.va.YX(3588168074);ca&&this.Rlo(ca.epochClickTime,ca.sessionOrigin,ca.correlationId);this.vJi()}if(v.AFrameworkApplication.D1i){b+="NewOrder,";
ca=8;this.nYa&&this.nYa.value&&this.nYa.value.isEnabled()&&v.AFrameworkApplication.FSb&&(b+="Post,",ca=this.Hhj());if(32===ca)return{returnValue:ca,$qb:b};r.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return v.AFrameworkApplication.Cs.S9?(r.ULS.shipAssertTag(5566816,211,!!v.AFrameworkApplication.Cs.S9),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ua.RU(!0,v.AFrameworkApplication.Cs.S9),$qb:b}):this.Frc?(r.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
v.AFrameworkApplication.userSessionId),b+="DocUrl,",nH.$Th(this.Frc,this.iz,this.options,this.application,Object(z.a)(this,this.rTi,"onEditInClientSuccess"),Object(z.a)(this,this.qTi,"onEditInClientFailure"),this.Krj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,u,B,Q,this.Mvd,this.gz,this.Sgd,v.AFrameworkApplication.va.Z4d,this.uye),{returnValue:32,$qb:b}):{returnValue:8,$qb:b}}b+="OldOrder,";if(!this.Frc&&v.AFrameworkApplication.Cs.S9)return this.nYa&&this.nYa.value&&this.nYa.value.isEnabled()&&
v.AFrameworkApplication.FSb?(b+="Post,",h=this.Hhj()):(r.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(r.ULS.shipAssertTag(22595484,211,!!v.AFrameworkApplication.Cs.S9),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ua.RU(!0,v.AFrameworkApplication.Cs.S9),$qb:b}):{returnValue:h,$qb:b};r.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",v.AFrameworkApplication.userSessionId);b+="DocUrl,";nH.$Th(this.Frc,
this.iz,this.options,this.application,Object(z.a)(this,this.rTi,"onEditInClientSuccess"),Object(z.a)(this,this.qTi,"onEditInClientFailure"),this.Krj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,u,B,Q,this.Mvd,this.gz,this.Sgd,v.AFrameworkApplication.va.Z4d,this.uye);return{returnValue:32,$qb:b}}g2n(b){v.AFrameworkApplication.Ql.setDw(8981,b)}rTi(b){this.g2n(b);r.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.nDo||this.WEi(),
this.vJi()):this.Xig||this.closeApplication()}qTi(b,h=0){r.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const u=!!this.Otc&&!this.Xuc;let B=0;1===b&&(B=2);6<=b&&13>=b&&(B=1,1===h&&(this.Xig=!0));this.YGo.jhn?(r.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",B),KJ.a.instance.Ral(this.Xuc?Object(z.a)(this,this.wRi,"oicErrorDialogHandlerCloseForced"):
Object(z.a)(this,this.xRi,"oicErrorDialogHandlerNoCloseForced"),u?Object(z.a)(this,this.qUi,"onLaunchDownload"):null,this.qRh(!1)?Object(z.a)(this,this.aum,"iHaveOfficeButtonHandler"):null,B,h)):(r.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",B),KJ.a.instance.Pal(this.Xuc?Object(z.a)(this,this.wRi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.xRi,"oicErrorDialogHandlerNoCloseForced"),u?Object(z.a)(this,this.qUi,"onLaunchDownload"):null,B))}}vJi(){try{const b=
[Object.assign(new ha.a,{name:"CorrelationId",string:this.gz}),Object.assign(new ha.a,{name:"SessionOrigin",string:this.Mvd}),Object.assign(new ha.a,{name:"ClickTime",string:this.Sgd}),Object.assign(new ha.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Fe.a("OpenInClientCompleted",!0,0,b)}catch(b){r.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}WEi(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.pF&&v.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new CG(this):new NJ(this)}wRi(){this.closeApplication()}xRi(){this.bjc()}qUi(){this.MEi()}aum(){return this.qRh(!0)}qRh(b){const h=(Z.a.eWc||Z.a.pu)&&!!v.AFrameworkApplication.mKd;h&&b&&(Qd.a.om(v.AFrameworkApplication.mKd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}bE.yun="OpenInDesktop";bE.qun="OpenInBrowser";Object(m.a)(bE,"AOpenInClientOperation",null,[]);class oH extends bE{constructor(b,h,u=!1){super(u);this.P4j=b;this.O4j=h}get Voi(){return this.O4j}get uzf(){return this.P4j}Lwl(){v.AFrameworkApplication.va.Rb(Za.a.close,
2,sh.a)}wXh(){}wvh(b){return this.X5i(b)}MEi(){r.ULS.shipAssertTag(5566817,211,!!this.Otc);v.AFrameworkApplication.Pca?v.AFrameworkApplication.ua.RU(!0,this.Otc):Qd.a.om(this.Otc,void 0,void 0,"LaunchDownload")}RRc(){v.AFrameworkApplication.ua.Lb.RRc()}}Object(m.a)(oH,"OpenInClientOperation",bE,[]);class QJ extends oH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.tWn=b=>{r.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Fb.App.oS.forceOutbound(this.jYi,
this.$0m,b)};this.$0m=b=>{r.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new mg.StandardDialog;h.Cd=0;h.rx(kl.a.uPo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.Y0m:this.Z0m)};this.Y0m=()=>{v.AFrameworkApplication.va.Rb(Za.a.close,2,sh.c)};this.Z0m=()=>{Fb.App.za.refreshDocument(null)};this.jYi=b=>{v.AFrameworkApplication.lad=!0;r.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.X5i(b)}}vIk(b){Fb.App.ni.v5a.Jac||Fb.App.xd.kC.Fo?(r.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.jYi(b)):Km.a.iR(4,!0,this.tWn,null,b)}wvh(b){this.vIk(b);return 32}wXh(){Fb.App.za.refreshDocument(null)}}Object(m.a)(QJ,"OpenInWordOperation",oH,[]);const RJ=(b,h)=>{r.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[gg.a.On]=Df.PageReader.instance.mv(h);Df.PageReader.instance.mv(h)?b[gg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:
b[gg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},HM=(b,h,u,B,Q)=>{if(!Fb.App.za||!Fb.App.za.jb||!v.AFrameworkApplication.Om.J1a)return 8;h=Fb.App.za.jb.Yc;if(!h)return 8;if(b===Ob.a.gae&&2===u){b=new Qg.GraphTransaction(15);try{b.Db(h),Df.PageReader.instance.SIo(h)}finally{b&&b.dispose()}RJ(Q,h)}return 32},IM=(b,h,u,B,Q)=>{if(!Fb.App.za||!Fb.App.za.jb)return 8;b=Fb.App.za.jb.Yc;if(!b)return 8;Q[gg.a.Alt]=v.AFrameworkApplication.Om.J1a?"":CommonUIStrings.l_ProtectDocumentToolTip;
RJ(Q,b);return 32};class SJ extends HJ.a{constructor(b,h){super(b,h);this.M0g=!1;this.WUi=(u,B,Q,ca,qa)=>{var Qa;if(B.contextId!==Ad.a.frame)return 2;if(!(Fb.App.eIc||v.AFrameworkApplication.Cs.S9||v.AFrameworkApplication.FSb||this.M0g))return r.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.M0g=!0,8;if(1===Q)return fc.SessionStatusManager.instance.Uj?8:32;let rb=!1;void 0!==qa&&null!==qa&&(rb=qa);if(null===(Qa=v.AFrameworkApplication.K)||void 0===Qa?0:Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",
!1))(new JJ).wMb().then(()=>this.vMb(u,rb));else return this.vMb(u,rb);return 32};this.loc=(u,B,Q)=>{2==Q&&(Fe.a("OpenFileFromPC"),Fb.App.Phb(v.AFrameworkApplication.breadcrumbBrandUrl));return 32};this.Gol=u=>{this.n2m();if(!v.AFrameworkApplication.SXc&&v.AFrameworkApplication.ua.Lb.weg(Za.a.downloadACopy.toString()))this.lza(!0,L.a.download,!0,{});else if(v.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let B=v.AFrameworkApplication.GDb,Q=null;u&&(u.FileDownloadUrl&&(B=u.FileDownloadUrl.toString()),
u.CallSource&&(Q=u.CallSource.toString()));new IJ(B,Q)}else super.downloadACopy(0,null,2,null,null)};this.DQk=u=>{super.workflow(0,null,2,null,u)};this.NI=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback")}Tb(){super.Tb();this.ga.ra(Ob.a.openInClient,Ad.a.frame,this.WUi);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Xc(Ob.a.openInClient,12288);var b=this.ga;b.fb(Ob.a.gae,vc.a.application,HM,4);
b.fb(Ob.a.A3f,vc.a.application,IM,96);this.ga.ra(Za.a.fYf,Ad.a.frame,this.WUi);this.ga.ra(Ob.a.loc,vc.a.view,this.loc)}vMb(b,h){r.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new QJ).Ac(Fb.App.eIc,v.AFrameworkApplication.GDb,yG.Word,b===Za.a.fYf?IF.OpenInBrowser:IF.WriteOnly,h,new hg.a(()=>this.hY))}aDd(b){return Yg.a.instance.Uua()?!0:Fb.App.za.gfj(1,Zj.AppFrame.LYk,b)}downloadACopy(b,h,u,B,Q){if(2===u){if(!v.AFrameworkApplication.GDb&&!v.AFrameworkApplication.ua.Lb.weg(Za.a.downloadACopy.toString()))return 8;
Km.a.iR(2,!0,this.Gol,null,Q);this.aqe();return 32}return super.downloadACopy(b,h,u,B,Q)}aqe(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.NI&&(r.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.NI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}n2m(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=
this.NI&&this.NI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,u,B,Q){return 2===u?(Km.a.iR(13,!0,this.DQk,null,Q),32):super.workflow(b,h,u,B,Q)}}Object(m.a)(SJ,"AppFrameCommandUIActor",HJ.a,[]);class TJ extends mg.StandardDialog{constructor(){super();this.Cd=0;this.pmb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
null,null)}}Object(m.a)(TJ,"WheresTheSaveButtonDialog",mg.StandardDialog,[]);const JM=(b,h,u)=>{if(1===u)return 32;new TJ;return 32};var pH=c(547),UJ=c(1379);class $s extends hl.a{constructor(b,h,u,B,Q,ca,qa=null){var Qa;super();this.qJf=qa;this.MVj=50;this.NVj=56;this.DAc="px";this.Sse="aria-label";this.ZJa="BookmarkIndicator";this.pXg="HighlightBookmarkedContent";this.W3j="HighlightBookmark";this.SWa="wwaengidc";this.HJk="Bookmark_24";this.gb=b;this.gg=u;this.qk=h;this.nW=B;this.eA=Q;this.RVj=null===
(Qa=v.AFrameworkApplication.K)||void 0===Qa?void 0:Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.eA&&this.eA.eBd(this.YB.bind(this));this.GI=ca}Zoo(b){if(b.Wj){for(const h of b.Lg.Oi)if(this.loj(h))return!0;return!1}return this.loj(b.htmlElement)}G7a(b){let h=!1;v.AFrameworkApplication.le("bookmarks-core-ex;bookmarks-core-ex-cf");this.RVj&&nr.a.instance.ge(()=>{h=this.Zoo(b)},"BIA:SCIVE");return h}loj(b){return $s.TRe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&
0<b.length?!0:!1:!1}q0a(b){const h=[];nr.a.instance.ge(()=>{const u=b.D_a(0,this.GI?this.NVj:this.MVj,this.zoom);h.push(this.sna(b.d1,u,b.Hoc[0].y-b.B4[0].y))},"BIA:CIs");return h}sna(b,h,u){const B=b.Tg.ownerDocument,Q=Mh.a.createElement(B,Bi.a.div);Q.className=this.GI?$s.QVj:$s.Gte;$s.Gte;Q.style.left=h+this.DAc;Q.style.top=u+this.DAc;this.GI?(h=Mh.a.createElement(B,Bi.a.div),ah.a("renderIcon")&&appChrome.api.renderIcon(this.HJk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):
(h=Mh.a.createElement(B,Bi.a.f3a),h.src=xk.a.sg($s.ogd),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.Sse,"Bookmark");Q.appendChild(h);b={context:new vG([],Q,new Set,new Set,null,null),qTf:b,container:Q};this.GI||(this.qk.ob(Kd.a.TR,h,this.onMouseEnter),this.qk.ob(Kd.a.uL,h,this.jqa));this.gg.jE(Kd.a.click,Q,this.$Ga.bind(this),b);return Q}nFd(){const b=Object.assign(new mh.a,{action:1,type:5,GA:null,SJ:this.Pea});this.Pea=null;this.nW.EF(b)}YB(b,h){this.Pea&&(h.k1a.uf.classList.contains("BookmarkHighlightSelected")||
this.nFd())}onMouseEnter(b){if(null==b)return!1;b=b.uf;b.parentElement.classList.add($s.wLg);b.src=xk.a.sg($s.KVj);return!0}jqa(b){if(null==b)return!1;b=b.uf;b.parentElement.classList.remove($s.wLg);b.src=xk.a.sg($s.ogd);return!0}$Ga(b){this.z6a(this.pXg,this.W3j);if(null==b){var h=new Map;h.set("Source",this.ZJa);h=Object.assign(new Ub.a,{additionalValues:h});xa.Health.instance.recordKpiFailure(this.pXg,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.Uo.context;if($s.p4a(h,this.Pea))return!0;
h=this.Upf(b.Uo.qTf,h,b.Uo.container);b=Object.assign(new mh.a,{action:0,type:5,GA:h,SJ:this.Pea});this.Pea=h;this.nW.EF(b);return!0}Upf(b,h,u){h={gwh:new Set,FMb:new Set,jwh:null,u3e:null};const B=this.gb.vw(b.Bb,!0,!1),Q=[];if(B)for(const ca of B)Q.push(ca);this.esk(b,h,Q);h=new vG(Q,u,h.gwh,h.FMb,h.jwh,h.u3e);this.Pea&&this.Pea.es===Q&&(u.className+=String.format(" {0}",$s.LVj),this.Pea=h);return h}esk(b,h,u){if(b.Wj){const Q=new Set;for(const ca of b.Lg.Oi)ca.querySelectorAll("*").forEach(Q.add,
Q);b=Array.from(Q.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let B=[];h.FMb.add(u[0].id);h.jwh=u[0].id;h.u3e=u[0].id;b.forEach(Q=>{const ca=ed.a.Eb(Q,Fo.a.nDd);if(ca)for(const qa of ca)B.push(qa),h.gwh.add(qa);if(!B.length)return!0;Q=ed.a.Eb(Q,Fo.a.$Ab);if(!Q)return!0;B=UJ.a.Eic(B,Q)});for(b=this.gb.$f(u[u.length-1],!1,!0);B.length&&b;)h.FMb.add(b.id),h.u3e=b.id,u.push(b),this.qJf.value.vj(b).htmlElement.querySelectorAll("."+Fo.a.t3e).forEach(Q=>{(Q=ed.a.Eb(Q,
Fo.a.$Ab))&&(B=UJ.a.Eic(B,Q))}),b=this.gb.$f(b,!1,!0)}z6a(b,h){const u=new Map;u.set("Source",this.ZJa);u.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.SWa,u)}static p4a(b,h){return!!h&&!!b&&b.ewh===h.ewh}}$s.wLg="WordBookmarkIndicatorContainerHovered";$s.LVj="WordBookmarkIndicatorContainerSelected";$s.ogd="BookmarkDefault.png";$s.KVj="BookmarkHover.png";$s.TRe=!0;$s.Gte="WordBookmarkIndicatorContainer";$s.QVj="WordBookmarkSvgIndicatorContainer";Object(m.a)($s,"BookmarkIndicatorActor",
hl.a,[569]);class VJ{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb=null,Yb=null,gc=null,Fc=null,Sc=null,ld=null,Hd=null){this.U2="_";this.ite="Bookmark";this.kVj=/^BOOKMARK\d+$/i;this.ZJa="BookmarkRibbonOptions";this.HVj="BookmarkFloatieOptions";this.iPg="CreateBookmarkOnRange";this.jPg="CreateBookmarkOnView";this.hPg="CreateBookmarkOnIP";this.Bwe="CreateBookmark";this.SWa="wwaengidc";this.kfh="ShowHideBookmarksOnDocument";this.vQg="DeleteBookmark";this.IZj="DeleteBookmarkAction";this.dik="ShowHideBookmarks";
this.jfh="ShowBookmarksFloatie";this.aik="ShowBookmarksFloatieAction";this.cSg="EditBookmark";this.I_j="EditBookmarkAction";this.y3e="BookmarksUsage";this.LJk="InsertTabSwitchActivity";this.ACm="Insert";this.JTb=b;this.ga=h;this.ib=u;this.xn=B;this.Bx=Q;this.b7=ca;this.Kc=qa;this.YL=Qa;this.eq=Yb;this.vLg=rb;this.De=Lb;this.J6=Sc;this.Pn=gc;this.kd=Fc;this.yS=ld;this.Ik=Hd}get mx(){return this.Bx.value}Tb(){this.hCf()&&(this.ga.ra(Qc.a.sOa,vc.a.view,this.sOa.bind(this)),this.ga.fb(Za.a.AUa,vc.a.application,
this.yLo.bind(this),96),this.ga.ra(Qc.a.sOa,vc.a.Jd,this.N7k.bind(this)),this.ga.ra(Qc.a.sOa,vc.a.Tc,this.M7k.bind(this)),this.ga.ra(Qc.a.deleteBookmark,vc.a.view,this.deleteBookmark.bind(this)),this.ga.ra(Qc.a.Yff,vc.a.view,this.wrl.bind(this)),this.ga.fb(Qc.a.Rpj,vc.a.view,this.nuo.bind(this),1028),this.ga.fb(Qc.a.nae,vc.a.application,this.nae.bind(this),96),this.ga.fb(Qc.a.The,vc.a.Tc,this.The.bind(this),1028),this.ga.fb(Ob.a.K1d,vc.a.view,this.K1d.bind(this),1028),this.ga.fb(Qc.a.MVd,vc.a.view,
this.MVd.bind(this),1028),this.ga.Xc(Qc.a.sOa,1028))}yLo(b,h,u,B,Q){return Q&&Q.NewContextId===this.ACm?(this.f2d(this.LJk),32):2}sOa(b,h,u,B,Q){var ca,qa;b=this.ib.ng;if(!b||b.contextId===vc.a.M7)return 2;if(1===u)return Hi.a.eia(h)||(null===(ca=this.Ik)||void 0===ca?0:ca.R_(b))||(null===(qa=this.Ik)||void 0===qa?0:qa.hia(b))?8:32;h=this.ib.hb.lb;if(!h||this.De.Il(h))return 2;this.RZc(Q,"User is trying to create bookmark from UILocation : {0}");this.z6a(this.jPg,this.Bwe);if(h&&this.xn.oYe(this.sPa(),
h))return this.f2d(this.y3e),32;Q=new Map;Q.set("Source",this.ZJa);Q=Object.assign(new Ub.a,{additionalValues:Q});xa.Health.instance.recordKpiFailure(this.jPg,"Unable to create bookmark",!1,!0,Q);return 8}N7k(b,h,u,B,Q){if(1===u)return 32;if(vc.a.Jd!==h.contextId)return 8;this.RZc(Q,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.lb;if(!b)return 2;this.z6a(this.iPg,this.Bwe);if(this.xn.oYe(this.sPa(),b))return this.f2d(this.y3e),32;b=new Map;b.set("Source",this.ZJa);b=Object.assign(new Ub.a,
{additionalValues:b});xa.Health.instance.recordKpiFailure(this.iPg,"Unable to create bookmark for range",!1,!0,b);return 8}M7k(b,h,u,B,Q){if(1===u)return 32;if(vc.a.Tc!==h.contextId)return 8;this.RZc(Q,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.lb;if(!b)return 2;this.De.Il(b)&&(h=b.Pa,this.De.hlb(h)?(b=this.De.c0(h,!1),b||(r.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.De.c0(h,!0))):r.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));
this.z6a(this.hPg,this.Bwe);if(this.xn.oYe(this.sPa(),b))return this.f2d(this.y3e),32;b=new Map;b.set("Source",this.ZJa);b=Object.assign(new Ub.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.hPg,"Unable to create bookmark for IP",!1,!0,b);return 8}nae(b,h,u,B,Q){1===u&&32;Q[gg.a.On]=$s.TRe;return 32}nuo(b,h,u,B,Q){if(1===u)return 32;this.z6a(this.kfh,this.dik);(b=Q[gg.a.On])||r.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");$s.TRe=b;b=Zo.PageNavigator.instance.hP(this.mx);
if(null!==b)return this.$4c(b),this.JTb.cH({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.ZJa);b=Object.assign(new Ub.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.kfh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,u,B,Q){if(this.hCf()){b=this.ib.hb.lb;if(!b)return 2;b=b.Pa;b=this.xn.BQd(b.node,b.cpBegin);if(1===u)return b?32:8;this.RZc(Q,"User is trying to delete bookmark from UILocation : {0}");this.YL.C0&&(r.ULS.sendTraceTag(545118155,
3029,50,"Dismissing the bookmarks floatie"),this.YL.dismissFloatie());this.z6a(this.vQg,this.IZj);b||r.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.xn.O8i(b.id))return this.vLg&&this.vLg.nFd(),32;u=new Map;u.set("Source",this.ZJa);u=Object.assign(new Ub.a,{additionalValues:u});xa.Health.instance.recordKpiFailure(this.vQg,"Unable to delete bookmark",!1,!0,u);return 8}return 2}wrl(b,h,u,B,Q){b=this.ib.hb.lb;if(!b)return 2;b=b.Pa;
b=this.xn.BQd(b.node,b.cpBegin);if(1===u)return b?32:8;this.RZc(Q,"User is trying to edit bookmark from UILocation : {0}");this.YL.C0&&(r.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.YL.dismissFloatie());this.z6a(this.cSg,this.I_j);b||r.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.J6.value.xrl(h,b,this.xn),32;h=new Map;h.set("Source",this.ZJa);h=Object.assign(new Ub.a,{additionalValues:h});xa.Health.instance.recordKpiFailure(this.cSg,
"Unable to edit bookmark",!1,!0,h);return 8}RZc(b,h){b&&b.UILocation&&r.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}The(b,h,u,B,Q){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===u&&32;this.z6a(this.jfh,this.aik);if(h.contextId===vc.a.Tc)return b=Array(1),b.push("Bookmarks"),this.YL.showFloatie(Q.location,b,1),32;Q=new Map;Q.set("Source",this.HVj);Q=Object.assign(new Ub.a,{additionalValues:Q});xa.Health.instance.recordKpiFailure(this.jfh,
"Unable to show bookmark floatie",!1,!0,Q);return 8}return 2}K1d(b,h,u,B,Q){let ca;return 1===u?(nr.a.instance.ge(()=>{ca=this.ga.Kf(h,Ob.a.insertHyperlink,u,!0,B,Q);32!==ca&&(ca=this.ga.Kf(h,Qc.a.sOa,u,!0,B,Q))},"BA:LFE"),ca):8}MVd(b,h,u){var B;if(1===u)return 32;if(b=this.ib.hb.lb){b=b.Pa.node;if(h=this.VXh(b))return h.click(),32;r.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.xn.BQd(b,0)){b=this.yS.Xeb.get(null===(B=b.id)||void 0===B?void 0:B.toString());
B=Zo.PageNavigator.instance.hP(this.mx).Lc.Eb(b);if(B=this.VXh(B))return B.click(),32;r.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else r.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}VXh(b){let h;b=this.Pn.Hl(b).vj(this.kd.zd.$b);b.Fkb&&(b=b.htmlElement.querySelectorAll("div."+$s.Gte),0<b.length&&(h=b[0]));return h}$4c(b){const h=pH.b(b);if(h){var u=this.Kc.Pc(2);try{for(u.Db(b);h.moveNext();){if(!me.ParagraphReader.kh(h.iterator))continue;
const B=h.currentNode;this.pql(B)&&this.b7.pIb(B,!0)}}finally{u&&u.dispose()}}}pql(b){for(let u=0;u<b.qa.length;u++){const B=b.qa.J(u);if(null!=B.Fh)for(let Q=0;Q<B.Fh.length;Q++){var h=B.Fh.J(Q);if(null!=h&&(h=b.Lc.Eb(h.un).ja(Jc.a.zt,""),!F.a.Xe(h)&&!h.startsWith(this.U2)))return!0}}}sPa(){var b=this.xn.hPd(!1);const h=[];for(let u=0;u<b.count;u++){const B=b.J(u).ja(Jc.a.zt,"");this.kVj.test(B)&&h.push(B)}return 0<h.length?(h.sort((u,B)=>u.localeCompare(B,void 0,{numeric:!0})),b=parseInt(h[h.length-
1].substring(this.ite.length)),this.ite+(b+1)):this.ite+1}z6a(b,h){const u=new Map;u.set("Source",this.ZJa);u.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.SWa,u)}f2d(b){this.hCf()&&this.eq&&this.eq.execute(h=>{h.logActivity(b,null)})}hCf(){v.AFrameworkApplication.le("bookmarks-core-ex;bookmarks-core-ex-cf");return v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(m.a)(VJ,"BookmarkActor",null,[]);class WJ{constructor(b,
h,u){this.nc=b;this.ull=h;this.Qf=u;this.Y7e=this.Y7e.bind(this)}Tb(){this.nc.ra(Qc.a.VIf,vc.a.view,this.Y7e)}Y7e(b,h,u,B,Q){return 1===u?32:(b=this.Qf.W8(h.ek))?(Q=3===Q.Qx,this.ull.value.XJh(this.j9l(b),this.$hm(b),Q),32):2}j9l(b){const h=new Od.DictionaryPropertySet;h.setValue(Ud.a.XE,this.Qf.eh(b));h.setValue(Ud.a.mG,this.Qf.uha(b));h.setValue(Ud.a.gna,this.Qf.qib(b));h.setValue(Ud.a.separator,this.Qf.sTd(b));return h}$hm(b){const h=new Od.DictionaryPropertySet;h.setValue(Jc.a.marginLeft,this.Qf.xJ(b));
h.setValue(Jc.a.marginRight,this.Qf.jL(b));h.setValue(Jc.a.Go,this.Qf.Ft(b));return h}}Object(m.a)(WJ,"ColumnsDialogActor",null,[]);var XJ=c(469);class YJ{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){this.Yo=b;this.dfa=h;this.Be=u;this.mr=B;this.em=Q;this.Ld=ca;this.Kc=qa;this.ue=Qa;this.ga=rb;this.s6j=Lb;this.pYj=Yb}get WCf(){return this.s6j}Tb(){this.ga.fb(Ob.a.T9c,vc.a.view,this.XAm.bind(this),96);this.ga.fb(Ob.a.J5c,vc.a.view,this.J5c.bind(this),4);this.ga.fb(Ob.a.nCd,vc.a.view,this.nCd.bind(this),
1028)}nCd(b,h,u,B,Q){if(!In.a.v9e)return 8;b=Q.FormattingActionId;Q=Q.FormattingActionData;if(!h.view||!h.view.qe)return 2;h=h.view;if(!(b&&Q&&h.mb&&h.mb.hb.lb))return 8;h=this.em.n6h(h.mb.hb.lb.toArray());for(const ca of h){h=ca.ja(Jc.a.Ww,0);u=this.Yo.getById(h);if(!u)return r.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.pYj.CSo(u,b,Q))return r.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}XAm(b,
h,u,B,Q){h=this.Yo.getById(Q);if(!h)return 8;u=h.contentControlNode;if(!u)return 8;if(u.ja(Jc.a.k8,!1))return 2;B=this.Yo.XQl(h);if(!B)return 8;Q=this.Kc.Pc(7);Q.Db(B.node);if(!this.WCf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Ld.Ge(B,b),In.a.r4a?this.em.GAb(h,!0):this.GAb(h),u.setValue(Jc.a.k8,!0),Q.dispose(),32;const ca=new Od.DictionaryPropertySet;ca.setValue($c.a.Bji,B);var qa=u.ja(Jc.a.oOa,"");qa=this.dfa.Kii(qa);if(!qa)return this.mr.Ge(B,
WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,In.a.sr?b:void 0),In.a.r4a?this.em.GAb(h,!0):this.GAb(h),u.setValue(Jc.a.k8,!0),Q.dispose(),32;ca.setValue($c.a.nvf,qa);if(1<qa.length&&!h.Gf)return Q.dispose(),8;this.k6k(ca);u.setValue(Jc.a.k8,!0);Q.dispose();return 32}J5c(b,h,u){b=h.view.qe?h.view:null;if(!b||!b.mb)return 8;const [B,Q]=this.tbm(b.mb.hb);if(0===B.length)return 8;if(1===u){for(var ca of B){var qa=Q.get(ca.parentId);if(this.Sui(ca,qa))return 32}return 8}if(2===u){u=this.Bxo(B,
Q);ca=this.Kc.Pc(15);ca.Db(b.ed);for(qa of u)u=Q.get(qa.parentId),this.Sui(qa,u)&&this.Yo.rOb(qa.id);ca.dispose();Object(XJ.l)()&&Object(XJ.o)("RemoveContentControl");return 32}return 2}tbm(b){var h,u,B=[];for(const ca of b)B.push(...(null!==(h=this.em.joa(ca.Pa,ca.Rc,1))&&void 0!==h?h:[]));if(0===B.length)return[B,new Map];h=[];for(const ca of b)h.push(...(null!==(u=this.em.joa(ca.Pa,ca.Rc,3))&&void 0!==u?u:[]));b=new Map(B.map(ca=>[ca.id,ca]));if(0===h.length)return[B,b];const Q=new Map(h.map(ca=>
[ca.id,ca]));B=B.filter(ca=>!Q.has(ca.id));b=new Map([...b,...Q]);return 0==B.length?[[h[0]],b]:[B,b]}GAb(b){const h=this.mr.AQc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.ue.ZC(b.start.node).jj(ls.a.I_f))this.Be.vga(h.formatting),this.Be.E7a(h.formatting,b)}else r.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}k6k(b){this.ga.Rb(Ob.a.qie,2,b)}Sui(b,h){return b.$ha&&b.OQm&&(!h||h.isEditable)}Bxo(b,h){const u=(B,Q)=>null==B||null==Q||
B.id===Q.id?!1:B.id===Q.parentId||u(h.get(B.parentId),Q);return b.slice().sort((B,Q)=>u(B,Q)?1:u(Q,B)?-1:0)}}Object(m.a)(YJ,"ContentControlActor",null,[]);class KF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.oyk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.fIo="Interested in this feature?"}Tb(){this.ga.ra(Qc.a.gcf,
vc.a.view,this.OUc.bind(this))}OUc(b,h,u){2===u&&(Object(Fe.c)(Qc.a.gcf),b=new mg.StandardDialog,b.Cd=4,b.xe(1,this.primaryButtonText),b.xe(2,this.secondaryButtonText),b.XEc(this.oyk,null),b.pv(this.fIo,null,0,this.Vba));return 32}Vba(b){1===b&&(Object(Fe.a)("CountMeIn_CustomizeRibbon",!0),F.a.DR(KF.SGj)&&Qd.a.om(KF.SGj))}}KF.SGj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(m.a)(KF,"CustomizeRibbonActor",null,[]);var rB=c(1085);class qH extends Hf.a{constructor(b,
h,u){super(!1,!1,!0);this.K3g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,rB.a.d0e,rB.a.c0e,rB.a.e0e];this.yUj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,rB.a.Hzk,rB.a.Gzk,rB.a.Jzk];this.PJg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.llc=()=>{new qH(this.ga,this.PTe,this.btc)};this.XZl=()=>{const B=[];for(const Q of this.PTe)B.push(this.Z5(Q));return B};this.jXo=B=>{const Q=
new Set;this.$ea="";for(const ca of B)if(""!==ca.position){const qa=this.Obi(ca.position);if(0>qa||22<qa){this.$ea=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(Q.has(qa)){this.$ea=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.uIo(ca)),Q.add(qa)}else{this.$ea=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.$ea&&(this._tabStops=[],this.PTe=B)};this.xfl=(B,Q)=>{try{if(1===B){if(""!==this.$ea)throw Error.create(this.$ea);
Q.DefaultTabStop&&(this.btc=rB.a.i$f(Q.DefaultTabStop),this.x_o(this.btc));if(32!==this.ga.Rb(Qc.a.iSb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Of.a.Mv(this.btc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ca){this.kIa(ca.message,this.llc)}};this.ga=b;this.PTe=h;this._tabStops=[];this.btc=u;this.$ea="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.dFb()};this.Qh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.xfl,b)}Z5(b){return{["position"]:b.position,
["alignment"]:b.alignment,["leader"]:b.leader}}Obi(b){return Math.floor(100*parseFloat(b))/100}uIo(b){return new Mz.a(Of.a.Mv(this.Obi(b.position)),rB.a.iem(b.alignment),rB.a.gem(b.leader),1)}x_o(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Rb(Ob.a.EHa,2,h)){var u=h.marginLeft;const B=kf.a.Ki(h.marginRight,0);u=kf.a.Ki(u,0);h=kf.a.Ki(h.Go,0);if(kf.a.Fca(b,0,!1)>=h-B-u)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}dFb(){return{["getInitState"]:this.XZl,["updateState"]:this.jXo,["validPositions"]:this.bgi(-Infinity,Infinity,"Position"),["validAlignments"]:this.J5h(this.PJg,this.PJg,null,"Alignment"),["validLeaders"]:this.J5h(this.K3g,this.K3g,this.yUj,"Leader"),["defaultTabStopSpinButtonProps"]:this.bgi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.btc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}bgi(b,
h,u){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:u,["unitType"]:"Inch",["validUnits"]:[mC("Inch",3,b,h,.1)],["numberFormatInfo"]:WG()}}J5h(b,h,u,B){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:B,["options"]:lG(b,h,u)}}}Object(m.a)(qH,"CustomTabDialog",Hf.a,[]);class ZJ{constructor(b,h,u){this.sfc=(B,Q,ca,qa,Qa)=>{if(2!==ca)return 8;if(!Qa)return 16;B=Qa.tabStop;Qa=Qa.value;if(!B)return 16;Fe.c(Qc.a.sfc);Qa=new Mz.a(Qa,
B.mea,B.Opa,B.ljg);Q=Q.node;this.TAa.G6a(Q,B);this.TAa.XWd(Q,Qa);return 32};this.u8c=(B,Q,ca,qa,Qa)=>{if(2===ca){if(!Qa)return 16;this.TAa.XWd(Q.node,Qa);return 32}return 8};this.HNb=(B,Q,ca,qa,Qa)=>{B=this.TAa.R5i(Q.node);if(!("customTabs"in Qa))return Qa.customTabs=B,32;Q=Qa.customTabs;if(!Q||0>=Q.length||!B||0>=B.length)return Qa.customTabs=null,32;ca=[];for(const rb of Q)for(const Lb of B)if(Lb.KIa===rb.KIa&&Lb.ljg===rb.ljg&&Lb.mea===rb.mea){ca.push(rb);break}Qa.customTabs=ca;return 32};this.G6a=
(B,Q,ca,qa,Qa)=>{if(2===ca){if(!Qa)return 16;Fe.c(Qc.a.G6a);this.TAa.G6a(Q.node,Qa);return 32}return 8};this.sOb=(B,Q)=>{this.TAa.sOb(Q.node);return 32};this.iSb=(B,Q,ca,qa,Qa)=>{if(2===ca){if(!Qa)return 16;B=Qa.tabStops;ca=Qa.defaultTabStopLength;Q=Q.node;qa=!1;const rb=this.TAa.l1n(Q,B);Qa.defaultTabStopLengthSaved||(qa=this.BK.kfo(Q,ca),Qa.defaultTabStopLengthSaved=!0);rb&&Fe.d(Qc.a.iSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"Custom Tab Stops Count",string:B.length.toString()})]);
if(null==qa)return r.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;qa&&(this.g6c&&this.g6c.$si(),this.Pd.Us(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Fe.d(Qc.a.iSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"Default Tab Stop Length",string:ca.toString()})]));return 32}return 8};this.bqj=(B,Q,ca)=>{if(2!==ca)return 8;B={};if(32!==this.ga.Rb(Qc.a.LX,2,B))return r.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;Q={};if(32!==this.ga.Rb(Ob.a.EHa,2,Q))return r.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;B=rB.a.i$f(Of.a.Wz(B.defaultTabStop));ca={};ca.defaultTabStopLength=B;ca.sectionPropertiesData=Q;if(32!==this.ga.Rb(Qc.a.Spg,2,ca))return r.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ca.isParagraphValid)return r.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.TAa.kIa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;Q={};if(32!==this.ga.Rb(Qc.a.HNb,2,Q))return r.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(Q=Q.customTabs)||(Q=[]);Q=rB.a.hem(Q);new qH(this.ga,Q,B);Fe.c(Qc.a.llc,!0);return 32};this.DPm=(B,Q,ca,qa,Qa)=>{if(2!==ca)return 8;if(!Qa)return 16;if(Qa.isParagraphValid)return 32;ca={};if(32!==this.ga.Kf(Q,Ob.a.u6a,2,!1,null,ca))return 16;B=Qa.sectionPropertiesData;Q=Qa.defaultTabStopLength;var rb=ca.It;qa=rb.Voa;
rb=1===rb.specialIndentType?rb.KB:rb.KB-rb.hea;const Lb=B.marginLeft,Yb=B.marginRight;ca.isRtl?(ca=kf.a.Ki(Math.max(Yb,Yb+qa),0),qa=kf.a.Ki(Math.max(Lb,Lb+rb),0)):(ca=kf.a.Ki(Math.max(Lb,Lb+rb),0),qa=kf.a.Ki(Math.max(Yb,Yb+qa),0));B=kf.a.Ki(B.Go,0);Q=kf.a.Fca(Q,0,!1);Qa.isParagraphValid=Q<B-ca-qa;return 32};this.ga=b;this.TAa=h;this.BK=u}get Pd(){return null!=this.$Gg?this.$Gg:this.$Gg=Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get g6c(){return null!=this.NEg?this.NEg:
this.NEg=Ga.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}Tb(){const b=u=>Qo.OutlineElementGeneralizer.nha(u.hb,!0),h=Fb.App.JUa.HJc(b,!0);this.ga.ra(Qc.a.HNb,vc.a.view,Fb.App.JUa.HJc(b,!1));this.ga.fb(Qc.a.HNb,vc.a.paragraph,this.HNb,96);this.ga.ra(Qc.a.G6a,vc.a.view,h);this.ga.fb(Qc.a.G6a,vc.a.paragraph,this.G6a,96);this.ga.ra(Qc.a.sOb,vc.a.view,h);this.ga.fb(Qc.a.sOb,vc.a.paragraph,this.sOb,96);this.ga.ra(Qc.a.u8c,vc.a.view,h);this.ga.fb(Qc.a.u8c,vc.a.paragraph,this.u8c,96);
this.ga.ra(Qc.a.sfc,vc.a.view,h);this.ga.fb(Qc.a.sfc,vc.a.paragraph,this.sfc,96);this.ga.ra(Qc.a.iSb,vc.a.view,h);this.ga.fb(Qc.a.iSb,vc.a.paragraph,this.iSb,96);this.ga.ra(Qc.a.Spg,vc.a.view,h);this.ga.fb(Qc.a.Spg,vc.a.paragraph,this.DPm,96);this.ga.ra(Qc.a.llc,vc.a.view,this.bqj);this.ga.ra(Qc.a.Fri,vc.a.view,this.bqj)}}Object(m.a)(ZJ,"CustomTabActor",null,[]);var KM=c(119),DG=c(626);class $J{constructor(b,h,u,B,Q,ca,qa,Qa,rb){this.ga=b;this.rzd=u;this.dKa=(this.G_b=Q)&&B;this.yn=ca;this.rT=qa;
this.lZj=Qa;this.yx=rb;this.tKg=h;this.tKg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.mMf(!0),this.ELf(!0)):(this.G_b&&ah.a("isSharedUXDarkModeOn")?(this.yn.hJ=appChrome.api.isSharedUXDarkModeOn(),this.mMf(!0)):this.yn.hJ=!1,this.dKa?this.ELf(!0):this.yn.yUa=!1);v.AFrameworkApplication.lI(()=>{this.NLb()});this.dKa&&ah.a("dispatch")&&appChrome.api.dispatch(this.Hvj([]))}Tb(){this.dKa&&(this.ga.ra(Qc.a.MIo,vc.a.view,this.Lfl.bind(this)),this.ga.ra(Qc.a.r9c,
vc.a.view,this.r9c.bind(this)),this.ga.fb(Qc.a.C4c,vc.a.view,this.C4c.bind(this),96));this.G_b&&(this.ga.ra(Qc.a.s9c,vc.a.view,this.s9c.bind(this)),this.ga.fb(Qc.a.abe,vc.a.view,this.abe.bind(this),96))}pEm(b){if(!this.jqo(b))return!1;const h=$k.a.instance.Pc(2);try{h.Db(b.root);const u=vd.GraphIterator.eb(b.root.graphNode),B=bq.a.Np(u);for(;B.moveNext();){const Q=Object(Na.a)(KM.a,B.currentNode);Q&&Q.mL(b.$b,20,!0)}}finally{h&&h.dispose()}return!0}jqo(b){return b&&b.root&&b.kv?b.Vi||b.dEf||b.Swi||
b.Vj:!1}f3n(){let b=!1;this.rzd.forEach(h=>{this.pEm(h)&&(b=!0)});return b}NIo(){r.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.yn.hJ?"dark":"light");return this.yn.hJ?DG.a.dFc(1):DG.a.$8i(1)}qlg(){const b=this.yn.Z7;r.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.f3n()||(b?!DG.a.dFc(0):!DG.a.$8i(0)))return!1;this.lZj.SLn(b);return!0}Hvj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.yn.hJ));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.Ggi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.yn.yUa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):r.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){r.ULS.sendTraceTag(527282835,3023,10,h)}return b}Lfl(){return this.qlg()?
32:8}s9c(b,h,u){if(1===u)return 32;b=this.rT.Vf("UserAction","sharedUXDarkModeToggle");if(ah.a("toggleSharedUXDarkMode"))r.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),ah.a("isSharedUXDarkModeOn")?this.yn.hJ=appChrome.api.isSharedUXDarkModeOn():this.yn.hJ=!this.yn.hJ,r.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.yn.hJ);else return 8;appChrome.getHeaderApi().then(B=>{B.hasOwnProperty("refreshThemeOverride")&&
B.refreshThemeOverride()});this.NIo()||r.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.dKa&&!this.yn.yUa&&(this.qlg()||r.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Fb.App.za.cH(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.yn.hJ));this.dKa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.yn.hJ));b.stop();r.ULS.sendTraceTag(555885377,3023,50,"{0}",b.li);Fe.b(this.yn.hJ?"DarkModeOn":"DarkModeOff");return 32}r9c(b,h,u){if(1===u)return 32;b=this.rT.Vf("UserAction","sharedUXDarkModeSwitchBackground");r.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.yn.yUa=!this.yn.yUa;if(!this.qlg())return 8;h={};h.DarkModeSwitchBackground=this.yx?"ButtonModel":"ToggleButtonModel";Fb.App.za.cH(h);b.stop();r.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.li);r.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.yn.yUa);Fe.b(this.yn.yUa?"DarkCanvasOff":"DarkCanvasOn");return 32}abe(b,h,u,B,Q){if(1===u)return 32;if(!Q)return 2;ah.a("isSharedUXDarkModeOn")&&(this.yn.hJ=appChrome.api.isSharedUXDarkModeOn());Q&&(Q[gg.a.On]=this.yn.hJ);return 32}C4c(b,h,u,B,Q){if(1===u)return 32;if(!Q)return 2;!this.yx&&Q&&(Q[gg.a.On]=this.yn.yUa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.yn.hJ));
this.dKa&&this.Hvj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.Ggi(!1)));appChrome.api.dispatch(b);return 32}Ggi(b){const h={};this.yn.yUa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}NLb(){this.G_b&&this.mMf(!1);this.dKa&&this.ELf(!1)}mMf(b){var h;r.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.yn.hJ?"dark":"light",this.yn.eEa);b&&this.yn.hJ!=(null===(h=this.tKg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&r.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.yn.hJ?"dark":"light",this.yn.eEa)}ELf(b){r.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.yn.Z7?"dark":"light",this.yn.Kfl)}}Object(m.a)($J,"DarkModeActor",null,[]);var aK=c(1604);
class EG{constructor(){this.Height=this.Width=0}static construct(b,h){const u=new EG;u.Width=b;u.Height=h;return u}}Object(m.a)(EG,"ViewportInfo",null,[]);class rH extends Qs.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}el(){return 85}static construct(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){const gc=new rH;gc.ContractVersion=b;
gc.DocumentContent=h;gc.EnhancementId=u;gc.World=B;gc.ScalingFactor=Q;gc.DesktopViewportInfo=EG.construct(ca,qa);gc.MobileViewportInfo=EG.construct(Qa,rb);gc.MinParagraphCount=Lb;gc.ContentCulture=Yb;return gc}}Object(m.a)(rH,"SwayPreviewRequest",Qs.a,[]);var LM=c(597);class wD{static get Yg(){return Hf.a.Bz(Fb.App.instance&&Fb.App.instance.P0d?wD.xll:wD.Sm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,
wD.k8n,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}wD.k8n=xk.a.sg("progress.gif");wD.Sm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
wD.xll="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(m.a)(wD,"DigitalPrintDialogHtml",null,[]);class Ix{constructor(b,h,u,B){this.fontFamily=b;this.Y4n=h;this.fontWeight=u;this.fontStyle=B}}Object(m.a)(Ix,"FontInfo",null,[]);class at{constructor(b,h,u,B){this.styleName=b;this.title=h;this.eIo=u;this.Grm=B}}Object(m.a)(at,"StyleVisualInfo",null,[]);class cE extends Hf.a{constructor(b,h,u,B,Q=!0){super();this.V6=this.du=this.Ala=this.d3=this.bmd=this.Rgh=this.qxd=this.GTe=this.HTe=this.ZSe=this.b0b=this.VMa=this.s3=this.u_b=null;this.wWe=this.ZOe=
!1;this.Rkd=null;this.Opl=()=>{this.Cfj(0)};this.Npl=(ca,qa)=>{this.Cfj(qa)};this.oXi=ca=>{this.P$h(ca)===Sys.UI.Key.enter&&(this.mXf(ca),ca.preventDefault(),ca.stopPropagation())};this.HTi=ca=>{((ca=ca.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ca.id||ca.id===em.a.lfd)||Z.a.Kt)&&this.VMa&&this.JPb(this.VMa)};this.ITi=ca=>{const qa=this.P$h(ca);qa!==Sys.UI.Key.tab&&qa!==Sys.UI.Key.left&&qa!==Sys.UI.Key.right&&qa!==Sys.UI.Key.up&&qa!==Sys.UI.Key.down||this.zom(qa)||(ca.preventDefault(),
ca.stopPropagation(),this.hmn(qa))};this.kVf=()=>{this.wWe||(this.wWe=!0,r.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Me.a.removeHandler(this.s3,Kd.a.scroll,this.kVf))};this.VVf=()=>{r.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.mXf=ca=>{ca.preventDefault();ca.stopPropagation();v.AFrameworkApplication.va.processAction(Ob.a.oRh,2);ca.target?(ca="button"===ca.target.tagName.toLowerCase()?ca.target:ca.target.parentNode)&&ca.id!==this.u_b&&(r.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.u_b,ca.id),this.sBh(ca),this.VLh()):r.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.dml=ca=>{const qa=(new Date).getTime()-this.RQg;ei.a.instance.lf(Qh.a.fml,qa);ca?this.Ubo():(r.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),v.AFrameworkApplication.va.processAction(Ob.a.nRh,2))};
this.Sbo=()=>{this.Avo();try{const ca=cE.TSh.wyl(),qa=rH.construct(2,ca,this.u_b,"VerticalWorld",.3,1366,600,330,280,20,cE.TSh.Q$a.name);v.AFrameworkApplication.He.sj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Fb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,LM.b(qa),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.XEn,this.f2i,qa)}catch(ca){r.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ca.message)}};
this.XEn=ca=>{var qa=null;({group:qa}=If.a.S1(ca.data.se)).returnValue?(qa=qa.Responses[0],qa.Succeeded?(this.E2d(ca.data,Qh.a.BDo),this.zfb(),this.ilj(this.GTe,qa.PreviewHtml),this.ilj(this.qxd,qa.PreviewHtmlMobile)):this.f2i(null)):r.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.f2i=()=>{this.Bvo();this.HTe.style.background="#E6E6E6";this.Rgh.style.background="#E6E6E6"};this.Yg=wD.Yg;this.ug="DigitalPrintDialog";r.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.pek=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.FVb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.zjk=u;this.Fuc=B;this.xe(1,this.pek);this.Qh(this.FVb,this.dml,null);this.Eym();this.iCo();this.RQg=(new Date).getTime();Q&&Km.a.iR(14,!1,this.Opl,this.Npl,null);this.Pzm();this.exm();this.$_m();this.hLf();this.R_m();this.VLh()}get lwa(){return this.Rkd}Cfj(b){if(!this.ZOe){const h=
(new Date).getTime()-this.RQg;ei.a.instance.lf(Qh.a.eml,h);b?r.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",sg.a[b])):r.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.w_a.disabled=!1}}Eym(){this.b0b=document.getElementById("digitalPrintStatusMessageDiv");this.ZSe=document.getElementById("digitalPrintStatusMessageIconDiv");this.HTe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.GTe=document.getElementById("swayDesktopPreviewHtmlHolder");this.qxd=document.getElementById("swayMobilePreviewHtmlHolder");this.Rgh=document.getElementById("swayMobilePreviewWrapperDiv");this.s3=document.getElementById("swayGallery");this.s3.setAttribute("tabindex","0");Me.a.addHandler(this.s3,Kd.a.scroll,this.kVf);this.s3.setAttribute(af.a.oh,af.a.fuh);this.d3=document.getElementById("digitalPrintLearnMoreLink");this.d3.href="https://go.microsoft.com/fwlink/?linkid=871972";Me.a.addHandler(this.d3,
Kd.a.click,this.VVf);this.Ala=new zb.a;this.bmd=document.getElementById("homeWrapper");this.C5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Fuc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}Pzm(){this.du=new zb.a;this.du.add(new at("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.du.add(new at("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.du.add(new at("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.du.add(new at("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.du.add(new at("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.du.add(new at("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.du.add(new at("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.du.add(new at("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.du.add(new at("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.du.add(new at("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.du.add(new at("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.du.add(new at("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.du.add(new at("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.du.add(new at("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.du.add(new at("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.du.add(new at("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.du.add(new at("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.du.add(new at("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.du.add(new at("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.du.add(new at("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.du.add(new at("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.du.add(new at("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}exm(){this.V6=
new zb.a;this.V6.add(new Ix("universc","universc","normal","normal"));this.V6.add(new Ix("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.V6.add(new Ix("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.V6.add(new Ix("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.V6.add(new Ix("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.V6.add(new Ix("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.V6.add(new Ix("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.V6.add(new Ix("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.V6.add(new Ix("ArialNova","ArialNova","normal","normal"));this.V6.add(new Ix("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.V6.add(new Ix("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.V6.add(new Ix("RockwellNova","RockwellNova","normal","normal"));
this.V6.add(new Ix("SabonNRegLT","SabonNRegLT","normal","normal"));this.V6.add(new Ix("DaytonaThin","DaytonaThin","100","normal"))}$_m(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const u of this.V6)h+=String.format(this.zjk,u.fontFamily,u.Y4n,u.fontWeight,u.fontStyle);b.innerText=h;this.bmd.appendChild(b)}R_m(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
xk.a.sg("SwayPreviewFrame.svg")),u=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",xk.a.sg("SwayPreviewFrameHC.svg"));b.innerText=h+u;Z.a.Cr&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.bmd.appendChild(b)}P$h(b){return b?b.keyCode:window.event.keyCode}hide(){this.f6f();super.hide()}f6f(){if(this.s3&&!this.ZOe){for(let b=0;b<this.Ala.count;b++)Me.a.removeHandler(this.Ala.J(b),
Kd.a.click,this.mXf),Me.a.removeHandler(this.Ala.J(b),Kd.a.$h,this.oXi);Me.a.removeHandler(this.s3,Kd.a.$h,this.ITi);Me.a.removeHandler(this.s3,Kd.a.focus,this.HTi);Me.a.removeHandler(this.d3,Kd.a.click,this.VVf);this.wWe||Me.a.removeHandler(this.s3,Kd.a.scroll,this.kVf);this.ZOe=!0}}hLf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",xk.a.uKk());this.bmd.appendChild(b);for(const h of this.du)this.pId(this.s3,h);this.u1(this.s3);
this.sBh(this.s3.firstChild);this.s3.firstChild.focus();Me.a.addHandler(this.s3,Kd.a.$h,this.ITi);Me.a.addHandler(this.s3,Kd.a.focus,this.HTi)}pId(b,h){const u=document.createElement("button");u.className="swayGalleryItem swayClip136x90 swayImageBorderButton";u.setAttribute(af.a.Heb,af.a.uM);u.setAttribute("title",h.title);u.setAttribute(af.a.oh,af.a.iuh);u.id=h.styleName;b.appendChild(u);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=xk.a.sg("swayPublish.png");b.setAttribute(af.a.oh,af.a.rz);b.setAttribute("unselectable","on");b.setAttribute(af.a.sA,af.a.pp);b.id=h.styleName+"img";u.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.eIo;b.setAttribute(af.a.sA,af.a.pp);b.setAttribute("unselectable","on");b.setAttribute(af.a.oh,af.a.rz);u.appendChild(b);const B=document.createElement("label");B.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;B.className=h.Grm;B.setAttribute(af.a.sA,
af.a.pp);b.setAttribute("unselectable","on");B.setAttribute(af.a.oh,af.a.rz);u.appendChild(B);Me.a.addHandler(u,Kd.a.click,this.mXf);Me.a.addHandler(u,Kd.a.$h,this.oXi);this.Ala.add(u)}hmn(b){const h=this.lwa;this.tFl(b,h,!v.AFrameworkApplication.isRtl)||this.vFl(b,h,!v.AFrameworkApplication.isRtl)||this.qFl(b,h)||this.rFl(b,h)}zom(b){return b===Sys.UI.Key.tab?(this.lwa&&this.lwa!==this.VMa&&(this.lwa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Rkd=this.VMa),!0):!1}tFl(b,
h,u){return b===Sys.UI.Key.right&&u||b===Sys.UI.Key.left&&!u?(b=(b=h.nextSibling)||this.s3.firstChild,this.JPb(b),!0):!1}vFl(b,h,u){return b===Sys.UI.Key.left&&u||b===Sys.UI.Key.right&&!u?(b=(b=h.previousSibling)||this.s3.lastChild,this.JPb(b),!0):!1}qFl(b,h){return b===Sys.UI.Key.down?(b=this.Ala.indexOf(h),h=b+2,h<this.Ala.count?(b=this.Ala.J(h))&&this.JPb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Ala.J(h))&&this.JPb(b)),!0):!1}rFl(b,h){b===Sys.UI.Key.up&&(b=this.Ala.indexOf(h),h=b-2,0<=h?(b=this.Ala.J(h))&&
this.JPb(b):(h=b?20+b-1:this.Ala.count-1,(b=this.Ala.J(h))&&this.JPb(b)))}JPb(b){this.lwa&&this.lwa.id!==this.VMa.id&&(this.lwa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Rkd=b;this.lwa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.lwa.focus()}iCo(){this.w_a.className="WACDialogButtonNormal swayPrintToWebButton";this.w_a.setAttribute("tabindex","0");this.Yz.className="WACDialogButtonNormal swayCancelButton";
this.Yz.setAttribute("tabindex","0");this.w_a.disabled=!0}sBh(b){this.lwa&&(this.lwa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.VMa&&(this.VMa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.VMa.setAttribute(af.a.Heb,af.a.uM));this.u_b=b.id;this.VMa=b;this.VMa.setAttribute(af.a.Heb,af.a.pp);this.Rkd=b;this.lwa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}VLh(){Bg.a.instance.Xb(new bf.a(2,
1,50,this.Sbo))}ilj(b,h){b.innerHTML=h}Ubo(){r.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.u_b));v.AFrameworkApplication.va.processAction(Ob.a.pRh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Fb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature,v.AFrameworkApplication.userSessionId,this.u_b);Qd.a.openWindow(4,b)}E2d(b,h){ei.a.instance.lf(h,+b.PT-+b.RH)}Bvo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.zfb();this.b0b.innerText=b;this.b0b.style.display="block"}Avo(){this.zfb();this.ZSe.style.display="block";this.b0b.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.b0b.style.display="block"}zfb(){this.HTe.style.background="";this.qxd.style.background="";kc.a.K_(this.GTe);kc.a.K_(this.qxd);this.b0b.style.display="none";this.ZSe.style.display="none"}static get TSh(){return null!=cE.Mwg?cE.Mwg:cE.Mwg=
Ga.a.instance.Oa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(m.a)(cE,"DigitalPrintDialog",Hf.a,[]);class sH{constructor(b,h){this._context=this.Bk=null;this.Que=0;this.Pgd=!1;this.Jfh=null;this.digitalPrint=(u,B,Q,ca,qa)=>{if(1===Q)return v.AFrameworkApplication.xF?8:32;this.Jfh=qa.SourceControlId;if(v.AFrameworkApplication.K.$("IsAnonymousUser"))return r.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.Upb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=B;if(sH.$Nm())return r.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.O$e(),32;switch(this.Que){case 1:r.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.O$e();break;case 2:r.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.Upb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.Pgd=!1,this.Bk=(new ci.a).create(),this.Bk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Bk.GL(CommonUIStrings.l_DefaultDialogTitle,this.eVk,null),v.AFrameworkApplication.He.sj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Fb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.gVk,this.fVk,null)}return 32};this.eVk=()=>{this.Pgd=!0;r.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.gVk=u=>{if(!this.Pgd){this.Bk.close();var B=null;this.E2d(u.data,Qh.a.ADo);({group:B}=If.a.S1(u.data.se)).returnValue?(u=B.Responses[0],r.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",u.HasLicense,u.Succeeded),u.Succeeded?(this.Que=u.HasLicense?1:2,2===this.Que?this.Upb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.O$e()):this.Upb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(r.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Upb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.fVk=u=>{this.Pgd||(this.Bk.close(),r.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.E2d(u.data,Qh.a.zDo),this.Upb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.J6=h}Tb(){v.AFrameworkApplication.UY?r.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?r.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(Ob.a.digitalPrintToSway,vc.a.view,this.digitalPrint,4),this.ga.fb(Ob.a.oRh,vc.a.view,dd.ActionManager.cR,4),this.ga.fb(Ob.a.pRh,vc.a.view,
dd.ActionManager.cR,4),this.ga.fb(Ob.a.nRh,vc.a.view,dd.ActionManager.cR,4),this.ga.fb(Za.a.lKd,vc.a.view,dd.ActionManager.cR,4))}O$e(){r.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.Jfh);new cE(this._context,this.ga,v.AFrameworkApplication.K.kb("SwayFontDownloadUrlTemplate"),v.AFrameworkApplication.K.kb("FileSource"))}Upb(b){const h=new mg.StandardDialog;h.Cd=0;h.Uja(CommonUIStrings.l_DefaultDialogTitle,b,
null)}E2d(b,h){ei.a.instance.lf(h,+b.PT-+b.RH)}static $Nm(){return"OneDriveWOPI"===v.AFrameworkApplication.K.kb("FileSource")}}Object(m.a)(sH,"DigitalPrintActor",null,[]);class bK{constructor(){this.Iih=null}LJi(){r.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}xBj(b){if(!b)return r.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.WCi(b.errorDetails))return!1;this.Iih=Object(Na.a)(Il.a,b.errorDetails).typeId;return!0}whe(b){return this.WCi(b)?
Object(Na.a)(Il.a,b).typeId===this.Iih:!1}WCi(b){if(!b)return r.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Na.a)(Il.a,b);return b?b.token&&b.typeId?!0:(r.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(r.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(m.a)(bK,"DoNotCheckThisCritiqueTypeStrategy",null,[571]);class cK extends Hf.a{constructor(b,h,u){super(!1,!1,!0);this.nc=b;this.Yna=u;this.v_j="DocumentChoiceGroup";this.sSg="EmbededContent";
this.UXg="HyperLink";this.HHe=u.E$a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.dFb()};this.XVj=this.ayl.bind(this);this.xe(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Qh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.XVj,b)}dFb(){const b=Array(2);b[0]={["key"]:this.sSg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.UXg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.v_j,["defaultSelectedKey"]:this.HHe?this.sSg:this.UXg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}ayl(b,h){1===b?(this.HHe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Qc.a.aPa:Qc.a.vhb,this.nc.processAction(b,2),this.HHe=h.isExternalContentSelected,ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ha.a,{name:"ActionId",int64:b})]}))),this.Yna.J8n(h.isExternalContentSelected)):0===b&&r.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(m.a)(cK,"ExternalContentDefaultSettingsDialog",Hf.a,[]);class bt{constructor(b,h,u,B,Q){this.YL=Ga.a.instance.resolve("Common.IReactContextualUILauncher");this.Lsb=gg.a.On;this.nlc=()=>{const ca=Array(1);ca.push("ExternalContent");var qa=Ga.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").FPa();qa=Object.assign(new rD.a,{x:qa.x,y:qa.y});this.YL.showFloatie(qa,ca,1);return 32};this.rHb=()=>{this.YL.C0&&this.YL.dismissFloatie();return 32};this.U3i=(ca,qa,Qa,rb,Lb)=>
{if(qa="object"===typeof Lb?Lb:null)ca===Qc.a.Y2f?(ca=bt.zXa!==Qc.a.aPa&&bt.zXa!==Qc.a.vhb,qa[this.Lsb]=bt.zXa===Qc.a.aPa||ca):ca===Qc.a.Z2f&&(qa[this.Lsb]=bt.zXa===Qc.a.vhb);return 32};this.NXh=(ca,qa,Qa)=>{1!==Qa&&(ca===Qc.a.vhb&&bt.zXa!==Qc.a.vhb?(r.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Lm.undo()&&(qa=new fx.a(1,v.AFrameworkApplication.isRtl),qa.R2c="ExternalContent",bt.uhb.W4c(qa))):ca===Qc.a.aPa&&bt.zXa!==Qc.a.aPa&&(r.ULS.sendTraceTag(575813833,
324,50,"ExternalContentPasteEmbededWebContentOption clicked"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.kTg.B5i()),bt.zXa=ca);ea.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ha.a,{name:"behavior",string:Qa.toString()}),Object.assign(new ha.a,{name:"ActionId",int64:ca})]}));return 32};this.ga=b;this.Lm=h;this.kTg=B;this.P5j=Q;this.WVj=this.byl.bind(this);
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.kTg.v7i(()=>{this.reset()})}Tb(){this.ga.fb(Qc.a.Y2f,vc.a.view,this.U3i,97);this.ga.fb(Qc.a.Z2f,vc.a.view,this.U3i,97);this.ga.fb(Qc.a.MXh,vc.a.view,this.WVj,1028);this.ga.fb(Qc.a.aPa,vc.a.view,this.NXh,1028);this.ga.fb(Qc.a.vhb,vc.a.view,this.NXh,1028);this.P5j||(this.ga.fb(Qc.a.nlc,vc.a.view,this.nlc,96),this.ga.fb(Qc.a.rHb,vc.a.view,this.rHb,96))}Tto(b){new cK(this.ga,b,bt.Yna)}byl(b,h,u){1!==
u&&this.Tto(bt.zXa);return 32}static get uhb(){return null!=bt.fxg?bt.fxg:bt.fxg=Ga.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Yna(){bt.eBa||(bt.eBa=Ga.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return bt.eBa}reset(){bt.zXa=null!=bt.Yna?bt.Yna.E$a?Qc.a.aPa:Qc.a.vhb:Qc.a.aPa}}bt.zXa=Qc.a.aPa;bt.eBa=null;Object(m.a)(bt,"ExternalContentActor",null,[]);class dE extends vz{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){super(b,h,u,B,Q,ca,
qa,Qa,rb,Lb,Yb,gc);this.TUc=Fc;this.AMd=!1;this.qZg=null}r5c(){this.AMd||(super.r5c(),this.AMd=!0)}Tme(){this.AMd&&(super.Tme(),dE.eUh&&this.qZg&&dE.eUh.removeHandler(Rc.a.zua,this.qZg),this.AMd=!1)}jSb(){if(this.TUc){this.mva.C0&&this.mva.dismissFloatie();const b=new fx.a(0,v.AFrameworkApplication.isRtl);b.location=this.$5a.FPa();this.showFloatie(null,b)}else this.mva.C0&&v.AFrameworkApplication.va.processAction(Qc.a.rHb,2),v.AFrameworkApplication.va.processAction(Qc.a.nlc,2);this.Adc=!1}dismissFloatie(b){!this.uFe&&
(b&&(this.$5a.uBf(),this.xCj()),this.mva.C0||this.ILa)&&(this.ILa=!b,this.Tme(),this.TUc?this.mva.dismissFloatie():v.AFrameworkApplication.va.processAction(Qc.a.rHb,2))}showFloatie(b,h){h||(h=new fx.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.$5a.FPa());if(!h.location)return!1;this.ILa&&(this.ILa=!1,this.r5c());this.TUc?(b=Array(1),b.push("ExternalContent"),this.mva.showFloatie(this.$5a.FPa(),b,1)):v.AFrameworkApplication.va.processAction(Qc.a.nlc,2);return!0}zKc(){if(!this.Adc){const b=
new bf.a(3,1,this.hOh,()=>{this.jSb()},196);Bg.a.instance.Xb(b);this.Adc=!0}}xja(){this.TUc?this.mva.C0&&this.mva.dismissFloatie():v.AFrameworkApplication.va.processAction(Qc.a.rHb,2);this.zKc()}nPb(){this.TUc?this.mva.C0&&this.mva.dismissFloatie():v.AFrameworkApplication.va.processAction(Qc.a.rHb,2);this.zKc()}static get eUh(){return null!=dE.Rwg?dE.Rwg:dE.Rwg=Ga.a.instance.resolve("Box4.IEditStateEventManager")}}Object(m.a)(dE,"ExternalContentFloatieEventManager",vz,[]);class eE extends ys{constructor(b,
h,u,B,Q){super(b,h,u,B,Q)}nzh(){if(!this.ib||!this.ib.hb||!this.ib.hb.lb)return r.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.hb.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let u=b.node;if(u&&h&&!u.FJ){do u=this.Gdi(u);while(u&&!u.FJ&&Object(Cb.a)(wp.AParagraphNode,u)&&!u.characterData.trim().length)}let B="";const Q=Object(Na.a)(wp.AParagraphNode,u);Q&&(B=Q.characterData.length===b.cpBegin||h?Q.characterData.trimEnd():Q.characterData.substring(0,
b.cpBegin).trimEnd());h=Q?B.length:b.cpBegin;b=Object.assign(new BB,{zya:Object(Na.a)(134,(Q?Object(Na.a)(134,Q):Object(Na.a)(134,u))||b.node),phc:h});return this.xpf(b)}L9h(b,h){let u=null;const B=Object(Na.a)(196,b.zya.vj(h.$b));if(!B)return null;if(Object(Cb.a)(wp.AParagraphNode,b.zya)){const Q=Object(Na.a)(wp.AParagraphNode,b.zya);if(Q.UQ){if(b=Object(Na.a)(kt.a,me.ParagraphReader.HPa(Q)))(b=Object(Na.a)(196,b.vj(h.$b)))&&(u=b.getBounds()),u&&(u.height+=eE.V_h,u.width-=eE.MEl);return u}h=Object(Na.a)(105,
B);if(!h)return null;try{if(u=this.aua.E_(b.phc,h,0<b.phc,!1,!1,!1))u.height+=eE.V_h}catch(ca){r.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ca),u=null}}u||(u=B.getBounds());return u}}eE.V_h=65;eE.MEl=100;Object(m.a)(eE,"ExternalContentFloatiePositionProvider",ys,[]);class dK{constructor(b,h,u,B,Q,ca){this.z8f=(qa,Qa,rb)=>{if(1===rb)return v.AFrameworkApplication.UY||v.AFrameworkApplication.xF||v.AFrameworkApplication.opa||fc.SessionStatusManager.instance.Uj?
8:32;if(qa===Ob.a.print)qa=1;else if(qa===Qc.a.KLc)qa=0;else if(qa===Qc.a.ZKd)qa=2;else return 8;return this.t8n(qa)};this.ga=b;this.J6=h;this.vWb=u;this.d_j=B;this.eRg=Q;this.lWj=ca;this.NI=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback")}Tb(){v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.d_j||v.AFrameworkApplication.xF?(document.body.classList.add("WACStopPrinting"),""!==this.eRg&&this.lWj.tuo(this.eRg)):(this.ga.ra(Ob.a.print,vc.a.application,this.z8f),this.ga.ra(Qc.a.KLc,vc.a.application,
this.z8f),this.ga.ra(Qc.a.ZKd,vc.a.application,this.z8f))}t8n(b){const h=v.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Fb.App.xd&&Fb.App.xd.kC.Fo)return 8;this.vWb.mYd=!1;this.vWb.SIj.start();Km.a.iR(5,!0,Object(z.a)(this.vWb,this.vWb.K2n,"requestFileDownload"),Object(z.a)(this.vWb,this.vWb.aMb,"onForceSaveFailed"),b);this.aqe();return 32}aqe(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.NI&&(r.ULS.sendTraceTag(509145741,
306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.NI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(m.a)(dK,"FileDownloadActor",null,[]);class eK extends bi{constructor(b,h=null,u=null){super(b,!0,h,!1,void 0,u)}get Uyf(){return null}get l5a(){return this.LYd?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:v.AFrameworkApplication.L0a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get sec(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get xBd(){return null}get LYd(){return"VersionHistory"===
this.l5e?!1:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}q2d(){r.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");v.AFrameworkApplication.zia("tcopypdf;ccopypdf")}}Object(m.a)(eK,"DownloadAsPdfDialog",bi,[]);class ew{constructor(){this._url=this.vv=null;this.PYa=this.OYa=0;this.Wdb=!1;this.makeRequest=()=>{v.AFrameworkApplication.He.sj(this._url,1,null,null,!0,2,this.mMb,this.lqa,null)};this.mMb=b=>{ew.E6c();const h=
b.data.yja;let u=null;if(h)try{u=h.selectSingleNode("/docdata/status")}catch(B){}u&&("InProgress"===u.text&&22>this.OYa++||"ServiceBusy"===u.text&&3>this.PYa++)?this.XHa(1E3*(this.OYa+this.PYa)):this.vv(!0,u?u.text:null,b.data)};this.lqa=b=>{this.Wdb?(ew.cCa||(ew.Lbb=new Date,ew.cCa=!0,ew.nT=1),18E4>(new Date).getTime()-ew.Lbb.getTime()?this.retryOnFailure(4<=ew.nT?2E4:1E3):this.L2a(b.data)):4>ew.nT?this.retryOnFailure(2E3):this.L2a(b.data)}}send(b,h,u){this._url=b;this.vv=h;this.Wdb=u;this.makeRequest(null)}XHa(b){b=
new bf.a(2,1,b,this.makeRequest);v.AFrameworkApplication.oc.Xb(b)}retryOnFailure(b){this.XHa(b);ew.nT++}L2a(b){this.vv(!1,null,b)}static z8(b,h){(new ew).send(b,h,!1)}static E6c(){ew.cCa=!1;ew.nT=0}}ew.Lbb=null;ew.cCa=!1;ew.nT=0;Object(m.a)(ew,"ClientRequestWithRetry",null,[]);class fK extends Te{constructor(b){super(b,void 0,v.AFrameworkApplication.L0a)}get l5a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get sec(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get lZc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get iKc(){return v.AFrameworkApplication.L0a?
"UIFontDialogTextLarge":null}q2d(){r.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}ILf(){r.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}HZc(){r.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get SYc(){return nB.fRi}get Klb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get nNi(){return!v.AFrameworkApplication.L0a}}Object(m.a)(fK,"DownloadAsOdtDialog",Te,[]);class gK{constructor(b,h){this.Dab=this.HZa=
null;this.Q7a=u=>{1===Fb.App.za.state||this.HZa||(this.HZa=(new ci.a).create(),u=u.customData,this.B1m(u),1===u?this.HZa.message=this.Ntb.bR.isEnabled?v.AFrameworkApplication.L0a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:u?2===u&&(this.HZa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.HZa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.HZa.GL(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.mYd=!0};this.M9=(u,B,Q)=>{this.Yhg("Success. Save and Conversion Complete.");Q=new bb.QueryStringBuilder(Q.request.get_url());v.AFrameworkApplication.aga(Q);Q=Q.toString();const ca=this.Z2n(Q);this.Hna(ca);2!==ca&&this.Ntb.GFn();!u||B?this.K5(ca):this.mYd?(this.mYd=!1,this.Dab=null):(this.Dab&&v.AFrameworkApplication.oc.Ze(this.Dab),this.Dab=null,this.Mnl(Q,ca))};this.mYd=!1;this.Ntb=b;this.SIj=h.ORa("UserAction","WordEditorForceSaveAndPrint")}Hna(b){this.HZa&&
(this.L1m(b),this.HZa.close(),this.HZa=null)}K5(b){if(1!==Fb.App.za.state){this.F2m(b);const h=new mg.StandardDialog;h.Cd=0;h.xe(1,CommonUIStrings.l_DialogClose);h.rx(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}Hsf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return r.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}K2n(b){var h=v.AFrameworkApplication.rootQuerySignature;
h&&""!==h?(h="WordViewer/request."+this.Hif(b)+"?"+h+"&type="+this.Hsf(b)+"&rndm="+yb.a.create(),1===b&&this.Ntb.Mso()&&(h+="&useNamedAction=1"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&kp.FontUtils.lhe()&&(1===b||!b)&&(0<kp.FontUtils.SNh&&(h+="&cfcVer="+kp.FontUtils.SNh),kp.FontUtils.RNh&&(h+="&cfcUrl="+kp.FontUtils.RNh),kp.FontUtils.TNh&&(h+="&cfcEncData="+kp.FontUtils.TNh)),ew.z8(h,this.M9),this.Dab||(this.Dab=new bf.a(2,1,500,this.Q7a),this.Dab.customData=
b,v.AFrameworkApplication.oc.Xb(this.Dab))):(this.Yhg("failed. QuerySignature is empty."),this.K5(b))}Hif(b){return 2===b?"odt":"pdf"}aMb(){this.Yhg("Failed. force save failed.")}Z2n(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;r.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}Yhg(b){r.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.SIj.stop()}Mnl(b,h){const u=new zb.a;u.add("access_token");u.add("access_token_ttl");1!==Fb.App.za.state&&(1===h?this.Ntb.cvo(b,u):h?2===h&&new fK(b):new eK(b))}dispose(){}B1m(b){switch(b){case 0:r.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:r.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:r.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:r.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}L1m(b){switch(b){case 0:r.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:r.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:r.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:r.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}F2m(b){switch(b){case 0:r.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:r.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:r.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:r.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(m.a)(gK,"FileDownloadManager",null,[]);class fE{get key(){return"LIST"}get Xw(){return Box4Intl.Box4Strings.l_ListContentTitle}Hnc(b){let h=null;const u=fE.Fd.tw(b);if(!u)return{returnValue:!1,nna:h};b=this.V0l(b,u);h=Object.assign(new Gy.a,{TG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,nna:h}}sFb(b,h){b=b.contentObject;const u=this.D_l(b.Sx),B=new Ck.a;h?(h=h.contentObject,h.level!==b.level?(B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),B.add(u)):h.id.equals(b.id)&&h.Sx.listType===b.Sx.listType||B.add(u)):(B.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),B.add(u));return B.toArray().join(" ")}D_l(b){let h="";const u=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Ou);else if(1===b.listType)switch(u){case 1:h=this.$xh;break;case 2:h=this.MNk;break;case 3:h=this.NNk;break;default:h=
this.$xh}return h}static get Fd(){return null!=fE.HCg?fE.HCg:fE.HCg=Ga.a.instance.resolve("Box4.List.IListReader")}}Object(m.a)(fE,"ListDetailsProvider",null,[534,336]);class hK{constructor(){this.Sx=this.listId=this.id=null;this.level=0}}Object(m.a)(hK,"ListItemInfo",null,[]);class iK extends fE{constructor(b){super();this.S6=b}get $xh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get MNk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get NNk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}V0l(b,
h){const u=this.S6.DB(b);return Object.assign(new hK,{id:b.currentNode.id,listId:new W.a(yb.a.nil,u.listID),Sx:h,level:u.level+1})}}Object(m.a)(iK,"FlatListDetailsProvider",fE,[]);class jK{constructor(b,h){this.ga=b;this.Ef=h}get uc(){return null!=this.qIg?this.qIg:this.qIg=Ga.a.instance.Oa("Box4.Styles.IWACStyleReader")}Tb(){}}Object(m.a)(jK,"FormattingActor",null,[]);var MM=c(1169),OE=c(1331),NM=c(1713);class kK{constructor(b,h,u,B,Q,ca,qa,Qa){this.Gb=b;this.Ygk=h;this.Kc=u;this.avb=B;this.Jo=Q;
this.Ga=ca;this.od=qa;this.O6j=Qa}xgc(b,h,u,B,Q,ca,qa){r.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:qa.li});this.avb.then(()=>{this.Ygk(b.data.se);r.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:qa.li});qa.stop()})}lqa(b,h,u,B,Q,ca,qa){ca.stop();Q();qa?(this.iAn(h,u),r.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:Dd.ImageReader.KPa(h.Gb)})):r.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Dd.ImageReader.KPa(h.Gb)})}ash(b,h){b.ye(wG.a.Q9e,"1");if(this.od&&this.od.isFeatureEnabled(51)){var u=this.Jo.nn(h.ek);u=this.Jo.vi(u);b.ye(fh.a.Is,OE.a[u]);5===u&&this.cCk(b,h)}this.O6j&&b.ye(fh.a.sWd,"true")}Klh(){return new NM.a(this.Gb.id,this.Gb)}gTd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}iAn(b,h){const u=this.Kc.Pc(7,Ob.a.Ikm);u.Db(h);
b.Gb.setValue(Jc.a.jHh,!0);u.dispose()}cCk(b,h){var u=h.ek;h=this.Jo.nn(u);var B=u.node;const Q=(u=this.Jo.iFa(h,B.Lc,!1))?this.Jo.bFa(u):"";if(""===Q)throw r.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");B=(B=this.Jo.iFa(h,B.Lc,!0))?this.Jo.bFa(B):"";b.ye(fh.a.Pgc,Q);b.ye(fh.a.WIj,B);u=u.ja(xh.a.RYh,"");""!==u&&b.ye(fh.a.extension,u);b.ye(fh.a.width,this.Jo.iF(h).toString());b.ye(fh.a.height,this.Jo.EG(h).toString());
b.ye(fh.a.Z2c,this.Jo.Uib(h).toString());u=this.Ga.$("WordEditorImageCropIsEnabled");b.ye(fh.a.dNh,u.toString());u&&(u=this.Jo.mca(h),b.ye(fh.a.top,u.top.toString()),b.ye(fh.a.bottom,u.bottom.toString()),b.ye(fh.a.left,u.left.toString()),b.ye(fh.a.right,u.right.toString()));u=this.Ga.$("WordEditorImageRotateIsEnabled");b.ye(fh.a.qej,u.toString());u&&(b.ye(fh.a.angle,this.Jo.h0(h).toString()),b.ye(fh.a.flipH,this.Jo.lZ(h,Jc.a.kSc,!1)?"true":"false"),b.ye(fh.a.flipV,this.Jo.lZ(h,Jc.a.ySc,!1)?"true":
"false"));b.ye(fh.a.JUh,"true")}}Object(m.a)(kK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[579]);class lK{constructor(){this.kLa=null}IIk(b){this.kLa=b}teardown(){null!=this.kLa&&(this.kLa.teardown(),this.kLa=null);this.YNe=null}getGraphicData(){return this.kLa?this.kLa.getGraphicData():null}vWn(){null!=this.YNe&&this.setGraphicData(this.YNe)}setGraphicData(b){this.YNe=b;if(this.kLa)try{this.kLa.setGraphicData(b)}catch(h){r.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else r.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.kLa?this.kLa.hasEdits():!1}}Object(m.a)(lK,"GraphicsEditorGC2HostUser",null,[581]);var OM=c(1714),PM=c(1091),QM=c(1380),RM=c(795),SM=c(1472),TM=c(1090);class mK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(m.a)(mK,"GC2ScriptLoader",null,[]);class tH{constructor(b,
h,u){this.qve=b;this._context=h;this.IMa=u}closeEditor(){this.qve&&(this.qve(),this.qve=null)}logActivity(b,h,u,B){Fe.a(b,h,u,B)}logTrace(b,h,u,B){r.ULS.sendTraceTag(575522531,3001,tH.h6m(h),B)}isEnabled(b){const h=v.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ga.a.instance.resolve("Box4.IFontServiceParser").z1a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=kp.FontUtils.$lf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(u=>"premium"!==
u.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return xa.Health.instance}getFonts(b){const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),u=h?"msofp_hier":"msofp",B=`${Ga.a.instance.resolve("Box4.IFontServiceParser").z1a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(u,B);kp.FontUtils.smh();kp.FontUtils.Umh({});b=kp.FontUtils.Zlf(()=>!1,(Q,ca)=>ca).MenuSectionList;h&&0<b.length&&(b.pop(),
b.push(this.K2k()));return b}K2k(){const b=kp.FontUtils.$lf(()=>!1,()=>"").fonts.map((h,u)=>{const B=h.name;h=h.displayName;const Q=kp.FontUtils.Dpa(B);return Object.assign(new vE.a,{MenuItemId:kp.FontUtils.rgj+u,CommandValueId:B,LabelText:h||B,Styles:{["optionText"]:{["fontFamily"]:h&&!Q?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:B})});return Object.assign(new wh.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=
this._context.ek;var u=Dd.ImageReader.nn(h);if(this.XLm(u,h,b)&&(u=Dd.ImageReader.lZ(u,$c.a.pqa,""),u.length))return Promise.resolve(u);u=new bb.QueryStringBuilder("/we/GetImage.ashx?");u.M1b(h.node.Ui().vr);u.ye(fh.a.lJd,b);v.AFrameworkApplication.aga(u);u.ye(fj.a.Grb,"1");ui.a.instance.rAb(u);u.ye(fh.a.fOh,"true");const B=u.toString();return new Promise((Q,ca)=>{this.IMa.sj(B,1,null,null,!1,2,qa=>{Q(qa.data.se)},qa=>{ca(qa.data.Qe.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=
xk.a.sg("progress.gif");b.PictureInvalid=xk.a.sg("CancelRequest.32x32x32.png");return b}getTheme(){const b=Zo.PageNavigator.instance.ru(this._context.view.ed).properties.ja(Jc.a.gle,"");return 0===b.length?[]:b.split(" ").map(h=>Fb.App.VBb[h])}static h6m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}XLm(b,h,u){const B=h.node.Lc;h=Dd.ImageReader.kSd(b,B,!1);b=Dd.ImageReader.kSd(b,B,!0);return u===h||u===b}}Object(m.a)(tH,"GraphicsEditorApp",
null,[606]);class nK extends Hf.a{constructor(b,h,u,B,Q){super(!1,!1,!0);this.closeEditor=()=>{this.LHh();this.dispose()};this.Vba=ca=>{this.LHh(2===ca)};this.Vab=b;this.w3j=h;this.mYg=u;this._context=B;this.IMa=Q}juo(b){return new Promise((h,u)=>{this.Qh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.Vba,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(B,Q)=>this.QJk(Q,b),["onload"]:B=>{this.onLoad(B,h,u)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.Vab.vWn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,u){b?(this.Vab.IIk(b),h(b)):(r.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),u(null))}QJk(b,h){const u=v.AFrameworkApplication.K,B=TM.a();B.loadScriptWithRetryHandler=b;const Q=new tH(this.closeEditor,this._context,this.IMa),ca={["bootConfig"]:Object.assign(new QM.a,
{scriptBaseUrl:HE.AppChromeOverrideUtilities.isEnabled?HE.AppChromeOverrideUtilities.VRd(v.AFrameworkApplication.lcid):v.AFrameworkApplication.R5+v.AFrameworkApplication.lcid+"/",isMLRRibbonMode:v.AFrameworkApplication.ua.Lb.blc,isCombinedBundleEnabled:v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new mK(new PM.DynamicScriptLoader(B)),["publicPath"]:v.AFrameworkApplication.R5,["appSettings"]:u.appSettings,["logger"]:new hm.a,["featureGateManager"]:Object.assign(new RM.a,
{getBooleanFeatureGate:Object(z.a)(u,u.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(u,u.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(u,u.getStringFeatureGate,"getStringFeatureGate")}),["app"]:Q,["resolveScript"]:(qa,Qa)=>SM.a.resolveScript(qa,Qa),["initialTabId"]:h};u.$("DynamicBundlesIsEnabled")&&(h=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ca.dynamicBundlesPath=
HE.AppChromeOverrideUtilities.isEnabled?HE.AppChromeOverrideUtilities.Kjc+h:u.kb("StaticContentUrl")+h);return new Promise((qa,Qa)=>{b("gc2",v.AFrameworkApplication.Rz("gc2.js",5),"anonymous",5,!1).then(()=>{qa(ca)}).catch(()=>{r.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Qa(null)})})}LHh(b){b=this.Vab.hasEdits()&&!b;this.w3j(b?this.Vab.getGraphicData():null,!!this.mYg,this.mYg,b)}}Object(m.a)(nK,"ReactGraphicsEditorDialog",Hf.a,[]);class oK{constructor(b,
h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc,ld=!1){this.g2h=ld;this.avb=this._context=null;this.kuo=(Hd,Ie,fe,de,ne)=>{var ye,Vf,Og;const Bl=!!ne&&Object(Cb.a)(W.a,ne);try{if(1===fe){const op=Ie.view;return this.Rj.uga(Ie)&&op.features.Xje?32:8}this.i7j=4===(null===ne||void 0===ne?void 0:ne.InputMethod)?!0:!1;Fb.App.instance&&Fb.App.instance.QIb&&(this.g2h||MM.a.qhb(()=>{this.g2h=!0}));r.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Bl}`);performance.mark("LaunchStart");this._context=
Ie;const sm=new nK(this.Vab,this.vUf,Bl?ne:null,Ie,this.Wf);Hd=null;if(Bl&&(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const op=null===(Og=null===(Vf=Ie.view.mb)||void 0===Vf?void 0:Vf.hb)||void 0===Og?void 0:Og.lb;if(null===op||void 0===op?0:op.VH)Hd="Draw"}this.avb=sm.juo(Hd).then(()=>{r.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Bl}`)}).catch(()=>
{this.YRh()});if(!Bl){const op=oB=>{this.avb.then(()=>{this.BWi(oB,!1)})};if(v.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return op(JSON.stringify({elements:[]})),32;let zv=null;zv=Zo.PageNavigator.instance.ru(Ie.view.ed);const XC=zv.properties.ja(Jc.a.h2h,"");if(0<XC.length)return op(XC),32;this.RBe.qbo(Ie,W.a.create(),yb.a.create()).then(oB=>{const WD=this.Kc.Pc(0,Ob.a.LRc);WD.Db(zv);zv.setValue(Jc.a.h2h,oB);WD.dispose();
op(oB);return null}).catch(oB=>{r.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",oB.toString(),Bl);this.YRh()})}return 32}catch(sm){return r.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",sm.toString(),Bl),8}};this.rmm=(Hd,Ie,fe,de,ne)=>{if(!Ie.view.features.Xje)return 32;r.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.aUh(ne,Ie);return 32};
this.qmm=(Hd,Ie,fe,de,ne)=>{var ye,Vf,Og;const Bl=Ie.view;if(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(ye=null===(Og=null===(Vf=null===Bl||void 0===Bl?void 0:Bl.mb)||void 0===Vf?void 0:Vf.hb)||void 0===Og?void 0:Og.lb,null===ye||void 0===ye||!ye.M3a)return 8;return this.Cki(Hd,Ie,fe,de,ne)};this.Cki=(Hd,Ie,fe)=>{if(1===fe)return Ie.view.features.Xje?32:8;if(2===fe){Hd=Dd.ImageReader.nn(Ie.ek);if(!Hd)return 2;
r.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.aUh(Hd,Ie);return 32}return 2};this.BWi=(Hd,Ie=!0)=>{this.Vab.setGraphicData(Hd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Hd=performance.getEntriesByName("EditorLaunch");r.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${Ie} Duration: ${Hd[Hd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.vUf=(Hd,Ie,fe,de)=>{var ne;this.Vab.teardown();if(Ie&&this._context){var ye=this._context.view.mb.ng,Vf=ye.node;ye.Vk&&me.ParagraphReader.Wb(Vf)&&(ye=null===(ne=this.w7)||void 0===ne?void 0:ne.FA(Vf),27==(null===ye||void 0===ye?void 0:ye.role)&&r.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",de,de?" Everything deleted: "+(0==(null===Hd||void 0===Hd?void 0:Hd.json.length)):""))}if(de)if(r.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Hd)if(de=Hd.json,ne=Hd.width,Vf=Hd.height,de.length||Ie)if(!de.length&&Ie)if(Ie=this._context.ek){Ie=Ie.node;if(Dd.ImageReader.h9(Ie)){if(!this.Rj.OWn(Ie,new vd.GraphIterator,ti.a.instance,aK.DeleteActor.w1b)){r.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Rj.Hic(Ie,fe,this.gb,this.TV)){r.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}r.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else r.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ye=new OM.a(this._context,v.AFrameworkApplication.ua.hQa,!0,this.Rj,this.Ga,Zo.PageNavigator.instance),Hd=yb.a.create(),fe=new zJ.a(ye,de,this.lK,this.Lm,Hd,$k.a.instance,Ie,fe,this.Rj,this.Jo,ne,Vf,this.Ga,this.TV,this.od,Fb.App.instance.QIb,Fb.App.instance.wzf),this.RBe.Kag(fe,this._context,Ie,Hd),this.Gra(),this.i7j&&this.uLo();else r.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else r.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else r.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ga=h;this.RBe=u;this.Rj=B;this.lK=Q;this.Lm=ca;this.Vab=new lK;this.Kc=Qa;this.gb=rb;this.TV=Lb;this.Jo=Yb;this.od=Fc;this.Wf=gc;this.w7=Sc}Tb(){var b;let h=!0;this.Ga.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.od&&this.od.isFeatureEnabled(51));
h&&!Z.a.Kt&&(this.ga.fb(Qc.a.Fvf,vc.a.view,this.kuo,4),this.ga.fb(Ob.a.$ff,vc.a.view,this.rmm,4),this.ga.fb(Qc.a.cUh,vc.a.view,this.qmm,4),(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.fb(Qc.a.J6b,vc.a.view,this.Cki,4))}YRh(){const b=new mg.StandardDialog;b.Cd=0;b.rx(kl.a.Pff,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Fb.App.za.updateCommandUI()}aUh(b,
h){var u=b.ja(Sh.a.w5,1);const B=b.ja(xh.a.s0,0);u&&1!==B?b.ja(Jc.a.jHh,!1)?(h=new mg.StandardDialog,h.Cd=0,h.rx(kl.a.Pff,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Fb.App.za.updateCommandUI(),r.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Dd.ImageReader.KPa(b)})):(this.ga.Rb(Qc.a.Fvf,2,b.id),this.avb||(r.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),
this.avb=new Promise(Q=>{Q(null)})),u=yb.a.create(),b=new kK(b,this.BWi,$k.a.instance,this.avb,this.Jo,this.Ga,this.od,Fb.App.instance.HU(this.Jo.vi(b))),this.RBe.Kag(b,h,!0,u)):r.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Gra(){const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):r.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}uLo(){const b=
Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):r.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(m.a)(oK,"GraphicsEditorActor",null,[]);var UM=c(519);class pK{constructor(b,h,u){this.SWa="wwaengidc";this.Zhd="CreateLinkForHeading";this.RYj="CreateLinkForHeadingAction";this.Z_j="\ufffc";this.EWa=b;this.ga=h;this.gb=u}Tb(){this.ga.ra(Qc.a.NJc,vc.a.paragraph,this.Saf.bind(this));this.ga.ra(Qc.a.NJc,
vc.a.Jd,this.Saf.bind(this));this.ga.ra(Qc.a.NJc,vc.a.Tc,this.Saf.bind(this));this.ga.Xc(Qc.a.NJc,1028)}Saf(b,h,u){b=h.node;if(1===u)return this.fyi(b)?32:8;this.JPn(this.Zhd,this.RYj);if(!this.fyi(b))return r.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;u=b.getValue(Jc.a.Wc);if(!u)return r.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),u=new Map,u.set("Source",this.Zhd),u=Object.assign(new Ub.a,{additionalValues:u}),
xa.Health.instance.recordKpiFailure(this.Zhd,"Unable to create sharable link as paragraph id is missing",!1,!0,u),8;this.MKh(u);return 32}MKh(b){b=String.format('{{"{0}":"{1}"}}',UM.a.heading,b);this.ga.Rb(Za.a.K8,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}fyi(b){return!this.gb.Wb(b)||this.gb.icc(b)||this.gb.NIb(b)||b.Dr||""===b.characterData||b.characterData===this.Z_j||!this.EWa.eRd(b)?!1:!0}JPn(b,h){const u=new Map;u.set("Source",this.Zhd);u.set("Action",h);xa.Health.instance.recordKpiUsage(b,
0,this.SWa,u)}}Object(m.a)(pK,"HeadingsActor",null,[]);class qK{nro(b){return me.ParagraphReader.jva(this.k9h(b))}z8c(b,h,u){if(b=me.ParagraphReader.HPa(this.k9h(b)))h=b.pe(h),Object(Cb.a)(572,h)&&(eB.m(b)?h.Clo(u):h.z8c())}k9h(b){return b&&b.Vk&&b?b.node:null}}Object(m.a)(qK,"IFrameFocusStrategy",null,[573]);class rK{constructor(b){this.uCa=null;this.ymd=b}LJi(){r.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}xBj(b){if(!b)return r.ULS.sendTraceTag(25007836,375,15,"Error range is null"),
!1;if(!b.errorDetails)return r.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return r.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.uCa=F.a.sle(b.errorDetails.token,b.errorDetails.lcid);this.ymd.add(this.uCa,b.errorDetails.lcid);return!0}whe(b){return b?b.token?F.a.sle(b.token,b.lcid)===this.uCa:(r.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),
!1):(r.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(m.a)(rK,"IgnoreAllProofingErrorStrategy",null,[571]);var VM=c(1389),WM=c(573),sK=c(534);class tK{constructor(b,h){this.filename=b;this.blob=h}}Object(m.a)(tK,"UploadBlobParameters",null,[]);class uK extends Id{constructor(b,h,u,B,Q,ca,qa,Qa=null){super(b,h,u,null,Q,ca,!1);this.r8j="DragAndDrop";this.NTg="FileName";this.QTg=0;this.njh=null;this.Vne=this.m6b=!1;this.WRg=B;this.X$g=Qa}get vP(){return this.r8j}get fileExtension(){return this.NTg}get fileSize(){return this.QTg}get QGj(){return this.njh}dad(b){const h=
new tK(this.WRg.name,this.WRg);b.bvj(h);this.njh=b.Tdb}ePa(b,h){this.X$g&&this.X$g();super.ePa(b,h)}D_o(b){const h=!!b&&this.gAa(b.name,null)&&this.Qpg(b,null);b&&(this.NTg=b.name,this.QTg=b.size);h||this.r2d();return h}}Object(m.a)(uK,"DragDropInsertImageUploader",Id,[]);class ct{constructor(b,h,u,B,Q,ca,qa){this.wTc=ca;this.jS=qa;this.y3d=this.z3d=this.Y3d=this.Z3d=0;this.ga=null;this.Fff=(Qa,rb,Lb)=>{if(Fb.App.pKd)return 8;Qa=rb.node;return 1===Lb?Qa?32:2:2===Lb?(Lb=Dd.ImageReader.nn(rb),rb=Dd.ImageReader.BQc(Lb,
rb.node.Ui().vd,v.AFrameworkApplication.K,v.AFrameworkApplication.ua.hQa),My(rb),32):2};this.jCm=(Qa,rb,Lb)=>{var Yb;const gc=this.Rj.uga(rb);if(2===Lb&&gc){if(Ob.a.yR===Qa||Ob.a.HEd===Qa)v.AFrameworkApplication.Ppa?v.AFrameworkApplication.ngg():((null===(Yb=v.AFrameworkApplication.K)||void 0===Yb?0:Yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&pv.a.instance.I6a("PictureLocal"),this.Abl(rb));return 32}return 1!==Lb||Ob.a.yR!==Qa&&Ob.a.HEd!==Qa?2:gc?32:2};this.cIb=
(Qa,rb,Lb,Yb,gc)=>this.Rj.uga(rb)?1===Lb?32:this.Rj.bBf(rb,gc)?32:2:2;this.Uko=()=>{if(this.ib&&this.ib.hb&&this.ib.hb.lb){const Qa=this.ib.hb.lb.Pa;Qa&&this.ib.Bc(Cg.SelectionFactory.ne(Qa.node,Qa.cpBegin))}};this.arl=(Qa,rb,Lb,Yb,gc)=>{r.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Qa=gc.DataTransfer)&&Qa.files&&0<Qa.files.length){r.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Qa.files.length));for(Lb=0;Lb<Qa.files.length;Lb++)Yb=Qa.files[Lb],0<=F.a.Zg(Yb.type).indexOf("image")&&
this.wBm(Yb,rb)&&(Yb=this.ib.hb.lb.Pa,this.ib.Bc(Cg.SelectionFactory.ne(Yb.node,Yb.cpBegin+1)));this.MJa();return 32}r.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.NAn=(Qa,rb,Lb,Yb,gc)=>{if(2===Lb)return v.AFrameworkApplication.va.Kf(rb.ek,Qa,Lb,!0,Yb,gc);if(!rb.view.qe)return 8;Qa=rb.view;if(!Qa.mb)return 8;Qa=ct.Xg.tO(Qa.mb.ng);return 1===Qa.length&&this.sO(Qa[0])?(this.x4m(),this.VXc||ct.A_f(!0),32):8};this.flm=(Qa,rb,Lb)=>{if(!this.sO(rb))return 8;
const Yb=Dd.ImageReader.nn(rb),gc=Dd.ImageReader.iF(Yb),Fc=Dd.ImageReader.EG(Yb);Qa=Qa===Ob.a.IUd;r.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Qa});if(1===Lb)return this.wi.D4||Dd.ImageReader.b4a(Yb)?2:Qa&&gc<this.z3d&&Fc<this.y3d||!Qa&&gc>this.Z3d&&Fc>this.Y3d?32:2;Lb=Qa?1.1:.9;this.setSize(Yb,rb,gc*Lb,Fc*Lb,!0);return 32};this.Zhc=(Qa,rb,Lb,Yb,gc)=>{if(!this.Nma(rb))return 8;Qa=Dd.ImageReader.nn(rb);rb=Dd.ImageReader.gFa(Qa);Lb=Dd.ImageReader.fFa(Qa);if(0>=rb||0>=Lb)return 2;
Qa=Dd.ImageReader.iF(Qa)/rb*100;gc.setValue($c.a.DTc,Qa);return 32};this.Dac=(Qa,rb,Lb,Yb,gc)=>{if(!this.Nma(rb))return 8;Qa=Dd.ImageReader.nn(rb);if(1===Lb)return this.wi.D4||Dd.ImageReader.b4a(Qa)?2:32;r.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Lb=gc.ja($c.a.DTc,-1)/100;Yb=gc.ja($c.a.Poi,!1);const Fc=gc.ja($c.a.qzf,!0);gc=gc.ja($c.a.rzf,!0);if(0>=Lb)return ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.nIb}),2;const Sc=Dd.ImageReader.gFa(Qa),ld=Dd.ImageReader.fFa(Qa),Hd=Dd.ImageReader.iF(Qa),
Ie=Dd.ImageReader.EG(Qa);if(0>=Sc||0>=ld)return ct.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.nIb}),2;Yb?(Yb=Fc?Lb*Hd:Hd,Lb=gc?Lb*Ie:Ie):(Yb=Fc?Lb*Sc:Hd,Lb=gc?Lb*ld:Ie);this.setSize(Qa,rb,Yb,Lb);Fb.App.xd.So&&Fb.App.xd.Yp.$F(rb.node);this.MJa();return 32};this.MNb=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;Qa=Dd.ImageReader.nn(rb);Qa=Dd.ImageReader.EG(Qa);if(0>=Qa)return 2;gc.setValue($c.a.AFa,Qa);return 32};this.AFa=(Qa,rb,Lb,Yb,gc)=>{if(!this.Nma(rb))return 8;Qa=Dd.ImageReader.nn(rb);if(1===Lb)return this.wi.D4||
Dd.ImageReader.b4a(Qa)?2:32;r.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Lb=gc.ja($c.a.AFa,0);gc=Dd.ImageReader.a4a(Qa);if(0>=Lb)return ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.nIb}),2;Yb=Dd.ImageReader.gFa(Qa);const Fc=Dd.ImageReader.fFa(Qa),Sc=Dd.ImageReader.iF(Qa);var ld=Dd.ImageReader.EG(Qa);ld=Sc/ld;if(0>=Yb||0>=Fc)if(ct.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.nIb}),this.$oj(Qa))return 2;this.setSize(Qa,rb,gc?Lb*ld:Sc,Lb);Fb.App.xd.So&&Fb.App.xd.Yp.$F(rb.node);Fb.App.za.updateCommandUI();
return 32};this.NNb=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;Qa=Dd.ImageReader.nn(rb);Qa=Dd.ImageReader.iF(Qa);if(0>=Qa)return 2;gc.setValue($c.a.BFa,Qa);return 32};this.BFa=(Qa,rb,Lb,Yb,gc)=>{if(!this.Nma(rb))return 8;Qa=Dd.ImageReader.nn(rb);if(1===Lb)return this.wi.D4||Dd.ImageReader.b4a(Qa)?2:32;r.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Lb=gc.ja($c.a.BFa,0);gc=Dd.ImageReader.a4a(Qa);if(0>=Lb)return ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.nIb}),2;Yb=Dd.ImageReader.gFa(Qa);
const Fc=Dd.ImageReader.fFa(Qa);var Sc=Dd.ImageReader.iF(Qa);const ld=Dd.ImageReader.EG(Qa);Sc=ld/Sc;if(0>=Yb||0>=Fc)if(ct.Hc.Yb(pd.a.U1,{["Reason"]:pe.a.nIb}),this.$oj(Qa))return 2;this.setSize(Qa,rb,Lb,gc?Lb*Sc:ld);Fb.App.xd.So&&Fb.App.xd.Yp.$F(rb.node);Fb.App.za.updateCommandUI();return 32};this.PNb=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;Qa=Dd.ImageReader.nn(rb);Qa=Dd.ImageReader.a4a(Qa);gc.setValue($c.a.lY,Qa);return 32};this.lY=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;Qa=Dd.ImageReader.nn(rb);
if(1===Lb&&this.wi.D4)return 2;Fb.App.xd.So&&Fb.App.xd.Yp.$F(rb.node);gc&&(rb=gc.ja($c.a.lY,!0),r.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Rj.hkj(Qa,rb),Fb.App.za.updateCommandUI());return 32};this.t6a=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;Qa=Dd.ImageReader.nn(rb);Qa=Dd.ImageReader.PX(Qa);gc.setValue($c.a.Jjb,Qa);return 32};this.Jjb=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;if(1===Lb)return this.wi.D4?2:32;if(Fb.App.xd.So&&(Qa=rb.node.ja(Sh.a.MJ,gk.a.Nt),Qa!==
gk.a.Nt&&(Qa=Fb.App.xd.Yp.Jib(Qa),sK.CoauthLockEditor.getInstance().I7a(Qa))))return ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),2;Qa=Dd.ImageReader.nn(rb);gc=gc.ja($c.a.Jjb,null);this.Rj.bho(Qa,rb,gc);r.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Pd.Us(13);return 32};this.s6a=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;Qa=Dd.ImageReader.nn(rb);Qa=Dd.ImageReader.JPa(Qa);gc.setValue($c.a.kY,Qa);return 32};this.kY=(Qa,rb,Lb,Yb,gc)=>{if(!this.sO(rb))return 8;if(1===Lb)return this.wi.D4?
2:32;if(Fb.App.xd.So&&(Qa=rb.node.ja(Sh.a.MJ,gk.a.Nt),Qa!==gk.a.Nt&&(Qa=Fb.App.xd.Yp.Jib(Qa),sK.CoauthLockEditor.getInstance().I7a(Qa))))return ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),2;Qa=Dd.ImageReader.nn(rb);gc=gc.ja($c.a.kY,null);this.Rj.aho(Qa,rb,gc);r.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Pd.Us(13);return 32};this.h7a=(Qa,rb,Lb)=>{var Yb,gc;if(1===Lb)return 32;if(!rb.view.qe)return r.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Qa),
8;rb=rb.view;Lb=null===(gc=null===(Yb=rb.mb)||void 0===Yb?void 0:Yb.hb)||void 0===gc?void 0:gc.J(0);if(!Lb)return r.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Qa),8;gc=Lb.Pa;Yb=this.jS.Vf("UserAction",Qa.toString());let Fc;Qa==Ob.a.iag?Fc=this.wTc.h7a(gc,2):Qa==Ob.a.lag?(Fc=this.wTc.h7a(gc,0),5==Fc&&(Fc=this.wTc.h7a(gc,2))):Qa==Ob.a.mag&&(Fc=this.wTc.h7a(gc,1),5==Fc&&(Fc=this.wTc.h7a(gc,3)));switch(Fc){case 4:gc=32;rb.z5();break;case 5:gc=2;break;default:gc=8}Yb.stop();r.ULS.sendTraceTag(512267789,
322,50,"Select image: {0}. Duration: {1}. Action: {2}",Fc,Yb.li,Qa);return gc};this.Rj=b;this.Zm=h;this.Pd=u;this.Qg=B;this.ib=Q;this.og=Re.a.getInstance(Xl.a)}get wi(){return Df.PageReader.instance}get aca(){return this.Zm.instance}get nc(){return this.ga}Ozm(){this.Z3d=kf.a.Kl(1,0);this.Y3d=kf.a.Kl(1,1);this.z3d=kf.a.Kl(1920,0);this.y3d=kf.a.Kl(1280,1)}Tb(b){this.ga=b;const h=this.NAn,u=this.jCm,B=this.cIb,Q=this.flm;b.fb(Ob.a.yR,vc.a.view,u,1284);b.ra(Ob.a.cIb,vc.a.Tc,B);b.ra(Ob.a.iag,vc.a.view,
this.h7a);b.ra(Ob.a.lag,vc.a.view,this.h7a);b.ra(Ob.a.mag,vc.a.view,this.h7a);b.ra(Ob.a.cIb,vc.a.image,B);b.Xc(Ob.a.cIb,1284);b.fb(Ob.a.HEd,vc.a.view,u,1284);b.fb(Ob.a.e6e,vc.a.view,h,1028);this.rr(b,Ob.a.IUd,Q);this.rr(b,Ob.a.Agg,Q);this.rr(b,Ob.a.Zhc,this.Zhc);this.rr(b,Ob.a.MNb,this.MNb);this.rr(b,Ob.a.NNb,this.NNb);this.rr(b,Ob.a.t6a,this.t6a);this.rr(b,Ob.a.s6a,this.s6a);this.rr(b,Ob.a.Dac,this.Dac);this.rr(b,Ob.a.$fe,this.AFa);this.rr(b,Ob.a.age,this.BFa);this.rr(b,Ob.a.D8c,this.Jjb);this.rr(b,
Ob.a.HPb,this.kY);this.rr(b,Ob.a.PNb,this.PNb);this.rr(b,Ob.a.lY,this.lY);this.rr(b,Ob.a.Fff,this.Fff);b.fb(Ob.a.KTh,vc.a.view,this.arl,4);b.Xc(Ob.a.IUd,4);b.Xc(Ob.a.Agg,4);b.Xc(Ob.a.Zhc,69);b.Xc(Ob.a.MNb,69);b.Xc(Ob.a.NNb,69);b.Xc(Ob.a.PNb,69);b.Xc(Ob.a.t6a,69);b.Xc(Ob.a.s6a,69);b.Xc(Ob.a.lY,4);b.Xc(Ob.a.Dac,4);b.Xc(Ob.a.$fe,4);b.Xc(Ob.a.age,4);b.Xc(Ob.a.D8c,4);b.Xc(Ob.a.HPb,4);this.Ozm();this.VXc&&xf.a.instance.Sw(this.yQk)}rr(b,h,u){b.ra(h,vc.a.image,u);b.ra(h,vc.a.EEb,u);b.ra(h,vc.a.Jd,u);b.ra(h,
vc.a.M7,u)}Abl(b){new Id(b,Bg.a.instance,v.AFrameworkApplication.K,null,this.Qg,this.ga)}N_o(b){return this.wi.D4?(ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.bzl}),!1):ct.Uf.R_(b)?(ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.ZE}),!1):this.aca&&this.aca.EU(b)?(ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.o1a}),!1):!0}$Lm(b){const h=Dd.ImageReader.nn(b);return h&&5===Dd.ImageReader.vi(h)&&this.Yvi(b,h)}Yvi(b,h){(h=!Dd.ImageReader.u9b(h)&&!Dd.ImageReader.KZd(h))||
ct.Hc.Yb(pd.a.rn,{["Reason"]:pe.a.qHh});return h&&this.N_o(b)}wBm(b,h){var u,B;h=new uK(h,Bg.a.instance,v.AFrameworkApplication.K,b,this.Qg,this.ga,this.ib,this.Uko);if(h.D_o(b))(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.$("ShouldLogPicturesExtendedHealthKpis"))&&this.og.logKpiUsage({kpiName:Xl.c.CFa,kpiType:0});else return(null===(u=v.AFrameworkApplication.K)||void 0===u?0:u.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Ub.a,{extendedProperties:b}),
this.og.logKpiFailure({kpiName:Xl.c.CFa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Xl.c.Bac,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):xa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),r.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new ug.a(document.body,Object(z.a)(h,h.Hgc,
"onUploadFrameInitialized"),Object(z.a)(h,h.Zza,"uploadResponseReceived"),v.AFrameworkApplication.K,!1,void 0,gm.a(v.AFrameworkApplication.K));return!0}sO(b){return this.$Lm(b)}Nma(b){const h=Dd.ImageReader.nn(b);if(!h)return!1;const u=Ga.a.instance.Oa("Box4.IFeatureHelper"),B=Dd.ImageReader.vi(h);return 5===B||10===B||48===B||11===B||u&&u.isFeatureEnabled(51)&&4===B?this.Yvi(b,h):!1}get VXc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",
!1)}yQk(){ct.A_f(!0)}setSize(b,h,u,B,Q=!1){Fb.App.xd.So&&Fb.App.xd.Yp.$F(h.node);const ca=Dd.ImageReader.a4a(b);let qa=1;u>this.z3d?qa=this.z3d/u:u<this.Z3d&&(qa=this.Z3d/u);let Qa=1;B>this.y3d?Qa=this.y3d/B:B<this.Y3d&&(Qa=this.Y3d/B);if(ca||Q)qa=Math.min(qa,Qa),Qa=Math.min(qa,Qa);1!==qa&&(u*=qa);1!==Qa&&(B*=Qa);this.fff(b,h,u,B)}fff(b,h,u,B){this.Rj.flo(b,h,u,B)}x4m(){r.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}MJa(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}$oj(b){const h=Dd.ImageReader.gFa(b);b=Dd.ImageReader.fFa(b);return 0>=h||0>=b}static get Xg(){return On.ContextSetEditor.instance}static get Uf(){return ti.a.instance}static get Hc(){return Wh.a.instance}}ct.A_f=null;Object(m.a)(ct,"ImageActor",null,[]);var vK=c(1103),Av=c(395),Jx=c(730);class LF{constructor(b,
h,u,B,Q){this.imagePropertySet=b;this.graphNode=h;this.kLd=u;this.Mkm=B;this.UEb=Q;if(this.A3a=Fb.App.instance&&Fb.App.instance.A3a())this.mBe=new vK.a(this.xr(),LF.gpc);this.og=Re.a.getInstance(Av.a)}Pga(b){this.jda("crop");if(null===this.imagePropertySet||void 0===this.kLd||void 0===this.UEb)return this.YM("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");if(void 0===h)return!1;const u=this.UEb.ajm();u.top=b.top;u.left=b.left;u.right=b.right;u.bottom=b.bottom;try{if(!this.x1e(u,
h))return this.w2d("crop","Failed to apply and update"),this.YM("crop","Failed to apply and update"),!1}catch(B){return this.w2d("crop",B),this.YM("crop",B.stack?B.stack:B.message?B.message:B.toString()),!1}this.VLf("crop");return!0}rotate(b){this.jda("rotate");if(null===this.imagePropertySet||void 0===this.kLd||void 0===this.UEb)return this.YM("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.imagePropertySet.hob.Nsf();if(0!==b){const u=this.UEb.djm();
u.rotation=b;try{if(!this.x1e(u,h))return this.YM("rotate","Failed to apply and update"),!1}catch(B){return this.w2d("rotate",B),this.YM("rotate",B.stack?B.stack:B.message?B.message:B.toString()),!1}}this.VLf("rotate");return!0}resize(b,h){this.jda("resize");if(null===this.imagePropertySet||void 0===this.kLd||void 0===this.UEb)return this.YM("resize","Argument(s) invalid"),!1;const u=this.getGraphicData("resize");if(void 0===u)return!1;let B=0;var Q=0;({width:B,height:Q}=Dd.ImageReader.Fib(this.imagePropertySet));
b/=B;h/=Q;Q=this.UEb.ejm();Q.scale=this.UEb.qcm();Q.scale.width=b;Q.scale.height=h;try{if(!this.x1e(Q,u))return this.YM("resize","Failed to apply and update"),!1}catch(ca){return this.w2d("resize",ca),this.YM("resize",ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.VLf("resize");return!0}VLf(b){Jx.a.tIa&&(b=new Map([["Renderer",Av.b.VOd],["Operation",b],["Type",Dd.ImageReader.vi(this.imagePropertySet).toString()]]),this.og.logKpiSuccess({kpiName:Av.d.fLd,optionalProperties:{additionalValues:{durationMs:void 0,
inStaging:void 0,extendedProperties:b},hasImpliedUsage:void 0},blockFutureEmissionDurationInMs:3E5}))}w2d(b,h){Jx.a.tIa&&(b=Object.assign(new Ub.a,{extendedProperties:new Map([["Renderer",Av.b.VOd],["Exception",h.message],["Operation",b]])}),h={name:Av.d.RTh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:Av.d.fLd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:b},optionalVeto:h}))}static get gpc(){return Ga.a.instance.Oa("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.A3a){const h=this.mBe.nuf();return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.YM(b,h.stack?h.stack:h.message?h.message:h.toString())}}x1e(b,h){this.kLd.apply(b,h);b=this.imagePropertySet.gFb(h);if(void 0===b)return!1;this.DRo(b);return!0}DRo(b){const h=new Qg.GraphTransaction(15);h.Db(this.graphNode);
this.imagePropertySet.setValue(Ud.a.tR,b.tR);this.Mkm.P8n(b.RXh,b.Kxa,this.imagePropertySet);h.dispose()}xr(){return Zo.PageNavigator.instance.ru(this.graphNode)}jda(b){const h=this.Fsg;h.edit=b;r.ULS.sendTraceTag(509657553,322,50,"{0}",h)}YM(b,h){const u=this.Fsg;u.message=h;u.edit=b;r.ULS.sendTraceTag(509666444,322,15,"{0}",u)}get Fsg(){return{["id"]:Dd.ImageReader.KPa(this.imagePropertySet),["type"]:Dd.ImageReader.vi(this.imagePropertySet)}}}Object(m.a)(LF,"EditWithGC2Command",null,[]);class FG{P8n(b,
h,u){this.b0m(b,h);this.S8n(u)}b0m(b,h){this.JH=Array(4);this.JH[0]=b.ngf;this.JH[2]=b.pgf;this.JH[1]=b.ogf;this.JH[3]=b.mgf;this.ZOa=b.ZOa;this.$Oa=b.$Oa;(this.Kxa=h)&&this.i5k()}S8n(b){b.setValue(Ud.a.Mwa,Math.round(this.ZOa).toString());b.setValue(Ud.a.Nwa,Math.round(this.$Oa).toString());const h=Array(4);this.JH.forEach((u,B)=>{h[B]=Math.round(u).toString()});b.setValue(Ud.a.YPa,h);b.setValue(Ud.a.L3a,this.Kxa)}i5k(){this.yDo();const b=this.ZOa/2,h=this.$Oa/2;this.ZOa%2&&0===this.$Oa%2?(--this.JH[0],
++this.JH[2]):this.$Oa%2&&0===this.ZOa%2&&(++this.JH[0],--this.JH[2]);this.JH[0]+=b-h;this.JH[1]-=b-h;this.JH[2]+=h-b;this.JH[3]-=h-b}yDo(){const b=this.ZOa;this.ZOa=this.$Oa;this.$Oa=b}}Object(m.a)(FG,"GraphicsExtents",null,[]);var uH=c(1167),vH=c(1168),GG=c(696);class wH{constructor(){this.L1o={["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,
["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.Pfl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8}}HIo(b,h){if(b){var u=this.GSd(b);h=h.hob.V7l();b.On=void 0===u?!1:u===h}}GIo(b,h){if(b){var u=this.T7l(b);h=h.hob.S7l();b.On=void 0===u||void 0===h?!1:u===h}}static V9b(b,h){return b.hob.V9b(h)}GSd(b){b=this.L1o[b.SourceControlId];if(void 0!==b)return b=kf.a.SY(b,0,!1),kf.a.G_f(b)}T7l(b){return this.Pfl[b.SourceControlId]}}
Object(m.a)(wH,"Gc2PictureBorderHelper",null,[]);var wK=c(521),XM=c(520),YM=c(1476);class cr extends ct{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){super(b,h,B,ca,qa,Qa,rb);this.I4g=!1;this.yBa=this.lBe=this.Raa=null;this.Cw=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;if(1===Fc)return this.wi.D4?2:32;Yb=parseInt(ld);r.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Yb);this.jvd.OKn(gc,Dd.ImageReader.nn(gc),Yb);this.EZc(gc);this.MJa();return 32};this.Cde=(Yb,gc,Fc)=>{if(!this.sO(gc))return 8;r.ULS.sendTraceTag(593372311,
322,50,"Applying Style Reset");Yb=Dd.ImageReader.nn(gc);if(1===Fc)return this.wi.D4?2:32;Fc=Dd.ImageReader.h2a(Yb);1===Fc?(Fc=new Qg.GraphTransaction(15),Fc.Db(gc.node),Dd.ImageReader.Ebc()?Yb.setValue(Jc.a.WMb,""):this.xK.BXn(Yb),Fc.dispose(),this.pBc.create(Yb,gc).Cw(We.a.Acj),this.EZc(gc)):2===Fc&&this.pBc.create(Yb,gc).Cw(We.a.Acj);return 32};this.Rmm=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;Yb=Dd.ImageReader.nn(gc);if(1===Fc)return this.wi.D4||Dd.ImageReader.pcc(Yb)?2:32;ld&&(this.xK.cbd(Yb,
gc),r.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Fb.App.za.updateCommandUI());this.MJa();return 32};this.Smm=(Yb,gc,Fc,Sc,ld)=>{var Hd;if(!this.sO(gc))return 8;if(1===Fc)return this.wi.D4?2:32;Yb=Dd.ImageReader.nn(gc);if(ld){Fc=Dd.ImageReader.oYd(Dd.ImageReader.nn(gc));r.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Fc);Sc=ld.ja($c.a.Ojb,0);const fe=ld.ja($c.a.Ljb,0),de=ld.ja($c.a.Mjb,0);ld=ld.ja($c.a.Njb,0);var Ie=Dd.ImageReader.mca(Yb);const ne=Ie.bottom,
ye=Ie.left,Vf=Ie.right;if(Sc===Ie.top&&fe===ne&&de===ye&&ld===Vf)return r.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(this.ZDf(Yb)&&(Ie=null===(Hd=x())||void 0===Hd?void 0:Hd.ECb(),(new LF(Yb,gc.node,Ie,new FG,y())).Pga({top:.001*Sc,bottom:.001*fe,left:.001*de,right:.001*ld})))return 32;Fc?(new uH.a(Yb,new vH.a)).Teo(Sc,fe,de,ld,this.Lkn,gc):this.jvd.EKn(gc,Dd.ImageReader.nn(gc),Sc,fe,de,ld);this.EZc(gc);Fb.App.za.updateCommandUI()}return 32};
this.SUd=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;Sc=Dd.ImageReader.nn(gc);if(1===Fc)return this.wi.D4||Dd.ImageReader.pcc(Sc)?2:32;if(ld){r.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.xK.sxa()||this.xK.cbd(Sc,gc);switch(Yb){case Qc.a.tTc:Yb=ld.ja($c.a.Ojb,-1);Fc=0;break;case Qc.a.mTc:Yb=ld.ja($c.a.Ljb,-1);Fc=1;break;case Qc.a.nTc:Yb=ld.ja($c.a.Mjb,-1);Fc=2;break;case Qc.a.oTc:Yb=ld.ja($c.a.Njb,-1);Fc=3;break;default:return 8}this.xK.pUo(Yb,
Fc);this.EZc(gc);Fb.App.za.updateCommandUI()}return 32};this.lob=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;Dd.ImageReader.nn(gc);ld&&(Yb=this.xK.sxa(),ld.setValue($c.a.sxa,Yb));return 32};this.Yhc=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;Yb=Dd.ImageReader.nn(gc);if(ld){if(this.xK.sxa())({top:Hd,bottom:Fc,left:Yb,right:gc}=this.xK.lSl());else{Sc=kf.a.jf(Dd.ImageReader.iF(Yb),0);var Hd=kf.a.jf(Dd.ImageReader.EG(Yb),1);gc=Dd.ImageReader.mca(Yb);const Ie=Math.max(gc.top,0);Fc=Math.max(gc.bottom,
0);Yb=Math.max(gc.left,0);gc=Math.max(gc.right,0);Sc=1E5*Sc/(1E5-(Yb+gc));const fe=1E5*Hd/(1E5-(Ie+Fc));Hd=Math.floor(Ie*fe/1E5);Fc=Math.floor(Fc*fe/1E5);Yb=Math.floor(Yb*Sc/1E5);gc=Math.floor(gc*Sc/1E5)}ld.setValue($c.a.Ojb,Hd);ld.setValue($c.a.Ljb,Fc);ld.setValue($c.a.Mjb,Yb);ld.setValue($c.a.Njb,gc)}return 32};this.M$b=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;if(1===Fc){if(this.wi.D4)return 2;this.c6m();return 32}Yb=Dd.ImageReader.nn(gc);this.xK.sxa()&&this.xK.cbd(Yb,gc);Yb=ld.ja($c.a.DIa,"");
ld=ld.ja($c.a.o9a,0);r.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:ld,["SourceControlId"]:Yb});switch(ld){case 1:this.xK.$lo(gc);break;case 8:this.xK.Yge(gc,1,1);break;case 9:this.xK.Yge(gc,1,3);break;case 3:this.xK.Yge(gc,2,void 0,!0);break;case 4:this.xK.Yge(gc,2,void 0,!1)}this.MJa();Fb.App.za.updateCommandUI();return 32};this.lic=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;Yb=Dd.ImageReader.nn(gc);gc=Dd.ImageReader.G4(gc);Fc=Dd.ImageReader.j9(Yb);Sc=Dd.ImageReader.x$b(Yb);
Yb=Dd.ImageReader.Kx(Yb);return this.CKn(gc,Fc,Sc,Yb,ld)?32:8};this.Umm=(Yb,gc,Fc,Sc,ld)=>{var Hd;if(!this.Nma(gc))return 8;Sc=Dd.ImageReader.nn(gc);if(1===Fc)return fc.SessionStatusManager.instance.Uj?8:this.wi.D4||Dd.ImageReader.qcc(Sc)?2:32;this.xK.sxa()&&this.xK.cbd(Sc,gc);if(this.ZDf(Sc)&&(Fc=null===(Hd=x())||void 0===Hd?void 0:Hd.ECb(),Hd=new LF(Sc,gc.node,Fc,new FG,y()),Fc=ld.ja($c.a.DJ,0),Hd.rotate(Fc)))return 32;if(ld){Fc=ld.ja($c.a.ATc,0);const Ie=Dd.ImageReader.oYd(Sc);r.ULS.sendTraceTag(22052889,
322,50,"SetImageRotateAction: {0}, isCanvas: {1}",Fc,Ie);Hd=Dd.ImageReader.h0(Sc);let fe=Dd.ImageReader.jRd(Sc),de=Dd.ImageReader.GFb(Sc);switch(Fc){case 0:Hd=ld.ja($c.a.DJ,0);break;case 2:Hd-=90;Hd=Cf.c(Hd);break;case 1:Hd+=90;Hd=Cf.c(Hd);break;case 4:fe=!fe;break;case 3:de=!de;break;case 5:Hd+=ld.ja($c.a.DJ,0),Hd=Cf.c(Hd)}Ie?(new uH.a(Sc,new vH.a)).tko(Hd,fe,de,this.$qn,gc):Fc?this.pBc.create(Sc,gc).Ajo(Hd,fe,de):(ld=yb.a.create(),Fc=new Qg.GraphTransaction(15,Ob.a.c9),Fc.Db(gc.node),this.xK.kho(Sc,
Hd),this.jvd.KKn(gc,Dd.ImageReader.nn(gc),Hd,ld),Fc.HGa(ld,1),Fc.Qj=Yb,Fc.dispose());this.MJa();this.EZc(gc);Fb.App.za.updateCommandUI()}return 32};this.ONb=(Yb,gc,Fc,Sc,ld)=>{if(!this.sO(gc))return 8;Yb=Dd.ImageReader.nn(gc);Yb=Dd.ImageReader.h0(Yb);if(0>Yb)return 2;ld.setValue($c.a.DJ,Yb);return 32};this.$qn=(Yb,gc,Fc,Sc)=>{if(Yb){const ld=new Qg.GraphTransaction(15,Ob.a.c9);ld.Db(Sc.node);gc.setValue($c.a.EBb,JSON.stringify(Fc));gc.setValue($c.a.at,Yb);this.xK.dge(gc,Fc.rotationAngle,Fc.nac,Fc.Foc);
this.WEb(gc);ld.dispose()}};this.Jqn=(Yb,gc,Fc,Sc)=>{if(Yb){const ld=new Qg.GraphTransaction(15);ld.Db(Sc.node);gc.setValue($c.a.EBb,JSON.stringify(Fc));gc.setValue($c.a.at,Yb);this.xK.Kfe(gc,Fc.Hme,Fc.ecd);this.WEb(gc);ld.dispose()}};this.Lkn=(Yb,gc,Fc,Sc)=>{if(Yb){const ld=new Qg.GraphTransaction(15);ld.Db(Sc.node);gc.setValue($c.a.EBb,JSON.stringify(Fc));gc.setValue($c.a.at,Yb);this.xK.eho(gc,Math.round(Fc.Ava*GG.a.kgb),Math.round(Fc.xva*GG.a.kgb),Math.round(Fc.yva*GG.a.kgb),Math.round(Fc.zva*
GG.a.kgb));this.WEb(gc);ld.dispose()}};this.k3c=(Yb,gc,Fc,Sc,ld)=>{var Hd;if(!this.Nma(gc))return 8;if(1===Fc)return 32;Yb=gc.contextId===vc.a.view?Df.PageReader.instance.rSd(gc):Zo.PageNavigator.instance.ru(gc.node);if(!Yb)return 8;Fc=Dd.ImageReader.nn(gc);(null===(Hd=Fb.App.instance)||void 0===Hd?0:Hd.HU(Dd.ImageReader.vi(Fc)))?(gc=new vK.a(Yb,this.TZk),gc=wH.V9b(Fc,gc.nuf())):gc=this.No.V9b(Kl.a.mU(gc),Fc);cr.y0i.sPb=gc;this.cXc&&this.l1.Ene(gc);gc=cr.y0i.oOc(Yb,Fb.App.VBb);if(!gc)return 8;ld.MenuItems=
gc;return 32};this.z$=(Yb,gc,Fc,Sc,ld)=>{if(!this.Nma(gc))return 8;if((Sc=Dd.ImageReader.nn(gc))&&Dd.ImageReader.Jy(Sc))return 2;if(1===Fc)return 32;if(2!==Fc)return 2;if(!ld)return r.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Fc=new Qg.GraphTransaction(15);Fc.Db(gc.node);const Hd=cr.q8a.cva(gc.node,ld);this.No.z$(Sc,ld,gc,Hd);this.WEb(Sc);Fc.dispose();Yb==Ob.a.L8c&&this.l1.VZa(ld);this.Ted();this.MJa();return 32};this.Sia=(Yb,gc,Fc)=>{if(!this.Nma(gc))return 8;
if(1===Fc)return 32;Fb.App.za.dismissFloatie();cr.s$a=new is.a("PictureBorder",Ob.a.L8c);cr.s$a.ilc(0);return 32};this.Mja=(Yb,gc,Fc,Sc,ld)=>{if(!this.Nma(gc))return 8;if(1===Fc)return 32;if((Yb=Dd.ImageReader.nn(gc))&&Dd.ImageReader.Jy(Yb))return 2;if(!ld)return r.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Fc=new Qg.GraphTransaction(15);Fc.Db(gc.node);this.No.Mja(Yb,ld,gc);this.WEb(Yb);Fc.dispose();this.Ted();this.MJa();return 32};this.B7a=(Yb,gc,Fc,Sc,ld)=>{if(!this.Nma(gc))return 8;
if(1===Fc)return 32;if((Yb=Dd.ImageReader.nn(gc))&&Dd.ImageReader.Jy(Yb))return 2;if(!ld)return r.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;Fc=new Qg.GraphTransaction(15);Fc.Db(gc.node);this.No.B7a(Yb,ld,gc);this.WEb(Yb);Fc.dispose();this.Ted();this.MJa();return 32};this.Ice=(Yb,gc,Fc)=>{if(!this.Nma(gc))return 8;if(1===Fc)return 32;Yb=Dd.ImageReader.nn(gc);Fc=new Qg.GraphTransaction(15);Fc.Db(gc.node);Dd.ImageReader.Y$b(Yb)&&(this.No.Ice(Yb),this.WEb(Yb));Fc.dispose();
this.Ted();this.MJa();return 32};this.xK=b;this.pBc=u;this.jvd=Q;cr.Lh=Lb;ct.A_f=cr.OAn}get l1(){return null!=this.JEg?this.JEg:this.JEg=Ga.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get No(){this.Raa||(this.Raa=new wK.a);return this.Raa}get f2h(){this.lBe||(this.lBe=new wH);return this.lBe}Tb(b){super.Tb(b);this.rr(b,Ob.a.Cw,this.Cw);b.Xc(Ob.a.Cw,4);this.rr(b,Ob.a.Cde,this.Cde);this.rr(b,Qc.a.gpe,this.M$b);b.Xc(Qc.a.gpe,4);this.rr(b,Qc.a.hpe,this.M$b);this.rr(b,Qc.a.ipe,this.M$b);this.rr(b,
Qc.a.jpe,this.M$b);this.rr(b,Qc.a.kpe,this.M$b);this.rr(b,Qc.a.lpe,this.M$b);this.rr(b,Qc.a.lic,this.lic);b.Xc(Qc.a.lic,101);this.rr(b,Qc.a.imageCrop,this.Rmm);b.Xc(Qc.a.imageCrop,4);this.rr(b,Qc.a.lob,this.lob);b.Xc(Qc.a.lob,101);this.rr(b,Qc.a.Boi,this.Smm);this.rr(b,Qc.a.tTc,this.SUd);this.rr(b,Qc.a.mTc,this.SUd);this.rr(b,Qc.a.nTc,this.SUd);this.rr(b,Qc.a.oTc,this.SUd);this.rr(b,Qc.a.j4c,this.Yhc);b.Xc(Qc.a.j4c,101);this.rr(b,Qc.a.vae,this.Yhc);b.Xc(Qc.a.vae,101);this.rr(b,Qc.a.wae,this.Yhc);
b.Xc(Qc.a.wae,101);this.rr(b,Qc.a.xae,this.Yhc);b.Xc(Qc.a.xae,101);this.rr(b,Ob.a.c9,this.Umm);b.Xc(Ob.a.c9,4);this.rr(b,Ob.a.ONb,this.ONb);b.Xc(Ob.a.ONb,101);this.rr(b,Ob.a.k3c,this.k3c);b.Xc(Ob.a.k3c,4);this.rr(b,Ob.a.z$,this.z$);b.Xc(Ob.a.z$,4);this.rr(b,Ob.a.L8c,this.z$);b.Xc(Ob.a.L8c,4);this.rr(b,Ob.a.iYf,this.Sia);b.Xc(Ob.a.iYf,4);this.rr(b,Ob.a.Jya,this.Jya.bind(this));b.Xc(Ob.a.Jya,4);this.rr(b,Ob.a.Mja,this.Mja);b.Xc(Ob.a.Mja,4);this.rr(b,Ob.a.QNb,this.QNb.bind(this));b.Xc(Ob.a.QNb,4);this.rr(b,
Ob.a.B7a,this.B7a);b.Xc(Ob.a.B7a,4);this.rr(b,Ob.a.pSf,this.Ice);b.Xc(Ob.a.pSf,4)}fff(b,h,u,B){var Q;r.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Dd.ImageReader.oYd(b));this.xK.sxa()&&this.xK.cbd(b,h);if(this.ZDf(b)){const ca=null===(Q=x())||void 0===Q?void 0:Q.ECb();if((new LF(b,h.node,ca,new FG,y())).resize(u,B))return}Dd.ImageReader.Jy(b)?(b=yb.a.create(),Q=new Qg.GraphTransaction(15),Q.Db(h.node),this.jvd.JKn(h,Dd.ImageReader.nn(h),u,B,b),Q.HGa(b,1),Q.dispose()):
Dd.ImageReader.flc(b)?(new uH.a(b,new vH.a)).dko(u,B,this.Jqn,h):(super.fff(b,h,u,B),this.Pd.Us(13))}sO(b){if(!b.Vk)return!1;var h=b.node;return(h=Fb.App.instance&&Fb.App.instance.QIb?h instanceof yp.a||h instanceof YM.a?h:null:Object(Na.a)(yp.a,h))&&eB.n(h)?(ct.Hc.Yb(VM.a.rn,{["Reason"]:WM.a.yO}),!1):super.sO(b)}static OAn(b){b&&!cr.dxb&&(cr.Lh.YZa(cr.Wmb),cr.dxb=!0)}CKn(b,h,u,B,Q){return Q?(Q.vxi=b,Q.j9=h,Q.zRb=u,Q.ww=B,Q.o9a=cr.ljm(Q),!0):!1}ZDf(b){b=Dd.ImageReader.vi(b);const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",
!1);return Fb.App.instance&&Fb.App.instance.HU(b)?(v.AFrameworkApplication.le("editswithgc2;editswithgc2cf"),h):!1}EZc(b){Fb.App.xd.So&&Fb.App.xd.Yp.$F(b.node)}c6m(){this.I4g||(r.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.I4g=!0)}WEb(b){const h=XM.a.instance.Zhf(b);this.xK.bge(b,h[0],h[1],h[2],h[3])}get TZk(){return null!=this.Jvg?this.Jvg:this.Jvg=Ga.a.instance.Oa("Box4.ICssColorProvider")}Jya(b,h,u,B,Q){var ca;if(!this.Nma(h))return 8;2===u&&(b=Dd.ImageReader.nn(h),(null===(ca=
Fb.App.instance)||void 0===ca?0:ca.HU(Dd.ImageReader.vi(b)))?this.f2h.HIo(Q,b):this.No.MQj(Q,b));return 32}QNb(b,h,u,B,Q){var ca;if(!this.Nma(h))return 8;2===u&&(b=Dd.ImageReader.nn(h),(null===(ca=Fb.App.instance)||void 0===ca?0:ca.HU(Dd.ImageReader.vi(b)))?this.f2h.GIo(Q,b):this.No.LQj(Q,b));return 32}Ted(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ga.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>
{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get q8a(){return null!=cr.GGg?cr.GGg:cr.GGg=Zn.a.instance}static get y0i(){cr.WV||(cr.WV=new Nx.a("PictureBorder"),cr.HFa(cr.WV));return cr.WV}static ljm(b){if(b.vxi)b=1;else switch(b.zRb){case 2:b=b.j9?3:4;break;case 1:b=1===b.ww?8:3===b.ww?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=0}return b}static HFa(b){b.dX(3,Ob.a.z$);b.dX(4,Ob.a.z$);b.dX(5,Ob.a.L8c);b.dX(6,Ob.a.z$);b.qAb(yw.a.instance,
1)}get cXc(){null==this.yBa&&(v.AFrameworkApplication.le("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.yBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.yBa}}cr.dxb=!1;cr.WV=null;cr.s$a=null;cr.Wmb=()=>{cr.Lh.Nic(cr.Wmb);cr.dxb=!1;if(ah.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&
appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else r.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(m.a)(cr,"ImageActor",ct,[]);class $m{static get il(){return null!=$m.cEg?$m.cEg:$m.cEg=Ga.a.instance.resolve("Box4.IParagraphEditor")}static get RA(){return null!=$m.nEg?$m.nEg:$m.nEg=Ga.a.instance.resolve("Box4.IParagraphIndentationReader")}static get g1(){return $m.il.mq}static get Qg(){return null!=$m.FHg?$m.FHg:$m.FHg=Ga.a.instance.resolve("Box4.IUndoManager")}static Tb(){const b=
v.AFrameworkApplication.va;b.ra(Ob.a.ANb,vc.a.view,ng.a.jw);b.ra(Ob.a.ANb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.ANb,1036);b.ra(Ob.a.qDb,vc.a.view,ng.a.jw);b.ra(Ob.a.qDb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.qDb,1036);b.ra(Ob.a.zgb,vc.a.view,ng.a.jw);b.ra(Ob.a.zgb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.zgb,1036);b.ra(Ob.a.Gic,vc.a.view,ng.a.jw);b.ra(Ob.a.Gic,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.Gic,1036);b.ra(Ob.a.O5c,vc.a.view,ng.a.jw);b.ra(Ob.a.O5c,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.O5c,1036);b.ra(Ob.a.j3a,vc.a.view,
ng.a.jw);b.ra(Ob.a.j3a,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.j3a,1036);b.ra(Ob.a.Rjb,vc.a.view,ng.a.jw);b.ra(Ob.a.Rjb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.Rjb,1036);b.ra(Ob.a.i3a,vc.a.view,ng.a.jw);b.ra(Ob.a.i3a,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.i3a,1036);b.ra(Ob.a.fge,vc.a.view,$m.gje);b.ra(Ob.a.fge,vc.a.paragraph,$m.gje);b.Xc(Ob.a.fge,1028);b.ra(Ob.a.tcg,vc.a.view,$m.gje);b.ra(Ob.a.tcg,vc.a.paragraph,$m.gje);b.Xc(Ob.a.tcg,1028);b.ra(Ob.a.UPb,vc.a.view,ng.a.jw);b.ra(Ob.a.UPb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.UPb,
1036);b.ra(Ob.a.zpb,vc.a.view,ng.a.jw);b.ra(Ob.a.zpb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.zpb,1036);b.ra(Ob.a.VPb,vc.a.view,ng.a.jw);b.ra(Ob.a.VPb,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.VPb,1036);b.ra(Ob.a.fhg,vc.a.view,ng.a.jw);b.Xc(Ob.a.fhg,1028);b.ra(Ob.a.U8c,vc.a.view,ng.a.jw);b.ra(Ob.a.U8c,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.U8c,1036);b.ra(Ob.a.V8c,vc.a.view,ng.a.jw);b.ra(Ob.a.V8c,vc.a.paragraph,$m.Hma);b.Xc(Ob.a.V8c,1036)}static gje(b,h,u,B,Q){2===u&&""===Q[gj.a.Text]&&(b=b===Ob.a.fge?Ob.a.j3a:Ob.a.i3a,
h=new KC.a,h.value=0,h.unit=Fb.App.gGa?2:1,v.AFrameworkApplication.va.Rb(b,2,h),Fb.App.za.updateCommandUI());return 32}static Hma(b,h,u,B,Q){if(!({xy:u}=ng.a.Eeg(u,h)).returnValue)return u;h=h.node;switch(b){case Ob.a.ANb:$m.g1.r2f(h,!0);break;case Ob.a.qDb:$m.g1.r2f(h,!1);break;case Ob.a.zgb:$m.g1.zgb(h);break;case Ob.a.Gic:$m.g1.Zda(h,0);break;case Ob.a.O5c:$m.g1.opb(h,0);break;case Ob.a.Rjb:case Ob.a.j3a:u=new vd.GraphIterator;u.set(h);u.zb(11);let ca=Q.value;Q=Q.unit;b===Ob.a.Rjb&&(ca=(new qm.a(Q,
ca)).Ut+$m.RA.DG(h).Ut,Q=1);$m.g1.qza(u,Q,ca);break;case Ob.a.i3a:$m.g1.IPb(h,Q.unit,Q.value);break;case Ob.a.UPb:Q?(b=(new qm.a(Q.unit,Q.value)).Ut,$m.g1.Zda(h,b)):$m.RA.SQd(h).Ut||$m.g1.Zda(h,Rj.OutlineReader.LX(h));break;case Ob.a.zpb:Q?(b=(new qm.a(Q.unit,Q.value)).Ut,$m.g1.opb(h,b)):$m.RA.DG(h).Ut||$m.g1.opb(h,Rj.OutlineReader.LX(h));break;case Ob.a.VPb:$m.g1.Zda(h,0);break;case Ob.a.U8c:b=Q;b=(new qm.a(b.unit,b.value)).Ut;$m.g1.kdg(h,1,b);break;case Ob.a.V8c:b=Q,b=(new qm.a(b.unit,b.value)).Ut,
$m.g1.kdg(h,2,b)}$m.Qg.nF();B&&Xq.a.Gqb&&(B.As|=Xq.a.rib(h));return 32}}Object(m.a)($m,"IndentationActor",null,[]);class xH extends Hf.a{constructor(){super(!1,!1,!0);this.Ogh="08448f1f-f728-4e12-95f8-f6333cdb269f";this.iub="Envelopes"}wMb(b=!1){!0===b&&(this.iub="Labels",this.Ogh="43f54585-fdbb-4c80-88eb-3251ae40b275");b={["description"]:`Thank you for showing interest! While we are building this feature, we'd love your feedback.\nHow often do you create ${this.iub.toLowerCase()}?`,["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};
const h=Array(5);h[0]={["key"]:"4",["text"]:"Daily"};h[1]={["key"]:"3",["text"]:"Weekly"};h[2]={["key"]:"2",["text"]:"Monthly"};h[3]={["key"]:"1",["text"]:"Rarely"};h[4]={["key"]:"0",["text"]:"Never"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b.textAreaDescription=`Please tell us more about why you create ${this.iub.toLowerCase()} and the top 3 capabilities you would like to see in ${this.iub.toLowerCase()} feature?`;b={["id"]:"MailingsDialog",["bodyControls"]:b};this.Qh(`Interested in the ${this.iub} Feature?`,
this.rio.bind(this),b);return new Promise(u=>{this.oLe=u})}rio(b,h){1===b&&this.aK(h.selectedReason,h.reasonDescription)}dispose(){super.dispose();this.oLe()}aK(b,h){const u={},B={},Q={},ca={},qa={};u.appId=2155;u.manifestType="Fps";u.submitTime=(new Date).toISOString();u.source="Client";u.type="Survey";u.clientFeedbackId=yb.a.create().toString();qa.reason=b;const Qa={},rb={numberOfOptions:5};rb.selectedRating=b;Qa.rating=[rb];Qa.comment=[h];ca.surveySpecificData=JSON.stringify(Qa);Q.extendedManifestData=
JSON.stringify(ca);u.application=Q;qa.surveyId=this.Ogh;u.survey=qa;u.telemetry=this.x_a();u.web=this.kBb();B["Content-Type"]="application/json";this.nja(JSON.stringify(u),B)}rM(b,h,u,B){h&&b&&B&&u&&B in h&&(b[u]=h[B])}x_a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Envelopes and Labels";this.rM(h,b,"audienceGroup","AudienceGroup");this.rM(h,b,"osBuild","OsVersion");this.rM(h,b,"platform","Platform");this.rM(h,b,
"processSessionId","WACSessionID");return h}kBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.rM(h,b,"browser","Browser");this.rM(h,b,"browserVersion","BrowserVersion");this.rM(h,b,"dataCenter","WACDatacenter");return h}nja(b,h,u=0){let B=0;3<u||(1===u?B=200:1<u&&(B=200+500*(u-1)),v.AFrameworkApplication.oc.Xb(new bf.a(2,1,B,()=>{v.AFrameworkApplication.He.sj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{r.ULS.sendTraceTag(508904273,211,50,"Success sending OCV feedback for {0}",
this.iub)},()=>{this.nja(b,h,u+1);r.ULS.sendTraceTag(508904272,211,50,"Failure sending OCV feedback for {0}, attempt {1}",this.iub,u)},null)})))}}Object(m.a)(xH,"MailingsDialog",Hf.a,[]);class xK{constructor(b){this.ga=b}Tb(){this.ga.ra(Qc.a.Phf,vc.a.view,this.OUc.bind(this))}OUc(b,h,u){2===u&&(Object(Fe.c)(Qc.a.Phf),(new xH).wMb());return 32}}Object(m.a)(xK,"EnvelopesActor",null,[]);class yK{constructor(b){this.ga=b}Tb(){this.ga.ra(Qc.a.labels,vc.a.view,this.OUc.bind(this))}OUc(b,h,u){2===u&&(Object(Fe.c)(Qc.a.labels),
(new xH).wMb(!0));return 32}}Object(m.a)(yK,"LabelsActor",null,[]);var zK=c(381),ZM=c(66),HG=c(418),$M=c(1208);class Lr{constructor(b){this.gYa=this.FCa=this.uzc=null;this.Dkh=!1;this.I$d=h=>{if(this.FCa)if(h===Za.a.H$d)hd.FocusManager.instance().getRegion($d.AFrame.j6a).vfc();else if(h===Za.a.G$d)hd.FocusManager.instance().getRegion($d.AFrame.j6a).tfc();else return 2;else return 2;return 32};this._frame=b}nAo(){if(this.Dkh)this.VEi();else{const b=Ya.a.create(v.AFrameworkApplication.K.kb("WopiBootstrapUrl"));
b.t_((h,u)=>{u.succeeded?(this.Dkh=!0,this.VEi()):r.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Hb.a.FX(b)}}VEi(){if(this.uzc)r.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.Tra;this.FCa=document.createElement("div");b.parentNode.insertBefore(this.FCa,b);this.gYa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:v.AFrameworkApplication.K.kb("FileName"),reactRoot:this.FCa});this.gYa.setWebpackPublicPath(v.AFrameworkApplication.R5);
this.gYa.renderDocumentPanel()}}G_l(b){const h={};h.Container=b;h.BootstrapperUrl=v.AFrameworkApplication.K.kb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.Drb;b={};b.HostName=v.AFrameworkApplication.K.kb("FileSource");b.HostSessionId=v.AFrameworkApplication.K.kb("HostSessionId");b.UserId=v.AFrameworkApplication.K.kb("UserId");b.DocumentClickTime=new Date(this._frame.qmb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=v.AFrameworkApplication.K.kb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.qmb;h.Diagnostics=b;b={};b.WopiSrc=v.AFrameworkApplication.K.kb("WopiSrc");b.AccessToken=v.AFrameworkApplication.K.kb("AccessToken");b.AccessTokenTtl=v.AFrameworkApplication.K.kb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
u=>{Lr.$W=u;this.gYa.setMaxPage(Lr.$W.GetPageCount());this.gYa.setCurrentPage(Lr.$W.GetCurrentPage());this.gYa.setPageControlVisible(!0);Lr.$W.RegisterEventHandler("PageChanged",B=>{this.gYa.setCurrentPage(B.newPage)});Lr.$W.RegisterEventHandler("BrowserEvent",B=>{27===B.keyCode?this.closeViewer():B.button&&1!==B.button||this.FCa.click()});u=this._frame.qmb-(new Date).getTime();r.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",u);this.Tb();hd.FocusManager.instance().zL($d.AFrame.j6a,
!0);this.buildFocusRegion();this.LHa(hd.FocusManager.instance().ae($d.AFrame.j6a));this.FCa.click()};h.FnOnInitializeFailure=(u,B)=>{r.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",u.toString(),B.toString());this.closeViewer()};return h}buildFocusRegion(){const b=hd.FocusManager.instance();var h=b.getRegion($d.AFrame.j6a);h=[2,3];const u=b.ae($d.AFrame.j6a),B=new te.DOMFocusListing(()=>this.FCa);B.uja=!0;for(const Q of h)B.Mm(Q);h=b.Vma(()=>this.FCa,u,B);h.fTa();h.xP=!0;h.$_a=!0;B.Zy(B.kha)}Tb(){v.AFrameworkApplication.va.ra(Za.a.H$d,
Ad.a.frame,this.I$d);v.AFrameworkApplication.va.ra(Za.a.G$d,Ad.a.frame,this.I$d)}LHa(b){b.kr(hd.FocusManager.instance().LW);b.kr(hd.FocusManager.instance().MW);b.bindAction(hd.FocusManager.instance().LW,Za.a.H$d);b.bindAction(hd.FocusManager.instance().MW,Za.a.G$d)}loadViewer(b){b=this.G_l(b);this.uzc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.uzc.Complete(b.WopiInfo)}closeViewer(){hd.FocusManager.instance().dS($d.AFrame.j6a);Lr.$W&&(Lr.$W.Dispose(),Lr.$W=null,v.AFrameworkApplication.va.Vv(Za.a.H$d,
Ad.a.frame,this.I$d),v.AFrameworkApplication.va.Vv(Za.a.G$d,Ad.a.frame,this.I$d));this.uzc&&(this.FCa.parentNode.removeChild(this.FCa),this.FCa=this.uzc=null)}printAction(){r.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");v.AFrameworkApplication.va.processAction(Ob.a.print,2)}downloadPdfAction(){r.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");v.AFrameworkApplication.va.processAction(Qc.a.KLc,2)}downloadCopyAction(){r.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
v.AFrameworkApplication.va.processAction(Za.a.downloadACopy,2)}zoomInAction(){if(Lr.$W){let b=Lr.$W.GetZoomLevel();b+=.2;Lr.$W.SetZoomLevel(b)}}zoomOutAction(){if(Lr.$W){let b=Lr.$W.GetZoomLevel();b-=.2;Lr.$W.SetZoomLevel(b)}}setPage(b){if(Lr.$W){const h=Lr.$W.GetPageCount();1>b?(Lr.$W.SetCurrentPage(1),this.gYa.setCurrentPage(1)):1<=b&&b<=h?Lr.$W.SetCurrentPage(b):(Lr.$W.SetCurrentPage(h),this.gYa.setCurrentPage(h))}}static getInstance(b){Lr.WNe||(Lr.WNe=new Lr(b));return Lr.WNe}}Lr.$W=null;Lr.WNe=
null;Object(m.a)(Lr,"PreviewPanelActor",null,[]);class Up{static get uIj(){return null!=Up.ZHg?Up.ZHg:Up.ZHg=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName")}static Tb(b,h){b.fb(Ob.a.readingMode,Ad.a.frame,Up.QJj,128);b.ra(Ob.a.hke,Ad.a.frame,Up.QJj);Up.KI=h;b.ra(Qc.a.LYc,Ad.a.frame,Up.LYc);b.ra(Qc.a.NYc,Ad.a.frame,Up.NYc);b.ra(Qc.a.mfe,Ad.a.frame,Up.mfe);b.fb(Qc.a.x4c,Ad.a.frame,Up.x4c,96);b.fb(Qc.a.M4c,Ad.a.frame,Up.M4c,96);b.fb(Qc.a.Zae,Ad.a.frame,Up.Zae,96)}static QJj(b,h,u){if(h.contextId!==
Ad.a.frame)return 2;h=hk.App.hn;switch(b){case Ob.a.readingMode:if(!h.Drb)return 8;if(1===u)return fc.SessionStatusManager.instance.Uj?8:32;b=(new Date).getTime();cl.a.instance.$Qn(b);h.qmb=b;v.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Km.a.iR(3,!0,Up.xEn,null,h):Km.a.iR(3,!0,Up.fPi,null,h);return 32;case Ob.a.hke:return 32;default:return 2}}static fPi(b){HG.a()?Up.Phm(b):Up.Jvj(b)}static Phm(b){const h={};h[H.a.Dyf]=Up.uIj;v.AFrameworkApplication.kP().execute(u=>{u.Fv(L.a.Eyf);u.JPo(L.a.Eyf);
u.bC(L.a.Eyf,B=>{Up.FTk(B,b)});u.sendMessage(L.a.NYl,h)})}static FTk(b,h){b.Values[H.a.Dyf]===Up.uIj&&("true"===b.Values[H.a.Mni]?Up.Jvj(h):(Up.$So(),Up.KDo()))}static $So(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};v.AFrameworkApplication.le("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static KDo(){v.AFrameworkApplication.mv=!0;Fb.App.za.K$(1);Fb.App.za.jb.gu&&Fb.App.za.jb.gu.Vi&&Fb.App.za.jb.gu.rAf();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Fb.App.za.updateCommandUI();$M.MainView.Hzj(v.AFrameworkApplication.K)}static Jvj(b){try{const h=new tb.a;let u,B;v.AFrameworkApplication.OIj?(u=Fb.App.hostUrl,B=3):(u=b.Drb,B=1);b.qmb&&h.add(v.AFrameworkApplication.JOf,
b.qmb.toString());v.AFrameworkApplication.JCf&&h.add(v.AFrameworkApplication.P9e,"1");v.AFrameworkApplication.C5e&&h.add(v.AFrameworkApplication.a3k,"1");h.add(zK.a.Epg,zK.a.userSessionData);h.add(v.AFrameworkApplication.K$d,v.AFrameworkApplication.userSessionId);const Q=v.AFrameworkApplication.K.kb(v.AFrameworkApplication.nka);Q&&h.add(v.AFrameworkApplication.XBj,Q);r.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");HG.b(v.AFrameworkApplication.K)?HG.d("view",h,HG.c):(u=fa.a.Knh(u,h),
v.AFrameworkApplication.OIj?Qd.a.om(u,Qd.a.Ura(B),void 0,"AuthenticationLostDuringSession"):Qd.a.openWindow(B,u,!1,void 0,ZM.a.qaj))}catch(h){}}static xEn(b){r.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ga.a.instance.resolve("Common.IDynamicScriptLoaderProvider").aA.loadScript("previewPanel")).catch(()=>{r.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Up.fPi(b)}).then(()=>
{Lr.getInstance(b).nAo()})}static LYc(b,h,u){if(1===u)return 32;Up.KI.Sbg(1);Fb.App.za.updateCommandUI();return 32}static NYc(b,h,u){if(1===u)return 32;Up.KI.Sbg(0);Fb.App.za.updateCommandUI();return 32}static mfe(b,h,u){if(1===u)return 32;Up.KI.Sbg(1===Up.KI.mu?0:1);Fb.App.za.updateCommandUI();return 32}static Zae(b,h,u,B,Q){if(1===u)return 32;Q[gg.a.On]=1===Up.KI.mu;return 32}static x4c(b,h,u,B,Q){if(1===u)return 32;Q[gg.a.On]=1===Up.KI.mu;return 32}static M4c(b,h,u,B,Q){if(1===u)return 32;Q[gg.a.On]=
!Up.KI.mu;return 32}}Up.KI=null;Object(m.a)(Up,"MainViewModeActor",null,[]);class AK{constructor(b,h,u){this.h8m=(B,Q,ca,qa,Qa)=>1===ca?32:(B=this.Sk.W8(Q.ek))?(Qa=3===Qa.Qx,this.J6.value.hLh(this.k9l(B),this.KGb(B),Qa),32):2;this.ga=b;this.J6=h;this.Sk=u}Tb(){this.ga.ra(Qc.a.$If,vc.a.view,this.h8m);this.ga.fb(Qc.a.Bae,vc.a.view,bm.d,96);this.ga.fb(Qc.a.yae,vc.a.view,bm.d,96);this.ga.fb(Qc.a.zae,vc.a.view,bm.d,96);this.ga.fb(Qc.a.Aae,vc.a.view,bm.d,96);this.ga.ra(Qc.a.T1c,vc.a.view,bm.c);this.ga.ra(Qc.a.S1c,
vc.a.view,bm.c);this.ga.ra(Qc.a.r8d,vc.a.view,bm.c);this.ga.ra(Qc.a.s8d,vc.a.view,bm.c)}k9l(b){const h=new Od.DictionaryPropertySet;h.setValue(Jc.a.marginTop,this.Sk.toa(b));h.setValue(Jc.a.marginBottom,this.Sk.Awa(b));h.setValue(Jc.a.marginLeft,this.Sk.xJ(b));h.setValue(Jc.a.marginRight,this.Sk.jL(b));return h}KGb(b){const h=new Od.DictionaryPropertySet;h.setValue(Jc.a.Go,this.Sk.Ft(b));h.setValue(Jc.a.rv,this.Sk.EB(b));return h}}Object(m.a)(AK,"MarginsDialogActor",null,[]);class BK{constructor(b,
h,u,B){this.ga=b;this.fd=h;this.rMa=u;this.gZj=B;this.Oxd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],POj:["Summary","Updates","Challenges","Opportunities","What's Next"],QQj:["Highlights","Itinerary","Food","Activities"],uNj:["Introduction","Step 1","Step 2","Step 3"]}}Tb(){this.ga.fb(Qc.a.KNi,vc.a.Tc,this.ADk.bind(this),1028);this.ga.fb(Qc.a.GOf,vc.a.Tc,this.YFc.bind(this),1028);this.ga.fb(Qc.a.EOf,vc.a.Tc,this.YFc.bind(this),1028);this.ga.fb(Qc.a.DOf,vc.a.Tc,
this.YFc.bind(this),1028);this.ga.fb(Qc.a.HOf,vc.a.Tc,this.YFc.bind(this),1028);this.ga.fb(Qc.a.FOf,vc.a.Tc,this.YFc.bind(this),1028)}ADk(){return null===this.fd.instance?2:32}YFc(b,h,u){var B;if(1===u){if(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))return 32}else if(2===u){switch(b){case Qc.a.GOf:this.aXd(this.Oxd.Resume);break;case Qc.a.EOf:this.aXd(this.Oxd.POj);break;case Qc.a.HOf:this.aXd(this.Oxd.QQj);
break;case Qc.a.DOf:this.aXd(this.Oxd.uNj);break;case Qc.a.FOf:this.gZj.x7b(Q=>{Q.AIa("WordMiniTemplateSurvey",null)})}return 32}return 2}aXd(b){const h=new Qg.GraphTransaction(15);try{const u=Fb.App.za.jb.qc.ed;let B=u,Q;for(Q=Fa.a.ap(u);Q.moveNext();){const qa=Q.currentNode;if(me.ParagraphReader.SVc(qa)&&me.ParagraphReader.Wb(qa)){B=qa;break}}h.Db(B);const ca=this.fd.instance.jFc(b,B,!0).toArray();this.XGl(ca)}finally{h.dispose()}}XGl(b){for(const h of b)this.rMa.instance.rba(h.node,4)}}Object(m.a)(BK,
"MiniTemplateActor",null,[]);class yH{constructor(b){this.dbd=(h,u,B)=>{if(1===B)return 32;h=v.AFrameworkApplication.ua;if(!h)return 32;h.cDd();yH.K8n(h);return 32};this.ga=b}Tb(){this.ga.ra(Qc.a.dbd,vc.a.view,this.dbd)}static K8n(b){const h=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");var u=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");u=ac.a.ica(h,!u);ac.a.aUa(h,(!u).toString(),ac.a.SRa);u?r.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):
r.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Fe.d(Qc.a.dbd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"ModernUxExperimentPreference",string:(!u).toString()})]);b.refreshDocument(null)}}Object(m.a)(yH,"ModernUxActor",null,[]);var aN=c(1078),dt=c(1710);class CK{constructor(b,h,u,B){this.Uie=Of.a.Mv(1)/6;this.Hjo=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;if(qa=this.Qf.W8(ca.ek)){if(0<=rb&&rb<dt.a.k1.length){ca=new Qg.GraphTransaction(15);ca.Db(qa);
ca.Qj=Q;Q=dt.a.k1[rb].zwb;Qa=dt.a.k1[rb].xwb;const Lb=dt.a.k1[rb]._marginLeft;rb=dt.a.k1[rb].ywb;this.W8d(Q,Qa,this.Qf.EB(qa))&&this.W8d(Lb,rb,this.Qf.Ft(qa))?(this.LE.y7a(qa,Q),this.LE.w7a(qa,Qa),this.LE.Lja(qa,Lb),this.LE.x7a(qa,rb),this.Ud.Us(11)):this.kIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ca.dispose()}else return 2;return 32}r.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek);return 2};this.Ijo=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;if(qa=
this.Qf.W8(ca.ek)){if(0<=rb&&rb<dt.a.Dqa.length)ca=new Qg.GraphTransaction(15),ca.Db(qa),ca.Qj=Q,Q=(Qa=this.Qf.hWc(qa))?dt.a.Dqa[rb].yta:dt.a.Dqa[rb].qMa,rb=Qa?dt.a.Dqa[rb].qMa:dt.a.Dqa[rb].yta,this.W8d(this.Qf.Awa(qa),this.Qf.toa(qa),rb)&&this.W8d(this.Qf.xJ(qa),this.Qf.jL(qa),Q)?(this.LE.Ocg(qa,Q),this.LE.Ncg(qa,rb),this.Ud.Us(11)):this.kIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),ca.dispose();else return 2;return 32}r.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ek);return 2};this.cjo=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;if(qa=this.Qf.W8(ca.ek)){ca=this.Qf.hWc(qa);Qa=new Qg.GraphTransaction(15);Qa.Db(qa);Qa.Qj=Q;this.LE.vkj(qa,rb);if(rb&&!ca||!rb&&ca){Q=this.Qf.Ft(qa);rb=this.Qf.EB(qa);this.LE.Ocg(qa,rb);this.LE.Ncg(qa,Q);Q=this.Qf.toa(qa);rb=this.Qf.Awa(qa);const Lb=this.Qf.xJ(qa),Yb=this.Qf.jL(qa);ca?(this.LE.y7a(qa,v.AFrameworkApplication.isRtl?Lb:Yb),this.LE.w7a(qa,v.AFrameworkApplication.isRtl?Yb:Lb),this.LE.Lja(qa,v.AFrameworkApplication.isRtl?
rb:Q),this.LE.x7a(qa,v.AFrameworkApplication.isRtl?Q:rb)):(this.LE.y7a(qa,v.AFrameworkApplication.isRtl?Yb:Lb),this.LE.w7a(qa,v.AFrameworkApplication.isRtl?Lb:Yb),this.LE.Lja(qa,v.AFrameworkApplication.isRtl?Math.abs(Q):rb),this.LE.x7a(qa,v.AFrameworkApplication.isRtl?rb:Q));this.Ud.Us(11)}Qa.dispose();return 32}r.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek);return 2};this.uYd=(Q,ca,qa)=>{if(1===qa)return 1===this.hT.mu?32:8};this.kpb=(Q,ca,qa,Qa,
rb)=>{if(1===qa)return 32;qa=this.Qf.W8(ca.ek);if(!qa)return r.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek),2;ca=new Qg.GraphTransaction(15);ca.Db(qa);ca.Qj=Q;Q=Math.floor(this.Qf.Ft(qa)/720);if(0>rb||rb>Q)return 2;this.LE.BPb(qa,rb);this.kld.execute(Lb=>{Lb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Efe=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;qa=this.Qf.W8(ca.ek);if(!qa)return r.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ek),2;ca=new Qg.GraphTransaction(15);ca.Db(qa);ca.Qj=Q;Q=rb[0];Qa=this.Qf.Ft(qa);if(720>Q||Q>Qa)return 2;this.LE.rkc(qa,rb);this.kld.execute(Lb=>{Lb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Dfe=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;qa=this.Qf.W8(ca.ek);if(!qa)return r.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek),2;ca=new Qg.GraphTransaction(15);ca.Db(qa);ca.Qj=Q;Q=this.Qf.Ft(qa);Qa=this.Qf.eh(qa);if(0>rb||rb>(Q-
720*Qa)/(Qa-1))return 2;this.LE.zeo(qa,rb);this.kld.execute(Lb=>{Lb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Cfe=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;qa=this.Qf.W8(ca.ek);if(!qa)return r.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek),2;ca=new Qg.GraphTransaction(15);ca.Db(qa);ca.Qj=Q;if(null==rb)return 2;this.LE.Zko(qa,rb);this.kld.execute(Lb=>{Lb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};
this.EHa=(Q,ca,qa,Qa,rb)=>{if(Q=this.Qf.W8(ca.ek))return rb.marginTop=this.Qf.toa(Q),rb.marginBottom=this.Qf.Awa(Q),rb.marginLeft=this.Qf.xJ(Q),rb.marginRight=this.Qf.jL(Q),rb.Go=this.Qf.Ft(Q),rb.rv=this.Qf.EB(Q),rb.wxa=this.Qf.hWc(Q),rb.XE=this.Qf.eh(Q),rb.gna=this.Qf.qib(Q),rb.b_k=this.Qf.sTd(Q),rb.WKb=this.d2l(rb),rb.CMb=this.l6l(rb),rb.uIc=this.RPl(rb),32;r.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek);return 2};this.tge=(Q,ca,qa,Qa,rb)=>{if(1===
qa)return 32;if(qa=this.Qf.W8(ca.ek)){ca=new Qg.GraphTransaction(15);ca.Db(qa);switch(Q){case Ob.a.y7a:this.LE.y7a(qa,rb);break;case Ob.a.w7a:this.LE.w7a(qa,rb);break;case Ob.a.Lja:this.LE.Lja(qa,rb);break;case Ob.a.x7a:this.LE.x7a(qa,rb)}this.Ud.Us(11);ca.dispose();return 32}r.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek);return 2};this.blj=(Q,ca,qa,Qa,rb)=>{if(1===qa)return 32;if(qa=this.Qf.W8(ca.ek)){ca=new Qg.GraphTransaction(15);ca.Db(qa);let Lb=
Qa=0;switch(Q){case Ob.a.Qcg:Lb=rb;this.LE.Ocg(qa,Lb);Qa=this.Qf.EB(qa);break;case Ob.a.Pcg:Qa=rb,this.LE.Ncg(qa,Qa),Lb=this.Qf.Ft(qa)}this.LE.vkj(qa,Qa<Lb);this.Ud.Us(11);ca.dispose();return 32}r.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ek);return 2};this.LE=b;this.Ud=h;this.hT=u;this.kld=B}get Qf(){return Pk.a.instance}e2l(b){var h=Fb.App.WEf,u=h?1:3,B=v.AFrameworkApplication.numberFormat;let Q=dt.a.k1[b].zwb;var ca=dt.a.k1[b].xwb;var qa=dt.a.k1[b]._marginLeft;
b=dt.a.k1[b].ywb;Q=h?Of.a.VUa(Q):Of.a.Wz(Q);ca=h?Of.a.VUa(ca):Of.a.Wz(ca);qa=h?Of.a.VUa(qa):Of.a.Wz(qa);b=h?Of.a.VUa(b):Of.a.Wz(b);h=F.a.MEa(Q,u,B);ca=F.a.MEa(ca,u,B);qa=F.a.MEa(qa,u,B);u=F.a.MEa(b,u,B);B={};B.top=h;B.bottom=ca;B.left=qa;B.right=u;return B}f8m(b){const h=WordRibbonStrings.PageMarginsTop,u=WordRibbonStrings.PageMarginsBottom,B=WordRibbonStrings.PageMarginsLeft,Q=WordRibbonStrings.PageMarginsRight;b=this.e2l(b);return[[h,b.top,u,b.bottom],[B,b.left,Q,b.right]]}p2c(b){var h=Fb.App.WEf,
u=h?1:3;const B=v.AFrameworkApplication.numberFormat;let Q=dt.a.Dqa[b].yta;b=dt.a.Dqa[b].qMa;Q=h?Of.a.VUa(Q):Of.a.Wz(Q);b=h?Of.a.VUa(b):Of.a.Wz(b);h=F.a.MEa(b,u,B);u=F.a.MEa(Q,u,B);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,u)}Tb(){const b=v.AFrameworkApplication.va;b.fb(Ob.a.z7a,vc.a.view,this.Hjo,4);b.fb(Ob.a.UTa,vc.a.view,this.Ijo,4);b.fb(Ob.a.setOrientation,vc.a.view,this.cjo,4);b.fb(Ob.a.EHa,vc.a.view,this.EHa,96);b.ra(Ob.a.y7a,vc.a.view,this.tge);b.ra(Ob.a.w7a,vc.a.view,
this.tge);b.ra(Ob.a.Lja,vc.a.view,this.tge);b.ra(Ob.a.x7a,vc.a.view,this.tge);b.ra(Ob.a.Qcg,vc.a.view,this.blj);b.ra(Ob.a.Pcg,vc.a.view,this.blj);b.fb(Ob.a.uYd,vc.a.view,this.uYd,4);b.ra(Ob.a.kpb,vc.a.view,this.kpb);b.ra(Ob.a.Efe,vc.a.view,this.Efe);b.ra(Ob.a.Dfe,vc.a.view,this.Dfe);b.ra(Ob.a.Cfe,vc.a.view,this.Cfe)}W8d(b,h,u){return u>=b+h+Fb.App.lAa}d2l(b){let h=5;for(let u=0;u<dt.a.k1.length;u++)if(dt.a.k1[u].zwb===b.marginTop&&dt.a.k1[u].xwb===b.marginBottom&&dt.a.k1[u]._marginLeft===b.marginLeft&&
dt.a.k1[u].ywb===b.marginRight){h=u;break}return h}l6l(b){let h=5;b=new aN.a(Math.min(b.Go,b.rv),Math.max(b.Go,b.rv));for(let u=0;u<dt.a.Dqa.length;u++)if(this.Own(b,dt.a.Dqa[u])){h=u;break}return h}RPl(b){let h=0;switch(b.XE){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}Own(b,h){return qe.a.$ti(b.qMa,Math.max(h.qMa-this.Uie,0),h.qMa+this.Uie)&&qe.a.$ti(b.yta,Math.max(h.yta-this.Uie,0),h.yta+this.Uie)}kIa(b){if(!em.a.BM){const h=new mg.StandardDialog;h.Cd=0;h.uV(CommonUIStrings.l_DefaultDialogTitle,
b,null)}}}Object(m.a)(CK,"PageActor",null,[563]);class DK{constructor(b){this.ga=b}get nc(){return this.ga}sge(b,h){let u=0;b?1===b?u=Ob.a.Lja:2===b?u=Ob.a.x7a:3===b&&(u=Ob.a.w7a):u=Ob.a.y7a;this.nc.Rb(u,2,h)}UTa(b,h){let u=0;1===b?u=Ob.a.Pcg:b||(u=Ob.a.Qcg);this.nc.Rb(u,2,h)}Bfe(b,h){let u=0;switch(b){case 0:u=Ob.a.kpb;break;case 1:u=Ob.a.Efe;break;case 2:u=Ob.a.Dfe;break;case 3:u=Ob.a.Cfe}this.nc.Rb(u,2,h)}}Object(m.a)(DK,"PageCommands",null,[562]);class EK{constructor(b,h,u){this.Nwn=(B,Q,ca,qa,
Qa)=>1===ca?32:(B=this.Sk.W8(Q.ek))?(Qa=3===Qa.Qx,this.J6.value.NLh(this.l9l(B),this.KGb(B),Qa),32):2;this.ga=b;this.J6=h;this.Sk=u}Tb(){this.ga.ra(Qc.a.bJf,vc.a.view,this.Nwn);this.ga.fb(Qc.a.Qae,vc.a.view,bm.d,96);this.ga.fb(Qc.a.Pae,vc.a.view,bm.d,96);this.ga.ra(Qc.a.v8d,vc.a.view,bm.c);this.ga.ra(Qc.a.u8d,vc.a.view,bm.c)}l9l(b){const h=new Od.DictionaryPropertySet;h.setValue(Jc.a.Go,this.Sk.Ft(b));h.setValue(Jc.a.rv,this.Sk.EB(b));return h}KGb(b){const h=new Od.DictionaryPropertySet;h.setValue(Jc.a.marginTop,
Math.abs(this.Sk.toa(b)));h.setValue(Jc.a.marginBottom,Math.abs(this.Sk.Awa(b)));h.setValue(Jc.a.marginLeft,this.Sk.xJ(b));h.setValue(Jc.a.marginRight,this.Sk.jL(b));return h}}Object(m.a)(EK,"PaperSizeDialogActor",null,[]);class PE{constructor(b,h,u){this.ga=b;this.J6=h;this.qW=u}Tb(){this.ga.fb(Ob.a.iec,vc.a.view,this.Cxn.bind(this),1028);this.ga.ra(Ob.a.iec,vc.a.paragraph,this.Axn.bind(this));this.ga.fb(Ob.a.iKn,vc.a.view,bm.d,96);this.ga.fb(Ob.a.jKn,vc.a.view,bm.d,96);this.ga.fb(Ob.a.qJn,vc.a.view,
bm.d,96);this.ga.fb(Ob.a.rJn,vc.a.view,bm.d,96);this.ga.fb(Ob.a.Cyo,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Byo,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Sun,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Tun,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Dun,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Ayo,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Eun,vc.a.view,bm.c,96)}Axn(b,h,u,B,Q){if(1===u)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.TAj(h);Q=3===Q.Qx;this.J6.value.wId(this.RQc(b),this.KGb(h),Q);return 32}Cxn(b,h,u,B,Q){b=h.view.mb;
if(!b||PE.Uf.Mbc(b.ng))return 8;if(PE.Xg.hAa(me.ParagraphReader.AU,b.ng))return PE.Hc.Yb(pd.a.Ye,{["Reason"]:pe.a.yO}),8;if(1===u)return 3===this.ga.mode||2===this.ga.mode?32:8;u=b.hb.lb;h=this.TAj(h);Q=3===Q.Qx;if(1===u.length&&Ge.SelectionEditor.ef(u.J(0)))return u=u.J(0).node,this.J6.value.wId(this.RQc(u),this.KGb(h),Q),32;b=[];for(B=0;B<u.length;B++){const ca=u.J(B);(!B&&Ge.SelectionEditor.Fk(ca)||me.ParagraphReader.nm(ca)||Ge.SelectionEditor.nl(ca))&&b.push(ca.node)}if(!b.length)return 8;u=Array(b.length);
for(B=0;B<b.length;B++)u[B]=this.RQc(b[B]);u=Mu.APropertySet.D$h(u);this.J6.value.wId(u,this.KGb(h),Q);return 32}RQc(b){const h=new Od.DictionaryPropertySet;h.setValue($c.a.ww,me.ParagraphReader.Kx(b));const u=this.qW.hFa(b);var B=u.lineSpacing;h.setValue($c.a.N4a,B.unit);h.setValue($c.a.xa,B.value);B=u.beforeSpacing;h.setValue($c.a.dhc,B.unit);h.setValue($c.a.ehc,B.value);B=u.afterSpacing;h.setValue($c.a.bhc,B.unit);h.setValue($c.a.chc,B.value);h.setValue($c.a.w2c,u.qw);h.setValue(Ud.a.keepWithNext,
me.ParagraphReader.keepWithNext(b));h.setValue(Ud.a.widowControl,me.ParagraphReader.Poc(b));h.setValue(Ud.a.keepTogether,me.ParagraphReader.keepTogether(b));return h}static get Uf(){return ti.a.instance}static get Xg(){return On.ContextSetEditor.instance}static get Hc(){return Wh.a.instance}}Object(m.a)(PE,"AParagraphDialogActor",null,[]);class FK extends PE{constructor(b,h,u,B,Q){super(b,h,u);this.Sk=B;this.Zo=Q}Tb(){super.Tb();this.ga.fb(Ob.a.b4i,vc.a.view,bm.d,96);this.ga.fb(Ob.a.c4i,vc.a.view,
bm.d,96);this.ga.fb(Ob.a.wJn,vc.a.view,bm.d,96);this.ga.fb(Ob.a.lwm,vc.a.view,bm.c,96);this.ga.fb(Ob.a.nwm,vc.a.view,bm.c,96);this.ga.fb(Ob.a.yyo,vc.a.view,bm.c,96);this.ga.fb(Ob.a.zyo,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Lun,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Vun,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Uun,vc.a.view,bm.c,96);this.ga.fb(Ob.a.Dyo,vc.a.view,bm.c,96);this.ga.fb(Ob.a.kKn,vc.a.view,bm.d,96);this.ga.fb(Ob.a.lKn,vc.a.view,bm.d,96)}TAj(b){return this.Sk.W8(b.ek)}RQc(b){const h=super.RQc(b);var u=
this.Zo.nU(b);const B=this.Zo.DG(b);h.setValue($c.a.sHa,1);h.setValue($c.a.tHa,u.Ut-B.Ut);u=this.Zo.A2a(b);h.setValue($c.a.Jnb,u.unit);h.setValue($c.a.Knb,u.value);b=this.Zo.n$b(b);b.specialIndentType&&(h.setValue($c.a.O5,b.specialIndentType),h.setValue($c.a.kUa,b.unit),h.setValue($c.a.lUa,b.value));return h}KGb(b){const h=new Od.DictionaryPropertySet;h.setValue(Jc.a.Go,this.Sk.Ft(b));h.setValue(Jc.a.rv,this.Sk.EB(b));h.setValue(Jc.a.marginTop,Math.abs(this.Sk.toa(b)));h.setValue(Jc.a.marginBottom,
Math.abs(this.Sk.Awa(b)));h.setValue(Jc.a.marginLeft,this.Sk.xJ(b));h.setValue(Jc.a.marginRight,this.Sk.jL(b));return h}}Object(m.a)(FK,"ParagraphDialogActor",PE,[]);class GK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.$xi=h}}Object(m.a)(GK,"AfterPasteEventArgs",Sys.EventArgs,[]);class HK{constructor(b){this.DEe=null;this.hkd=b}get aOd(){return null!=this.tyg?this.tyg:this.tyg=Ga.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get HYd(){this.DEe||(this.DEe=
!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(ht.a.pQh));return this.DEe}NGn(b){if(b&&Yc.OutlineElementReader.Bh(b.jwa)&&Yc.OutlineElementReader.Bh(b.Dlb)){this.hHn(b);var h=new sk.a;for(h.jd(b.jwa);h&&h.currentNode;){const u=this.ESd(h),B=me.ParagraphReader.Wb(u);B&&me.ParagraphReader.Qfb(u)&&this.LGn(u);const Q=h.currentNode.id===b.Dlb.currentNode.id;B&&this.HYd&&u.tj.yha(u.type).wbe(new GK(u,Q));if(Q)break;gf.OutlineElementNavigator.$r(h,!1,!1)}}}LGn(b){r.ULS.sendTraceTag(590435214,
307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.qhc;b=Je.a.Oc(b,0);Tt.LVc(h)?this.aOd.F9d(b,h):this.hkd.F9d(b,h)}hHn(b){if(b.jwa.currentNode&&b.Dlb.currentNode&&b.jwa.currentNode.id===b.Dlb.currentNode.id){const h=this.ESd(b.jwa);me.ParagraphReader.Wb(h)?this.PGn(h,b.tzn,b.szn):r.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}PGn(b,h,u){r.ULS.shipAssertTag(590956771,
307,0<=h);r.ULS.shipAssertTag(590958592,307,0<=u);var B=me.ParagraphReader.text(b);if(""!==B){var Q=Je.a.createTextRange(b,h,u);Q=ok.a.EA(Q,!1);if(1===Q.length){const ca=Q[0];Q=B.substring(h,u).trim();B=B.substring(ca.cpBegin,ca.cpEnd).trim();h=Q===B;Q=Je.a.createTextRange(b,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&h&&!ok.a.y4a(B))b=ca.hyperlink.url;else if(h)b=B;else{r.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}Tt.LVc(b)?this.aOd.tQa(Q,b,!1):this.hkd.tQa(Q,b,!1)}else r.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",Q.length)}}ESd(b){const h=gf.OutlineElementNavigator.Ce(b);gf.OutlineElementNavigator.Wd(b);return h}}Object(m.a)(HK,"PastedContentsProcessorPostMergeAfterPaste",null,[561]);class zH extends tw{constructor(b,h,u,B,Q,ca,qa,Qa){super(B);this.EQe=7;this.hw=
this.luc=null;this.lDe=0;this.iDe=b;this.Ik=h;this.zn=u;this.he=Q;this.$Sj=qa;this.xYa=Qa;this.r3=this.he.ORa("UserAction","WordIgnoreAll")}Wdg(b){this.iDe.LJi();this.luc=this.zn.noa(b);this.xYa.toi(this.luc,null,!1);return this.iDe.xBj(this.luc)?(this.r3.start(),this.hw=new Qg.GraphTransaction(15),this.hw.Db(b.node),!0):!1}O$d(b){this.wNb(b.node);return!0}H3c(b){this.wNb(b);return!0}P$d(b){this.wNb(b.node)}akg(b){this.hw.dispose();this.luc.errorDetails.Wqb(b.actionId);this.r3.stop();r.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.lDe,this.r3.li,this.luc.errorDetails.proofingType));return!0}Ilc(b,h){if(super.Ilc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}Wdi(b){if(b&&b.type!==this.EQe){const h=vd.GraphIterator.eb(b);return h.zb(this.EQe)?h.ld(this.EQe):b}return b}YLm(b,h){return this.iDe.whe(h.errorDetails)&&!this.Ik.n9(Je.a.createTextRange(b,h.Ac,h.end))}wNb(b){if(b){var h=this.zn.s4(b,
u=>this.YLm(b,u));this.$Sj?this.zn.Cob(b,h,!0):0<h.length&&(b.gl(4,!0),this.zn.CLb(b));this.lDe+=h.length}}}Object(m.a)(zH,"IgnoreAllCallbackSteps",tw,[]);class IK{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){this.t4c=(Sc,ld,Hd,Ie,fe)=>{if(1===Hd)return 32;Sc=this.HI.eFa(ld.view.mb.ng);if(Sc=Jj.a.qg(Sc))fe[xm.a.LabelText]=Sc.displayName;return 32};this.Noa=(Sc,ld,Hd,Ie,fe,de)=>{const ne=new zH(this.B4j,this.Ik,this.zn,this.De,this.he,this.EW,0,this.xYa);return new hx(Sc,ld,Hd,Ie,fe,de,ne,this.ga,
this.ib,this.De,"IgnoreAllOperation")};this.yDb=(Sc,ld,Hd,Ie,fe,de)=>{const ne=new zH(this.r_j,this.Ik,this.zn,this.De,this.he,this.EW,1,this.xYa);return new hx(Sc,ld,Hd,Ie,fe,de,ne,this.ga,this.ib,this.De,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ik=h;this.ib=u;this.De=B;this.zn=Q;this.HI=ca;this.he=qa;this.B4j=Qa;this.r_j=rb;this.JXb=Lb.WWc;this.EW=Lb;this.xYa=Yb;this.kFe=gc;this.Y9a=Fc}Tb(){this.kFe&&(mt.LB()?this.ga.fb(Ob.a.Noa,vc.a.Tc,this.yum.bind(this),1028):this.ga.vT(Ob.a.Noa,vc.a.view,
this.Noa,1028));this.JXb&&this.ga.vT(Ob.a.yDb,vc.a.view,this.yDb,1028);this.ga.fb(Qc.a.t4c,vc.a.view,this.t4c,96)}yum(b,h,u,B,Q){if(1===u)return 32;r.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.Y9a.Nwf(Q?Q:h,null,Mi.b.IgnoreAll);return 32}}Object(m.a)(IK,"ProofingActor",null,[]);var bN=c(1712);class aD{constructor(b,h,u,B,Q,ca,qa,Qa,rb){this.Hp=this.QMa=this.Swd=this.Twd=null;this.rE=this.Mr=this.Lp=0;this.Lab=this.Kab=!1;this.dba=this.O$a=this.N$a=this.L$a=this.P$a=
0;this.Uvd=null;this.Lea=this.FW=this.Sq=this.sQ=0;this.Sl=null;this.nvb=0;this.WWf=Lb=>{var Yb;if(5===this.nvb){const gc=Object.assign(new Ub.a,{extendedProperties:new Map});gc.extendedProperties.set("status",Lb.data.status.toString());gc.extendedProperties.set("httpStatus",Lb.data.Qe.toString());(null===(Yb=v.AFrameworkApplication.K)||void 0===Yb?0:Yb.$("ShouldLogPicturesExtendedHealthKpis"))?(Yb={name:Xl.c.kWd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:gc},gc.extendedProperties.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:Xl.c.zac,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:gc},optionalVeto:Yb})):xa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,gc)}r.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Lb.data.status,["HttpStatus"]:Lb.data.Qe,["Id"]:Lb.data.id,["ResponseData"]:Lb.data.se},
OE.a[this.nvb]);this.Tde()};this.Rj=u;this._image=b;this._context=h;this.Lod=!1;(b=aD.ai.ru(h.node))&&b.rf(Jc.a.MGf)&&(this.Lod=!0);this.dwc=B.$("ImageDataURLPresentationIsEnabled");this.Ddk=B.$("WordOartPostRequestIsEnabled");this.Ga=B;this.nr=Q;this.he=ca;this.Ud=qa;this.Lm=Qa;this.lK=rb;this.og=Re.a.getInstance(Xl.a);this.azm();this.x7d=this.xgc.bind(this)}azm(){this.Hp="";this.Lp=Dd.ImageReader.iF(this._image);this.Mr=Dd.ImageReader.EG(this._image);this.dba=Dd.ImageReader.Uib(this._image);this.rE=
Dd.ImageReader.h0(this._image);this.Kab=Dd.ImageReader.jRd(this._image);this.Lab=Dd.ImageReader.GFb(this._image);const b=Dd.ImageReader.mca(this._image);this.P$a=Math.max(b.top,0);this.L$a=Math.max(b.bottom,0);this.N$a=Math.max(b.left,0);this.O$a=Math.max(b.right,0);this.Sl=yb.a.nil;this.QMa=null;this.nvb=Dd.ImageReader.vi(this._image)}FDd(b,h){return(new bN.a(this.nr,this.nvb,this.Ga,this.Lp,this.Mr,this.rE,this.dba,this.P$a,this.L$a,this.N$a,this.O$a,this.Kab,this.Lab,this.Lod)).build(this._context.node,
this._image,b,h)}resize(b,h){this.Hp="Resize";this.tje();Gj.a.mark(this.U9b());this.Lp=b;this.Mr=h;this.sendMessage(!1,this.x7d)}Cw(b){this.Hp="Styles";this.tje();Gj.a.mark(this.U9b());this.dba=b;this.sendMessage(!1,this.x7d)}Ajo(b,h,u){this.Hp="Rotation";this.tje();this.rE=b;this.Kab=h;this.Lab=u;this.sendMessage(!1,this.x7d)}zjo(b,h){this.Hp="SwordRequestManager";this.tje();this.QMa=b;this.rE=h.angle;this.Lp=h.width;this.Mr=h.height;this.dba=h.styleId;this.P$a=h.top;this.L$a=h.bottom;this.N$a=h.left;
this.O$a=h.right;this.Sl=h.yX;this.sendMessage(!1,this.x7d)}sendMessage(b,h){if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var u=this.egb(u);const B=Dd.ImageReader.yoa(this._image,this.Ga,this.nr);B?Jx.a.xpb(this._image,B,4):this._image.setValue(Sh.a.jPa,!0);u.dispose()}this.Ttj(b);Gj.a.mark(this.U9b());b=new bb.QueryStringBuilder(this.FDd(b,!0));this.dwc&&b.ye(fh.a.fOh,"true");this.Ddk?(u=new bb.QueryStringBuilder("WordOart.ashx"),v.AFrameworkApplication.He.sj(u.toString(),2,b.toString(),
{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.WWf,null)):v.AFrameworkApplication.He.sj(b.toString(),1,"",null,!0,0,h,this.WWf,null)}egb(b){b=this.Sl&&this.Sl!==yb.a.nil?new Qg.GraphTransaction(7,Ob.a.c9):new Qg.GraphTransaction(15);b.Db(this._context.node);return b}get pNj(){const b=new Qg.GraphTransaction(3);b.Db(this._context.node);return b}Tde(){this.rMc();this.KLd();const b=this.pNj;var h=Dd.ImageReader.QEa(this._image,this._context.node.Lc,this.Ga,this.nr);this._image.setValue(Sh.a.jPa,
!1);this._image.setValue($c.a.uTc,h);this._image.setValue($c.a.DJ,-1);this._image.setValue(Sh.a.w5,1);h=Dd.ImageReader.yoa(this._image,this.Ga,this.nr);this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty($c.a.Y9d),this._image.removeProperty($c.a.W9d),h&&Jx.a.xpb(this._image,h,3));b.dispose();aD.zp();this.QMa&&this.QMa()}Ttj(b){this.he&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Twd=this.he.Vf("WebServiceCall",b))}rMc(){this.Twd&&(this.Twd.stop(),
this.Twd=null)}tje(){if(this.he){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Hp,OE.a[this.nvb]);this.Swd=this.he.Vf("WebServiceCall",b)}}KLd(){this.Swd&&(this.Swd.stop(),this.Swd=null)}static get ai(){return Zo.PageNavigator.instance}static zp(){const b=new mg.StandardDialog;b.Cd=0;b.rx(kl.a.LAn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Fb.App.za&&Fb.App.za.updateCommandUI()}}Object(m.a)(aD,"RenderedImageEditOperation",
null,[583]);var AH=c(299),MF=c(509);class JK extends aD{constructor(b,h,u,B,Q,ca,qa,Qa,rb){super(b,h,u,B,Q,ca,qa,Qa,rb);this.og=Re.a.getInstance(Av.a)}sendMessage(b,h){Object(AH.a)(()=>{let u;u=this.egb(u);this._image.setValue(Sh.a.w5,0);u.dispose()});this.Ttj(b);Gj.a.mark(this.U9b());b=new bb.QueryStringBuilder("WordOart.ashx");this.nYg=this.ajb(!0,!1);b=new MF.a(b.toString(),2,this.ajb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,
null,null,null,null,null,null,["Content-Type"],null,"text");v.AFrameworkApplication.He.send(b).Qya(h,u=>{this.WWf(u)})}xgc(b){try{var h=JSON.parse(b.data.xTa);this.v3j=h[fh.a.KRc];this.ank=h[fh.a.width];this.P3j=h[fh.a.height];this.YJg=h[fh.a.EFc];this.Xtc=Array(4);this.Xtc[0]=h[fh.a.Ugb];this.Xtc[1]=h[fh.a.Vgb];this.Xtc[2]=h[fh.a.Wgb];this.Xtc[3]=h[fh.a.Tgb];this.N1g=void 0!==h[fh.a.Kxa]?"true"===h[fh.a.Kxa].toLowerCase():null;Object(AH.a)(()=>{this.zcd();this._context.node.Ui().contentReplicator.forceOutbound(()=>
{this.lDl()},null,null)})}catch(u){Jx.a.tIa&&(b=Object.assign(new Ub.a,{extendedProperties:new Map([["Renderer",Av.b.CEa],["Exception",u.message],["Operation",this.Hp]])}),h={name:Av.d.RTh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:Av.d.fLd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})),
r.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",u.message,this.Hp,Dd.ImageReader.vi(this._image)),this.Tde()}}L6d(){r.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}zcd(){let b;b=this.egb(b);this._image.setValue(Ud.a.tR,this.v3j);this.YJg&&this._image.setValue(Ud.a.QBd,this.YJg);this._image.setValue(Ud.a.Mwa,this.ank);this._image.setValue(Ud.a.Nwa,this.P3j);this._image.setValue(Ud.a.YPa,this.Xtc);
this.I4j&&this._image.setValue($c.a.IHb,this.I4j);Jx.a.xpb(this._image,this.nYg,3);this._image.setValue(Jc.a.Rgb,this.nYg);this.N1g?this._image.setValue(Ud.a.L3a,this.N1g):this._image.removeProperty(Ud.a.L3a);this.bWk();b.dispose()}bWk(){this._image.removeProperty($c.a.at);this._image.removeProperty($c.a.DJ);this._image.removeProperty($c.a.Y9d);this._image.removeProperty($c.a.W9d)}lDl(){this.lK.jIa(this._context);if(this.Sl&&this.Sl!==yb.a.nil){var b=this._context.node.Ui();const h=new W.a(this.Sl,
1);this.Lm.B4b(b,h)}this.Ud.Us(13);Jx.a.tIa&&(b=new Map([["Renderer",Av.b.CEa],["Type",Dd.ImageReader.vi(this._image).toString()]]),this.og.logKpiSuccess({kpiName:Av.d.fLd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b}},blockFutureEmissionDurationInMs:3E5}));this.rMc();this.KLd();Gj.a.mark(this.T9b());Object(AH.a)(()=>{let h;h=this.egb(h);this._image.setValue(Sh.a.w5,1);h.dispose()});this.QMa&&this.QMa()}ajb(b,h){b=new bb.QueryStringBuilder(this.FDd(b,
h));b.ye(fh.a.sWd,"true");return b.toString()}U9b(){return 51511}T9b(){return 51512}}Object(m.a)(JK,"RenderedGraphicEditOperation",aD,[]);class KK extends aD{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){super(b,h,u,B,Q,ca,qa,Qa,rb);this.iTg=null;this.L6d=Yb=>{const gc=this.FDd(!0,!1);let Fc;Fc=this.egb(Fc);this._image.setValue(Jc.a.FFc,this.Uvd);var Sc=Ga.a.instance.Oa("Box4.IFeatureHelper");if(Jx.a.tIa){const Ie=new Map([["Renderer",Av.b.legacy],["Type",Dd.ImageReader.vi(this._image).toString()]]);this.og.logKpiSuccess({kpiName:Av.d.QTh,
optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:Ie}},blockFutureEmissionDurationInMs:3E5})}Sc&&Sc.isFeatureEnabled(51)&&this._image.setValue(Jc.a.PMd,this.iTg);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Rj.dge(this._image,this.rE,this.Kab,this.Lab);const ld=Dd.ImageReader.yoa(this._image,this.Ga,this.nr),Hd=()=>{ld&&Jx.a.xpb(this._image,ld,3);Jx.a.xpb(this._image,gc,3);this.Rj.bge(this._image,
Of.a.xG(this.sQ),Of.a.xG(this.FW),Of.a.xG(this.Sq),Of.a.xG(this.Lea));this._image.setValue(Jc.a.Rgb,gc);Dd.ImageReader.Jy(this._image)||this._image.setValue(Jc.a.DFa,1);this.Rj.Kfe(this._image,this.Lp,this.Mr);this.Ga.$("WordEditorImageRotateIsEnabled")&&!this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Rj.dge(this._image,this.rE,this.Kab,this.Lab);2===Yb.data.status&&Dd.ImageReader.E0(Yb.data.se)&&(this._image.setValue($c.a.at,Yb.data.se),Yb.data.request&&this._image.setValue($c.a.IHb,
Jx.a.cNc("POST"===Yb.data.request.get_httpVerb()?Yb.data.request.get_body():Yb.data.request.get_url())));this.QMa&&this.QMa();this.lK.jIa(this._context);if(this.Sl&&this.Sl!==yb.a.nil){const Ie=this._context.node.Ui(),fe=new W.a(this.Sl,1);this.Lm.B4b(Ie,fe)}this.Ud.Us(13);this.rMc();this.KLd();Gj.a.mark(this.T9b())};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Sl&&this.Sl!==yb.a.nil&&(Sc=this._context.node.Ui())&&Sc.contentReplicator){Fc.dispose();Sc.contentReplicator.forceOutbound(()=>
{let Ie;Ie=this.egb(Ie);Hd();Ie.dispose()},null,null);return}Hd();Fc.dispose()};this.og=Re.a.getInstance(Av.a);this.ePe=Lb}U9b(){return 51511}T9b(){return 51512}xgc(b){try{var h=JSON.parse(b.data.se);const Q=Sys.Net.XMLDOM("string"===typeof h[fh.a.hrh]?h[fh.a.hrh]:null);this.Uvd="string"===typeof h[fh.a.RBd]?h[fh.a.RBd]:null;const ca=Ga.a.instance.Oa("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(51)&&(this.iTg="string"===typeof h[fh.a.D7b]?h[fh.a.D7b]:null);Z.a.Kt&&Q.setProperty("SelectionNamespaces",
"xmlns:mc='"+We.a.oAk+"'");const qa=Q.selectSingleNode("/mc:AlternateContent");if(!qa)throw gt.a.argument("Alternate content element could not be retrieved!");const Qa=qa.firstChild;if(!Qa)throw gt.a.argument("Alternate content choice element could not be retrieved!");const rb=Qa.firstChild;if(!rb)throw gt.a.argument("Drawing element could not be retrieved!");var u=rb.firstChild;if(!u)throw gt.a.argument("Inline element could not be retrieved!");h=b=null;const Lb=RegExp("effectExtent"),Yb=RegExp("extent");
for(const Fc of u.childNodes)-1!==Fc.nodeName.search(Lb)&&(b=Fc),-1!==Fc.nodeName.search(Yb)&&(h=Fc);if(!b||!h)throw gt.a.argument("Effect extent or extent could not be retrieved!");this.sQ=parseInt(b.selectSingleNode("@l").text);this.FW=parseInt(b.selectSingleNode("@r").text);this.Sq=parseInt(b.selectSingleNode("@t").text);this.Lea=parseInt(b.selectSingleNode("@b").text);const gc=Cf.c(this.rE);if(45<=gc&&135>=gc||225<=gc&&315>=gc){const Fc=parseInt(h.selectSingleNode("@cx").text);var B=parseInt(h.selectSingleNode("@cy").text);
u=Fc/2;B/=2;this.sQ-=u-B;this.FW+=u-B;this.Sq-=B-u;this.Lea+=B-u}}catch(Q){Jx.a.tIa&&(B=Object.assign(new Ub.a,{extendedProperties:new Map([["Renderer",Av.b.legacy],["Exception",Q.message],["Operation",this.Hp]])}),u={name:Av.d.Uql,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:B},B.extendedProperties.set("ErrorLevel","warning"),this.og.logKpiFailure({kpiName:Av.d.QTh,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:B},optionalVeto:u}));r.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",Q.message,this.Hp,OE.a[this.ePe]);this.Tde();return}this.sendMessage(!0,this.L6d)}}Object(m.a)(KK,"RenderedDrawingEditOperation",aD,[]);class LK extends aD{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){super(b,h,u,B,Q,ca,qa,Qa,rb);this.Raa=null;this.L6d=gc=>{var Fc;const Sc=this.FDd(!0,!1);let ld;ld=this.egb(ld);this._image.setValue(Jc.a.WMb,
this.Uvd);const Hd=Dd.ImageReader.yoa(this._image,this.Ga,this.nr);(null===(Fc=v.AFrameworkApplication.K)||void 0===Fc?0:Fc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.og.logKpiSuccess({kpiName:Xl.c.zac});const Ie=()=>{Hd&&Jx.a.xpb(this._image,Hd,3);Jx.a.xpb(this._image,Sc,3);this.Rj.bge(this._image,Of.a.xG(this.sQ),Of.a.xG(this.FW),Of.a.xG(this.Sq),Of.a.xG(this.Lea));this._image.setValue(Jc.a.Rgb,Sc);Dd.ImageReader.Jy(this._image)||this._image.setValue(Jc.a.DFa,1);this._image.setValue(Jc.a.Z2c,
this.dba);this._image.setValue($c.a.rvm,-1);this.od.isFeatureEnabled(91)&&Dd.ImageReader.Y$b(this._image)&&this.No.Ice(this._image);this._image.setValue(Sh.a.jPa,!1);this.Rj.Kfe(this._image,this.Lp,this.Mr);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Rj.dge(this._image,this.rE,this.Kab,this.Lab);this.Ga.$("WordEditorImageCropIsEnabled")&&this.Rj.pcg(this._image,this.P$a,this.L$a,this.N$a,this.O$a);2===gc.data.status&&Dd.ImageReader.E0(gc.data.se)&&(this._image.setValue($c.a.at,gc.data.se),gc.data.request&&
this._image.setValue($c.a.IHb,Jx.a.cNc("POST"===gc.data.request.get_httpVerb()?gc.data.request.get_body():gc.data.request.get_url())));this.QMa&&this.QMa();this.lK.jIa(this._context);if(this.Sl&&this.Sl!==yb.a.nil){const fe=this._context.node.Ui(),de=new W.a(this.Sl,1);this.Lm.B4b(fe,de)}this.Ud.Us(13);this.rMc();this.KLd();Gj.a.mark(this.T9b())};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Sl&&this.Sl!==yb.a.nil&&(Fc=this._context.node.Ui())&&Fc.contentReplicator){ld.dispose();
Fc.contentReplicator.forceOutbound(()=>{let fe;fe=this.egb(fe);Ie();fe.dispose()},null,null);return}Ie();ld.dispose()};this.ePe=Lb;this.od=Yb}U9b(){return 7988}T9b(){return 7989}get No(){this.Raa||(this.Raa=new wK.a);return this.Raa}xgc(b){var h;try{const u=b.data.yja;this.Uvd=b.data.se;Z.a.Kt&&u.setProperty("SelectionNamespaces","xmlns:pic='"+We.a.JAn+"'");const B=u.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.sQ=parseInt(B.selectSingleNode("@l").text);this.FW=parseInt(B.selectSingleNode("@r").text);
this.Sq=parseInt(B.selectSingleNode("@t").text);this.Lea=parseInt(B.selectSingleNode("@b").text)}catch(u){b=Object.assign(new Ub.a,{extendedProperties:new Map});b.extendedProperties.set("exception",u.message);b.extendedProperties.set("operation",this.Hp);(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Xl.c.kWd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.og.logKpiFailure({kpiName:Xl.c.zac,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):xa.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);r.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",u.message,this.Hp,OE.a[this.ePe]);this.Tde();return}this.rMc();Gj.a.mark(this.T9b());this.sendMessage(!0,
this.L6d)}}Object(m.a)(LK,"RenderedPictureEditOperation",aD,[]);class MK{constructor(b,h,u,B,Q,ca,qa,Qa){this.Rj=b;this.Ga=h;this.nr=u;this.he=B;this.Ud=Q;this.Lm=ca;this.lK=qa;this.od=Qa}create(b,h){const u=Dd.ImageReader.vi(b);return hk.App.instance.HU(u)?new JK(b,h,this.Rj,this.Ga,this.nr,this.he,this.Ud,this.Lm,this.lK):10===u||11===u||48===u||4===u?new KK(b,h,this.Rj,this.Ga,this.nr,this.he,this.Ud,this.Lm,this.lK,u):5===u?new LK(b,h,this.Rj,this.Ga,this.nr,this.he,this.Ud,this.Lm,this.lK,u,
this.od):null}}Object(m.a)(MK,"Factory",null,[558]);class NK{constructor(){this.ALc=b=>{const h=window.performance.now(),u=lk.a.xr();if(u){b=pH.a(b.customData,u);b=Fa.a.zs(b,u);var B=0,Q=new Qg.GraphTransaction(3);try{for(Q.Db(u);b.moveNext();){if(!me.ParagraphReader.kh(b.iterator))continue;const ca=b.currentNode;this.jTh(ca)&&(B++,ca.gl(4,!0));const qa=window.performance.now()-h;if(2500<B||100<qa){this.myb=null;this.O4c(ca);break}}}finally{Q&&Q.dispose()}}else Pc.b(570450380,3018,10,"PageContentNode not found")};
this.myb=null}$si(){const b=lk.a.xr();this.$4c(b);this.O4c(null)}O4c(b){this.myb&&(v.AFrameworkApplication.oc.Ze(this.myb),this.myb=null);this.myb=new bf.a(1,1,1,this.ALc,198);this.myb.customData=b;v.AFrameworkApplication.oc.Xb(this.myb)}$4c(b){const h=pH.b(b);if(h){var u=new Qg.GraphTransaction(3);try{for(u.Db(b);h.moveNext();){if(!me.ParagraphReader.kh(h.iterator))continue;const B=h.currentNode;this.jTh(B)&&B.gl(4,!0)}}finally{u&&u.dispose()}}}jTh(b){b=b.dH;for(const h of b)if(h.Fkb)return 0<h.aRb;
return!1}}Object(m.a)(NK,"RenderParagraphsContainingTabs",null,[]);class OK{constructor(b,h){this.bye=!0;this.Ksc=null;this.qpl=()=>{this.Ksc=null;this.bye=!0;this.RMa&&this.RMa.dVa(!Fb.App.mP())};this.W8a=(u,B,Q)=>{if(1===Q)return 32;2===Q&&(u=!1,Fb.App.mP()?this.bye=!1:this.bye?u=!0:this.SXo(),this.RMa&&this.RMa.dVa(u));return 32};this.ga=b;this.RMa=h}Tb(){this.ga.fb(Za.a.W8a,vc.a.application,this.W8a,1124)}SXo(){this.Ksc?v.AFrameworkApplication.oc.Ze(this.Ksc):this.Ksc=new bf.a(4,1,5E3,this.qpl);
v.AFrameworkApplication.oc.Xb(this.Ksc)}}Object(m.a)(OK,"SaveStatusActor",null,[]);class PK{get G$f(){return null!=this.XEg?this.XEg:this.XEg=Ga.a.instance.Oa("Box4.ISaveStyleManager")}get p3n(){return this.o3n||(this.o3n=Ga.a.instance.Oa("Box4.IResetAndDeleteStyleManager"))}get eo(){return null!=this.TFg?this.TFg:this.TFg=Ga.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(u,B,Q)=>{u=lk.a.zJb(B);if(1===Q||u)return u?8:32;this.J6.value.B7k(B);return 32};this.LCb=(u,B,
Q)=>{u=lk.a.zJb(B);if(1===Q||u)return u?8:32;this.J6.value.Eal(B,this.ga);return 32};this.mdf=(u,B,Q)=>{u=lk.a.zJb(B)||this.jpo();if(1===Q||u)return u?8:32;this.J6.value.mdf(B);return 32};this.ga=b;this.J6=h}get uc(){return null!=this.EIg?this.EIg:this.EIg=Ga.a.instance.resolve("Box4.Styles.IWACStyleReader")}Tb(){this.ga.fb(Ob.a.applyStyles,vc.a.view,this.applyStyles,1028);this.ga.fb(Ob.a.LCb,vc.a.view,this.LCb,4);this.ga.fb(Ob.a.pDb,vc.a.view,this.mdf,4);this.ga.fb(Ob.a.F$f,vc.a.view,this.f9n.bind(this),
4);this.ga.fb(Ob.a.Y8f,vc.a.view,this.Z8f.bind(this),4);this.ga.fb(Ob.a.hdf,vc.a.view,this.djl.bind(this),4)}f9n(b,h,u){b=lk.a.zJb(h)||this.opo();if(1===u||b)return b?8:32;this.G$f.e9n();return 32}Z8f(b,h,u){b=lk.a.zJb(h)||this.mpo();if(1===u||b)return b?8:32;this.p3n.Z8f();return 32}djl(b,h,u){b=lk.a.zJb(h)||this.ipo();if(1===u||b)return b?8:32;this.J6.value.cjl();return 32}ipo(){return"{}"===EE.a.wrb?!0:!1}mpo(){if(0==EE.a.X4.size)return!0;var b=EE.a.X4;const h=this.uc.yr();let u=0;for(const B of b.values())b=
h.jj(B),this.uc.je(b,h)||u++;return 0==u?!0:!1}opo(){var b=EE.a.wrb,h=EE.a.X4;const u=this.uc.yr();if(0==h.size)return!0;if(!({Hu:b}=G.d(b)).returnValue)return r.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const Q of h.values()){h=u.jj(Q);var B=b[Q];if(null==B)return!1;if(B=lk.a.CTd(B)){if(h=lk.a.vPc(h,u),lk.a.vWc(h,B))return!1}else r.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}jpo(){var b=
lk.a.xr();if(!b)return Pc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new tv.WACStyleSet).XX(b);const h=b.BO;for(let B=0;B<h;B++){var u=b.mFa(B);if(this.uc.isHidden(u)||!this.uc.je(u,b))continue;const Q=this.uc.GG(u);if(2===Q||1===Q)if(!u.hasProperty(Jc.a.linkedStyle)||2===Q)if(u=u.ja(Jc.a.SK,null),!(u&&0<u.length))return!1}return!0}}Object(m.a)(PK,"StylesActor",null,[]);class IG{constructor(b){this.gke=(h,u,B)=>{h=v.AFrameworkApplication.ua;if(1===B)return 1!==h.mode||fc.SessionStatusManager.instance.Uj?
2:32;xa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,IG.xB,null);const Q={};Q[H.a.Dyf]=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName");Q[H.a.Mni]="true";v.AFrameworkApplication.kP().execute(ca=>{ca.sendMessage(L.a.BBo,Q)});return v.AFrameworkApplication.va.processAction(Ob.a.readingMode,2)};this.ga=b}Tb(){this.ga.ra(Qc.a.gke,vc.a.view,this.gke)}}IG.xB="wwaengidc";Object(m.a)(IG,"SwitchToClassicViewModeActor",null,[]);class QK{constructor(b,h,u,B,Q,ca,qa,Qa,rb){this.angle=
u;this.styleId=B;this.width=b;this.height=h;this.top=Q;this.bottom=ca;this.left=qa;this.right=Qa;this.yX=rb}}Object(m.a)(QK,"SWordData",null,[]);class RK{constructor(b,h){this.Ak=this.Y2=this.uq=null;this.tPe=this.QYb=!1;this.sQ=this.FW=this.Lea=this.Sq=this.dba=this.Mr=this.Lp=this.rE=0;this.Sl=null;this.M9=()=>{this.tPe=!1;this.QYb&&this.vMc()};this.Jo=b;this.pBc=h;this.mqi()}mqi(){this.FW=this.sQ=this.Lea=this.Sq=this.dba=this.Mr=this.Lp=this.rE=-1;this.Sl=yb.a.nil}vMc(){this.tPe||(this.X_o(),
this.Tbl(),this.QYb=!1)}Tbl(){this.Ak=new QK(this.Lp,this.Mr,this.rE,this.dba,this.Sq,this.Lea,this.sQ,this.FW,this.Sl);this.pBc.create(this.Y2,this.uq).zjo(this.M9,this.Ak);this.tPe=!0;let b;Object(Cb.a)(3,this.Y2)?b=OE.a[Dd.ImageReader.vi(this.Y2)]:(r.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");r.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Lp,this.Mr,this.rE,this.dba,this.Sq,this.Lea,this.sQ,this.FW,b);this.mqi()}X_o(){this.Lp=-1!==this.Lp?this.Lp:this.Y2.ja($c.a.BFa,-1);this.Mr=-1!==this.Mr?this.Mr:this.Y2.ja($c.a.AFa,-1);this.Lp=-1!==this.Lp?this.Lp:this.Jo.iF(this.Y2);this.Mr=-1!==this.Mr?this.Mr:this.Jo.EG(this.Y2);this.rE=-1!==this.rE?this.rE:this.Jo.h0(this.Y2);this.dba=-1!==this.dba?this.dba:this.Jo.Uib(this.Y2);const b=this.Jo.mca(this.Y2);this.Sq=-1!==this.Sq?this.Sq:b.top;this.Lea=-1!==this.Lea?this.Lea:b.bottom;this.sQ=
-1!==this.sQ?this.sQ:b.left;this.FW=-1!==this.FW?this.FW:b.right}KKn(b,h,u,B){this.uq=b;this.rE=u;this.QYb=!0;this.Y2=h;this.Sl=B;this.vMc()}JKn(b,h,u,B,Q){this.uq=b;this.QYb=!0;this.Y2=h;this.Sl=Q;this.Y2.setValue($c.a.BFa,u);this.Y2.setValue($c.a.AFa,B);this.vMc()}OKn(b,h,u){this.uq=b;this.QYb=!0;this.Y2=h;this.dba=u;this.vMc()}EKn(b,h,u,B,Q,ca){this.uq=b;this.Sq=u;this.Lea=B;this.sQ=Q;this.FW=ca;this.QYb=!0;this.Y2=h;h=b=0;({width:b,height:h}=this.Jo.Fib(this.Y2));this.Lp=b-(Q+ca)/1E5*b;this.Mr=
h-(u+B)/1E5*h;this.vMc()}}Object(m.a)(RK,"SWordRequestManager",null,[555]);class NF{constructor(b,h,u,B=null,Q=null,ca=null,qa=null,Qa=null,rb=null,Lb=null){this.Lm=null;this.Njh=!1;this.iEo=(Yb,gc,Fc,Sc,ld)=>{if(1===Fc)return 32;const Hd=Yb===Ob.a.jeg;if(!gc.view.qe)return 2;const Ie=gc.view,fe=Ie.mb,de=fe.ng;if(!de||NF.Uf.R_(de))return 2;if(this.Zm&&this.Zm.instance&&this.Zm.instance.EU(de))return 4;Yb=null;var ne=dd.ActionManager.bya;let ye=!1;var Vf=Ge.SelectionEditor.ef(de);if(de.gx){if(fe.hb.HJ&&
(ne=de.getContext(0),Yb=new vd.GraphIterator,Yb.set(ne.node),Yb.gp(),ne=Hd?Ob.a.nag:Ob.a.Tee),ne=this.LTe.nFn(ne),ne===dd.ActionManager.bya){var Og=NF.Xg.HT(de,16);Og?(Hd&&(ne=Ob.a.N4d),Yb=new vd.GraphIterator,Yb.set(Og.node),Yb.rd()):ne=Hd?Ob.a.SG:Ob.a.LO}}else if(de.Vk)if(Yb=new vd.GraphIterator,Yb.set(de.node),Ge.SelectionEditor.yu(Yb),Rj.OutlineReader.$Qa(de))ne=Hd?Ob.a.nag:Ob.a.Tee;else{if(this.gDe&&this.gDe.nro(de))return this.gDe.z8c(de,Ie.$b,Hd),32;Dd.ImageReader.C3a(de)?ne=Hd?Ob.a.mag:Ob.a.lag:
(ne=Hd?this.LTe.zkm(Yb,de,ne,gc):this.LTe.ykm(Yb,de,ne,gc),Yc.OutlineElementReader.Bh(Yb)&&de.contextId===vc.a.Tc&&(ye=Yc.OutlineElementReader.JA(Yb,de,!1)),Og=Lf.ListItemReader.jg(Yb)&&ye,ne!==dd.ActionManager.bya||Jf.TableCellReader.Epa(Yb)||Og||(this.Njh||(r.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.Njh=!0),v.AFrameworkApplication.va.processAction(Ob.a.Iqi,2),this.fri(gc)))}else return 2;if(!Hd&&ne===dd.ActionManager.bya&&Jf.TableCellReader.Epa(Yb))if(qg.returnToCell(Yb),
Jf.TableCellReader.TQa(Yb)||Zi.TableReader.txi(Yb)&&Jf.TableCellReader.EEf(Yb)){if(ne=this.rok(),!ne)return 2}else ne=Ob.a.$Oi;if(ne===dd.ActionManager.bya)return 2;switch(ne){case Ob.a.$Oi:case Ob.a.N4d:Sc=ne===Ob.a.N4d;Vf&&this.m2&&this.uZ&&(Vf=this.m2.Bjf(de,-1,!0,Se.a.Fw))&&this.uZ.Pfj(Vf);Fc=32;qg.returnToCell(Yb);qg.moveToNextOrPreviousCell(Yb,Sc)&&(Vf=!0,Sc=!1,Rj.OutlineReader.Ixf(Yb)||(uf.OutlineNavigator.ePf(Yb,!1),gf.OutlineElementNavigator.Ce(Yb),me.ParagraphReader.At(Yb.currentNode)&&
(Vf=!1,me.ParagraphReader.textLength(Yb.currentNode)||(Sc=!0)),Sc||qg.returnToCell(Yb)),Sc?Yb=Cg.SelectionFactory.ne(Yb.currentNode,0):(Yb=Cg.SelectionFactory.Aq(Yb.currentNode),!Vf&&Ge.SelectionEditor.Fk(Yb.Rc)&&(Vf=Yb.toArray(),Array.removeAt(Vf,Vf.length-1),Yb=new Dh.Selection(Vf,Yb.isForward))),fe.Bc(Yb));break;case Ob.a.nag:case Ob.a.Tee:ne===Ob.a.Tee?uf.OutlineNavigator.BOi(Yb,!1):uf.OutlineNavigator.BOi(Yb,!0);fe.Bc(Cg.SelectionFactory.Aq(Yb.currentNode));Fc=32;break;case Ob.a.E$c:Fc=v.AFrameworkApplication.va.Kf(gc,
ne,Fc,!0,Sc,ld);break;default:if(Fc=v.AFrameworkApplication.va.Kf(gc,ne,Fc,!0,Sc,ld),!ye&&Vf&&(ne===Ob.a.SG||ne===Ob.a.LO)){const Bl=Ge.SelectionEditor.lX(fe.hb.lb).y;Fb.App.zic(()=>{this.Hcn(fe,Ie,Bl)})}}32===Fc&&gc.view.qe&&this.Qg.nF();return Fc};this.uma=b;this.LTe=h;this.Zm=u;this.m2=B;this.uZ=Q;this.OTe=ca;this.WJa=qa;this.od=Qa;this.Kc=rb;this.gDe=Lb}get Qg(){return this.Lm||(this.Lm=this.uma())}Tb(){const b=v.AFrameworkApplication.va,h=this.iEo;b.fb(Ob.a.tab,vc.a.view,h,1124);b.fb(Ob.a.jeg,
vc.a.view,h,1124);b.ra(Ob.a.Iqi,vc.a.view,dd.ActionManager.Lf)}Hcn(b,h,u){if(b&&h){var B=b.hb.lb;Ge.SelectionEditor.lX(B).y<u?(h=Ge.SelectionEditor.wNc(h,B,!1),h=Ge.SelectionEditor.iwa(h,{SA:!1,Hs:!1,RC:!1,oE:!0})):h=Ge.SelectionEditor.xNc(h,B,!1);b.Bc(h)}}rok(){return Ob.a.v3a}fri(){}Y_c(b,h,u){if(b&&h){var B=b.hb.lb;Ge.SelectionEditor.lX(B).y<u?(h=Ge.SelectionEditor.wNc(h,B,!1),h=Ge.SelectionEditor.iwa(h,{SA:!1,Hs:!1,RC:!1,oE:!0})):h=Ge.SelectionEditor.iwa(B,{SA:!1,Hs:!1,RC:!1,oE:!0});b.Bc(h)}}static get Uf(){return ti.a.instance}static get Xg(){return On.ContextSetEditor.instance}}
Object(m.a)(NF,"TabActor",null,[]);class BH{constructor(b){this.jwc=b}get mq(){return this.jwc}nFn(b){return b}zkm(b,h,u,B){const Q=B.view,ca=Q.mb.hb.lb;if(Jf.TableCellReader.Epa(b))return this.nxi(b,B)?Ob.a.SG:Ob.a.N4d;gf.OutlineElementNavigator.Wd(b);if(Ge.SelectionEditor.ef(h))Yc.OutlineElementReader.JA(b,h,!1)&&this.cpj(b)?u=Ob.a.ANb:Ge.SelectionEditor.mXc(Q,ca)&&this.mq.ABb(b)?u=Ob.a.SG:Ge.SelectionEditor.mXc(Q,ca)&&(u=Ob.a.SG);else if(Ge.SelectionEditor.nl(h)){if(!this.mq.ABb(b))return u;Ge.SelectionEditor.Bkb(h)?
u=Ob.a.SG:Ge.SelectionEditor.lCi(h)&&(u=this.cpj(b)?Ob.a.ANb:Ob.a.SG)}else this.mq.ABb(b)&&(u=Ob.a.SG);return u}ykm(b,h,u,B){if(Jf.TableCellReader.F0(b))return this.nxi(b,B)?Ob.a.LO:u;gf.OutlineElementNavigator.Wd(b);if(Ge.SelectionEditor.ef(h))Yc.OutlineElementReader.JA(b,h,!1)&&(!Lf.ListItemReader.jg(b)&&Yc.OutlineElementReader.isEmpty(b,!1)?u=dd.ActionManager.bya:this.hpo(b)?u=Ob.a.zgb:this.ooj(b)?u=Ob.a.qDb:this.mq.G3b(b)&&(u=Ob.a.LO));else if(Ge.SelectionEditor.nl(h)){if(!this.mq.G3b(b))return u;
Ge.SelectionEditor.Bkb(h)?u=Ob.a.LO:Ge.SelectionEditor.lCi(h)&&(u=this.ooj(b)?Ob.a.qDb:Ob.a.LO)}else this.mq.G3b(b)&&(u=Ob.a.LO);return u}cpj(b){return Lf.ListItemReader.jg(b)?!1:0<Yc.OutlineElementReader.t4(b)?!0:!1}ooj(b){if(Lf.ListItemReader.jg(b))return!1;const h=Yc.OutlineElementReader.t4(b);b=Rj.OutlineReader.LX(b.currentNode);return h<b?!0:!1}hpo(b){return Lf.ListItemReader.jg(b)?!1:0<Yc.OutlineElementReader.DG(b)?!0:!1}static Ur(){return new BH(Cr.a.jGb)}nxi(b,h){if(this.vQm){h=h.view;const u=
h.mb.hb.lb,B=new vd.GraphIterator;B.jd(b);gf.OutlineElementNavigator.Wd(B);if(Lf.ListItemReader.jg(B)&&Ge.SelectionEditor.mXc(h,u))return!0}return!1}get vQm(){var b;v.AFrameworkApplication.le("egdi3422;7g6fa693");return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(m.a)(BH,"TabActorPromoteDemoteStrategy",null,[567]);class gE extends NF{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc){super(b,h,u,B,
Q,ca,qa,Qa,rb,Lb);this.k7d=(Sc,ld)=>{Sc=ld.property;!this.g6c||Sc!==Jc.a.Go&&Sc!==Jc.a.marginLeft&&Sc!==Jc.a.marginRight||this.g6c.$si()};this.LX=(Sc,ld,Hd,Ie,fe)=>{Sc=Rj.OutlineReader.LX(this.Q6l(ld));fe.defaultTabStop=Sc;return 32};this.SYb=Yb;this.ga=Fc;this.cC();this.ga.ra(Qc.a.LX,vc.a.view,this.LX)}get g6c(){return null!=this.MEg?this.MEg:this.MEg=Ga.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}cC(){this.SYb.zl.Te(10).Mo(this.k7d)}fri(b){const h=b.view,u=h.mb;b=u.ng;if(this.WJa&&
this.Kc){var B=this.Kc.Pc(15);B.Db(b.node);b.contextId===vc.a.Jd&&v.AFrameworkApplication.va.processAction(Ob.a.HH,2);this.WJa.lXd(u.ng);B.dispose();var Q=Ge.SelectionEditor.lX(u.hb.lb).y;Fb.App.zic(()=>{this.Y_c(u,h,Q)})}}Q6l(b){return b.view.mb.hb.lb.Pa.node}static get instance(){return null!=gE.vBg?gE.vBg:gE.vBg=gE.Wl()}static Wl(){return new gE(()=>Ga.a.instance.resolve("Box4.IUndoManager"),BH.Ur(),Ga.a.instance.Ta("Box4.IExternalSelectionManager"),Ga.a.instance.resolve("Box4.IAutoCorrectRules"),
Ga.a.instance.resolve("Box4.IAutoCorrectScheduler"),Ga.a.instance.Oa("Box4.ITabPresenterFactory"),Ga.a.instance.Oa("Box4.IBlobEditor"),Ga.a.instance.Oa("Box4.IFeatureHelper"),Ga.a.instance.Oa("Box4.Graph.GraphTransactionFactory"),Ga.a.instance.Oa("Box4.Actors.IIFrameFocusStrategy"),Fb.App.ni,Ga.a.instance.Oa("Box4.ITabRenderer"),v.AFrameworkApplication.va)}}Object(m.a)(gE,"TabActor",NF,[]);class Kx{static get yt(){return null!=Kx.Iug?Kx.Iug:Kx.Iug=Ga.a.instance.resolve("Box4.IAppFrame")}static initialize(){Yq.a.ddc=
Kx.sRm;Yq.a.Bke=Kx.T2o}static sRm(b){return!Zi.TableReader.nMm(b)}static Wmb(){Kx.yt.Nic(Kx.Wmb);Kx.dxb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static T2o(b){var h,u,B;b&&((null===(h=Hr.a.instance.lb)||void 0===h?0:h.rGa)||(null===(u=Hr.a.instance.lb)||void 0===u?0:u.Ov)||(null===(B=Hr.a.instance.lb)||void 0===B?0:B.nlb))&&!Kx.dxb&&(Kx.yt.YZa(Kx.Wmb),
Kx.dxb=!0)}}Kx.dxb=!1;Object(m.a)(Kx,"TableActor",null,[]);var cN=c(919);class CH{eDl(b,h,u,B){return b?this.EBl(h,u,B):this.fDl(h,u,B)}RZh(b,h,u,B,Q){return b?this.HCl(h,u,B,Q):this.uCl(h,u,B,Q)}rCl(b){let h=!1;var u=b.isForward?b.Ke.Rc:b.Ke.Pa;b=new vd.GraphIterator;b.set(u.node);b.zb(14);u=null;Jf.TableCellReader.Tca(b)?Jf.TableCellReader.UIb(b)||(h=!0,u=qg.moveToNextRow(b)):u=qg.moveToNextColumn(b);return{returnValue:u,$cn:h}}CCl(b){var h=b.isForward?b.Ke.Rc:b.Ke.Pa;const u=new vd.GraphIterator;
u.set(h.node);u.zb(14);h=null;Jf.TableCellReader.dia(u)?Jf.TableCellReader.cia(u)||(h=new vd.GraphIterator,h.set(b.jDa.node),h.zb(14),b=Im.a.Es(h),Im.a.Es(u)>b?(qg.moveToPreviousRow(u),qg.moveToLastColumn(u),h=u.currentNode):h=qg.moveToPreviousRow(u)):h=qg.moveToPreviousColumn(u);return h}e_h(b,h){var u=b.isForward?b.Ke.Rc:b.Ke.Pa;b=new vd.GraphIterator;b.set(u.node);b.zb(14);u=null;h?Jf.TableCellReader.cia(b)||(u=qg.moveToPreviousRow(b)):Jf.TableCellReader.UIb(b)||(u=qg.moveToNextRow(b));return u}TJb(b,
h,u){for(;Jf.TableCellReader.fg(b);)if(h){if(u&&b.qxa(1)||!u&&b.xxa(1))return null;u?qg.moveToPreviousColumn(b):qg.moveToNextColumn(b)}else{if(Jf.TableCellReader.Q4(b.currentNode)){const B=new vd.GraphIterator;B.jd(b);if(this.TJb(B,!0,!0)||this.TJb(B,!0,!1)){b.jd(B);break}}else{if(!u&&qg.moveToControllingCell(b,2))break;if(u&&qg.moveToControllingCell(b))break}if(u&&Jf.TableCellReader.cia(b)||!u&&Jf.TableCellReader.UIb(b))return null;u?qg.moveToPreviousRow(b):qg.moveToNextRow(b)}return b.currentNode}T7b(b,
h){if(!Im.a.isTableRow(b))return null;b=vd.GraphIterator.eb(b.currentNode);b.zb(14);let u;const B=Zi.TableReader.MB(b.origin);do u=h?qg.moveToPreviousRow(b):qg.moveToNextRow(b);while(B&&u&&Im.a.KQa(b));return u}wmb(b,h,u,B,Q){let ca=null;gf.OutlineElementNavigator.Wd(b);const qa=Yc.OutlineElementReader.isRtl(b.currentNode);if(u)if(qg.returnToCell(b),h=Jf.TableCellReader.Tca(b),u=Jf.TableCellReader.dia(b),Q||!qa&&u||qa&&B&&h)qg.returnToContainingRow(b),(B=this.T7b(b,!0))?ca=Cg.SelectionFactory.oo(B,
!h):Q&&(gf.OutlineElementNavigator.Wd(b),Q=new sk.a,Q.jd(b),(b=gf.OutlineElementNavigator.X0(Q,!1,!1))&&(ca=Cg.SelectionFactory.oo(b,!1)));else{do qa?qg.moveToNextColumn(b):qg.moveToPreviousColumn(b);while(Jf.TableCellReader.fg(b)&&!Jf.TableCellReader.cia(b));Jf.TableCellReader.fg(b)||(ca=Cg.SelectionFactory.oo(b.currentNode,!qa))}else Yc.OutlineElementReader.JA(b,h,qa)||Ge.SelectionEditor.ef(h)||qg.returnToCell(b),ca=Cg.SelectionFactory.oo(b.currentNode,!qa);return ca}vmb(b,h,u,B,Q){let ca=null;
gf.OutlineElementNavigator.Wd(b);const qa=Yc.OutlineElementReader.isRtl(b.currentNode);if(u)if(qg.returnToCell(b),u=Jf.TableCellReader.Tca(b),h=Jf.TableCellReader.dia(b),Q||!qa&&B&&u||qa&&!B&&h)qg.returnToContainingRow(b),(B=this.T7b(b,!1))?ca=Cg.SelectionFactory.oo(B,h):(gf.OutlineElementNavigator.Wd(b),B=new sk.a,B.jd(b),(b=gf.OutlineElementNavigator.$r(B,!1,!1))&&(ca=Cg.SelectionFactory.oo(b,!0)));else{do qa?qg.moveToPreviousColumn(b):qg.moveToNextColumn(b);while(Jf.TableCellReader.fg(b)&&!Jf.TableCellReader.Tca(b));
Jf.TableCellReader.fg(b)||(ca=Cg.SelectionFactory.oo(b.currentNode,qa))}else Yc.OutlineElementReader.JA(b,h,!qa)||Ge.SelectionEditor.ef(h)||qg.returnToCell(b),ca=Cg.SelectionFactory.oo(b.currentNode,qa);return ca}}Object(m.a)(CH,"ATableCellSelectionStrategy",null,[1366]);class SK extends CH{constructor(){super()}uCl(b,h,u,B){let Q=b.lb,ca=null;if(b.Ov)if(h)if(2===Q.Ke.Hia&&!Q.isForward&&Q.Ke.Rc.equals(Q.jDa))Q=Cg.SelectionFactory.jMh(Q.jDa.node,!1);else{var qa=({$cn:b}=this.rCl(Q)).returnValue;qa&&
(Jf.TableCellReader.Xr(qa)&&(qa=vd.GraphIterator.eb(qa),qa.zb(14),qa=!b&&this.TJb(qa,!0,!1)?qa.currentNode:b||qg.moveToNextRow(qa)?this.TJb(qa,!1,!1):null),qa&&(ca=Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(qa),Q.isForward)))}else Q=b.oea,b=vd.GraphIterator.eb(Q.Ke.Rc.node),b.zb(14),Jf.TableCellReader.dGa(b.currentNode)&&qg.moveToLastGhostCell(b,2),(qa=qg.moveToNextColumn(b))?(b=Jf.TableCellReader.Q4(qa),Jf.TableCellReader.Xr(qa)&&!b&&(qa=vd.GraphIterator.eb(qa),qa.zb(14),qa=qg.moveToControllingCell(qa)),
b?Q=Cg.SelectionFactory.oo(Q.Ke.Rc.node,!1):ca=Cg.SelectionFactory.oo(qa,!0)):(qa=Q.Ke.Rc.node,ca=Cg.SelectionFactory.oo(qa,!1));else b=h&&Q.isForward||!h&&!Q.Gpa?Q.Ke.Rc:Q.Ke.Pa,Im.a.Fpa(b.node)&&(b=vd.GraphIterator.eb(b.node),(qa=this.T7b(b,!1))?ca=h?Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(qa),Q.isForward):Cg.SelectionFactory.oo(qa,!0):Q=Ge.SelectionEditor.Fj(Cg.SelectionFactory.Aq(b.currentNode),!1,!0));return ca?ca:B?Ge.SelectionEditor.S7b(Q,!1,h,!0):Ge.SelectionEditor.iwa(Q,{SA:!h,
Hs:h,RC:u,oE:!0})}HCl(b,h,u,B){let Q=b.lb;var ca=null;if(b.Ov)h?1===Q.Ke.Hia&&Q.isForward&&Q.Ke.Pa.equals(Q.jDa)||(ca=this.CCl(Q),(ca=this.PZh(Q,ca))||Q.isForward&&(Q=Q.RNc())):(Q=b.oea,ca=Cg.SelectionFactory.oo(Q.Ke.Pa.node,!0));else if(h){var qa=(Q.isForward?Q.Ke.Rc:Q.Ke.Pa).node;b=vd.GraphIterator.eb(qa);Ge.SelectionEditor.yu(b);Im.a.Fpa(qa)&&(Q.isForward&&1===Q.Ke.Hia&&Q.Gpa?(ca=Im.a.yB(qa).toArray(),(ca=this.PZh(Q,0<=ca.length-2?ca[ca.length-2]:null))||Q.isForward&&(Q=Q.RNc())):(qa=this.T7b(b,
!0))?ca=Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(qa),Q.isForward):Q=Cg.SelectionFactory.oo(b.currentNode,!0))}else ca=Ge.SelectionEditor.Fj(Q,!0,!1);return ca?ca:B?Ge.SelectionEditor.S7b(Q,!0,h,!0):Ge.SelectionEditor.GEa(Q,{SA:!h,Hs:h,RC:u,oE:!0})}PZh(b,h){if(!h)return null;var u=h;Jf.TableCellReader.Xr(h)&&(u=vd.GraphIterator.eb(h),u.zb(14),u=this.TJb(u,!0,!0)?u.currentNode:Jf.TableCellReader.iha(h));return u?Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(u),b.isForward):null}fDl(b,h,
u){let B=h.lb,Q=null;if(h.Ov){var ca=h.vX>h.NIa;if(u)if(2===h.length&&1===h.oea.Ke.Hia&&ca)B=Ge.SelectionEditor.Fj(B,!0,!1);else{if(h=this.e_h(B,!0))Jf.TableCellReader.Xr(h)&&(h=vd.GraphIterator.eb(h),h.zb(14),h=this.TJb(h,!1,!0)),h&&(Q=Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(h),B.isForward));Q||B.isForward&&(B=B.RNc())}else ca&&(B=h.oea)}else h=u&&B.isForward?B.Ke.Rc:B.Ke.Pa,Im.a.Fpa(h.node)&&(h=vd.GraphIterator.eb(h.node),(ca=this.T7b(h,!0))?Q=u?Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(ca),
B.isForward):Cg.SelectionFactory.oo(ca,!0):u&&(B=Cg.SelectionFactory.oo(h.currentNode,!0)));return Q?Q:Ge.SelectionEditor.fgb(b,B,!1,u,u)}EBl(b,h,u){let B=h.lb,Q=null;if(h.Ov){const ca=h.vX<h.NIa;if(u)if(2===h.length&&1===h.oea.Ke.Hia&&ca)B=Ge.SelectionEditor.Fj(B,!1,!1);else{if(h=this.e_h(B,!1))Jf.TableCellReader.Xr(h)&&(h=vd.GraphIterator.eb(h),h.zb(14),h=this.TJb(h,!1,!1)),h&&(Q=Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(h),B.isForward))}else ca&&(B=h.oea)}else h=!u||B.isForward?B.Ke.Rc:
B.Ke.Pa,Im.a.Fpa(h.node)&&(h=vd.GraphIterator.eb(h.node),(h=this.T7b(h,!1))&&(Q=u?Cg.SelectionFactory.Tn(Fs.TableNodeContext.create(h),B.isForward):Cg.SelectionFactory.oo(h,B.Gpa)));return Q?Q:Ge.SelectionEditor.fgb(b,B,!0,u,u)}}Object(m.a)(SK,"TableCellSelectionStrategy",CH,[]);class TK{constructor(b){this.GL=(h,u,B,Q,ca)=>{if(1===B)return 32;h=(new ci.a).create();u="";switch(ca.DialogType){case "DirectPrintPreparingPDF":u=CommonUIStrings.l_DirectPrintPreparingPDF;ca=CommonUIStrings.l_DefaultDialogTitle;
break;default:ca=CommonUIStrings.l_DefaultDialogTitle}h.message=u;h.GL(ca,null,null);return 32};this.ga=b}Tb(){this.ga.fb(Ob.a.GL,vc.a.view,this.GL,1028)}}Object(m.a)(TK,"UIAutomationActor",null,[]);class UK{constructor(b,h,u,B){this.gb=b;this.WJa=h;this.Rqc=u;this.W6=B}ymg(b,h,u){return this.Rqc.mPm(h)?u?!0:b&&this.gb.kh(b)?(b=this.rw(b.currentNode),this.WJa.sri(b),!0):!1:!1}axf(b,h){return this.Rqc.lwl(b,h)}gxf(b){b&&this.gb.kh(b)&&(b=this.rw(b.currentNode),this.WJa.lXd(b))}rw(b){return Je.a.rw(b)}y$(b,
h,u){this.W6.v_i&&this.Rqc.Svi(u)&&(this.W6.y$(b,h),b.setValue($c.a.nwi,!0))}oge(){}kZd(b){return this.Rqc.kZd(b)}get u_d(){return this.Rqc.u_d}jD(){}bea(){}Mge(){}get ypj(){return!1}}Object(m.a)(UK,"WordEditorPasteStewardBridge",null,[552]);class VK{constructor(b){this.sa=new Nc.a;this.efj="WordFileSaveAsButtonClicked";this.V2o=()=>{this.sa.raiseEvent(this.efj,null);return 32};this.ga=b}Tb(){v.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.ra(Qc.a.OJj,Ad.a.frame,this.V2o)}Ywk(b){this.sa.addHandler(this.efj,
b)}}Object(m.a)(VK,"WordFileSaveAsActor",null,[]);class WK extends uA{constructor(){super()}ZFc(b,h,u,B,Q,ca,qa){return Ap.a.shc(h,u,B,Q,ca,qa)}}Object(m.a)(WK,"WordIndentationActorExtension",uA,[]);class DH{constructor(){this.tod=null}get name(){return"WordEditor.Actors"}init(){var b;nb.InteractiveViewManager.instance.ve.c6b=!0;v.AFrameworkApplication.va.ra(Qc.a.P1o,Ad.a.frame,JM);this.W.resolve("WordEditor.Actors.DeleteActor").Tb(v.AFrameworkApplication.va);$D.instance.Tb();$m.Tb();Up.Tb(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.IMainViewModeManager"));Bk.Tb();gE.instance.Tb();cN.a.Tb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Tb(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Tb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Tb();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Tb();v.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Tb();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.EW.D_d=!0);v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Tb();v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Tb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Tb();
this.W.resolve("Common.IOfficeTrialExperience").Tb();this.W.resolve("Common.IMacOfficeOffer").Tb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Tb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Tb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Tb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Tb();this.W.resolve("WordEditor.Actors.StylesActor").Tb();(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",
!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Tb();this.W.resolve("WordEditor.Actors.LabelsActor").Tb();this.W.resolve("WordEditor.Actors.EnvelopesActor").Tb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Tb();this.W.resolve("WordEditor.Actors.ProofingActor").Tb();this.W.resolve("WordEditor.Actors.PageActor").Tb();this.W.resolve("WordEditor.Actors.DarkModeActor").Tb();this.W.resolve("WordEditor.Actors.ImageActor").Tb(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.FormattingActor").Tb();
this.W.resolve("WordEditor.Actors.UIAutomationActor").Tb();this.W.resolve("WordEditor.Actors.ContentControlActor").Tb();this.W.resolve("WordEditor.Actors.CustomTabActor").Tb();this.W.resolve("WordEditor.Actors.BookmarkActor").Tb();this.W.resolve("WordEditor.Actors.HeadingsActor").Tb();this.W.resolve("Box4.Indicator.IIndicatorManager").dTa(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Tb();this.W.resolve("WordEditor.Actors.AccessibilityActor").B5f();
this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Tb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Tb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Tb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").WY();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Tb();v.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?
this.URn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb();this.nW.C6a(this.IVj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");v.AFrameworkApplication.le("bookmarks-core-ex;bookmarks-core-ex-cf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.xpm()&&Fb.App.za.jb.GVh();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Tb();
Fb.App.za.updateCommandUI();Kx.initialize()}dispose(){}URn(){this.od.lq.isCompleted?this.od&&this.od.isFeatureEnabled(51)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb():this.od.lq.continueWith(()=>{this.od&&this.od.isFeatureEnabled(51)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb(),Fb.App.za.updateCommandUI())})}get HPm(){if(null==this.tod)if(this.od)if(this.od.lq.isCompleted)this.tod=this.od.isFeatureEnabled(3);else return!1;else this.tod=!1;return this.tod}wc(b){var h,
u;this.W=b;this.od=b.Oa("Box4.IFeatureHelper");this.EW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.EW.WWc=v.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new mJ).wc(b);b.ia("Box4.IClipboardCommands",()=>new nJ(v.AFrameworkApplication.va,Ob.a.i4e,Ob.a.OGc,Ob.a.F_,Ob.a.NZf,Ob.a.paste,Ob.a.Z9,Ob.a.Snb)).ha();b.ia("HtmlImport.IHtmlNormalizerSettings",
()=>{const B=b.resolve("Common.IAppSettingsManager");return new qA(!0,B.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia("HtmlImport.IHtmlTranslatorSettings",()=>{const B=b.resolve("Common.IAppSettingsManager"),Q=ca=>!ca.Nbc;return new jJ(B.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,B.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ca=>ca.Nbc,()=>!1,Q,Q,Q,Q,void 0,()=>this.HPm,ca=>!ca.Nbc)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",
()=>new UK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new HK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",
()=>new oJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ia("Box4.IIndentationCommands",()=>new pJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.IJustificationCommands",()=>new qJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.ISpacingCommands",()=>new rJ(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.IPageCommands",()=>new DK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.StylesActor",()=>new PK(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"))).ha();
(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ia("WordEditor.Actors.CustomizeRibbonActor",()=>new KF(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.EnvelopesActor",()=>new xK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.LabelsActor",()=>new yK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.DigitalPrintActor",()=>new sH(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"))).ha();
b.ia("WordEditor.Actors.FileDownloadManager",()=>new gK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new BM.a)).ha();b.ia("WordEditor.Actors.FileDownloadActor",()=>new dK(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),v.AFrameworkApplication.K.$("DisablePrint"),v.AFrameworkApplication.K.kb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();b.ia("WordEditor.Actors.ParagraphDialogActor",()=>new FK(v.AFrameworkApplication.va,
b.Re("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Pk.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("WordEditor.Actors.MarginsDialogActor",()=>new AK(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"),Pk.a.instance)).ha();b.ia("WordEditor.Actors.ColumnsDialogActor",()=>new WJ(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"),Pk.a.instance)).ha();b.ia("WordEditor.Actors.ModeSwitcherControlActor",()=>new zy.a(b.Ta("Common.ISystemInitiatedFeedback"),
xJ.a.Y8b())).as("WordEditor.IModeSwitcherControl").ha();b.ia("WordEditor.Actors.PaperSizeDialogActor",()=>new EK(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"),Pk.a.instance)).ha();b.ia("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new rK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(bK,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ia("WordEditor.Actors.ProofingActor",()=>new IK(v.AFrameworkApplication.va,ti.a.instance,Ga.a.instance.resolve("Box4.ISelectionManager"),
Rp.a.instance,Ga.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ga.a.instance.resolve("Box4.ILanguageReader"),Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ga.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ga.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.EW,Ga.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ga.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();
(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").aA.loadScript("EditorSettingsManager")).then(()=>{const B=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");B.Zwm();B.init();b.ia("Box4.Proofing.EditorSettingsUIActor",()=>new sJ(v.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new tJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Tb()});b.ia("WordEditor.Actors.PageActor",()=>new CK(Ga.a.instance.resolve("Box4.IWordSectionEditor"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.resolve("WordEditor.IMainViewModeManager"),Ga.a.instance.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();
b.ia("WordEditor.Actors.DarkModeActor",()=>new $J(v.AFrameworkApplication.va,v.AFrameworkApplication.K,Fb.App.O$,!!Fb.App.instance&&Fb.App.instance.cGa,!!Fb.App.instance&&Fb.App.instance.pXc,Ga.a.instance.resolve("Box4.IDarkModeState"),Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ga.a.instance.resolve("Box4.DarkModeEventsManager"),!!Fb.App.instance&&Fb.App.instance.tpa)).ha();b.ia("WordEditor.FlatListDetailsProvider",()=>new iK(b.resolve("WordEditor.IFlatListEditor")));
b.ia("WordEditor.Actors.AccessibilityActor",()=>new EJ(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.Re("WordEditor.FlatListDetailsProvider"),b.Re("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Re("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ia("WordEditor.Actors.AppFrameCommandUIActor",()=>new SJ(v.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha();b.ia("WordEditor.Actors.ImageActor",()=>new cr(b.resolve("WordEditor.IImageEditor"),
b.Ta("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),v.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").ha();b.ia("WordEditor.Actors.WordFileSaveAsActor",
()=>new VK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new MK(b.resolve("WordEditor.IImageEditor"),v.AFrameworkApplication.K,v.AFrameworkApplication.ua.hQa,Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.Actors.DeleteActor",
()=>new aK.DeleteActor(Ga.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ga.a.instance.Ta("Box4.ContentControlConfigSettings"),Ga.a.instance.Ta("Box4.IContentControlEditor"),Ga.a.instance.resolve("Box4.IDynamicRangeEditor"),Ga.a.instance.Ta("WordEditor.Bookmark.IBookmarkManager"),Ga.a.instance.resolve("Box4.IHyperlinkEditor"),Ga.a.instance.resolve("Box4.IHyperlinkStrategy"),Ga.a.instance.resolve("Box4.IParagraphReader"),Ga.a.instance.resolve("Box4.IParagraphIndentationReader"),
Ga.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ga.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ga.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();this.W.ia("WordEditor.Actors.SWordRequestManager",()=>new RK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),v.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").ha();b.ia("WordEditor.Actors.TableCellSelectionStrategy",
()=>new SK).as("Box4.ITableCellSelectionStrategy").ha();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new uJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),ti.a.instance,b.resolve("Box4.IFeatureHelper"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();b.ia("Box4.Actors.FormatPainterActor",()=>new aE(Fb.App.za,hd.FocusManager.instance(),v.AFrameworkApplication.va,Wh.a.instance,Hr.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),
!!Fb.App.instance&&Fb.App.instance.tpa,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ia("WordEditor.Actors.FormattingActor",()=>new jK(v.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ia("WordEditor.Actors.UIAutomationActor",()=>new TK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.SaveStatusActor",()=>new OK(v.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();b.ia("Box4.Actors.IEnterViewStrategy",()=>new vJ(b.Oa("Box4.IAutoCorrectScheduler"),
b.Re("Box4.IUndoManager"),b.Ta("Box4.IExternalSelectionManager"))).ha();b.ia("Box4.ISelectAllHandlers",()=>new ZC(Df.PageReader.instance,b.Re("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ia("WordEditor.Actors.ContentControlActor",()=>new YJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va,v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ia("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new FJ(v.AFrameworkApplication.va,b.Re("WordEditor.UI.IDialogFactory"),hd.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new wJ).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new xG(v.AFrameworkApplication.He,Zo.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),v.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();
b.ia("WordEditor.Actors.GraphicsEditorActor",()=>new oK(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),v.AFrameworkApplication.He,
this.od,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new NK).ha();b.ia("WordEditor.Actors.CustomTabActor",()=>new ZJ(v.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).ha();b.ia("WordEditor.Actors.HeadingsActor",()=>new pK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),v.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();
b.ia("WordEditor.Actors.BookmarkActor",()=>new VJ(Fb.App.za,v.AFrameworkApplication.va,xf.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new hg.a(()=>Fb.App.za.jb.Yc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Rp.a.instance,this.W.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),
nb.InteractiveViewManager.instance,this.W.Re("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),ti.a.instance)).ha();b.ia("WordEditor.Actors.BookmarkIndicatorActor",()=>{var B,Q;return new $s(b.resolve("Box4.IParagraphReader"),vf.a.instance,Wi.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(Q=null===(B=Fb.App.instance)||void 0===B?void 0:B.cD)&&void 0!==Q?Q:!1,new hg.a(()=>Fb.App.za.jb.qc))}).ha();b.ia("Box4.Actors.IIFrameFocusStrategy",
()=>new qK).ha();b.ia("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new eE(xf.a.instance,b.resolve("Box4.ITextMetricsAdapter"),nb.InteractiveViewManager.instance,Qd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ia("WordEditor.Actors.ExternalContentActor",()=>new bt(v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").ha();b.ia("Box4.UI.ExternalContentFloatieManager",()=>new DJ).as("Box4.UI.IFloatieManager").ha();b.ia("WordEditor.Actors.ActionHangDetector",()=>new GJ(v.AFrameworkApplication.K,v.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ia("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new dE(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),nb.InteractiveViewManager.instance,
Rx.a.instance(),v.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Fb.App.ni.zl.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",
()=>new WK).as("Box4.Actors.IIndentationActorExtension").ha();v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia("WordEditor.Actors.ModernUxActor",()=>new yH(v.AFrameworkApplication.va)).ha());v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia("WordEditor.Actors.SwitchToClassicViewModeActor",
()=>new IG(v.AFrameworkApplication.va)).ha();(new iJ).wc(b);b.ia("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new CJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ia("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new AJ(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),!!Fb.App.instance&&Fb.App.instance.P0d)).ha();b.ia("WordEditor.OnlineMedia.OnlineMediaActor",
()=>new BJ(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),ti.a.instance,v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?Ga.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).ha();(null===(u=v.AFrameworkApplication.K)||void 0===u?0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",
!1))&&b.ia("WordEditor.Actors.MiniTemplateActor",()=>new BK(v.AFrameworkApplication.va,b.Ta("WordEditor.Extension.IInsertApiOperations"),b.Ta("WordEditor.Designer.Style.IParagraphDesigner"),xJ.a.Y8b())).ha();this.IVj=new yJ;this.nW=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){M.a.instance.Gc(new DH)}}Object(m.a)(DH,"WordEditorActorsPackage",null,[1,2]);class XK{constructor(b){this.aod=!1;this.PTi=()=>{this.aod=!0;this.xs.Vce(this.PTi)};this.xs=b;this.xs.xAb(this.PTi)}}Object(m.a)(XK,
"GraphFullyConnectedGetter",null,[277]);class $f{constructor(){this.I3g=Object.assign(new Hn.a,{})}cqk(b,h){let u;const B=b&1023;({value:u}=this.I3g.Fc(B,0)).returnValue||$f.Pjm().contains(B)||r.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,B);u+=h;this.I3g.Z(B,u);return u}static Pjm(){$f.gxd||($f.gxd=new Ca.a,$f.pc(0),$f.pc(1),$f.pc(2),$f.pc(3),$f.pc(4),$f.pc(5),$f.pc(6),$f.pc(7),$f.pc(8),$f.pc(9),$f.pc(10),$f.pc(11),$f.pc(12),$f.pc(13),$f.pc(14),$f.pc(15),$f.pc(16),
$f.pc(17),$f.pc(18),$f.pc(19),$f.pc(20),$f.pc(21),$f.pc(22),$f.pc(23),$f.pc(24),$f.pc(25),$f.pc(26),$f.pc(27),$f.pc(28),$f.pc(29),$f.pc(30),$f.pc(31),$f.pc(32),$f.pc(33),$f.pc(34),$f.pc(35),$f.pc(36),$f.pc(37),$f.pc(38),$f.pc(39),$f.pc(40),$f.pc(41),$f.pc(42),$f.pc(43),$f.pc(44),$f.pc(45),$f.pc(46),$f.pc(47),$f.pc(48),$f.pc(49),$f.pc(50),$f.pc(51),$f.pc(52),$f.pc(53),$f.pc(54),$f.pc(55),$f.pc(56),$f.pc(57),$f.pc(58),$f.pc(59),$f.pc(60),$f.pc(61),$f.pc(62),$f.pc(63),$f.pc(64),$f.pc(65),$f.pc(66),$f.pc(67),
$f.pc(68),$f.pc(69),$f.pc(70),$f.pc(71),$f.pc(72),$f.pc(73),$f.pc(74),$f.pc(75),$f.pc(76),$f.pc(77),$f.pc(78),$f.pc(79),$f.pc(80),$f.pc(81),$f.pc(82),$f.pc(83),$f.pc(84),$f.pc(85),$f.pc(86),$f.pc(87),$f.pc(88),$f.pc(89),$f.pc(90),$f.pc(91),$f.pc(92),$f.pc(93),$f.pc(94),$f.pc(95),$f.pc(96),$f.pc(97),$f.pc(98),$f.pc(99),$f.pc(100),$f.pc(101),$f.pc(102),$f.pc(103),$f.pc(104),$f.pc(105),$f.pc(106),$f.pc(107),$f.pc(108),$f.pc(109),$f.pc(110),$f.pc(111),$f.pc(112),$f.pc(113),$f.pc(114),$f.pc(115),$f.pc(116),
$f.pc(117),$f.pc(118),$f.pc(119),$f.pc(120),$f.pc(121),$f.pc(122),$f.pc(124),$f.pc(126),$f.pc(127),$f.pc(128),$f.pc(129),$f.pc(130),$f.pc(131),$f.pc(132),$f.pc(133),$f.pc(134),$f.pc(135),$f.pc(136),$f.pc(140),$f.pc(145),$f.pc(146),$f.pc(147));return $f.gxd}static pc(b){$f.gxd.add(b&1023)}}$f.gxd=null;Object(m.a)($f,"LanguagePerParagraphModel",null,[]);class YK{constructor(){this.xfg=!1;this.NEd=this.MEd=this.fTb=0;this.NCi=!0;this.B5o=0}}Object(m.a)(YK,"UpdateWordCountStateResult",null,[]);class ZK extends Sys.EventArgs{constructor(b){super();
this.isEnabled=b}}Object(m.a)(ZK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class $K{constructor(){this.vBh=this.uBh=this.wordCount=-1;this.KDb=this.Zwh=0;this.JDb=1;this.OZi=1033}}Object(m.a)($K,"WordCountCache",null,[]);class aL extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(m.a)(aL,"WordCountChangedEventArg",Sys.EventArgs,[]);class bL{constructor(){this.Ooc=this.rDa=0}}Object(m.a)(bL,"CharsCountResult",null,[]);class cL{constructor(){this.cp=0;this.Qoc=null;this.c8=
this.d8=0}}Object(m.a)(cL,"TextChunkResult",null,[]);class dL{constructor(){this.CJj=this.d8=this.c8=this.wordCount=0}}Object(m.a)(dL,"WordCountStateForParagraph",null,[]);class EH{constructor(){this.L$=this.CJ=this.d8=this.c8=this.bS=this.wordCount=0;this.currentNode=null;this.vX=-1;this.cp=0;this.e_f=[];this.JDb=this.KDb=this.v_a=this.$Zf=this.a_f=0;this.qI=this.Uwi=!1;this.Prb=new zb.a;this.H4a=new zb.a}}Object(m.a)(EH,"WordCountState",null,[]);class dr{constructor(b,h,u,B,Q,ca){this.Nzo=1E3;this.sa=
new Nc.a;this.Xzb=null;this.Hre=0;this.J1j="\ue000";this.Jtc=!1;this.Ywe=this.Nwe=this.Eid=0;this.CPg=this.KPg=null;this.Jwe=this.Iwe=this.Swe=0;this.spl=qa=>{this.Xzb=null;this.hff(qa.customData)};this.UF=h;this.W_j=new RegExp(wp.AParagraphNode.PC,"g");this.Fd=b;this.taskManager=B;this.Vm=u;this.JZa=ca;this.eXa=Q.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Egk=Q.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.rcj()}get CVm(){return!!this.Xzb}get HOa(){return this.Jtc}set HOa(b){this.Jtc=
b}get kAd(){return this.Hre}set kAd(b){this.Hre=b}get qRa(){return!this.Hre}get By(){return this.Eid}get XCb(){return this.Nwe}get aDb(){return this.Ywe}get ofl(){return this.KPg}get Kbf(){return this.CPg}get oKc(){return this.Swe}get mKc(){return this.Iwe}get E5b(){return this.Jwe}xAb(b){this.sa.addHandler(dr.Noe,b)}Vce(b){this.sa.removeHandler(dr.Noe,b)}r_e(b){this.sa.addHandler(dr.Pqg,b)}L_n(b){this.sa.removeHandler(dr.Pqg,b)}RJd(){this.QJd();this.rcj()}rcj(){this.Swe=this.Jwe=this.Iwe=this.Ywe=
this.Nwe=this.Eid=-1}Tcf(){this.xje(this.Nzo)}S$c(){const b=new EH;b.Uwi=!0;this.QJd();this.hff(b)}xje(b,h=null){this.qRa&&(this.CVm&&(h=null,this.QJd()),h||(h=new EH),b=new bf.a(3,1,b,this.spl,this.Bwj),b.customData=h,this.zuk(b))}QJd(){this.Xzb&&(this.taskManager.Ze(this.Xzb),this.Xzb=null)}HGj(b,h,u,B,Q,ca=!0,qa=-1,Qa=-1,rb=-1,Lb=1033){const Yb=new YK;Yb.fTb=u;Yb.MEd=Q;Yb.NEd=B;if(!b.cp&&h.Gdd&&ca&&!this.uei(h))return dr.lYo(b,h.Gdd),Yb.NCi=!0,Yb;B=0<=Qa&&0<=rb?{Bd:Qa,endCp:rb}:void 0;u=this.JKl(h,
B);B&&(Qa=B.Bd,rb=B.endCp);u=0<=rb?u.substring(0,rb):u;rb=0<=Qa&&0<=rb?u.substring(Qa,rb):u;B=b.cp>=Qa?b.cp:Qa;Q=b.e_f||[];ca=0<b.a_f?b.a_f:0;let gc=0<b.$Zf?b.$Zf:0,Fc=[];b.qI=!1;do{this.JZa.update();if(!b.Uwi&&(Yb.fTb+Fc.length/2>dr.z2o||this.JZa.Amb())){let Hd;Q=(Hd=Q).concat.apply(Hd,Fc);b.cp=B;b.e_f=Q;b.$Zf=gc;b.a_f=ca;b.vX=qa;b.currentNode=h;this.xje(dr.c6o,b);Yb.xfg=!0;b.qI=!0;return Yb}if((!B||B===Qa)&&0<u.length&&B<u.length){Q.push(Ky.a.instance.luf(u,B));var Sc=this.uei(h);if(0<=qa&&!B&&
Sc){b.wordCount+=1;Yb.fTb+=1;const Hd=this.Fd.UX(Sc);Sc=this.UF.J0c(Hd,Sc);Sc=dr.RHd(Sc);b.d8+=Sc.rDa+1;b.c8+=Sc.rDa-Sc.Ooc}}Sc=this.Sii(u,B,dr.JVk);B=Sc.cp;let ld;Fc=(ld=Fc).concat.apply(ld,Sc.Qoc);ca+=Sc.d8;gc+=Sc.c8}while(-1!==B);b=this.dok(b,Q,Fc,u,rb,Yb.fTb,Yb.MEd,Yb.NEd,h,-1===qa,Lb);Yb.fTb=b.wordCount;Yb.MEd=b.c8;Yb.NEd=b.d8;Yb.B5o=b.CJj;return Yb}CSh(b,h){const u=me.ParagraphReader.textLength(h,9);if(u){h=Hq.e(h);var B=0;for(let Q=0;Q<h.length;Q++)if(this.Kjb&&5===h[Q].qh&&b.CJ++,dr.Noo(h[Q])){B++;
break}h.length!==u?b.bS++:b.bS+=B}}noj(b){this.kAd=this.lpo(b.v_a,b.wordCount)?1:0;return!!this.kAd}HXi(b){this.Eid=b.wordCount;this.Nwe=b.CJ;this.Ywe=b.L$;this.Jwe=b.d8;this.Iwe=b.c8;this.Swe=b.bS;this.KPg=b.Prb;this.CPg=b.H4a;this.s5i(b)}s5i(b){this.sa.raiseEvent(dr.Noe,new aL(b))}r5i(){this.sa.raiseEvent(dr.Pqg,new ZK(!1))}lpo(b,h){if(Z.a.Kt||Z.a.pu||Z.a.YH)return!1;(h/=2)||(h=1);return(h?b/h:0)>dr.q9m?!0:!1}get Kjb(){const b=!this.uNf||1===this.uNf&&this.Egk;return this.eXa&&b}fbi(b,h){let u=
1033,B=0;b=h.zqf(b);h=new $f;for(let Q=0;Q<b.length;Q++){const ca=h.cqk(b[Q].lcid,b[Q].end-b[Q].Ac);B<ca&&(B=ca,u=b[Q].lcid)}return u}dok(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){var gc;h=(gc=h).concat.apply(gc,u);u=Ky.a.instance.Uii(h,B);b.wordCount+=u.wordCount;Q=dr.RHd(Q);gc=Q.rDa-Q.Ooc;const Fc=Q.rDa;b.c8+=gc;b.d8+=Fc;ca+=u.wordCount;qa+=Q.rDa-Q.Ooc;Qa+=Q.rDa;b.v_a+=u.v_a;const {srl:Sc,vJo:ld}=dr.cok(h,B);b.KDb+=Sc;b.JDb+=ld;b.H4a.add(Yb);b.Prb.add(u.wordCount);Lb&&dr.COk(Fc,gc,rb,u,Sc,ld,Yb);b.cp=0;b.e_f=
[];b=new dL;b.c8=qa;b.d8=Qa;b.wordCount=ca;b.CJj=u.wordCount;return b}JKl(b,h){let u=this.p1n(b);u=me.ParagraphReader.Ehb(b,9,u,h);return this.DXn(u)}p1n(b){var h=me.ParagraphReader.text(b);b=Hq.e(b);if(0<b.length){h=h.split("");for(let B=0;B<b.length;++B){let Q=!0;var u=!0;const ca=b[B];if(1===ca.qh)u=ca,u=22!==u.kind&&2!==u.kind;else if(5===ca.qh)Q=!1;else if(7===ca.qh||10===ca.qh)h[ca.Kb.cp]=this.J1j,Q=!1;if(Q){if(ca.Kb.cp>=h.length)return"";h[ca.Kb.cp]=u?" ":"C"}}h=h.join("")}return h}DXn(b){return b.replace(this.W_j,
"")}Sii(b,h,u){const B=b.length-h<=u;var Q=B?b.length:h+u;const ca=new cL;if(Q<h)return ca.cp=-1,ca;ca.Qoc=Ky.a.instance.lnf(b,h,Q);Q=dr.RHd(b.substr(h,Q));ca.d8=Q.rDa;ca.c8=Q.rDa-Q.Ooc;if(!ca.Qoc.length&&!B)return u===b.length-h?ca:this.Sii(b,h,b.length-h);ca.cp=B||!ca.Qoc.length?-1:ca.Qoc[ca.Qoc.length-1].cp;return ca}zuk(b){this.Xzb=b;this.taskManager.Xb(this.Xzb)}uei(b){if(b=b.bJ){const h=this.Fd.UX(b);if(h&&h.Kz)return b}return null}static Noo(b){return 11===b.qh}static lYo(b,h){b.wordCount+=
h.wordCount;b.c8+=h.uBh;b.d8+=h.vBh;b.v_a+=h.Zwh;b.KDb+=h.KDb;b.JDb+=h.JDb;b.H4a.add(h.OZi);b.Prb.add(h.wordCount)}static COk(b,h,u,B,Q,ca,qa){const Qa=new $K;Qa.wordCount=B.wordCount;Qa.vBh=b;Qa.uBh=h;Qa.Zwh=B.v_a;Qa.KDb=Q;Qa.JDb=ca;Qa.OZi=qa;u.Gdd=Qa}static RHd(b){const h=b.length,u=new bL;for(let Q=0;Q<h;Q++){var B=b.charCodeAt(Q);u.rDa++;if(55296<=B&&56319>=B&&(B=Q+1<h?b.charCodeAt(Q+1):0,56320<=B&&57343>=B)){Q++;continue}F.a.ada(b.charAt(Q))&&u.Ooc++}return u}static cok(b,h){let u=0,B=0;for(let Q=
0;Q<b.length;++Q){const ca=b[Q],qa=ca.QL;(3===qa||2===qa)&&ca.cp<h.length&&(++u,F.a.Vbc(h.charCodeAt(ca.cp))&&++B)}return{srl:B,vJo:u}}}dr.Noe="wctek";dr.Pqg="wcac";dr.c6o=1;dr.JVk=400;dr.z2o=90;dr.q9m=.1;Object(m.a)(dr,"WordCountManagerBase",null,[323]);class eL extends dr{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){super(b,h,u,Q,rb,Lb);this.S0h=this.wxd=this.cma=null;this.kqa=()=>{this.Tcf()};this.ib=B;this.yd=qa;this.fhh=Qa;this.HI=Yb;this.ib.Sw(this.kqa);this.YFe=rb.$("ReadingTimeIsEnabled")}get Bwj(){return 66}Jzm(){if(this.cma)return!0;
if(!this.ib||!this.ib.hb)return this.yd&&(Fb.App.sYd||v.AFrameworkApplication.Lk?this.yd.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.yd.Yb("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.ib.hb.clone();this.cma=b.HO(!0);if(!this.cma||!this.cma.RY())return this.QJd(),!1;this.fhh&&(this.wxd=this.fhh.create(h=>b.HO(h),this.Vm));this.cma.moveNext();return!0}get uNf(){return 1}q4k(b){return b===vc.a.Jd||b===vc.a.paragraph?
!0:this.Kjb&&(b===vc.a.EEb||b===vc.a.image||b===vc.a.M7)}hff(b){this.JZa.reset();if(this.Jzm()){for(this.Kjb&&this.wxd&&(this.wxd.npl(b,this.JZa)||this.xje(1,b));this.cma.current;){const B=-1===b.vX?0:b.vX;let Q=0;var h=this.cma.current;if(!this.q4k(h.contextId)){this.cma.moveNext();continue}if(this.Kjb&&Dd.ImageReader.C3a(h)){b.CJ++;this.cma.moveNext();continue}if(!me.ParagraphReader.Wb(h.node)){this.cma.moveNext();continue}const ca=h.node;if(this.HOa&&this.S0h&&this.S0h.b2a(ca))this.cma.moveNext();
else{if(this.Kjb&&h.isValid){var u=vd.GraphIterator.eb(ca);for(u.Ub(6);!u.Wr;)Dd.ImageReader.Jt(u.currentNode)&&b.CJ++,u.Ni(6)}u=this.YFe?this.fbi(ca,this.HI):1033;h=this.HGj(b,ca,0,0,0,this.pZd(h),B,h.cpBegin,h.cpEnd,u);if(h.NCi&&(Q+=1,100<Q)){b.vX=B+1;this.xje(1,b);return}if(h.xfg)return;this.CSh(b,ca);this.cma.moveNext()}}this.wxd=this.cma=null;this.noj(b)?(this.Eid=-1,this.r5i()):this.HXi(b)}}pZd(b){let h=!1;b.contextId===vc.a.paragraph?h=!0:b.contextId===vc.a.Jd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);
return h}}Object(m.a)(eL,"SelectionWordCountManager",dr,[]);class JG{constructor(b,h){this.BXb=!1;this.hzb=null;b&&h&&(this.n0b=b(!1),this.Zc=h,this.n0b.moveNext())}npl(b,h){if(!b||!this.n0b||!this.n0b.current)return!0;do{const u=this.n0b.current;if(u.contextId===vc.a.$x||u.contextId===vc.a.Ew){for(this.hzb||this.Szm(u.node);this.hzb.moveNext();)if(14===this.hzb.currentNode.type&&b.L$++,h.update(),h.Amb())return!1;this.O6k(u,b);this.hzb=null}this.n0b.moveNext()}while(this.n0b.current);return!0}O6k(b,
h){const u=this.Zc.Tf(b.node);u.zb(14);b.contextId===vc.a.$x&&(Im.a.Hwi(u)&&(this.BXb=!0),Im.a.RZd(u)&&this.BXb&&(this.BXb=!1,h.L$++));b.contextId===vc.a.Ew&&(Jf.TableCellReader.GVc(u)&&(this.BXb=!0),Jf.TableCellReader.TQa(u)&&this.BXb&&(this.BXb=!1,h.L$++))}Szm(b){this.hzb=Fa.a.ap(b);14===b.type?this.hzb.wo(JG.qNc,b):this.hzb.wo(JG.qNc,null)}static qNc(b){return b.parentNode?!0:!1}}Object(m.a)(JG,"TableCountSelectionTraverser",null,[324]);class fL{constructor(b){this.eXa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,
h){return this.eXa?new JG(b,h):null}}Object(m.a)(fL,"TableCountSelectionTraverserFactory",null,[276]);class gL extends dr{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb){super(b,h,u,Q,rb,Lb);this.B2o=gc=>{if(gc.Wr)return!0;gc=gc.role;return 1===gc||2===gc||this.Kjb&&6===gc||3===gc||4===gc||5===gc||!this.HOa&&(7===gc||8===gc)};this.ga=B;this.yck=ca;this.nlk=qa;this.kPg=Qa;this.HI=Yb;this.ga.fb(Qc.a.AJj,vc.a.application,dd.ActionManager.Lf,64);this.ga.fb(Qc.a.BJj,vc.a.application,dd.ActionManager.Lf,64);this.YFe=
rb.$("ReadingTimeIsEnabled")}get Bwj(){return 63}get uNf(){return 0}hff(b){this.JZa.reset();b.qI=!1;var h=this.yck();Df.PageReader.instance.cJb(h)||(this.RJd(),this.r5i());h=this.Vm.qoa(h,7,7).currentNode;var u=this.C$k(b.currentNode,h);h=this.nlk(u,h);h.wo(this.B2o,null);let B=u=0;for(var Q=0;h.moveNext();)if(h.currentNode&&this.Fd.Uca(h.currentNode)){var ca=this.Fd.UX(h.currentNode);if(ca.Kz){var qa=this.Fd.$Fb(h.currentNode);if(qa&&(qa=qa.qa.last,(null===qa||void 0===qa?0:qa.Oh)&&(hk.App.tN&&qa.Kh||
qa.JR)))continue;b.wordCount+=1;if(ca=this.UF.J0c(ca,h.currentNode))ca=dr.RHd(ca),b.d8+=ca.rDa+1,b.c8+=ca.rDa-ca.Ooc;u+=1;B+=b.d8;Q+=b.c8}}else if(this.Kjb&&h.currentNode&&Dd.ImageReader.Jt(h.currentNode))b.CJ++;else if(this.Kjb&&h.currentNode&&Zi.TableReader.HR(h.currentNode))b.L$++;else if(h.currentNode&&me.ParagraphReader.Wb(h.currentNode)){ca=h.currentNode;qa=this.YFe?this.fbi(ca,this.HI):1033;Q=this.HGj(b,ca,u,B,Q,!0,-1,-1,-1,qa);if(Q.xfg){b.qI=!0;v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");
return}this.CSh(b,ca);u=Q.fTb;B=Q.NEd;Q=Q.MEd}this.noj(b)?(this.RJd(),this.h2n(),this.s5i(b)):this.HXi(b)}C$k(b,h){b?(b=this.kPg(b),b.zb(7)):b=this.kPg(h);return b}h2n(){switch(this.kAd){case 1:this.ga.processAction(Qc.a.AJj,2);break;case 2:this.ga.processAction(Qc.a.BJj,2)}}}Object(m.a)(gL,"TotalWordCountManager",dr,[]);class hL{constructor(){this.ihj=this.hhj=this.Bag=this.jhj=this.Nyj=this.Oyj=this.Lyj=this.Myj=0}get YQi(){return this.z9b(this.jhj,this.Oyj,"WC")}get ygn(){return this.z9b(this.hhj,
this.Lyj,"NumCharsNoSp")}get zgn(){return this.z9b(this.Bag,this.Myj,"NumCharsWithSp")}get Egn(){return this.z9b(this.ihj,this.Nyj,"NumParagraphs")}z9b(b,h,u){const B=this.kdd(h,u).toLocaleString();return 0<this.Bag?(b=this.Tpg(b,h,u),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),B)):B}Tpg(b,h,u){b=this.kdd(b,u);return b>h?(r.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",u),h):b}kdd(b,h){0>b&&r.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,
0)}}Object(m.a)(hL,"DocumentStats",null,[]);class KG{static M$e(b){return Hf.a.Bz(KG.Sm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.YQi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.ygn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.zgn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.Egn)}}KG.Sm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(m.a)(KG,"DocumentStatsDialogHtml",null,[]);class iL extends Hf.a{constructor(b){super();this.KS=!1;this.Vpl=()=>{};this.YF=b}Hto(){this.ug="DocumentStatsDialog";this.Yg=KG.M$e(this.YF);this.Cd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.Vpl);this.C5("DocumentStatsTable")}L9(){}dispose(){this.KS||(super.dispose(),this.KS=!0)}}Object(m.a)(iL,"DocumentStatsDialog",Hf.a,[]);class jL{constructor(b,h,u,B,Q,ca,qa,Qa,rb){this.ggh=this.uvc=this.Jtc=this.AXb=this.XGe=
!1;this.Jgc=()=>{this.Mne()};this.nqa=()=>{this.Mne()};this.slo=()=>{this.ggh=!0;return 32};this.P3f=()=>this.xs.qRa?32:8;this.N4c=(Lb,Yb,gc,Fc,Sc)=>{if(1===gc)return this.xs.qRa?32:8;Sc[gg.a.On]=this.JHf;return 32};this.tle=(Lb,Yb,gc)=>{if(1===gc)return this.xs.qRa?32:8;this.JHf?this.Lml():this.qtl();Fb.App.za.cH({ShowWordCount:"CheckboxModel"});return 32};this.ylc=(Lb,Yb,gc)=>{if(1===gc)return Hi.a.eia(Yb)?8:this.xs.qRa?32:8;if(this.ggh)return v.AFrameworkApplication.va.processAction(Qc.a.o8d,2),
32;Lb=this.he.Vf("UserAction","Show Word Count Dialog");Lb.start();this.xs.S$c();this.CQ.S$c();this.xs.By!==this.CQ.By?r.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):r.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Yb=this.X8k();(new iL(Yb)).Hto();Lb.stop();return 32};this.$3c=(Lb,Yb,gc,Fc,Sc)=>{Sc||r.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===gc)return 32;if(!this.xs.qRa)return Sc[xm.a.Visible]=
!1,32;Sc[xm.a.Visible]=!0;this.JHf?(Lb=this.xs.By,0>Lb?Lb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Lb?(Yb=this.CQ?this.CQ.By:-1,Lb=0<Yb?this.Fbm(Lb,Yb):String.format(1===Lb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.yee(Lb))):Lb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.yee(Lb))):Lb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Sc[xm.a.LabelText]=Lb;return 32};
this.qwe=qa;this.rwe=ca;this.xs=b;this.CQ=h;this.$Cc=u;this.djk=Q;this.CQ.r_e(this.Jgc);this.xs.r_e(this.Jgc);this.CQ.xAb(this.nqa);this.xs.xAb(this.nqa);this.he=Qa;this.HOa=B;this.eXa=rb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Icf(){return!Z.a.K4}Tb(){const b=v.AFrameworkApplication.va;b.ra(Qc.a.tle,vc.a.application,this.tle);b.ra(Qc.a.ylc,vc.a.view,this.ylc);b.fb(Qc.a.N4c,vc.a.application,this.N4c,96);b.fb(Qc.a.$3c,vc.a.application,this.$3c,96);b.fb(Qc.a.P3f,vc.a.application,
this.P3f,96);b.ra(Qc.a.$Uh,vc.a.application,this.slo)}get HOa(){return this.Jtc}set HOa(b){this.Jtc=b;this.xs.HOa=b;this.CQ.HOa=b}qtl(){this.xs.qRa&&(this.Zmj(!0),this.Mne(),this.xs.S$c())}X8k(){const b=new hL;b.Oyj=this.xs.By;b.Myj=this.xs.E5b;b.Lyj=this.xs.mKc;b.Nyj=this.xs.oKc;b.jhj=this.CQ.By;b.hhj=this.CQ.mKc;b.Bag=this.CQ.E5b;b.ihj=this.CQ.oKc;return b}OUl(){return this.qwe("WACWordCountEnabled",this.Icf)}Qfe(b){this.rwe("WACWordCountEnabled",b?"true":"false",ac.a.SRa)}get JHf(){this.AXb||(this.XGe=
this.OUl(),this.AXb=!0);return this.XGe}Zmj(b){this.Qfe(b);this.XGe=b;this.AXb=!0}Lml(){this.xs.RJd();this.CQ.RJd();this.Zmj(!1);this.Mne()}get $J(){return null!=this.CFg?this.CFg:this.CFg=(()=>this.$Cc())()}Mne(){this.uvc||(r.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.Ydl()),this.uvc=!0);this.$J&&this.$J.bV(this.djk)}Ydl(){const b={["words"]:this.xs.By,["charsWithSpaces"]:this.xs.E5b,["charsWithNoSpaces"]:this.xs.mKc,["paragraphs"]:this.xs.oKc};this.eXa&&(b.images=this.xs.XCb,
b.tables=this.xs.aDb);return b}yee(b){try{return b.toLocaleString()}catch(h){r.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}Fbm(b,h){h>b&&(r.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.yee(h),this.yee(b))}}Object(m.a)(jL,"WordCountActor",
null,[]);class kL extends pt.a{constructor(b,h,u,B){super();this.LY=(Q,ca)=>{if(ca.property===Xe.a.vo||ca.property===Xe.a.Ln)Q=ca.node,ca=hk.App.hn.jb.qc,ca.kv&&ca.ed&&ca.ed.Lc&&Q.Lc&&Q.Lc.id===ca.ed.Lc.id&&this.lWh(Q)};this.hVi=(Q,ca)=>{this.lWh(ca.node)};this.Jon=(Q,ca)=>{ca.property!==$c.a.LA&&ca.property!==Jc.a.nv||this.IY()};this.r6d=()=>{this.IY()};this.R2=b;this.xs=h;this.tq=u;this.eXa=B.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Pz(){var b=this.tq.Te(12);b.Mo(this.LY);b.hu(this.hVi);
b.Fx(this.hVi);b=this.tq.Te(22);b.Mo(this.Jon);b.hu(this.r6d);b.Fx(this.r6d);this.eXa&&this.oUn();this.R2.ara(this,7)}oUn(){var b=[19,14];for(const h of b)b=this.tq.Te(h),b.hu(this.r6d),b.Fx(this.r6d)}get index(){return 1}run(){this.xs.Tcf()}lWh(b){b.Gdd=null;this.IY()}}Object(m.a)(kL,"WordCountAppEventCoordinator",pt.a,[]);class FH{}FH.eok="AccurateWordCountButton";Object(m.a)(FH,"WordCountConstants",null,[]);class lL{constructor(b,h){this.xs=b;this.CQ=h}getInstance(b){switch(b){case 1:return this.CQ;
case 0:return this.xs;default:return this.xs}}}Object(m.a)(lL,"WordCountManagerFactory",null,[275]);class GH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}wc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ia("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new fL(h)).ha();this.W.ia("WordEditor.WordCount.IWordCountManagerFactory",()=>{var u=new Vl.a(10,Qd.a.We);const B=new gL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Yn.a,v.AFrameworkApplication.va,v.AFrameworkApplication.oc,()=>hk.App.hn.jb.qc.ed,Fa.a.zs,vd.GraphIterator.eb,h,u,Ga.a.instance.resolve("Box4.ILanguageReader"));u=new eL(Ga.a.instance.resolve("Box4.List.IListReader"),Ga.a.instance.resolve("Box4.IListMarkerUtility"),new Yn.a,xf.a.instance,v.AFrameworkApplication.oc,Cs.a.instance,Wh.a.instance,Ga.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,u,Ga.a.instance.resolve("Box4.ILanguageReader"));return new lL(B,u)}).ha();
this.W.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new XK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=Fb.App.za.jb;b.mxa?this.Xja():b.fga(()=>{this.Xja()})}Xja(){if(Fb.App.ni){var b=Fb.App.ni.zl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),u=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
B=Ga.a.instance.resolve("Common.IAppSettingsManager");(new jL(h,u,()=>Ga.a.instance.Oa("WordEditor.IStatusBarUser"),this.QTl(),FH.eok,ac.a.aUa,ac.a.ica,Ga.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),B)).Tb();(new kL(fg.GraphTransactionManager.instance,h,b,B)).Pz();h.Tcf()}else r.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else r.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}QTl(){var b=
hk.App.hn.jb;if(!b)return r.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.qc;if(!b)return r.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ed;return b?b.ja(Jc.a.HOa,!1):(r.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){M.a.instance.Gc(new GH)}}Object(m.a)(GH,"PackageManager",null,[1,2]);var dN=c(2054);class mL{constructor(b){this.LQe=null;b.Ta("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.LQe=h})}wjj(b){this.LQe&&this.LQe.Zpf().handleDocumentContentAugloopAnnotation(b)}}
Object(m.a)(mL,"DocumentContentExtractionManager",null,[445]);class Ph{}Ph.xxo="mso_smartLookup";Ph.channelId="SmartLookup";Ph.wxo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Ph.vsj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Ph.wsj="https://uci.cdn.office.net/mirrored/smartlookup/";Ph.vxo="https://hedwigtestserver.blob.core.windows.net/builds/";Ph.uxo="http://localhost:8080/";Ph.t$c="current";Ph.usj="next";Ph.jxn=2;Ph.$gc=1;Ph.ahc=CommonUIStrings.L_SmartLookupPaneTitle;
Ph.iC="InsightsTaskPane";Ph.Vjg="InsightsTaskPaneData";Ph.Tyf="InsightsContentFrame";Ph.width=400;Ph.San="ApplicationPropertiesRequest";Ph.cbn="SelectionRequest";Ph.Yan="PageRendered";Ph.Ran="ApplicationProperties";Ph.bbn="Selection";Ph.ebn="Telemetry";Ph.dbn="TakeFocus";Ph.Xan="LostFocus";Ph.Uan="Keyboard";Ph.Van="LegalAgreed";Ph.x5o="WordWac";Ph.Qtn="OneNoteWAC";Ph.FZf="yes";Ph.Nwj="appCorrelationId";Ph.cGo="clientCorrelationId";Ph.Owj="message";Ph.sFi="Microsoft::Office::Insights::LegalAgreed";
Object(m.a)(Ph,"InsightsConstants",null,[]);var OF=c(1626);class QE{}Object(m.a)(QE,"ActivityContractInfo",null,[]);class Wt{}Object(m.a)(Wt,"BrowserPaneDataField",null,[]);class RE{}Object(m.a)(RE,"BrowserPaneTelemetryEvent",null,[]);class Pl{static Tz(b,h){const u=new RE;u.eventName="Diagnostics";u.isActivity=!1;u.activityContract=Object.assign(new QE,{success:!0});const B=[],Q=new Wt;Q.name="Message";Q.dataType=0;Q.value=b;b=new Wt;b.name="Level";b.dataType=0;b.value=Pl.getLevelString(h);Array.add(B,
Q);Array.add(B,b);u.dataFields=B;Pl.sendTelemetryEvent(u)}static Bhj(b,h){const u=new RE;u.eventName=b;u.isActivity=!1;u.activityContract=Object.assign(new QE,{success:!0});b=[];const B=new Wt;B.name="AppCorrelationId";B.dataType=0;B.value=h;Array.add(b,B);u.dataFields=b;Pl.sendTelemetryEvent(u)}static wbo(b,h,u,B,Q,ca){const qa=new RE;qa.eventName="LaunchPaneWithError";qa.isActivity=!1;qa.activityContract=Object.assign(new QE,{success:!0});const Qa=[],rb=new Wt;rb.name="IsNetworkConnected";rb.dataType=
0;rb.value=b?"true":"false";b=new Wt;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Wt;h.name="EntryPoint";h.dataType=0;h.value=u;u=new Wt;u.name="RuntimeVersion";u.dataType=0;u.value=B;B=new Wt;B.name="IsFirstRelease";B.dataType=1;B.value=Q?"true":"false";Q=new Wt;Q.name="IsZeroTerm";Q.dataType=1;Q.value=ca?"true":"false";ca=new Wt;ca.name="IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Qa,rb);Array.add(Qa,h);Array.add(Qa,b);Array.add(Qa,u);Array.add(Qa,
B);Array.add(Qa,Q);Array.add(Qa,ca);qa.dataFields=Qa;Pl.sendTelemetryEvent(qa)}static Eag(b,h,u){const B=new RE;B.eventName="CDNDownloadLatency";B.isActivity=!0;B.activityContract=Object.assign(new QE,{duration:u,success:!0});u=[];const Q=new Wt;Q.name="CDNHostname";Q.dataType=0;Q.value=b;b=new Wt;b.name="Filename";b.dataType=0;b.value=h;Array.add(u,Q);Array.add(u,b);B.dataFields=u;Pl.sendTelemetryEvent(B,1)}static Xjc(b,h,u,B,Q,ca,qa,Qa){const rb=new RE;rb.eventName="LaunchPane";rb.isActivity=!0;
rb.activityContract=Object.assign(new QE,{duration:h,success:!0});h=[];const Lb=new Wt;Lb.name="AppCorrelationId";Lb.dataType=0;Lb.value=b;b=new Wt;b.name="EntryPoint";b.dataType=0;b.value=u;u=new Wt;u.name="IsServerSideRendering";u.dataType=1;u.value="true";const Yb=new Wt;Yb.name="UxVersion";Yb.dataType=0;Yb.value=B;B=new Wt;B.name="FeatureGates";B.dataType=0;B.value=Q;Q=new Wt;Q.name="IsFirstRelease";Q.dataType=1;Q.value=ca?"true":"false";ca=new Wt;ca.name="IsZeroTerm";ca.dataType=1;ca.value=qa?
"true":"false";qa=new Wt;qa.name="IsClientSideRendering";qa.dataType=1;qa.value=Qa?"true":"false";Array.add(h,Lb);Array.add(h,b);Array.add(h,u);Array.add(h,Yb);Array.add(h,B);Array.add(h,Q);Array.add(h,ca);Array.add(h,qa);rb.dataFields=h;Pl.sendTelemetryEvent(rb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Pl.H2m(b.eventName);else{var u=-1<b.eventName.indexOf(Pl.Mwj)?b.eventName:Pl.Mwj+b.eventName,B=Pl.QSl(b.dataFields);b.isActivity?(b=Object.assign(new zi.a,{name:u,samplingPolicy:h,
dataFields:B,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ea.a.sendActivityEvent(b)):(b=Object.assign(new la.a,{name:u,samplingPolicy:h,dataFields:B}),ea.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static QSl(b){const h=[];if(b&&0<b.length)for(const u of b)(b=ol.a.S8(u.name,u.value,Pl.L5k(u.dataType)))&&Array.add(h,b);return h}static L5k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static H2m(b){const h=Ga.a.instance.Oa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):r.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Pl.Mwj="Office.Insights.SmartLookup.";Object(m.a)(Pl,"TelemetryUtils",null,[]);var SE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(SE||(SE={}));Object(m.b)("EntryPoint",SE);var Xt=c(1550),Lx=c(1565);class Bv{static pY(b,h,u,B,Q,ca){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;if(Q.value.hso())return Pl.Tz("Skipping Serplet launch",10),32;h=ca;if(!h)return 8;b=Bv.bFb();if(u=h.CommandValueId)try{h=G.a(u)}catch(qa){return r.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",u),8}u=h;h.selection||(h.neighborhood?u=Object.assign(new Xt.a,{selection:h}):
(h=Q.value.LFb(),u.selection=Object.assign(new Lx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));u.selection.clientDetectedLanguage=Q.value.t$h();return Bv.z7b(ca,null,u,b,0,Q)}static z7b(b,h,u,B,Q,ca){const qa={};qa.controlId=b?b.SourceControlId:"shortcut";u&&(qa.entryPoint=SE[u.entryPoint]);r.ULS.sendTraceTag(594044172,1303,50,Bv.iU("Show insights",B,qa));h?ca.value.Auo(h,B,Q):u&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ca.value.Wso(u,B):ca.value.Buo(u,B,Q));return 32}static iU(b,h,u=null){b={["appCorrelationId"]:h,["message"]:b};if(u)for(let B in u)b[B]=u[B];return G.c(b)}static bFb(){return yb.a.create().toString()}}Object(m.a)(Bv,"InvokingPaneUtils",null,[]);class nL{}Object(m.a)(nL,"LaunchDataInDoc",null,[]);class oL{}Object(m.a)(oL,"LaunchDataPasteAsSlide",null,[]);class pL{}Object(m.a)(pL,"LaunchDataSlidesCompression",null,[]);var Fu=c(1540);class HH{constructor(b,h,u,B,Q,ca,qa,Qa,rb){this.Ltc=this.imd=
this.uv=null;this.tC=b;this.ga=h||v.AFrameworkApplication.va;this.hp=u;this.Vb=B;this.i1g=Qa;this.pzc=Q;this.Ga=ca;this.Ib=qa;this.Oym();this.ZWa=new hg.a(()=>new bn.a(rb.value,Object(z.a)(this,this.bGb,"getMoreInfoEventReceived")))}Tb(){this.ga.ra(Za.a.UCm,Ad.a.frame,Object(z.a)(this,this.yuo,"showInsights"));this.ga.ra(Za.a.VCm,Ad.a.frame,Object(z.a)(this,this.zuo,"showInsightsForTellMe"));this.ga.ra(Za.a.definitions,Ad.a.frame,Object(z.a)(this,this.xto,"showDefinitions"));this.ga.ra(Za.a.Qcf,Ad.a.frame,
Object(z.a)(this,this.yto,"showDefinitionsForTellMe"));this.ga.ra(Za.a.Vfg,Ad.a.frame,Object(z.a)(this,this.Vfg,"showInsightsForSuggestion"));this.i1g&&(this.ga.ra(Za.a.g9,Ad.a.frame,Object(z.a)(this,this.pY,"invokeSmartLookupPane")),this.ga.ra(Za.a.QUc,Ad.a.frame,Object(z.a)(this,this.QUc,"invokeInDocSerplet")),this.ga.ra(Za.a.SUc,Ad.a.frame,Object(z.a)(this,this.SUc,"invokeSerpletRibbon")),this.ga.ra(Za.a.RUc,Ad.a.frame,Object(z.a)(this,this.RUc,"invokeSerpletContextMenu")),this.ga.ra(Za.a.TBf,
Ad.a.frame,Object(z.a)(this,this.TBf,"invokeSerpletTellMeZeroTerm")),this.ga.ra(Za.a.SBf,Ad.a.frame,Object(z.a)(this,this.SBf,"invokeSerpletTellMeNotes")),this.ga.ra(Za.a.MXd,Ad.a.frame,Object(z.a)(this,this.MXd,"invokeImageSerpletContextMenu")),this.ga.ra(Za.a.QXd,Ad.a.frame,Object(z.a)(this,this.QXd,"invokeSynonymsSerpletContextMenu")),this.ga.ra(Za.a.LXd,Ad.a.frame,Object(z.a)(this,this.LXd,"invokeDictionarySerpletContextMenu")),this.ga.ra(Za.a.SXd,Ad.a.frame,Object(z.a)(this,this.SXd,"invokeZeroTermSerpletContextMenu")),
this.ga.ra(Za.a.KXd,Ad.a.frame,Object(z.a)(this,this.KXd,"invokeDefinitionSearchFromFloatie")),this.ga.ra(Za.a.PXd,Ad.a.frame,Object(z.a)(this,this.PXd,"invokeSerpletBrowseFiles")),this.ga.ra(Za.a.NXd,Ad.a.frame,Object(z.a)(this,this.NXd,"invokeInDocSerpletWithLaunchData")),this.ga.ra(Za.a.kbe,Ad.a.frame,Object(z.a)(this,this.kbe,"queryToggleSerplet")),this.ga.ra(Za.a.ege,Ad.a.frame,Object(z.a)(this,this.ege,"setInDocSearchParameter")),this.ga.ra(Za.a.RBf,Ad.a.frame,Object(z.a)(this,this.RBf,"invokeSerpletSlidesCompression")),
this.ga.ra(Za.a.QBf,Ad.a.frame,Object(z.a)(this,this.QBf,"invokeSerpletPasteAsNewSlide")),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.ra(Za.a.mti,Ad.a.frame,Object(z.a)(this,this.PEm,"invokeSmartLookupPaneConversations")),this.ga.ra(Za.a.IXd,Ad.a.frame,Object(z.a)(this,this.IXd,"invokeAutoLaunchSearchRequest"))),this.WSn().continueWith(()=>{v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.updateCommandUI(!0)}))}cnh(){this.ga.fb(Za.a.XFa,
Ad.a.frame,Object(z.a)(this,this.XFa,"invokeFilesSerplet"),4);this.ga.fb(Za.a.KBf,Ad.a.frame,Object(z.a)(this,this.XFa,"invokeFilesSerplet"),4);this.ga.fb(Za.a.gti,Ad.a.frame,Object(z.a)(this,this.EEm,"invokeLinkFilesSerplet"),4);if(this.Ga.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ga.$("SmartLookupTokenPrefetchIsEnabled")){const b=bf.a.r8(0,Object(z.a)(this,this.E1i,"prefetchToken"),0,177);this.Ib.Xb(b)}}DZe(){ah.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.ra(Za.a.XFa,Ad.a.frame,Object(z.a)(this,this.LBf,"invokeFilesSerpletUnavailable")),this.ga.ra(Za.a.KBf,Ad.a.frame,Object(z.a)(this,this.LBf,"invokeFilesSerpletUnavailable")),this.ga.ra(Za.a.gti,Ad.a.frame,Object(z.a)(this,this.LBf,"invokeFilesSerpletUnavailable")))}E1i(b){r.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Inc().then(h=>{let u=1;if(h)r.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.Yag("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ga.lc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{r.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.Yag("SmartLookupFiles: Token prefetch failed",!1);u=parseInt(b.data||"1");if(u>this.Ga.lc("SmartLookupTokenRenewalRetryThreshold",5)){r.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.Yag("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Ga.lc("SmartLookupTokenRetryWaitDurationInMinutes",10);u++}h=new bf.a(3,1,h,Object(z.a)(this,this.E1i,"prefetchToken"),177);h.data=u.toString();this.Ib.Xb(h)})}Yag(b="",h=!1){this.pzc.execute(u=>{u&&u.Vjc("PrefetchToken",h,0,"SmartLookup",b)})}Inc(){return this.pzc?new Promise(b=>{this.pzc.execute(h=>{if(h){var u=Date.now();h.getToken("SmartLookup",this.Ga.kb("SmartLookupShredderServiceEndpoint")).then(B=>{b(!!B&&0<B.length);h.Vjc("TryGetTokenInternal",!!B&&0<B.length,Date.now()-
u,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}WSn(){const b=new Jd.a;if(this.Ga.$("BrowserSupportsInsightsPaneSSO"))this.cnh(),b.Ag(!0);else{if(!this.pzc)return r.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Ag(!1),this.DZe(),b.task;this.pzc.execute(h=>{h?h.getToken("SmartLookup",this.Ga.kb("SmartLookupShredderServiceEndpoint")).then(u=>{r.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!u&&0<u.length);u&&0<u.length?(this.cnh(),b.Ag(!0)):this.DZe()}):(r.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.Ag(!1),this.DZe())})}return b.task}yuo(b,h,u,B,Q){if(1===u)return v.AFrameworkApplication.ua&&v.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!v.AFrameworkApplication.hJc?8:this.tC.value.Hxi()?32:8;b=Bv.bFb();h=this.tC.value.LFb();return this.i1g?(h=Object.assign(new Lx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Xt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new Fu.a,
{landingTab:"All"})}),Bv.z7b(Q,null,h,b,0,this.tC)):Bv.z7b(Q,h,null,b,0,this.tC)}xto(b,h,u,B,Q){if(1===u)return this.tC.value.Hxi()?32:8;b=Bv.bFb();h=this.tC.value.LFb();return Bv.z7b(Q,h,null,b,1,this.tC)}zuo(b,h,u,B,Q){return 1===u?32:this.xXh(Q,0)}yto(b,h,u,B,Q){return 1===u?32:this.xXh(Q,1)}xXh(b,h){const u=Bv.bFb(),B=b.CommandValueId;let Q;try{Q=G.a(B)}catch(ca){return r.ULS.sendTraceTag(6295941,1303,15,Bv.iU(String.format("Insights parameters [{0}] is not in proper format.",B),u)),8}return Bv.z7b(b,
Q,null,u,h,this.tC)}Vfg(b,h,u,B,Q){if(1===u)return 32;if(!Q)return 8;b=Q.query?Q.query:"";h=Bv.bFb();u=new OF.a;u.neighborhood=b;u.mentionStart=0;u.mentionLength=b.length;return Bv.z7b(Q,u,null,h,0,this.tC)}EEm(b,h,u,B){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;const Q=v.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ca=this.tC.value.i2a();return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new Fu.a,{landingTab:"File"}),entryPoint:Q?32:10}))}XFa(b,h,u,B){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;const Q=v.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ca=this.tC.value.i2a();return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Fu.a,{landingTab:Q?"Slide":"File"}),entryPoint:Q?20:10}))}LBf(){return 2}QUc(b,h,u,B,Q){if(1===
u)return fc.SessionStatusManager.instance.Uj?8:32;const ca=this.tC.value.i2a();Q=void 0===Q||null===Q?18:19;return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new Fu.a,{landingTab:"Indoc"}),entryPoint:Q}))}NXd(b,h,u,B,Q){Q=Q.CommandValueId;if(!Q||Q&&this.Ltc&&Q.query===this.Ltc.query&&Q.matchCase===this.Ltc.matchCase&&Q.matchWholeWordOnly===this.Ltc.matchWholeWordOnly)return 32;
const ca=this.tC.value.i2a();return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new Fu.a,{landingTab:"Indoc",data:Object.assign(new nL,{type:4,query:Q.query,matchCase:Q.matchCase,matchWholeWord:Q.matchWholeWordOnly})}),entryPoint:18}))}kbe(b,h,u,B,Q){Q&&(Q[gg.a.On]=this.tC.value.dJb);return 32}ege(b,h,u,B,Q){if(b=Q.CommandValueId)this.Ltc=b;return 32}PEm(b,
h,u){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;b=this.tC.value.i2a();b=Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Fu.a,{landingTab:"All"})});this.tC.value.s1d(b);return 32}IXd(b,h,u){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;b=this.tC.value.i2a();b=Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new Fu.a,{landingTab:"All",data:v.AFrameworkApplication.GDb})});h=Bv.bFb();this.tC.value.vPb(b,h);return 32}SUc(b,h,u,B){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;const Q=this.tC.value.v$h();return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:Q.mentionLength}),entryPoint:4,launchData:Object.assign(new Fu.a,{landingTab:"All"})}))}RUc(b,
h,u,B){return this.pY(b,h,u,B,Object.assign(new Xt.a,{entryPoint:5,launchData:Object.assign(new Fu.a,{landingTab:"All"})}))}TBf(b,h,u,B){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;const Q=this.tC.value.i2a();return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:0}),launchData:Object.assign(new Fu.a,{landingTab:"All"}),entryPoint:26}))}LXd(b,h,u,B){return 1===u?(b=this.tC.value.LFb())&&0<
b.mentionLength?32:8:this.pY(b,h,u,B,Object.assign(new Xt.a,{entryPoint:22,launchData:Object.assign(new Fu.a,{landingTab:"All"})}))}KXd(b,h,u,B){return 1===u?(b=this.tC.value.LFb())&&0<b.mentionLength?32:8:this.pY(b,h,u,B,Object.assign(new Xt.a,{entryPoint:7,launchData:Object.assign(new Fu.a,{landingTab:"All"})}))}MXd(b,h,u,B){return this.pY(b,h,u,B,Object.assign(new Xt.a,{launchData:Object.assign(new Fu.a,{landingTab:"Image"}),entryPoint:9}))}QXd(b,h,u,B){return this.pY(b,h,u,B,Object.assign(new Xt.a,
{launchData:Object.assign(new Fu.a,{landingTab:"All"}),entryPoint:24}))}SBf(b,h,u,B){return this.pY(b,h,u,B,Object.assign(new Xt.a,{launchData:Object.assign(new Fu.a,{landingTab:"Notes"}),entryPoint:33}))}SXd(b,h,u,B){if(1===u)return fc.SessionStatusManager.instance.WH?32:8;const Q=this.tC.value.i2a();return this.pY(b,h,u,B,Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:0}),launchData:Object.assign(new Fu.a,{landingTab:"All"}),
entryPoint:27}))}RBf(b,h,u,B,Q){if(!Q)return 8;const ca=Q.url;Q=Q.selectedSlideIDs;return this.pY(b,h,u,B,Object.assign(new Xt.a,{launchData:Object.assign(new Fu.a,{landingTab:"All",data:Object.assign(new pL,{type:6,url:ca,selectedSlideIDs:Q})}),entryPoint:37}))}QBf(b,h,u,B,Q){if(!Q)return 8;const ca=Q.Selection;Q=Q.CurrentDocTitle;return this.pY(b,h,u,B,Object.assign(new Xt.a,{launchData:Object.assign(new Fu.a,{landingTab:"All",data:Object.assign(new oL,{type:5,selection:ca,currentDocTitle:Q})}),
entryPoint:36}))}pY(b,h,u,B,Q){return Bv.pY(b,h,u,B,this.tC,Q)}PXd(b,h,u){if(1===u)return 32;this.uv||this.ZWa.value.jP("Browse File from Search pane",!0);if(!this.imd||""===this.imd)return r.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Qd.a.om(this.imd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}bGb(b){this.uv||3!==b.state||(this.uv=b,this.imd=this.uv.Eda)}Oym(){const b=this.Vb.ae(Ph.iC);b.parent=$d.AFrame.xp;b.cga(Object(z.a)(this,this.Wjc,
"sendIFrameTakeFocusMessage"));this.hp.wT(Ph.iC)}Wjc(){document.activeElement.blur();v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.$kb||(this.tC.value.fgo(),this.tC.value.ubo())}dispose(){this.tC.value&&this.tC.value.dispose()}}Object(m.a)(HH,"InsightsActor",null,[10]);const IH=b=>{b=b.split("-");return b[b.length-1]},fN=()=>{var b=LG();if(b)return Promise.resolve(b);b=PF().replace("SearchWeb","searchweb");b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Ph.usj+"/":b+Ph.t$c+"/";b+="version.json";if(Z.a.lpa)return eN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Pl.Tz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(u=>u.json()).catch(()=>{Pl.Tz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(u=>{u=G.b(JSON.stringify(u));
return u.version?u.version:""},u=>{Pl.Tz("InsightsUtils - Failed to deserialize version: "+u.toString(),10);r.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+u.toString());return""}).then(u=>u)}catch(h){return Pl.Tz("InsightsUtils - Failed to download version.json: "+h.toString(),10),r.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},eN=b=>{const h=v.AFrameworkApplication.He;return new Promise(u=>{const B=
new MF.a(b,1,null,null,!0,2,null);h.send(B).Qya(Q=>{Q&&Q.data?Q.data.se||(Pl.Tz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+Q.data.Qe,10),u("")):(Pl.Tz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),u(""));try{const ca=G.b(Q.data.se);ca.version&&u(ca.version)}catch(ca){Pl.Tz("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),u("")}},Q=>{Q&&Q.data?Pl.Tz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
Q.data.Qe,10):Pl.Tz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);u("")})})},MG=()=>v.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),NG=()=>{const b=PF();return MG()||v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?b+LG()+"/":v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Ph.usj:b+Ph.t$c},LG=()=>MG()?"dev":v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/")[1]:v.AFrameworkApplication.K.kb("SmartLookupClientVersion"),JH=b=>{var h=3===v.AFrameworkApplication.ua.Lb.Nk?"wordwac":2===v.AFrameworkApplication.ua.Lb.Nk?"pptwac":"excelwac";var u=Jj.a.qg(v.AFrameworkApplication.lcid);const B=u?u.name:"en-us";u=PF();const Q=bD();h="main_ssr_wac.html?appName="+h+"&culture="+B;return"LOCAL"===Q?
u+h:u+((""!==b?b:Ph.t$c)+"/")+h},gN=b=>PF()+(""!==b?b:Ph.t$c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",PF=()=>{switch(bD()){case "LOCAL":return Ph.uxo;case "PR":const b=v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/");return Ph.vxo+b[0]+"/";case "INT":return Ph.wxo;case "EDOG":return Ph.vsj;default:return Ph.wsj}},hN=()=>{if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(bD()){case "EDOG":return Ph.vsj;
case "PROD":return Ph.wsj;default:return""}},bD=()=>{if(v.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(v.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(v.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")&&v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc"))return"PR";if(MG())return"LOCAL";switch(Object(Na.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=v.AFrameworkApplication.K.kb("UserPrincipalName");b=F.a.Zg(b);const h=v.AFrameworkApplication.K.ow("SmartLookupINTEnabledForSKITeam")?v.AFrameworkApplication.K.BB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},qL=()=>{let b;b=v.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":v.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":v.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":bD();const h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint"),u=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(u?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(u?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},iN=()=>{const b=bD(),h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class rL{sendTelemetryEvent(b){Pl.sendTelemetryEvent(b)}}
Object(m.a)(rL,"OtelTelemetrySink",null,[468]);class sL{}Object(m.a)(sL,"ApplicationProperties",null,[]);class tL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(m.a)(tL,"CurrentDocumentProperties",null,[]);class uL{}Object(m.a)(uL,"EnterpriseUserInfo",null,[]);class vL{}Object(m.a)(vL,"FeatureGates",null,[]);class KH{constructor(b,h){this.ov=this.Gi=null;this.Iea="Search";this.ZKi=!0;this.Mzb=h;this.Xu=b;this.Xu.execute(u=>{u.isFeatureEnabled("mso_sendASmile",!0).then(B=>
{this.ZKi=B}).catch(B=>{Pl.Tz("SearchHelper - Failed to check if Feedback feature is enabled: "+B.toString(),15)})});b=qL();h=v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.ov={};const u=this.Pbm();if(u&&0<u.length)for(let B=0;B<u.length;B++){const Q=u[B],ca=this.bcm(Q);switch(ca.toLowerCase()){case "true":this.ov[Q]=
!0;break;case "false":this.ov[Q]=!1;break;default:this.ov[Q]=ca}}this.ov.EnableInDocumentSearch=h;this.ov.EnableInDocumentSearchReplace=!0;this.ov.EnableInDocumentParamLocalSearch=!0;this.ov.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.ov.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.ov.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.ov.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.ov.EnableInDocumentExperiment3=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.ov.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.ov.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.ov.EnableLocalSearch=!0;this.ov.EnableInDocumentStickyFilters=!0;this.ov.IntentServiceEndpoint=b;this.ov.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.ov.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.ov.UXBundleVersion=LG();this.ov.SmartLookupServicePath=NG();this.ov.EnableAcronymSearch=
!0;this.ov.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.ov.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.ov.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.ov.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.ov.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.ov.ShowDebugInfo="INT"===bD();this.ov.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.ov.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.ov.QnaInMixSection=!0;this.ov.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.ov.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.ov.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.ov.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.ov.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.ov.EnableClientSideRendering=!0}else this.Gi=new vL,this.Gi.EnableInDocumentSearch=h,this.Gi.EnableInDocumentSearchReplace=
!0,this.Gi.EnableInDocumentParamLocalSearch=!0,this.Gi.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Gi.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Gi.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Gi.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Gi.EnableInDocumentExperiment3=
h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Gi.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Gi.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Gi.EnableLocalSearch=!0,this.Gi.EnableInDocumentStickyFilters=!0,this.Gi.IntentServiceEndpoint=b,this.Gi.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Gi.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Gi.UXBundleVersion=LG(),this.Gi.SmartLookupServicePath=NG(),this.Gi.EnableAcronymSearch=
!0,this.Gi.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Gi.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Gi.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Gi.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Gi.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Gi.ShowDebugInfo="INT"===bD(),this.Gi.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Gi.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Gi.QnaInMixSection=!0,this.Gi.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Gi.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Gi.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Gi.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Gi.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Gi.EnableClientSideRendering=!0,this.Gi.SharedSerpletFeatureGate1=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Gi.SharedSerpletFeatureGate2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Gi.SharedSerpletFeatureGate3=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Gi.SharedSerpletFeatureGate4=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Gi.SharedSerpletFeatureGate5=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Gi.SharedSerpletFeatureGate6=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Gi.SharedSerpletFeatureGate7=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Gi.SharedSerpletFeatureGate8=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Gi.SharedSerpletFeatureGate9=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Gi.SharedSerpletFeatureGate10=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Gi.SharedSerpletFeatureGate11=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Gi.SharedSerpletFeatureGate12=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Gi.SharedSerpletFeatureGate13=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Gi.SharedSerpletFeatureGate14=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Gi.SharedSerpletFeatureGate15=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Gi.SharedSerpletFeatureGate16=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Gi.SharedSerpletFeatureGate17=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Gi.SharedSerpletFeatureGate18=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Gi.SharedSerpletFeatureGate19=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Gi.SharedSerpletFeatureGate20=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Gi.SharedSerpletFeatureGate21=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Gi.SharedSerpletFeatureGate22=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Gi.SharedSerpletFeatureGate23=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Gi.SharedSerpletFeatureGate24=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Gi.SharedSerpletFeatureGate25=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Gi.SharedSerpletFeatureGate26=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Gi.SharedSerpletFeatureGate27=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Gi.SharedSerpletFeatureGate28=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Gi.SharedSerpletFeatureGate29=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Gi.SharedSerpletFeatureGate30=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Gi.SharedSerpletFeatureGate31=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Gi.SharedSerpletFeatureGate32=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Gi.SharedSerpletFeatureGate33=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Gi.SharedSerpletFeatureGate34=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Gi.SharedSerpletFeatureGate35=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Gi.SharedSerpletFeatureGate36=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Gi.SharedSerpletFeatureGate37=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Gi.SharedSerpletFeatureGate38=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Gi.SharedSerpletFeatureGate39=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Gi.SharedSerpletFeatureGate40=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.ryc=Ga.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.gmb=KH.isEnterpriseUser();this.JRa=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.jNf=fa.a.OX(v.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.c7m=v.AFrameworkApplication.K.kb("UserPrincipalName");this.gmb&&this.Pfi()}bcm(b){return v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}Pbm(){const b=v.AFrameworkApplication.K.x1a,h=v.AFrameworkApplication.K.BB("SmartLookupFlightKeywordList"),u=[];if(b&&h&&0<h.length)for(let Q in b){var B=
{key:Q,value:b[Q]};B=B&&B.key?B.key:"";for(let ca=0;ca<h.length;ca++)if(-1<B.toLowerCase().indexOf(h[ca].toLowerCase())){const qa=B.split(".");qa&&4===qa.length&&Array.add(u,qa[qa.length-1])}}return u}ptf(b,h,u,B){return new Promise(Q=>{this.CSm().then(ca=>{const qa=new sL;qa.anid="";qa.applicationName=3===v.AFrameworkApplication.ua.Lb.Nk?"WORD":"POWERPNT";qa.applicationVersion=v.AFrameworkApplication.buildVersion;qa.appCorrelationId=b?b:Bv.bFb();qa.themePlatform="web";qa.lcid=v.AFrameworkApplication.lcid;
qa.launchUtcTime=(new Date).toUTCString();v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?qa.featureGates=G.c(this.ov):qa.featureGates=G.c(this.Gi);var Qa=Jj.a.qg(v.AFrameworkApplication.lcid);Qa=Qa?Qa.name:null;qa.market=IH(Qa);qa.uiLanguage=Qa;qa.sessionId=v.AFrameworkApplication.userSessionId;qa.themeId=u;qa.parentalControl="yes";qa.processorOnlyMode=ca;qa.isEditingAllowed=h.isEditingAllowed();qa.isFeedbackEnabled=this.ZKi;qa.isClientSideRendering=18===B||19===B||15===B;qa.disableClipboard=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&v.AFrameworkApplication.xF&&!v.AFrameworkApplication.RDb;qa.accessToken=this.gmb?this.Pfi():"";ca=new uL;ca.CountryCode=IH(Qa);ca.ServiceEndpoint=this.JRa;ca.IsGoLocal=v.AFrameworkApplication.K.$("IsGoLocalEnvironment");ca.IsEnabled=this.gmb;ca.IsEnterpriseEnabled=this.gmb;ca.TenantRoot=this.jNf;ca.Upn=this.c7m;Qa=bD();ca.IsEUDB="PROD"===Qa&&""!==v.AFrameworkApplication.K.kb("IntentServiceEndpoint");
qa.enterpriseUserInfo=ca;ca=new tL;ca.filePath=v.AFrameworkApplication.K.kb("EditDocInClientUrl");ca.docName=v.AFrameworkApplication.K.kb("FileName");ca.author=99!==B?h.author():null;ca.createdDate=99!==B?h.createdDate():null;qa.currentDocument=ca;Q(qa)})})}CSm(){return new Promise(b=>{this.Xu?this.Xu.execute(h=>{h.isFeatureEnabled(Ph.xxo,!0).then(u=>{b(!u)}).catch(u=>{Pl.Tz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+u.toString(),10);b(!0)})}):b(!0)})}Tzn(b){this.ryc&&
this.gmb&&this.$Td(this.JRa).then(h=>{b(h)})}Pfi(){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.ryc?this.ryc.Ufm(this.Iea,this.JRa):""}$Td(b){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.ryc?this.ryc.getToken(this.Iea,b):Promise.resolve("")}aRc(){return this.Mzb?this.Mzb.getVersion():""}BVl(){return v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?G.c(this.ov):G.c(this.Gi)}static isEnterpriseUser(){const b=v.AFrameworkApplication.K.kb("SovereignEnvironmentName"),h=v.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(m.a)(KH,"SearchHelper",null,[446]);class hE{constructor(){hE._instance=
""}getVersion(){return hE._instance}Dmo(b){hE._instance=b}}hE._instance=null;Object(m.a)(hE,"SmartLookupVersion",null,[]);class wL{}Object(m.a)(wL,"ConfigurationProvider",null,[]);class TE{constructor(b){TE._instance=b}Zpf(){return TE._instance}}TE._instance=null;Object(m.a)(TE,"SearchHostRuntime",null,[]);class LH{constructor(){this.kfa=this.PTb=this.W=null}get name(){return"Common.App.Insights"}wc(b){this.W=b;const h=ob.a.Bp(Ga.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>")),u=
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||v.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(HH,"Common.App.Insights.InsightsActor").ha().Sd(()=>new HH(b.Re("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,Um.a.instance,hd.FocusManager.instance(),b.Ta("Common.App.SearchCommon.ISearchOAuthManager"),v.AFrameworkApplication.K,Bg.a.instance,u,new hg.a(()=>h.result)));b.register(445,"Common.App.Insights.IDocumentContentExtractionManager").ha().Sd(()=>new mL(b));
u&&(b.register(hE,"Common.App.Insights.SmartLookupVersion").ha().Sd(()=>new hE),b.register(446,"Common.App.SearchCommon.ISearchHelper").ha().Sd(()=>new KH(Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Oa("Common.App.Insights.SmartLookupVersion"))))}init(){v.AFrameworkApplication.u0&&(this.PTb=this.W.Oa("Common.App.Insights.InsightsActor"),this.PTb.Tb())}HRn(){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").$Td(b).then(h=>{var u={};u.Authorization="Bearer "+h;h=iN();const B=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);u=new MF.a(h+("?isTelemetryOnly="+B),1,null,u,!0,2,null);v.AFrameworkApplication.He.send(u).Qya(()=>{Pl.Tz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
B,50)},Q=>{Pl.Tz("InsightsPackage - Failed to send refreshmemory API request. Error: "+Q.toString(),10)})})}}Jql(){this.zDm();this.HRn()}zDm(){fN().then(b=>{if(""!==b){const h=this.W.Oa("Common.App.Insights.SmartLookupVersion");h&&h.Dmo(b)}this.$Kd();this.PTb=this.W.resolve("Common.App.Insights.InsightsActor");b=gN(b);b=Ya.a.create(b);b.t_((h,u)=>{u.succeeded?this.Ano()&&this.prefetchZeroTerm():Pl.Tz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+u.BF,10);this.PTb.Tb()});
Hb.a.FX(b)})}Ano(){const b=Object.assign(new wL,{channelId:Ph.channelId,approvedOriginPattern:MG()?"^(http)?://(localhost:8080)$":v.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const u=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),B=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Q=new zb.a;h&&Q.add(h);u&&Q.add(u);B&&Q.add(B);h=qL();try{const ca=new rL,qa=SmartLookupHostRuntime.setup(b,
Q.toArray(),!0,h,ca);this.W.register(TE,"Common.App.SearchCommon.SearchHostRuntime").ha().Sd(()=>new TE(qa));return!0}catch(ca){return Pl.Tz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Ga.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),u=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.ptf(null,u,0,99).then(B=>{b.Zpf().prefetchZeroTerm(B,v.AFrameworkApplication.userSessionId,NG(),!0,"Indoc",null)})}else Pl.Tz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}$Kd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=JH(b.aRc());b=b.aRc();b=PF()+(""!==b?b:Ph.t$c)+"/scripts/microsoft.office.smartlookup.ssr.js";
const u=hN();Z.a.lpa?this.Iql(h,b):(this.Gql(h,u),this.Hql(b,u))}Gql(b,h){const u=new Sys.Net.WebRequest;u.set_httpVerb("GET");const B={};B.method=u.get_httpVerb();u.set_url(b);const Q=(new Date).getTime();try{window.fetch(u.getResolvedUrl(),B).then(()=>{""!==h&&Pl.Eag(h,b,(new Date).getTime()-Q);this.W.Oa("Common.App.Insights.SmartLookupVersion")})}catch(ca){Pl.Tz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ca.toString(),10)}}Hql(b,h){var u=new Sys.Net.WebRequest;
u.set_httpVerb("GET");const B={};B.method=u.get_httpVerb();u.set_url(b);let Q=-1;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))u=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Bg.a.instance.Xb(new bf.a(5,1,u,()=>{const ca=Ya.a.create(b);ca.SZe(()=>{Q=Date.now()});ca.t_((qa,Qa)=>{Qa.succeeded?""!==h&&Pl.Eag(h,b,Date.now()-Q):Pl.Tz("InsightsPackage - Failed to prefetch JS file.",
10)});Hb.a.FX(ca)}));else{Q=Date.now();try{window.fetch(u.getResolvedUrl(),B).then(()=>{""!==h&&Pl.Eag(h,b,Date.now()-Q)})}catch(ca){Pl.Tz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}Iql(b,h){if(Z.a.lpa){var u=v.AFrameworkApplication.He;b=new MF.a(b,1,null,null,!0,2,null);u.send(b).Qya(B=>{B&&B.data?B.data.se?this.W.Oa("Common.App.Insights.SmartLookupVersion"):Pl.Tz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Qe,10):Pl.Tz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Pl.Tz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+B.data.Qe,10):Pl.Tz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});v.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new MF.a(h,1,null,null,!0,2,null),u.send(h).Qya(B=>{B&&B.data?B.data.se||Pl.Tz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Qe,10):Pl.Tz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Pl.Tz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+B.data.Qe,10):Pl.Tz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.PTb&&this.PTb.dispose()}}Object(m.a)(LH,"InsightsPackage",null,[1,2]);var xL=c(1608);class yL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(m.a)(yL,"DocumentContentParams",null,[]);var OG=c(1878),zL=c(403),UE=c(729),Gu;(function(b){b.EVa="SearchProvider";b.A9a="TextSummarization"})(Gu||(Gu={}));Object(m.b)("WorkflowType",Gu);var Tw;(function(b){b.Success="Success";b.Jsg="Invoked";b.Error="Error"})(Tw||(Tw={}));Object(m.b)("LogType",Tw);var Ey;(function(b){b.dLj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.Isg="InvalidAnnotation";b.hQj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Ey||(Ey={}));Object(m.b)("ErrorReason",Ey);class QF{constructor(b){this.SSh=b;this.UUf=this.UUf.bind(this);this.rnb=this.rnb.bind(this);this.SGo=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.s$n=Date.now();this.Zob=yb.a.create().toString();this.log({jK:Gu.EVa,logType:Tw.Jsg,success:!0,correlationId:this.Zob});
var b=bD().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new hp.l({parentPath:["Signal",OG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new OG.SearchProviderSignal({correlationId:this.Zob,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.ngj=window.setTimeout(()=>{this.onError(Gu.EVa,Tw.Error,Ey.Timeout)},1500)}catch(h){window.clearTimeout(this.ngj),this.onError(Gu.EVa,Tw.Error,
Ey.Other,this.W7h(h))}}async generateDocumentSummaryDetails(){try{if(!QF.CXc)return null;this.RGo=Date.now();this.log({jK:Gu.A9a,logType:Tw.Jsg,success:!0});await this.activateAnnotation();const b=new hp.l({parentPath:["Signal",UE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new UE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.jxj=window.setTimeout(()=>{this.onError(Gu.A9a,Tw.Error,Ey.Timeout)},
this.SGo);return new Promise(h=>{this.dmc=h})}catch(b){window.clearTimeout(this.jxj),this.onError(Gu.A9a,Tw.Error,Ey.Other,this.W7h(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get CXc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get GSm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.tbc){await qs.a.Uk();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new zL.a,{annotationType:OG.SearchProviderAnnotation.getTypeName(),handler:this.UUf}))];QF.CXc&&h.push(b(Object.assign(new zL.a,{annotationType:UE.TextSummaryAnnotation.getTypeName(),handler:this.rnb})));await Promise.all(h);this.tbc=!0}}rnb(b){var h,u,B;if(this.dmc)if(this.hzi(b)){if(b=b.items[0],UE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.jxj),
b=b.body,b.status!==UE.Result.Success)this.onError(Gu.A9a,Tw.Error,this.fVl(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({jK:Gu.A9a,logType:Tw.Success,success:!0});var Q=null!==b.summary&&""!==b.summary,ca=QF.GSm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===UE.TTSStatus.Success&&null!==(null===(u=b.tts)||void 0===u?void 0:u.base64Audio)&&""!==(null===(B=b.tts)||void 0===B?void 0:B.base64Audio);this.dmc({succeeded:Q,summary:Q?b.summary:null,audioSucceeded:ca,
audioBase64:ca?b.tts.base64Audio:null});this.dmc=null}}else this.log({jK:Gu.A9a,logType:Tw.Error,success:!1,oMd:Ey.Isg})}UUf(b){if(this.hzi(b)&&(b=b.items[0],OG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.ngj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Zob)this.log({jK:Gu.EVa,logType:Tw.Error,oMd:Ey.dLj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Zob!==b.correlationId)this.log({jK:Gu.EVa,logType:Tw.Error,oMd:Ey.hQj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.nKh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({jK:Gu.EVa,logType:Tw.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Zob=void 0;this.SSh.wjj(h)}else this.onError(Gu.EVa,
Tw.Error,Ey.Isg)}fVl(b){switch(b.status){case "BlockedByPrefilter":return Ey.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Ey.BlockedByQualityCheck;default:return Ey.Other}}hzi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.jK){case Gu.EVa:var h=this.s$n;break;case Gu.A9a:h=this.RGo;break;default:h=-1}const u=Date.now(),B=h?u-h:-1;h=[Object.assign(new ha.a,{name:"WorkflowType",string:b.jK}),Object.assign(new ha.a,{name:"LogType",string:b.logType}),
Object.assign(new ha.a,{name:"ErrorReason",string:b.oMd}),Object.assign(new ha.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ha.a,{name:"Message",string:b.message}),Object.assign(new ha.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ha.a,{name:"StartTime",int64:h}),Object.assign(new ha.a,{name:"EndTime",int64:u}),Object.assign(new ha.a,{name:"Duration",int64:B})];Object(Fe.a)("AugloopSearchProviderData",b.success,B,h)}W7h(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}nKh(b=
"",h="",u=""){return Object.assign(new yL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:u})}onError(b,h,u,B){h={jK:b,logType:h,success:!1,message:B,oMd:u};switch(b){case Gu.EVa:if(!this.Zob)break;h.correlationId=this.Zob;this.log(h);this.Zob=void 0;this.czl();break;case Gu.A9a:if(!this.dmc)break;this.log(h);this.dmc(null);this.dmc=null;break;default:return null}}czl(){this.SSh.wjj(this.nKh())}}Object(m.a)(QF,"AugloopSearchProviderManager",null,[]);class PG{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(m.a)(PG,"DocumentContentSearchResults",null,[]);class MH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,u,B,Q){this.selectRange(h,u,B,Q)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,u=>{h(Object.assign(new PG,{results:u,totalResultCount:u.length,hasTooManyResults:100<u.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,u=>{h(Object.assign(new PG,{results:u,
totalResultCount:u.length,hasTooManyResults:u.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(m.a)(MH,"BaseDocumentContentExecutor",null,[925,320]);var NH=c(2095),AL=c(1468);class QG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(m.a)(QG,"DocumentContentSearchParams",null,[]);class OH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(m.a)(OH,"DocumentSelection",null,[]);class BL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(m.a)(BL,"IAuthorProperties",null,[]);var iE=c(686);class PH{constructor(){this.ENc=this.i8e=0}}Object(m.a)(PH,"CommentFindResultIndexInfo",null,[]);const QH=b=>{b.Bc(Ge.SelectionEditor.Fj(b.hb.lb,!0,!1))},CL=b=>{b=NH.a.LSd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class DL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(m.a)(DL,"DocumentContentSearchResult",null,[]);var jN=c(1835);class EL{constructor(){this.authorEmail=this.authorName=this.vEb=this.n8e=null}}Object(m.a)(EL,"CommentFindResults",null,[]);class FL{constructor(){this.end=this.Ac=0}}Object(m.a)(FL,"FindResultOffset",null,[]);class fw{constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb){this.que=this.vv=this.rAe=this.eB=null;this.jih=0;this.jM=null;this.Trc=new zb.a;this.cOg=null;this.Bu=b;this.gb=h;this.idb=u;this.Hfa=
Q;this.zWb=ca;this.vub=qa;this.Wh=Qa;this.ga=rb;this.ib=Lb}IYl(b,h){var u;const B=[];if(12!=b.type)return B;const Q=zc.FormattingReader.o3h(b);let ca=null,qa=-1;var Qa=zl.a.auto;for(let Lb=0;Lb<=Q.length;Lb++){let Yb=-1;var rb=zl.a.auto;Lb<Q.length&&(rb=Q[Lb],Yb=rb.cp,rb=null===(u=rb.formatting)||void 0===u?void 0:u.cache,rb=(null===rb||void 0===rb?0:rb.fHb)?rb.highlight:(null===rb||void 0===rb?0:rb.dQa)?rb.qx:zl.a.auto);if(Qa!=rb){if(Qa!=zl.a.auto){ca||(ca=this.vub.ZEa(b.id));-1==Yb&&(Yb=ca.length);
Qa=this.idb.CId(ca,qa,Yb,"");const gc={};gc.context=Qa.mHd;gc.startOffsetInContext=Qa.Mde;gc.endOffsetInContext=Qa.Kde-1;B.push({data:gc,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:qa,endOffsetInParagraph:Yb-1})}qa=Yb;Qa=rb}}return B}get Hba(){return this.cOg}initialize(){this.eB=Sk.FindManager.createInstance(this,this.Hfa,Ea.a.instance,!1,!0)}search(b,h){this.eB.G_a();this.RFf(b)?(this.vv=h,this.jM=new zb.a,b=this.Iaf(b),this.eB.find(b)):h(null)}searchV2(b,h){v.AFrameworkApplication.$n("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.eB.G_a();if(this.RFf(b)){this.uxi()&&this.ga.Rb(Za.a.ege,2,{CommandValueId:b});this.que=h;this.jih=b.totalResultLimit;this.jM=new zb.a;b=this.Iaf(b);this.cOg=new Hn.a;this.eB.find(b);h=this.Hfa.u3c(b.text);h=this.Hfa.OMb(h);b=this.zWb.b$b(h.join("|"),b);h=this.Wh.$O();for(let B=0;B<h.length;B++){const Q=h[B],ca=CL(Q);var u=this.vub.kjb(ca,b);const qa=this.vub.kjb(Q.author,b);if(!u&&!qa){r.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ca,!b);continue}u=qa&&
(!this.Gui||0<qa.length)?qa:u;let Qa="",rb="";qa&&(!this.Gui||0<qa.length)&&(Qa=Q.author,rb=Q.authorId);for(const Lb of u)u=jN.a.createInstance(Lb.Ac,Lb.end,W.a.Ff(Q.objectId),B,32,!1),this.Trc.add(u),this.Hba.nb(B)||this.Hba.add(B,Object.assign(new EL,{n8e:ca,vEb:[],authorName:Qa,authorEmail:rb}))}}else h(null)}get KZh(){null==this.rAe&&(this.rAe=Sk.FindManager.createInstance(this,this.Hfa,Ea.a.instance));return this.rAe}uxi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:
b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}rcc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}get Gui(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentsInFindPaneFix",!1)}highlight(b){var h=this.RFf(b);b=h?this.Iaf(b):null;var u={};this.uxi()&&this.ga.Rb(Qc.a.O3f,
2,u);if(u[gg.a.On]){if(h){h={};u={};var B={};this.ga.Rb(Qc.a.sae,2,h);this.ga.Rb(Za.a.rae,2,u);this.ga.Rb(Za.a.tae,2,B);if(b.text!=h.CommandValueId||b.matchCase!=u[gg.a.On]||b.matchWholeWord!=B[gg.a.On])QH(this.ib),this.ga.Rb(Za.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else u=this.KZh,u.G_a(),h&&u.find(b)}selectNextPrevHighlight(b){const h=this.KZh;return 0<h.Oj.ika?(b?h.Kji():h.Pji(),h.Oj.bYe-1):-1}Iaf(b){let h=Lj.a.none;b.matchCase&&(h|=
Lj.a.matchCase);b.matchWholeWordOnly&&(h|=Lj.a.wholeWordOnly);return Gi.a.createQuery(b.query,h)}RFf(b){return b&&!!b.query&&0<b.query.length}$ge(){}sfe(){}reset(){}Vjf(){}P7b(){if(this.vv){var b=this.oKh(this.jM);this.vv(b)}if(this.que){b=new PG;const h=this.jM.count+this.Trc.count>this.jih;b.totalResultCount=this.jM.count+this.Trc.count;b.hasTooManyResults=h;h||(this.jM.aD(this.jM.count,this.Trc),b.results=this.oKh(this.jM));this.que(b);this.Trc.clear()}}oKh(b){var h;const u=[];var B=Object.assign(new iE.a,
{oP:!1,Gca:!0,Toa:this.rcc(),pP:!0});B=this.gb.YEa(this.Bu.value,B);for(const qa of b){var Q=qa.Ac;let Qa=qa.end;var ca=void 0;b=-1;let rb=null,Lb=0;if(32===qa.type){rb=fw.m8e;Lb=3;b=B.count+qa.iQa;const Yb=({Ac:Q,end:Qa}=xL.a.i9i(this.Hba.J(qa.iQa).n8e,Q,Qa)).returnValue;ca=this.idb.CId(Yb,Q,Qa,vh.a(qa.type));this.Hba.J(qa.iQa).n8e=Yb;this.Hba.J(qa.iQa).vEb.push(Object.assign(new FL,{Ac:Q,end:Qa}))}else{if(2===qa.type||4===qa.type)Lb=2===qa.type?1:2,rb=fw.Yxf;if(8===qa.type||16===qa.type)Lb=8===
qa.type?6:5,rb=fw.CSf;for(ca=0;ca<B.count;ca++)if(B.J(ca).id===qa.nodeId){b=ca;break}ca=this.idb.DId(qa)}Q=(null===(h=this.Hba)||void 0===h?0:h.nb(qa.iQa))?this.Hba.J(qa.iQa):null;if(0<=b||(null===Q||void 0===Q?0:Q.authorName))b=Object.assign(new DL,{snippet:ca.mHd,subdocumentId:rb,subdocumentType:Lb,startOffsetInSnippet:ca.Mde,endOffsetInSnippet:ca.Kde-1,paragraphIndex:b,startOffsetInParagraph:qa.Ac-ca.Mde,endOffsetInParagraph:qa.end-ca.Kde-1,authorName:Q?Q.authorName:"",authorEmail:Q?Q.authorEmail:
""}),u.push(b)}u.sort((qa,Qa)=>qa.paragraphIndex===Qa.paragraphIndex?qa.startOffsetInParagraph-Qa.startOffsetInParagraph:qa.paragraphIndex-Qa.paragraphIndex);return u}update(){}fPa(b,h){switch(b){case 0:h&&0<h.length&&!this.jM&&(r.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.jM=new zb.a);for(const u of h)this.jM.add(u)}}ypb(){}dispose(){}}fw.m8e="Comment";fw.Yxf="HeaderFooter";fw.CSf="Note";fw.Qoi="Image";Object(m.a)(fw,"WordDocumentSearchProcessor",null,[321,10,322]);
class GL extends MH{get iS(){return!this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}rcc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,u,B,Q,ca,qa,Qa,rb,Lb,Yb,gc,Fc,Sc){super();this.Ga=Lb;this.UMa=null;this.LY=(ld,Hd)=>{ld=Hd.node;Hd=Hd.property;this.Ieg(ld)&&Hd===Xe.a.vo&&this.YGb(ld,3)};this.Pia=(ld,Hd)=>{ld=Hd.node;
!Hd.ZCf&&this.Ieg(ld)&&this.YGb(ld,1)};this.jnb=(ld,Hd)=>{ld=Hd.node;this.Ieg(ld)&&this.YGb(ld,2)};this.Bu=b;this.gb=h;this.kd=u;this.ib=B;this.JE=Q;this.sl=Qa;this.Vb=rb;this.F7=ca;this.wC=qa;this.Wh=Yb;this.s5j=gc;this.Ach=W.a.create();this.oce(this.LY,this.Pia,this.jnb);Sc&&Sc.execute(ld=>this.Ola=ld);Fc.execute(ld=>{this.YYa=ld})}submitDocumentContentExtractionSignal(){this.YYa&&this.YYa.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.YYa?this.YYa.generateDocumentSummary():
Promise.resolve(null)}generateDocumentSummaryDetails(){return this.YYa?this.YYa.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.qU(this.R6l());for(const u of this.Wh.$O()){var h=NH.a.LSd(u.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new iE.a,{oP:!1,Gca:!1,pP:!0}),u=this.gb.YEa(this.Bu.value,h);h=[];const B=[];for(var Q=0;Q<u.count;++Q){var ca=u.J(Q);h.push(...this.FZl(ca,
Q));B.push(...this.F7.IYl(ca,Q))}u=[];Q=this.Wh.$O();for(ca=0;ca<Q.length;ca++)u.push(this.dQl(Q[ca]));Q={};Q.images=h;Q.comments=u;Q.highlights=B;b(Q)}selectRange(b,h,u,B,Q){const ca=Date.now(),qa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.VTa();if(0>b||0>h||0>u||0>B||b>u||b===u&&h>B)throw Error("Provided select range offsets incorrect");const Sc=Object.assign(new iE.a,{oP:!1,Gca:!0,Toa:this.rcc(),pP:!0}),ld=this.gb.YEa(this.Bu.value,Sc);
if(u>=ld.count){const Hd=Ga.a.instance.resolve("Common.Comments.ICommentModel").$O(),Ie=u-ld.count;if(Ie<Hd.length){Q=-1;if(this.F7.Hba.nb(Ie)){const de=this.F7.Hba.J(Ie).vEb;for(var Qa=0;Qa<de.length;Qa++)if(de[Qa].Ac===h){Q=Qa;break}}this.UMa=-1!==Q?Object.assign(new PH,{i8e:Ie,ENc:Q}):null;const fe=Hd[Ie];v.AFrameworkApplication.va.processAction(Qc.a.ZT,2);v.AFrameworkApplication.va.Rb(Qc.a.d4,2,null);v.AFrameworkApplication.va.Rb(Qc.a.selectComment,2,Object.assign(new AL.a,{commentId:fe.id,s$:2,
iS:this.iS}))}}else{this.UMa=null;var rb=ld.J(b),Lb=ld.J(u);if(!this.G0d(rb,h)||!this.G0d(Lb,B))throw Error("Provided select range offsets incorrect");v.AFrameworkApplication.va.processAction(Qc.a.ZT,2);this.RIo(rb);var Yb=this.JE.ne(rb,h);Qa=this.JE.Dy(Yb,Je.a.Oc(Lb,B+1));if(Q){const Hd=Qa.toArray();h=[];for(const Ie of Hd)h.push(this.zSd(Ie.node));h.join(" ").includes(Q)||(qa.success=!1,qa.message="The text in clicked passage does not match the selected hit")}var gc=this.sl.value.gu,Fc=this.ib.hb.lb;
Fc&&Fc.equals(Qa)&&this.kd.dea(gc,null);this.kd.dea(gc,Qa);qa.duration=Date.now()-ca;this.logMessage(qa)}}catch(Sc){qa.success=!1,qa.message=Sc.stack,qa.duration=Date.now()-ca,this.logMessage(qa)}}search(b,h){this.VTa();this.F7.search(Object.assign(new QG,{query:b}),h)}searchV2(b,h){this.VTa();this.F7.searchV2(Object.assign(new QG,{query:b}),h)}selectNextPrevHighlight(b){this.VTa();return this.F7.selectNextPrevHighlight(b)}searchWithParam(b,h){this.VTa();this.F7.search(b,h)}searchWithParamV2(b,h){this.VTa();
this.F7.searchV2(b,h)}highlight(b){this.VTa();this.F7.highlight(Object.assign(new QG,{query:b}))}highlightWithParam(b){this.VTa();this.F7.highlight(b)}getRevision(){return this.Ach.toString()}getSelectedText(){const b=this.s5j.getSelectedText();return Object.assign(new Lx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new iE.a,{oP:!1,Gca:!0,Toa:this.rcc(),pP:!0}),h=({es:ca}=this.Abm(b)).returnValue;if(h)return h;
var u=this.ib.hb.lb;if(!u||!u.length)return null;h=u.Pa;u=u.Rc;let B=-1,Q=-1;var ca=ca||this.gb.YEa(this.Bu.value,b);b=null;for(let qa=0;qa<ca.count;qa++){const Qa=ca.J(qa);-1===B&&h.node.id===Qa.id&&(B=qa,b=Qa);-1===Q&&u.node.id===Qa.id&&(Q=qa)}ca=null;5===(null===b||void 0===b?void 0:b.Mna)&&(ca=fw.Yxf);if(1===(null===b||void 0===b?void 0:b.Mna)||2===(null===b||void 0===b?void 0:b.Mna))ca=fw.CSf;return Object.assign(new OH,{subdocumentId:ca,startParagraphIndex:B,startParagraphOffset:h.Ij,endParagraphIndex:Q,
endParagraphOffset:u.np})}clearDocumentSelection(){QH(this.ib)}selectRangeV2(b,h,u,B,Q,ca){const qa=Date.now(),Qa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.VTa();if(0>h||0>u||0>B||0>Q||h>B||h===B&&u>Q)throw Error("Provided select range offsets incorrect");var rb=Object.assign(new iE.a,{oP:!1,Gca:!0,Toa:this.rcc(),pP:!0});const Fc=this.gb.YEa(this.Bu.value,rb);if(b==fw.m8e)this.Agj(u,B,Fc.count);else{rb=this.UMa=null;var Lb={};Lb.subdocumentId=
b;Lb.startParagraphIndex=h;Lb.startParagraphOffset=u;Lb.endParagraphIndex=B;Lb.endParagraphOffset=Q;rb=b==fw.Qoi?this.Z9h(Fc.J(h),{isFloatingImage:!1,imageId:"",...Lb}):this.zhi(Fc.J(h),Fc.J(B),{clickedPassage:ca,...Lb},Qa);var Yb=this.sl.value.gu,gc=this.ib.hb.lb;(null===gc||void 0===gc?0:gc.equals(rb))&&this.kd.dea(Yb,null);this.kd.dea(Yb,rb)}Qa.duration=Date.now()-qa;this.logMessage(Qa)}catch(Fc){Qa.success=!1,Qa.message=Fc.stack,Qa.duration=Date.now()-qa,this.logMessage(Qa)}}selectRangeV3(b){const h=
Date.now(),u={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.VTa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var B=Object.assign(new iE.a,{oP:!1,Gca:!0,Toa:this.rcc(),pP:!0});const qa=this.gb.YEa(this.Bu.value,
B);if(b.subdocumentId==fw.m8e)this.Agj(b.startParagraphOffset,b.endParagraphIndex,qa.count);else{B=this.UMa=null;B=b.subdocumentId==fw.Qoi?this.Z9h(qa.J(b.startParagraphIndex),b):this.zhi(qa.J(b.startParagraphIndex),qa.J(b.endParagraphIndex),b,u);var Q=this.sl.value.gu,ca=this.ib.hb.lb;(null===ca||void 0===ca?0:ca.equals(B))&&this.kd.dea(Q,null);this.kd.dea(Q,B)}u.duration=Date.now()-h;this.logMessage(u)}catch(qa){u.success=!1,u.message=qa.stack,u.duration=Date.now()-h,this.logMessage(u)}}R6l(){const b=
Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},u=Object.assign(new iE.a,{oP:!1,Gca:!1,pP:!0});h.duration=Date.now()-b;this.logMessage(h);return this.gb.YEa(this.Bu.value,u)}qU(b){const h=Date.now(),u={activityName:"GetParagraphContent",success:!0,message:"",duration:0},B=new zb.a;for(const Q of b)B.add(this.zSd(Q));u.duration=Date.now()-h;this.logMessage(u);return B}Z9h(b,h){if(h.isFloatingImage)return h=W.a.Ff(h.imageId),b=b.Lc.Eb(h),b=Cg.SelectionFactory.Aq(b);
const u=this.JE.ne(b,h.startParagraphOffset);return b=this.JE.Dy(u,Je.a.Oc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new Bj.a(b,"O365",h,b);if(!this.Ola||!this.Ola.getPersonaIconPropertiesArray)return null;b=await this.Ola.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new BL,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}zhi(b,h,u,B){if(!this.G0d(b,u.startParagraphOffset)||!this.G0d(h,
u.endParagraphOffset))throw Error("Provided select range offsets incorrect");u.subdocumentId==fw.Yxf?v.AFrameworkApplication.va.Rb(Qc.a.Hlb,2,new ou.a(b)):v.AFrameworkApplication.va.processAction(Qc.a.ZT,2);u.subdocumentId==fw.CSf?32===v.AFrameworkApplication.va.Rb(Qc.a.N5a,2,new ou.a(b))&&v.AFrameworkApplication.va.processAction(Qc.a.sOd,2):v.AFrameworkApplication.va.Rb(Qc.a.d4,2,null);b=this.JE.ne(b,u.startParagraphOffset);h=this.JE.Dy(b,Je.a.Oc(h,u.endParagraphOffset+1));if(u.clickedPassage){b=
h.toArray();const Q=[];for(const ca of b)Q.push(this.zSd(ca.node));Q.join(" ").includes(u.clickedPassage)||(B.success=!1,B.message="The text in clicked passage does not match the selected hit")}return h}Agj(b,h,u){const B=Ga.a.instance.resolve("Common.Comments.ICommentModel").$O();h-=u;if(h<B.length){u=-1;if(this.F7.Hba.nb(h)){const Q=this.F7.Hba.J(h).vEb;for(let ca=0;ca<Q.length;ca++)if(Q[ca].Ac===b){u=ca;break}}this.UMa=-1!==u?Object.assign(new PH,{i8e:h,ENc:u}):null;b=B[h];v.AFrameworkApplication.va.processAction(Qc.a.ZT,
2);v.AFrameworkApplication.va.Rb(Qc.a.d4,2,null);v.AFrameworkApplication.va.Rb(Qc.a.selectComment,2,Object.assign(new AL.a,{commentId:b.id,s$:2,iS:this.iS}))}}VTa(){this.Vb&&(this.Vb.currentScope&&this.Vb.currentScope.name===Ph.iC||this.Vb.kg(Ph.iC))}GWo(){this.Ach=W.a.create()}zSd(b){if(b.AIb)return"";b=this.gb.text(b);return wp.AParagraphNode.NP(b," ")}G0d(b,h){b=this.zSd(b);return h<b.length}YGb(b,h){switch(h){case 1:case 2:case 3:this.GWo()}}logMessage(b){const h=[Object.assign(new ha.a,{name:"Message",
string:b.message})];Object(Fe.a)(b.activityName,b.success,b.duration,h)}Ieg(b){return!b.AIb&&this.zWc(b)}zWc(b){const h=this.Bu.value;return!!h&&!!h.vd&&!!b.Lc&&b.Lc.id.equals(h.vd.id)}RIo(b){this.gb.icc(b)?32===v.AFrameworkApplication.va.Rb(Qc.a.N5a,2,new ou.a(b))&&v.AFrameworkApplication.va.processAction(Qc.a.sOd,2):v.AFrameworkApplication.va.Rb(Qc.a.d4,2,null)}oce(b,h,u){this.wC&&(this.wC.Mo(b),this.wC.hu(h),this.wC.Fx(u))}Abm(b){let h=null;var u=this.Vb?this.Vb.currentScope.name:"";if(!this.Wh.qt||
u!==$d.AFrame.Qr&&u!==$d.AFrame.GM)return{returnValue:null,es:h};u=Array.indexOf(this.Wh.$O(),this.Wh.qt);if(0>u)return{returnValue:null,es:h};h=this.gb.YEa(this.Bu.value,b);var B=NH.a.LSd(this.Wh.qt.text[0]).split("\n");b=0;B=(1===B.length?B[0]:B.join(" ")).length-1;this.UMa&&u===this.UMa.i8e&&this.F7.Hba.nb(u)&&this.F7.Hba.J(u).vEb.length>this.UMa.ENc&&(b=this.F7.Hba.J(u).vEb[this.UMa.ENc].Ac,B=this.F7.Hba.J(u).vEb[this.UMa.ENc].end);return{returnValue:Object.assign(new OH,{startParagraphIndex:h.count+
u,startParagraphOffset:b,endParagraphIndex:h.count+u,endParagraphOffset:B,subdocumentId:"Comment"}),es:h}}FZl(b,h){const u=[];if(12!=b.type)return u;u.push(...this.e_l(b,h));u.push(...this.JWl(b,h));return u}JWl(b,h){const u=[],B=vd.GraphIterator.eb(b);if(!B.Gz())return u;let Q=B.Qd();for(;Q;){if(!this.JQa(Q)){Q=B.Gt();continue}const ca=Q.properties;ca&&Dd.ImageReader.ZVc(ca)&&u.push(this.uzj(ca,h,0,b.Lc,!0,Q.id.toString()));Q=B.Gt()}return u}JQa(b){if(19!==b.type||5!==Dd.ImageReader.vi(b))return!1;
b=vd.GraphIterator.eb(b);if(!b.Gz())return!0;let h=b.Qd();for(;h;){if(59===h.type)return!1;h=b.Gt()}return!0}e_l(b,h){const u=[],B=b.Lc;if(B){if(!b.hasProperty(Xe.a.Ln))return u;var Q=b.ja(Xe.a.Ln,null);if(!Q)return u;b=b.ja(Xe.a.Dm,null);for(let qa=0;qa<Q.length;++qa){var ca=Q[qa];if(!ca)continue;ca=B.Eb(ca);if(!ca||!Dd.ImageReader.ZVc(ca)||5!==Dd.ImageReader.vi(ca))continue;let Qa=0;0!=qa&&b&&qa-1<b.length&&(Qa=b[qa-1]);u.push(this.uzj(ca,h,Qa,B,!1,""))}return u}}uzj(b,h,u,B,Q,ca){B=(new Sys.Net.WebRequest).getResolvedUrl()+
Dd.ImageReader.s5l(b,B);const qa=b.ja($c.a.at,""),Qa={};Qa.base64Encoding=qa;Qa.url=B;Qa.width=Dd.ImageReader.WC(b);Qa.height=Dd.ImageReader.NH(b);Qa.altText=Dd.ImageReader.PX(b);Qa.description=Dd.ImageReader.JPa(b);Qa.imageId=ca;Qa.isFloatingImage=Q;return{data:Qa,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:u,endOffsetInParagraph:u+1}}dQl(b){return{data:{comment:CL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,
startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(m.a)(GL,"WordDocumentContentExecutor",MH,[]);class RG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(m.a)(RG,"BaseDocumentHelper",null,[458]);class HL extends RG{constructor(b){super();this.iIl=b}get D6b(){const b=this.iIl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Fb.App.za.jb.isEditingAllowed}author(){var b;return null===(b=this.D6b)||void 0===b?void 0:b.author}createdDate(){var b;
return null===(b=this.D6b)||void 0===b?void 0:b.creationDate}}Object(m.a)(HL,"WordDocumentHelper",RG,[]);class IL{constructor(b){this.wKi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.NAf(b.htmlText)}getId(){return"InsertContentExecutor"}NAf(b){return this.executeCommand(Ob.a.Lma,b)}executeCommand(b,h){const u=new Od.DictionaryPropertySet;u.setValue($c.a.IP,h);u.setValue($c.a.Gja,!1);h=this.wKi.processAction(b,1);32===h&&(h=this.wKi.Rb(b,2,u));return h}}Object(m.a)(IL,"WordInsertContentExecutor",
null,[319,320]);var kN=c(1715),lN=c(1716);class JL{constructor(b,h,u,B,Q){this.Lsc="undefined";this.aeg="Something went wrong with retrieving a summary. Please try again.";this.QEm=(ca,qa,Qa,rb,Lb)=>Bv.pY(ca,qa,Qa,rb,this.tC,Lb);this.Xhe=(ca,qa,Qa,rb,Lb)=>{if(1===Qa)return this.t6j?32:8;ca=oG.getSelectedText();ca=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,oG.bTd(ca));Lb[xm.a.LabelText]=ca;return 32};this.imf=(ca,qa,Qa)=>{if(1===Qa)return 32;const rb=
{};this.YYa?this.YYa.generateDocumentSummary().then(Lb=>{Lb||(Lb=this.aeg,r.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));rb.additionalData=this.r$e(Lb);this.ga.Rb(Za.a.K8,2,rb)}).catch(()=>{r.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");rb.additionalData=this.r$e(this.aeg);this.ga.Rb(Za.a.K8,2,rb)}):(r.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),
rb.additionalData=this.r$e(this.aeg),this.ga.Rb(Za.a.K8,2,rb));return 32};this.HKo=(ca,qa,Qa)=>{if(!this.jLi)return r.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Qa)return this.gUm()?32:2;if(2===Qa)this.jLi.$Td(this.Ga.kb("SmartLookupShredderServiceEndpoint")).then(rb=>{rb={token:rb,files:G.c(this.MVl()),type:"MultiFilesDeckGeneration"};rb=Object.assign(new kN.a,{selection:Object.assign(new Lx.a,{neighborhood:"",mentionStart:0,mentionLength:0}),
launchData:Object.assign(new Fu.a,{landingTab:"All",data:rb}),entryPoint:38});this.ga.Rb(Za.a.g9,2,rb);return 32}).catch(()=>{r.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.tC=b;this.ga=h||v.AFrameworkApplication.va;this.Ga=u;this.c6j=(this.Mw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.qL)&&!!this.Ga&&this.Ga.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.t6j=!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1);B&&B.execute(ca=>{this.YYa=ca});this.jLi=Q}Tb(){this.ga.fb(Qc.a.kvh,Ad.a.frame,this.QEm,1028);this.ga.fb(Qc.a.Xhe,Ad.a.frame,this.Xhe,1028);this.ga.fb(Qc.a.t2h,Ad.a.frame,this.imf,1028);this.ga.fb(Qc.a.vzj,Ad.a.frame,this.HKo,1028);this.c6j&&(this.Lsc=Fb.App.za.VI.getWindowMode(),this.LVh(this.Lsc),Fb.App.za.VI.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.Lsc&&(this.Lsc=h,this.LVh(this.Lsc))}))}gUm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",
!1)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}LVh(b){"DP"===b&&mk.UISurfaces.Mu().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Rb(Qc.a.kvh,2,{SourceControlId:"smartlookupAuto"});return null})}r$e(b){return{["documentSummary"]:b}}MVl(){const b=new lN.a("docx",v.AFrameworkApplication.K.kb("EditDocInClientUrl"),v.AFrameworkApplication.K.kb("BreadcrumbBrandUrl"),"",v.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,
(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(m.a)(JL,"WordInsightsActor",null,[]);class VE{constructor(){this.Vhd=this.rQ=null}i2a(){return this.LFb()}v$h(){return this.LFb()}t$h(){return null}Auo(b,h,u){this.rQ||(this.rQ=this.mId());this.rQ.OP(b,h,u)}Buo(b,h,u){this.rQ||(this.rQ=this.mId());this.rQ.fgg(b,h,u)}Wso(b,h){this.Vhd||(this.Vhd=null);this.Vhd&&this.Vhd.fgg(b,h)}vPb(b,h){this.rQ||(this.rQ=this.mId());this.rQ.vPb(b,h)}s1d(b){this.rQ||(this.rQ=this.mId());this.rQ.s1d(b)}ubo(){this.rQ&&
this.rQ.Wjc()}fgo(){this.rQ&&this.rQ.Sfe()}hso(){var b=v.AFrameworkApplication.K.lc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-VE.zEi<=b;b||(VE.zEi=window.performance.now());return b}dispose(){this.rQ&&(this.rQ.dispose(),this.rQ=null)}get dJb(){return this.rQ?this.rQ.isVisible:!1}}VE.zEi=0;Object(m.a)(VE,"InsightsManager",null,[950,10]);class RF{constructor(b,h,u,B,Q,ca=!0,qa=null,Qa=null){this.q6=this.GE=this.FLa=null;this.jxc=!1;this.kfa=null;this.Vb=h;this.QXb=
ca;this.uRg=Qa?Qa:new RG;this.Xu=qa;this.hp=b;this.QXb&&(Ga.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime")&&(this.kfa=Ga.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Zpf()),this.jdb=Ga.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Mzb=this.jdb.aRc())}enb(b){if(this.QXb){b=b.rawEvent;try{var h=G.a(b.data)}catch(u){r.ULS.sendTraceTag(595161728,1303,15,this.iU("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=
0;this.GE&&(b=this.GE.entryPoint);this.jdb.ptf(this.q6,this.uRg,this.y$b(),b).then(u=>{h.data=u;this.Ynb(h)});break;case 118:h.data=this.GE?this.GE:Object.assign(new Xt.a,{selection:Object.assign(new Lx.a,{neighborhood:this.FLa.neighborhood,mentionStart:this.FLa.mentionStart,mentionLength:this.FLa.mentionLength})});this.Ynb(h);break;case 103:b=G.a(Object(Na.a)(String,h.data));Pl.sendTelemetryEvent(b);break;case 206:this.jdb.$Td(h.data).then(u=>{h.data=u;this.Ynb(h)});break;case 112:h.data.shiftPressed?
(Z.a.lj&&document.activeElement.blur(),this.hp.QUd(0,null,2,null,null),r.ULS.sendTraceTag(592545156,1303,50,this.iU("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.hp.SRc(0,null,2,null,null),r.ULS.sendTraceTag(592545155,1303,50,this.iU("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Loa()}}}F7c(b){if(this.kfa){var h=0;this.GE&&(h=this.GE.entryPoint);this.jdb.ptf(this.q6,this.uRg,this.y$b(),h).then(u=>{Pl.Bhj("SearchFromHost",this.q6);this.GE.launchData||(this.GE.launchData=
new Fu.a);const B=NG();try{this.kfa.search(this.GE,u,v.AFrameworkApplication.userSessionId,B,b),this.jdb.Tzn(Q=>{Pl.Bhj("SearchFromHostWithToken",this.q6);this.kfa.searchAuthenticatedProviders(this.GE,u,v.AFrameworkApplication.userSessionId,B,null,Q)})}catch(Q){Pl.Tz("BaseSmartLookupPane - Fail to search from host. Error: "+Q,10)}}).catch(u=>{Pl.Tz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+u.toString(),10)})}}Xjc(b){if(this.QXb){var h=Pl,u=h.Xjc,B=this.q6;
b=Math.round(window.performance.now()-b);var Q=this.GE?SE[this.GE.entryPoint]:"",ca=this.jdb.aRc(),qa=this.jdb.BVl(),Qa=this.GE?this.GE.entryPoint:0;u.call(h,B,b,Q,ca,qa,v.AFrameworkApplication.k0e,this.jxc,18===Qa||19===Qa||15===Qa)}}}Object(m.a)(RF,"BaseSmartLookupPane",null,[428,10]);class SF{constructor(b){this.messageType=null;this.messageType=b}}Object(m.a)(SF,"InsightsMessage",null,[]);class TF extends SF{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(m.a)(TF,
"InsightsMessageWithContent",SF,[]);class KL extends TF{constructor(b){super(Ph.Ran,b)}}Object(m.a)(KL,"InsightsMessageAppProperties",TF,[]);class LL extends TF{constructor(b){super(Ph.bbn,b)}}Object(m.a)(LL,"InsightsMessageSelection",TF,[]);class ML extends SF{constructor(){super(Ph.dbn)}}Object(m.a)(ML,"InsightsMessageTakeFocus",SF,[]);class UF extends RF{constructor(b,h,u,B,Q=null,ca=null,qa=null,Qa=!0,rb=null,Lb=null){super(h,u,Q,ca,qa,Qa,rb,Lb);this.Ugd=this.gB=this.gj=null;this.nsd=!1;this.cnd=
b;this.Svc=this.QXb?JH(this.Mzb):v.AFrameworkApplication.WCm;this.G_();this.L5f();this.Zp=B;this.hQg=0}get isVisible(){return!1}G_(){this.gj=this.cnd.dKc();v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb.$kb&&this.gj.AUn(b=>{b===this.gj&&(this.Sfe(),this.Wjc())});this.pAf(this.gj.qUa.Svh);this.gj.Bm()}pAf(b){b.style.overflow="hidden";const h=ig.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.gB=h;b.appendChild(this.gB);
this.gB.id=Ph.Tyf}L5f(){Me.a.addHandler(this.gB,"load",Object(z.a)(this,this.dnb,"onIFrameLoad"));Me.a.addHandler(this.gB,"error",Object(z.a)(this,this.cnb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,this.enb,"onIFrameMessage"))}mng(){Me.a.removeHandler(this.gB,"load",Object(z.a)(this,this.dnb,"onIFrameLoad"));Me.a.removeHandler(this.gB,"error",Object(z.a)(this,this.cnb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.enb,"onIFrameMessage"))}dispose(){this.gB&&
(this.mng(),this.gB.parentNode.removeChild(this.gB),this.gB=null);this.gj&&(this.cnd.x6b(this.gj),this.gj=null)}OP(b,h,u){this.q6=h;this.Ugd=null;this.hQg=u;this.jxc=!b.mentionLength;this.nsd=!1;r.ULS.sendTraceTag(6295947,1303,50,this.iU("Start to show Insights"));this.FLa=b;this.Svc&&this.Svc.length?this.gB.src=this.Svc:(this.gB.src=UF.SQi,r.ULS.sendTraceTag(6295948,1303,15,this.iU("The Insights URL config setting is null or empty")));this.Zp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,
!0);this.gj.zY||this.gj.T5f(Object(z.a)(this,this.nnn,"onInsightsTaskPaneHidden"));this.QXb&&this.F7c(!1);b=window.performance.now();this.cnd.showTaskPane(this.gj);this.gj.Bm();this.Xjc(b)}fgg(b,h,u){this.GE=b;this.OP(Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,u)}vPb(){}s1d(){}Wjc(){this.gB.src===this.Svc&&this.nsd&&(this.Vb.kg(Ph.iC),this.Ynb(new ML))}Sfe(){this.gB&&hd.FocusManager.fK(this.gB.contentWindow)}zcf(){this.gB.src=
UF.SQi;this.gj.Cm()}Loa(){this.cnd.hideTaskPane(this.gj);this.zcf()}nnn(b){b===this.gj&&this.Loa()}dnb(){r.ULS.sendTraceTag(6295951,1303,50,this.iU("The iframe is successfully loaded in Insights task pane"))}cnb(){r.ULS.sendTraceTag(6295952,1303,15,this.iU("The iframe failed to load in Insights task pane"))}enb(b){const h=b.rawEvent;if(h.source===this.gB.contentWindow)if(this.QXb)super.enb(b);else{let u;try{u=G.a(h.data)}catch(B){r.ULS.sendTraceTag(6295953,1303,15,this.iU("Message data [{0}] failed to deserialize.",
h.data));return}if(Le.c(u.messageType))r.ULS.sendTraceTag(6295954,1303,15,this.iU("Message data [{0}] is in wrong format.",h.data));else switch(u.messageType){case Ph.San:this.Ynb(new KL(this.n_l()));break;case Ph.cbn:this.Ynb(new LL(this.FLa));break;case Ph.Yan:this.nsd=!0;this.Sfe();this.Wjc();r.ULS.sendTraceTag(6295955,1303,50,this.iU("Insights pane rendering is completed"));break;case Ph.ebn:b=u.messageContent;this.Ugd=b.clientCorrelationId;this.q6!==b.appCorrelationId&&r.ULS.sendTraceTag(6403778,
1303,15,this.iU("App correlation ID on client {0} does not match one on server {1}",this.q6,b.appCorrelationId));break;case Ph.Xan:u.messageContent?(Z.a.lj&&document.activeElement.blur(),this.hp.QUd(0,null,2,null,null),r.ULS.sendTraceTag(6604741,1303,50,this.iU("Insights UX lost focus through Ctrl + Shift + F6"))):(this.hp.SRc(0,null,2,null,null),r.ULS.sendTraceTag(6604742,1303,50,this.iU("Insights UX lost focus through Ctrl + F6")));break;case Ph.Uan:u.messageContent.keyCode===Se.a.yJa&&this.Loa();
break;case Ph.Van:try{this.nsd=!1,localStorage.setItem(Ph.sFi,"true")}catch(B){r.ULS.sendTraceTag(17961859,1303,10,this.iU("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}n_l(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.q6;3===v.AFrameworkApplication.ua.Lb.Nk?b.applicationName=Ph.x5o:4===v.AFrameworkApplication.ua.Lb.Nk&&(b.applicationName=Ph.Qtn);b.applicationVersion=v.AFrameworkApplication.buildVersion;var h=Jj.a.qg(v.AFrameworkApplication.lcid);h=h?h.name:
null;b.market=IH(h);b.uiLanguage=h;b.sessionId=v.AFrameworkApplication.userSessionId;b.parentalControl=Ph.FZf;b.clientType="user";b.legalAgreed=this.w0l();b.defaultDefineTab=1===this.hQg?"true":null;return b}iU(b,...h){const u={};this.q6&&(u[Ph.Nwj]=this.q6);this.Ugd&&(u[Ph.cGo]=this.Ugd);u[Ph.Owj]=String.format.apply(null,[b].concat(h));return G.c(u)}y$b(){return 5}w0l(){try{const b=localStorage.getItem(Ph.sFi);return!!b&&"true"===b}catch(b){return r.ULS.sendTraceTag(17961860,1303,10,this.iU("Failed to GetItem in LocalStorage for LegalAgreed")),
!1}}Ynb(b){b=G.c(b);this.gB.contentWindow.postMessage(b,fa.a.getOrigin(this.Svc))}}UF.SQi="about:blank";Object(m.a)(UF,"InsightsPane",RF,[]);class NL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(m.a)(NL,"SmartLookupTaskPaneProps",null,[]);class OL{}Object(m.a)(OL,"ActionDescriptor",null,[]);class PL extends RF{constructor(b,h,u,B=null,Q=null,ca=null,qa=!0,Qa=null,rb=null){super(h,u,B,Q,ca,qa,Qa,rb);this.dUe=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Lb&&v.AFrameworkApplication.ua.Lb.eHf;
this.Rs=this.UOe=!1;this.f$j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.d$j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.i$j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.h$j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);qa||Pl.Tz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.TBa=b;this.ZXg=JH(this.Mzb)}get isVisible(){return this.Rs}vPb(b,h){this.GE=b;this.FLa=b=Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.jxc=!b.mentionLength;this.q6=h;this.F7c(!1)}s1d(b){this.GE=b;this.tlc(Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}OP(b,h){this.q6=h;this.tlc(b,!0)}fgg(b,h,
u){this.GE=b;this.OP(Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,u)}Loa(){this.$da();this.TBa.hideTaskPane()}tlc(b,h){fc.SessionStatusManager.instance.WH&&this.kfa?(this.FLa=b,this.jxc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?v.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.TBa.updateTaskPane(null),h&&this.cco()):(h&&this.F7c(!1),this.UOe=
!this.UOe,this.TBa.updateTaskPane(this.vA())):(h&&this.F7c(this.isVisible),this.TBa.showTaskPane(this.vA())),this.Xjc(b)):(this.TBa.showTaskPane(this.vA()),Pl.wbo(fc.SessionStatusManager.instance.WH,!!this.kfa,this.GE?SE[this.GE.entryPoint]:"",this.jdb.aRc(),v.AFrameworkApplication.k0e,this.jxc))}cco(){if(!this.GE){const b=Object.assign(new Lx.a,{neighborhood:this.FLa.neighborhood,mentionStart:this.FLa.mentionStart,mentionLength:this.FLa.mentionLength});this.GE=Object.assign(new Xt.a,{selection:b,
userIntent:null,entryPoint:0,launchData:null})}this.F7c(this.isVisible)}Gbo(){const b=new OL;b.transactionId=this.q6;b.actionType=15;b.channelId=Ph.channelId;this.Ynb(b)}enb(b){const h=b.rawEvent;document.getElementById(Ph.iC)&&h.source!==document.getElementById(Ph.iC).contentWindow||this.kNn(b)}kNn(b){const h=b.rawEvent;let u;try{u=G.b(h.data)}catch(B){r.ULS.sendTraceTag(545604257,1303,15,this.iU("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(u.actionType){case 32:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&(kc.a.NGb()>=this.f$j?this.TBa.updateTaskPane(this.abf(this.d$j)):kc.a.NGb()>=this.i$j&&this.TBa.updateTaskPane(this.abf(this.h$j)));break;case 33:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.TBa.updateTaskPane(this.abf(u.data));break;case 42:this.TBa.updateTaskPane(this.kdl(u.data));break;case 43:this.TBa.updateTaskPane(this.vA());break;default:super.enb(b)}}dispose(){}initialize(){this.G_();this.Sja()}G_(){this.TBa.dKc()}Sja(){const b=
this.Vb.ae(Ph.iC);b.parent=$d.AFrame.xp;b.$H=!0}mgo(){this.Vb.kg(Ph.iC)}$da(){this.w4a()&&this.Vb.kg(this.Vb.XT)}L5f(){$addHandler(window,"message",Object(z.a)(this,this.enb,"onIFrameMessage"))}mng(){$removeHandler(window,"message",Object(z.a)(this,this.enb,"onIFrameMessage"))}w4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Ph.iC}Ynb(b){b=G.c(b);document.getElementById(Ph.iC)&&document.getElementById(Ph.iC).contentWindow.postMessage(b,fa.a.getOrigin(this.ZXg))}iU(b,...h){const u={};
this.q6&&(u[Ph.Nwj]=this.q6);u[Ph.Owj]=String.format.apply(null,[b].concat(h));return G.c(u)}y$b(){return ah.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}nXi(){if(this.kfa)this.kfa.onPaneThemeChanged(this.y$b());return ah.a("getTheme")?appChrome.api.getTheme():null}Wjc(){}Sfe(){document.getElementById(Ph.iC)&&hd.FocusManager.fK(document.getElementById(Ph.iC).contentWindow)}cnb(){Pl.Tz("ReactSmartLookupPane - Iframe component failed to load.",10)}dnb(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",
!1)||window.navigator.onLine||Pl.Tz("ReactSmartLookupPane - Onload detected no network.",50)}rUl(){return this.GE?10===this.GE.entryPoint?2===v.AFrameworkApplication.ua.Lb.Nk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.GE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.GE.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.GE.entryPoint||38===this.GE.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:
""}vA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(b=this.rUl());const h=new NL;h.src=this.ZXg;h.id=Ph.iC;h.refreshPane=this.UOe;h.onError=Object(z.a)(this,this.cnb,"onIFrameError");h.onLoad=Object(z.a)(this,this.dnb,"onIFrameLoad");h.title=b;fc.SessionStatusManager.instance.WH?this.kfa||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=
CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new ql.a,{title:b,hideHeader:!1,width:Ph.width,location:Ph.jxn,contentProps:h,isModernPane:!0,onOpen:()=>{this.mgo();this.Rs=!0;this.L5f();ah.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.nXi,"onThemeIdChanged"));v.AFrameworkApplication.ua.updateCommandUI();if(this.kfa)this.kfa.onPaneStateChanged(!0)},onClose:()=>{this.Gbo();this.$da();this.Rs=!1;this.mng();ah.a("removeOnThemeChangeCallback")&&
appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.nXi,"onThemeIdChanged"));v.AFrameworkApplication.ua.updateCommandUI();if(this.kfa)this.kfa.onPaneStateChanged(!1)}});this.dUe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}kdl(b){const h=this.vA();h.title=b;h.contentProps.title=b;return h}abf(b){const h=this.vA();h.resizeWidth=b;return h}}Object(m.a)(PL,"ReactSmartLookupPane",RF,[]);class QL{dKc(){const b=new Fm.CuiHelper(xk.a.u_a,WordEditorIntl.WordEditorStrings);
return Vn.a.instance.CMh(Ph.iC,Ph.$gc,Ph.width,Ph.Vjg,b)}showTaskPane(b){Vn.a.instance.showTaskPane(b)}hideTaskPane(b){Vn.a.instance.hideTaskPane(b)}x6b(b){Vn.a.instance.x6b(Ph.iC,b)}}Object(m.a)(QL,"WordInsightsPaneHandler",null,[357]);class RL{dKc(){Vn.a.instance.tOa()}showTaskPane(b){mk.UISurfaces.Mu().then(h=>{h.showTaskPane(Ph.iC,b);return null})}updateTaskPane(b=null){mk.UISurfaces.Mu().then(h=>{h.setSelectedTaskPane(Ph.iC);b&&h.updateTaskPane(Ph.iC,b);return null})}hideTaskPane(){mk.UISurfaces.Mu().then(b=>
{b.hideTaskPane(Ph.iC,2);return null})}}Object(m.a)(RL,"WordReactSmartLookupPaneHandler",null,[355]);class SL extends VE{constructor(b,h){super();this.Cx=b;this.ib=h}mId(){const b=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Lb&&v.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Lb&&v.AFrameworkApplication.ua.Lb.XFf?new PL(new RL,Um.a.instance,hd.FocusManager.instance(),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),
Ga.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ga.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new UF(new QL,Um.a.instance,hd.FocusManager.instance(),Ga.a.instance.resolve("Common.Utils.IAriaNotifier"),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ga.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Ga.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ga.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ga.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}LFb(){return this.Cx.getSelectedText()}t$h(){if(!this.ib||!this.ib.hb||1>this.ib.hb.length)return null;var b=this.ib.hb.lb.Pa;b=null==b?null:zc.FormattingReader.Vr(b);return(b=null==b?null:Jj.a.qg(zc.FormattingReader.language(b)))?b.name:""}i2a(){return this.Cx.btf()}v$h(){return this.Cx.btf()}Hxi(){return this.Cx.oIm()}}
Object(m.a)(SL,"WordInsightsManager",VE,[]);var mN=c(214);class TL{}Object(m.a)(TL,"CommandMetadataResponse",null,[]);class jE{constructor(){this.Vyf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){mN.PrivacyDialogManager.Uhe()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new TL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const u=appChrome.selectors.getControlIconSet(b.commandId),B=Array(2);B[0]=u["default"];B[1]=u.icon32;h.svgData=this.getCommandIconSvg(B)}catch(u){return null}return h}getCommandIconSvg(b){if(!this.Vyf)return"";
for(let h=0;h<b.length;h++){const u=b[h];if(u in this.Vyf)return this.Vyf[u]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const u={};u.featureArea=jE.vzl;h.telemetryGroup=u;h.appData=b;return h}}jE.Umi="FA000000012";jE.queryPrefix="AssetID=";jE.vzl="SearchPane";Object(m.a)(jE,"BaseSerpletExecutor",null,[353,320]);
class UL extends jE{constructor(b,h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Rb(Ob.a.hKb,2,null);break;case 1:this.ga.Rb(Qc.a.FQb,2,null);break;case 2:this.ga.Rb(Ob.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Rb(Za.a.PXd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Rb(Za.a.oPb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Rb(Za.a.Rjf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};QH(this.ib);this.ga.Rb(Za.a.Rjf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Rb(Za.a.findInDocument,2,h)}openNavigationPane(){this.ga.Rb(Qc.a.plc,2,null)}openSerpletTaskPane(){this.ga.Rb(Za.a.mti,2,null)}sendAutoLaunchSearchRequest(){this.ga.Rb(Za.a.IXd,2,null)}getAllIcons(){const b=
{};for(const u of Object.keys(window))if(u.startsWith("word")){var h=window[u];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(B=>b[B.id]=JSON.stringify(B)))}return b}}Object(m.a)(UL,"WordSerpletExecutor",jE,[]);class VL extends LH{constructor(){super();this.pMe=null;this.Wx=()=>{v.AFrameworkApplication.u0&&(this.Jql(),qs.a.Uk().then(()=>this.pMe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){v.AFrameworkApplication.u0&&(this.pMe.Oa("WordEditor.Insights.WordInsightsActor").Tb(),
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?v.AFrameworkApplication.K.Hn(this.Wx):super.init())}wc(b){super.wc(b);this.pMe=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new Am.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new IL(v.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new UL(v.AFrameworkApplication.va,xf.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new QF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new fw(new hg.a(()=>Fb.App.za?Fb.App.za.jb.Yc:null),b.resolve("Box4.IParagraphReader"),
xL.a.instance,v.AFrameworkApplication.K,yh.a.instance,dN.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),v.AFrameworkApplication.va,xf.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new GL(new hg.a(()=>Fb.App.za?Fb.App.za.jb.Yc:null),b.resolve("Box4.IParagraphReader"),nb.InteractiveViewManager.instance,xf.a.instance,b.resolve("Box4.ISelectionFactory"),h,Fb.App.ni.zl.Te(12),new hg.a(()=>Fb.App.za.jb),hd.FocusManager.instance(),
v.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.Ta("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new SL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();b.ia("WordEditor.Insights.WordInsightsActor",
()=>new JL(b.Re("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ia("Common.App.SearchCommon.IDocumentHelper",()=>new HL(b.Ta("WordEditor.Extension.DocumentProperties"))).ha()}}Object(m.a)(VL,"WordInsightsPackage",LH,[]);class nN{}Object(m.a)(nN,"ScalingStep",null,[]);class XL{constructor(b,h,u){this.wwc=!1;this.fQ=null;this.nDc=this.CXb=
!1;this.gZa=[];this.zde=B=>{this.maa&&this.maa!==B&&appChrome.api.dispatch(this.ffi(!1))};h.execute(B=>{this.fQ=B});b.Sw(Object(z.a)(this,this.Arn,"onProcessSetSelectionFinished"));this.eq=u}g$b(b,h,u){const B=[];for(const Q of b)B.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:Q},u));return B}Cdi(b){const h=[];for(let u=0;4>u;u++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>u?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",
{type:"GalleryToFlyout",controlId:b},void 0));return h}ffi(b){const h=[];if(b)switch(this.maa){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.Cdi("PictureStyles"));h.push(...this.g$b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.gZa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.g$b(b,"MoveToOverflow"));break;case "Table":this.nDc||
h.push(...this.Cdi("TableStyles"));h.push(...this.g$b(this.gZa,"DropLabel",this.nDc?0:void 0));b=this.gZa.slice().reverse();h.push(...this.g$b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.g$b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.gZa.slice().reverse(),h.push(...this.g$b(b,"MoveToOverflow"))}else for(const u of this.gZa)h.push(appChrome.actions.removeControlScalingStepsFromTab(u,"Home"));return h}mcd(b){const h={};for(const u of b)try{h[u]=appChrome.selectors.getModelType(u)}catch(B){this.MG("Error",
"GetModelType failed for "+u)}Fb.App.za.FOd(h)}cRo(b){if(0!==b.length){var h=[],u={},B=!1;for(const Q of b)try{if(appChrome.selectors.isControlDefined(Q))u[Q]=appChrome.selectors.getModelType(Q);else{B=!0;break}}catch(ca){this.MG("Error","GetModelType failed for "+Q);B=!0;break}if(B)this.maa=void 0,this.$me(!1);else{if("Image"===this.maa&&!this.CXb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.CXb=!0;else if(this.CXb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));
B=appChrome.selectors.getVisibleControlsInGroup("Font");for(const Q of B)u[Q]=appChrome.selectors.getModelType(Q);this.CXb=!1}Fb.App.za.FOd(u);this.gZa=b;u=[];for(const Q of b)appChrome.selectors.isControlDisabled(Q)&&u.push(Q);0<u.length&&this.MG("Disabled",u.join(","));0<this.gZa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.gZa)),h.push(...this.ffi(!0)),this.wwc=!0);appChrome.api.dispatch(h)}}}$me(b){if(b||
this.wwc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.wwc=b;if("Image"===this.maa||this.CXb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const u=appChrome.selectors.getVisibleControlsInGroup("Font");this.mcd(u)}this.CXb=!b}appChrome.api.dispatch(h)}}UUa(){this.wwc&&this.eq&&this.eq.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}Arn(b,h){!v.AFrameworkApplication.ua.Lb.blc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.fQ&&h.pl&&h.pl.lb&&0!==h.pl.length?(b=()=>{let u=[],B=!1;var Q=this.fQ.contentType,ca=appChrome.selectors.getActiveContextualTabIds();Q.includes("Image")?(this.zde("Image"),this.maa&&"Image"===this.maa?B=!0:(u="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.maa="Image")):Q.includes("Table")&&0<=ca.indexOf("Table")?(Q=!(Hr.a.instance.lb.rGa||Hr.a.instance.lb.Ov||
Hr.a.instance.lb.nlb),(ca="Table"===this.maa&&Q!==this.nDc)?this.zde("TableCellEdit"):this.zde("Table"),!this.maa||"Table"!==this.maa||ca?(Q?(u=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.nDc=!0):(u="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.nDc=!1),this.maa="Table"):
B=!0):Q.includes("Hyperlink")&&(this.zde("Hyperlink"),this.maa&&"Hyperlink"===this.maa?B=!0:(u=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.maa="Hyperlink"));B?this.wwc||(this.mcd(this.gZa),this.$me(!0),this.UUa()):0<u.length?(this.cRo(u),this.UUa()):this.$me(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.$me(!1)}MG(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new zi.a;h.name=
"Events";h.dataFields=ol.a.jJ(b);h.durationMs=window.performance.now();ea.a.gIa(h,"TellMeWAC.")}}Object(m.a)(XL,"AdaptiveTabGroupUpdater",null,[]);class YL{constructor(){this.W=null;this.Din=()=>{v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ia("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new XL(this.W.resolve("Box4.ISelectionManager"),this.W.Ta("Common.IActionContextProvider"),this.W.Ta("Common.ISystemInitiatedFeedback"))).ha(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}wc(b){this.W=b}init(){ED.a(1,this.Din)}dispose(){}}Object(m.a)(YL,"PackageManager",null,[1,2]);const oN=(b,h,u)=>1===u?32:2===u?(c.e(4).then(c.bind(null,2076)).then(B=>{B.createAndShowDevToolsMenu()}),32):2;class RH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))v.AFrameworkApplication.va.ra(Qc.a.Gfg,Ad.a.frame,oN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(4).then(c.bind(null,2076))}dispose(){}wc(){}static main(){M.a.instance.Gc(new RH)}}Object(m.a)(RH,"WordDevToolsPackage",null,[1,2]);c(582);class SH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(m.a)(SH,"FormattingData",null,[]);class ZL extends SH{constructor(){super();this.hyperlinkData=null}}Object(m.a)(ZL,"RichContentCommandData",
SH,[]);class Qi{constructor(){Qi.Xi.add(Qc.a.h8a);Qi.Xi.add(Qc.a.$Qb);Qi.Xi.add(Qc.a.jmc);Qi.Xi.add(Qc.a.AV);Qi.Xi.add(Qc.a.gSf);Qi.Xi.add(Qc.a.f1f);Qi.Xi.add(Qc.a.deleteComment);Qi.Xi.add(Qc.a.KKc);Qi.Xi.add(Qc.a.$cf);Qi.Xi.add(Qc.a.nie);Qi.Xi.add(Qc.a.t8a);Qi.Xi.add(Qc.a.Gfg);Qi.Xi.add(Qc.a.FQb);Qi.Xi.add(Qc.a.Nfg);Qi.Xi.add(Qc.a.KLc);Qi.Xi.add(Qc.a.ZKd);Qi.Xi.add(Ob.a.digitalPrintToSway);Qi.Xi.add(Ob.a.openInClient);Qi.Xi.add(Ob.a.print);Qi.Xi.add(Ob.a.gae);Qi.Xi.add(Ob.a.A3f);Qi.Xi.add(Ob.a.readingMode);
Qi.Xi.add(Ob.a.hKb);Qi.Xi.add(Za.a.lyj);Qi.Xi.add(Za.a.tellMe);Qi.Xi.add(Za.a.Had);Qi.Xi.add(Za.a.oPb);Qi.Xi.add(Za.a.giveFeedback);Qi.Xi.add(Za.a.R9c);Qi.Xi.add(Za.a.zfg);Qi.Xi.add(Za.a.Hqg);Qi.Xi.add(Za.a.K8);Qi.Xi.add(Za.a.SGa);Qi.Xi.add(Za.a.M7e);Qi.Xi.add(Za.a.yRa);Qi.Xi.add(Za.a.r8f);Qi.Xi.add(Za.a.q8f);Qi.Xi.add(Za.a.s8f);Qi.Xi.add(Za.a.lKd);Qi.Xi.add(Za.a.Dma);Qi.Xi.add(Za.a.Cie);Qi.Xi.add(Za.a.lqj);Qi.Xi.add(Za.a.close);Qi.Xi.add(Za.a.$ae);Qi.Xi.add(Za.a.oae);Qi.Xi.add(Za.a.w8d);Qi.Xi.add(Za.a.xie);
Qi.Xi.add(Za.a.Bie);Qi.Xi.add(Za.a.sNb);Qi.Xi.add(Za.a.renameFile);Qi.Xi.add(Za.a.Xac);Qi.Xi.add(Za.a.mgg);Qi.Xi.add(Za.a.wlc);Qi.Xi.add(Za.a.downloadACopy);Qi.Xi.add(Za.a.Gjc);Qi.Xi.add(Za.a.l$d);Qi.Xi.add(Za.a.XNb);Qi.Xi.add(Za.a.p4i);Qi.Xi.add(Za.a.AEh);Qi.Xi.add(Za.a.LFd);Qi.Xi.add(Za.a.L7e);Qi.Xi.add(Za.a.CEh);Qi.Xi.add(Za.a.BEh);Qi.Xi.add(Za.a.M7e);Qi.Xi.add(Za.a.MFd);Qi.Xi.add(Qc.a.ppe);Qi.Xi.add(Qc.a.xrg);Qi.Xi.add(Qc.a.zoomToPageWidth);Qi.Xi.add(Qc.a.pag);Qi.Xi.add(Qc.a.job);Qi.Xi.add(Qc.a.sbe);
Qi.Xi.add(Qc.a.uka);Qi.Xi.add(Za.a.Qjb);Qi.Xi.add(Za.a.ugb);Qi.Xi.add(Za.a.zlc);Qi.Xi.add(Za.a.zKj);Qi.Xi.add(Za.a.w4i);Qi.Xi.add(Qc.a.I4c);Qi.Xi.add(Ob.a.eNb);Qi.Xi.add(Ob.a.Sia)}}Qi.Xi=new Set;Object(m.a)(Qi,"CommentRibbonCommands",null,[]);class $L{constructor(b,h,u,B,Q){this.iQi=b;this.yh=h;this.Co=u;this.hl=B;this.sHo=Q;this.a_b=null;this.AAa=new Jh.a(0);this.Hsb=new Jh.a(0);this.Mte=new Jh.a(0);this.cWe=!1;this.bym();this.lVn()}oHm(b){return this.a_b&&this.Co.Px?!Qi.Xi.has(b):!1}L$b(b,h,u){if(b===
Za.a.Gg)return 32;if(!this.AAa.nb(b)&&!this.Hsb.nb(b)||!this.a_b)return 2;const B=this.Hsb.nb(b);var Q=B?this.Hsb.J(b):this.AAa.J(b);const ca=B?2:this.Mte.J(u);B||1!==ca||(this.QKm(Fb.App.za.Dp.currentScope.name)||Fb.App.za.Dp.kg(this.yh.xm?$d.AFrame.Qr:$d.AFrame.GM),Fb.App.za.updateCommandUI(!0));u=new ZL;switch(Q){case 1:u.highlight={color:this.eei(h.Color)};break;case 6:u.fontColor={color:this.eei(h.Color)}}Q=this.a_b.executeCommand(Q,ca,u);2===Q&&B&&(b===Ob.a.Whc?h[gg.a.On]=!!u.bold:b===Ob.a.bic?
h[gg.a.On]=!!u.italic:b===Ob.a.kic?h[gg.a.On]=!!u.underline:b===Ob.a.eic?h[gg.a.On]=!!u.strikethrough:b===Ob.a.cZ?h[gg.a.On]=!!u.highlight:b===Ob.a.Xv&&(h[gg.a.On]=!!u.fontColor));return 2===Q?32:1===Q?2:8}pSn(b){this.a_b=b;this.a_b.registerSelectionChangeHandler(()=>{this.cWe||(this.cWe=!0,Fb.App.za.updateCommandUI(!0),this.cWe=!1)});this.a_b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case Se.a.xTb:case Se.a.bsb:case Se.a.Yqe:case Se.a.HVa:Fb.App.za.updateCommandUI(!0)}h.key!==Se.a.oC&&
h.key!==Se.a.Z1||Fb.App.za.updateCommandUI(!0)})}lVn(){this.iQi.h8i($d.AFrame.Qr,this);this.iQi.h8i($d.AFrame.GM,this)}bym(){this.AAa.Z(Ob.a.bold,0);this.AAa.Z(Ob.a.Wy,3);this.AAa.Z(Ob.a.strikethrough,4);this.AAa.Z(Ob.a.underline,5);this.AAa.Z(Ob.a.cZ,1);this.AAa.Z(Ob.a.Vua,1);this.AAa.Z(Ob.a.Xv,6);this.AAa.Z(Ob.a.wga,6);this.AAa.Z(Ob.a.gra,6);this.Hsb.Z(Ob.a.Whc,0);this.Hsb.Z(Ob.a.bic,3);this.Hsb.Z(Ob.a.eic,4);this.Hsb.Z(Ob.a.kic,5);this.Mte.Z(1,0);this.Mte.Z(2,1)}QKm(b){return b===$d.AFrame.Qr||
b===$d.AFrame.GM}eei(b){return b?zl.a.aF(this.sHo.cva(this.hl.ed,b)):""}}Object(m.a)($L,"CommentRibbonCommandHandler",null,[273,274]);class TH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").i4f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").k$("OnCommentRenderedOnce",()=>
{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new $L(this.W.Oa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),hk.App.hn.jb.qc,Zn.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();this.W.ia("WordEditor.Comments.CommentRibbonCommands",()=>new Qi).ha()}static main(){M.a.instance.Gc(new TH)}}Object(m.a)(TH,
"PackageManager",null,[1,2]);var pN=c(1969);class VF{constructor(b,h){this.Rgl=2E3;this.Nlh=null;this.sZf=b.PZi;this.maxLength=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.Rgl);h&&h.execute(u=>{this.Nlh=u})}wnf(b){b=this.nOl(b,this.maxLength);return{semantic:Bd.ObjectSemantic.CanvasContext,type:Bd.ObjectSchemaType.WordCanvasContext,value:b}}nOl(b,h){try{return this.mOl(b,h)}catch(u){return r.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",
u),null}}Gbm(b,h){const u={e1a:[],cya:0,selection:{start:null,end:null},cursor:null,tiles:[]},B=b.length;for(let ca=0;ca<B;ca++){const qa=b.J(ca);var Q=qa.node;if(!me.ParagraphReader.Wb(Q)||Array.contains(u.e1a,Q.Bl))continue;u.e1a.push(Q.Bl);const Qa=me.ParagraphReader.textLength(Q);if(u.cya+Qa>h)break;Q=this.sZf.qCb(Q);u.tiles.push(Q);u.cya+=Qa;1!==B||u.cursor||(u.cursor=VF.BSl(qa,u.tiles.length-1));null===u.selection.start&&0===ca&&(u.selection.start=this.Dhi(qa,!0,u.tiles.length-1));null===u.selection.end&&
ca===B-1&&(u.selection.end=this.Dhi(qa,!1,u.tiles.length-1))}return u}z3l(b,h,u){const B={Uad:[],Ixj:[],cya:0};var Q=b.J(0).node;let ca=b.J(b.length-1).node;for(b=h;0<b&&(Q||ca);){var qa=VF.a3i(Q,!0,b,u);if(Q=qa.node)Q=this.sZf.qCb(Q),B.Uad.push(Q),b-=qa.cya,Q=qa.node,u=qa.e1a;qa=VF.a3i(ca,!1,b,u);if(ca=qa.node)u=this.sZf.qCb(ca),B.Ixj.push(u),b-=qa.cya,ca=qa.node,u=qa.e1a}B.cya=h-b;return B}oOl(b,h){let u=0;var B=this.Gbm(b,h);const Q={tiles:B.tiles,selection:B.selection,cursor:B.cursor};u+=B.cya;
B=B.e1a;u<h&&(b=this.z3l(b,h-u,B),Q.tiles.unshift.apply(Q.tiles,b.Uad),Q.tiles.push.apply(Q.tiles,b.Ixj),Q.selection.start&&(Q.selection.start.index+=b.Uad.length),Q.selection.end&&(Q.selection.end.index+=b.Uad.length),Q.cursor&&(Q.cursor.index+=b.Uad.length));return Q}mOl(b,h){var u;if(!b)return null;b=this.oOl(b,h);return{contentType:null===(u=this.Nlh)||void 0===u?void 0:u.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}Dhi(b,h,u){if(b.contextId===vc.a.Jd||b.contextId===
vc.a.paragraph||b.contextId===vc.a.Tc){if(h&&-1!==b.Ij)return{index:u,offset:b.Ij};if(!h&&-1!==b.np)return{index:u,offset:b.np}}return null}static BSl(b,h){return b.contextId===vc.a.Tc?{index:h,offset:b.Ij}:null}static a3i(b,h,u,B){B={node:null,cya:0,e1a:B};if(!b||0>=u||!B.e1a)return B;do B.node=me.ParagraphReader.$f(b,h,!1,!1),B.cya=B.node?me.ParagraphReader.textLength(B.node):0,b=B.node;while(B.node&&(Array.contains(B.e1a,B.node.Bl)||!me.ParagraphReader.Wb(B.node)||!B.cya));B.node&&(B.cya>u?B.node=
null:B.e1a.push(B.node.Bl));return B}}Object(m.a)(VF,"Box4CanvasContextProvider",null,[272]);class UH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}wc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new VF(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Ta("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){M.a.instance.Gc(new UH)}}Object(m.a)(UH,"Box4CanvasContextPackage",null,[1,2]);class aM{constructor(b,h,
u,B){this.zI={};this.m1b=this.kvd=0;this.wJd=3E4;this.start=()=>{0!=this.Uzb.size&&0===this.m1b&&(this.m1b=window.setInterval(this.b8n,this.wJd),r.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.b8n=()=>{if(0!=this.Uzb.size)if(this.kf.Fo)r.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var Q=50;this.zI.ScanTime=Date.now();this.zI.NumWatchDogs=this.Uzb.size;this.zI.WatchDogManagerScanNumber=++this.kvd;this.Uzb.forEach(async(ca,qa)=>{this.zI[qa]=
await ca.ccn();this.eNm&&"KickoutComponent"==this.zI[qa].ComponentStatus&&this.qIf(this.aVl(qa));ca.oVm()||(Q=15)});r.ULS.sendTraceTag(520974674,306,Q,JSON.stringify(this.zI))}};this.kf=b;this.f_b=u;this.XZ=B;this.dXe=new Map;this.Uzb=new Map;h.execute(Q=>{this.Vl=Q;this.Vl.$Za((ca,qa)=>{this.aY(qa)})})}aY(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.m1b||(r.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),
this.stop()):(this.stop(),this.start(),this.s4n(),r.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.m1b&&(window.clearInterval(this.m1b),this.m1b=0);r.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}wtk(b,h){this.dXe.set(b,h)}V4n(){this.FDn(this.dXe)}get Rzk(){return this.dXe.size===this.Uzb.size}FDn(b){b.forEach((h,u)=>{h.execute(B=>{B?(this.Uzb.set(u,B),this.start()):r.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",
u)})})}s4n(){this.Uzb.forEach(b=>{b&&b.R6a()});r.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}qIf(b){0<this.f_b.XUa&&this.XZ.Ydc(b)}aVl(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?kl.a.z5o:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?kl.a.y5o:null}get eNm(){return null!=this.UBg?this.UBg:this.UBg=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KickoutEnabledFromWatchDogs",!1)}}Object(m.a)(aM,"WatchDogManager",null,
[109]);class VH{constructor(){this.W=this.Tzb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.Tzb=this.W.resolve(this.name);this.cAm()}dispose(){this.Tzb&&this.Tzb.stop()}wc(b){this.W=b;b.ia(this.name,this.Udl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){M.a.instance.Gc(new VH)}k0o(){if(!this.Tzb.Rzk){const b=[];let h=0;this.fvd.forEach((u,B)=>{u&&(this.W.Oa(B)||(b[h++]=B))});if(0<b.length){const u=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").KU;
r.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,u)}}}Udl(){return new aM(this.W.resolve("Common.ISessionStatus")||fc.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),this.W.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.W.resolve("Wonca.KickoutExecutor"))}puk(){window.setTimeout(this.k0o.bind(this),this.E1o)}wuk(){this.fvd=new Map;this.fvd.set("WordEditor.RunawayDataLossMonitorWatchDog",Fb.App.ym||Fb.App.ys);this.fvd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",
!0)}cAm(){this.wuk();this.vuk(this.fvd,this.Tzb.wtk.bind(this.Tzb));this.Tzb.V4n();this.puk()}vuk(b,h){b.forEach((u,B)=>{u&&h(B,this.W.Ta(B))})}get E1o(){return null!=this.ZIg?this.ZIg:this.ZIg=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(m.a)(VH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");
Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");
Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");
Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");
Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");
Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");
Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");
Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");P.main();Type.registerNamespace("Common.App.WopiIdentity");sa.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Cc.main();Object(pN.a)(!1);fb.main();Xa.main();
Pb.main();RH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");hf.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");pf.main();Type.registerNamespace("Common.App.WildFire");Bc.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Gd.main();Type.registerNamespace("Common.App.HostNotification");
$b.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Mf.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Af.main();Type.registerNamespace("CNT");km.main();Type.registerNamespace("Common.App.NewAndOpen.Core");M.a.instance.Gc(new Lm);Type.registerNamespace("Common.App.NewAndOpen.UX");M.a.instance.Gc(new md);Type.registerNamespace("Common.App.OneDriveFilePickerApi");
Rh.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");oe.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Uk.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");nc.main();Type.registerNamespace("CADWLTR");Kc.main();Type.registerNamespace("Common.App.DirectPrint");
M.a.instance.Gc(new lm);Type.registerNamespace("Common.App.SearchOAuthManager");eh.main();Fl.main();Wj.main();Hj.main();dp.main();Dk.main();M.a.instance.Gc(new tj);qb.main();Zb.main();Fi.main();M.a.instance.Gc(new Bo);Type.registerNamespace("Common.App.SaveStatus");M.a.instance.Gc(new po);Type.registerNamespace("Common.App.EventsCacheManager");Fk.main();Type.registerNamespace("CUIB");$h.main();Type.registerNamespace("CommandUI.TaskPane");try{M.a.instance.Gc(new $l(Fb.App.za.jb))}catch(b){r.ULS.shipAssertTag(575930383,
3016,!1,b.message)}mn.main();Type.registerNamespace("Common.App.Insights");Wo;M.a.instance.Gc(new Om);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");nn("Begin");M.a.instance.Gc(new Ok);try{M.a.instance.Gc(new Qr(Yk.a.get_instance(),Fb.App.za.jb,Fb.App.za.Lb))}catch(b){r.ULS.shipAssertTag(575930384,
3016,!1,b.message)}$e.main();M.a.instance.Gc(new td);zr.main();ml.main();Li.main();Ct.main();Dt.main();kw.main();by.main();zA.main();M.a.instance.Gc(new Lv);Qu.main();Mv.main();Ez.main();Bw.main();UH.main();TH.main();M.a.instance.Gc(new GA);M.a.instance.Gc(new Gz);Dw.main();RB.main();su.main();M.a.instance.Gc(new Gw);M.a.instance.Gc(new oy);py;Cx.main();Rt.main();eD.main();bj.main();uh;M.a.instance.Gc(new jb);M.a.instance.Gc(new jd);He.main();zD.main();mE.main();M.a.instance.Gc(new dF);M.a.instance.Gc(new kF);
Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=kz;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Zs.main();mD.main();sE.main();bG;gH.main();zM;window.MSOJS=uD;DH.main();GH.main();M.a.instance.Gc(new VL);M.a.instance.Gc(new YL);(async()=>{v.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(27).then(c.bind(null,2086)).then(b=>{b.initializeOnDemandPackage()})})();
VH.main();mo.main()},2095:function(D,I,c){D=c(0);var l=c(7),f=c(1622);class a{static get R9m(){return 50}static LSd(x){if(""===x)return"";let y=0,m="";try{const r=f.a.xFb(x);for(const z of r.ops)if(a.JG(z))y||(m+=a.nWl(z.attributes.atmention.fullName)),y+=1;else{const v=z.insert?z.insert:"";" "!==v&&0<v.length&&(y=0,m+=v)}}catch(r){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return m}static mQl(x){x=a.LSd(x);return 0<
x.length&&x.split(" ").length<=a.R9m?x:null}static nWl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static JG(x){return!!x.attributes&&!!x.attributes.atmention}}Object(D.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(I,"a",function(){return k});class k extends a{constructor(){super()}static nFb(x,y,m=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Af||""===y.Af;return 0<x.length&&y&&!m?a.mQl(x):null}}Object(D.a)(k,"CommentSmartReplyHelpers",a,[])},955:function(D,
I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.method=this.api=0}}Object(D.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20205649/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll1.js.map